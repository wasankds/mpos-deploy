const _0x337f60=_0x28fa;(function(_0x1155f4,_0x2a70f6){const _0x800f39=_0x28fa,_0x3dff4d=_0x1155f4();while(!![]){try{const _0x2477da=parseInt(_0x800f39(0x27d))/0x1*(-parseInt(_0x800f39(0x191))/0x2)+-parseInt(_0x800f39(0x1ae))/0x3*(-parseInt(_0x800f39(0x12f))/0x4)+-parseInt(_0x800f39(0x1a8))/0x5*(parseInt(_0x800f39(0x12b))/0x6)+parseInt(_0x800f39(0x137))/0x7+-parseInt(_0x800f39(0x21c))/0x8+parseInt(_0x800f39(0x111))/0x9+parseInt(_0x800f39(0xc4))/0xa;if(_0x2477da===_0x2a70f6)break;else _0x3dff4d['push'](_0x3dff4d['shift']());}catch(_0x1e8d78){_0x3dff4d['push'](_0x3dff4d['shift']());}}}(_0x1fdc,0x4554d));const _0x459260=(function(){const _0x933c45=_0x28fa,_0x1b90f9={'KERij':function(_0x50bd61,_0x51d5e7){return _0x50bd61(_0x51d5e7);},'MOmcW':function(_0x5cce23,_0x38b988){return _0x5cce23===_0x38b988;},'pgUCe':_0x933c45(0x10d),'KaXsB':'ALCOM','TllJS':_0x933c45(0x99),'WnyDz':_0x933c45(0x205),'DqLZS':function(_0xb2174a,_0x4309b8){return _0xb2174a===_0x4309b8;},'uAMWi':'RjloW'};let _0x221103=!![];return function(_0x243ccd,_0x135e15){const _0x1f20f0=_0x933c45,_0x509fbd={'CVyit':function(_0x382a78,_0x3fda10){const _0x1900b9=_0x28fa;return _0x1b90f9[_0x1900b9(0x1de)](_0x382a78,_0x3fda10);},'RyXgq':_0x1b90f9[_0x1f20f0(0xb6)],'DShkI':_0x1b90f9[_0x1f20f0(0xbf)],'VvoSj':function(_0xf8d6ad,_0x4385fe){const _0x56598b=_0x1f20f0;return _0x1b90f9[_0x56598b(0x1de)](_0xf8d6ad,_0x4385fe);},'zzxGC':_0x1b90f9[_0x1f20f0(0x10a)],'BseEY':_0x1b90f9[_0x1f20f0(0x221)]};if(_0x1b90f9[_0x1f20f0(0x12a)](_0x1b90f9[_0x1f20f0(0x1cc)],_0x1b90f9[_0x1f20f0(0x1cc)])){const _0x294876=_0x221103?function(){const _0x2b0479=_0x1f20f0;if(_0x509fbd[_0x2b0479(0x278)](_0x509fbd[_0x2b0479(0x18e)],_0x509fbd['DShkI']))_0x24c855['has'](_0x4dbfd6['supplierId'])?_0x4ce44b[_0x2b0479(0xe8)](_0x5cc192['supplierId']):_0x596843[_0x2b0479(0xe8)](_0x5b8f13[_0x2b0479(0x199)]);else{if(_0x135e15){if(_0x509fbd['VvoSj'](_0x509fbd[_0x2b0479(0x1d4)],_0x509fbd[_0x2b0479(0xda)]))_0x53e625[_0x2b0479(0x11f)]();else{const _0xb7a37f=_0x135e15[_0x2b0479(0x11a)](_0x243ccd,arguments);return _0x135e15=null,_0xb7a37f;}}}}:function(){};return _0x221103=![],_0x294876;}else _0x1b90f9['KERij'](_0x9d0495,'0');};}());(function(){const _0x30ff86=_0x28fa,_0x5b9e76={'SYRqt':function(_0x1fa1f3,_0x1cb5a3){return _0x1fa1f3!==_0x1cb5a3;},'Jlbcj':_0x30ff86(0x21e),'BFNfy':_0x30ff86(0x1bd),'xjZVB':_0x30ff86(0xf9),'TjwQa':_0x30ff86(0x155),'sJxfF':function(_0x2dad8a,_0x3ef2b6){return _0x2dad8a(_0x3ef2b6);},'IZbkU':_0x30ff86(0xc0),'vHLhv':function(_0xe998ad,_0x41bdb1){return _0xe998ad+_0x41bdb1;},'VxlYK':'chain','WejFV':function(_0x2c8857,_0x9dc8f9){return _0x2c8857+_0x9dc8f9;},'fheRt':_0x30ff86(0x119),'JxKjq':function(_0xd9ef6a,_0x4f2217){return _0xd9ef6a===_0x4f2217;},'NKyKd':_0x30ff86(0x192),'CIZAQ':function(_0x28b340,_0x5310e9){return _0x28b340(_0x5310e9);},'zRRTa':_0x30ff86(0x120),'iGdBF':function(_0x2f616d){return _0x2f616d();},'crEIN':function(_0x1e8762,_0x1c7398,_0x2cfb50){return _0x1e8762(_0x1c7398,_0x2cfb50);}};_0x5b9e76['crEIN'](_0x459260,this,function(){const _0x3a8969=_0x30ff86;if(_0x5b9e76[_0x3a8969(0x24c)](_0x5b9e76[_0x3a8969(0x14f)],_0x5b9e76[_0x3a8969(0x9a)])){const _0x3f2e66=new RegExp(_0x5b9e76['xjZVB']),_0x3e9c29=new RegExp(_0x5b9e76[_0x3a8969(0x213)],'i'),_0x346a85=_0x5b9e76[_0x3a8969(0x258)](_0x2da58c,_0x5b9e76[_0x3a8969(0x274)]);if(!_0x3f2e66['test'](_0x5b9e76[_0x3a8969(0x235)](_0x346a85,_0x5b9e76[_0x3a8969(0xb5)]))||!_0x3e9c29[_0x3a8969(0x13f)](_0x5b9e76[_0x3a8969(0x1f7)](_0x346a85,_0x5b9e76[_0x3a8969(0x1c8)])))_0x5b9e76[_0x3a8969(0x1a1)](_0x5b9e76['NKyKd'],_0x5b9e76[_0x3a8969(0x20a)])?_0x5b9e76[_0x3a8969(0x167)](_0x346a85,'0'):_0x30291e[_0x3a8969(0x11f)]();else{if(_0x5b9e76[_0x3a8969(0x24c)](_0x5b9e76[_0x3a8969(0x26f)],_0x5b9e76[_0x3a8969(0x26f)]))return!![];else _0x5b9e76[_0x3a8969(0x143)](_0x2da58c);}}else _0x3fef6a[_0x3a8969(0x11f)]();})();}());const _0x2721c7=(function(){const _0x6a0cfc=_0x28fa,_0x1fad6c={'MOaYg':function(_0x50a6d2,_0x401ce4){return _0x50a6d2===_0x401ce4;},'loByQ':_0x6a0cfc(0x15f),'lGiVP':_0x6a0cfc(0xb4),'ehriZ':function(_0x45346d,_0x51f8e1){return _0x45346d===_0x51f8e1;},'aofOS':_0x6a0cfc(0x195),'yNXKB':_0x6a0cfc(0x24e),'HHXLP':'msg','DAIuD':'green','rbIqt':function(_0x1b98b6,_0x55abdb){return _0x1b98b6===_0x55abdb;},'OdjlX':_0x6a0cfc(0xc3)};let _0x25abd0=!![];return function(_0x335888,_0x8861e1){const _0x545050=_0x6a0cfc,_0x58dd7d={'ALcco':_0x1fad6c[_0x545050(0xc7)],'lrhlA':_0x1fad6c[_0x545050(0x1a5)]};if(_0x1fad6c['rbIqt'](_0x1fad6c['OdjlX'],_0x1fad6c[_0x545050(0x9b)])){const _0x1699e7=_0x25abd0?function(){const _0x414e14=_0x545050;if(_0x1fad6c[_0x414e14(0xa8)](_0x1fad6c[_0x414e14(0x26c)],_0x1fad6c[_0x414e14(0x18b)])){const _0x4364f2=_0x2280fb?new _0x90be22(''+_0x1027c2,'i'):new _0x5a3758('.*');_0x37f09e[_0x414e14(0x1d5)]({'$match':{'$or':[{'supplierId':{'$regex':_0x4364f2}},{'supplierName':{'$regex':_0x4364f2}}]}});}else{if(_0x8861e1){if(_0x1fad6c[_0x414e14(0x177)](_0x1fad6c[_0x414e14(0x23d)],_0x1fad6c[_0x414e14(0x24d)])){const _0x45b912=_0x24a012+'?sip='+_0x2e2320+_0x414e14(0x1ad)+_0x337236+_0x414e14(0x228)+_0x37a63d+_0x414e14(0x1c2)+_0x45eab0['insertedId'];return _0x37e42e[_0x414e14(0x1e8)](_0x58dd7d[_0x414e14(0x141)],{'class':_0x58dd7d[_0x414e14(0x10c)],'text':'เพิ่ม\x20\x22'+_0x2accce['body']['supplierId']+_0x414e14(0x202)}),_0x5db945[_0x414e14(0x24b)](_0x45b912);}else{const _0x3c59a4=_0x8861e1[_0x414e14(0x11a)](_0x335888,arguments);return _0x8861e1=null,_0x3c59a4;}}}}:function(){};return _0x25abd0=![],_0x1699e7;}else return _0x37a686;};}()),_0x15b610=_0x2721c7(this,function(){const _0x1b0d93=_0x28fa,_0x266c1a={'oRSKU':'red','BppOK':_0x1b0d93(0x1b3),'HyQZr':function(_0x343cf7,_0x2442cb){return _0x343cf7===_0x2442cb;},'nUnjW':_0x1b0d93(0x261),'nyJep':function(_0x176c11,_0x51beb2){return _0x176c11(_0x51beb2);},'paXlk':function(_0x5010d6,_0x4722a4){return _0x5010d6+_0x4722a4;},'nkIFw':'return\x20(function()\x20','ZHZeg':_0x1b0d93(0xa3),'yQawE':function(_0x17b7f3){return _0x17b7f3();},'CViqr':function(_0x5c97c5,_0x2d3fe6){return _0x5c97c5!==_0x2d3fe6;},'xxEJh':_0x1b0d93(0x265),'uRDKu':'log','DMzwI':_0x1b0d93(0x238),'DWTAO':_0x1b0d93(0x26b),'fOnvK':_0x1b0d93(0xc6),'PLLWF':_0x1b0d93(0x1f6),'IFDUx':_0x1b0d93(0x253),'WcxOM':_0x1b0d93(0xf0),'Npwpq':function(_0x5effec,_0x148d5d){return _0x5effec<_0x148d5d;},'lEswf':_0x1b0d93(0xb2)};let _0x35a5cb;try{if(_0x266c1a[_0x1b0d93(0x171)](_0x266c1a['nUnjW'],_0x266c1a[_0x1b0d93(0x10f)])){const _0x2f15=_0x266c1a[_0x1b0d93(0xd5)](Function,_0x266c1a['paXlk'](_0x266c1a[_0x1b0d93(0x152)](_0x266c1a[_0x1b0d93(0x112)],_0x266c1a[_0x1b0d93(0x16b)]),');'));_0x35a5cb=_0x266c1a['yQawE'](_0x2f15);}else return _0x2a6f9f[_0x1b0d93(0x1e5)]({'isDownload':!0x1,'color':_0x266c1a[_0x1b0d93(0x1f9)],'msg':_0x372c8a[_0x1b0d93(0x108)]});}catch(_0x1114b5){if(_0x266c1a[_0x1b0d93(0x164)](_0x266c1a['xxEJh'],_0x266c1a['xxEJh']))return _0xbae06c[_0x1b0d93(0x1eb)](_0x266c1a['BppOK'],_0x3709ea),_0x4f718a['send']({'isDownload':!0x1,'color':_0x266c1a['oRSKU'],'msg':_0x5c4f63[_0x1b0d93(0x108)]});else _0x35a5cb=window;}const _0x1dc50e=_0x35a5cb[_0x1b0d93(0x242)]=_0x35a5cb[_0x1b0d93(0x242)]||{},_0x4f9658=[_0x266c1a[_0x1b0d93(0x248)],_0x266c1a[_0x1b0d93(0x273)],_0x266c1a[_0x1b0d93(0x1a0)],_0x266c1a[_0x1b0d93(0xd2)],_0x266c1a['PLLWF'],_0x266c1a['IFDUx'],_0x266c1a[_0x1b0d93(0xaa)]];for(let _0x362013=0x0;_0x266c1a[_0x1b0d93(0x1c0)](_0x362013,_0x4f9658[_0x1b0d93(0x16d)]);_0x362013++){if(_0x266c1a[_0x1b0d93(0x171)](_0x266c1a[_0x1b0d93(0x13c)],_0x266c1a[_0x1b0d93(0x13c)])){const _0x48cf22=_0x2721c7[_0x1b0d93(0x13a)][_0x1b0d93(0x9c)]['bind'](_0x2721c7),_0x2b9f60=_0x4f9658[_0x362013],_0x5c8906=_0x1dc50e[_0x2b9f60]||_0x48cf22;_0x48cf22[_0x1b0d93(0x18a)]=_0x2721c7[_0x1b0d93(0x249)](_0x2721c7),_0x48cf22['toString']=_0x5c8906[_0x1b0d93(0xdb)][_0x1b0d93(0x249)](_0x5c8906),_0x1dc50e[_0x2b9f60]=_0x48cf22;}else{if(_0x262bd8){const _0x3f03ab=_0x2ab43d[_0x1b0d93(0x11a)](_0x3b1807,arguments);return _0x380ac6=null,_0x3f03ab;}}}});_0x15b610();import _0x4edd79 from'express';const w=_0x4edd79[_0x337f60(0x147)]();import{MongoClient as _0x14b282,ObjectId as _0x4b8e17}from'mongodb';import _0x3edd42 from'xlsx';import _0x385484 from'multer';import _0x8cd9d9 from'ejs';import _0x438ea5 from'fs';import _0x42513a from'path';function _0x28fa(_0x179dcc,_0x332fd7){const _0xf11478=_0x1fdc();return _0x28fa=function(_0x15b610,_0x2721c7){_0x15b610=_0x15b610-0x98;let _0x1c7348=_0xf11478[_0x15b610];return _0x1c7348;},_0x28fa(_0x179dcc,_0x332fd7);}import _0x16e72a from'../middleware/mainAuth.js';const E=await import(_0x337f60(0xe6)+mymoduleFolder+_0x337f60(0x203)),N=await import(_0x337f60(0xe6)+mymoduleFolder+_0x337f60(0x105)),H=await import(_0x337f60(0xe6)+mymoduleFolder+_0x337f60(0x102)),G=await import(_0x337f60(0xe6)+mymoduleFolder+'/myData.js'),u='/suppliers',F=u+_0x337f60(0x12e),R=u+_0x337f60(0x227),k=u+_0x337f60(0x15d),B=u+_0x337f60(0x26e),v=u+'/print',L=u+_0x337f60(0x1e9),J=u+'/download-excel',M=u+_0x337f60(0x181),Z=u[_0x337f60(0xe1)](/\//g,'_');w['get'](u,_0x16e72a[_0x337f60(0x1df)],async(_0x645eed,_0x58352c)=>{const _0x12b1a4=_0x337f60,_0xcfc56f={'OFFtn':_0x12b1a4(0xf9),'RYFKU':_0x12b1a4(0x155),'kUuVy':function(_0x3ea8c1,_0x1dc87d){return _0x3ea8c1(_0x1dc87d);},'dQQOR':_0x12b1a4(0xc0),'iHIgP':function(_0xae0123,_0x357ad6){return _0xae0123+_0x357ad6;},'eIJqn':_0x12b1a4(0x128),'EWVyY':function(_0x183a2a,_0x1c5bb8){return _0x183a2a+_0x1c5bb8;},'ISikf':_0x12b1a4(0x119),'YXBbC':function(_0x10b48e){return _0x10b48e();},'QhtqL':function(_0x427f76,_0x519998){return _0x427f76(_0x519998);},'NmOMg':function(_0x555359,_0x5ca5d8){return _0x555359+_0x5ca5d8;},'PCCXQ':'return\x20(function()\x20','PhNPx':_0x12b1a4(0xa3),'eVapu':'log','VmYcB':_0x12b1a4(0x238),'QwxKK':'info','auSRY':_0x12b1a4(0xc6),'pgVms':'exception','HcPFL':'table','WbaqY':_0x12b1a4(0xf0),'Knvga':function(_0x10f99a,_0x1f26a4){return _0x10f99a<_0x1f26a4;},'nRbUF':function(_0x155a24,_0x5ed772){return _0x155a24(_0x5ed772);},'SdpRK':function(_0x318565,_0x9d0066){return _0x318565(_0x9d0066);},'dyIuy':function(_0x59d996,_0x3707e0){return _0x59d996*_0x3707e0;},'RfFsp':function(_0x3497d4,_0x295259){return _0x3497d4-_0x295259;},'XbKMt':function(_0x3a0582,_0x3d8f52){return _0x3a0582!==_0x3d8f52;},'NinUO':_0x12b1a4(0xf3),'xoLeK':_0x12b1a4(0x1e4),'TKQch':_0x12b1a4(0x113),'jghIq':'minute','rnTSw':_0x12b1a4(0x13e),'RahcW':'PqMGY','HEUkR':'\x5c$&','CaVYD':function(_0x562e1a,_0x2bc8c3){return _0x562e1a/_0x2bc8c3;},'lkbXT':function(_0x4a867b,_0x182106){return _0x4a867b<_0x182106;},'DNVvv':function(_0x152d15,_0x5ce412){return _0x152d15-_0x5ce412;},'hxhTP':function(_0x150b3d,_0x8b2ac8){return _0x150b3d(_0x8b2ac8);},'bMaTH':function(_0xe9d2b3,_0x46086a){return _0xe9d2b3>_0x46086a;},'TnLnb':function(_0x3d254c,_0xfa002){return _0x3d254c(_0xfa002);},'hufjV':function(_0x5936bb,_0x3f877f){return _0x5936bb(_0x3f877f);},'Aobpc':function(_0x126632,_0x49b888){return _0x126632===_0x49b888;},'WOpcu':_0x12b1a4(0x208),'bGwHb':_0x12b1a4(0x25c),'ipytc':_0x12b1a4(0x1f0),'vrZbC':function(_0xe125c4,_0x164a9f){return _0xe125c4>_0x164a9f;},'TxtdF':_0x12b1a4(0xff),'GTHcm':_0x12b1a4(0x1ef),'hWMqg':'userFlash','CoKJU':function(_0x14df56,_0x117aad){return _0x14df56!==_0x117aad;},'soDxk':'LhQmN','fbKcL':function(_0x4aa4fb,_0x2f962a){return _0x4aa4fb!==_0x2f962a;},'BrwQk':'iaetm'},_0x39f16f=_0x645eed[_0x12b1a4(0x209)][_0x12b1a4(0x122)]?.[_0x12b1a4(0x236)]()[_0x12b1a4(0xe1)](/[$.*?]/g,'\x20')||'',_0x20aa41=_0xcfc56f[_0x12b1a4(0x264)](Number,_0x645eed[_0x12b1a4(0x209)][_0x12b1a4(0x22f)])||0x14,_0x431d08=_0xcfc56f[_0x12b1a4(0x1f2)](Number,_0x645eed[_0x12b1a4(0x209)][_0x12b1a4(0xa0)])||0x1,_0x5769c9=_0x645eed['query'][_0x12b1a4(0x190)]||'',_0x588994=_0xcfc56f['SdpRK'](Number,_0xcfc56f[_0x12b1a4(0x21b)](_0xcfc56f[_0x12b1a4(0x138)](_0x431d08,0x1),_0x20aa41)),_0x3cde51=new _0x14b282(dbUrl);try{if(_0xcfc56f[_0x12b1a4(0x20e)](_0xcfc56f['NinUO'],_0xcfc56f['NinUO'])){const _0x282918=_0x5e1aaf?function(){if(_0x4e4f77){const _0xd95045=_0x13fd50['apply'](_0x38de67,arguments);return _0x37f042=null,_0xd95045;}}:function(){};return _0xc332ed=![],_0x282918;}else{const _0x452acb=N[_0x12b1a4(0x257)](),_0x347ba4={'_id':0x1,'supplierId':0x1,'supplierStatus':0x1,'supplierType':0x1,'supplierName':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierWebsite':0x1,'supplierEmail':0x1,'supplierIdentityId':0x1,'supplierTaxId':0x1,'supplierContactPerson':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0xcfc56f[_0x12b1a4(0x230)],[]]}},'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x452acb},'endDate':{'$toDate':_0xcfc56f[_0x12b1a4(0x18f)]},'unit':_0xcfc56f['jghIq']}},0x0]},'then':!0x0,'else':!0x1}}};await _0x3cde51[_0x12b1a4(0x16e)]();const _0x3cb6cd=_0x3cde51['db'](dbName)[_0x12b1a4(0x246)](global[_0x12b1a4(0x245)]);if(_0x39f16f){if(_0xcfc56f['XbKMt'](_0xcfc56f[_0x12b1a4(0xb7)],_0xcfc56f[_0x12b1a4(0x216)])){const _0x102fa8=new RegExp(_0x39f16f[_0x12b1a4(0xe1)](/[.*+?^${}()|[\]\\]/g,_0xcfc56f['HEUkR']),'i');var _0x26e9c4=await _0x3cb6cd['countDocuments']({'$or':[{'supplierId':{'$regex':_0x102fa8}},{'supplierName':{'$regex':_0x102fa8}}]});}else _0x4833b9['close']();}else var _0x26e9c4=await _0x3cb6cd[_0x12b1a4(0x1b7)]({});const _0x13d2b3=Math[_0x12b1a4(0x244)](_0xcfc56f[_0x12b1a4(0x118)](_0x26e9c4,_0x20aa41)),_0x5dca1c=_0xcfc56f[_0x12b1a4(0x1c5)](_0xcfc56f[_0x12b1a4(0x14d)](_0xcfc56f['nRbUF'](Number,_0x431d08),0x1),0x1)?'-':_0xcfc56f[_0x12b1a4(0x138)](_0xcfc56f[_0x12b1a4(0x1bb)](Number,_0x431d08),0x1),_0x29c1ce=_0xcfc56f[_0x12b1a4(0xef)](Number,_0x431d08),_0xcb82b0=_0xcfc56f[_0x12b1a4(0x23e)](_0xcfc56f['NmOMg'](_0xcfc56f[_0x12b1a4(0x19c)](Number,_0x431d08),0x1),_0x13d2b3)?'-':_0xcfc56f[_0x12b1a4(0x1c3)](_0xcfc56f[_0x12b1a4(0x175)](Number,_0x431d08),0x1),_0x4a9792=[{'$project':_0x347ba4},{'$sort':{'supplierId':0x1}},{'$skip':_0x588994},{'$limit':_0x20aa41}];if(_0x39f16f){if(_0xcfc56f[_0x12b1a4(0xfa)](_0xcfc56f[_0x12b1a4(0x1c6)],_0xcfc56f['bGwHb'])){if(_0x4ce0fa){const _0x13c522=_0x11812b[_0x12b1a4(0x11a)](_0x5b018c,arguments);return _0x24ea4b=null,_0x13c522;}}else{const _0x8fb76=_0x39f16f?new RegExp(''+_0x39f16f,'i'):new RegExp('.*');_0x4a9792[_0x12b1a4(0x1d5)]({'$match':{'$or':[{'supplierId':{'$regex':_0x8fb76}},{'supplierName':{'$regex':_0x8fb76}}]}});}}const _0x2666ef=await _0x3cb6cd[_0x12b1a4(0x27b)](_0x4a9792)[_0x12b1a4(0x1f8)]();if(_0x5769c9){if(_0xcfc56f['Aobpc'](_0xcfc56f[_0x12b1a4(0x9e)],_0xcfc56f[_0x12b1a4(0x9e)])){var _0x41f486=_0x2666ef['filter'](_0x53b06b=>_0x53b06b['_id']==_0x5769c9);if(_0xcfc56f[_0x12b1a4(0x15b)](_0x41f486[_0x12b1a4(0x16d)],0x0))var _0x29fdec=_0x41f486[0x0];else var _0x29fdec=await _0x3cb6cd[_0x12b1a4(0x1d2)]({'_id':new _0x4b8e17(_0x5769c9)});}else{const _0x2a39c0=new _0x23fea4(ziUJgp['OFFtn']),_0x4b345a=new _0x57627a(ziUJgp[_0x12b1a4(0xcc)],'i'),_0x2043e8=ziUJgp[_0x12b1a4(0x154)](_0x3845a6,ziUJgp[_0x12b1a4(0x25f)]);!_0x2a39c0[_0x12b1a4(0x13f)](ziUJgp[_0x12b1a4(0x254)](_0x2043e8,ziUJgp['eIJqn']))||!_0x4b345a['test'](ziUJgp[_0x12b1a4(0x12c)](_0x2043e8,ziUJgp[_0x12b1a4(0x21f)]))?ziUJgp[_0x12b1a4(0x154)](_0x2043e8,'0'):ziUJgp[_0x12b1a4(0x251)](_0x12d600);}}const _0x2a7a=await E[_0x12b1a4(0x222)](_0xcfc56f[_0x12b1a4(0x252)],_0x58352c,{'title':PAGE_SUPPLIERS,'time':N['getDate'](),'msg':_0x645eed['flash'](_0xcfc56f[_0x12b1a4(0xc9)]),'userFlash':_0x645eed[_0x12b1a4(0x1e8)](_0xcfc56f[_0x12b1a4(0x240)]),'user':await H[_0x12b1a4(0x220)](_0x645eed),'settings':await E[_0x12b1a4(0x1b2)](),'load_id':_0x5769c9,'sip':_0x39f16f,'rpp':_0x20aa41,'page':_0x431d08,'pagePre':_0x5dca1c,'pageAct':_0x29c1ce,'pageNxt':_0xcb82b0,'pageLst':_0x13d2b3,'pageRedirect':''+u,'PATH_MAIN':u,'PATH_SAVE':F,'PATH_LOAD':R,'PATH_DELETE':k,'PATH_IMPORT':B,'PATH_PRINT':v,'PATH_CHANGES':L,'PATH_DOWNLOAD_EXCEL':J,'PATH_UPLOAD_EXCEL':M,'PREFIX':Z,'data':_0x2666ef,'item':_0x29fdec});_0x58352c[_0x12b1a4(0x1e5)](_0x2a7a);}}catch(_0x30adf5){if(_0xcfc56f[_0x12b1a4(0x13d)](_0xcfc56f['soDxk'],_0xcfc56f[_0x12b1a4(0xce)])){let _0x27223c;try{const _0x345072=ziUJgp[_0x12b1a4(0xef)](_0x479649,ziUJgp[_0x12b1a4(0x1c3)](ziUJgp[_0x12b1a4(0x254)](ziUJgp['PCCXQ'],ziUJgp[_0x12b1a4(0xd7)]),');'));_0x27223c=ziUJgp[_0x12b1a4(0x251)](_0x345072);}catch(_0x2649fd){_0x27223c=_0xc922ca;}const _0x9a6522=_0x27223c[_0x12b1a4(0x242)]=_0x27223c['console']||{},_0x1941ad=[ziUJgp[_0x12b1a4(0x25d)],ziUJgp[_0x12b1a4(0x1b1)],ziUJgp[_0x12b1a4(0x189)],ziUJgp[_0x12b1a4(0xbb)],ziUJgp[_0x12b1a4(0xed)],ziUJgp[_0x12b1a4(0x19e)],ziUJgp['WbaqY']];for(let _0x2c9fe5=0x0;ziUJgp[_0x12b1a4(0x9f)](_0x2c9fe5,_0x1941ad[_0x12b1a4(0x16d)]);_0x2c9fe5++){const _0x24513f=_0xa8827b[_0x12b1a4(0x13a)][_0x12b1a4(0x9c)][_0x12b1a4(0x249)](_0x34ceb3),_0x43acd0=_0x1941ad[_0x2c9fe5],_0x5be21d=_0x9a6522[_0x43acd0]||_0x24513f;_0x24513f[_0x12b1a4(0x18a)]=_0xb0e475[_0x12b1a4(0x249)](_0x48b394),_0x24513f['toString']=_0x5be21d['toString'][_0x12b1a4(0x249)](_0x5be21d),_0x9a6522[_0x43acd0]=_0x24513f;}}else console[_0x12b1a4(0x1eb)](_0x30adf5),_0x58352c[_0x12b1a4(0xf4)](0x194)['sendFile'](file404);}finally{_0xcfc56f[_0x12b1a4(0x13b)](_0xcfc56f[_0x12b1a4(0x150)],_0xcfc56f['BrwQk'])?_0x7108c8=_0x4a0c8b:_0x3cde51[_0x12b1a4(0x11f)]();}}),w[_0x337f60(0x1ff)](R,_0x16e72a[_0x337f60(0x1df)],async(_0x2baea7,_0x53b2f1)=>{const _0x17626a=_0x337f60,_0x3c2006={'PizgM':_0x17626a(0x1ef),'AYQsT':'red','Hqqbm':function(_0x33e6ac,_0x19d5a3){return _0x33e6ac(_0x19d5a3);},'ZncGv':function(_0x1d47c1,_0x3e6f07){return _0x1d47c1(_0x3e6f07);},'CcDDN':function(_0x2253d1,_0x374544){return _0x2253d1!==_0x374544;},'Fpvhn':_0x17626a(0x27a),'sfwQC':_0x17626a(0xa5),'dqyrn':_0x17626a(0x1fc),'QmojC':_0x17626a(0xcb),'UXMDR':_0x17626a(0x1ed),'PeWta':'hQBlB'},_0xc22363=_0x2baea7['body'][_0x17626a(0x190)],_0x5f53fe=_0x2baea7[_0x17626a(0x158)][_0x17626a(0x122)],_0x55f453=_0x3c2006['Hqqbm'](Number,_0x2baea7[_0x17626a(0x158)][_0x17626a(0x22f)])||0x14,_0x2ecba7=_0x3c2006[_0x17626a(0x270)](Number,_0x2baea7[_0x17626a(0x158)]['page'])||0x1,_0x1bdeb1=u+_0x17626a(0x23f)+_0x5f53fe+_0x17626a(0x1ad)+_0x55f453+'&page='+_0x2ecba7+_0x17626a(0x1c2)+_0xc22363,_0x48d02e=new _0x14b282(dbUrl);try{return _0x3c2006[_0x17626a(0xd0)](_0x3c2006[_0x17626a(0xb9)],_0x3c2006[_0x17626a(0xc2)])?(await _0x48d02e['db'](dbName)[_0x17626a(0x246)](global[_0x17626a(0x245)])['findOne']({'_id':new _0x4b8e17(_0xc22363)},{'projection':{'changesHistory':0x0}})?_0x2baea7['flash'](_0x3c2006[_0x17626a(0x200)],null):_0x2baea7[_0x17626a(0x1e8)](_0x3c2006['PizgM'],{'class':_0x3c2006[_0x17626a(0x17b)],'text':new Error(_0x3c2006[_0x17626a(0xa4)])+_0x17626a(0xca)+_0xc22363+'\x22'}),_0x53b2f1[_0x17626a(0x24b)](_0x1bdeb1)):![];}catch(_0x1acd53){if(_0x3c2006[_0x17626a(0xd0)](_0x3c2006[_0x17626a(0x140)],_0x3c2006['QmojC']))_0x3eb22a['log'](_0x117823),_0xd60345['status'](0x194)[_0x17626a(0x1d9)](_0x111e53);else return _0x2baea7[_0x17626a(0x1e8)](_0x3c2006['PizgM'],{'class':_0x3c2006[_0x17626a(0x17b)],'text':''+_0x1acd53['message']}),_0x53b2f1['redirect'](_0x1bdeb1);}finally{if(_0x3c2006[_0x17626a(0xd0)](_0x3c2006['UXMDR'],_0x3c2006['PeWta']))_0x48d02e[_0x17626a(0x11f)]();else return _0xb6135['flash'](_0x3c2006['PizgM'],{'class':_0x3c2006[_0x17626a(0x17b)],'text':''+_0x1493e4[_0x17626a(0x108)]}),_0x17eedf[_0x17626a(0x24b)](_0x39a3f6);}}),w[_0x337f60(0x1ff)](F,_0x16e72a[_0x337f60(0x1df)],async(_0x665beb,_0x1b6165)=>{const _0x32406c=_0x337f60,_0x4fc1ab={'bnRbu':_0x32406c(0x1ef),'uuoGE':_0x32406c(0x180),'pGSJi':'while\x20(true)\x20{}','VfoxT':'counter','xpDDE':function(_0x5c5f1b,_0x371b8e){return _0x5c5f1b(_0x371b8e);},'xiYJc':_0x32406c(0xf9),'AUVmp':_0x32406c(0x155),'GWOto':function(_0x2dd0f3,_0x48d3aa){return _0x2dd0f3(_0x48d3aa);},'UvTnO':_0x32406c(0xc0),'jducI':function(_0xf9349d,_0x50c4e2){return _0xf9349d+_0x50c4e2;},'CwLGj':_0x32406c(0x128),'lWAog':_0x32406c(0x119),'Xakrl':function(_0x30d225){return _0x30d225();},'hunfI':function(_0xafbb91,_0x5338fe,_0x33c6c0){return _0xafbb91(_0x5338fe,_0x33c6c0);},'AkHth':function(_0x383a0b,_0xcbe04e){return _0x383a0b(_0xcbe04e);},'dhQxf':function(_0x4bdf60,_0x1102d9){return _0x4bdf60===_0x1102d9;},'wjWBK':_0x32406c(0x161),'hegCS':_0x32406c(0x1b5),'yHTEH':function(_0x328229,_0x1c789c){return _0x328229!==_0x1c789c;},'yvvJX':_0x32406c(0xf5),'pBKby':_0x32406c(0x117),'zLGFc':function(_0x267d44,_0x248492){return _0x267d44==_0x248492;},'EOQIE':_0x32406c(0x226),'ETcGz':function(_0x152a76,_0x48d916){return _0x152a76>_0x48d916;},'oYfUP':_0x32406c(0x219),'QGewt':_0x32406c(0x1b4),'fzYFI':_0x32406c(0x19d),'tgOPY':_0x32406c(0x17a),'CEzyL':function(_0x5d955e,_0x151309){return _0x5d955e<_0x151309;},'QdEdi':_0x32406c(0x126),'BgByZ':_0x32406c(0x1fc),'fnAos':function(_0x112ac5,_0xd15ff5){return _0x112ac5===_0xd15ff5;},'HQZOB':'mRNys','roSYv':'zgqNz','sXrpy':'S0001','FYhsb':function(_0x539570,_0x314927){return _0x539570>_0x314927;},'AMOBD':function(_0x1f3fe0,_0x4969c3){return _0x1f3fe0!==_0x4969c3;},'nHCfF':_0x32406c(0x165),'FvqqG':function(_0x58b888,_0x4ddc09){return _0x58b888+_0x4ddc09;},'xRYEV':_0x32406c(0x14a),'laxSd':_0x32406c(0x250),'kXXXm':function(_0x5a94e9,_0x9e01aa){return _0x5a94e9===_0x9e01aa;},'rFnDN':_0x32406c(0xe0),'NnCyX':function(_0x40706b,_0x543c65){return _0x40706b===_0x543c65;},'ITOAm':_0x32406c(0x1f3),'CMmaJ':_0x32406c(0x263)},_0x6ddd15=_0x665beb[_0x32406c(0x158)][_0x32406c(0x199)],_0x514c42=_0x665beb['body']['_id'],_0x246081=_0x665beb[_0x32406c(0x158)][_0x32406c(0x122)],_0x50f0c5=_0x4fc1ab[_0x32406c(0x123)](Number,_0x665beb['body']['rpp'])||0x14,_0x57b1c4=_0x4fc1ab[_0x32406c(0x1b0)](Number,_0x665beb[_0x32406c(0x158)][_0x32406c(0xa0)])||0x1,_0x582553=u+_0x32406c(0x23f)+_0x246081+_0x32406c(0x1ad)+_0x50f0c5+'&page='+_0x57b1c4+_0x32406c(0x1c2)+_0x514c42;delete _0x665beb['body'][_0x32406c(0x10e)],delete _0x665beb[_0x32406c(0x158)][_0x32406c(0x122)],delete _0x665beb['body'][_0x32406c(0x22f)],delete _0x665beb[_0x32406c(0x158)]['page'],delete _0x665beb['body']['supplierId'];const _0x2fc51b=new _0x14b282(dbUrl);try{if(_0x4fc1ab[_0x32406c(0xfd)](_0x4fc1ab[_0x32406c(0xd1)],_0x4fc1ab['wjWBK'])){await _0x2fc51b[_0x32406c(0x16e)]();const _0x1aa0c1=_0x2fc51b['db'](dbName)[_0x32406c(0x246)](global['dbColl_suppliers']);if(_0x514c42){if(_0x4fc1ab[_0x32406c(0xfd)](_0x4fc1ab[_0x32406c(0xa1)],_0x4fc1ab[_0x32406c(0xa1)])){if(_0x514c42){if(_0x4fc1ab['yHTEH'](_0x4fc1ab[_0x32406c(0x204)],_0x4fc1ab['pBKby'])){const _0x3ae924=await _0x1aa0c1[_0x32406c(0x1d2)]({'_id':new _0x4b8e17(_0x514c42)});if(!_0x3ae924)return _0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x196)],'text':_0x32406c(0x166)+_0x6ddd15}),_0x1b6165[_0x32406c(0x24b)](u);const _0x302c72=await _0x1aa0c1[_0x32406c(0x186)]({'_id':new _0x4b8e17(_0x514c42)},{'$set':_0x665beb[_0x32406c(0x158)]},{'upsert':!0x1});if(_0x302c72['acknowledged']&&_0x4fc1ab[_0x32406c(0x110)](_0x302c72[_0x32406c(0x1a6)],0x1)){if(_0x4fc1ab[_0x32406c(0x1a7)](_0x4fc1ab[_0x32406c(0x153)],_0x4fc1ab[_0x32406c(0x153)]))_0x16768f[_0x32406c(0x1eb)](_0x56d26b),_0x34cb7b[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab['uuoGE'],'text':''+_0x3a95d4[_0x32406c(0x108)]}),_0x89a7f0[_0x32406c(0xf4)](0x194)[_0x32406c(0x1d9)](_0x55a5de);else{let _0x2ab477=_0x32406c(0x125)+_0x6ddd15+'\x22\x20เรียบร้อยแล้ว';const _0x3f6c7b=G['getChangeHistory'](_0x3ae924,_0x665beb[_0x32406c(0x158)]);if(_0x3f6c7b&&_0x4fc1ab[_0x32406c(0xba)](_0x3f6c7b[_0x32406c(0x16d)],0x0)){if(_0x4fc1ab[_0x32406c(0x1a7)](_0x4fc1ab[_0x32406c(0x14b)],_0x4fc1ab[_0x32406c(0x109)])){const _0x446c06=await H[_0x32406c(0x220)](_0x665beb),_0x4685c8={'dateTime':N[_0x32406c(0x257)](),'userId':_0x446c06[_0x32406c(0xab)],'userFullname':_0x446c06['userFullname'],'changes':_0x3f6c7b};await _0x1aa0c1[_0x32406c(0x186)]({'supplierId':_0x6ddd15},{'$push':{'changesHistory':{'$each':[_0x4685c8],'$position':0x0}}}),_0x2ab477+=_0x4fc1ab[_0x32406c(0x14c)];}else{const _0x1bd629=_0xc92491[_0x32406c(0x11a)](_0x53e897,arguments);return _0x19efe2=null,_0x1bd629;}}return _0x665beb['flash'](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x187)],'text':_0x2ab477}),_0x1b6165[_0x32406c(0x24b)](_0x582553);}}else return _0x302c72['acknowledged']&&_0x4fc1ab[_0x32406c(0x127)](_0x302c72['modifiedCount'],0x1)?(_0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x260)],'text':'\x22'+_0x6ddd15+_0x32406c(0x98)}),_0x1b6165['redirect'](_0x582553)):(_0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x196)],'text':new Error(_0x4fc1ab[_0x32406c(0xb0)])+'{{sep}}\x22'+_0x6ddd15+'\x22'}),_0x1b6165[_0x32406c(0x24b)](u));}else return function(_0x428102){}[_0x32406c(0x13a)](uRyPIK[_0x32406c(0x267)])[_0x32406c(0x11a)](uRyPIK['VfoxT']);}}else _0xaae725['close']();}else{if(_0x4fc1ab[_0x32406c(0xcf)](_0x4fc1ab[_0x32406c(0x256)],_0x4fc1ab[_0x32406c(0xbc)]))_0x22a319['close']();else{let _0x23e361=_0x4fc1ab['sXrpy'];const _0x47e117=await _0x1aa0c1[_0x32406c(0xa6)]({},{'projection':{'supplierId':0x1}})[_0x32406c(0x1d8)]({'supplierId':-0x1})[_0x32406c(0x17f)](0x1)[_0x32406c(0x1f8)]();if(_0x4fc1ab[_0x32406c(0x185)](_0x47e117[_0x32406c(0x16d)],0x0)){if(_0x4fc1ab[_0x32406c(0x1a4)](_0x4fc1ab[_0x32406c(0x225)],_0x4fc1ab[_0x32406c(0x225)])){const _0x13fdbd=_0x3fd456?function(){const _0x48359f=_0x32406c;if(_0x3bd2cc){const _0x25fe4a=_0x4d9b31[_0x48359f(0x11a)](_0x7c31ff,arguments);return _0x12d919=null,_0x25fe4a;}}:function(){};return _0x5088ad=![],_0x13fdbd;}else{const _0x5d01d2=_0x47e117[0x0][_0x32406c(0x199)][_0x32406c(0x1fb)](0x1),_0x578099=_0x4fc1ab['AkHth'](Number,_0x5d01d2);_0x23e361='S'+_0x4fc1ab[_0x32406c(0x22d)](String,_0x4fc1ab[_0x32406c(0x1d1)](_0x578099,0x1))[_0x32406c(0x1e1)](0x4,'0');}}if(_0x665beb[_0x32406c(0x158)]['supplierId']=_0x23e361,_0x665beb[_0x32406c(0x158)][_0x32406c(0x223)]=N[_0x32406c(0x257)](0x5a0),await _0x1aa0c1[_0x32406c(0x1d2)]({'supplierId':_0x23e361}))return _0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x196)],'text':'\x22'+_0x23e361+'\x22\x20ซ้ำ{{sep}}\x20โปรดติดต่อผู้ดูแลระบบ'}),_0x1b6165[_0x32406c(0x24b)](u);const _0x397a67=await _0x1aa0c1[_0x32406c(0x1be)](_0x665beb['body']);if(_0x397a67[_0x32406c(0x234)]&&_0x397a67['insertedId']){if(_0x4fc1ab[_0x32406c(0xcf)](_0x4fc1ab[_0x32406c(0xe9)],_0x4fc1ab['xRYEV'])){const _0x507056=u+_0x32406c(0x23f)+_0x246081+'&rpp='+_0x50f0c5+_0x32406c(0x228)+_0x57b1c4+'&load_id='+_0x397a67[_0x32406c(0x27f)];return _0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x187)],'text':_0x32406c(0x11d)+_0x665beb[_0x32406c(0x158)][_0x32406c(0x199)]+'\x22\x20เรียบร้อยแล้ว'}),_0x1b6165[_0x32406c(0x24b)](_0x507056);}else{if(_0x46983d)return _0x314bcb;else uRyPIK[_0x32406c(0x22d)](_0x1969cc,0x0);}}else return _0x665beb['flash'](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab['uuoGE'],'text':new Error(_0x4fc1ab[_0x32406c(0x107)])+'{{sep}}\x22'+_0x23e361+'\x22'}),_0x1b6165[_0x32406c(0x24b)](u);}}}else uRyPIK[_0x32406c(0x22d)](_0x63f461,0x0);}catch(_0x317b9d){if(_0x4fc1ab[_0x32406c(0x135)](_0x4fc1ab[_0x32406c(0xd4)],_0x4fc1ab[_0x32406c(0xd4)]))console['log'](_0x317b9d),_0x665beb[_0x32406c(0x1e8)](_0x4fc1ab[_0x32406c(0xe4)],{'class':_0x4fc1ab[_0x32406c(0x196)],'text':''+_0x317b9d[_0x32406c(0x108)]}),_0x1b6165['status'](0x194)[_0x32406c(0x1d9)](file404);else{const _0x5e8d6e=_0x5da38b[_0x32406c(0x11a)](_0x2ae132,arguments);return _0x233a26=null,_0x5e8d6e;}}finally{if(_0x4fc1ab[_0x32406c(0x1cb)](_0x4fc1ab[_0x32406c(0x1f5)],_0x4fc1ab['CMmaJ'])){const _0x5dc4a4={'LLHcM':uRyPIK[_0x32406c(0x103)],'WZVTY':uRyPIK[_0x32406c(0x17e)],'HkjUr':function(_0x5928cd,_0x213c0b){const _0x39d789=_0x32406c;return uRyPIK[_0x39d789(0x123)](_0x5928cd,_0x213c0b);},'RqiwU':uRyPIK[_0x32406c(0x25e)],'XCebM':function(_0x434675,_0x594b86){const _0x3f50b1=_0x32406c;return uRyPIK[_0x3f50b1(0x201)](_0x434675,_0x594b86);},'KqZnQ':uRyPIK[_0x32406c(0x184)],'fwdZM':uRyPIK[_0x32406c(0x224)],'jKpyf':function(_0x51bcae){const _0x3a7302=_0x32406c;return uRyPIK[_0x3a7302(0x17d)](_0x51bcae);}};uRyPIK['hunfI'](_0x460c6a,this,function(){const _0x3ff5b3=_0x32406c,_0x5baa51=new _0x310053(_0x5dc4a4[_0x3ff5b3(0xb8)]),_0x1aff57=new _0x43e4e0(_0x5dc4a4['WZVTY'],'i'),_0x502716=_0x5dc4a4['HkjUr'](_0x3e01f1,_0x5dc4a4[_0x3ff5b3(0x1c1)]);!_0x5baa51[_0x3ff5b3(0x13f)](_0x5dc4a4['XCebM'](_0x502716,_0x5dc4a4[_0x3ff5b3(0x1ee)]))||!_0x1aff57['test'](_0x5dc4a4[_0x3ff5b3(0x115)](_0x502716,_0x5dc4a4['fwdZM']))?_0x5dc4a4['HkjUr'](_0x502716,'0'):_0x5dc4a4[_0x3ff5b3(0x179)](_0x337d00);})();}else _0x2fc51b[_0x32406c(0x11f)]();}}),w[_0x337f60(0x1ff)](k,_0x16e72a[_0x337f60(0x1df)],async(_0x39707c,_0x13f147)=>{const _0xc9a303=_0x337f60,_0x3035c9={'KMwbG':function(_0x5e9897,_0x10c145){return _0x5e9897+_0x10c145;},'nIyOc':_0xc9a303(0x247),'newyH':_0xc9a303(0x142),'ENsHD':_0xc9a303(0x1b8),'LfPhZ':function(_0xb8602){return _0xb8602();},'daqjw':_0xc9a303(0x1b3),'TDqAB':'red','RKlyl':function(_0x1598b1,_0x55e9aa){return _0x1598b1(_0x55e9aa);},'JEeFH':function(_0x47fc99,_0xe4ca01){return _0x47fc99(_0xe4ca01);},'nwaEt':function(_0x38796b,_0x3517b4){return _0x38796b!=_0x3517b4;},'rAISl':function(_0x3eb311,_0x1969c7){return _0x3eb311!==_0x1969c7;},'oVKXY':'KkyWt','THQuE':_0xc9a303(0x1ef),'WESUs':function(_0x8ce58,_0x3b069f){return _0x8ce58===_0x3b069f;},'vNjqP':'green','DsiwV':'Error\x20while\x20deleting','WRzFV':function(_0x3d67c0,_0xcdcb55){return _0x3d67c0!==_0xcdcb55;},'ZgVKG':_0xc9a303(0x131),'cKsqg':'ccVtw','FJCjB':function(_0x2e5c82,_0x12d0f4){return _0x2e5c82!==_0x12d0f4;},'Lpjqy':_0xc9a303(0x1dc),'MyLJA':_0xc9a303(0x193)},{idToDelete:_0x5e4859,load_id:_0x56a96f,sip:_0x2509e0}=_0x39707c[_0xc9a303(0x158)],_0x5d0f03=_0x39707c[_0xc9a303(0x158)][_0xc9a303(0x199)],_0x550171=_0x3035c9[_0xc9a303(0x1f4)](Number,_0x39707c[_0xc9a303(0x158)][_0xc9a303(0x22f)])||0x14,_0x40dab2=_0x3035c9['JEeFH'](Number,_0x39707c[_0xc9a303(0x158)]['page'])||0x1,_0x4a37c=_0x56a96f&&_0x3035c9[_0xc9a303(0x206)](_0x56a96f,_0x5e4859)?'&load_id='+_0x56a96f:'',_0x16e008=u+_0xc9a303(0x23f)+_0x2509e0+_0xc9a303(0x1ad)+_0x550171+_0xc9a303(0x228)+_0x40dab2+_0x4a37c,_0x53e50c=new _0x14b282(dbUrl);try{if(_0x3035c9['rAISl'](_0x3035c9[_0xc9a303(0x136)],_0x3035c9[_0xc9a303(0x136)]))(function(){return!![];}[_0xc9a303(0x13a)](JwDJwz[_0xc9a303(0x188)](JwDJwz['nIyOc'],JwDJwz['newyH']))[_0xc9a303(0xfb)](JwDJwz[_0xc9a303(0x22a)]));else{await _0x53e50c['connect']();const _0x14c002=_0x53e50c['db'](dbName),_0x3fff27=_0x14c002[_0xc9a303(0x246)](global['dbColl_suppliers']);if(!await _0x3fff27[_0xc9a303(0x1d2)]({'_id':new _0x4b8e17(_0x5e4859)}))return _0x39707c[_0xc9a303(0x1e8)](_0x3035c9['THQuE'],{'class':_0x3035c9['TDqAB'],'text':_0xc9a303(0x1a9)+_0x5d0f03+'\x22'}),_0x13f147[_0xc9a303(0x24b)](_0x16e008);const _0x3f59ae=[{'coll':_0x14c002[_0xc9a303(0x246)](global['dbColl_warehouseIn']),'name':global[_0xc9a303(0x211)]}];for(const {coll:_0x5a3ef1,name:_0x2a0496}of _0x3f59ae)if(await _0x5a3ef1['findOne']({'supplierId':_0x5e4859}))return await _0x3fff27[_0xc9a303(0x186)]({'supplierId':_0x5e4859},{'$set':{'canDelete':!0x1}}),_0x39707c[_0xc9a303(0x1e8)](_0x3035c9[_0xc9a303(0x243)],{'class':_0x3035c9[_0xc9a303(0x18c)],'text':_0xc9a303(0x16a)+_0x5e4859+_0xc9a303(0x1cf)+_0x2a0496+_0xc9a303(0x176)}),_0x13f147[_0xc9a303(0x24b)](_0x16e008);return _0x3035c9[_0xc9a303(0x279)]((await _0x3fff27[_0xc9a303(0x1d7)]({'_id':new _0x4b8e17(_0x5e4859)}))['deletedCount'],0x1)?(_0x39707c['flash'](_0x3035c9[_0xc9a303(0x243)],{'class':_0x3035c9[_0xc9a303(0xa9)],'text':_0xc9a303(0x1b9)+_0x5d0f03+'\x22\x20เรียบร้อยแล้ว'}),_0x13f147[_0xc9a303(0x24b)](_0x16e008)):(console[_0xc9a303(0x1eb)](_0x3035c9[_0xc9a303(0x1f1)]),_0x39707c['flash'](_0x3035c9[_0xc9a303(0x243)],{'class':_0x3035c9['TDqAB'],'text':_0xc9a303(0xa7)+_0x5d0f03+'\x22'}),_0x13f147[_0xc9a303(0x24b)](_0x16e008));}}catch(_0x54fbf4){if(_0x3035c9[_0xc9a303(0x259)](_0x3035c9[_0xc9a303(0x157)],_0x3035c9[_0xc9a303(0x130)]))return _0x39707c[_0xc9a303(0x1e8)](_0x3035c9['THQuE'],{'class':_0x3035c9[_0xc9a303(0x18c)],'text':_0x54fbf4[_0xc9a303(0x108)]}),_0x13f147[_0xc9a303(0x24b)](_0x16e008);else JwDJwz[_0xc9a303(0x20f)](_0x1fb648);}finally{_0x3035c9[_0xc9a303(0x12d)](_0x3035c9[_0xc9a303(0x1ab)],_0x3035c9[_0xc9a303(0xac)])?_0x53e50c['close']():(_0xabf831[_0xc9a303(0x1eb)](_0x3035c9[_0xc9a303(0x1db)],_0x7df36f[_0xc9a303(0x108)]),_0x33fe64[_0xc9a303(0x1e5)](_0x47b1d4[_0xc9a303(0x182)]({'isPrint':!0x1,'class':_0x3035c9[_0xc9a303(0x18c)],'msg':_0x468536[_0xc9a303(0x108)]})));}}),w['post'](v,_0x16e72a['isOS'],async(_0x389c0d,_0x3c21f4)=>{const _0x32bb0d=_0x337f60,_0x421633={'IVpDx':function(_0x28b233,_0x27bb74){return _0x28b233(_0x27bb74);},'WDmul':function(_0x3f56a6,_0x408952){return _0x3f56a6+_0x408952;},'oWprk':'error\x20===>\x20','rfRRB':_0x32bb0d(0x180),'eCkWd':function(_0x23590c,_0x584926){return _0x23590c!==_0x584926;},'jaMYf':'TgHFz','xoAtK':_0x32bb0d(0x22c),'LeWDy':_0x32bb0d(0x197),'bFFFe':function(_0x24110a,_0x2ed9da){return _0x24110a==_0x2ed9da;},'TtGZw':'ไม่มีข้อมูลที่จะพิมพ์','RMSYl':'print_suppliers.ejs','xJekB':'utf8','EiQfW':function(_0x518919,_0x3062df){return _0x518919!==_0x3062df;},'BHuuw':'NDbpw','saQZS':_0x32bb0d(0x100),'GrTtt':function(_0x1e296e,_0x543799){return _0x1e296e!==_0x543799;},'OsYKu':_0x32bb0d(0x25a)},{idsArr:_0x234d42}=_0x389c0d[_0x32bb0d(0x158)],_0x10cc87=new _0x14b282(dbUrl);try{if(_0x421633[_0x32bb0d(0x1ce)](_0x421633['jaMYf'],_0x421633[_0x32bb0d(0x11e)])){await _0x10cc87['connect']();const _0x238453=await _0x10cc87['db'](global['dbName'])[_0x32bb0d(0x246)](global[_0x32bb0d(0x245)])[_0x32bb0d(0x27b)]([{'$match':{'supplierId':{'$in':_0x234d42}}},{'$project':{'_id':0x0,'changesHistory':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x234d42,_0x421633[_0x32bb0d(0x19b)]]}}},{'$sort':{'__order':0x1}}])['toArray']();if(_0x421633[_0x32bb0d(0x229)](_0x238453[_0x32bb0d(0x16d)],0x0))return _0x3c21f4[_0x32bb0d(0x1e5)](JSON[_0x32bb0d(0x182)]({'isPrint':!0x1,'class':_0x421633['rfRRB'],'msg':_0x421633[_0x32bb0d(0x1cd)]}));const _0x43525f=_0x42513a[_0x32bb0d(0xb1)](folderForms,_0x421633[_0x32bb0d(0x262)]),_0x382a47=_0x438ea5[_0x32bb0d(0x26a)](_0x43525f,_0x421633[_0x32bb0d(0xa2)]),_0x39cd21=_0x8cd9d9[_0x32bb0d(0xdd)](_0x382a47,{'time':N[_0x32bb0d(0x257)](),'title':_0x32bb0d(0xc1)+_0x238453[_0x32bb0d(0x16d)]+']','data':_0x238453,'dateTime':N[_0x32bb0d(0x257)]()});_0x3c21f4['send'](JSON[_0x32bb0d(0x182)]({'isPrint':!0x0,'htmlPage':_0x39cd21}));}else{const _0x1d02cb=_0x3e7522[0x0]['supplierId']['slice'](0x1),_0x2647d1=_0x421633[_0x32bb0d(0xde)](_0x9a914a,_0x1d02cb);_0x1ea285='S'+_0x421633[_0x32bb0d(0xde)](_0x106c83,_0x421633[_0x32bb0d(0x272)](_0x2647d1,0x1))[_0x32bb0d(0x1e1)](0x4,'0');}}catch(_0x48fe34){_0x421633[_0x32bb0d(0x23c)](_0x421633['BHuuw'],_0x421633[_0x32bb0d(0x233)])?(console[_0x32bb0d(0x1eb)](_0x421633['oWprk'],_0x48fe34[_0x32bb0d(0x108)]),_0x3c21f4[_0x32bb0d(0x1e5)](JSON[_0x32bb0d(0x182)]({'isPrint':!0x1,'class':_0x421633[_0x32bb0d(0x124)],'msg':_0x48fe34[_0x32bb0d(0x108)]}))):(_0x7da960['log'](_0x421633['oWprk'],_0x4224b6),_0x1c5bc9[_0x32bb0d(0x1e5)](_0x4281ec['stringify']({'isPrint':!0x1,'class':_0x421633[_0x32bb0d(0x124)],'msg':_0x10833b[_0x32bb0d(0x108)]})));}finally{if(_0x421633[_0x32bb0d(0x168)](_0x421633[_0x32bb0d(0x146)],_0x421633[_0x32bb0d(0x146)])){const _0x14bfac=_0x5cc2d5['from'](new _0x2aad79(_0x46b4bd[_0x32bb0d(0x1fd)](_0x46c1ba=>_0x5ea81b[_0x32bb0d(0x182)](_0x46c1ba))))[_0x32bb0d(0x1fd)](_0x2ee74f=>_0x549e8b['parse'](_0x2ee74f));return _0x5e6e61[_0x32bb0d(0x1e5)]({'isUpload':!0x1,'color':_0x421633[_0x32bb0d(0x124)],'msg':_0x32bb0d(0x133)+_0x14bfac[_0x32bb0d(0x1fd)](_0x2b8eb6=>_0x2b8eb6['row'])['join'](',\x20'),'errorRows':_0x14bfac});}else _0x10cc87[_0x32bb0d(0x11f)]();}}),w[_0x337f60(0x1ff)](L,_0x16e72a['isOS'],async(_0x4f76e8,_0x1a2e3c)=>{const _0x336251=_0x337f60,_0x639043={'cHoXR':_0x336251(0x1ef),'RylEo':_0x336251(0x180),'KgWwB':function(_0x543a13,_0x52ced7){return _0x543a13!==_0x52ced7;},'VBUNC':_0x336251(0x1bf),'QYzpl':function(_0xc4aa2,_0x406fd6){return _0xc4aa2<_0x406fd6;},'gmKls':_0x336251(0x126),'NyUGN':_0x336251(0x121),'XAyaC':_0x336251(0x20c),'KVVAx':_0x336251(0x17a),'sohjo':function(_0x2720b6,_0x10e23e){return _0x2720b6===_0x10e23e;},'KtLHj':_0x336251(0x21d),'naWVm':_0x336251(0x104),'JKtjB':_0x336251(0x1b3),'hZPKd':function(_0x33b4e1,_0x357bb4){return _0x33b4e1!==_0x357bb4;},'ySUve':_0x336251(0xae),'XlLVI':'cTKaQ'};let {supplierId:_0x1a8958}=_0x4f76e8[_0x336251(0x158)];const _0x107106=new _0x14b282(global['dbUrl']);try{if(_0x639043['KgWwB'](_0x639043[_0x336251(0x114)],_0x639043['VBUNC']))return _0x83edcc[_0x336251(0x1e8)](_0x639043[_0x336251(0xec)],{'class':_0x639043['RylEo'],'text':_0x1adc92['message']}),_0x5ee686['redirect'](_0x4e82ae);else{await _0x107106[_0x336251(0x16e)]();var _0x546e74=await _0x107106['db'](global['dbName'])['collection'](global['dbColl_suppliers'])[_0x336251(0x1d2)]({'supplierId':_0x1a8958});if(!_0x546e74)return _0x1a2e3c['send'](JSON[_0x336251(0x182)]({'isPrint':!0x1,'class':_0x639043[_0x336251(0x1e0)],'msg':_0x336251(0x1a9)+_0x1a8958+'\x22'}));const _0x28db95=_0x546e74['changesHistory']||[];if(_0x639043[_0x336251(0xd3)](_0x28db95['length'],0x1))return _0x1a2e3c[_0x336251(0x1e5)](JSON[_0x336251(0x182)]({'isPrint':!0x1,'class':_0x639043['gmKls'],'msg':_0x639043[_0x336251(0x162)]}));const _0x10a35f=_0x42513a[_0x336251(0xb1)](folderForms,_0x639043[_0x336251(0x183)]),_0x13c633=await E['renderView'](_0x10a35f,_0x1a2e3c,{'title':_0x336251(0x25b)+_0x546e74[_0x336251(0x199)]+']\x20'+_0x546e74[_0x336251(0x237)],'time':N[_0x336251(0x257)](),'changesHistory':_0x28db95});_0x1a2e3c['send'](JSON[_0x336251(0x182)]({'isPrint':!0x0,'class':_0x639043[_0x336251(0x1ac)],'htmlPage':_0x13c633}));}}catch(_0x16a0fd){if(_0x639043[_0x336251(0x101)](_0x639043[_0x336251(0x1a2)],_0x639043[_0x336251(0x116)])){const _0x591870=_0x403820['constructor'][_0x336251(0x9c)][_0x336251(0x249)](_0x18a988),_0x3840db=_0x2c757d[_0x25dcf8],_0x2609aa=_0x1211a8[_0x3840db]||_0x591870;_0x591870[_0x336251(0x18a)]=_0x1e3054['bind'](_0x54723d),_0x591870[_0x336251(0xdb)]=_0x2609aa[_0x336251(0xdb)]['bind'](_0x2609aa),_0x4eeb92[_0x3840db]=_0x591870;}else console['log'](_0x639043[_0x336251(0xd9)],_0x16a0fd),_0x1a2e3c[_0x336251(0x1e5)](JSON[_0x336251(0x182)]({'isPrint':!0x1,'class':_0x639043['RylEo'],'msg':_0x16a0fd[_0x336251(0x108)]}));}finally{_0x639043[_0x336251(0x1c7)](_0x639043['ySUve'],_0x639043[_0x336251(0x149)])?_0x107106[_0x336251(0x11f)]():_0x4e522b[_0x336251(0x11f)]();}}),w[_0x337f60(0x1ff)](J,_0x16e72a['isOS'],async(_0x4f5805,_0x20f2a8)=>{const _0x481dc9=_0x337f60,_0x38187c={'jaJfG':function(_0x35ff50,_0xe3ffaa){return _0x35ff50(_0xe3ffaa);},'XqUwY':function(_0x3e0107,_0x3e719d){return _0x3e0107+_0x3e719d;},'UkjXC':_0x481dc9(0x174),'LzPun':_0x481dc9(0xa3),'uviGM':function(_0x5333f1){return _0x5333f1();},'SQPVB':function(_0x920873,_0x2d1ced){return _0x920873+_0x2d1ced;},'NsswT':'debu','soMwe':_0x481dc9(0x142),'aUaek':_0x481dc9(0x1c9),'hLICD':function(_0x2b307e,_0x3495f5){return _0x2b307e===_0x3495f5;},'UWwGD':_0x481dc9(0x268),'rdjpi':_0x481dc9(0x1e4),'RrRLB':function(_0x1dcb42,_0x5259c4){return _0x1dcb42==_0x5259c4;},'MNHlZ':_0x481dc9(0x180),'CQSFt':_0x481dc9(0x16c),'URLQD':_0x481dc9(0xff),'bicWk':'buffer','mCNkh':_0x481dc9(0x1e3),'oEBrd':'green','QrdLy':_0x481dc9(0x1e2),'ZqkiZ':_0x481dc9(0x1da),'PhGvU':function(_0x5c5aa0,_0xb9c83e){return _0x5c5aa0===_0xb9c83e;},'ojoyF':_0x481dc9(0xeb),'fxRAR':_0x481dc9(0x18d),'tUxGW':function(_0x417d8e,_0x13c1e1){return _0x417d8e===_0x13c1e1;},'Tjuir':'xOLxr','Hasqg':_0x481dc9(0x17c)},_0x544ea0=new _0x14b282(dbUrl);try{if(_0x38187c[_0x481dc9(0x215)](_0x38187c[_0x481dc9(0x23b)],_0x38187c[_0x481dc9(0x23b)])){await _0x544ea0['connect']();const _0x1131f2=await _0x544ea0['db'](dbName)[_0x481dc9(0x246)](dbColl_suppliers)['aggregate']([{'$project':{'_id':0x0,'supplierId':0x1,'supplierType':0x1,'supplierStatus':0x1,'supplierName':0x1,'supplierContactPerson':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierEmail':0x1,'supplierWebsite':0x1,'supplierTaxId':0x1,'supplierIdentityId':0x1,'dateTimeCanDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x38187c[_0x481dc9(0x151)],[]]}}}},{'$sort':{'supplierId':0x1}}])[_0x481dc9(0x1f8)]();if(_0x38187c[_0x481dc9(0x15a)](_0x1131f2[_0x481dc9(0x16d)],0x0))return _0x20f2a8[_0x481dc9(0x1e5)](JSON[_0x481dc9(0x182)]({'isDownload':!0x1,'class':_0x38187c[_0x481dc9(0x20b)],'msg':_0x38187c[_0x481dc9(0xbe)]}));const _0x1630a3=_0x481dc9(0x139)+N[_0x481dc9(0x257)]()[_0x481dc9(0xe1)](/[: ]/g,'-')+_0x481dc9(0xe2),_0x4fda08=_0x3edd42[_0x481dc9(0xf2)][_0x481dc9(0x159)](_0x1131f2),_0x4d621f=_0x3edd42[_0x481dc9(0xf2)]['book_new']();_0x3edd42[_0x481dc9(0xf2)]['book_append_sheet'](_0x4d621f,_0x4fda08,_0x38187c['URLQD']);const _0x2f6e67=_0x3edd42[_0x481dc9(0xc5)](_0x4d621f,{'type':_0x38187c[_0x481dc9(0x1af)],'bookType':_0x38187c['mCNkh']});_0x20f2a8['send']({'isDownload':!0x0,'color':_0x38187c[_0x481dc9(0x255)],'msg':_0x38187c[_0x481dc9(0xee)],'filename':_0x1630a3,'fileData':_0x2f6e67['toString'](_0x38187c[_0x481dc9(0x1ec)])});}else{const _0x28b821=QJhsgf['jaJfG'](_0x5c6f60,QJhsgf[_0x481dc9(0x207)](QJhsgf['XqUwY'](QJhsgf['UkjXC'],QJhsgf[_0x481dc9(0x275)]),');'));_0x288202=QJhsgf[_0x481dc9(0x1c4)](_0x28b821);}}catch(_0x70f951){if(_0x38187c[_0x481dc9(0xf6)](_0x38187c[_0x481dc9(0x276)],_0x38187c[_0x481dc9(0x11b)]))_0x55ac84[_0x481dc9(0x11f)]();else return _0x20f2a8[_0x481dc9(0x1e5)]({'isDownload':!0x1,'color':_0x38187c[_0x481dc9(0x20b)],'msg':_0x70f951[_0x481dc9(0x108)]});}finally{_0x38187c[_0x481dc9(0x1fe)](_0x38187c[_0x481dc9(0x14e)],_0x38187c[_0x481dc9(0x134)])?function(){return![];}[_0x481dc9(0x13a)](QJhsgf[_0x481dc9(0x24f)](QJhsgf[_0x481dc9(0x15c)],QJhsgf[_0x481dc9(0xea)]))[_0x481dc9(0x11a)](QJhsgf[_0x481dc9(0x1dd)]):_0x544ea0[_0x481dc9(0x11f)]();}});const K=_0x385484({'storage':_0x385484[_0x337f60(0x22b)]()});w[_0x337f60(0x1ff)](M,_0x16e72a['isOS'],K['single'](_0x337f60(0x27e)),async(_0x5f3c37,_0x1558d2)=>{const _0x5f5a7d=_0x337f60,_0x39e6fc={'cTCWa':_0x5f5a7d(0x180),'OidCk':_0x5f5a7d(0xf1),'trrfV':_0x5f5a7d(0x241),'esNDF':_0x5f5a7d(0xff),'RrZZi':function(_0x4eced4,_0x149556){return _0x4eced4>_0x149556;},'NUxeQ':_0x5f5a7d(0x199),'WGywe':'supplierType','Bvmvo':_0x5f5a7d(0x19a),'YiDhk':_0x5f5a7d(0x237),'QqtNX':'supplierContactPerson','YRvjT':_0x5f5a7d(0x21a),'XqpPG':'supplierAddress2','htghQ':_0x5f5a7d(0x1d0),'mpyhS':_0x5f5a7d(0x1e6),'uyKOp':_0x5f5a7d(0xbd),'QSepi':_0x5f5a7d(0x9d),'ksrYZ':_0x5f5a7d(0x1d3),'ATBmU':_0x5f5a7d(0x269),'POfFj':_0x5f5a7d(0x223),'bEWVU':function(_0x1941e4,_0x1bd4c5){return _0x1941e4>_0x1bd4c5;},'MprOA':_0x5f5a7d(0x1ca),'ncxnS':'organization','NzOVe':'active','IHpQA':function(_0x1d9be6,_0x422498){return _0x1d9be6+_0x422498;},'HEKFb':function(_0x3c9f6c,_0x5d04d0){return _0x3c9f6c===_0x5d04d0;},'AZfTn':function(_0x530575,_0xb9845){return _0x530575===_0xb9845;},'mvcCl':function(_0x434e1e,_0x2d66a2){return _0x434e1e!=_0x2d66a2;},'vEltp':_0x5f5a7d(0x19f),'ENSxI':function(_0x210c8a,_0x2a01f6){return _0x210c8a<_0x2a01f6;},'iIobs':function(_0x28d4b8,_0x348b16){return _0x28d4b8>_0x348b16;},'PvqCr':function(_0x67525a,_0x23a7df){return _0x67525a+_0x23a7df;},'xwAbR':_0x5f5a7d(0x145),'VfUtC':'green','mXmgD':_0x5f5a7d(0x1b3)},_0xf2b6f3=new _0x14b282(dbUrl);try{if(!_0x5f3c37[_0x5f5a7d(0x10b)])return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x1,'color':_0x39e6fc[_0x5f5a7d(0x15e)],'msg':_0x39e6fc[_0x5f5a7d(0x232)]});const _0x2db5ec=_0x3edd42[_0x5f5a7d(0x11c)](_0x5f3c37[_0x5f5a7d(0x10b)][_0x5f5a7d(0x241)],{'type':_0x39e6fc[_0x5f5a7d(0x1bc)]}),_0x4d8763=[_0x39e6fc[_0x5f5a7d(0x16f)]],_0x247b50=_0x2db5ec[_0x5f5a7d(0xcd)],_0x2c31e4=_0x4d8763[_0x5f5a7d(0xd8)](_0x526c51=>!_0x247b50[_0x5f5a7d(0x231)](_0x526c51));if(_0x39e6fc[_0x5f5a7d(0x218)](_0x2c31e4[_0x5f5a7d(0x16d)],0x0))return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x1,'color':_0x39e6fc['cTCWa'],'msg':_0x5f5a7d(0x148)+_0x2c31e4[_0x5f5a7d(0xb1)](',\x20')+'\x22'});const _0x32f39e=_0x2db5ec[_0x5f5a7d(0x20d)][_0x5f5a7d(0xff)],_0x51bf77=_0x3edd42['utils'][_0x5f5a7d(0x172)](_0x32f39e),_0x3a69b5=[_0x39e6fc['NUxeQ'],_0x39e6fc[_0x5f5a7d(0xb3)],_0x39e6fc[_0x5f5a7d(0xd6)],_0x39e6fc[_0x5f5a7d(0x169)],_0x39e6fc['QqtNX'],_0x39e6fc['YRvjT'],_0x39e6fc[_0x5f5a7d(0x23a)],_0x39e6fc[_0x5f5a7d(0x178)],_0x39e6fc[_0x5f5a7d(0xdf)],_0x39e6fc[_0x5f5a7d(0xc8)],_0x39e6fc[_0x5f5a7d(0x1e7)],_0x39e6fc[_0x5f5a7d(0x214)],_0x39e6fc['ATBmU'],_0x39e6fc[_0x5f5a7d(0xe3)]][_0x5f5a7d(0xd8)](_0x4b25a0=>!_0x51bf77[_0x5f5a7d(0x1ea)](_0x15570f=>Object['prototype']['hasOwnProperty'][_0x5f5a7d(0xfb)](_0x15570f,_0x4b25a0)));if(_0x39e6fc[_0x5f5a7d(0x218)](_0x3a69b5[_0x5f5a7d(0x16d)],0x0))return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x1,'color':_0x39e6fc['cTCWa'],'msg':_0x5f5a7d(0x129)+_0x3a69b5[_0x5f5a7d(0xb1)](',\x20')+'\x22'});const _0x178441=new Set(),_0x1f4434=new Set();if(_0x51bf77[_0x5f5a7d(0x1ba)](_0x31777d=>{const _0x237101=_0x5f5a7d;_0x178441[_0x237101(0x1a3)](_0x31777d[_0x237101(0x199)])?_0x1f4434[_0x237101(0xe8)](_0x31777d[_0x237101(0x199)]):_0x178441['add'](_0x31777d[_0x237101(0x199)]);}),_0x39e6fc[_0x5f5a7d(0xf7)](_0x1f4434['size'],0x0))return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x1,'color':_0x39e6fc[_0x5f5a7d(0x15e)],'msg':'มี\x20supplierId\x20ซ้ำกัน:\x20\x22'+Array[_0x5f5a7d(0x1aa)](_0x1f4434)[_0x5f5a7d(0xb1)](',\x20')+'\x22'});const _0x595b63=[],_0x122378=new RegExp(global[_0x5f5a7d(0x160)]),_0x412d60=/^S[A-Za-z0-9]{4}$/,_0x1554c5=[_0x39e6fc[_0x5f5a7d(0x198)],_0x39e6fc[_0x5f5a7d(0x1d6)]],_0x5269ec=[_0x39e6fc['NzOVe'],''];for(const [_0x349470,_0xf18aff]of _0x51bf77['entries']()){const _0x1f2a86=_0x39e6fc[_0x5f5a7d(0x212)](_0x349470,0x2),_0x3e0f14={'supplierId':_0xf18aff[_0x5f5a7d(0x199)],'row':_0x1f2a86};if(!_0xf18aff[_0x5f5a7d(0x199)]||_0x39e6fc['HEKFb'](_0x412d60[_0x5f5a7d(0x13f)](_0xf18aff[_0x5f5a7d(0x199)]),!0x1)){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}if(!_0xf18aff[_0x5f5a7d(0x156)]||!_0x1554c5[_0x5f5a7d(0x231)](_0xf18aff['supplierType'])){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}if(_0x39e6fc[_0x5f5a7d(0x266)](_0xf18aff[_0x5f5a7d(0x19a)],void 0x0)||!_0x5269ec[_0x5f5a7d(0x231)](_0xf18aff[_0x5f5a7d(0x19a)])){_0x595b63['push'](_0x3e0f14);continue;}if(!_0xf18aff[_0x5f5a7d(0x237)]||_0x39e6fc[_0x5f5a7d(0x210)](typeof _0xf18aff['supplierName'],_0x39e6fc['vEltp'])||_0x39e6fc[_0x5f5a7d(0xfc)](_0xf18aff[_0x5f5a7d(0x237)][_0x5f5a7d(0x236)]()[_0x5f5a7d(0x16d)],0x1)){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}if(_0xf18aff[_0x5f5a7d(0x1d3)]&&!_0x122378[_0x5f5a7d(0x13f)](_0xf18aff[_0x5f5a7d(0x1d3)])){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}if(_0xf18aff[_0x5f5a7d(0x269)]&&!_0x122378['test'](_0xf18aff[_0x5f5a7d(0x269)])){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}if(!_0xf18aff[_0x5f5a7d(0x223)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x5f5a7d(0x13f)](_0xf18aff[_0x5f5a7d(0x223)])){_0x595b63[_0x5f5a7d(0xf8)](_0x3e0f14);continue;}}if(_0x39e6fc[_0x5f5a7d(0x1fa)](_0x595b63['length'],0x0)){const _0x5f0f1e=Array[_0x5f5a7d(0x1aa)](new Set(_0x595b63[_0x5f5a7d(0x1fd)](_0x1e9337=>JSON['stringify'](_0x1e9337))))[_0x5f5a7d(0x1fd)](_0x54d2e4=>JSON[_0x5f5a7d(0x22e)](_0x54d2e4));return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x1,'color':_0x39e6fc['cTCWa'],'msg':'ชีท\x20\x27items\x27\x20มีข้อมูลผิดพลาดที่แถว\x20'+_0x5f0f1e[_0x5f5a7d(0x1fd)](_0x47cbed=>_0x47cbed[_0x5f5a7d(0x271)])['join'](',\x20'),'errorRows':_0x5f0f1e});}await _0xf2b6f3['connect']();const _0x1afca0=_0xf2b6f3['db'](dbName)['collection'](dbColl_suppliers),_0x3a7c5b=[];for(const _0x56061a of _0x51bf77){_0x56061a[_0x5f5a7d(0x156)]||(_0x56061a[_0x5f5a7d(0x156)]='');const _0x404b11=await _0x1afca0[_0x5f5a7d(0x186)]({'supplierId':_0x56061a['supplierId']},{'$set':_0x56061a},{'upsert':!0x0});_0x3a7c5b[_0x5f5a7d(0xf8)]({'supplierId':_0x56061a[_0x5f5a7d(0x199)],'matchedCount':_0x404b11['matchedCount'],'upsertedCount':_0x404b11[_0x5f5a7d(0x1b6)]});}const _0x27ff82=_0x39e6fc['iIobs'](_0x3a7c5b[_0x5f5a7d(0x16d)],0x0)?_0x39e6fc[_0x5f5a7d(0x24a)](_0x5f5a7d(0x26d)+_0x3a7c5b['filter'](_0x197e40=>_0x197e40['matchedCount']>0x0)['length']+'\x20รายการ',(_0x5f5a7d(0xfe)+_0x3a7c5b[_0x5f5a7d(0xd8)](_0x18d814=>_0x18d814[_0x5f5a7d(0x1b6)]>0x0)[_0x5f5a7d(0x16d)]+_0x5f5a7d(0x27c))[_0x5f5a7d(0x236)]()):_0x39e6fc[_0x5f5a7d(0xe7)];return _0x1558d2[_0x5f5a7d(0x1e5)]({'isUpload':!0x0,'color':_0x39e6fc[_0x5f5a7d(0xad)],'msg':_0x27ff82});}catch(_0x2789ee){return console[_0x5f5a7d(0x1eb)](_0x39e6fc['mXmgD'],_0x2789ee),_0x1558d2[_0x5f5a7d(0x1e5)]({'isDownload':!0x1,'color':_0x39e6fc[_0x5f5a7d(0x15e)],'msg':_0x2789ee['message']});}finally{_0xf2b6f3['close']();}});export default w;function _0x2da58c(_0x144591){const _0x40fd6d=_0x337f60,_0x11dffc={'HkiwY':function(_0x667d9c,_0x3372bb){return _0x667d9c===_0x3372bb;},'klHAA':_0x40fd6d(0x19f),'ZYhUP':_0x40fd6d(0x173),'lWhJF':'counter','PKAKG':function(_0x46f86b,_0x14d20e){return _0x46f86b!==_0x14d20e;},'KOHTq':function(_0xebce5c,_0x52b8df){return _0xebce5c+_0x52b8df;},'eMTbe':function(_0x48a59f,_0x29764d){return _0x48a59f/_0x29764d;},'ILJmz':_0x40fd6d(0x16d),'nKEgM':function(_0x19ff2a,_0x365eb2){return _0x19ff2a%_0x365eb2;},'ziwFD':function(_0x57005d,_0x5a852a){return _0x57005d+_0x5a852a;},'qLHZC':_0x40fd6d(0x247),'CiyGx':_0x40fd6d(0x142),'vQVPZ':_0x40fd6d(0x1b8),'qWphh':_0x40fd6d(0x1c9),'nSyed':function(_0x58d51a,_0x3306a7){return _0x58d51a(_0x3306a7);}};function _0x22f3c3(_0x39f2fb){const _0x5bb6a2=_0x40fd6d;if(_0x11dffc[_0x5bb6a2(0xaf)](typeof _0x39f2fb,_0x11dffc['klHAA']))return function(_0x457deb){}['constructor'](_0x11dffc[_0x5bb6a2(0x132)])[_0x5bb6a2(0x11a)](_0x11dffc[_0x5bb6a2(0x106)]);else _0x11dffc[_0x5bb6a2(0x277)](_0x11dffc[_0x5bb6a2(0x144)]('',_0x11dffc['eMTbe'](_0x39f2fb,_0x39f2fb))[_0x11dffc[_0x5bb6a2(0xe5)]],0x1)||_0x11dffc[_0x5bb6a2(0xaf)](_0x11dffc[_0x5bb6a2(0x239)](_0x39f2fb,0x14),0x0)?function(){return!![];}[_0x5bb6a2(0x13a)](_0x11dffc[_0x5bb6a2(0x163)](_0x11dffc[_0x5bb6a2(0xdc)],_0x11dffc[_0x5bb6a2(0x217)]))[_0x5bb6a2(0xfb)](_0x11dffc['vQVPZ']):function(){return![];}['constructor'](_0x11dffc[_0x5bb6a2(0x144)](_0x11dffc[_0x5bb6a2(0xdc)],_0x11dffc[_0x5bb6a2(0x217)]))[_0x5bb6a2(0x11a)](_0x11dffc[_0x5bb6a2(0x194)]);_0x11dffc[_0x5bb6a2(0x170)](_0x22f3c3,++_0x39f2fb);}try{if(_0x144591)return _0x22f3c3;else _0x11dffc[_0x40fd6d(0x170)](_0x22f3c3,0x0);}catch(_0x2b5a6a){}}function _0x1fdc(){const _0x611b91=['XlLVI','oXZbn','oYfUP','fzYFI','DNVvv','Tjuir','Jlbcj','BrwQk','rdjpi','paXlk','EOQIE','kUuVy','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','supplierType','ZgVKG','body','json_to_sheet','RrRLB','vrZbC','NsswT','/delete','cTCWa','QuWIj','TAXID_PATTERN','oAPwK','NyUGN','ziwFD','CViqr','EHUJi','ไม่พบ\x20','CIZAQ','GrTtt','YiDhk','ผู้จัดจำหน่าย\x20\x22','ZHZeg','ไม่มีข้อมูล','length','connect','esNDF','nSyed','HyQZr','sheet_to_json','while\x20(true)\x20{}','return\x20(function()\x20','hufjV','{{sep}}ไม่สามารถลบได้','ehriZ','htghQ','jKpyf','green','AYQsT','PQmCN','Xakrl','AUVmp','limit','red','/upload-excel','stringify','XAyaC','CwLGj','FYhsb','updateOne','tgOPY','KMwbG','QwxKK','__proto__','lGiVP','TDqAB','seicz','RyXgq','TKQch','load_id','39736GJfujd','UXDca','axrYO','qWphh','YUjpI','uuoGE','$supplierId','MprOA','supplierId','supplierStatus','LeWDy','TnLnb','{{sep}}[\x20บันทึกการแก้ไข\x20]','HcPFL','string','DWTAO','JxKjq','KtLHj','has','AMOBD','DAIuD','modifiedCount','yHTEH','465KwETPE','ไม่พบ\x20\x22','from','Lpjqy','KVVAx','&rpp=','54AnTrNB','bicWk','AkHth','VmYcB','getSettings','error\x20===>\x20','Ynffm','MUnMq','upsertedCount','countDocuments','action','ลบ\x20\x22','forEach','hxhTP','trrfV','kcglz','insertOne','MOHiX','Npwpq','RqiwU','&load_id=','NmOMg','uviGM','lkbXT','WOpcu','hZPKd','fheRt','stateObject','personal','NnCyX','uAMWi','TtGZw','eCkWd','\x22\x20มีอยู่ในเอกสาร\x20','supplierProvince','FvqqG','findOne','supplierTaxId','zzxGC','unshift','ncxnS','deleteOne','sort','sendFile','base64','daqjw','uHZMW','aUaek','MOmcW','isOS','RylEo','padStart','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','xlsx','$changesHistory','send','supplierPhone','QSepi','flash','/changes','some','log','ZqkiZ','jgKkB','KqZnQ','msg','PWlRs','DsiwV','SdpRK','JfIUP','RKlyl','ITOAm','exception','WejFV','toArray','oRSKU','iIobs','slice','Not\x20Found','map','tUxGW','post','PizgM','jducI','\x22\x20เรียบร้อยแล้ว','/myModule.js','yvvJX','SFgAd','nwaEt','XqUwY','FZBKB','query','NKyKd','MNHlZ','doc_changes.ejs','Sheets','XbKMt','LfPhZ','mvcCl','dbColl_warehouseIn','IHpQA','TjwQa','ksrYZ','hLICD','RahcW','CiyGx','RrZZi','CONQK','supplierAddress1','dyIuy','1751512oXOxXo','aTtzA','ZzLls','ISikf','getSessionData','WnyDz','renderView','dateTimeCanDelete','lWAog','nHCfF','PxIEU','/load','&page=','bFFFe','ENsHD','memoryStorage','zpZbd','xpDDE','parse','rpp','xoLeK','includes','OidCk','saQZS','acknowledged','vHLhv','trim','supplierName','warn','nKEgM','XqpPG','UWwGD','EiQfW','aofOS','bMaTH','?sip=','hWMqg','buffer','console','THQuE','ceil','dbColl_suppliers','collection','debu','uRDKu','bind','PvqCr','redirect','SYRqt','yNXKB','gqTzk','SQPVB','Not\x20Inserted','YXBbC','TxtdF','table','iHIgP','oEBrd','HQZOB','getDateTime','sJxfF','WRzFV','FNdKz','ประวัติการแก้ไขผู้จัดจำหน่าย\x20:\x20[','CRnDd','eVapu','UvTnO','dQQOR','QdEdi','SnbxC','RMSYl','pgQFe','nRbUF','yYKuc','AZfTn','pGSJi','iHMGK','supplierIdentityId','readFileSync','info','loByQ','อัปเดท\x20','/import','zRRTa','ZncGv','row','WDmul','DMzwI','IZbkU','LzPun','ojoyF','PKAKG','CVyit','WESUs','TXybq','aggregate','\x20รายการ','20LTQsbn','uploadExcelFile','insertedId','\x22{{sep}}ไม่มีอะไรเปลี่ยนแปลง','bDnFw','BFNfy','OdjlX','prototype','supplierWebsite','ipytc','Knvga','page','hegCS','xJekB','{}.constructor(\x22return\x20this\x22)(\x20)','dqyrn','TaUsO','find','เกิดข้อผิดพลาดขณะลบ\x20\x22','MOaYg','vNjqP','WcxOM','userId','MyLJA','VfUtC','MZZuz','HkiwY','BgByZ','join','KwAJF','WGywe','jeawB','VxlYK','pgUCe','rnTSw','LLHcM','Fpvhn','ETcGz','auSRY','roSYv','supplierEmail','CQSFt','KaXsB','init','ผู้จัดจำหน่าย\x20[','sfwQC','LrPaY','2288700RzCvhU','write','error','HHXLP','uyKOp','GTHcm','{{sep}}\x22','AVyhq','RYFKU','SheetNames','soDxk','fnAos','CcDDN','wjWBK','fOnvK','QYzpl','rFnDN','nyJep','Bvmvo','PhNPx','filter','JKtjB','BseEY','toString','qLHZC','render','IVpDx','mpyhS','JOAkM','replace','.xlsx','POfFj','bnRbu','ILJmz','../','xwAbR','add','xRYEV','soMwe','riflC','cHoXR','pgVms','QrdLy','QhtqL','trace','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','utils','Xtosv','status','XXuAe','PhGvU','bEWVU','push','function\x20*\x5c(\x20*\x5c)','Aobpc','call','ENSxI','dhQxf','{{sep}}เพิ่มใหม่\x20','suppliers','PLIIs','sohjo','/myUsers.js','xiYJc','JCxIg','/myDateTime.js','lWhJF','laxSd','message','QGewt','TllJS','file','lrhlA','rDxqV','_id','nUnjW','zLGFc','1655226yqEGuf','nkIFw','$dateTimeCanDelete','VBUNC','XCebM','naWVm','WPaRY','CaVYD','input','apply','fxRAR','read','เพิ่ม\x20\x22','xoAtK','close','mCdly','ไม่พบประวัติการเปลี่ยนแปลง','sip','GWOto','rfRRB','อัปเดท\x20\x22','yellow','CEzyL','chain','ชี้ท\x20\x27suppliers\x27\x20ต้องมีคอลัมน์\x20\x22','DqLZS','8298hrRUXr','EWVyY','FJCjB','/save','83164HeQuSj','cKsqg','cbLXw','ZYhUP','ชีท\x20\x27items\x27\x20มีข้อมูลผิดพลาดที่แถว\x20','Hasqg','kXXXm','oVKXY','1693139zhKZtV','RfFsp','suppliers_','constructor','fbKcL','lEswf','CoKJU','PUxpF','test','QmojC','ALcco','gger','iGdBF','KOHTq','ไม่มีข้อมูลที่อัปเดท','OsYKu','Router','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22'];_0x1fdc=function(){return _0x611b91;};return _0x1fdc();}