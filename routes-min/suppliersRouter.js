const _0x486515=_0x1caf;(function(_0x22fb34,_0x456c13){const _0x19846d=_0x1caf,_0x5d5dec=_0x22fb34();while(!![]){try{const _0x57cbec=-parseInt(_0x19846d(0xd9))/0x1*(-parseInt(_0x19846d(0x1e8))/0x2)+parseInt(_0x19846d(0x148))/0x3+-parseInt(_0x19846d(0x182))/0x4*(parseInt(_0x19846d(0xd3))/0x5)+parseInt(_0x19846d(0x1ba))/0x6*(-parseInt(_0x19846d(0xf0))/0x7)+parseInt(_0x19846d(0xfb))/0x8*(parseInt(_0x19846d(0x129))/0x9)+-parseInt(_0x19846d(0x25b))/0xa*(-parseInt(_0x19846d(0x281))/0xb)+-parseInt(_0x19846d(0x188))/0xc;if(_0x57cbec===_0x456c13)break;else _0x5d5dec['push'](_0x5d5dec['shift']());}catch(_0x591f7a){_0x5d5dec['push'](_0x5d5dec['shift']());}}}(_0x1d1f,0xd4523));const _0x46f629=(function(){const _0x3b830d=_0x1caf,_0x49018f={'eXgZj':_0x3b830d(0xe1),'FgtfX':_0x3b830d(0x166),'VyCwj':function(_0x33c286,_0x2c8777){return _0x33c286(_0x2c8777);},'KdOAk':_0x3b830d(0x11d),'LRdSi':function(_0x27510a,_0x3c229b){return _0x27510a+_0x3c229b;},'hKCXF':'chain','pZYzR':'input','ihlvB':function(_0x3981df,_0x1789b0){return _0x3981df(_0x1789b0);},'IwpEt':function(_0x2f837b){return _0x2f837b();},'GfFaX':_0x3b830d(0x1ee),'UrbDR':'{}.constructor(\x22return\x20this\x22)(\x20)','luqew':function(_0x2c6bb0,_0x59e6f5){return _0x2c6bb0===_0x59e6f5;},'QkWGr':_0x3b830d(0x1d7),'rmiLS':function(_0x3485c4,_0x493992){return _0x3485c4===_0x493992;},'txlTC':_0x3b830d(0x196),'DhXXt':_0x3b830d(0x161),'cOoma':'CHYMB'};let _0x5ed34c=!![];return function(_0x18d383,_0x219e2a){const _0x3dd547=_0x3b830d,_0x3fc0e8={'QWMct':_0x49018f['eXgZj'],'Tnpia':_0x49018f[_0x3dd547(0x27d)],'oSqbL':function(_0x376391,_0x1e2356){return _0x49018f['VyCwj'](_0x376391,_0x1e2356);},'ZqpbB':_0x49018f[_0x3dd547(0x1f4)],'SSQuf':function(_0x3aa498,_0x531139){const _0x47bc1b=_0x3dd547;return _0x49018f[_0x47bc1b(0xf7)](_0x3aa498,_0x531139);},'Vxuix':_0x49018f['hKCXF'],'SQBXj':_0x49018f['pZYzR'],'UvovG':function(_0x37b46e,_0xbfa505){return _0x49018f['ihlvB'](_0x37b46e,_0xbfa505);},'ufHsU':function(_0x5663f9){const _0x286ba9=_0x3dd547;return _0x49018f[_0x286ba9(0x1a4)](_0x5663f9);},'JeGZq':_0x49018f['GfFaX'],'RjNck':_0x49018f[_0x3dd547(0x10c)],'DPbXN':function(_0x469a8c,_0x182b0d){return _0x49018f['luqew'](_0x469a8c,_0x182b0d);},'kCusC':_0x49018f[_0x3dd547(0x12e)],'TeNJG':function(_0x1fd6c3,_0x48baed){const _0x27285b=_0x3dd547;return _0x49018f[_0x27285b(0x234)](_0x1fd6c3,_0x48baed);},'BRsuC':_0x49018f['txlTC'],'sZnZr':_0x49018f[_0x3dd547(0x162)]};if(_0x49018f['luqew'](_0x49018f['cOoma'],_0x49018f['cOoma'])){const _0x430080=_0x5ed34c?function(){const _0x42953a=_0x3dd547;if(_0x3fc0e8[_0x42953a(0x1b9)](_0x3fc0e8[_0x42953a(0x277)],_0x3fc0e8['kCusC'])){if(_0x219e2a){if(_0x3fc0e8[_0x42953a(0x12c)](_0x3fc0e8[_0x42953a(0x245)],_0x3fc0e8['sZnZr'])){const _0xd090af=new _0x4f2f69(_0x3fc0e8['QWMct']),_0x2df8a8=new _0xd51fef(_0x3fc0e8[_0x42953a(0x1a1)],'i'),_0x46f415=_0x3fc0e8['oSqbL'](_0x4c6a7c,_0x3fc0e8[_0x42953a(0x20b)]);!_0xd090af[_0x42953a(0x10e)](_0x3fc0e8[_0x42953a(0x1b0)](_0x46f415,_0x3fc0e8[_0x42953a(0x254)]))||!_0x2df8a8[_0x42953a(0x10e)](_0x3fc0e8[_0x42953a(0x1b0)](_0x46f415,_0x3fc0e8[_0x42953a(0x1f3)]))?_0x3fc0e8[_0x42953a(0x136)](_0x46f415,'0'):_0x3fc0e8[_0x42953a(0x283)](_0x3663d7);}else{const _0x19c65f=_0x219e2a['apply'](_0x18d383,arguments);return _0x219e2a=null,_0x19c65f;}}}else{let _0x307fce;try{_0x307fce=_0x3fc0e8['UvovG'](_0x42286d,_0x3fc0e8[_0x42953a(0x1b0)](_0x3fc0e8['SSQuf'](_0x3fc0e8[_0x42953a(0x15d)],_0x3fc0e8['RjNck']),');'))();}catch(_0xe3102f){_0x307fce=_0x57a197;}return _0x307fce;}}:function(){};return _0x5ed34c=![],_0x430080;}else _0x206206[_0x3dd547(0x173)]();};}());(function(){const _0x38e46b=_0x1caf,_0x5564b4={'qduwq':_0x38e46b(0x181),'SdieM':'green','DPeyV':function(_0x2434bb,_0xe1713e){return _0x2434bb(_0xe1713e);},'zjfOW':function(_0x390cc6,_0x3eada4){return _0x390cc6===_0x3eada4;},'IyKed':_0x38e46b(0x201),'JCYcn':'PkZZU','GjfmW':_0x38e46b(0xe1),'EoHJB':_0x38e46b(0x166),'jpmtY':function(_0x449b5c,_0x20a008){return _0x449b5c(_0x20a008);},'lSVwt':_0x38e46b(0x11d),'Tnjwt':function(_0x44393e,_0x1bc0f1){return _0x44393e+_0x1bc0f1;},'eMzQc':_0x38e46b(0x1a9),'EZPBa':function(_0x2baf13,_0x1aaeed){return _0x2baf13+_0x1aaeed;},'sPdjd':_0x38e46b(0x1ff),'OCSXX':'PgTfT','JDifI':function(_0x8c7e7c,_0x12ce95){return _0x8c7e7c(_0x12ce95);},'kqmhR':function(_0x8cfe95,_0x3b7000){return _0x8cfe95===_0x3b7000;},'OXKLm':_0x38e46b(0x143),'ahUUD':function(_0xf86287){return _0xf86287();},'tGrfv':function(_0x3262dc,_0x3c3283,_0x3ab7cd){return _0x3262dc(_0x3c3283,_0x3ab7cd);}};_0x5564b4['tGrfv'](_0x46f629,this,function(){const _0x2ee470=_0x38e46b;if(_0x5564b4['zjfOW'](_0x5564b4[_0x2ee470(0xe5)],_0x5564b4['JCYcn']))_0x61723a[_0x2ee470(0x173)]();else{const _0x8395f9=new RegExp(_0x5564b4[_0x2ee470(0x1e7)]),_0x5121bd=new RegExp(_0x5564b4[_0x2ee470(0x183)],'i'),_0x4bba9e=_0x5564b4['jpmtY'](_0xe27ada,_0x5564b4[_0x2ee470(0x16e)]);if(!_0x8395f9[_0x2ee470(0x10e)](_0x5564b4[_0x2ee470(0x230)](_0x4bba9e,_0x5564b4['eMzQc']))||!_0x5121bd['test'](_0x5564b4[_0x2ee470(0x1e4)](_0x4bba9e,_0x5564b4[_0x2ee470(0xec)]))){if(_0x5564b4[_0x2ee470(0xc3)](_0x5564b4['OCSXX'],_0x5564b4['OCSXX']))_0x5564b4[_0x2ee470(0x16a)](_0x4bba9e,'0');else{const _0x3b71e7=_0x30ab0e+_0x2ee470(0x1da)+_0x59e2d8+_0x2ee470(0xd1)+_0x18c16d+_0x2ee470(0x24b)+_0x4fcbbb+_0x2ee470(0x14e)+_0x4e1eaf[_0x2ee470(0x198)];return _0x58439b['flash'](_0x5564b4['qduwq'],{'class':_0x5564b4['SdieM'],'text':'เพิ่ม\x20\x22'+_0x197d83['body']['supplierId']+_0x2ee470(0xf2)}),_0x3e51db['redirect'](_0x3b71e7);}}else _0x5564b4[_0x2ee470(0x219)](_0x5564b4[_0x2ee470(0xe7)],_0x5564b4['OXKLm'])?_0x5564b4[_0x2ee470(0x1b8)](_0xe27ada):_0x5564b4[_0x2ee470(0x22c)](_0x1ba509,0x0);}})();}());const _0x24d7fb=(function(){const _0x282181=_0x1caf,_0x115e33={'FchEh':'msg','AvsGd':'red','ccLzM':function(_0xf1bfeb,_0x4c7fb0){return _0xf1bfeb===_0x4c7fb0;},'atnMW':'arrUT','FHXlF':'CAuAB','cCrSh':function(_0x14e7b1,_0x276bbe){return _0x14e7b1===_0x276bbe;},'hHTQE':_0x282181(0x1b4),'BtRXw':function(_0x136a58,_0x511a5f){return _0x136a58!==_0x511a5f;},'ZnwoL':_0x282181(0x260)};let _0x484a2d=!![];return function(_0x592fc8,_0x32dc17){const _0x1a3ebe=_0x282181,_0x48e0c7={'gaogs':_0x115e33[_0x1a3ebe(0x22d)],'wfSyP':_0x115e33[_0x1a3ebe(0x1fd)],'YXOKB':function(_0x25682c,_0x20f08b){const _0x3e0d53=_0x1a3ebe;return _0x115e33[_0x3e0d53(0x199)](_0x25682c,_0x20f08b);},'mpcxM':_0x115e33[_0x1a3ebe(0x195)],'zKcuV':_0x115e33[_0x1a3ebe(0x1ad)],'VExxN':function(_0x458ff2,_0x108ef8){const _0x3d4cb1=_0x1a3ebe;return _0x115e33[_0x3d4cb1(0x264)](_0x458ff2,_0x108ef8);},'Qqxed':_0x115e33[_0x1a3ebe(0x220)]};if(_0x115e33['BtRXw'](_0x115e33[_0x1a3ebe(0x1c7)],_0x115e33['ZnwoL']))return _0x110bed[_0x1a3ebe(0xcf)](_0x48e0c7['gaogs'],{'class':_0x48e0c7['wfSyP'],'text':''+_0x296cae[_0x1a3ebe(0xd0)]}),_0x53f703[_0x1a3ebe(0x1ab)](_0x2aca1f);else{const _0x5db8d7=_0x484a2d?function(){const _0x3959f6=_0x1a3ebe;if(_0x48e0c7[_0x3959f6(0x1e9)](_0x48e0c7[_0x3959f6(0x207)],_0x48e0c7[_0x3959f6(0x202)]))_0x198028[_0x3959f6(0x1b5)](_0x48e662[_0x3959f6(0x274)])?_0xf50869[_0x3959f6(0xcd)](_0x2088f7[_0x3959f6(0x274)]):_0x5080a9[_0x3959f6(0xcd)](_0x2eb15f[_0x3959f6(0x274)]);else{if(_0x32dc17){if(_0x48e0c7['VExxN'](_0x48e0c7[_0x3959f6(0x159)],_0x48e0c7['Qqxed'])){const _0x24150b=_0x32dc17[_0x3959f6(0xb6)](_0x592fc8,arguments);return _0x32dc17=null,_0x24150b;}else{const _0x56c1ae=_0x577ac7?function(){const _0x4c86bd=_0x3959f6;if(_0x11d9e5){const _0x4b9179=_0x17949b[_0x4c86bd(0xb6)](_0x356743,arguments);return _0x45d692=null,_0x4b9179;}}:function(){};return _0x515590=![],_0x56c1ae;}}}}:function(){};return _0x484a2d=![],_0x5db8d7;}};}()),_0x348d85=_0x24d7fb(this,function(){const _0x22ef25=_0x1caf,_0x3434e5={'lQgxw':_0x22ef25(0x114),'OCYBt':_0x22ef25(0x25a),'fkcwS':function(_0xbd7853,_0x58fe47){return _0xbd7853(_0x58fe47);},'cwAsS':function(_0x1239d6,_0x4e44b9){return _0x1239d6===_0x4e44b9;},'INYnO':_0x22ef25(0x123),'bnNDT':'sJfMD','LVILX':function(_0x58e9fc,_0x4300a3){return _0x58e9fc!==_0x4300a3;},'BtbRw':_0x22ef25(0xbc),'IhfKH':function(_0x3e4267,_0x5c52c9){return _0x3e4267(_0x5c52c9);},'kagIv':function(_0x2cff85,_0x270bf6){return _0x2cff85+_0x270bf6;},'gAMSl':_0x22ef25(0x1ee),'HnwFy':_0x22ef25(0x12b),'oSJjW':_0x22ef25(0x221),'XBEXy':_0x22ef25(0x1c4),'KfBzS':_0x22ef25(0x13c),'noUYd':_0x22ef25(0x27f),'PonrX':function(_0x3238ef){return _0x3238ef();},'XgbPv':_0x22ef25(0x194),'euUeF':'warn','KTNyg':_0x22ef25(0x229),'KLAMd':_0x22ef25(0x101),'HjEwE':_0x22ef25(0x150),'LVCoi':_0x22ef25(0x22b),'mtQeO':_0x22ef25(0x214),'tJTFv':function(_0x7d6fbf,_0x20706e){return _0x7d6fbf<_0x20706e;},'zzfTu':_0x22ef25(0xe3),'LYGaY':_0x22ef25(0x127)},_0x268de7=function(){const _0x4ef3be=_0x22ef25,_0x5ec793={'LucXj':function(_0x42843f,_0x4f798d){const _0x4bf9be=_0x1caf;return _0x3434e5[_0x4bf9be(0x191)](_0x42843f,_0x4f798d);}};if(_0x3434e5[_0x4ef3be(0x1c3)](_0x3434e5['INYnO'],_0x3434e5[_0x4ef3be(0x185)])){if(_0x1e2790)return _0x3e3d77;else _0x5ec793[_0x4ef3be(0x1ca)](_0x37c320,0x0);}else{let _0x17b632;try{_0x3434e5['LVILX'](_0x3434e5[_0x4ef3be(0x177)],_0x3434e5[_0x4ef3be(0x177)])?(_0xc17f18[_0x4ef3be(0x194)](_0x3434e5[_0x4ef3be(0x126)],_0x419449[_0x4ef3be(0xd0)]),_0x1b2b1f[_0x4ef3be(0x115)](_0x5ef03e['stringify']({'isPrint':!0x1,'class':_0x3434e5[_0x4ef3be(0xea)],'msg':_0xf40a38[_0x4ef3be(0xd0)]}))):_0x17b632=_0x3434e5[_0x4ef3be(0x244)](Function,_0x3434e5[_0x4ef3be(0x18e)](_0x3434e5['kagIv'](_0x3434e5['gAMSl'],_0x3434e5[_0x4ef3be(0x25e)]),');'))();}catch(_0x246c3c){_0x3434e5[_0x4ef3be(0x1c3)](_0x3434e5[_0x4ef3be(0x11f)],_0x3434e5[_0x4ef3be(0xce)])?_0x17fc9c[_0x4ef3be(0x173)]():_0x17b632=window;}return _0x17b632;}},_0xeda451=_0x3434e5['PonrX'](_0x268de7),_0x424fb1=_0xeda451[_0x22ef25(0x1df)]=_0xeda451['console']||{},_0x679256=[_0x3434e5[_0x22ef25(0x23b)],_0x3434e5['euUeF'],_0x3434e5[_0x22ef25(0xfd)],_0x3434e5[_0x22ef25(0x187)],_0x3434e5[_0x22ef25(0x15f)],_0x3434e5['LVCoi'],_0x3434e5['mtQeO']];for(let _0x18ea6a=0x0;_0x3434e5[_0x22ef25(0x1d5)](_0x18ea6a,_0x679256[_0x22ef25(0x107)]);_0x18ea6a++){if(_0x3434e5[_0x22ef25(0x1a0)](_0x3434e5[_0x22ef25(0xbf)],_0x3434e5['LYGaY'])){const _0x508111=_0x24d7fb['constructor'][_0x22ef25(0x116)]['bind'](_0x24d7fb),_0x525859=_0x679256[_0x18ea6a],_0x288d4f=_0x424fb1[_0x525859]||_0x508111;_0x508111['__proto__']=_0x24d7fb[_0x22ef25(0xd4)](_0x24d7fb),_0x508111[_0x22ef25(0x247)]=_0x288d4f['toString'][_0x22ef25(0xd4)](_0x288d4f),_0x424fb1[_0x525859]=_0x508111;}else return function(_0x345578){}[_0x22ef25(0x252)](_0x3434e5[_0x22ef25(0x1ea)])[_0x22ef25(0xb6)](_0x3434e5[_0x22ef25(0x13e)]);}});function _0x1d1f(){const _0x4a3ec5=['oSJjW','MuflQ','UoogN','QtyYM','DwqzU','gger','JqaJJ','lQgxw','cvcVp','McFep','549hqmKww','countDocuments','{}.constructor(\x22return\x20this\x22)(\x20)','TeNJG','NGdin','QkWGr','row','mykBb','usfWF','Zlupu','stringify','Buqhb','push','UvovG','dxJvn','dGqWx','hUjzO','ARoxQ','เกิดข้อผิดพลาดขณะลบ\x20\x22','while\x20(true)\x20{}','RbKNq','noUYd','debu','UcjIg','trim','cMmOG','NqfvY','ผู้จัดจำหน่าย\x20[','supplierStatus','.xlsx','NBHDk','176691DJDKWx','render','map','IHeEO','CqJMn','wcspY','&load_id=','yATeA','exception','filter','yellow','vTCkr','THrBc','TjivD','userFlash','lbIXF','SheetNames','Qqxed','UiMYu','supplierType','call','JeGZq','ludyj','HjEwE','pqVxj','VAyOt','DhXXt','supplierIdentityId','alTbo','eIYnd','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','อัปเดท\x20\x22','ApHnz','file','JDifI','CsaXW','TASzB','acknowledged','lSVwt','{{sep}}[\x20บันทึกการแก้ไข\x20]','ceil','isOS','QQqnQ','close','YmpHV','CuvgS','supplierAddress1','BtbRw','active','abZjJ','ไม่มีข้อมูลที่จะพิมพ์','tEzqk','limit','xHnTg','supplierPhone','aNpXA','\x22{{sep}}ไม่มีอะไรเปลี่ยนแปลง','msg','4688276CRIFTr','EoHJB','supplierTaxId','bnNDT','Ndrsn','KLAMd','16028136aErNSE','wrLNC','ZVXYX','zncVZ','hfvzh','ZKSEM','kagIv','rFLVU','qJaZF','fkcwS','vFlOo','WIPMw','log','atnMW','UgSuW','moYIB','insertedId','ccLzM','ISoPJ','/myModule.js','gQuPj','SCaVa','QEGaX','orKwQ','LVILX','Tnpia','RWjBq','EEYSD','IwpEt','json_to_sheet','getSessionData','pTfyJ','OaAQF','chain','updateOne','redirect','aLZVI','FHXlF','getDateTime','TxWPG','SSQuf','kbXLZ','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','fHrJc','XWpLb','has','HjsSt','yjDaY','ahUUD','DPbXN','1056evxTzq','gEACc','MPryr','padStart','EUgae','_id','cqofT','forEach','gprmD','cwAsS','otWBb','/changes','MgYnz','ZnwoL','getChangeHistory','write','LucXj','DQOjh','ZvqKV','ลบ\x20\x22','getDate','vGhVl','deletedCount','jFJHT','insertOne','zwESO','suppliers_','tJTFv','dbColl_warehouseIn','rjryk','SMIvs','fwqhs','?sip=','nPEkE','xlsx','MaGtH','QEJUY','console','nKmNM','TcKYH','/delete','ceaZq','EZPBa','rpp','ejOlJ','GjfmW','416kYlRgE','YXOKB','KfBzS','QYHcW','ไม่พบ\x20\x22','{{sep}}เพิ่มใหม่\x20','return\x20(function()\x20','$supplierId','modifiedCount','riOwi','hqfgU','SQBXj','KdOAk','sort','pdeVB','Ewmmf','Ouxvb','vcoua','sheet_to_json','supplierContactPerson','sJUig','AvsGd','find','input','minute','EAnkK','zKcuV','TKIPC','\x22\x20ซ้ำ{{sep}}\x20โปรดติดต่อผู้ดูแลระบบ','GZHaA','อัปเดท\x20','mpcxM','qqQbj','dbName','fuAKj','ZqpbB','UxBsQ','supplierAddress2','some','มี\x20supplierId\x20ซ้ำกัน:\x20\x22','action','gxsXH','aggregate','bBjKM','trace','cyUYz','dIDuo','XoXtz','cCwqC','kqmhR','YkfRc','ผู้จัดจำหน่าย\x20\x22','/suppliers','OGwSU','pjYau','dJBQP','hHTQE','FGvjl','green','ZEwgy','xWCFj','eulQj','ADpoF','supplierProvince','toArray','info','{{sep}}\x22','table','DPeyV','FchEh','ไม่พบประวัติการเปลี่ยนแปลง','Not\x20Found','Tnjwt','kVJPz','OVZCK','knljP','rmiLS','AdlFg','tPmDQ','FkfCl','jnVBH','WCfLP','memoryStorage','XgbPv','slice','page','EYzKQ','KvHqC','Ongbs','ZBTPy','TCnne','NBXrZ','IhfKH','BRsuC','xhgQK','toString','changesHistory','body','$changesHistory','&page=','post','OJyHh','Rnlve','XgRkj','sOeZH','bEvEk','constructor','เพิ่ม\x20\x22','Vxuix','get','sendFile','XGGky','print_suppliers.ejs','UuwEh','red','20NCKGCB','doc_changes.ejs','$dateTimeCanDelete','HnwFy','/print','tNxXy','upsertedCount','fSOLe','Not\x20Inserted','cCrSh','ZLcKF','IUlXi','stateObject','vpxCc','hasOwnProperty','UBIsM','edsjx','MHgqP','fbmAd','dCuwi','BpgWm','IVwch','yKdnt','fTTua','utils','supplierId','fcaBd','TAXID_PATTERN','kCusC','DIqfc','xzHXK','dAjgK','base64','dbColl_suppliers','FgtfX','ytySk','counter','replace','9203161iPJxwX','buffer','ufHsU','fmFlM','includes','qzHxJ','apply','lLjRZ','suppliers','connect','matchedCount','deleteOne','RrDgr','YaUjN','/import','zzfTu','CEfMN','status','ZzCPc','zjfOW','AzOxP','rkMDO','bSGCB','collection','\x5c$&','GSTMW','load_id','rzYsZ','UyXXH','add','XBEXy','flash','message','&rpp=','ewmha','5sUIoeq','bind','oUjmt','S0001','xiAHF','luxsc','1398tzBBgi','WLNps','Error\x20while\x20deleting','parse','MtXgZ','from','BHsUs','UnKqz','function\x20*\x5c(\x20*\x5c)','VwrWm','ZQxBM','__proto__','IyKed','TqBQR','OXKLm','query','Router','OCYBt','Jgbwv','sPdjd','SqDKP','vgYUT','supplierName','8344KWJlIB','ijCMx','\x22\x20เรียบร้อยแล้ว','RqamV','ngqJw','npYit','dateTimeCanDelete','LRdSi','COCYP','/load','unshift','205144ucOlHJ','string','KTNyg','../','MdANP','rMPah','error','userFullname','RNVmz','ehimt','Xrdux','hKQfC','length','join','sfoka','gklUe','EkOlC','UrbDR','Caloe','test','entries','BvLXd','vQzuh','iEAZP','hTceu','error\x20===>\x20','send','prototype','findOne','Seajf','ชีท\x20\x27items\x27\x20มีข้อมูลผิดพลาดที่แถว\x20','fPidi','QVyIJ','vXZdM','init','sip'];_0x1d1f=function(){return _0x4a3ec5;};return _0x1d1f();}_0x348d85();import _0x5267cf from'express';const w=_0x5267cf[_0x486515(0xe9)]();import{MongoClient as _0x312601,ObjectId as _0x284d57}from'mongodb';import _0x202efe from'xlsx';import _0xbeb3b3 from'multer';import _0x4b3f57 from'ejs';import _0x4715ba from'fs';import _0x3d88ee from'path';import _0x5426aa from'../middleware/mainAuth.js';const E=await import(_0x486515(0xfe)+mymoduleFolder+_0x486515(0x19b)),N=await import(_0x486515(0xfe)+mymoduleFolder+'/myDateTime.js'),H=await import(_0x486515(0xfe)+mymoduleFolder+'/myUsers.js'),G=await import(_0x486515(0xfe)+mymoduleFolder+'/myData.js'),u=_0x486515(0x21c),F=u+'/save',R=u+_0x486515(0xf9),k=u+_0x486515(0x1e2),B=u+_0x486515(0xbe),v=u+_0x486515(0x25f),L=u+_0x486515(0x1c5),J=u+'/download-excel',M=u+'/upload-excel',Z=u[_0x486515(0x280)](/\//g,'_');w[_0x486515(0x255)](u,_0x5426aa[_0x486515(0x171)],async(_0x368887,_0x35dcef)=>{const _0x2b9c20=_0x486515,_0x5502b4={'ceaZq':function(_0x4c5a63){return _0x4c5a63();},'OJyHh':_0x2b9c20(0x181),'NBHDk':'red','OVXTi':_0x2b9c20(0x114),'vURHc':_0x2b9c20(0xe1),'IHeEO':_0x2b9c20(0x166),'zwESO':function(_0x3be323,_0x14eadb){return _0x3be323(_0x14eadb);},'bfKEX':_0x2b9c20(0x11d),'MaGtH':function(_0x58c43e,_0x26c52d){return _0x58c43e+_0x26c52d;},'QEGaX':_0x2b9c20(0x1a9),'vXZdM':_0x2b9c20(0x1ff),'jFJHT':function(_0x24576e){return _0x24576e();},'UBIsM':function(_0x43a769,_0x11720d,_0x37a6cd){return _0x43a769(_0x11720d,_0x37a6cd);},'CEfMN':function(_0x473836,_0x29df24){return _0x473836(_0x29df24);},'qyeJr':function(_0x70bf83,_0x353724){return _0x70bf83*_0x353724;},'UoogN':function(_0x64425e,_0x963881){return _0x64425e-_0x963881;},'fcaBd':function(_0x5b7fff,_0x3d3bfd){return _0x5b7fff===_0x3d3bfd;},'TqBQR':_0x2b9c20(0x20a),'alTbo':_0x2b9c20(0x24a),'dGqWx':_0x2b9c20(0x25d),'ADpoF':_0x2b9c20(0x200),'zzbUg':function(_0x19cc5b,_0x36dea8){return _0x19cc5b===_0x36dea8;},'Caloe':_0x2b9c20(0x18b),'zdwUW':_0x2b9c20(0xc8),'IYTUi':function(_0x2d868c,_0x4d23bd){return _0x2d868c/_0x4d23bd;},'kVJPz':function(_0x536a7a,_0x2e679d){return _0x536a7a<_0x2e679d;},'ZLcKF':function(_0x2f9125,_0x524b12){return _0x2f9125-_0x524b12;},'bSGCB':function(_0x306d8f,_0x8ef86f){return _0x306d8f(_0x8ef86f);},'Seajf':function(_0x50d053,_0x291650){return _0x50d053>_0x291650;},'CsaXW':function(_0x1aee87,_0x4d40a9){return _0x1aee87+_0x4d40a9;},'pjYau':function(_0x2883b3,_0x348738){return _0x2883b3(_0x348738);},'yOBak':function(_0xe58df2,_0x281a10){return _0xe58df2+_0x281a10;},'JeyhC':function(_0x786807,_0x6334b5){return _0x786807===_0x6334b5;},'QXdda':_0x2b9c20(0x27e),'gklUe':_0x2b9c20(0xcc),'CqJMn':function(_0x1af05d,_0x50f87b){return _0x1af05d!==_0x50f87b;},'pqVxj':_0x2b9c20(0x112),'dIDuo':function(_0x25a495,_0x1fb938){return _0x25a495>_0x1fb938;},'GSTMW':_0x2b9c20(0xb8),'BpgWm':_0x2b9c20(0x156),'TxWPG':'ySuRa','JkPKG':function(_0x5786d1,_0xcbed6d){return _0x5786d1===_0xcbed6d;},'gEACc':_0x2b9c20(0x1c0),'hfvzh':_0x2b9c20(0x1fc)},_0x2e21ac=_0x368887[_0x2b9c20(0xe8)]['sip']?.[_0x2b9c20(0x141)]()['replace'](/[$.*?]/g,'\x20')||'',_0x5647c5=_0x5502b4[_0x2b9c20(0x1d3)](Number,_0x368887[_0x2b9c20(0xe8)]['rpp'])||0x14,_0x15546f=_0x5502b4[_0x2b9c20(0x1d3)](Number,_0x368887[_0x2b9c20(0xe8)]['page'])||0x1,_0x4b287d=_0x368887[_0x2b9c20(0xe8)]['load_id']||'',_0x231b1f=_0x5502b4[_0x2b9c20(0xc0)](Number,_0x5502b4['qyeJr'](_0x5502b4[_0x2b9c20(0x121)](_0x15546f,0x1),_0x5647c5)),_0x39b75b=new _0x312601(dbUrl);try{if(_0x5502b4[_0x2b9c20(0x275)](_0x5502b4[_0x2b9c20(0xe6)],_0x5502b4[_0x2b9c20(0xe6)])){const _0x4316b9=N[_0x2b9c20(0x1ae)](),_0x5ec153={'_id':0x1,'supplierId':0x1,'supplierStatus':0x1,'supplierType':0x1,'supplierName':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierWebsite':0x1,'supplierEmail':0x1,'supplierIdentityId':0x1,'supplierTaxId':0x1,'supplierContactPerson':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x5502b4[_0x2b9c20(0x164)],[]]}},'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x4316b9},'endDate':{'$toDate':_0x5502b4[_0x2b9c20(0x138)]},'unit':_0x5502b4[_0x2b9c20(0x226)]}},0x0]},'then':!0x0,'else':!0x1}}};await _0x39b75b[_0x2b9c20(0xb9)]();const _0x26b61c=_0x39b75b['db'](dbName)['collection'](global['dbColl_suppliers']);if(_0x2e21ac){if(_0x5502b4['zzbUg'](_0x5502b4[_0x2b9c20(0x10d)],_0x5502b4[_0x2b9c20(0x10d)])){const _0x401a6b=new RegExp(_0x2e21ac[_0x2b9c20(0x280)](/[.*+?^${}()|[\]\\]/g,_0x5502b4['zdwUW']),'i');var _0x18cf41=await _0x26b61c['countDocuments']({'$or':[{'supplierId':{'$regex':_0x401a6b}},{'supplierName':{'$regex':_0x401a6b}}]});}else bfZwlq[_0x2b9c20(0x1e3)](_0x5e4b14);}else var _0x18cf41=await _0x26b61c[_0x2b9c20(0x12a)]({});const _0x2709ce=Math[_0x2b9c20(0x170)](_0x5502b4['IYTUi'](_0x18cf41,_0x5647c5)),_0x323ce1=_0x5502b4[_0x2b9c20(0x231)](_0x5502b4[_0x2b9c20(0x121)](_0x5502b4[_0x2b9c20(0xc0)](Number,_0x15546f),0x1),0x1)?'-':_0x5502b4[_0x2b9c20(0x265)](_0x5502b4[_0x2b9c20(0xc6)](Number,_0x15546f),0x1),_0x13a692=_0x5502b4[_0x2b9c20(0x1d3)](Number,_0x15546f),_0x24a40f=_0x5502b4[_0x2b9c20(0x118)](_0x5502b4[_0x2b9c20(0x16b)](_0x5502b4[_0x2b9c20(0x21e)](Number,_0x15546f),0x1),_0x2709ce)?'-':_0x5502b4['yOBak'](_0x5502b4['zwESO'](Number,_0x15546f),0x1),_0x40a66d=[{'$project':_0x5ec153},{'$sort':{'supplierId':0x1}},{'$skip':_0x231b1f},{'$limit':_0x5647c5}];if(_0x2e21ac){if(_0x5502b4['JeyhC'](_0x5502b4['QXdda'],_0x5502b4[_0x2b9c20(0x10a)]))_0x261d90[_0x2b9c20(0x173)]();else{const _0x2bdb2c=_0x2e21ac?new RegExp(''+_0x2e21ac,'i'):new RegExp('.*');_0x40a66d['unshift']({'$match':{'$or':[{'supplierId':{'$regex':_0x2bdb2c}},{'supplierName':{'$regex':_0x2bdb2c}}]}});}}const _0x34765a=await _0x26b61c['aggregate'](_0x40a66d)[_0x2b9c20(0x228)]();if(_0x4b287d){if(_0x5502b4[_0x2b9c20(0x14c)](_0x5502b4[_0x2b9c20(0x160)],_0x5502b4[_0x2b9c20(0x160)])){const _0x51a1d2=_0x28f17f?function(){const _0x3097ee=_0x2b9c20;if(_0x25710c){const _0x5e27ef=_0x431053[_0x3097ee(0xb6)](_0x116bb9,arguments);return _0x105b61=null,_0x5e27ef;}}:function(){};return _0x53bfa4=![],_0x51a1d2;}else{var _0x585f98=_0x34765a[_0x2b9c20(0x151)](_0x29ead9=>_0x29ead9[_0x2b9c20(0x1bf)]==_0x4b287d);if(_0x5502b4[_0x2b9c20(0x216)](_0x585f98[_0x2b9c20(0x107)],0x0))var _0x11f28a=_0x585f98[0x0];else var _0x11f28a=await _0x26b61c['findOne']({'_id':new _0x284d57(_0x4b287d)});}}const _0x190b1a=await E['renderView'](_0x5502b4[_0x2b9c20(0xc9)],_0x35dcef,{'title':PAGE_SUPPLIERS,'time':N[_0x2b9c20(0x1ce)](),'msg':_0x368887[_0x2b9c20(0xcf)](_0x5502b4[_0x2b9c20(0x24d)]),'userFlash':_0x368887[_0x2b9c20(0xcf)](_0x5502b4[_0x2b9c20(0x26f)]),'user':await H['getSessionData'](_0x368887),'settings':await E['getSettings'](),'load_id':_0x4b287d,'sip':_0x2e21ac,'rpp':_0x5647c5,'page':_0x15546f,'pagePre':_0x323ce1,'pageAct':_0x13a692,'pageNxt':_0x24a40f,'pageLst':_0x2709ce,'pageRedirect':''+u,'PATH_MAIN':u,'PATH_SAVE':F,'PATH_LOAD':R,'PATH_DELETE':k,'PATH_IMPORT':B,'PATH_PRINT':v,'PATH_CHANGES':L,'PATH_DOWNLOAD_EXCEL':J,'PATH_UPLOAD_EXCEL':M,'PREFIX':Z,'data':_0x34765a,'item':_0x11f28a});_0x35dcef['send'](_0x190b1a);}else _0x492f77[_0x2b9c20(0x194)](_0x43cd40),_0x35473e['flash'](_0x5502b4[_0x2b9c20(0x24d)],{'class':_0x5502b4[_0x2b9c20(0x147)],'text':''+_0x5474b1[_0x2b9c20(0xd0)]}),_0xd58418[_0x2b9c20(0xc1)](0x194)[_0x2b9c20(0x256)](_0x3d93d5);}catch(_0x5041b8){_0x5502b4['CqJMn'](_0x5502b4[_0x2b9c20(0x1af)],_0x5502b4[_0x2b9c20(0x1af)])?(_0x19c15e[_0x2b9c20(0x194)](_0x5502b4['OVXTi'],_0x1f6d6a),_0x29497f[_0x2b9c20(0x115)](_0x50b611['stringify']({'isPrint':!0x1,'class':_0x5502b4['NBHDk'],'msg':_0x1c0415[_0x2b9c20(0xd0)]}))):(console[_0x2b9c20(0x194)](_0x5041b8),_0x35dcef[_0x2b9c20(0xc1)](0x194)[_0x2b9c20(0x256)](file404));}finally{if(_0x5502b4['JkPKG'](_0x5502b4[_0x2b9c20(0x1bb)],_0x5502b4[_0x2b9c20(0x18c)])){const _0x419d58={'Xrdux':bfZwlq['vURHc'],'eulQj':bfZwlq[_0x2b9c20(0x14b)],'pajLA':function(_0x4df00a,_0x1b5a87){const _0x5cee05=_0x2b9c20;return bfZwlq[_0x5cee05(0x1d3)](_0x4df00a,_0x1b5a87);},'hqfgU':bfZwlq['bfKEX'],'bAqbc':function(_0x30a9d7,_0x32a202){const _0x1cf9ad=_0x2b9c20;return bfZwlq[_0x1cf9ad(0x1dd)](_0x30a9d7,_0x32a202);},'QNOhE':bfZwlq[_0x2b9c20(0x19e)],'ehimt':function(_0x2785a8,_0x234d74){return bfZwlq['MaGtH'](_0x2785a8,_0x234d74);},'qJaZF':bfZwlq[_0x2b9c20(0x11c)],'uodyg':function(_0xeda32b,_0x4fb1f2){const _0x5a1387=_0x2b9c20;return bfZwlq[_0x5a1387(0x1d3)](_0xeda32b,_0x4fb1f2);},'JmBRb':function(_0x41d646){const _0x45077d=_0x2b9c20;return bfZwlq[_0x45077d(0x1d1)](_0x41d646);}};bfZwlq[_0x2b9c20(0x26a)](_0xacf867,this,function(){const _0x37e52d=_0x2b9c20,_0x64baf4=new _0x5dbec8(_0x419d58[_0x37e52d(0x105)]),_0x41b32b=new _0x11804e(_0x419d58[_0x37e52d(0x225)],'i'),_0x1d9178=_0x419d58['pajLA'](_0x541c92,_0x419d58[_0x37e52d(0x1f2)]);!_0x64baf4[_0x37e52d(0x10e)](_0x419d58['bAqbc'](_0x1d9178,_0x419d58['QNOhE']))||!_0x41b32b[_0x37e52d(0x10e)](_0x419d58[_0x37e52d(0x104)](_0x1d9178,_0x419d58[_0x37e52d(0x190)]))?_0x419d58['uodyg'](_0x1d9178,'0'):_0x419d58['JmBRb'](_0x2bc381);})();}else _0x39b75b[_0x2b9c20(0x173)]();}}),w[_0x486515(0x24c)](R,_0x5426aa['isOS'],async(_0x5b6fa2,_0x42c8c2)=>{const _0x33c9aa=_0x486515,_0x32067a={'UuwEh':'error\x20===>\x20','hKQfC':_0x33c9aa(0x25a),'TcKYH':function(_0x48301c,_0x4c2e17){return _0x48301c+_0x4c2e17;},'WLNps':_0x33c9aa(0x13f),'UXbsG':'gger','BvLXd':_0x33c9aa(0x267),'npYit':function(_0x50da77,_0x4c82ae){return _0x50da77(_0x4c82ae);},'hTceu':function(_0x519d24,_0xabea58){return _0x519d24(_0xabea58);},'qqQbj':function(_0x2f862b,_0x2e3d7b){return _0x2f862b!==_0x2e3d7b;},'buGaA':_0x33c9aa(0x1a8),'xWCFj':_0x33c9aa(0x134),'xHnTg':'msg','HJoXp':_0x33c9aa(0x22f),'ISoPJ':'HkXjy','MtXgZ':function(_0x57130f,_0x335ad1){return _0x57130f!==_0x335ad1;},'abZjJ':_0x33c9aa(0x128)},_0x5da94a=_0x5b6fa2['body'][_0x33c9aa(0xca)],_0x4e3e6a=_0x5b6fa2['body'][_0x33c9aa(0x11e)],_0x174832=_0x32067a[_0x33c9aa(0xf5)](Number,_0x5b6fa2[_0x33c9aa(0x249)][_0x33c9aa(0x1e5)])||0x14,_0x2605d9=_0x32067a[_0x33c9aa(0x113)](Number,_0x5b6fa2['body'][_0x33c9aa(0x23d)])||0x1,_0x3d2627=u+'?sip='+_0x4e3e6a+'&rpp='+_0x174832+_0x33c9aa(0x24b)+_0x2605d9+_0x33c9aa(0x14e)+_0x5da94a,_0x19bbab=new _0x312601(dbUrl);try{return _0x32067a[_0x33c9aa(0x208)](_0x32067a['buGaA'],_0x32067a[_0x33c9aa(0x224)])?(await _0x19bbab['db'](dbName)['collection'](global['dbColl_suppliers'])[_0x33c9aa(0x117)]({'_id':new _0x284d57(_0x5da94a)},{'projection':{'changesHistory':0x0}})?_0x5b6fa2['flash'](_0x32067a['xHnTg'],null):_0x5b6fa2[_0x33c9aa(0xcf)](_0x32067a[_0x33c9aa(0x17d)],{'class':_0x32067a[_0x33c9aa(0x106)],'text':new Error(_0x32067a['HJoXp'])+'{{sep}}\x22'+_0x5da94a+'\x22'}),_0x42c8c2[_0x33c9aa(0x1ab)](_0x3d2627)):(_0x568668[_0x33c9aa(0x194)](_0x32067a[_0x33c9aa(0x259)],_0x149b6c),_0x3a42fb['send']({'isDownload':!0x1,'color':_0x32067a[_0x33c9aa(0x106)],'msg':_0x1e7e8a[_0x33c9aa(0xd0)]}));}catch(_0x568fc1){if(_0x32067a['qqQbj'](_0x32067a['ISoPJ'],_0x32067a[_0x33c9aa(0x19a)]))(function(){return![];}[_0x33c9aa(0x252)](bLvWEO[_0x33c9aa(0x1e1)](bLvWEO[_0x33c9aa(0xda)],bLvWEO['UXbsG']))['apply'](bLvWEO[_0x33c9aa(0x110)]));else return _0x5b6fa2[_0x33c9aa(0xcf)](_0x32067a[_0x33c9aa(0x17d)],{'class':_0x32067a[_0x33c9aa(0x106)],'text':''+_0x568fc1['message']}),_0x42c8c2[_0x33c9aa(0x1ab)](_0x3d2627);}finally{_0x32067a[_0x33c9aa(0xdd)](_0x32067a[_0x33c9aa(0x179)],_0x32067a[_0x33c9aa(0x179)])?_0x5006c0[_0x33c9aa(0x173)]():_0x19bbab[_0x33c9aa(0x173)]();}}),w[_0x486515(0x24c)](F,_0x5426aa[_0x486515(0x171)],async(_0x4bed05,_0x5b1881)=>{const _0x633f0a=_0x486515,_0x34b0d9={'UiMYu':function(_0x17bf0e,_0x202500){return _0x17bf0e(_0x202500);},'YmpHV':'red','fPidi':function(_0x5ba6ae,_0x5b1da3){return _0x5ba6ae+_0x5b1da3;},'ejOlJ':_0x633f0a(0x13f),'SEzGo':_0x633f0a(0x124),'cCwqC':'action','nxMsd':function(_0x1b1bd4,_0x1838b2){return _0x1b1bd4!==_0x1838b2;},'EkOlC':_0x633f0a(0x1d9),'fbmAd':_0x633f0a(0xdf),'lbIXF':function(_0x2bf2ac,_0xa7483c){return _0x2bf2ac===_0xa7483c;},'SCaVa':_0x633f0a(0xd8),'THrBc':function(_0x1f0e46,_0x1c80c0){return _0x1f0e46!==_0x1c80c0;},'cyUYz':_0x633f0a(0xf1),'ZzCPc':_0x633f0a(0x181),'dxQZu':function(_0x22edfe,_0x40ffc5){return _0x22edfe==_0x40ffc5;},'XgRkj':_0x633f0a(0x217),'zsOAw':function(_0x3ee1a7,_0x2c1168){return _0x3ee1a7>_0x2c1168;},'nkGJW':_0x633f0a(0x1b3),'RqamV':_0x633f0a(0x16f),'usfWF':_0x633f0a(0x222),'moYIB':function(_0x4d4160,_0x1a8a17){return _0x4d4160<_0x1a8a17;},'wKIvS':_0x633f0a(0x152),'rFLVU':_0x633f0a(0x22f),'EUgae':function(_0x1bc4c2,_0x1a25bd){return _0x1bc4c2!==_0x1a25bd;},'Ongbs':_0x633f0a(0xc4),'vgYUT':_0x633f0a(0xd7),'ZEwgy':_0x633f0a(0xd6),'oUjmt':_0x633f0a(0x246),'QQqnQ':function(_0x3a2f27,_0x505744){return _0x3a2f27+_0x505744;},'TCnne':_0x633f0a(0x1e0),'bBjKM':_0x633f0a(0x263),'jnVBH':_0x633f0a(0x11b),'UcjIg':'ZikPv','GnOfq':_0x633f0a(0x257),'IVwch':_0x633f0a(0x14d)},_0x16d27e=_0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x274)],_0x2fd637=_0x4bed05[_0x633f0a(0x249)]['_id'],_0x457f77=_0x4bed05[_0x633f0a(0x249)]['sip'],_0x24a9cc=_0x34b0d9['UiMYu'](Number,_0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x1e5)])||0x14,_0x53c89c=_0x34b0d9[_0x633f0a(0x15a)](Number,_0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x23d)])||0x1,_0xb5b648=u+_0x633f0a(0x1da)+_0x457f77+_0x633f0a(0xd1)+_0x24a9cc+'&page='+_0x53c89c+_0x633f0a(0x14e)+_0x2fd637;delete _0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x1bf)],delete _0x4bed05['body'][_0x633f0a(0x11e)],delete _0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x1e5)],delete _0x4bed05[_0x633f0a(0x249)]['page'],delete _0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x274)];const _0x3124da=new _0x312601(dbUrl);try{if(_0x34b0d9['nxMsd'](_0x34b0d9[_0x633f0a(0x10b)],_0x34b0d9[_0x633f0a(0x26d)])){await _0x3124da[_0x633f0a(0xb9)]();const _0x394c76=_0x3124da['db'](dbName)[_0x633f0a(0xc7)](global[_0x633f0a(0x27c)]);if(_0x2fd637){if(_0x34b0d9[_0x633f0a(0x157)](_0x34b0d9[_0x633f0a(0x19d)],_0x34b0d9[_0x633f0a(0x19d)])){if(_0x2fd637){if(_0x34b0d9['THrBc'](_0x34b0d9[_0x633f0a(0x215)],_0x34b0d9['cyUYz']))return![];else{const _0x2951b2=await _0x394c76['findOne']({'_id':new _0x284d57(_0x2fd637)});if(!_0x2951b2)return _0x4bed05[_0x633f0a(0xcf)](_0x34b0d9['ZzCPc'],{'class':_0x34b0d9[_0x633f0a(0x174)],'text':'ไม่พบ\x20'+_0x16d27e}),_0x5b1881[_0x633f0a(0x1ab)](u);const _0x1e9772=await _0x394c76[_0x633f0a(0x1aa)]({'_id':new _0x284d57(_0x2fd637)},{'$set':_0x4bed05[_0x633f0a(0x249)]},{'upsert':!0x1});if(_0x1e9772[_0x633f0a(0x16d)]&&_0x34b0d9['dxQZu'](_0x1e9772[_0x633f0a(0x1f0)],0x1)){if(_0x34b0d9[_0x633f0a(0x157)](_0x34b0d9[_0x633f0a(0x24f)],_0x34b0d9['XgRkj'])){let _0x5be9ff=_0x633f0a(0x167)+_0x16d27e+_0x633f0a(0xf2);const _0x60f386=G[_0x633f0a(0x1c8)](_0x2951b2,_0x4bed05[_0x633f0a(0x249)]);if(_0x60f386&&_0x34b0d9['zsOAw'](_0x60f386[_0x633f0a(0x107)],0x0)){if(_0x34b0d9[_0x633f0a(0x157)](_0x34b0d9['nkGJW'],_0x34b0d9['nkGJW'])){const _0x26aef1=await H[_0x633f0a(0x1a6)](_0x4bed05),_0x2797fd={'dateTime':N['getDateTime'](),'userId':_0x26aef1['userId'],'userFullname':_0x26aef1[_0x633f0a(0x102)],'changes':_0x60f386};await _0x394c76['updateOne']({'supplierId':_0x16d27e},{'$push':{'changesHistory':{'$each':[_0x2797fd],'$position':0x0}}}),_0x5be9ff+=_0x34b0d9[_0x633f0a(0xf3)];}else RyPNxO[_0x633f0a(0x15a)](_0x4ab79d,'0');}return _0x4bed05[_0x633f0a(0xcf)](_0x34b0d9[_0x633f0a(0xc2)],{'class':_0x34b0d9[_0x633f0a(0x131)],'text':_0x5be9ff}),_0x5b1881[_0x633f0a(0x1ab)](_0xb5b648);}else _0x3224bb=_0x4cd271;}else return _0x1e9772[_0x633f0a(0x16d)]&&_0x34b0d9[_0x633f0a(0x197)](_0x1e9772[_0x633f0a(0x1f0)],0x1)?(_0x4bed05[_0x633f0a(0xcf)](_0x34b0d9[_0x633f0a(0xc2)],{'class':_0x34b0d9['wKIvS'],'text':'\x22'+_0x16d27e+_0x633f0a(0x180)}),_0x5b1881[_0x633f0a(0x1ab)](_0xb5b648)):(_0x4bed05[_0x633f0a(0xcf)](_0x34b0d9['ZzCPc'],{'class':_0x34b0d9[_0x633f0a(0x174)],'text':new Error(_0x34b0d9[_0x633f0a(0x18f)])+_0x633f0a(0x22a)+_0x16d27e+'\x22'}),_0x5b1881[_0x633f0a(0x1ab)](u));}}}else return _0x1a8181;}else{if(_0x34b0d9[_0x633f0a(0x1be)](_0x34b0d9[_0x633f0a(0x240)],_0x34b0d9[_0x633f0a(0xee)])){let _0x325050=_0x34b0d9[_0x633f0a(0x223)];const _0x13b3b0=await _0x394c76[_0x633f0a(0x1fe)]({},{'projection':{'supplierId':0x1}})[_0x633f0a(0x1f5)]({'supplierId':-0x1})[_0x633f0a(0x17c)](0x1)['toArray']();if(_0x34b0d9['zsOAw'](_0x13b3b0['length'],0x0)){if(_0x34b0d9[_0x633f0a(0x157)](_0x34b0d9[_0x633f0a(0xd5)],_0x34b0d9[_0x633f0a(0xd5)])){const _0x2e8e91=_0x13b3b0[0x0][_0x633f0a(0x274)][_0x633f0a(0x23c)](0x1),_0x3cea10=_0x34b0d9[_0x633f0a(0x15a)](Number,_0x2e8e91);_0x325050='S'+_0x34b0d9[_0x633f0a(0x15a)](String,_0x34b0d9[_0x633f0a(0x172)](_0x3cea10,0x1))[_0x633f0a(0x1bd)](0x4,'0');}else _0x301568[_0x633f0a(0x173)]();}if(_0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x274)]=_0x325050,_0x4bed05['body'][_0x633f0a(0xf6)]=N[_0x633f0a(0x1ae)](0x5a0),await _0x394c76[_0x633f0a(0x117)]({'supplierId':_0x325050}))return _0x4bed05['flash'](_0x34b0d9[_0x633f0a(0xc2)],{'class':_0x34b0d9[_0x633f0a(0x174)],'text':'\x22'+_0x325050+_0x633f0a(0x204)}),_0x5b1881[_0x633f0a(0x1ab)](u);const _0x53f075=await _0x394c76[_0x633f0a(0x1d2)](_0x4bed05['body']);if(_0x53f075[_0x633f0a(0x16d)]&&_0x53f075[_0x633f0a(0x198)]){if(_0x34b0d9[_0x633f0a(0x157)](_0x34b0d9[_0x633f0a(0x242)],_0x34b0d9[_0x633f0a(0x242)])){const _0x286599=u+_0x633f0a(0x1da)+_0x457f77+_0x633f0a(0xd1)+_0x24a9cc+_0x633f0a(0x24b)+_0x53c89c+_0x633f0a(0x14e)+_0x53f075[_0x633f0a(0x198)];return _0x4bed05[_0x633f0a(0xcf)](_0x34b0d9[_0x633f0a(0xc2)],{'class':_0x34b0d9[_0x633f0a(0x131)],'text':_0x633f0a(0x253)+_0x4bed05[_0x633f0a(0x249)][_0x633f0a(0x274)]+_0x633f0a(0xf2)}),_0x5b1881[_0x633f0a(0x1ab)](_0x286599);}else{const _0x5a29fe=_0xf84647[_0x633f0a(0xde)](new _0x119946(_0x33a643[_0x633f0a(0x14a)](_0xeeead=>_0x3f952d['stringify'](_0xeeead))))[_0x633f0a(0x14a)](_0x3e8e43=>_0x38ff6c[_0x633f0a(0xdc)](_0x3e8e43));return _0x9452d5[_0x633f0a(0x115)]({'isUpload':!0x1,'color':_0x34b0d9[_0x633f0a(0x174)],'msg':'ชีท\x20\x27items\x27\x20มีข้อมูลผิดพลาดที่แถว\x20'+_0x5a29fe[_0x633f0a(0x14a)](_0x3c8c9e=>_0x3c8c9e[_0x633f0a(0x12f)])[_0x633f0a(0x108)](',\x20'),'errorRows':_0x5a29fe});}}else return _0x4bed05['flash'](_0x34b0d9['ZzCPc'],{'class':_0x34b0d9[_0x633f0a(0x174)],'text':new Error(_0x34b0d9[_0x633f0a(0x213)])+_0x633f0a(0x22a)+_0x325050+'\x22'}),_0x5b1881[_0x633f0a(0x1ab)](u);}else(function(){return!![];}[_0x633f0a(0x252)](RyPNxO[_0x633f0a(0x11a)](RyPNxO[_0x633f0a(0x1e6)],RyPNxO['SEzGo']))[_0x633f0a(0x15c)](RyPNxO[_0x633f0a(0x218)]));}}else _0x4c7683[_0x633f0a(0x194)](_0x2db7be),_0x473e63[_0x633f0a(0xc1)](0x194)[_0x633f0a(0x256)](_0x2c8f27);}catch(_0x287865){if(_0x34b0d9[_0x633f0a(0x154)](_0x34b0d9[_0x633f0a(0x238)],_0x34b0d9[_0x633f0a(0x140)]))console['log'](_0x287865),_0x4bed05[_0x633f0a(0xcf)](_0x34b0d9[_0x633f0a(0xc2)],{'class':_0x34b0d9[_0x633f0a(0x174)],'text':''+_0x287865[_0x633f0a(0xd0)]}),_0x5b1881['status'](0x194)['sendFile'](file404);else{const _0x10ad4d=_0x40716e[_0x633f0a(0xb6)](_0x34c190,arguments);return _0x1f631e=null,_0x10ad4d;}}finally{if(_0x34b0d9[_0x633f0a(0x1be)](_0x34b0d9['GnOfq'],_0x34b0d9[_0x633f0a(0x270)]))_0x3124da[_0x633f0a(0x173)]();else{if(_0x4f961d){const _0x539839=_0x4dff0a['apply'](_0x5569d4,arguments);return _0x3671f7=null,_0x539839;}}}}),w[_0x486515(0x24c)](k,_0x5426aa['isOS'],async(_0x4a126a,_0xf4a59c)=>{const _0x4c0e2f=_0x486515,_0x3ec04b={'Zlupu':function(_0x324a1f,_0x17d52e){return _0x324a1f(_0x17d52e);},'StTru':function(_0x351525,_0x5fe1be){return _0x351525+_0x5fe1be;},'ewmha':function(_0x214abc,_0xe3f8ba){return _0x214abc+_0xe3f8ba;},'dAjgK':_0x4c0e2f(0x1ee),'MdANP':'{}.constructor(\x22return\x20this\x22)(\x20)','kdDnR':function(_0x126db1,_0x3aac6a){return _0x126db1(_0x3aac6a);},'ARoxQ':function(_0x1bfa9c,_0x59b97a){return _0x1bfa9c!=_0x59b97a;},'dJBQP':function(_0x5ad607,_0x45de6b){return _0x5ad607!==_0x45de6b;},'wrLNC':_0x4c0e2f(0x235),'RbKNq':'gGBUH','fTTua':_0x4c0e2f(0x181),'YaUjN':_0x4c0e2f(0x25a),'orKwQ':function(_0x414d91,_0x1c23bf){return _0x414d91===_0x1c23bf;},'TASzB':_0x4c0e2f(0x222),'dxJvn':_0x4c0e2f(0xdb),'sOeZH':function(_0x1ce76c,_0x1cdb6a){return _0x1ce76c===_0x1cdb6a;},'gprmD':_0x4c0e2f(0x19c),'vcoua':_0x4c0e2f(0x14f),'yACMn':_0x4c0e2f(0x284),'QYHcW':_0x4c0e2f(0x262)},{idToDelete:_0x4cc847,load_id:_0x2add69,sip:_0x4185fe}=_0x4a126a[_0x4c0e2f(0x249)],_0x472ba4=_0x4a126a[_0x4c0e2f(0x249)]['supplierId'],_0x8272ed=_0x3ec04b['kdDnR'](Number,_0x4a126a[_0x4c0e2f(0x249)]['rpp'])||0x14,_0x1ddb99=_0x3ec04b['kdDnR'](Number,_0x4a126a[_0x4c0e2f(0x249)]['page'])||0x1,_0x4ed44c=_0x2add69&&_0x3ec04b[_0x4c0e2f(0x13a)](_0x2add69,_0x4cc847)?'&load_id='+_0x2add69:'',_0xe1e6e8=u+_0x4c0e2f(0x1da)+_0x4185fe+_0x4c0e2f(0xd1)+_0x8272ed+'&page='+_0x1ddb99+_0x4ed44c,_0x5cf759=new _0x312601(dbUrl);try{if(_0x3ec04b[_0x4c0e2f(0x21f)](_0x3ec04b[_0x4c0e2f(0x189)],_0x3ec04b[_0x4c0e2f(0x13d)])){await _0x5cf759[_0x4c0e2f(0xb9)]();const _0x12cc44=_0x5cf759['db'](dbName),_0x4674bf=_0x12cc44[_0x4c0e2f(0xc7)](global[_0x4c0e2f(0x27c)]);if(!await _0x4674bf['findOne']({'_id':new _0x284d57(_0x4cc847)}))return _0x4a126a[_0x4c0e2f(0xcf)](_0x3ec04b[_0x4c0e2f(0x272)],{'class':_0x3ec04b[_0x4c0e2f(0xbd)],'text':_0x4c0e2f(0x1ec)+_0x472ba4+'\x22'}),_0xf4a59c[_0x4c0e2f(0x1ab)](_0xe1e6e8);const _0x1b7b7f=[{'coll':_0x12cc44[_0x4c0e2f(0xc7)](global[_0x4c0e2f(0x1d6)]),'name':global[_0x4c0e2f(0x1d6)]}];for(const {coll:_0x4805e5,name:_0x1533f9}of _0x1b7b7f)if(await _0x4805e5['findOne']({'supplierId':_0x4cc847}))return await _0x4674bf[_0x4c0e2f(0x1aa)]({'supplierId':_0x4cc847},{'$set':{'canDelete':!0x1}}),_0x4a126a[_0x4c0e2f(0xcf)](_0x3ec04b['fTTua'],{'class':_0x3ec04b['YaUjN'],'text':_0x4c0e2f(0x21b)+_0x4cc847+'\x22\x20มีอยู่ในเอกสาร\x20'+_0x1533f9+'{{sep}}ไม่สามารถลบได้'}),_0xf4a59c[_0x4c0e2f(0x1ab)](_0xe1e6e8);return _0x3ec04b[_0x4c0e2f(0x19f)]((await _0x4674bf[_0x4c0e2f(0xbb)]({'_id':new _0x284d57(_0x4cc847)}))[_0x4c0e2f(0x1d0)],0x1)?(_0x4a126a['flash'](_0x3ec04b['fTTua'],{'class':_0x3ec04b[_0x4c0e2f(0x16c)],'text':_0x4c0e2f(0x1cd)+_0x472ba4+_0x4c0e2f(0xf2)}),_0xf4a59c[_0x4c0e2f(0x1ab)](_0xe1e6e8)):(console[_0x4c0e2f(0x194)](_0x3ec04b[_0x4c0e2f(0x137)]),_0x4a126a[_0x4c0e2f(0xcf)](_0x3ec04b['fTTua'],{'class':_0x3ec04b['YaUjN'],'text':_0x4c0e2f(0x13b)+_0x472ba4+'\x22'}),_0xf4a59c[_0x4c0e2f(0x1ab)](_0xe1e6e8));}else _0x10c2da[_0x4c0e2f(0x173)]();}catch(_0x1e726f){if(_0x3ec04b[_0x4c0e2f(0x250)](_0x3ec04b[_0x4c0e2f(0x1c2)],_0x3ec04b[_0x4c0e2f(0x1f9)]))_0x1accbb=spkVNM[_0x4c0e2f(0x132)](_0x27239f,spkVNM['StTru'](spkVNM[_0x4c0e2f(0xd2)](spkVNM[_0x4c0e2f(0x27a)],spkVNM[_0x4c0e2f(0xff)]),');'))();else return _0x4a126a[_0x4c0e2f(0xcf)](_0x3ec04b[_0x4c0e2f(0x272)],{'class':_0x3ec04b[_0x4c0e2f(0xbd)],'text':_0x1e726f[_0x4c0e2f(0xd0)]}),_0xf4a59c['redirect'](_0xe1e6e8);}finally{if(_0x3ec04b[_0x4c0e2f(0x21f)](_0x3ec04b['yACMn'],_0x3ec04b[_0x4c0e2f(0x1eb)]))_0x5cf759['close']();else{const _0xdcded=_0x601b2e[_0x4c0e2f(0xb6)](_0xfca0d7,arguments);return _0x17a090=null,_0xdcded;}}}),w['post'](v,_0x5426aa[_0x486515(0x171)],async(_0x53446e,_0x1a00cc)=>{const _0x4730f6=_0x486515,_0x1d58f3={'ludyj':'red','rkMDO':function(_0x269d86,_0x57f516){return _0x269d86!==_0x57f516;},'aNpXA':'lkVYr','rMPah':_0x4730f6(0x1ef),'NBXrZ':function(_0x37ccc8,_0x254137){return _0x37ccc8==_0x254137;},'ngqJw':_0x4730f6(0x17a),'QEJUY':_0x4730f6(0x258),'yjDaY':'utf8','VwrWm':function(_0x2d0d3e,_0x1f79d7){return _0x2d0d3e===_0x1f79d7;},'kbXLZ':'zfEEk','tEzqk':'error\x20===>\x20','ZKSEM':_0x4730f6(0x1a7),'Jgbwv':_0x4730f6(0x153)},{idsArr:_0x529e3f}=_0x53446e['body'],_0x2b2014=new _0x312601(dbUrl);try{if(_0x1d58f3[_0x4730f6(0xc5)](_0x1d58f3[_0x4730f6(0x17f)],_0x1d58f3[_0x4730f6(0x17f)]))return!![];else{await _0x2b2014[_0x4730f6(0xb9)]();const _0x188c98=await _0x2b2014['db'](global[_0x4730f6(0x209)])[_0x4730f6(0xc7)](global[_0x4730f6(0x27c)])['aggregate']([{'$match':{'supplierId':{'$in':_0x529e3f}}},{'$project':{'_id':0x0,'changesHistory':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x529e3f,_0x1d58f3[_0x4730f6(0x100)]]}}},{'$sort':{'__order':0x1}}])[_0x4730f6(0x228)]();if(_0x1d58f3[_0x4730f6(0x243)](_0x188c98[_0x4730f6(0x107)],0x0))return _0x1a00cc[_0x4730f6(0x115)](JSON['stringify']({'isPrint':!0x1,'class':_0x1d58f3[_0x4730f6(0x15e)],'msg':_0x1d58f3[_0x4730f6(0xf4)]}));const _0x5e1786=_0x3d88ee[_0x4730f6(0x108)](folderForms,_0x1d58f3[_0x4730f6(0x1de)]),_0x3b778a=_0x4715ba['readFileSync'](_0x5e1786,_0x1d58f3[_0x4730f6(0x1b7)]),_0x132fb5=_0x4b3f57[_0x4730f6(0x149)](_0x3b778a,{'time':N[_0x4730f6(0x1ae)](),'title':_0x4730f6(0x144)+_0x188c98[_0x4730f6(0x107)]+']','data':_0x188c98,'dateTime':N['getDateTime']()});_0x1a00cc[_0x4730f6(0x115)](JSON['stringify']({'isPrint':!0x0,'htmlPage':_0x132fb5}));}}catch(_0x2c1494){if(_0x1d58f3[_0x4730f6(0xe2)](_0x1d58f3['kbXLZ'],_0x1d58f3[_0x4730f6(0x1b1)]))console['log'](_0x1d58f3[_0x4730f6(0x17b)],_0x2c1494[_0x4730f6(0xd0)]),_0x1a00cc[_0x4730f6(0x115)](JSON['stringify']({'isPrint':!0x1,'class':_0x1d58f3[_0x4730f6(0x15e)],'msg':_0x2c1494[_0x4730f6(0xd0)]}));else return _0x457125['send']({'isDownload':!0x1,'color':_0x1d58f3['ludyj'],'msg':_0x531e5d[_0x4730f6(0xd0)]});}finally{if(_0x1d58f3[_0x4730f6(0xe2)](_0x1d58f3[_0x4730f6(0x18d)],_0x1d58f3[_0x4730f6(0xeb)])){if(_0x2ec561){const _0x31c0d7=_0x5b86d1[_0x4730f6(0xb6)](_0x21d384,arguments);return _0x2c5c70=null,_0x31c0d7;}}else _0x2b2014['close']();}}),w[_0x486515(0x24c)](L,_0x5426aa[_0x486515(0x171)],async(_0xfe47d5,_0x2353b1)=>{const _0x33a185=_0x486515,_0x552148={'NgqGe':function(_0x321a78,_0x270533){return _0x321a78!==_0x270533;},'SqDKP':'bplIk','DQOjh':_0x33a185(0x25a),'cMmOG':function(_0x4cc2c7,_0x437c3a){return _0x4cc2c7<_0x437c3a;},'ApHnz':_0x33a185(0x152),'CuvgS':_0x33a185(0x22e),'OGwSU':_0x33a185(0x25c),'riOwi':_0x33a185(0x222),'ZVXYX':function(_0x1c8d83,_0xab50e8){return _0x1c8d83!==_0xab50e8;},'MunAB':'JGsHl','EYzKQ':'MwwNZ','tVOab':'error\x20===>\x20','RWjBq':function(_0x33756f,_0x155070){return _0x33756f!==_0x155070;},'gxsXH':'BQgfP','IMmlb':_0x33a185(0x1c6)};let {supplierId:_0x134870}=_0xfe47d5[_0x33a185(0x249)];const _0x1b4e2f=new _0x312601(global['dbUrl']);try{if(_0x552148['NgqGe'](_0x552148[_0x33a185(0xed)],_0x552148[_0x33a185(0xed)]))_0x5bc9aa[_0x33a185(0x173)]();else{await _0x1b4e2f['connect']();var _0x1a86a8=await _0x1b4e2f['db'](global[_0x33a185(0x209)])[_0x33a185(0xc7)](global[_0x33a185(0x27c)])[_0x33a185(0x117)]({'supplierId':_0x134870});if(!_0x1a86a8)return _0x2353b1[_0x33a185(0x115)](JSON[_0x33a185(0x133)]({'isPrint':!0x1,'class':_0x552148[_0x33a185(0x1cb)],'msg':'ไม่พบ\x20\x22'+_0x134870+'\x22'}));const _0x3b1a4e=_0x1a86a8[_0x33a185(0x248)]||[];if(_0x552148[_0x33a185(0x142)](_0x3b1a4e['length'],0x1))return _0x2353b1[_0x33a185(0x115)](JSON['stringify']({'isPrint':!0x1,'class':_0x552148[_0x33a185(0x168)],'msg':_0x552148[_0x33a185(0x175)]}));const _0x1a4544=_0x3d88ee[_0x33a185(0x108)](folderForms,_0x552148[_0x33a185(0x21d)]),_0x146568=await E['renderView'](_0x1a4544,_0x2353b1,{'title':'ประวัติการแก้ไขผู้จัดจำหน่าย\x20:\x20['+_0x1a86a8[_0x33a185(0x274)]+']\x20'+_0x1a86a8[_0x33a185(0xef)],'time':N[_0x33a185(0x1ae)](),'changesHistory':_0x3b1a4e});_0x2353b1[_0x33a185(0x115)](JSON[_0x33a185(0x133)]({'isPrint':!0x0,'class':_0x552148[_0x33a185(0x1f1)],'htmlPage':_0x146568}));}}catch(_0x3a7b26){if(_0x552148[_0x33a185(0x18a)](_0x552148['MunAB'],_0x552148[_0x33a185(0x23e)]))console[_0x33a185(0x194)](_0x552148['tVOab'],_0x3a7b26),_0x2353b1[_0x33a185(0x115)](JSON['stringify']({'isPrint':!0x1,'class':_0x552148['DQOjh'],'msg':_0x3a7b26[_0x33a185(0xd0)]}));else{const _0x31cc4f=_0x2a44bb?new _0x454c3d(''+_0x49cdd6,'i'):new _0x4a9aea('.*');_0x441cae[_0x33a185(0xfa)]({'$match':{'$or':[{'supplierId':{'$regex':_0x31cc4f}},{'supplierName':{'$regex':_0x31cc4f}}]}});}}finally{if(_0x552148[_0x33a185(0x1a2)](_0x552148[_0x33a185(0x211)],_0x552148['IMmlb']))_0x1b4e2f['close']();else{const _0x4bfb88=_0x52826e['constructor'][_0x33a185(0x116)][_0x33a185(0xd4)](_0x261cb4),_0x394eb9=_0x12fa46[_0x7a3934],_0x377716=_0x3e31c8[_0x394eb9]||_0x4bfb88;_0x4bfb88[_0x33a185(0xe4)]=_0x498d33[_0x33a185(0xd4)](_0x1f88f8),_0x4bfb88[_0x33a185(0x247)]=_0x377716[_0x33a185(0x247)]['bind'](_0x377716),_0x5668aa[_0x394eb9]=_0x4bfb88;}}}),w['post'](J,_0x5426aa[_0x486515(0x171)],async(_0x2ccddb,_0x2c1dcf)=>{const _0x256cca=_0x486515,_0x302a7d={'ClaUd':'msg','WIPMw':'red','UxBsQ':function(_0x5c33f3,_0x3d6571){return _0x5c33f3(_0x3d6571);},'IPmaH':function(_0x5c47c1,_0x14c04c){return _0x5c47c1+_0x14c04c;},'rzYsZ':function(_0x3e8b9c,_0x7bbc2){return _0x3e8b9c!==_0x7bbc2;},'DIqfc':_0x256cca(0x1db),'COCYP':_0x256cca(0x24a),'vGhVl':function(_0x2b7881,_0x4d3c46){return _0x2b7881==_0x4d3c46;},'tPmDQ':'ไม่มีข้อมูล','yKdnt':'suppliers','FkfCl':'buffer','hUjzO':_0x256cca(0x1dc),'xzHXK':'green','lOUjy':'ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','YkfRc':_0x256cca(0x27b),'JqaJJ':function(_0x400ed6,_0x513815){return _0x400ed6===_0x513815;},'TKIPC':_0x256cca(0x23f),'yYvRF':_0x256cca(0x251)},_0x7fc32e=new _0x312601(dbUrl);try{if(_0x302a7d[_0x256cca(0xcb)](_0x302a7d[_0x256cca(0x278)],_0x302a7d[_0x256cca(0x278)]))return _0x31d424[_0x256cca(0xcf)](_0x302a7d['ClaUd'],{'class':_0x302a7d[_0x256cca(0x193)],'text':_0x2b9aae[_0x256cca(0xd0)]}),_0x42f95c[_0x256cca(0x1ab)](_0x34493a);else{await _0x7fc32e[_0x256cca(0xb9)]();const _0x8494a2=await _0x7fc32e['db'](dbName)[_0x256cca(0xc7)](dbColl_suppliers)[_0x256cca(0x212)]([{'$project':{'_id':0x0,'supplierId':0x1,'supplierType':0x1,'supplierStatus':0x1,'supplierName':0x1,'supplierContactPerson':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierEmail':0x1,'supplierWebsite':0x1,'supplierTaxId':0x1,'supplierIdentityId':0x1,'dateTimeCanDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x302a7d[_0x256cca(0xf8)],[]]}}}},{'$sort':{'supplierId':0x1}}])['toArray']();if(_0x302a7d[_0x256cca(0x1cf)](_0x8494a2['length'],0x0))return _0x2c1dcf['send'](JSON[_0x256cca(0x133)]({'isDownload':!0x1,'class':_0x302a7d[_0x256cca(0x193)],'msg':_0x302a7d[_0x256cca(0x236)]}));const _0x37a187=_0x256cca(0x1d4)+N[_0x256cca(0x1ae)]()[_0x256cca(0x280)](/[: ]/g,'-')+_0x256cca(0x146),_0x1f69d5=_0x202efe[_0x256cca(0x273)][_0x256cca(0x1a5)](_0x8494a2),_0x3a33e3=_0x202efe['utils']['book_new']();_0x202efe[_0x256cca(0x273)]['book_append_sheet'](_0x3a33e3,_0x1f69d5,_0x302a7d[_0x256cca(0x271)]);const _0x10f5fb=_0x202efe[_0x256cca(0x1c9)](_0x3a33e3,{'type':_0x302a7d[_0x256cca(0x237)],'bookType':_0x302a7d[_0x256cca(0x139)]});_0x2c1dcf[_0x256cca(0x115)]({'isDownload':!0x0,'color':_0x302a7d[_0x256cca(0x279)],'msg':_0x302a7d['lOUjy'],'filename':_0x37a187,'fileData':_0x10f5fb['toString'](_0x302a7d[_0x256cca(0x21a)])});}}catch(_0x59bf5f){if(_0x302a7d[_0x256cca(0x125)](_0x302a7d[_0x256cca(0x203)],_0x302a7d['yYvRF'])){const _0x12664b=_0x317f8e[0x0][_0x256cca(0x274)][_0x256cca(0x23c)](0x1),_0x212849=_0x302a7d[_0x256cca(0x20c)](_0x4ca7c7,_0x12664b);_0x41af7a='S'+_0x302a7d[_0x256cca(0x20c)](_0x1bdcd0,_0x302a7d['IPmaH'](_0x212849,0x1))['padStart'](0x4,'0');}else return _0x2c1dcf[_0x256cca(0x115)]({'isDownload':!0x1,'color':_0x302a7d[_0x256cca(0x193)],'msg':_0x59bf5f[_0x256cca(0xd0)]});}finally{_0x7fc32e[_0x256cca(0x173)]();}});const K=_0xbeb3b3({'storage':_0xbeb3b3[_0x486515(0x23a)]()});w['post'](M,_0x5426aa['isOS'],K['single']('uploadExcelFile'),async(_0x89f688,_0xd9890)=>{const _0x42dced=_0x486515,_0x2ff19e={'RNVmz':_0x42dced(0x25a),'HjsSt':_0x42dced(0x1b2),'GAPWS':_0x42dced(0x282),'eIYnd':_0x42dced(0xb8),'dCuwi':function(_0x3653aa,_0x238591){return _0x3653aa>_0x238591;},'FwzdS':_0x42dced(0x274),'OVZCK':_0x42dced(0x15b),'vpxCc':'supplierStatus','xKlie':'supplierName','EEYSD':_0x42dced(0x1fb),'MHgqP':_0x42dced(0x176),'YfTQs':_0x42dced(0x20d),'quwyF':_0x42dced(0x227),'vQzuh':_0x42dced(0x17e),'SMIvs':'supplierEmail','NGdin':'supplierWebsite','rjvoS':'supplierTaxId','ZuRTS':_0x42dced(0x163),'TgCug':_0x42dced(0xf6),'ZBTPy':'personal','qzHxJ':'organization','GZHaA':_0x42dced(0x178),'pdeVB':function(_0x3714d9,_0x1451a3){return _0x3714d9+_0x1451a3;},'vFlOo':function(_0x2fea06,_0x108a2c){return _0x2fea06===_0x108a2c;},'NnIYm':function(_0x4afd16,_0x3a7a82){return _0x4afd16!=_0x3a7a82;},'Ndrsn':_0x42dced(0xfc),'TjivD':function(_0x57eff4,_0x3c5d43){return _0x57eff4<_0x3c5d43;},'QtyYM':function(_0xdc3dee,_0x43d024){return _0xdc3dee+_0x43d024;},'knljP':'ไม่มีข้อมูลที่อัปเดท','aLZVI':'green','MPryr':_0x42dced(0x114)},_0x131707=new _0x312601(dbUrl);try{if(!_0x89f688[_0x42dced(0x169)])return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x1,'color':_0x2ff19e[_0x42dced(0x103)],'msg':_0x2ff19e[_0x42dced(0x1b6)]});const _0x127dcb=_0x202efe['read'](_0x89f688[_0x42dced(0x169)]['buffer'],{'type':_0x2ff19e['GAPWS']}),_0x2890c0=[_0x2ff19e[_0x42dced(0x165)]],_0x3d763b=_0x127dcb[_0x42dced(0x158)],_0xe82e5b=_0x2890c0[_0x42dced(0x151)](_0x442c4d=>!_0x3d763b[_0x42dced(0x285)](_0x442c4d));if(_0x2ff19e[_0x42dced(0x26e)](_0xe82e5b[_0x42dced(0x107)],0x0))return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x1,'color':_0x2ff19e['RNVmz'],'msg':'ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22'+_0xe82e5b[_0x42dced(0x108)](',\x20')+'\x22'});const _0x2fa0af=_0x127dcb['Sheets'][_0x42dced(0xb8)],_0x1d20f0=_0x202efe[_0x42dced(0x273)][_0x42dced(0x1fa)](_0x2fa0af),_0x5e2246=[_0x2ff19e['FwzdS'],_0x2ff19e[_0x42dced(0x232)],_0x2ff19e[_0x42dced(0x268)],_0x2ff19e['xKlie'],_0x2ff19e[_0x42dced(0x1a3)],_0x2ff19e[_0x42dced(0x26c)],_0x2ff19e['YfTQs'],_0x2ff19e['quwyF'],_0x2ff19e[_0x42dced(0x111)],_0x2ff19e[_0x42dced(0x1d8)],_0x2ff19e[_0x42dced(0x12d)],_0x2ff19e['rjvoS'],_0x2ff19e['ZuRTS'],_0x2ff19e['TgCug']]['filter'](_0x1b74a6=>!_0x1d20f0[_0x42dced(0x20e)](_0x4da107=>Object[_0x42dced(0x116)][_0x42dced(0x269)]['call'](_0x4da107,_0x1b74a6)));if(_0x2ff19e[_0x42dced(0x26e)](_0x5e2246[_0x42dced(0x107)],0x0))return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x1,'color':_0x2ff19e[_0x42dced(0x103)],'msg':'ชี้ท\x20\x27suppliers\x27\x20ต้องมีคอลัมน์\x20\x22'+_0x5e2246[_0x42dced(0x108)](',\x20')+'\x22'});const _0xb022c4=new Set(),_0x3f5e1f=new Set();if(_0x1d20f0[_0x42dced(0x1c1)](_0x4524cb=>{const _0x5cf347=_0x42dced;_0xb022c4[_0x5cf347(0x1b5)](_0x4524cb[_0x5cf347(0x274)])?_0x3f5e1f[_0x5cf347(0xcd)](_0x4524cb[_0x5cf347(0x274)]):_0xb022c4[_0x5cf347(0xcd)](_0x4524cb['supplierId']);}),_0x2ff19e[_0x42dced(0x26e)](_0x3f5e1f['size'],0x0))return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x1,'color':_0x2ff19e[_0x42dced(0x103)],'msg':_0x42dced(0x20f)+Array['from'](_0x3f5e1f)[_0x42dced(0x108)](',\x20')+'\x22'});const _0x17069f=[],_0x5590be=new RegExp(global[_0x42dced(0x276)]),_0x2b4a72=/^S[A-Za-z0-9]{4}$/,_0x498961=[_0x2ff19e[_0x42dced(0x241)],_0x2ff19e[_0x42dced(0xb5)]],_0x45f1ee=[_0x2ff19e[_0x42dced(0x205)],''];for(const [_0x44d15,_0x396056]of _0x1d20f0[_0x42dced(0x10f)]()){const _0xfd3289=_0x2ff19e[_0x42dced(0x1f6)](_0x44d15,0x2),_0x4e6209={'supplierId':_0x396056[_0x42dced(0x274)],'row':_0xfd3289};if(!_0x396056[_0x42dced(0x274)]||_0x2ff19e[_0x42dced(0x192)](_0x2b4a72[_0x42dced(0x10e)](_0x396056['supplierId']),!0x1)){_0x17069f['push'](_0x4e6209);continue;}if(!_0x396056[_0x42dced(0x15b)]||!_0x498961[_0x42dced(0x285)](_0x396056[_0x42dced(0x15b)])){_0x17069f['push'](_0x4e6209);continue;}if(_0x2ff19e[_0x42dced(0x192)](_0x396056[_0x42dced(0x145)],void 0x0)||!_0x45f1ee[_0x42dced(0x285)](_0x396056['supplierStatus'])){_0x17069f[_0x42dced(0x135)](_0x4e6209);continue;}if(!_0x396056[_0x42dced(0xef)]||_0x2ff19e['NnIYm'](typeof _0x396056[_0x42dced(0xef)],_0x2ff19e[_0x42dced(0x186)])||_0x2ff19e[_0x42dced(0x155)](_0x396056[_0x42dced(0xef)][_0x42dced(0x141)]()[_0x42dced(0x107)],0x1)){_0x17069f[_0x42dced(0x135)](_0x4e6209);continue;}if(_0x396056[_0x42dced(0x184)]&&!_0x5590be[_0x42dced(0x10e)](_0x396056[_0x42dced(0x184)])){_0x17069f[_0x42dced(0x135)](_0x4e6209);continue;}if(_0x396056[_0x42dced(0x163)]&&!_0x5590be['test'](_0x396056[_0x42dced(0x163)])){_0x17069f[_0x42dced(0x135)](_0x4e6209);continue;}if(!_0x396056['dateTimeCanDelete']||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x42dced(0x10e)](_0x396056['dateTimeCanDelete'])){_0x17069f[_0x42dced(0x135)](_0x4e6209);continue;}}if(_0x2ff19e[_0x42dced(0x26e)](_0x17069f[_0x42dced(0x107)],0x0)){const _0x5a6038=Array[_0x42dced(0xde)](new Set(_0x17069f[_0x42dced(0x14a)](_0x294277=>JSON[_0x42dced(0x133)](_0x294277))))[_0x42dced(0x14a)](_0x428d9e=>JSON[_0x42dced(0xdc)](_0x428d9e));return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x1,'color':_0x2ff19e[_0x42dced(0x103)],'msg':_0x42dced(0x119)+_0x5a6038[_0x42dced(0x14a)](_0x4780af=>_0x4780af[_0x42dced(0x12f)])[_0x42dced(0x108)](',\x20'),'errorRows':_0x5a6038});}await _0x131707['connect']();const _0x4608ac=_0x131707['db'](dbName)[_0x42dced(0xc7)](dbColl_suppliers),_0x1e9c89=[];for(const _0x4c977c of _0x1d20f0){_0x4c977c[_0x42dced(0x15b)]||(_0x4c977c['supplierType']='');const _0x105581=await _0x4608ac['updateOne']({'supplierId':_0x4c977c[_0x42dced(0x274)]},{'$set':_0x4c977c},{'upsert':!0x0});_0x1e9c89['push']({'supplierId':_0x4c977c[_0x42dced(0x274)],'matchedCount':_0x105581[_0x42dced(0xba)],'upsertedCount':_0x105581[_0x42dced(0x261)]});}const _0x44d8ef=_0x2ff19e['dCuwi'](_0x1e9c89['length'],0x0)?_0x2ff19e[_0x42dced(0x122)](_0x42dced(0x206)+_0x1e9c89[_0x42dced(0x151)](_0x8491be=>_0x8491be[_0x42dced(0xba)]>0x0)['length']+'\x20รายการ',(_0x42dced(0x1ed)+_0x1e9c89[_0x42dced(0x151)](_0x156ffb=>_0x156ffb['upsertedCount']>0x0)[_0x42dced(0x107)]+'\x20รายการ')['trim']()):_0x2ff19e[_0x42dced(0x233)];return _0xd9890[_0x42dced(0x115)]({'isUpload':!0x0,'color':_0x2ff19e[_0x42dced(0x1ac)],'msg':_0x44d8ef});}catch(_0x577f10){return console[_0x42dced(0x194)](_0x2ff19e[_0x42dced(0x1bc)],_0x577f10),_0xd9890[_0x42dced(0x115)]({'isDownload':!0x1,'color':_0x2ff19e[_0x42dced(0x103)],'msg':_0x577f10[_0x42dced(0xd0)]});}finally{_0x131707[_0x42dced(0x173)]();}});function _0x1caf(_0x39f50a,_0x5e4cb6){const _0x3981cc=_0x1d1f();return _0x1caf=function(_0x348d85,_0x24d7fb){_0x348d85=_0x348d85-0xb5;let _0x40fd10=_0x3981cc[_0x348d85];return _0x40fd10;},_0x1caf(_0x39f50a,_0x5e4cb6);}export default w;function _0xe27ada(_0x39ca83){const _0x121922=_0x486515,_0x221f45={'Ewmmf':function(_0x4d6b94,_0x4e133d){return _0x4d6b94===_0x4e133d;},'edsjx':_0x121922(0xfc),'sfoka':'while\x20(true)\x20{}','YFSsq':_0x121922(0x27f),'fcrld':function(_0x430356,_0x5df9a3){return _0x430356!==_0x5df9a3;},'CCDUW':function(_0x31ffef,_0x560ff8){return _0x31ffef+_0x560ff8;},'lLjRZ':function(_0x57d27,_0x2b374e){return _0x57d27/_0x2b374e;},'MuflQ':_0x121922(0x107),'Rnlve':function(_0x717cef,_0x201558){return _0x717cef%_0x201558;},'rCcAr':function(_0x4543f6,_0x3ad9dc){return _0x4543f6+_0x3ad9dc;},'Ouxvb':_0x121922(0x13f),'ZvqKV':_0x121922(0x124),'UnKqz':_0x121922(0x210),'WCfLP':function(_0x13aa74,_0x297ab0){return _0x13aa74+_0x297ab0;},'IUlXi':_0x121922(0x267),'mykBb':function(_0x341b1d,_0x7bf9a9){return _0x341b1d(_0x7bf9a9);}};function _0x1d9f41(_0xe591bd){const _0x571167=_0x121922;if(_0x221f45[_0x571167(0x1f7)](typeof _0xe591bd,_0x221f45[_0x571167(0x26b)]))return function(_0x2062eb){}['constructor'](_0x221f45[_0x571167(0x109)])[_0x571167(0xb6)](_0x221f45['YFSsq']);else _0x221f45['fcrld'](_0x221f45['CCDUW']('',_0x221f45[_0x571167(0xb7)](_0xe591bd,_0xe591bd))[_0x221f45[_0x571167(0x120)]],0x1)||_0x221f45[_0x571167(0x1f7)](_0x221f45[_0x571167(0x24e)](_0xe591bd,0x14),0x0)?function(){return!![];}[_0x571167(0x252)](_0x221f45['rCcAr'](_0x221f45[_0x571167(0x1f8)],_0x221f45[_0x571167(0x1cc)]))['call'](_0x221f45[_0x571167(0xe0)]):function(){return![];}[_0x571167(0x252)](_0x221f45[_0x571167(0x239)](_0x221f45['Ouxvb'],_0x221f45[_0x571167(0x1cc)]))['apply'](_0x221f45[_0x571167(0x266)]);_0x221f45[_0x571167(0x130)](_0x1d9f41,++_0xe591bd);}try{if(_0x39ca83)return _0x1d9f41;else _0x221f45[_0x121922(0x130)](_0x1d9f41,0x0);}catch(_0x16567e){}}