const _0x1c086e=_0x856e;(function(_0x12b4a3,_0x30e3a4){const _0x2eb10c=_0x856e,_0x2dfc78=_0x12b4a3();while(!![]){try{const _0x3109b5=parseInt(_0x2eb10c(0x288))/0x1*(-parseInt(_0x2eb10c(0x1d8))/0x2)+-parseInt(_0x2eb10c(0x1f4))/0x3+parseInt(_0x2eb10c(0x1ee))/0x4*(-parseInt(_0x2eb10c(0x1be))/0x5)+-parseInt(_0x2eb10c(0x246))/0x6+-parseInt(_0x2eb10c(0x151))/0x7+parseInt(_0x2eb10c(0x12c))/0x8+parseInt(_0x2eb10c(0x1f9))/0x9;if(_0x3109b5===_0x30e3a4)break;else _0x2dfc78['push'](_0x2dfc78['shift']());}catch(_0x402ab5){_0x2dfc78['push'](_0x2dfc78['shift']());}}}(_0x48db,0x9d6c7));const _0x13e25a=(function(){const _0xec950b=_0x856e,_0x48dead={'vucQE':function(_0x198547,_0x3e00f2){return _0x198547!==_0x3e00f2;},'yZuVW':_0xec950b(0x1cf),'ZdTkk':'asAFa','oHAiw':_0xec950b(0x245),'xHXXC':_0xec950b(0x24f)};let _0x52188c=!![];return function(_0x27172a,_0x32836c){const _0x4297b2=_0xec950b;if(_0x48dead[_0x4297b2(0x287)](_0x48dead[_0x4297b2(0x13d)],_0x48dead['xHXXC'])){const _0x1a35b9=_0x101546?function(){if(_0x5b5593){const _0x3930ec=_0x1d7092['apply'](_0x5b2e49,arguments);return _0x678aae=null,_0x3930ec;}}:function(){};return _0x366bc0=![],_0x1a35b9;}else{const _0x2fffaf=_0x52188c?function(){const _0x2193f5=_0x4297b2;if(_0x48dead['vucQE'](_0x48dead[_0x2193f5(0x137)],_0x48dead[_0x2193f5(0x137)])){const _0x1c471d=_0x166bbe?function(){const _0x5a7f25=_0x2193f5;if(_0x333ce5){const _0x5a7ed0=_0x16e0b8[_0x5a7f25(0x21c)](_0x546793,arguments);return _0x54e2a6=null,_0x5a7ed0;}}:function(){};return _0x291b66=![],_0x1c471d;}else{if(_0x32836c){if(_0x48dead[_0x2193f5(0x287)](_0x48dead[_0x2193f5(0x17e)],_0x48dead[_0x2193f5(0x18a)])){const _0x119569=_0x32836c['apply'](_0x27172a,arguments);return _0x32836c=null,_0x119569;}else return!![];}}}:function(){};return _0x52188c=![],_0x2fffaf;}};}());(function(){const _0x3e488d=_0x856e,_0x2c406a={'cwQsn':function(_0x2e8fca){return _0x2e8fca();},'Vaoaa':_0x3e488d(0x2bd),'flxSN':'green','awcGr':function(_0x18ce1d,_0x1be46b){return _0x18ce1d!==_0x1be46b;},'biIgI':_0x3e488d(0x219),'AcVnC':_0x3e488d(0x24c),'zMpPr':_0x3e488d(0x27f),'KnPEz':_0x3e488d(0x21d),'ZVjOp':function(_0x349b04,_0x1300e6){return _0x349b04(_0x1300e6);},'JbVjF':_0x3e488d(0x14f),'zLIwk':function(_0x30eb8d,_0x2e1930){return _0x30eb8d+_0x2e1930;},'kuZFr':_0x3e488d(0x223),'qbhXM':_0x3e488d(0x242),'MXVzo':function(_0x1aa1f1,_0xf32253){return _0x1aa1f1===_0xf32253;},'zMdGH':_0x3e488d(0x178),'Ojgmz':'OHbgQ','qqXLv':function(_0x173fdc,_0x25adf4){return _0x173fdc(_0x25adf4);},'eGidn':'tJAdJ','Fwgag':_0x3e488d(0x2c7),'PTwgn':function(_0x3a08fd,_0xe11fc9,_0x172c93){return _0x3a08fd(_0xe11fc9,_0x172c93);}};_0x2c406a[_0x3e488d(0x13c)](_0x13e25a,this,function(){const _0x1bfb5b=_0x3e488d,_0x1b59b5={'TAkLI':_0x2c406a[_0x1bfb5b(0x154)],'CvWSQ':_0x2c406a['flxSN']};if(_0x2c406a[_0x1bfb5b(0x2ab)](_0x2c406a[_0x1bfb5b(0x23d)],_0x2c406a[_0x1bfb5b(0x289)])){const _0x1107b9=new RegExp(_0x2c406a['zMpPr']),_0x3f2899=new RegExp(_0x2c406a[_0x1bfb5b(0x259)],'i'),_0x25c4cd=_0x2c406a[_0x1bfb5b(0x187)](_0x414bc3,_0x2c406a[_0x1bfb5b(0x17f)]);if(!_0x1107b9[_0x1bfb5b(0x132)](_0x2c406a[_0x1bfb5b(0x1d7)](_0x25c4cd,_0x2c406a[_0x1bfb5b(0x1a5)]))||!_0x3f2899[_0x1bfb5b(0x132)](_0x2c406a[_0x1bfb5b(0x1d7)](_0x25c4cd,_0x2c406a['qbhXM']))){if(_0x2c406a[_0x1bfb5b(0x241)](_0x2c406a[_0x1bfb5b(0x112)],_0x2c406a['Ojgmz'])){const _0xcdf333=_0x74a09d+_0x1bfb5b(0x153)+_0x4ab46b+'&rpp='+_0x1fcc68+'&page='+_0x57416e+_0x1bfb5b(0x10c)+_0x4536f8[_0x1bfb5b(0x173)];return _0x3ce02e[_0x1bfb5b(0x22f)](_0x1b59b5[_0x1bfb5b(0x18d)],{'class':_0x1b59b5[_0x1bfb5b(0x1e5)],'text':_0x1bfb5b(0x1eb)+_0x18f737[_0x1bfb5b(0x1ed)]['supplierId']+'\x22\x20เรียบร้อยแล้ว'}),_0x393119[_0x1bfb5b(0x2a7)](_0xcdf333);}else _0x2c406a['qqXLv'](_0x25c4cd,'0');}else _0x2c406a[_0x1bfb5b(0x2ab)](_0x2c406a[_0x1bfb5b(0x1b6)],_0x2c406a[_0x1bfb5b(0x26d)])?_0x2c406a['cwQsn'](_0x414bc3):_0x48c686[_0x1bfb5b(0x218)]();}else _0x2c406a['cwQsn'](_0x51622e);})();}());const _0x5a333b=(function(){const _0x5da088=_0x856e,_0x5c65ae={'JosrV':function(_0x4e1d10,_0x176a04){return _0x4e1d10!==_0x176a04;},'RcDgx':'oXzID','sQlsC':_0x5da088(0x1bf),'mnKzz':function(_0x33a414,_0x2dfc2e){return _0x33a414===_0x2dfc2e;},'zZEzR':_0x5da088(0x1b9),'RmPWs':function(_0x511f3,_0x420b85){return _0x511f3+_0x420b85;},'agTNr':_0x5da088(0x238),'RuRkj':_0x5da088(0x148),'pvdGY':_0x5da088(0x192),'KOSrj':'function\x20*\x5c(\x20*\x5c)','lvyzY':_0x5da088(0x21d),'efNXr':function(_0x106f6d,_0x8bf5b){return _0x106f6d(_0x8bf5b);},'NjstR':_0x5da088(0x14f),'gpkPh':_0x5da088(0x223),'FGZQn':_0x5da088(0x242),'aRZRn':function(_0x2c1cee){return _0x2c1cee();},'JAQMP':_0x5da088(0x209),'MJxlO':_0x5da088(0x203),'RCGGx':'zUJJi'};let _0xe78de9=!![];return function(_0x445099,_0x4eecf5){const _0x2cf87a=_0x5da088,_0x48cf84={'ZMfvu':function(_0xee6478,_0x4e9cc8){const _0x3aeac5=_0x856e;return _0x5c65ae[_0x3aeac5(0x18f)](_0xee6478,_0x4e9cc8);},'qAVne':_0x5c65ae[_0x2cf87a(0x205)],'ihaBV':_0x5c65ae[_0x2cf87a(0x2af)],'ASFKq':_0x5c65ae[_0x2cf87a(0x1d3)],'bJzxj':_0x5c65ae[_0x2cf87a(0x2d0)],'BKYAC':_0x5c65ae[_0x2cf87a(0x27b)],'QcUYJ':function(_0x504921,_0xbcd3c2){const _0x49271f=_0x2cf87a;return _0x5c65ae[_0x49271f(0x22b)](_0x504921,_0xbcd3c2);},'HhfBr':_0x5c65ae[_0x2cf87a(0x1fa)],'fDoJi':function(_0x2efed6,_0x1bbd63){const _0xad6850=_0x2cf87a;return _0x5c65ae[_0xad6850(0x18f)](_0x2efed6,_0x1bbd63);},'cqmQK':_0x5c65ae[_0x2cf87a(0x277)],'SrQLL':_0x5c65ae['FGZQn'],'wsfIW':function(_0x4f0055,_0x4ab9d0){const _0x1b2f03=_0x2cf87a;return _0x5c65ae[_0x1b2f03(0x22b)](_0x4f0055,_0x4ab9d0);},'wkpxK':function(_0x127157){const _0x169a33=_0x2cf87a;return _0x5c65ae[_0x169a33(0x16e)](_0x127157);},'rVWdA':_0x5c65ae[_0x2cf87a(0x184)],'oQbMn':_0x5c65ae['MJxlO']};if(_0x5c65ae[_0x2cf87a(0x129)](_0x5c65ae[_0x2cf87a(0x267)],_0x5c65ae[_0x2cf87a(0x267)]))(function(){return![];}[_0x2cf87a(0x1fc)](_0x48cf84[_0x2cf87a(0x15c)](_0x48cf84['qAVne'],_0x48cf84[_0x2cf87a(0x1f0)]))[_0x2cf87a(0x21c)](_0x48cf84[_0x2cf87a(0x1c9)]));else{const _0x58d53c=_0xe78de9?function(){const _0x105d56=_0x2cf87a;if(_0x5c65ae['JosrV'](_0x5c65ae[_0x105d56(0x202)],_0x5c65ae[_0x105d56(0x135)])){if(_0x4eecf5){if(_0x5c65ae[_0x105d56(0xfd)](_0x5c65ae[_0x105d56(0x168)],_0x5c65ae['zZEzR'])){const _0x594b80=_0x4eecf5[_0x105d56(0x21c)](_0x445099,arguments);return _0x4eecf5=null,_0x594b80;}else{const _0x16ee96=new _0x45fb79(_0x48cf84['bJzxj']),_0x5ce3bd=new _0x483f3b(_0x48cf84[_0x105d56(0x28f)],'i'),_0x22221e=_0x48cf84[_0x105d56(0x17b)](_0x1ca51a,_0x48cf84[_0x105d56(0x172)]);!_0x16ee96[_0x105d56(0x132)](_0x48cf84['fDoJi'](_0x22221e,_0x48cf84[_0x105d56(0x15d)]))||!_0x5ce3bd[_0x105d56(0x132)](_0x48cf84['ZMfvu'](_0x22221e,_0x48cf84['SrQLL']))?_0x48cf84[_0x105d56(0x2a1)](_0x22221e,'0'):_0x48cf84[_0x105d56(0x2b8)](_0x4b8aae);}}}else return _0x53edbf[_0x105d56(0x164)](_0x48cf84[_0x105d56(0x261)],_0x37afad),_0x441d97['send']({'isDownload':!0x1,'color':_0x48cf84[_0x105d56(0xfb)],'msg':_0x39bf85[_0x105d56(0x1e7)]});}:function(){};return _0xe78de9=![],_0x58d53c;}};}()),_0x112a52=_0x5a333b(this,function(){const _0x87b865=_0x856e,_0x22e799={'cPirv':'msg','TsTSG':_0x87b865(0x203),'pcptj':function(_0x500087,_0x258ec9){return _0x500087===_0x258ec9;},'uSkFv':_0x87b865(0x1d1),'bWoRb':function(_0x3a88b0,_0x8c67bd){return _0x3a88b0!==_0x8c67bd;},'ZWRQu':'HaBdE','Hjyrf':_0x87b865(0x228),'GhalH':function(_0x22a20a,_0x5c4649){return _0x22a20a(_0x5c4649);},'tqDqh':function(_0x558b24,_0x574722){return _0x558b24+_0x574722;},'AVnCd':'return\x20(function()\x20','HuozQ':_0x87b865(0x1c5),'HyNWi':_0x87b865(0x158),'nFyGI':function(_0x48aa48){return _0x48aa48();},'qRmYb':'log','qADCB':'warn','pRVYH':'info','vqRDt':_0x87b865(0x114),'RlZiE':_0x87b865(0x21b),'KJWBt':'table','duUoQ':'trace','UklHr':function(_0x1f8cf4,_0x3ceea8){return _0x1f8cf4<_0x3ceea8;},'gLEIS':_0x87b865(0x11c),'MkXNZ':_0x87b865(0x233)},_0x14f95f=function(){const _0x4f6ff6=_0x87b865,_0x69a729={'FRhgt':_0x22e799[_0x4f6ff6(0x128)],'aqJcD':_0x22e799['TsTSG']};if(_0x22e799['pcptj'](_0x22e799[_0x4f6ff6(0x1c2)],_0x22e799[_0x4f6ff6(0x1c2)])){let _0x16a698;try{_0x22e799[_0x4f6ff6(0x214)](_0x22e799['ZWRQu'],_0x22e799[_0x4f6ff6(0x272)])?_0x16a698=_0x22e799[_0x4f6ff6(0x1d4)](Function,_0x22e799[_0x4f6ff6(0x20c)](_0x22e799[_0x4f6ff6(0x20c)](_0x22e799[_0x4f6ff6(0x2cf)],_0x22e799[_0x4f6ff6(0x104)]),');'))():_0x11425a[_0x4f6ff6(0x218)]();}catch(_0x152254){if(_0x22e799['pcptj'](_0x22e799[_0x4f6ff6(0x2a4)],_0x22e799['HyNWi']))_0x16a698=window;else return _0x539be6[_0x4f6ff6(0x22f)](_0x69a729[_0x4f6ff6(0x1bc)],{'class':_0x69a729[_0x4f6ff6(0x181)],'text':''+_0x3be2fe[_0x4f6ff6(0x1e7)]}),_0x1183f8[_0x4f6ff6(0x2a7)](_0x40b66a);}return _0x16a698;}else{if(_0x48eed9){const _0x271533=_0x53d8b8[_0x4f6ff6(0x21c)](_0x5e0b07,arguments);return _0x28911d=null,_0x271533;}}},_0x1ff999=_0x22e799[_0x87b865(0x121)](_0x14f95f),_0x52e1e=_0x1ff999[_0x87b865(0x206)]=_0x1ff999['console']||{},_0x597bd7=[_0x22e799['qRmYb'],_0x22e799[_0x87b865(0x2a6)],_0x22e799[_0x87b865(0x18b)],_0x22e799[_0x87b865(0x1f3)],_0x22e799[_0x87b865(0x294)],_0x22e799[_0x87b865(0x1e8)],_0x22e799[_0x87b865(0x14c)]];for(let _0x9fac03=0x0;_0x22e799[_0x87b865(0x13b)](_0x9fac03,_0x597bd7[_0x87b865(0x170)]);_0x9fac03++){if(_0x22e799[_0x87b865(0x1f8)](_0x22e799[_0x87b865(0x1b8)],_0x22e799[_0x87b865(0x1a8)]))return _0xffc907[_0x87b865(0x22f)](_0x22e799[_0x87b865(0x128)],{'class':_0x22e799[_0x87b865(0x2cb)],'text':_0x454329['message']}),_0x34d4eb[_0x87b865(0x2a7)](_0x494d35);else{const _0x46fc68=_0x5a333b[_0x87b865(0x1fc)][_0x87b865(0x251)][_0x87b865(0x123)](_0x5a333b),_0x1f037d=_0x597bd7[_0x9fac03],_0x2039d8=_0x52e1e[_0x1f037d]||_0x46fc68;_0x46fc68['__proto__']=_0x5a333b[_0x87b865(0x123)](_0x5a333b),_0x46fc68[_0x87b865(0x271)]=_0x2039d8[_0x87b865(0x271)][_0x87b865(0x123)](_0x2039d8),_0x52e1e[_0x1f037d]=_0x46fc68;}}});_0x112a52();function _0x856e(_0x4148ba,_0x378466){const _0x1e73b1=_0x48db();return _0x856e=function(_0x112a52,_0x5a333b){_0x112a52=_0x112a52-0xfa;let _0x455850=_0x1e73b1[_0x112a52];return _0x455850;},_0x856e(_0x4148ba,_0x378466);}import _0xe402f0 from'express';const w=_0xe402f0['Router']();import{MongoClient as _0x26f338,ObjectId as _0x13e2a5}from'mongodb';function _0x48db(){const _0x518c84=['RAquC','gger','SGEZc','hwrvF','อัปเดท\x20','duUoQ','{{sep}}[\x20บันทึกการแก้ไข\x20]','TinJo','init','yokWI','6263621hgBVZf','TtjoU','?sip=','Vaoaa','LuXcC','MibdC','ไม่มีข้อมูลที่จะพิมพ์','vlqfa','unshift','supplierId','IZYBo','ZMfvu','cqmQK','JwRto','VmOib','koRSl','VJJIk','sort','JKnWe','log','ykBZO','cqsXp','&page=','zZEzR','aggregate','matchedCount','JYFQj','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','deletedCount','aRZRn','VmZzb','length','roXBv','HhfBr','insertedId','qapUQ','FxBue','personal','send','kZrkX','zTvLj','wREJs','QcUYJ','xbSUv','organization','ZdTkk','JbVjF','dbColl_warehouseIn','aqJcD','&rpp=','/myData.js','JAQMP','JcIus','MgdJp','ZVjOp','lWNxm','OBkvp','oHAiw','pRVYH','file','TAkLI','/myModule.js','RmPWs','single','sendFile','stateObject','$changesHistory','tCKfn','forEach','getDateTime','jXcMX','BbeiG','has','row','DSivC','print_suppliers.ejs','flcak','zaAEv','kZsfp','EFXqi','map','NNoUJ','yellow','supplierWebsite','kuZFr','Hjxqs','PHRCl','MkXNZ','countDocuments','SmMtF','ZgIsH','LRUZT','OwSsW','S0001','call','cWucy','zdcDW','qbbcy','status','supplierTaxId','{{sep}}\x22','eGidn','QWAUZ','gLEIS','iJONz','dmqiU','HBxIZ','FRhgt','/myDateTime.js','5YEneqb','XLWAQ','fGYRv','sCZYx','uSkFv','zKXEZ','book_append_sheet','{}.constructor(\x22return\x20this\x22)(\x20)','Not\x20Inserted','XfTDn','modifiedCount','ASFKq','__proto__','ieWaZ','supplierStatus','TkVzg','deleteOne','zqowh','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','LIxXR','DiGRZ','pvdGY','GhalH','MqFYT','AIClL','zLIwk','312jffFIy','vJzJX','{{sep}}ไม่สามารถลบได้','pUCZu','vjYKG','OmOWO','/suppliers','suppliers','KCenC','query','NjHON','xukDR','join','CvWSQ','KKxpD','message','KJWBt','sheet_to_json','kSReK','เพิ่ม\x20\x22','bywqD','body','4048756erGnRD','trim','ihaBV','cabuh','renderView','vqRDt','1458027mkElhd','THosP','/changes','ichIQ','pcptj','22331538MNDqzI','NjstR','size','constructor','lEUme','../','filter','UXIMu','ไม่มีข้อมูลที่อัปเดท','RcDgx','red','supplierIdentityId','agTNr','console','dpfNh','VrWLT','error\x20===>\x20','LnjkG','Fnbvr','tqDqh','rgodT','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','lTiwF','JpPlW','ghPjf','gdQKT','aKETS','bWoRb','replace','post','zZWNE','close','jxpwO','eGDGw','exception','apply','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','$supplierId','uaaUa','lcJbL','xahWZ','KVqCt','chain','VmbcA','render','Lpenf','YOYyn','goQCt','uploadExcelFile','tuyOf','efNXr','QnXOV','LpABe','SheetNames','flash','LQkzN','vBqOO','\x22\x20มีอยู่ในเอกสาร\x20','QIZUb','xPnQv','ลบ\x20\x22','AFZpW','dbColl_suppliers','debu','mayAx','\x22\x20เรียบร้อยแล้ว','mRdmy','awjkG','biIgI','ประวัติการแก้ไขผู้จัดจำหน่าย\x20:\x20[','SVDCZ','utf8','MXVzo','input','ysLNo','DzTfy','zOldg','108846lzqscC','aXfbM','CpPdm','json_to_sheet','connect','LaEtE','Fpzyk','\x20รายการ','utils','XojGj','/download-excel','prototype','TUPwu','zgMcZ','QraTE','\x5c$&','BqCpC','Sheets','PDBwl','KnPEz','GenJv','iZDLq','mRjvB','getDate','/load','ouctb','yNYqH','rVWdA','pxvFd','green','kmURX','zefgi','iTNvX','RCGGx','rpp','JfHbP','FMkrU','.xlsx','upsertedCount','Fwgag','TXVnk','QNoMD','ไม่พบ\x20\x22','toString','Hjyrf','hJhVL','padStart','\x22\x20ซ้ำ{{sep}}\x20โปรดติดต่อผู้ดูแลระบบ','UMSNi','gpkPh','sdqpd','hIkej','JkfSk','lvyzY','jdoSJ','PNQiW','aimSh','function\x20*\x5c(\x20*\x5c)','wxDBa','XsvFC','stringify','อัปเดท\x20\x22','userFullname','/delete','parse','vucQE','3223yMbvcZ','AcVnC','svnkL','BskAl','sTEhV','hVvWJ','UdJyt','BKYAC','Skigh','KMgkL','ผู้จัดจำหน่าย\x20[','supplierAddress2','RlZiE','ioCqc','VbdkD','add','hDHpd','readFileSync','from','mskYI','jZkQx','string','UXKHN','supplierAddress1','NtApr','wsfIW','insertOne','supplierName','HyNWi','hasOwnProperty','qADCB','redirect','/print','push','ltBpY','awcGr','RkYyz','TinBB','hxVBz','RuRkj','page','qRsew','doc_changes.ejs','acknowledged','memoryStorage','ไม่พบ\x20','\x22{{sep}}ไม่มีอะไรเปลี่ยนแปลง','SeWPW','wkpxK','counter','return\x20(function()\x20','includes','load_id','msg','ชีท\x20\x27items\x27\x20มีข้อมูลผิดพลาดที่แถว\x20','dzhik','findOne','MLqil','fWkTR','dbName','zFbOV','updateOne','sTeom','RQUyK','DkeZH','dateTimeCanDelete','getSettings','TsTSG','URiPC','qssxg','yepBt','AVnCd','KOSrj','svfLC','QBEzd','oQbMn','OuGnl','mnKzz','toArray','eeXJJ','_id','HHVpj','supplierPhone','while\x20(true)\x20{}','HuozQ','book_new','isOS','Not\x20Found','wsNhZ','MKkag','entries','tkzPj','&load_id=','EdhGu','UQLrb','vwOqX','NmjZk','uRvUe','zMdGH','find','error','ISaiS','sip','DhsAh','action','ชี้ท\x20\x27suppliers\x27\x20ต้องมีคอลัมน์\x20\x22','AxKCw','ไม่พบประวัติการเปลี่ยนแปลง','jonBP','MgJXA','KbXXR','IsVbz','ไม่มีข้อมูล','nFyGI','ouCch','bind','buffer','rEevM','Txhsj','ScYWg','cPirv','JosrV','userFlash','cSCIM','8619640lTcGbE','UaFPW','getChangeHistory','PzjTR','write','get','test','xwCxD','vHoQa','sQlsC','dbUrl','yZuVW','taCRu','getSessionData','read','UklHr','PTwgn','xHXXC','collection','POzvL','supplierType','DugyB','minute','WOHKv','GHvsY','febmX','URilg'];_0x48db=function(){return _0x518c84;};return _0x48db();}import _0x456770 from'xlsx';import _0x2003c5 from'multer';import _0x1550ae from'ejs';import _0x223dc4 from'fs';import _0x3219bd from'path';import _0x55c869 from'../middleware/mainAuth.js';const E=await import(_0x1c086e(0x1fe)+mymoduleFolder+_0x1c086e(0x18e)),N=await import(_0x1c086e(0x1fe)+mymoduleFolder+_0x1c086e(0x1bd)),H=await import('../'+mymoduleFolder+'/myUsers.js'),G=await import('../'+mymoduleFolder+_0x1c086e(0x183)),u=_0x1c086e(0x1de),F=u+'/save',R=u+_0x1c086e(0x25e),k=u+_0x1c086e(0x285),B=u+'/import',v=u+_0x1c086e(0x2a8),L=u+_0x1c086e(0x1f6),J=u+_0x1c086e(0x250),M=u+'/upload-excel',Z=u['replace'](/\//g,'_');w[_0x1c086e(0x131)](u,_0x55c869[_0x1c086e(0x106)],async(_0x3492f1,_0x4e1a08)=>{const _0x4f1654=_0x1c086e,_0x36e0da={'DkeZH':_0x4f1654(0x203),'nNanK':function(_0x4eb21c,_0x3d9836){return _0x4eb21c(_0x3d9836);},'LQkzN':function(_0x16367b,_0x4e7b0b){return _0x16367b+_0x4e7b0b;},'gAUGP':function(_0x600aad,_0x326054){return _0x600aad+_0x326054;},'LRUZT':_0x4f1654(0x2ba),'HHVpj':_0x4f1654(0x1c5),'fWkTR':function(_0x58eb81,_0x2f36fa){return _0x58eb81(_0x2f36fa);},'KtpTU':function(_0x2d8c31,_0x48acee){return _0x2d8c31(_0x48acee);},'kSReK':function(_0x118ce9,_0xdad4de){return _0x118ce9*_0xdad4de;},'sdqpd':function(_0x3eb371,_0x4399a8){return _0x3eb371-_0x4399a8;},'JwRto':function(_0x42576a,_0x47f566){return _0x42576a!==_0x47f566;},'FZVhw':_0x4f1654(0x22a),'hIkej':_0x4f1654(0x22d),'Skigh':'$changesHistory','CtyVu':'$dateTimeCanDelete','VmZzb':_0x4f1654(0x142),'EdhGu':function(_0x177ba0,_0x24644d){return _0x177ba0===_0x24644d;},'PHRCl':_0x4f1654(0x265),'URiPC':_0x4f1654(0x255),'kZsfp':function(_0xe150d0,_0x19e74a){return _0xe150d0/_0x19e74a;},'xPnQv':function(_0x2c11a4,_0x4f583d){return _0x2c11a4<_0x4f583d;},'NjHON':function(_0x5b266f,_0x14aad8){return _0x5b266f(_0x14aad8);},'xhtjc':function(_0x3b68dc,_0xc0b64b){return _0x3b68dc(_0xc0b64b);},'vwOqX':function(_0x216dcd,_0x503360){return _0x216dcd(_0x503360);},'imqNS':function(_0x221418,_0x5785a9){return _0x221418>_0x5785a9;},'hwrvF':function(_0x1b0912,_0x36b04e){return _0x1b0912(_0x36b04e);},'NmjZk':function(_0x327c45,_0x1f1a60){return _0x327c45+_0x1f1a60;},'xwCxD':_0x4f1654(0x2a0),'cSCIM':'vmnhQ','UaFPW':function(_0x1cbd22,_0xaa5e6f){return _0x1cbd22===_0xaa5e6f;},'taCRu':_0x4f1654(0x1b0),'xbSUv':function(_0x2bddf6,_0x1826c1){return _0x2bddf6>_0x1826c1;},'JYFQj':'suppliers','MibdC':'msg','FxBue':_0x4f1654(0x12a),'sTeom':_0x4f1654(0x21f),'pUCZu':function(_0x32e09f,_0x150db7){return _0x32e09f!==_0x150db7;},'rgodT':_0x4f1654(0x269),'jZkQx':'mLQcA'},_0x2cf769=_0x3492f1[_0x4f1654(0x1e1)]['sip']?.[_0x4f1654(0x1ef)]()[_0x4f1654(0x215)](/[$.*?]/g,'\x20')||'',_0x379496=_0x36e0da[_0x4f1654(0x2c2)](Number,_0x3492f1[_0x4f1654(0x1e1)][_0x4f1654(0x268)])||0x14,_0x249e79=_0x36e0da['nNanK'](Number,_0x3492f1[_0x4f1654(0x1e1)][_0x4f1654(0x2b0)])||0x1,_0xbff6b7=_0x3492f1['query'][_0x4f1654(0x2bc)]||'',_0x583108=_0x36e0da['KtpTU'](Number,_0x36e0da[_0x4f1654(0x1ea)](_0x36e0da[_0x4f1654(0x278)](_0x249e79,0x1),_0x379496)),_0x30ae24=new _0x26f338(dbUrl);try{if(_0x36e0da[_0x4f1654(0x15e)](_0x36e0da['FZVhw'],_0x36e0da[_0x4f1654(0x279)])){const _0xdc8897=N[_0x4f1654(0x196)](),_0x1d522b={'_id':0x1,'supplierId':0x1,'supplierStatus':0x1,'supplierType':0x1,'supplierName':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierWebsite':0x1,'supplierEmail':0x1,'supplierIdentityId':0x1,'supplierTaxId':0x1,'supplierContactPerson':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x36e0da[_0x4f1654(0x290)],[]]}},'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0xdc8897},'endDate':{'$toDate':_0x36e0da['CtyVu']},'unit':_0x36e0da[_0x4f1654(0x16f)]}},0x0]},'then':!0x0,'else':!0x1}}};await _0x30ae24['connect']();const _0x1911f4=_0x30ae24['db'](dbName)[_0x4f1654(0x13e)](global[_0x4f1654(0x237)]);if(_0x2cf769){if(_0x36e0da[_0x4f1654(0x10d)](_0x36e0da[_0x4f1654(0x1a7)],_0x36e0da['PHRCl'])){const _0x371fb9=new RegExp(_0x2cf769[_0x4f1654(0x215)](/[.*+?^${}()|[\]\\]/g,_0x36e0da[_0x4f1654(0x2cc)]),'i');var _0x53499f=await _0x1911f4['countDocuments']({'$or':[{'supplierId':{'$regex':_0x371fb9}},{'supplierName':{'$regex':_0x371fb9}}]});}else{const _0x14921d=_0x1f3c5d[_0x4f1654(0x29a)](new _0x5c2fdf(_0x50029c[_0x4f1654(0x1a1)](_0x4a9a16=>_0x4fa44a[_0x4f1654(0x282)](_0x4a9a16))))[_0x4f1654(0x1a1)](_0x3039d4=>_0x3cee21['parse'](_0x3039d4));return _0x4b845b[_0x4f1654(0x177)]({'isUpload':!0x1,'color':_0x36e0da[_0x4f1654(0x2c8)],'msg':_0x4f1654(0x2be)+_0x14921d['map'](_0x359461=>_0x359461[_0x4f1654(0x19a)])[_0x4f1654(0x1e4)](',\x20'),'errorRows':_0x14921d});}}else var _0x53499f=await _0x1911f4[_0x4f1654(0x1a9)]({});const _0x2f0c7b=Math['ceil'](_0x36e0da[_0x4f1654(0x19f)](_0x53499f,_0x379496)),_0x50f8fc=_0x36e0da[_0x4f1654(0x234)](_0x36e0da['sdqpd'](_0x36e0da[_0x4f1654(0x1e2)](Number,_0x249e79),0x1),0x1)?'-':_0x36e0da[_0x4f1654(0x278)](_0x36e0da['xhtjc'](Number,_0x249e79),0x1),_0x4aadb7=_0x36e0da[_0x4f1654(0x10f)](Number,_0x249e79),_0x478075=_0x36e0da['imqNS'](_0x36e0da[_0x4f1654(0x230)](_0x36e0da[_0x4f1654(0x14a)](Number,_0x249e79),0x1),_0x2f0c7b)?'-':_0x36e0da[_0x4f1654(0x110)](_0x36e0da[_0x4f1654(0x2c2)](Number,_0x249e79),0x1),_0x3b96a8=[{'$project':_0x1d522b},{'$sort':{'supplierId':0x1}},{'$skip':_0x583108},{'$limit':_0x379496}];if(_0x2cf769){if(_0x36e0da[_0x4f1654(0x15e)](_0x36e0da[_0x4f1654(0x133)],_0x36e0da[_0x4f1654(0x12b)])){const _0x285caf=_0x2cf769?new RegExp(''+_0x2cf769,'i'):new RegExp('.*');_0x3b96a8[_0x4f1654(0x159)]({'$match':{'$or':[{'supplierId':{'$regex':_0x285caf}},{'supplierName':{'$regex':_0x285caf}}]}});}else return _0x927b9c[_0x4f1654(0x177)]({'isDownload':!0x1,'color':_0x36e0da['DkeZH'],'msg':_0x526d97[_0x4f1654(0x1e7)]});}const _0x17554f=await _0x1911f4['aggregate'](_0x3b96a8)[_0x4f1654(0xfe)]();if(_0xbff6b7){if(_0x36e0da[_0x4f1654(0x12d)](_0x36e0da['taCRu'],_0x36e0da[_0x4f1654(0x138)])){var _0x454f33=_0x17554f[_0x4f1654(0x1ff)](_0x524aef=>_0x524aef['_id']==_0xbff6b7);if(_0x36e0da[_0x4f1654(0x17c)](_0x454f33['length'],0x0))var _0xd06dde=_0x454f33[0x0];else var _0xd06dde=await _0x1911f4[_0x4f1654(0x2c0)]({'_id':new _0x13e2a5(_0xbff6b7)});}else{let _0x4d138e;try{_0x4d138e=LudhfD['nNanK'](_0x29f2db,LudhfD[_0x4f1654(0x230)](LudhfD['gAUGP'](LudhfD[_0x4f1654(0x1ac)],LudhfD[_0x4f1654(0x101)]),');'))();}catch(_0x3bceeb){_0x4d138e=_0x12f25d;}return _0x4d138e;}}const _0x5b65d2=await E[_0x4f1654(0x1f2)](_0x36e0da[_0x4f1654(0x16b)],_0x4e1a08,{'title':PAGE_SUPPLIERS,'time':N[_0x4f1654(0x25d)](),'msg':_0x3492f1[_0x4f1654(0x22f)](_0x36e0da[_0x4f1654(0x156)]),'userFlash':_0x3492f1['flash'](_0x36e0da[_0x4f1654(0x175)]),'user':await H[_0x4f1654(0x139)](_0x3492f1),'settings':await E[_0x4f1654(0x2ca)](),'load_id':_0xbff6b7,'sip':_0x2cf769,'rpp':_0x379496,'page':_0x249e79,'pagePre':_0x50f8fc,'pageAct':_0x4aadb7,'pageNxt':_0x478075,'pageLst':_0x2f0c7b,'pageRedirect':''+u,'PATH_MAIN':u,'PATH_SAVE':F,'PATH_LOAD':R,'PATH_DELETE':k,'PATH_IMPORT':B,'PATH_PRINT':v,'PATH_CHANGES':L,'PATH_DOWNLOAD_EXCEL':J,'PATH_UPLOAD_EXCEL':M,'PREFIX':Z,'data':_0x17554f,'item':_0xd06dde});_0x4e1a08['send'](_0x5b65d2);}else _0x5d7450[_0x4f1654(0x199)](_0x83d102[_0x4f1654(0x15a)])?_0x9ed3c5[_0x4f1654(0x297)](_0x29d367[_0x4f1654(0x15a)]):_0x376f77[_0x4f1654(0x297)](_0x322f28[_0x4f1654(0x15a)]);}catch(_0x17d273){if(_0x36e0da[_0x4f1654(0x12d)](_0x36e0da[_0x4f1654(0x2c6)],_0x36e0da[_0x4f1654(0x2c6)]))console[_0x4f1654(0x164)](_0x17d273),_0x4e1a08[_0x4f1654(0x1b3)](0x194)['sendFile'](file404);else{if(_0x24385d){const _0x5da80d=_0x5a9434['apply'](_0x428101,arguments);return _0x3ee83e=null,_0x5da80d;}}}finally{_0x36e0da[_0x4f1654(0x1db)](_0x36e0da[_0x4f1654(0x20d)],_0x36e0da[_0x4f1654(0x29c)])?_0x30ae24[_0x4f1654(0x218)]():_0x3b68f8[_0x4f1654(0x218)]();}}),w[_0x1c086e(0x216)](R,_0x55c869[_0x1c086e(0x106)],async(_0x55e5b3,_0x532387)=>{const _0x15ca06=_0x1c086e,_0x188bcf={'GenJv':_0x15ca06(0x209),'ysLNo':'red','XDhQg':function(_0x22bab4,_0x1aeb72){return _0x22bab4(_0x1aeb72);},'zaAEv':function(_0x47e43c,_0xe13819){return _0x47e43c(_0xe13819);},'tTmXp':function(_0x24b23e,_0x3f6fb1){return _0x24b23e!==_0x3f6fb1;},'yokWI':_0x15ca06(0x1c7),'ouCch':_0x15ca06(0x28b),'zdcDW':_0x15ca06(0x2bd),'vHoQa':_0x15ca06(0x107),'DugyB':function(_0x4308e2,_0x31b2aa){return _0x4308e2!==_0x31b2aa;},'VmbcA':_0x15ca06(0x171),'ykBZO':function(_0x3fa7dc,_0x2595dd){return _0x3fa7dc===_0x2595dd;},'SeWPW':_0x15ca06(0x236)},_0x116b86=_0x55e5b3[_0x15ca06(0x1ed)]['load_id'],_0x4d7c3=_0x55e5b3[_0x15ca06(0x1ed)]['sip'],_0x2e665f=_0x188bcf['XDhQg'](Number,_0x55e5b3['body'][_0x15ca06(0x268)])||0x14,_0x34a1ee=_0x188bcf[_0x15ca06(0x19e)](Number,_0x55e5b3[_0x15ca06(0x1ed)][_0x15ca06(0x2b0)])||0x1,_0x134924=u+'?sip='+_0x4d7c3+_0x15ca06(0x182)+_0x2e665f+_0x15ca06(0x167)+_0x34a1ee+'&load_id='+_0x116b86,_0x23ef20=new _0x26f338(dbUrl);try{if(_0x188bcf['tTmXp'](_0x188bcf[_0x15ca06(0x150)],_0x188bcf[_0x15ca06(0x122)]))return await _0x23ef20['db'](dbName)[_0x15ca06(0x13e)](global['dbColl_suppliers'])['findOne']({'_id':new _0x13e2a5(_0x116b86)},{'projection':{'changesHistory':0x0}})?_0x55e5b3[_0x15ca06(0x22f)](_0x188bcf[_0x15ca06(0x1b1)],null):_0x55e5b3[_0x15ca06(0x22f)](_0x188bcf['zdcDW'],{'class':_0x188bcf[_0x15ca06(0x243)],'text':new Error(_0x188bcf[_0x15ca06(0x134)])+_0x15ca06(0x1b5)+_0x116b86+'\x22'}),_0x532387[_0x15ca06(0x2a7)](_0x134924);else{const _0xed451f=_0x571e0['constructor'][_0x15ca06(0x251)][_0x15ca06(0x123)](_0x5ef68b),_0x4b976f=_0x1bf6a0[_0x44adb6],_0x570bde=_0x435771[_0x4b976f]||_0xed451f;_0xed451f[_0x15ca06(0x1ca)]=_0x40eddc[_0x15ca06(0x123)](_0x319743),_0xed451f[_0x15ca06(0x271)]=_0x570bde['toString'][_0x15ca06(0x123)](_0x570bde),_0x570510[_0x4b976f]=_0xed451f;}}catch(_0x1aebae){if(_0x188bcf[_0x15ca06(0x141)](_0x188bcf[_0x15ca06(0x224)],_0x188bcf[_0x15ca06(0x224)]))_0x455740[_0x15ca06(0x218)]();else return _0x55e5b3[_0x15ca06(0x22f)](_0x188bcf[_0x15ca06(0x1b1)],{'class':_0x188bcf[_0x15ca06(0x243)],'text':''+_0x1aebae[_0x15ca06(0x1e7)]}),_0x532387[_0x15ca06(0x2a7)](_0x134924);}finally{_0x188bcf[_0x15ca06(0x165)](_0x188bcf[_0x15ca06(0x2b7)],_0x188bcf[_0x15ca06(0x2b7)])?_0x23ef20['close']():(_0x5b8e70[_0x15ca06(0x164)](_0x188bcf[_0x15ca06(0x25a)],_0xb5fa05),_0x25ca02[_0x15ca06(0x177)](_0x25fd2f[_0x15ca06(0x282)]({'isPrint':!0x1,'class':_0x188bcf[_0x15ca06(0x243)],'msg':_0x500da5[_0x15ca06(0x1e7)]})));}}),w[_0x1c086e(0x216)](F,_0x55c869[_0x1c086e(0x106)],async(_0x2724e3,_0x4e0dee)=>{const _0x383113=_0x1c086e,_0x11c9f1={'DhsAh':_0x383113(0x27f),'ieukk':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','SAhah':function(_0x409b11,_0x3d366e){return _0x409b11(_0x3d366e);},'sTEhV':'init','OmOWO':function(_0x584106,_0x14355c){return _0x584106+_0x14355c;},'DSivC':_0x383113(0x223),'QraTE':function(_0x22f1e2,_0x26bc66){return _0x22f1e2+_0x26bc66;},'LiXEG':_0x383113(0x242),'TXVnk':function(_0x1b7d2a,_0x169bd1){return _0x1b7d2a(_0x169bd1);},'XsvFC':function(_0x144f17){return _0x144f17();},'UXKHN':function(_0x244501,_0x5b24e0,_0x25a8b1){return _0x244501(_0x5b24e0,_0x25a8b1);},'KbXXR':_0x383113(0x2bd),'TinBB':'red','WOHKv':_0x383113(0x103),'qXmbX':_0x383113(0x2b9),'OYyyC':_0x383113(0x209),'PiosN':_0x383113(0x238),'VBLqm':_0x383113(0x148),'KMgkL':'action','THosP':function(_0x50b626,_0x48460f){return _0x50b626+_0x48460f;},'LiSsS':_0x383113(0x2ba),'ichIQ':'{}.constructor(\x22return\x20this\x22)(\x20)','qRsew':function(_0x40df09,_0x2f79a2){return _0x40df09(_0x2f79a2);},'zgMcZ':function(_0x75dff5,_0xce0512){return _0x75dff5+_0xce0512;},'mRdmy':function(_0x42cfc4,_0x1e59ec){return _0x42cfc4===_0x1e59ec;},'UMSNi':_0x383113(0x198),'dpfNh':_0x383113(0x2c4),'Txhsj':function(_0x167fe0,_0x1140c4){return _0x167fe0!==_0x1140c4;},'ieWaZ':_0x383113(0x258),'LaEtE':function(_0x3ec421,_0x16c29d){return _0x3ec421===_0x16c29d;},'stBqN':_0x383113(0xfa),'WWrEb':'bkKKw','AIClL':function(_0x4d2a18,_0x336cfd){return _0x4d2a18==_0x336cfd;},'mAhJi':function(_0x5a0e84,_0x31c691){return _0x5a0e84!==_0x31c691;},'Fnbvr':_0x383113(0x2bf),'UQLrb':function(_0x3e8b81,_0xc45133){return _0x3e8b81>_0xc45133;},'dnGNf':function(_0x200853,_0x24687c){return _0x200853===_0x24687c;},'TtjoU':_0x383113(0x252),'QWAUZ':_0x383113(0x14d),'JcIus':_0x383113(0x263),'mayAx':function(_0x30f2d2,_0x4c93e1){return _0x30f2d2<_0x4c93e1;},'teghx':_0x383113(0x1a3),'TinJo':_0x383113(0x107),'EFXqi':_0x383113(0x161),'MKkag':_0x383113(0x1ae),'cabuh':_0x383113(0x1a6),'xukDR':function(_0x2c525f,_0x3b3055){return _0x2c525f!==_0x3b3055;},'ltBpY':'qPwJO','RYmwf':'Tcymz','zKXEZ':_0x383113(0x1c6),'jdoSJ':function(_0x37e8aa,_0x2dcf36){return _0x37e8aa!==_0x2dcf36;},'Wbzqo':'etojw','FsXOd':'Phmvn','wREJs':function(_0x4ed227,_0x5ebf52){return _0x4ed227===_0x5ebf52;},'hDHpd':'KHaqM','koRSl':_0x383113(0x1e0)},_0x950d30=_0x2724e3['body'][_0x383113(0x15a)],_0x33c687=_0x2724e3['body'][_0x383113(0x100)],_0x1f060b=_0x2724e3[_0x383113(0x1ed)][_0x383113(0x116)],_0x31813e=_0x11c9f1[_0x383113(0x2b1)](Number,_0x2724e3['body']['rpp'])||0x14,_0x45c1ae=_0x11c9f1['TXVnk'](Number,_0x2724e3['body'][_0x383113(0x2b0)])||0x1,_0x4d7638=u+_0x383113(0x153)+_0x1f060b+_0x383113(0x182)+_0x31813e+_0x383113(0x167)+_0x45c1ae+_0x383113(0x10c)+_0x33c687;delete _0x2724e3['body']['_id'],delete _0x2724e3['body'][_0x383113(0x116)],delete _0x2724e3['body'][_0x383113(0x268)],delete _0x2724e3[_0x383113(0x1ed)][_0x383113(0x2b0)],delete _0x2724e3[_0x383113(0x1ed)][_0x383113(0x15a)];const _0x109219=new _0x26f338(dbUrl);try{if(_0x11c9f1[_0x383113(0x23b)](_0x11c9f1[_0x383113(0x276)],_0x11c9f1[_0x383113(0x207)]))vBGdxp[_0x383113(0x29e)](_0x566066,this,function(){const _0x486074=_0x383113,_0x2bc9bc=new _0x76869b(vBGdxp[_0x486074(0x117)]),_0x24ad7a=new _0x47de6b(vBGdxp['ieukk'],'i'),_0x1424e1=vBGdxp['SAhah'](_0xc31f0c,vBGdxp[_0x486074(0x28c)]);!_0x2bc9bc['test'](vBGdxp[_0x486074(0x1dd)](_0x1424e1,vBGdxp[_0x486074(0x19b)]))||!_0x24ad7a['test'](vBGdxp[_0x486074(0x254)](_0x1424e1,vBGdxp['LiXEG']))?vBGdxp['TXVnk'](_0x1424e1,'0'):vBGdxp[_0x486074(0x281)](_0x3dd8d2);})();else{await _0x109219['connect']();const _0x523351=_0x109219['db'](dbName)[_0x383113(0x13e)](global[_0x383113(0x237)]);if(_0x33c687){if(_0x11c9f1[_0x383113(0x126)](_0x11c9f1[_0x383113(0x1cb)],_0x11c9f1[_0x383113(0x1cb)]))_0x26962f=_0x62d87;else{if(_0x33c687){if(_0x11c9f1[_0x383113(0x24b)](_0x11c9f1['stBqN'],_0x11c9f1['WWrEb']))_0x4f75b0['log'](_0x221fdf),_0x5b83b4[_0x383113(0x22f)](_0x11c9f1['KbXXR'],{'class':_0x11c9f1['TinBB'],'text':''+_0x39caed[_0x383113(0x1e7)]}),_0x41dd9b[_0x383113(0x1b3)](0x194)[_0x383113(0x191)](_0x4bf536);else{const _0x4d2efc=await _0x523351[_0x383113(0x2c0)]({'_id':new _0x13e2a5(_0x33c687)});if(!_0x4d2efc)return _0x2724e3[_0x383113(0x22f)](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1[_0x383113(0x2ad)],'text':_0x383113(0x2b5)+_0x950d30}),_0x4e0dee[_0x383113(0x2a7)](u);const _0x1caabd=await _0x523351[_0x383113(0x2c5)]({'_id':new _0x13e2a5(_0x33c687)},{'$set':_0x2724e3[_0x383113(0x1ed)]},{'upsert':!0x1});if(_0x1caabd[_0x383113(0x2b3)]&&_0x11c9f1[_0x383113(0x1d6)](_0x1caabd[_0x383113(0x1c8)],0x1)){if(_0x11c9f1['mAhJi'](_0x11c9f1[_0x383113(0x20b)],_0x11c9f1[_0x383113(0x20b)]))_0xfc7e41[_0x383113(0x218)]();else{let _0x1c90f3=_0x383113(0x283)+_0x950d30+_0x383113(0x23a);const _0x3ffe90=G[_0x383113(0x12e)](_0x4d2efc,_0x2724e3[_0x383113(0x1ed)]);if(_0x3ffe90&&_0x11c9f1[_0x383113(0x10e)](_0x3ffe90['length'],0x0)){if(_0x11c9f1['dnGNf'](_0x11c9f1[_0x383113(0x152)],_0x11c9f1['TtjoU'])){const _0x15b08=await H[_0x383113(0x139)](_0x2724e3),_0x597ddf={'dateTime':N[_0x383113(0x196)](),'userId':_0x15b08['userId'],'userFullname':_0x15b08[_0x383113(0x284)],'changes':_0x3ffe90};await _0x523351[_0x383113(0x2c5)]({'supplierId':_0x950d30},{'$push':{'changesHistory':{'$each':[_0x597ddf],'$position':0x0}}}),_0x1c90f3+=_0x11c9f1[_0x383113(0x1b7)];}else return function(_0x3704ef){}[_0x383113(0x1fc)](vBGdxp[_0x383113(0x143)])[_0x383113(0x21c)](vBGdxp['qXmbX']);}return _0x2724e3['flash'](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1[_0x383113(0x185)],'text':_0x1c90f3}),_0x4e0dee[_0x383113(0x2a7)](_0x4d7638);}}else return _0x1caabd[_0x383113(0x2b3)]&&_0x11c9f1[_0x383113(0x239)](_0x1caabd[_0x383113(0x1c8)],0x1)?(_0x2724e3[_0x383113(0x22f)](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1['teghx'],'text':'\x22'+_0x950d30+_0x383113(0x2b6)}),_0x4e0dee['redirect'](_0x4d7638)):(_0x2724e3[_0x383113(0x22f)](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1[_0x383113(0x2ad)],'text':new Error(_0x11c9f1[_0x383113(0x14e)])+_0x383113(0x1b5)+_0x950d30+'\x22'}),_0x4e0dee[_0x383113(0x2a7)](u));}}}}else{if(_0x11c9f1[_0x383113(0x126)](_0x11c9f1[_0x383113(0x1a0)],_0x11c9f1[_0x383113(0x1a0)]))_0x46c436[_0x383113(0x164)](_0x11c9f1['OYyyC'],_0x5039cc['message']),_0x4ad241['send'](_0x274ed2['stringify']({'isPrint':!0x1,'class':_0x11c9f1[_0x383113(0x2ad)],'msg':_0x4cee63[_0x383113(0x1e7)]}));else{let _0x2b9aab=_0x11c9f1[_0x383113(0x109)];const _0x2fa289=await _0x523351[_0x383113(0x113)]({},{'projection':{'supplierId':0x1}})[_0x383113(0x162)]({'supplierId':-0x1})['limit'](0x1)['toArray']();if(_0x11c9f1['UQLrb'](_0x2fa289[_0x383113(0x170)],0x0)){if(_0x11c9f1[_0x383113(0x126)](_0x11c9f1[_0x383113(0x1f1)],_0x11c9f1[_0x383113(0x1f1)]))(function(){return!![];}['constructor'](vBGdxp[_0x383113(0x1dd)](vBGdxp['PiosN'],vBGdxp['VBLqm']))['call'](vBGdxp[_0x383113(0x291)]));else{const _0x418898=_0x2fa289[0x0][_0x383113(0x15a)]['slice'](0x1),_0x65c93f=_0x11c9f1[_0x383113(0x2b1)](Number,_0x418898);_0x2b9aab='S'+_0x11c9f1[_0x383113(0x2b1)](String,_0x11c9f1[_0x383113(0x1dd)](_0x65c93f,0x1))[_0x383113(0x274)](0x4,'0');}}if(_0x2724e3[_0x383113(0x1ed)][_0x383113(0x15a)]=_0x2b9aab,_0x2724e3[_0x383113(0x1ed)][_0x383113(0x2c9)]=N[_0x383113(0x196)](0x5a0),await _0x523351[_0x383113(0x2c0)]({'supplierId':_0x2b9aab}))return _0x2724e3['flash'](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1[_0x383113(0x2ad)],'text':'\x22'+_0x2b9aab+_0x383113(0x275)}),_0x4e0dee[_0x383113(0x2a7)](u);const _0x26a954=await _0x523351[_0x383113(0x2a2)](_0x2724e3[_0x383113(0x1ed)]);if(_0x26a954[_0x383113(0x2b3)]&&_0x26a954['insertedId']){if(_0x11c9f1[_0x383113(0x1e3)](_0x11c9f1[_0x383113(0x2aa)],_0x11c9f1['RYmwf'])){const _0x3a2197=u+_0x383113(0x153)+_0x1f060b+_0x383113(0x182)+_0x31813e+_0x383113(0x167)+_0x45c1ae+'&load_id='+_0x26a954['insertedId'];return _0x2724e3[_0x383113(0x22f)](_0x11c9f1['KbXXR'],{'class':_0x11c9f1[_0x383113(0x185)],'text':_0x383113(0x1eb)+_0x2724e3[_0x383113(0x1ed)][_0x383113(0x15a)]+_0x383113(0x23a)}),_0x4e0dee[_0x383113(0x2a7)](_0x3a2197);}else vBGdxp['TXVnk'](_0x422399,'0');}else return _0x2724e3[_0x383113(0x22f)](_0x11c9f1['KbXXR'],{'class':_0x11c9f1[_0x383113(0x2ad)],'text':new Error(_0x11c9f1[_0x383113(0x1c3)])+_0x383113(0x1b5)+_0x2b9aab+'\x22'}),_0x4e0dee[_0x383113(0x2a7)](u);}}}}catch(_0x39407e){_0x11c9f1[_0x383113(0x27c)](_0x11c9f1['Wbzqo'],_0x11c9f1['FsXOd'])?(console[_0x383113(0x164)](_0x39407e),_0x2724e3[_0x383113(0x22f)](_0x11c9f1[_0x383113(0x11e)],{'class':_0x11c9f1[_0x383113(0x2ad)],'text':''+_0x39407e[_0x383113(0x1e7)]}),_0x4e0dee['status'](0x194)[_0x383113(0x191)](file404)):_0xf4bbce=vBGdxp[_0x383113(0x26e)](_0x5bd2fc,vBGdxp[_0x383113(0x1dd)](vBGdxp[_0x383113(0x1f5)](vBGdxp['LiSsS'],vBGdxp[_0x383113(0x1f7)]),');'))();}finally{if(_0x11c9f1[_0x383113(0x17a)](_0x11c9f1[_0x383113(0x298)],_0x11c9f1[_0x383113(0x160)])){const _0x467c92=_0x4a5187[0x0][_0x383113(0x15a)]['slice'](0x1),_0x201948=_0x11c9f1['SAhah'](_0x1376c6,_0x467c92);_0x20f275='S'+_0x11c9f1[_0x383113(0x2b1)](_0x474d95,_0x11c9f1[_0x383113(0x253)](_0x201948,0x1))[_0x383113(0x274)](0x4,'0');}else _0x109219[_0x383113(0x218)]();}}),w['post'](k,_0x55c869[_0x1c086e(0x106)],async(_0x4a0ff0,_0x1a63bd)=>{const _0x1e97dc=_0x1c086e,_0x4c699c={'sXYoC':function(_0x1bc3c8,_0x12d18d){return _0x1bc3c8(_0x12d18d);},'uRvUe':function(_0x3d3012,_0x53021b){return _0x3d3012!=_0x53021b;},'UdJyt':function(_0x315420,_0x289b35){return _0x315420===_0x289b35;},'uLiQa':'ihXgc','rEevM':_0x1e97dc(0x197),'ouctb':'msg','ZgIsH':_0x1e97dc(0x203),'hxVBz':function(_0x4e057c,_0xed447d){return _0x4e057c===_0xed447d;},'Lpenf':_0x1e97dc(0x263),'lcJbL':'Error\x20while\x20deleting','kmURX':function(_0x1d3ac1,_0x325cc7){return _0x1d3ac1===_0x325cc7;},'KVqCt':_0x1e97dc(0x188),'svnkL':_0x1e97dc(0x212),'ViZfY':function(_0x3151e6,_0x327bd7){return _0x3151e6!==_0x327bd7;},'HBxIZ':'Pydel'},{idToDelete:_0x366770,load_id:_0x748c5,sip:_0x55849b}=_0x4a0ff0[_0x1e97dc(0x1ed)],_0x96fbde=_0x4a0ff0[_0x1e97dc(0x1ed)]['supplierId'],_0x7f50=_0x4c699c['sXYoC'](Number,_0x4a0ff0['body'][_0x1e97dc(0x268)])||0x14,_0x16f0ff=_0x4c699c['sXYoC'](Number,_0x4a0ff0['body']['page'])||0x1,_0x5d639b=_0x748c5&&_0x4c699c[_0x1e97dc(0x111)](_0x748c5,_0x366770)?_0x1e97dc(0x10c)+_0x748c5:'',_0x28633c=u+_0x1e97dc(0x153)+_0x55849b+'&rpp='+_0x7f50+_0x1e97dc(0x167)+_0x16f0ff+_0x5d639b,_0x37b2d2=new _0x26f338(dbUrl);try{if(_0x4c699c[_0x1e97dc(0x28e)](_0x4c699c['uLiQa'],_0x4c699c[_0x1e97dc(0x125)]))_0x2a381f['log'](_0x2f764f),_0x477794[_0x1e97dc(0x1b3)](0x194)['sendFile'](_0x4c3578);else{await _0x37b2d2[_0x1e97dc(0x24a)]();const _0x54c6f6=_0x37b2d2['db'](dbName),_0x2ec353=_0x54c6f6['collection'](global[_0x1e97dc(0x237)]);if(!await _0x2ec353[_0x1e97dc(0x2c0)]({'_id':new _0x13e2a5(_0x366770)}))return _0x4a0ff0['flash'](_0x4c699c[_0x1e97dc(0x25f)],{'class':_0x4c699c[_0x1e97dc(0x1ab)],'text':_0x1e97dc(0x270)+_0x96fbde+'\x22'}),_0x1a63bd[_0x1e97dc(0x2a7)](_0x28633c);const _0x50bf38=[{'coll':_0x54c6f6[_0x1e97dc(0x13e)](global[_0x1e97dc(0x180)]),'name':global[_0x1e97dc(0x180)]}];for(const {coll:_0x42ce87,name:_0x17bc1e}of _0x50bf38)if(await _0x42ce87[_0x1e97dc(0x2c0)]({'supplierId':_0x366770}))return await _0x2ec353['updateOne']({'supplierId':_0x366770},{'$set':{'canDelete':!0x1}}),_0x4a0ff0[_0x1e97dc(0x22f)](_0x4c699c[_0x1e97dc(0x25f)],{'class':_0x4c699c[_0x1e97dc(0x1ab)],'text':'ผู้จัดจำหน่าย\x20\x22'+_0x366770+_0x1e97dc(0x232)+_0x17bc1e+_0x1e97dc(0x1da)}),_0x1a63bd[_0x1e97dc(0x2a7)](_0x28633c);return _0x4c699c[_0x1e97dc(0x2ae)]((await _0x2ec353[_0x1e97dc(0x1ce)]({'_id':new _0x13e2a5(_0x366770)}))[_0x1e97dc(0x16d)],0x1)?(_0x4a0ff0[_0x1e97dc(0x22f)](_0x4c699c[_0x1e97dc(0x25f)],{'class':_0x4c699c[_0x1e97dc(0x226)],'text':_0x1e97dc(0x235)+_0x96fbde+_0x1e97dc(0x23a)}),_0x1a63bd['redirect'](_0x28633c)):(console[_0x1e97dc(0x164)](_0x4c699c[_0x1e97dc(0x220)]),_0x4a0ff0['flash'](_0x4c699c[_0x1e97dc(0x25f)],{'class':_0x4c699c['ZgIsH'],'text':'เกิดข้อผิดพลาดขณะลบ\x20\x22'+_0x96fbde+'\x22'}),_0x1a63bd[_0x1e97dc(0x2a7)](_0x28633c));}}catch(_0x3cb80f){if(_0x4c699c[_0x1e97dc(0x264)](_0x4c699c[_0x1e97dc(0x222)],_0x4c699c[_0x1e97dc(0x28a)])){const _0x5f40d2=_0x449d20['apply'](_0x3de320,arguments);return _0x410470=null,_0x5f40d2;}else return _0x4a0ff0[_0x1e97dc(0x22f)](_0x4c699c[_0x1e97dc(0x25f)],{'class':_0x4c699c[_0x1e97dc(0x1ab)],'text':_0x3cb80f['message']}),_0x1a63bd[_0x1e97dc(0x2a7)](_0x28633c);}finally{if(_0x4c699c['ViZfY'](_0x4c699c[_0x1e97dc(0x1bb)],_0x4c699c[_0x1e97dc(0x1bb)]))return![];else _0x37b2d2['close']();}}),w[_0x1c086e(0x216)](v,_0x55c869[_0x1c086e(0x106)],async(_0x2a6340,_0x5c0214)=>{const _0x51ce39=_0x1c086e,_0xb7cc78={'KKxpD':function(_0x4e5d45,_0x399a69){return _0x4e5d45(_0x399a69);},'YOYyn':function(_0x254a42,_0xa2bbe3){return _0x254a42!==_0xa2bbe3;},'pxvFd':_0x51ce39(0x13f),'bywqD':_0x51ce39(0x21e),'lMfGA':function(_0x36e7ec,_0x349f60){return _0x36e7ec==_0x349f60;},'tCKfn':_0x51ce39(0x203),'xQLCg':_0x51ce39(0x157),'oLQNt':_0x51ce39(0x19c),'DiGRZ':_0x51ce39(0x240),'svfLC':_0x51ce39(0x144),'PNQiW':_0x51ce39(0x27e),'hVvWJ':_0x51ce39(0x209),'VEkPv':function(_0x3d3f86,_0x675335){return _0x3d3f86===_0x675335;},'OwSsW':_0x51ce39(0x247),'OuGnl':_0x51ce39(0x23f)},{idsArr:_0x4a6c86}=_0x2a6340[_0x51ce39(0x1ed)],_0x644358=new _0x26f338(dbUrl);try{if(_0xb7cc78[_0x51ce39(0x227)](_0xb7cc78[_0x51ce39(0x262)],_0xb7cc78[_0x51ce39(0x262)])){const _0x2e10c0=_0x5b5f14[_0x51ce39(0x21c)](_0x1ed285,arguments);return _0x3d1bd6=null,_0x2e10c0;}else{await _0x644358['connect']();const _0x185b16=await _0x644358['db'](global[_0x51ce39(0x2c3)])[_0x51ce39(0x13e)](global[_0x51ce39(0x237)])['aggregate']([{'$match':{'supplierId':{'$in':_0x4a6c86}}},{'$project':{'_id':0x0,'changesHistory':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x4a6c86,_0xb7cc78[_0x51ce39(0x1ec)]]}}},{'$sort':{'__order':0x1}}])[_0x51ce39(0xfe)]();if(_0xb7cc78['lMfGA'](_0x185b16[_0x51ce39(0x170)],0x0))return _0x5c0214[_0x51ce39(0x177)](JSON[_0x51ce39(0x282)]({'isPrint':!0x1,'class':_0xb7cc78[_0x51ce39(0x194)],'msg':_0xb7cc78['xQLCg']}));const _0x423c99=_0x3219bd[_0x51ce39(0x1e4)](folderForms,_0xb7cc78['oLQNt']),_0x328965=_0x223dc4[_0x51ce39(0x299)](_0x423c99,_0xb7cc78[_0x51ce39(0x1d2)]),_0x2e4433=_0x1550ae[_0x51ce39(0x225)](_0x328965,{'time':N[_0x51ce39(0x196)](),'title':_0x51ce39(0x292)+_0x185b16[_0x51ce39(0x170)]+']','data':_0x185b16,'dateTime':N[_0x51ce39(0x196)]()});_0x5c0214[_0x51ce39(0x177)](JSON['stringify']({'isPrint':!0x0,'htmlPage':_0x2e4433}));}}catch(_0x323409){_0xb7cc78[_0x51ce39(0x227)](_0xb7cc78[_0x51ce39(0x2d1)],_0xb7cc78[_0x51ce39(0x27d)])?(console[_0x51ce39(0x164)](_0xb7cc78[_0x51ce39(0x28d)],_0x323409[_0x51ce39(0x1e7)]),_0x5c0214[_0x51ce39(0x177)](JSON[_0x51ce39(0x282)]({'isPrint':!0x1,'class':_0xb7cc78[_0x51ce39(0x194)],'msg':_0x323409[_0x51ce39(0x1e7)]}))):_0x537ba1[_0x51ce39(0x218)]();}finally{if(_0xb7cc78['VEkPv'](_0xb7cc78[_0x51ce39(0x1ad)],_0xb7cc78[_0x51ce39(0xfc)])){if(_0x2f889e)return _0x2c046d;else sjtMsU[_0x51ce39(0x1e6)](_0x13ed2f,0x0);}else _0x644358[_0x51ce39(0x218)]();}}),w[_0x1c086e(0x216)](L,_0x55c869[_0x1c086e(0x106)],async(_0x56f3d2,_0x3edae7)=>{const _0x546407=_0x1c086e,_0x522966={'ApiGf':function(_0x33bb2d,_0x25ee21){return _0x33bb2d(_0x25ee21);},'SmMtF':function(_0x1269bb,_0x2122df){return _0x1269bb!==_0x2122df;},'DzTfy':'xCZwT','OBkvp':_0x546407(0x26a),'kjFNu':_0x546407(0x203),'iMTvE':function(_0x33c00a,_0x2eb8e4){return _0x33c00a<_0x2eb8e4;},'MqFYT':_0x546407(0x1a3),'UXIMu':_0x546407(0x11b),'febmX':_0x546407(0x2b2),'RkYyz':_0x546407(0x263),'iTNvX':function(_0x980b52,_0x2c0fe9){return _0x980b52!==_0x2c0fe9;},'fGYRv':_0x546407(0xff),'sCZYx':_0x546407(0x209),'ndDmp':function(_0x25db7f,_0x5c266d){return _0x25db7f!==_0x5c266d;},'PzjTR':_0x546407(0x2c1),'AxKCw':'pRaRg'};let {supplierId:_0x501b0e}=_0x56f3d2[_0x546407(0x1ed)];const _0x460ad1=new _0x26f338(global[_0x546407(0x136)]);try{if(_0x522966[_0x546407(0x1aa)](_0x522966[_0x546407(0x244)],_0x522966[_0x546407(0x189)])){await _0x460ad1[_0x546407(0x24a)]();var _0x5b37ee=await _0x460ad1['db'](global['dbName'])[_0x546407(0x13e)](global[_0x546407(0x237)])[_0x546407(0x2c0)]({'supplierId':_0x501b0e});if(!_0x5b37ee)return _0x3edae7['send'](JSON[_0x546407(0x282)]({'isPrint':!0x1,'class':_0x522966['kjFNu'],'msg':'ไม่พบ\x20\x22'+_0x501b0e+'\x22'}));const _0x2e27a9=_0x5b37ee['changesHistory']||[];if(_0x522966['iMTvE'](_0x2e27a9[_0x546407(0x170)],0x1))return _0x3edae7[_0x546407(0x177)](JSON[_0x546407(0x282)]({'isPrint':!0x1,'class':_0x522966[_0x546407(0x1d5)],'msg':_0x522966[_0x546407(0x200)]}));const _0x1480fe=_0x3219bd[_0x546407(0x1e4)](folderForms,_0x522966[_0x546407(0x145)]),_0x4d47cb=await E[_0x546407(0x1f2)](_0x1480fe,_0x3edae7,{'title':_0x546407(0x23e)+_0x5b37ee[_0x546407(0x15a)]+']\x20'+_0x5b37ee['supplierName'],'time':N[_0x546407(0x196)](),'changesHistory':_0x2e27a9});_0x3edae7[_0x546407(0x177)](JSON[_0x546407(0x282)]({'isPrint':!0x0,'class':_0x522966[_0x546407(0x2ac)],'htmlPage':_0x4d47cb}));}else _0xc07ec1['close']();}catch(_0x3d30d5){if(_0x522966[_0x546407(0x266)](_0x522966[_0x546407(0x1c0)],_0x522966[_0x546407(0x1c0)])){const _0x5240c4=_0x571954?new _0x4c97e7(''+_0x353504,'i'):new _0x3f4155('.*');_0xd2312[_0x546407(0x159)]({'$match':{'$or':[{'supplierId':{'$regex':_0x5240c4}},{'supplierName':{'$regex':_0x5240c4}}]}});}else console['log'](_0x522966[_0x546407(0x1c1)],_0x3d30d5),_0x3edae7['send'](JSON[_0x546407(0x282)]({'isPrint':!0x1,'class':_0x522966['kjFNu'],'msg':_0x3d30d5[_0x546407(0x1e7)]}));}finally{_0x522966['ndDmp'](_0x522966[_0x546407(0x12f)],_0x522966[_0x546407(0x11a)])?_0x460ad1[_0x546407(0x218)]():sTQmGx['ApiGf'](_0x246dde,0x0);}}),w['post'](J,_0x55c869[_0x1c086e(0x106)],async(_0x3be497,_0x172290)=>{const _0x476778=_0x1c086e,_0x165dca={'JkfSk':function(_0x3d5b30,_0x5236af){return _0x3d5b30!==_0x5236af;},'fOrwD':'NHeAt','vjYKG':_0x476778(0x295),'SGEZc':_0x476778(0x193),'mRjvB':function(_0x3468e9,_0x27085c){return _0x3468e9==_0x27085c;},'mskYI':'red','RAquC':_0x476778(0x120),'EhzfI':_0x476778(0x1df),'vJzJX':_0x476778(0x124),'LnjkG':'xlsx','MgJXA':_0x476778(0x263),'VbdkD':_0x476778(0x1d0),'ghPjf':'base64','yNYqH':_0x476778(0x19d)},_0x94f8a9=new _0x26f338(dbUrl);try{if(_0x165dca[_0x476778(0x27a)](_0x165dca['fOrwD'],_0x165dca[_0x476778(0x1dc)])){await _0x94f8a9[_0x476778(0x24a)]();const _0x4fae3c=await _0x94f8a9['db'](dbName)[_0x476778(0x13e)](dbColl_suppliers)[_0x476778(0x169)]([{'$project':{'_id':0x0,'supplierId':0x1,'supplierType':0x1,'supplierStatus':0x1,'supplierName':0x1,'supplierContactPerson':0x1,'supplierAddress1':0x1,'supplierAddress2':0x1,'supplierProvince':0x1,'supplierPhone':0x1,'supplierEmail':0x1,'supplierWebsite':0x1,'supplierTaxId':0x1,'supplierIdentityId':0x1,'dateTimeCanDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x165dca[_0x476778(0x149)],[]]}}}},{'$sort':{'supplierId':0x1}}])['toArray']();if(_0x165dca[_0x476778(0x25c)](_0x4fae3c[_0x476778(0x170)],0x0))return _0x172290[_0x476778(0x177)](JSON['stringify']({'isDownload':!0x1,'class':_0x165dca['mskYI'],'msg':_0x165dca[_0x476778(0x147)]}));const _0x466fa9='suppliers_'+N[_0x476778(0x196)]()[_0x476778(0x215)](/[: ]/g,'-')+_0x476778(0x26b),_0x1b317f=_0x456770[_0x476778(0x24e)][_0x476778(0x249)](_0x4fae3c),_0x1a0ebf=_0x456770['utils'][_0x476778(0x105)]();_0x456770[_0x476778(0x24e)][_0x476778(0x1c4)](_0x1a0ebf,_0x1b317f,_0x165dca['EhzfI']);const _0xa343a2=_0x456770[_0x476778(0x130)](_0x1a0ebf,{'type':_0x165dca[_0x476778(0x1d9)],'bookType':_0x165dca[_0x476778(0x20a)]});_0x172290[_0x476778(0x177)]({'isDownload':!0x0,'color':_0x165dca[_0x476778(0x11d)],'msg':_0x165dca[_0x476778(0x296)],'filename':_0x466fa9,'fileData':_0xa343a2[_0x476778(0x271)](_0x165dca[_0x476778(0x211)])});}else return _0x54288d;}catch(_0x29b1be){if(_0x165dca['JkfSk'](_0x165dca[_0x476778(0x260)],_0x165dca['yNYqH']))_0x249a11[_0x476778(0x218)]();else return _0x172290[_0x476778(0x177)]({'isDownload':!0x1,'color':_0x165dca[_0x476778(0x29b)],'msg':_0x29b1be['message']});}finally{_0x94f8a9[_0x476778(0x218)]();}});const K=_0x2003c5({'storage':_0x2003c5[_0x1c086e(0x2b4)]()});w[_0x1c086e(0x216)](M,_0x55c869['isOS'],K[_0x1c086e(0x190)](_0x1c086e(0x229)),async(_0x32f0b4,_0x255193)=>{const _0x37f82=_0x1c086e,_0x3d0e3b={'vBqOO':_0x37f82(0x203),'QnXOV':_0x37f82(0x20e),'IsVbz':'buffer','rXCfb':'suppliers','IZYBo':function(_0x554968,_0x1f8b54){return _0x554968>_0x1f8b54;},'qapUQ':'supplierId','lEUme':_0x37f82(0x140),'psAgM':_0x37f82(0x1cc),'AEIMH':'supplierName','CpPdm':'supplierContactPerson','tkzPj':_0x37f82(0x29f),'ZmUww':_0x37f82(0x293),'xahWZ':'supplierProvince','LuXcC':_0x37f82(0x102),'cqsXp':'supplierEmail','dmqiU':_0x37f82(0x1a4),'zZWNE':_0x37f82(0x1b4),'BqCpC':'supplierIdentityId','yepBt':'dateTimeCanDelete','AxfND':function(_0x558100,_0x5c351f){return _0x558100>_0x5c351f;},'zUzSo':_0x37f82(0x176),'MgdJp':_0x37f82(0x17d),'Tyxwi':'active','VmzUe':function(_0x3a69ba,_0x19e27e){return _0x3a69ba+_0x19e27e;},'QNoMD':function(_0x29ec8d,_0x316851){return _0x29ec8d===_0x316851;},'fOlJc':function(_0x4e3ab2,_0x1ff73e){return _0x4e3ab2===_0x1ff73e;},'PkaEZ':function(_0x2e9dd1,_0x2482d2){return _0x2e9dd1!=_0x2482d2;},'iZDLq':_0x37f82(0x29d),'URilg':function(_0x462d9d,_0x271989){return _0x462d9d<_0x271989;},'ISaiS':function(_0x3bf374,_0x53a408){return _0x3bf374>_0x53a408;},'NNoUJ':function(_0x3660da,_0x3ad88a){return _0x3660da+_0x3ad88a;},'rZZbq':_0x37f82(0x201),'awjkG':'green','qbbcy':_0x37f82(0x209)},_0x107064=new _0x26f338(dbUrl);try{if(!_0x32f0b4[_0x37f82(0x18c)])return _0x255193['send']({'isUpload':!0x1,'color':_0x3d0e3b[_0x37f82(0x231)],'msg':_0x3d0e3b[_0x37f82(0x22c)]});const _0x4c2780=_0x456770[_0x37f82(0x13a)](_0x32f0b4[_0x37f82(0x18c)][_0x37f82(0x124)],{'type':_0x3d0e3b[_0x37f82(0x11f)]}),_0x3d7378=[_0x3d0e3b['rXCfb']],_0xe15bc=_0x4c2780[_0x37f82(0x22e)],_0x469d36=_0x3d7378[_0x37f82(0x1ff)](_0xf4bda8=>!_0xe15bc[_0x37f82(0x2bb)](_0xf4bda8));if(_0x3d0e3b[_0x37f82(0x15b)](_0x469d36[_0x37f82(0x170)],0x0))return _0x255193[_0x37f82(0x177)]({'isUpload':!0x1,'color':_0x3d0e3b[_0x37f82(0x231)],'msg':_0x37f82(0x16c)+_0x469d36[_0x37f82(0x1e4)](',\x20')+'\x22'});const _0x5099d4=_0x4c2780[_0x37f82(0x257)]['suppliers'],_0x2b3845=_0x456770[_0x37f82(0x24e)][_0x37f82(0x1e9)](_0x5099d4),_0x4872ae=[_0x3d0e3b[_0x37f82(0x174)],_0x3d0e3b[_0x37f82(0x1fd)],_0x3d0e3b['psAgM'],_0x3d0e3b['AEIMH'],_0x3d0e3b[_0x37f82(0x248)],_0x3d0e3b[_0x37f82(0x10b)],_0x3d0e3b['ZmUww'],_0x3d0e3b[_0x37f82(0x221)],_0x3d0e3b[_0x37f82(0x155)],_0x3d0e3b[_0x37f82(0x166)],_0x3d0e3b[_0x37f82(0x1ba)],_0x3d0e3b[_0x37f82(0x217)],_0x3d0e3b[_0x37f82(0x256)],_0x3d0e3b[_0x37f82(0x2ce)]][_0x37f82(0x1ff)](_0x53dd00=>!_0x2b3845['some'](_0x3ebc0f=>Object[_0x37f82(0x251)][_0x37f82(0x2a5)][_0x37f82(0x1af)](_0x3ebc0f,_0x53dd00)));if(_0x3d0e3b[_0x37f82(0x15b)](_0x4872ae[_0x37f82(0x170)],0x0))return _0x255193['send']({'isUpload':!0x1,'color':_0x3d0e3b[_0x37f82(0x231)],'msg':_0x37f82(0x119)+_0x4872ae[_0x37f82(0x1e4)](',\x20')+'\x22'});const _0xedc2b7=new Set(),_0x5b8b55=new Set();if(_0x2b3845[_0x37f82(0x195)](_0x1bf1d0=>{const _0x1684e8=_0x37f82;_0xedc2b7[_0x1684e8(0x199)](_0x1bf1d0[_0x1684e8(0x15a)])?_0x5b8b55['add'](_0x1bf1d0[_0x1684e8(0x15a)]):_0xedc2b7[_0x1684e8(0x297)](_0x1bf1d0[_0x1684e8(0x15a)]);}),_0x3d0e3b['AxfND'](_0x5b8b55[_0x37f82(0x1fb)],0x0))return _0x255193['send']({'isUpload':!0x1,'color':_0x3d0e3b[_0x37f82(0x231)],'msg':'มี\x20supplierId\x20ซ้ำกัน:\x20\x22'+Array[_0x37f82(0x29a)](_0x5b8b55)[_0x37f82(0x1e4)](',\x20')+'\x22'});const _0x56d2b8=[],_0x6fe375=new RegExp(global['TAXID_PATTERN']),_0x2dbff2=/^S[A-Za-z0-9]{4}$/,_0x18863a=[_0x3d0e3b['zUzSo'],_0x3d0e3b[_0x37f82(0x186)]],_0x453edb=[_0x3d0e3b['Tyxwi'],''];for(const [_0x33ba94,_0x2549d2]of _0x2b3845[_0x37f82(0x10a)]()){const _0x4a7685=_0x3d0e3b['VmzUe'](_0x33ba94,0x2),_0x2b358a={'supplierId':_0x2549d2[_0x37f82(0x15a)],'row':_0x4a7685};if(!_0x2549d2[_0x37f82(0x15a)]||_0x3d0e3b[_0x37f82(0x26f)](_0x2dbff2[_0x37f82(0x132)](_0x2549d2[_0x37f82(0x15a)]),!0x1)){_0x56d2b8[_0x37f82(0x2a9)](_0x2b358a);continue;}if(!_0x2549d2[_0x37f82(0x140)]||!_0x18863a['includes'](_0x2549d2[_0x37f82(0x140)])){_0x56d2b8[_0x37f82(0x2a9)](_0x2b358a);continue;}if(_0x3d0e3b['fOlJc'](_0x2549d2[_0x37f82(0x1cc)],void 0x0)||!_0x453edb['includes'](_0x2549d2[_0x37f82(0x1cc)])){_0x56d2b8[_0x37f82(0x2a9)](_0x2b358a);continue;}if(!_0x2549d2[_0x37f82(0x2a3)]||_0x3d0e3b['PkaEZ'](typeof _0x2549d2[_0x37f82(0x2a3)],_0x3d0e3b[_0x37f82(0x25b)])||_0x3d0e3b[_0x37f82(0x146)](_0x2549d2[_0x37f82(0x2a3)][_0x37f82(0x1ef)]()[_0x37f82(0x170)],0x1)){_0x56d2b8[_0x37f82(0x2a9)](_0x2b358a);continue;}if(_0x2549d2[_0x37f82(0x1b4)]&&!_0x6fe375['test'](_0x2549d2[_0x37f82(0x1b4)])){_0x56d2b8['push'](_0x2b358a);continue;}if(_0x2549d2['supplierIdentityId']&&!_0x6fe375[_0x37f82(0x132)](_0x2549d2[_0x37f82(0x204)])){_0x56d2b8[_0x37f82(0x2a9)](_0x2b358a);continue;}if(!_0x2549d2[_0x37f82(0x2c9)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/['test'](_0x2549d2['dateTimeCanDelete'])){_0x56d2b8['push'](_0x2b358a);continue;}}if(_0x3d0e3b[_0x37f82(0x115)](_0x56d2b8[_0x37f82(0x170)],0x0)){const _0xe7fabd=Array[_0x37f82(0x29a)](new Set(_0x56d2b8['map'](_0x558914=>JSON[_0x37f82(0x282)](_0x558914))))['map'](_0x5857d0=>JSON[_0x37f82(0x286)](_0x5857d0));return _0x255193['send']({'isUpload':!0x1,'color':_0x3d0e3b[_0x37f82(0x231)],'msg':_0x37f82(0x2be)+_0xe7fabd['map'](_0x255882=>_0x255882['row'])['join'](',\x20'),'errorRows':_0xe7fabd});}await _0x107064[_0x37f82(0x24a)]();const _0x1dba30=_0x107064['db'](dbName)[_0x37f82(0x13e)](dbColl_suppliers),_0x25f88f=[];for(const _0x1a1a47 of _0x2b3845){_0x1a1a47['supplierType']||(_0x1a1a47[_0x37f82(0x140)]='');const _0x1186e0=await _0x1dba30['updateOne']({'supplierId':_0x1a1a47[_0x37f82(0x15a)]},{'$set':_0x1a1a47},{'upsert':!0x0});_0x25f88f['push']({'supplierId':_0x1a1a47[_0x37f82(0x15a)],'matchedCount':_0x1186e0[_0x37f82(0x16a)],'upsertedCount':_0x1186e0[_0x37f82(0x26c)]});}const _0x608785=_0x3d0e3b[_0x37f82(0x15b)](_0x25f88f[_0x37f82(0x170)],0x0)?_0x3d0e3b[_0x37f82(0x1a2)](_0x37f82(0x14b)+_0x25f88f[_0x37f82(0x1ff)](_0x375bad=>_0x375bad[_0x37f82(0x16a)]>0x0)[_0x37f82(0x170)]+_0x37f82(0x24d),('{{sep}}เพิ่มใหม่\x20'+_0x25f88f[_0x37f82(0x1ff)](_0x3af8b6=>_0x3af8b6[_0x37f82(0x26c)]>0x0)[_0x37f82(0x170)]+_0x37f82(0x24d))[_0x37f82(0x1ef)]()):_0x3d0e3b['rZZbq'];return _0x255193[_0x37f82(0x177)]({'isUpload':!0x0,'color':_0x3d0e3b[_0x37f82(0x23c)],'msg':_0x608785});}catch(_0x175df0){return console[_0x37f82(0x164)](_0x3d0e3b[_0x37f82(0x1b2)],_0x175df0),_0x255193['send']({'isDownload':!0x1,'color':_0x3d0e3b['vBqOO'],'msg':_0x175df0['message']});}finally{_0x107064['close']();}});export default w;function _0x414bc3(_0x1520b8){const _0x27db90=_0x1c086e,_0x44b142={'Kxdpj':function(_0x509bc3,_0x352626){return _0x509bc3===_0x352626;},'JKnWe':_0x27db90(0x29d),'TkVzg':_0x27db90(0x103),'aKETS':_0x27db90(0x2b9),'zTvLj':function(_0x13884c,_0x4cd9ac){return _0x13884c!==_0x4cd9ac;},'ScYWg':function(_0x216394,_0x3d0fad){return _0x216394+_0x3d0fad;},'hJhVL':function(_0x1e7957,_0x1c6fcc){return _0x1e7957/_0x1c6fcc;},'VmOib':_0x27db90(0x170),'eGDGw':function(_0x153d2d,_0x249e0c){return _0x153d2d===_0x249e0c;},'wsNhZ':function(_0x5159ee,_0x18f5f9){return _0x5159ee%_0x18f5f9;},'JpPlW':_0x27db90(0x238),'VrWLT':_0x27db90(0x148),'wxDBa':_0x27db90(0x118),'qssxg':_0x27db90(0x192),'lTiwF':function(_0x2d3a4e,_0x83ad3b){return _0x2d3a4e(_0x83ad3b);}};function _0x241982(_0x34d9c8){const _0x1418b4=_0x27db90;if(_0x44b142['Kxdpj'](typeof _0x34d9c8,_0x44b142[_0x1418b4(0x163)]))return function(_0xba3cf2){}[_0x1418b4(0x1fc)](_0x44b142[_0x1418b4(0x1cd)])[_0x1418b4(0x21c)](_0x44b142[_0x1418b4(0x213)]);else _0x44b142[_0x1418b4(0x179)](_0x44b142[_0x1418b4(0x127)]('',_0x44b142[_0x1418b4(0x273)](_0x34d9c8,_0x34d9c8))[_0x44b142[_0x1418b4(0x15f)]],0x1)||_0x44b142[_0x1418b4(0x21a)](_0x44b142[_0x1418b4(0x108)](_0x34d9c8,0x14),0x0)?function(){return!![];}[_0x1418b4(0x1fc)](_0x44b142['ScYWg'](_0x44b142[_0x1418b4(0x210)],_0x44b142[_0x1418b4(0x208)]))[_0x1418b4(0x1af)](_0x44b142[_0x1418b4(0x280)]):function(){return![];}[_0x1418b4(0x1fc)](_0x44b142[_0x1418b4(0x127)](_0x44b142[_0x1418b4(0x210)],_0x44b142[_0x1418b4(0x208)]))[_0x1418b4(0x21c)](_0x44b142[_0x1418b4(0x2cd)]);_0x44b142[_0x1418b4(0x20f)](_0x241982,++_0x34d9c8);}try{if(_0x1520b8)return _0x241982;else _0x44b142[_0x27db90(0x20f)](_0x241982,0x0);}catch(_0xb37924){}}