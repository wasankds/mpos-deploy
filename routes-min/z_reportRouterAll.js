const _0x14b7c3=_0xbf36;function _0xbf36(_0x26597d,_0x1702b2){const _0x2e0f59=_0x2218();return _0xbf36=function(_0x4876c0,_0x1817b6){_0x4876c0=_0x4876c0-0x1b6;let _0x353a92=_0x2e0f59[_0x4876c0];return _0x353a92;},_0xbf36(_0x26597d,_0x1702b2);}(function(_0x50fa52,_0x284f8f){const _0xf1d5bd=_0xbf36,_0x1c4f63=_0x50fa52();while(!![]){try{const _0x38317d=-parseInt(_0xf1d5bd(0x2ee))/0x1*(-parseInt(_0xf1d5bd(0x1b7))/0x2)+-parseInt(_0xf1d5bd(0x2b4))/0x3+-parseInt(_0xf1d5bd(0x1c4))/0x4+parseInt(_0xf1d5bd(0x1e5))/0x5+-parseInt(_0xf1d5bd(0x241))/0x6+parseInt(_0xf1d5bd(0x1c0))/0x7+parseInt(_0xf1d5bd(0x218))/0x8*(parseInt(_0xf1d5bd(0x2d9))/0x9);if(_0x38317d===_0x284f8f)break;else _0x1c4f63['push'](_0x1c4f63['shift']());}catch(_0x252f87){_0x1c4f63['push'](_0x1c4f63['shift']());}}}(_0x2218,0xbb2da));const _0x30e1e1=(function(){const _0x14bead=_0xbf36,_0x199c08={'jdOMt':function(_0x37c345,_0x3ab955){return _0x37c345!==_0x3ab955;},'dtDvG':'jAwkd','FOCvv':_0x14bead(0x2a1),'epTjN':_0x14bead(0x2c6),'EVUlf':_0x14bead(0x21c),'TMWRt':function(_0x40e80d,_0x1dcd6f){return _0x40e80d(_0x1dcd6f);},'gXoWp':function(_0x44001a,_0x22e4f3){return _0x44001a+_0x22e4f3;},'YTlJu':_0x14bead(0x290),'Jzxjn':_0x14bead(0x256),'JFTlX':function(_0x37c898,_0x3f5edd){return _0x37c898===_0x3f5edd;},'rgOxt':_0x14bead(0x2f4),'yhnJO':'cIiUb'};let _0x19cfb2=!![];return function(_0x2a4ba1,_0xf7c439){const _0x3457ad=_0x14bead,_0x3a1ac5={'ilXhO':function(_0x62014d,_0x256a8b){const _0x39c967=_0xbf36;return _0x199c08[_0x39c967(0x221)](_0x62014d,_0x256a8b);},'OSSAN':function(_0x169a4e,_0x59b34b){const _0x3bbc34=_0xbf36;return _0x199c08[_0x3bbc34(0x234)](_0x169a4e,_0x59b34b);},'vTeCV':function(_0x325d44,_0x204e08){const _0x53283f=_0xbf36;return _0x199c08[_0x53283f(0x234)](_0x325d44,_0x204e08);},'fcCiY':_0x199c08[_0x3457ad(0x20d)],'sdVtp':_0x199c08[_0x3457ad(0x25f)]};if(_0x199c08[_0x3457ad(0x1f3)](_0x199c08[_0x3457ad(0x2b5)],_0x199c08[_0x3457ad(0x1ff)])){const _0x1ada2b=_0x102df0?function(){const _0xa358c4=_0x3457ad;if(_0x49e6fd){const _0x5a75d5=_0x24c1ac[_0xa358c4(0x1c2)](_0x21156b,arguments);return _0x2dbbfb=null,_0x5a75d5;}}:function(){};return _0x4aedaa=![],_0x1ada2b;}else{const _0x177b66=_0x19cfb2?function(){const _0x324b4f=_0x3457ad;if(_0x199c08[_0x324b4f(0x2b1)](_0x199c08[_0x324b4f(0x276)],_0x199c08[_0x324b4f(0x1d0)])){if(_0xf7c439){if(_0x199c08['jdOMt'](_0x199c08['epTjN'],_0x199c08[_0x324b4f(0x206)])){const _0x15bb16=_0xf7c439[_0x324b4f(0x1c2)](_0x2a4ba1,arguments);return _0xf7c439=null,_0x15bb16;}else _0x5b1677=_0x3a1ac5[_0x324b4f(0x227)](_0x2dbec6,_0x3a1ac5[_0x324b4f(0x229)](_0x3a1ac5[_0x324b4f(0x24c)](_0x3a1ac5[_0x324b4f(0x2cf)],_0x3a1ac5[_0x324b4f(0x2ad)]),');'))();}}else{if(_0x25ad78){const _0x33c64a=_0x421e82[_0x324b4f(0x1c2)](_0x4f62e1,arguments);return _0x57647e=null,_0x33c64a;}}}:function(){};return _0x19cfb2=![],_0x177b66;}};}());(function(){const _0x253dac=_0xbf36,_0x202b56={'sSxWr':function(_0x929dfd,_0x2b83d0){return _0x929dfd+_0x2b83d0;},'kiKxW':_0x253dac(0x2f7),'KOMEt':'gger','huUGz':_0x253dac(0x293),'cUDra':function(_0x23ad79,_0xc66b30){return _0x23ad79===_0xc66b30;},'Njici':_0x253dac(0x253),'UOIoF':'function\x20*\x5c(\x20*\x5c)','WUvPy':_0x253dac(0x26f),'ZkZMi':function(_0x2685c8,_0xc825b5){return _0x2685c8(_0xc825b5);},'Ejoyr':_0x253dac(0x1c7),'WVPOL':function(_0x8fe36,_0x3da6c6){return _0x8fe36+_0x3da6c6;},'bwdUX':_0x253dac(0x2c2),'MjfnR':function(_0xa9e12b,_0x1a370c){return _0xa9e12b+_0x1a370c;},'OgTTV':'input','vGqrt':function(_0x57a3ed,_0x3eeada){return _0x57a3ed!==_0x3eeada;},'JgLER':_0x253dac(0x1b6),'aIknO':_0x253dac(0x240),'llnyg':function(_0x54b5a8,_0x3a215b){return _0x54b5a8(_0x3a215b);},'OCsrZ':function(_0x3df7c6,_0x2a974b){return _0x3df7c6!==_0x2a974b;},'IRPwI':_0x253dac(0x24d),'NEdsV':function(_0x342d89){return _0x342d89();},'ZSTDp':function(_0xcdd51,_0x43a0a9,_0x220137){return _0xcdd51(_0x43a0a9,_0x220137);}};_0x202b56[_0x253dac(0x24b)](_0x30e1e1,this,function(){const _0x34c43f=_0x253dac,_0x54025b={'wbVmM':function(_0x55bc99,_0x1e7f49){const _0x4e824e=_0xbf36;return _0x202b56[_0x4e824e(0x1c6)](_0x55bc99,_0x1e7f49);},'jPhRD':_0x202b56[_0x34c43f(0x1bd)],'NprRK':_0x202b56['KOMEt'],'NRVPr':_0x202b56['huUGz']};if(_0x202b56[_0x34c43f(0x295)](_0x202b56['Njici'],_0x202b56[_0x34c43f(0x2fa)])){const _0x2c9c6d=new RegExp(_0x202b56[_0x34c43f(0x28c)]),_0x38339e=new RegExp(_0x202b56[_0x34c43f(0x2fc)],'i'),_0x2c6ea3=_0x202b56[_0x34c43f(0x275)](_0x115c72,_0x202b56[_0x34c43f(0x212)]);if(!_0x2c9c6d[_0x34c43f(0x205)](_0x202b56[_0x34c43f(0x28d)](_0x2c6ea3,_0x202b56[_0x34c43f(0x2cb)]))||!_0x38339e[_0x34c43f(0x205)](_0x202b56['MjfnR'](_0x2c6ea3,_0x202b56[_0x34c43f(0x2dc)])))_0x202b56[_0x34c43f(0x1f8)](_0x202b56['JgLER'],_0x202b56[_0x34c43f(0x21b)])?_0x202b56['llnyg'](_0x2c6ea3,'0'):function(){return![];}[_0x34c43f(0x231)](_0x54025b[_0x34c43f(0x252)](_0x54025b[_0x34c43f(0x2b3)],_0x54025b[_0x34c43f(0x225)]))['apply'](_0x54025b[_0x34c43f(0x2cd)]);else{if(_0x202b56[_0x34c43f(0x27a)](_0x202b56['IRPwI'],_0x202b56[_0x34c43f(0x270)])){const _0x3a3b4a=_0x57712e[_0x34c43f(0x27b)][_0x34c43f(0x2ef)](_0x586b1a=>_0x586b1a[_0x34c43f(0x271)]==_0x39c103);return _0xaf9cdc[_0x34c43f(0x27b)]=_0x3a3b4a,_0x596881;}else _0x202b56[_0x34c43f(0x29c)](_0x115c72);}}else _0x2121ec[_0x34c43f(0x251)](_0x5bb059),_0x3b5dad[_0x34c43f(0x2d8)](0x194)[_0x34c43f(0x1e4)](_0x598ba1);})();}());const _0x1817b6=(function(){const _0x185bdf=_0xbf36,_0x1732b1={'PtdPr':'function\x20*\x5c(\x20*\x5c)','CZFHD':_0x185bdf(0x26f),'ZszTg':function(_0x52432f,_0x4b4e6){return _0x52432f(_0x4b4e6);},'VonOy':'init','sEWjO':function(_0x34eba8,_0x335926){return _0x34eba8+_0x335926;},'yqOKO':_0x185bdf(0x2c2),'yjVSE':'input','LFaiH':function(_0x2d369c){return _0x2d369c();},'hEwJX':function(_0x48f7bc,_0xacad3c,_0x556f36){return _0x48f7bc(_0xacad3c,_0x556f36);},'PihVr':function(_0x5259f3,_0x6ed29e){return _0x5259f3===_0x6ed29e;},'MAkfm':_0x185bdf(0x259),'sfPnr':_0x185bdf(0x20a),'zNltx':_0x185bdf(0x1ea),'ApOng':_0x185bdf(0x220),'rvpUu':'red','fiDnc':function(_0x2474d6,_0xee147a){return _0x2474d6!==_0xee147a;},'DTShB':'upqgu'};let _0x45b172=!![];return function(_0x358de1,_0x1b963a){const _0x329c3e=_0x185bdf,_0x4a01c0={'rBsNS':_0x1732b1[_0x329c3e(0x1f4)]};if(_0x1732b1['fiDnc'](_0x1732b1['DTShB'],_0x1732b1['DTShB']))_0x24defd[_0x329c3e(0x251)](_0x182759),_0x2d0740[_0x329c3e(0x2ce)](_0x39fa93['stringify']({'isLoad':!0x1,'class':_0x4a01c0['rBsNS'],'msg':_0x1bbb84[_0x329c3e(0x2ae)]}));else{const _0x2636b4=_0x45b172?function(){const _0x5d74dd=_0x329c3e,_0x2ba798={'xjepX':_0x1732b1[_0x5d74dd(0x1cf)],'sgJLM':_0x1732b1['CZFHD'],'Zhjdo':function(_0x4bee78,_0x9a0488){const _0x3e4549=_0x5d74dd;return _0x1732b1[_0x3e4549(0x1de)](_0x4bee78,_0x9a0488);},'DyEdj':_0x1732b1[_0x5d74dd(0x262)],'Cbsgk':function(_0x5a2103,_0x193684){const _0x4b6c09=_0x5d74dd;return _0x1732b1[_0x4b6c09(0x28e)](_0x5a2103,_0x193684);},'BOuBj':_0x1732b1[_0x5d74dd(0x1f5)],'UAvyV':function(_0x4aa656,_0x187494){const _0x51ef5d=_0x5d74dd;return _0x1732b1[_0x51ef5d(0x28e)](_0x4aa656,_0x187494);},'aERgM':_0x1732b1['yjVSE'],'rYaxK':function(_0x1e1a81){return _0x1732b1['LFaiH'](_0x1e1a81);},'ZIUaj':function(_0x48332d,_0x2fcdfc,_0x44d360){return _0x1732b1['hEwJX'](_0x48332d,_0x2fcdfc,_0x44d360);}};if(_0x1732b1[_0x5d74dd(0x257)](_0x1732b1['MAkfm'],_0x1732b1[_0x5d74dd(0x21d)])){const _0x2b8df1={'YfpfI':_0x2ba798[_0x5d74dd(0x246)],'EYzqi':_0x2ba798[_0x5d74dd(0x2ba)],'YEwkY':function(_0x181ade,_0x217fba){const _0x372ff0=_0x5d74dd;return _0x2ba798[_0x372ff0(0x1c8)](_0x181ade,_0x217fba);},'xdcvr':_0x2ba798[_0x5d74dd(0x244)],'KaHen':function(_0x50ab1f,_0x51340e){const _0x5583c0=_0x5d74dd;return _0x2ba798[_0x5583c0(0x2c3)](_0x50ab1f,_0x51340e);},'BNcHx':_0x2ba798['BOuBj'],'zZUHB':function(_0x4819dc,_0x50faac){const _0x1f9f7a=_0x5d74dd;return _0x2ba798[_0x1f9f7a(0x27c)](_0x4819dc,_0x50faac);},'xoSBO':_0x2ba798[_0x5d74dd(0x288)],'vwiSX':function(_0x280996,_0xd6ea6e){return _0x2ba798['Zhjdo'](_0x280996,_0xd6ea6e);},'vLoin':function(_0x5694f8){return _0x2ba798['rYaxK'](_0x5694f8);}};_0x2ba798[_0x5d74dd(0x291)](_0x49ccb3,this,function(){const _0x23b319=_0x5d74dd,_0x30bca6=new _0x587eb9(_0x2b8df1['YfpfI']),_0x3abe06=new _0x57b915(_0x2b8df1[_0x23b319(0x250)],'i'),_0x38fee6=_0x2b8df1[_0x23b319(0x2aa)](_0x4a4110,_0x2b8df1[_0x23b319(0x27f)]);!_0x30bca6['test'](_0x2b8df1['KaHen'](_0x38fee6,_0x2b8df1[_0x23b319(0x2d4)]))||!_0x3abe06[_0x23b319(0x205)](_0x2b8df1[_0x23b319(0x21e)](_0x38fee6,_0x2b8df1[_0x23b319(0x2db)]))?_0x2b8df1[_0x23b319(0x210)](_0x38fee6,'0'):_0x2b8df1['vLoin'](_0x5057e1);})();}else{if(_0x1b963a){if(_0x1732b1['PihVr'](_0x1732b1['zNltx'],_0x1732b1['ApOng']))_0x2ba798['rYaxK'](_0x4c61ca);else{const _0x85de00=_0x1b963a[_0x5d74dd(0x1c2)](_0x358de1,arguments);return _0x1b963a=null,_0x85de00;}}}}:function(){};return _0x45b172=![],_0x2636b4;}};}()),_0x4876c0=_0x1817b6(this,function(){const _0x5caea3=_0xbf36,_0x3a3884={'ehiax':function(_0x517a61,_0x32088b){return _0x517a61>_0x32088b;},'ViDyz':function(_0x34c9e1,_0x4796d1){return _0x34c9e1>_0x4796d1;},'VPqTs':function(_0x44540a,_0x16004e){return _0x44540a(_0x16004e);},'ulnyR':function(_0x1e6f78,_0x207534){return _0x1e6f78+_0x207534;},'qFmZG':'return\x20(function()\x20','mWNuw':_0x5caea3(0x256),'XjXUP':function(_0x41f841,_0x3a82d9){return _0x41f841!==_0x3a82d9;},'TZfVG':_0x5caea3(0x1ca),'CbLBh':'YXOhX','OAUcR':function(_0x273a15,_0x14d67d){return _0x273a15!==_0x14d67d;},'uPuzk':_0x5caea3(0x1ef),'OfzXH':function(_0x16d7fa,_0x4674a5){return _0x16d7fa(_0x4674a5);},'oqwHV':function(_0x358052,_0xc27814){return _0x358052+_0xc27814;},'SdPvB':function(_0x35f69b,_0x1a8017){return _0x35f69b===_0x1a8017;},'ABCFi':_0x5caea3(0x2c5),'WccSv':_0x5caea3(0x2fb),'OirmW':function(_0x27b003){return _0x27b003();},'GgDjn':_0x5caea3(0x251),'OwIVo':'warn','dmRzs':_0x5caea3(0x1ce),'NfuKX':'error','ZuEDH':_0x5caea3(0x26a),'IHNdZ':'table','nYNgI':_0x5caea3(0x2e2),'vYRBz':function(_0x4eb80a,_0x5f287b){return _0x4eb80a<_0x5f287b;},'lVPVR':function(_0x493c14,_0x30f3db){return _0x493c14===_0x30f3db;},'oUzIt':_0x5caea3(0x2e5),'tUWNb':'TecJQ'},_0x4131db=function(){const _0x541f0a=_0x5caea3,_0x57a995={'WGukB':function(_0xf59ff0,_0x192b05){const _0x5b8d57=_0xbf36;return _0x3a3884[_0x5b8d57(0x21f)](_0xf59ff0,_0x192b05);},'TVwWy':function(_0x9f0b2,_0x59f114){const _0xf22f10=_0xbf36;return _0x3a3884[_0xf22f10(0x2c7)](_0x9f0b2,_0x59f114);},'DYtJe':_0x3a3884[_0x541f0a(0x2b8)],'AzzEk':_0x3a3884[_0x541f0a(0x242)]};if(_0x3a3884['XjXUP'](_0x3a3884[_0x541f0a(0x208)],_0x3a3884[_0x541f0a(0x228)])){let _0x235c2a;try{if(_0x3a3884[_0x541f0a(0x264)](_0x3a3884[_0x541f0a(0x1fd)],_0x3a3884[_0x541f0a(0x1fd)])){const _0x4a3674=_0x2116c7['apply'](_0x23cae1,arguments);return _0x752dfb=null,_0x4a3674;}else _0x235c2a=_0x3a3884['OfzXH'](Function,_0x3a3884[_0x541f0a(0x2c7)](_0x3a3884[_0x541f0a(0x1fe)](_0x3a3884['qFmZG'],_0x3a3884[_0x541f0a(0x242)]),');'))();}catch(_0xa5f163){if(_0x3a3884['SdPvB'](_0x3a3884[_0x541f0a(0x200)],_0x3a3884[_0x541f0a(0x1b8)])){let _0x169f32;try{_0x169f32=_0x57a995[_0x541f0a(0x209)](_0xd917ea,_0x57a995[_0x541f0a(0x2ab)](_0x57a995[_0x541f0a(0x2ab)](_0x57a995['DYtJe'],_0x57a995['AzzEk']),');'))();}catch(_0x17330e){_0x169f32=_0x4c9121;}return _0x169f32;}else _0x235c2a=window;}return _0x235c2a;}else{const _0x2c742b={'sFJpu':function(_0x36164f,_0x1280bf){return _0x3a3884['ehiax'](_0x36164f,_0x1280bf);}},_0x636b62=_0x24f398[_0x541f0a(0x265)];return _0x636b62&&_0x3a3884[_0x541f0a(0x1c5)](_0x636b62[_0x541f0a(0x201)],0x0)&&_0x636b62[_0x541f0a(0x2a2)](_0x3b639c=>{const _0x5cb041=_0x541f0a,_0x554b0d=_0x3b639c[_0x5cb041(0x1c3)],_0x148990=_0x44f998[_0x5cb041(0x2ef)](_0x455d86=>_0x455d86['docId']==_0x554b0d);_0x2c742b[_0x5cb041(0x29f)](_0x148990[_0x5cb041(0x201)],0x0)?_0x3b639c[_0x5cb041(0x27b)]=_0x148990[0x0][_0x5cb041(0x27b)]['filter'](_0x5c34f9=>_0x5c34f9[_0x5cb041(0x271)]==_0x57b5e7[_0x5cb041(0x271)]):_0x3b639c[_0x5cb041(0x27b)]=[];}),_0x35a2c2;}},_0x27e171=_0x3a3884['OirmW'](_0x4131db),_0x1c3db1=_0x27e171[_0x5caea3(0x2ac)]=_0x27e171['console']||{},_0x282a1c=[_0x3a3884[_0x5caea3(0x1f2)],_0x3a3884['OwIVo'],_0x3a3884[_0x5caea3(0x283)],_0x3a3884[_0x5caea3(0x1fa)],_0x3a3884[_0x5caea3(0x28f)],_0x3a3884[_0x5caea3(0x1c9)],_0x3a3884[_0x5caea3(0x2c1)]];for(let _0x58a842=0x0;_0x3a3884[_0x5caea3(0x2a7)](_0x58a842,_0x282a1c['length']);_0x58a842++){if(_0x3a3884[_0x5caea3(0x20f)](_0x3a3884[_0x5caea3(0x203)],_0x3a3884[_0x5caea3(0x2ed)])){if(_0x5dfec8){const _0xa23cb2=_0x1f89f7[_0x5caea3(0x1c2)](_0x41e4f1,arguments);return _0x2181a6=null,_0xa23cb2;}}else{const _0x1fdb3b=_0x1817b6[_0x5caea3(0x231)][_0x5caea3(0x1dd)][_0x5caea3(0x263)](_0x1817b6),_0x647dcc=_0x282a1c[_0x58a842],_0x225eff=_0x1c3db1[_0x647dcc]||_0x1fdb3b;_0x1fdb3b['__proto__']=_0x1817b6[_0x5caea3(0x263)](_0x1817b6),_0x1fdb3b[_0x5caea3(0x1e1)]=_0x225eff[_0x5caea3(0x1e1)][_0x5caea3(0x263)](_0x225eff),_0x1c3db1[_0x647dcc]=_0x1fdb3b;}}});_0x4876c0();import _0x2252fe from'express';const S=_0x2252fe['Router']();import{MongoClient as _0x1a76ff}from'mongodb';function _0x2218(){const _0x17cec6=['JSome','sfPnr','zZUHB','VPqTs','CDett','TMWRt','originalUrl','KjByn','JAifB','NprRK','DAaDc','ilXhO','CbLBh','OSSAN','uAjHg','split','lWFrJ',',\x20(','map','/report/bill','/report','constructor','dbName','aggregate','gXoWp','mTsgz','cfkuR','fYtpw','xUuUc','JeVcG','oYkMD','BReMh','PErFm','dbUrl','$docDate','quotation','DIJAH','7500348zqKEIo','mWNuw','LkKYI','DyEdj','itemsReport','xjepX','body','XSvZO','tcaYg','close','ZSTDp','vTeCV','wokRB','userFlash','call','EYzqi','log','wbVmM','OpmDw','unshift','OmrVo','{}.constructor(\x22return\x20this\x22)(\x20)','PihVr','xzqXh','XPoFV','dbColl_bill','SBYaB','invoice','fc-dodgerblue','utf8','Jzxjn','-----------------','NSQXa','VonOy','bind','OAUcR','docs','AYNht','PrKno','$docId','zgkzj','exception','/report/receipt','NwCrR','dbColl_invoice','Bqfnq','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','IRPwI','itemId','reportItems.ejs','tTpXB','VhcqO','ZkZMi','dtDvG','kQmSX','function\x20*\x5c(\x20*\x5c)','vrzDU','OCsrZ','tableRows','UAvyV','getCollName_by_DocTitle','OLPyE','xdcvr','counter','wxPSC','$proposerFullname','dmRzs','WTebW','izXyg','XjjTf','string','aERgM','TweiB','uMVja','getDocs_Conclude','UOIoF','WVPOL','sEWjO','ZuEDH','return\x20(function()\x20','ZIUaj','iRadm','stateObject','PAGE_REPORT_QUOTATION','cUDra','green','GTFrJ','VLRUK','KsUSw','render','LpIKT','NEdsV','dYgvg','dzYRz','sFJpu','/report/invoice','BMJVL','forEach','reportDoc.ejs','aQBLE','ZjSVL','get','vYRBz','MNMRf','vfwtz','YEwkY','TVwWy','console','sdVtp','message','qdLNh','giIHj','jdOMt','getDocs_MonthUnique','jPhRD','3870534YXylUq','rgOxt','YAWHs','amgUh','qFmZG','rnYLe','sgJLM','formatDate','readFileSync','Fwjyi','NOnqy','PAGE_REPORT_RECEIPT','getSessionData','nYNgI','chain','Cbsgk','vrAGo','raVJv','bQCAk','ulnyR','cNCEV','dbColl_receipt','rnaij','bwdUX','lDoFl','NRVPr','send','fcCiY','$docStatusNumber','reportAll.ejs','receipt','VyAkZ','BNcHx','join','pXkpi','ZbwSP','status','9ngtvEA','rMzvY','xoSBO','OgTTV','kPzSr','action','while\x20(true)\x20{}','connect','collName\x20===>\x20','trace','LevRu','bIfif','LrdNV','toArray','kHCko','msg','$tableRows.itemId','jvewx','input','YabVf','tUWNb','523oEuyZU','filter','YLCzz','red','MONTH_NAMES','------------------','biDNe','sort','stringify','debu','post','tQmIa','Njici','JqSXU','WUvPy','WfNFm','KEITK','HDAzJ','3840fbuHer','WccSv','ZWVOu','fykWZ','XRbdx','fc-red','kiKxW','toMgH','req.body\x20===>\x20','8429414BSQppq','GZyNZ','apply','docId','2137836nZSIKM','ViDyz','sSxWr','init','Zhjdo','IHNdZ','YNZOH','MJlSC','xxzCu','$customerName','info','PtdPr','FOCvv','สร้าง','ynUQw','LdqVX','PBfEC','FulWD','diiNe','XMXdC','flash','jkfbt','ypHap','JXUuO','/report/quotation','prototype','ZszTg','zmRVN','Acbke','toString','OKNfw','WboFj','sendFile','2395240JgTnuB','getSettings','SDivm','zckId','PAGE_REPORT_INVOICE','gAGYL','qNlOF','vgoZQ','ClWMm','$_id','HWBol','HDnWx','LMRmD','GgDjn','JFTlX','rvpUu','yqOKO','Unknown','bSXOv','vGqrt','EluUE','NfuKX','docsReport','cvVtc','uPuzk','oqwHV','yhnJO','ABCFi','length','Jxhty','oUzIt','uEWeL','test','EVUlf','gqigc','TZfVG','WGukB','pAaqI','$customerId','BRsSc','YTlJu','zRBiV','lVPVR','vwiSX','AMNUl','Ejoyr','getUsers_for_report','isAuth','collection','GrHjf','bill','9231736KShbHm','\x20(\x20จำนวน=','/calendar','aIknO'];_0x2218=function(){return _0x17cec6;};return _0x2218();}import _0x47c58c from'ejs';import _0x3cf52c from'path';import _0x2bd5dd from'fs';import*as _0x13910f from'../mymodule/myDateTime.js';import*as _0x1b5d59 from'../mymodule/myUsers.js';import*as _0x1175f1 from'../mymodule/myModule.js';import*as _0x530287 from'../mymodule/myDocs.js';import _0x592fa3 from'../middleware/mainAuth.js';const O=_0x14b7c3(0x1dc),M=_0x14b7c3(0x2a0),U=_0x14b7c3(0x26b),F=_0x14b7c3(0x22f),K=[O,M,U,F],W=[M+_0x14b7c3(0x21a),O+_0x14b7c3(0x21a),U+_0x14b7c3(0x21a),F+_0x14b7c3(0x21a)],X=[M+_0x14b7c3(0x230),O+_0x14b7c3(0x230),U+_0x14b7c3(0x230),F+'/report'],J={'docStatus':{'$switch':{'branches':[{'case':{'$eq':[_0x14b7c3(0x2d0),0x1]},'then':_0x14b7c3(0x1d1)},{'case':{'$eq':[_0x14b7c3(0x2d0),0x2]},'then':'จบ'},{'case':{'$eq':['$docStatusNumber',0xa]},'then':'ยกเลิก'}],'default':_0x14b7c3(0x1f6)}},'docStatusColor':{'$switch':{'branches':[{'case':{'$eq':[_0x14b7c3(0x2d0),0x1]},'then':_0x14b7c3(0x25d)},{'case':{'$eq':[_0x14b7c3(0x2d0),0x2]},'then':'fc-green'},{'case':{'$eq':[_0x14b7c3(0x2d0),0xa]},'then':'fc-orange'}],'default':_0x14b7c3(0x1bc)}}};S[_0x14b7c3(0x2a6)](K,_0x592fa3[_0x14b7c3(0x214)],async(_0x4adc8d,_0x5c5154)=>{const _0x4b3c36=_0x14b7c3,_0x546fa7={'ynUQw':function(_0xd505d3,_0x4bfa21){return _0xd505d3(_0x4bfa21);},'LevRu':function(_0x17c797,_0x19fbef){return _0x17c797(_0x19fbef);},'jkfbt':function(_0xe1a1d,_0x5298fb){return _0xe1a1d===_0x5298fb;},'Xeffw':_0x4b3c36(0x23f),'WfNFm':function(_0x204fc1,_0x53b6c0){return _0x204fc1===_0x53b6c0;},'SDivm':_0x4b3c36(0x25c),'AYNht':_0x4b3c36(0x2d2),'zmRVN':function(_0xbf4b47,_0x3b0774){return _0xbf4b47===_0x3b0774;},'HDnWx':_0x4b3c36(0x217),'DAaDc':_0x4b3c36(0x2d1),'PBfEC':function(_0x43f6ac,_0x2d2f6f){return _0x43f6ac!==_0x2d2f6f;},'ZUKdT':_0x4b3c36(0x22c),'JeVcG':_0x4b3c36(0x1e2),'YfUlO':_0x4b3c36(0x2e8),'izXyg':_0x4b3c36(0x24e),'YabVf':function(_0x373074,_0x2bd72e){return _0x373074!==_0x2bd72e;},'FulWD':_0x4b3c36(0x2a8)},_0x21d0fa=_0x4adc8d['originalUrl'],_0x4c5f2c=_0x21d0fa+'/report',_0x24a1b6=_0x21d0fa+_0x4b3c36(0x21a),_0x2ed361=_0x21d0fa[_0x4b3c36(0x22b)]('/')[0x2];if(_0x546fa7['jkfbt'](_0x2ed361,_0x546fa7['Xeffw']))var _0x26d908=global[_0x4b3c36(0x294)],_0x2cbb46=global['dbColl_quotation'];else{if(_0x546fa7[_0x4b3c36(0x2fd)](_0x2ed361,_0x546fa7[_0x4b3c36(0x1e7)]))var _0x26d908=global[_0x4b3c36(0x1e9)],_0x2cbb46=global[_0x4b3c36(0x26d)];else{if(_0x546fa7[_0x4b3c36(0x1d9)](_0x2ed361,_0x546fa7[_0x4b3c36(0x266)]))var _0x26d908=global[_0x4b3c36(0x2bf)],_0x2cbb46=global[_0x4b3c36(0x2c9)];else{if(_0x546fa7[_0x4b3c36(0x1df)](_0x2ed361,_0x546fa7[_0x4b3c36(0x1f0)]))var _0x26d908=global['PAGE_REPORT_BILL'],_0x2cbb46=global[_0x4b3c36(0x25a)];}}}var _0x4795aa=_0x546fa7[_0x4b3c36(0x226)];try{if(_0x546fa7[_0x4b3c36(0x1d4)](_0x546fa7['ZUKdT'],_0x546fa7[_0x4b3c36(0x239)])){const _0x15c301=await _0x530287[_0x4b3c36(0x213)](),_0x2bdd19=await _0x530287['getItems_for_report'](),_0x4e06d5=await _0x530287[_0x4b3c36(0x2b2)](_0x2cbb46),_0x40516a=await _0x530287[_0x4b3c36(0x28b)](_0x2cbb46),_0x3f2746=await _0x1175f1['renderView'](_0x4795aa,_0x5c5154,{'title':_0x26d908,'time':_0x13910f[_0x4b3c36(0x2bb)](new Date()),'msg':_0x4adc8d[_0x4b3c36(0x1d8)](_0x546fa7['YfUlO']),'userFlash':_0x4adc8d[_0x4b3c36(0x1d8)](_0x546fa7[_0x4b3c36(0x285)]),..._0x1b5d59[_0x4b3c36(0x2c0)](_0x4adc8d),...await _0x1175f1[_0x4b3c36(0x1e6)](),'PATH_MAIN':_0x21d0fa,'PATH_REPORT':_0x4c5f2c,'PATH_CALENDAR':_0x24a1b6,'dataUsersJson':JSON[_0x4b3c36(0x2f6)](_0x15c301),'dataItemsJson':JSON['stringify'](_0x2bdd19),'monthDocs':_0x4e06d5,'dataDocConclude':JSON[_0x4b3c36(0x2f6)](_0x40516a)});_0x5c5154[_0x4b3c36(0x2ce)](_0x3f2746);}else yrZSLY[_0x4b3c36(0x1d2)](_0x147702,0x0);}catch(_0x3a23dd){_0x546fa7[_0x4b3c36(0x2ec)](_0x546fa7[_0x4b3c36(0x1d5)],_0x546fa7['FulWD'])?yrZSLY[_0x4b3c36(0x2e3)](_0x21bc9a,'0'):(console[_0x4b3c36(0x251)](_0x3a23dd),_0x5c5154[_0x4b3c36(0x2d8)](0x194)[_0x4b3c36(0x1e4)](file404));}}),S[_0x14b7c3(0x2f8)](W,_0x592fa3['isAuth'],async(_0x35c4e3,_0x1f77b9)=>{const _0xfd43c8=_0x14b7c3,_0x5625fb={'NSQXa':function(_0x33dfa5,_0x3f66f5){return _0x33dfa5>_0x3f66f5;},'iRadm':function(_0x568f1a,_0x5cceca){return _0x568f1a-_0x5cceca;},'xzqXh':function(_0x599c60,_0x149656){return _0x599c60(_0x149656);},'ZWVOu':'red','BReMh':'ไม่พบชื่อคอเล็กชั่น','VyAkZ':_0xfd43c8(0x2e1),'JXUuO':function(_0x597aa7,_0x450406){return _0x597aa7!==_0x450406;},'kPzSr':_0xfd43c8(0x1e0),'JlapU':_0xfd43c8(0x296),'xUuUc':'โหลดข้อมูลเรียบร้อยแล้ว','MVNDZ':function(_0x4e8d92,_0x406952){return _0x4e8d92===_0x406952;},'oYkMD':_0xfd43c8(0x284),'OLPyE':_0xfd43c8(0x235),'qNlOF':_0xfd43c8(0x249),'WiKKJ':_0xfd43c8(0x2c4)},{selectMonth:_0x56ba49,userId:_0x51a933,searchUser:_0x55a3aa,itemId:_0x1d5afe,searchItem:_0x1707a6,docId:_0x4ad5a6,docTitle:_0x3a83ae}=_0x35c4e3[_0xfd43c8(0x247)],[_0x1d7e31,_0x11d321]=_0x56ba49[_0xfd43c8(0x22b)]('-'),_0xa3e340=global[_0xfd43c8(0x2f2)][_0x5625fb[_0xfd43c8(0x292)](_0x5625fb[_0xfd43c8(0x258)](parseInt,_0x11d321),0x1)]+'\x20'+_0x1d7e31,_0x51c81d=_0x530287[_0xfd43c8(0x27d)](_0x3a83ae);if(!_0x51c81d)return _0x1f77b9[_0xfd43c8(0x2ce)](JSON[_0xfd43c8(0x2f6)]({'isStatus':!0x1,'class':_0x5625fb[_0xfd43c8(0x1b9)],'msg':_0x5625fb[_0xfd43c8(0x23b)]}));console['log'](_0x5625fb[_0xfd43c8(0x2d3)],_0x51c81d);let _0x94662f=''+_0xa3e340;_0x51a933&&(_0x94662f+=_0xfd43c8(0x22d)+_0x51a933+')\x20'+_0x55a3aa),_0x1d5afe&&(_0x94662f+=_0xfd43c8(0x22d)+_0x1d5afe+')\x20'+_0x1707a6),_0x4ad5a6&&(_0x94662f+=',\x20'+_0x4ad5a6);const _0x109896=new _0x1a76ff(global[_0xfd43c8(0x23d)]);try{if(_0x5625fb['JXUuO'](_0x5625fb[_0xfd43c8(0x2dd)],_0x5625fb['kPzSr'])){const _0x393bd7=_0x377ce8['docId'],_0x579dd9=_0x2d7c26[_0xfd43c8(0x2ef)](_0x567ec8=>_0x567ec8[_0xfd43c8(0x1c3)]==_0x393bd7);_0x5625fb[_0xfd43c8(0x261)](_0x579dd9[_0xfd43c8(0x201)],0x0)?_0x3d9e40[_0xfd43c8(0x27b)]=_0x579dd9[0x0][_0xfd43c8(0x27b)]['filter'](_0x871ca2=>_0x871ca2[_0xfd43c8(0x271)]==_0x27c381['itemId']):_0x32d906[_0xfd43c8(0x27b)]=[];}else{await _0x109896[_0xfd43c8(0x2e0)]();const _0x2fccb0=_0x109896['db'](global[_0xfd43c8(0x232)])[_0xfd43c8(0x215)](_0x51c81d),_0x12e904=[{'$match':{'docDate':{'$regex':'^'+_0x56ba49}}},{'$project':{'_id':0x0,'docId':0x1,'docDate':0x1,'docStatusNumber':0x1,'customerId':0x1,'customerName':0x1,'netAmount':0x1,'proposerId':0x1,'proposerFullname':0x1,...J}}];_0x51a933&&_0x12e904[_0xfd43c8(0x254)]({'$match':{'borrowerId':_0x51a933}}),_0x1d5afe&&_0x12e904[_0xfd43c8(0x254)]({'$match':{'tableRows.itemId':_0x1d5afe}}),_0x4ad5a6&&_0x12e904['unshift']({'$match':{'docId':_0x4ad5a6}});const _0x2cfcfc=await _0x2fccb0[_0xfd43c8(0x233)](_0x12e904)[_0xfd43c8(0x2e6)]();_0x94662f+=_0xfd43c8(0x219)+_0x2cfcfc[_0xfd43c8(0x201)]+'\x20)',_0x1f77b9[_0xfd43c8(0x2ce)](JSON[_0xfd43c8(0x2f6)]({'isLoad':!0x0,'class':_0x5625fb['JlapU'],'title':_0x94662f,'dataDocs':_0x2cfcfc,'selectMonth':_0x56ba49,'msg':_0x5625fb[_0xfd43c8(0x238)]}));}}catch(_0x1940b2){_0x5625fb['MVNDZ'](_0x5625fb[_0xfd43c8(0x23a)],_0x5625fb[_0xfd43c8(0x27e)])?_0x528854[_0xfd43c8(0x24a)]():(console[_0xfd43c8(0x251)](_0x1940b2['message']),_0x1f77b9['send'](JSON[_0xfd43c8(0x2f6)]({'isLoad':!0x1,'class':_0x5625fb['ZWVOu'],'title':_0x94662f,'selectMonth':_0x56ba49,'msg':_0x1940b2[_0xfd43c8(0x2ae)]})));}finally{if(_0x5625fb[_0xfd43c8(0x1db)](_0x5625fb[_0xfd43c8(0x1eb)],_0x5625fb['WiKKJ']))_0x109896[_0xfd43c8(0x24a)]();else return _0x41e78a;}}),S[_0x14b7c3(0x2f8)](X,_0x592fa3['isAuth'],async(_0x11890d,_0x21f3b3)=>{const _0x36e6ae=_0x14b7c3,_0x4d78f6={'SqlKA':_0x36e6ae(0x2df),'GTFrJ':'counter','cvVtc':_0x36e6ae(0x2f1),'XjjTf':function(_0x222e9c,_0x553983){return _0x222e9c!==_0x553983;},'jvewx':'MZuHR','PiIuq':function(_0x3d4663,_0x5eccbc){return _0x3d4663===_0x5eccbc;},'NwCrR':'frRiZ','tQmIa':_0x36e6ae(0x29b),'diiNe':function(_0xb21d4,_0x3af20e){return _0xb21d4>_0x3af20e;},'ypHap':function(_0x444b34,_0x3d771d){return _0x444b34(_0x3d771d);},'WboFj':function(_0x363d51,_0x4a22bd){return _0x363d51!==_0x4a22bd;},'dzYRz':'TzxXh','zRBiV':_0x36e6ae(0x2e4),'RdADt':function(_0x9df919,_0x162cdd){return _0x9df919+_0x162cdd;},'GZyNZ':_0x36e6ae(0x2f7),'xxzCu':'gger','kHCko':'action','HYOcZ':_0x36e6ae(0x1bf),'giIHj':'ไม่พบชื่อคอเล็กชั่น','amgUh':function(_0x42b705,_0x3de6ff){return _0x42b705-_0x3de6ff;},'Jxhty':'EhpZR','LkKYI':function(_0x55e735,_0x367084){return _0x55e735==_0x367084;},'PErFm':_0x36e6ae(0x1fb),'GrHjf':_0x36e6ae(0x224),'wxPSC':_0x36e6ae(0x2a3),'VhcqO':_0x36e6ae(0x25e),'rnaij':function(_0x120ac4,_0x5a1c96){return _0x120ac4==_0x5a1c96;},'LMRmD':_0x36e6ae(0x245),'vrzDU':'NwANO','XRbdx':'$tableRows','rnYLe':_0x36e6ae(0x2e9),'SBYaB':_0x36e6ae(0x1ee),'vfwtz':_0x36e6ae(0x268),'gildS':_0x36e6ae(0x23e),'KEITK':_0x36e6ae(0x20b),'tBRza':_0x36e6ae(0x1cd),'ViBTH':'$proposerId','gqigc':_0x36e6ae(0x282),'VLRUK':_0x36e6ae(0x2d0),'ClWMm':_0x36e6ae(0x272),'JPHjP':_0x36e6ae(0x296),'lDoFl':'FBUDI','NWOBH':function(_0x1fc67e,_0x438d44){return _0x1fc67e!==_0x438d44;},'LNlTo':_0x36e6ae(0x236),'PGabH':_0x36e6ae(0x20c)};console[_0x36e6ae(0x251)](_0x36e6ae(0x260)+_0x11890d[_0x36e6ae(0x222)]+_0x36e6ae(0x2f3)),console[_0x36e6ae(0x251)](_0x4d78f6['HYOcZ'],_0x11890d[_0x36e6ae(0x247)]);let {selectMonth:_0x433b04,reportType:_0x49beb3,itemId:_0x44b19f,searchItem:_0x1fad1e,userId:_0x4ff9c3,searchUser:_0x1f2a4e,docId:_0xb8b960,docTitle:_0x5a2fae}=_0x11890d[_0x36e6ae(0x247)];_0x4ff9c3=_0x4ff9c3&&_0x4d78f6[_0x36e6ae(0x1da)](Number,_0x4ff9c3);const _0x1c9b7d=_0x530287['getCollName_by_DocTitle'](_0x5a2fae);if(!_0x1c9b7d)return _0x21f3b3[_0x36e6ae(0x2ce)](JSON[_0x36e6ae(0x2f6)]({'isStatus':!0x1,'class':_0x4d78f6['cvVtc'],'msg':_0x4d78f6[_0x36e6ae(0x2b0)]}));const [_0x46d22f,_0xa4459e]=_0x433b04['split']('-');let _0x30f5e3=''+(global['MONTH_NAMES'][_0x4d78f6[_0x36e6ae(0x2b7)](_0x4d78f6[_0x36e6ae(0x1da)](parseInt,_0xa4459e),0x1)]+'\x20'+_0x46d22f);_0x4ff9c3&&(_0x30f5e3+=_0x36e6ae(0x22d)+_0x4ff9c3+')\x20'+_0x1f2a4e),_0x44b19f&&(_0x30f5e3+=_0x36e6ae(0x22d)+_0x44b19f+')\x20'+_0x1fad1e),_0xb8b960&&(_0x30f5e3+=',\x20'+_0xb8b960);const _0x3b6c6c=new _0x1a76ff(global[_0x36e6ae(0x23d)]);try{if(_0x4d78f6[_0x36e6ae(0x286)](_0x4d78f6[_0x36e6ae(0x202)],_0x4d78f6[_0x36e6ae(0x202)]))return![];else{await _0x3b6c6c[_0x36e6ae(0x2e0)]();const _0x1a0acf=_0x3b6c6c['db'](global[_0x36e6ae(0x232)])[_0x36e6ae(0x215)](_0x1c9b7d);if(_0x4d78f6[_0x36e6ae(0x243)](_0x49beb3,_0x4d78f6[_0x36e6ae(0x23c)])){if(_0x4d78f6['XjjTf'](_0x4d78f6[_0x36e6ae(0x216)],_0x4d78f6[_0x36e6ae(0x216)]))return function(_0x430c29){}[_0x36e6ae(0x231)](SfRfPy['SqlKA'])['apply'](SfRfPy[_0x36e6ae(0x297)]);else{const _0xc9ff91=[{'$match':{'docDate':{'$regex':'^'+_0x433b04}}},{'$project':{'_id':0x0,'docId':0x1,'docDate':0x1,'docStatusNumber':0x1,'customerId':0x1,'customerName':0x1,'totalAmount':0x1,'vatAmount':0x1,'netAmount':0x1,'proposerId':0x1,'proposerFullname':0x1,...J}}];_0x4ff9c3&&_0xc9ff91['unshift']({'$match':{'proposerId':_0x4ff9c3}}),_0x44b19f&&_0xc9ff91[_0x36e6ae(0x254)]({'$match':{'tableRows.itemId':_0x44b19f}}),_0xb8b960&&_0xc9ff91['unshift']({'$match':{'docId':_0xb8b960}});const _0x58864e=await _0x1a0acf[_0x36e6ae(0x233)](_0xc9ff91)[_0x36e6ae(0x2e6)](),_0x1278a3=_0x3cf52c[_0x36e6ae(0x2d5)](folderForm,_0x4d78f6[_0x36e6ae(0x281)]),_0x369994=_0x2bd5dd[_0x36e6ae(0x2bc)](_0x1278a3,_0x4d78f6[_0x36e6ae(0x274)]);var _0x3790d5=_0x47c58c[_0x36e6ae(0x29a)](_0x369994,{'title':_0x30f5e3,'data':_0x58864e});}}else{if(_0x4d78f6[_0x36e6ae(0x2ca)](_0x49beb3,_0x4d78f6[_0x36e6ae(0x1f1)])){if(_0x4d78f6['WboFj'](_0x4d78f6[_0x36e6ae(0x279)],_0x4d78f6[_0x36e6ae(0x279)]))_0x4a9dc8['log'](_0x38c4b2['message']),_0x43dfed[_0x36e6ae(0x2ce)](_0x4b5c19[_0x36e6ae(0x2f6)]({'isLoad':!0x1,'class':_0x4d78f6[_0x36e6ae(0x1fc)],'title':_0x58b575,'selectMonth':_0x564838,'msg':_0x7ece21[_0x36e6ae(0x2ae)]}));else{const _0x31fbca=[{'$match':{'docDate':{'$regex':'^'+_0x433b04}}},{'$unwind':_0x4d78f6['XRbdx']},{'$group':{'_id':_0x4d78f6['rnYLe']}},{'$project':{'_id':0x0,'itemId':_0x4d78f6['SBYaB']}},{'$sort':{'itemId':0x1}}];_0x4ff9c3&&_0x31fbca[_0x36e6ae(0x254)]({'$match':{'proposerId':_0x4ff9c3}}),_0x44b19f&&_0x31fbca[_0x36e6ae(0x254)]({'$match':{'tableRows.itemId':_0x44b19f}}),_0xb8b960&&_0x31fbca[_0x36e6ae(0x254)]({'$match':{'docId':_0xb8b960}});const _0x131a31=await _0x1a0acf['aggregate'](_0x31fbca)[_0x36e6ae(0x2e6)]();let _0x3aa2b9=_0x44b19f?[_0x44b19f]:_0x131a31['map'](_0x34ea29=>_0x34ea29[_0x36e6ae(0x271)]);_0x3aa2b9=_0x3aa2b9['filter'](_0x1692a2=>_0x1692a2!='');const _0x24f567=[{'$match':{'docDate':{'$regex':'^'+_0x433b04}}},{'$match':{'tableRows.itemId':{'$in':_0x3aa2b9}}},{'$unwind':_0x4d78f6[_0x36e6ae(0x1bb)]},{'$group':{'_id':_0x4d78f6[_0x36e6ae(0x2b9)],'docs':{'$addToSet':{'docId':_0x4d78f6[_0x36e6ae(0x2a9)],'docDate':_0x4d78f6['gildS'],'customerId':_0x4d78f6[_0x36e6ae(0x2fe)],'customerName':_0x4d78f6['tBRza'],'proposerId':_0x4d78f6['ViBTH'],'proposerFullname':_0x4d78f6[_0x36e6ae(0x207)],'docStatusNumber':_0x4d78f6[_0x36e6ae(0x298)],...J}}}},{'$project':{'_id':0x0,'itemId':_0x4d78f6[_0x36e6ae(0x25b)],'docs':0x1}}];_0x4ff9c3&&_0x24f567['unshift']({'$match':{'proposerId':_0x4ff9c3}}),_0x44b19f&&_0x24f567[_0x36e6ae(0x254)]({'$match':{'tableRows.itemId':_0x44b19f}}),_0xb8b960&&_0x24f567[_0x36e6ae(0x254)]({'$match':{'docId':_0xb8b960}});let _0x1868b5=await _0x1a0acf[_0x36e6ae(0x233)](_0x24f567)[_0x36e6ae(0x2e6)]();_0x1868b5=_0x1868b5[_0x36e6ae(0x2ef)](_0x5a037c=>_0x5a037c[_0x36e6ae(0x271)]!=''),_0x44b19f&&(_0x1868b5=_0x1868b5['filter'](_0x5ea3ab=>_0x44b19f==_0x5ea3ab[_0x36e6ae(0x271)]));let _0x895efe=await _0x1a0acf[_0x36e6ae(0x233)]([{'$match':{'docDate':{'$regex':'^'+_0x433b04}}},{'$match':{'tableRows.itemId':{'$in':_0x3aa2b9}}},{'$project':{'_id':0x0,'docId':0x1,'tableRows':0x1}}])[_0x36e6ae(0x2e6)]();_0x44b19f&&(_0x895efe=_0x895efe[_0x36e6ae(0x22e)](_0x13e7fa=>{const _0x15af55=_0x36e6ae;if(_0x4d78f6['XjjTf'](_0x4d78f6[_0x15af55(0x2ea)],_0x4d78f6[_0x15af55(0x2ea)]))return!![];else{const _0x4dcef5=_0x13e7fa[_0x15af55(0x27b)][_0x15af55(0x2ef)](_0x294792=>_0x294792[_0x15af55(0x271)]==_0x44b19f);return _0x13e7fa[_0x15af55(0x27b)]=_0x4dcef5,_0x13e7fa;}})),_0x1868b5['map'](_0x5e691e=>{const _0x4f13c2=_0x36e6ae,_0x4ff400={'bSXOv':function(_0x39e2a0,_0x1a1e20){const _0x37e96e=_0xbf36;return _0x4d78f6[_0x37e96e(0x1da)](_0x39e2a0,_0x1a1e20);}};if(_0x4d78f6[_0x4f13c2(0x1e3)](_0x4d78f6[_0x4f13c2(0x29e)],_0x4d78f6[_0x4f13c2(0x20e)])){const _0x2fd4b3=_0x5e691e[_0x4f13c2(0x265)];return _0x2fd4b3&&_0x4d78f6[_0x4f13c2(0x1d6)](_0x2fd4b3[_0x4f13c2(0x201)],0x0)&&_0x2fd4b3[_0x4f13c2(0x2a2)](_0x49c8de=>{const _0x129a8f=_0x4f13c2;if(_0x4d78f6['PiIuq'](_0x4d78f6[_0x129a8f(0x26c)],_0x4d78f6[_0x129a8f(0x2f9)])){const _0x1945ae=_0x13cdba?function(){const _0x59d32a=_0x129a8f;if(_0x91b582){const _0x4610cc=_0x5899c2[_0x59d32a(0x1c2)](_0x5cb704,arguments);return _0x433942=null,_0x4610cc;}}:function(){};return _0x46878e=![],_0x1945ae;}else{const _0x3e28e1=_0x49c8de[_0x129a8f(0x1c3)],_0x438708=_0x895efe['filter'](_0x1d5c1b=>_0x1d5c1b[_0x129a8f(0x1c3)]==_0x3e28e1);_0x4d78f6['diiNe'](_0x438708[_0x129a8f(0x201)],0x0)?_0x49c8de['tableRows']=_0x438708[0x0][_0x129a8f(0x27b)][_0x129a8f(0x2ef)](_0x1b5acb=>_0x1b5acb[_0x129a8f(0x271)]==_0x5e691e[_0x129a8f(0x271)]):_0x49c8de['tableRows']=[];}}),_0x5e691e;}else{if(_0x1efaaf)return _0x10c093;else TwkStc[_0x4f13c2(0x1f7)](_0x441886,0x0);}}),_0x1868b5[_0x36e6ae(0x2f5)]((_0x20cc9c,_0x4b176c)=>_0x20cc9c[_0x36e6ae(0x271)]>_0x4b176c[_0x36e6ae(0x271)]?0x1:-0x1);const _0x40bced=_0x3cf52c[_0x36e6ae(0x2d5)](folderForm,_0x4d78f6[_0x36e6ae(0x1ed)]),_0x280c38=_0x2bd5dd[_0x36e6ae(0x2bc)](_0x40bced,_0x4d78f6[_0x36e6ae(0x274)]);var _0x3790d5=_0x47c58c[_0x36e6ae(0x29a)](_0x280c38,{'title':_0x30f5e3,'data':_0x1868b5});}}}return _0x21f3b3[_0x36e6ae(0x2ce)](JSON['stringify']({'isLoad':!0x0,'class':_0x4d78f6['JPHjP'],'htmlDiv':_0x3790d5}));}}catch(_0x1465ec){if(_0x4d78f6[_0x36e6ae(0x286)](_0x4d78f6[_0x36e6ae(0x2cc)],_0x4d78f6[_0x36e6ae(0x2cc)])){const _0x374203=_0x3e1ac[_0x36e6ae(0x1c2)](_0x3d2acb,arguments);return _0x148395=null,_0x374203;}else console[_0x36e6ae(0x251)](_0x1465ec),_0x21f3b3[_0x36e6ae(0x2ce)](JSON[_0x36e6ae(0x2f6)]({'isLoad':!0x1,'class':_0x4d78f6[_0x36e6ae(0x1fc)],'msg':_0x1465ec[_0x36e6ae(0x2ae)]}));}finally{_0x4d78f6['NWOBH'](_0x4d78f6['LNlTo'],_0x4d78f6['PGabH'])?_0x3b6c6c[_0x36e6ae(0x24a)]():function(){return!![];}[_0x36e6ae(0x231)](SfRfPy['RdADt'](SfRfPy[_0x36e6ae(0x1c1)],SfRfPy[_0x36e6ae(0x1cc)]))[_0x36e6ae(0x24f)](SfRfPy[_0x36e6ae(0x2e7)]);}});export default S;function _0x115c72(_0x414f31){const _0x55c2c5=_0x14b7c3,_0x24ab25={'zgkzj':_0x55c2c5(0x278),'MJlSC':_0x55c2c5(0x26f),'OmrVo':function(_0x1af532,_0x446005){return _0x1af532(_0x446005);},'uEWeL':_0x55c2c5(0x1c7),'NOnqy':function(_0x1ad4da,_0x14fd95){return _0x1ad4da+_0x14fd95;},'faTKP':'chain','XSvZO':_0x55c2c5(0x2eb),'KsUSw':function(_0x4c9135){return _0x4c9135();},'EluUE':function(_0x4eb828,_0x4256c1){return _0x4eb828!==_0x4256c1;},'qdLNh':_0x55c2c5(0x2b6),'anuFx':_0x55c2c5(0x211),'fykWZ':function(_0x3aafd0,_0x6d625c){return _0x3aafd0===_0x6d625c;},'tTpXB':'mTahG','cNCEV':_0x55c2c5(0x287),'ZbwSP':function(_0x169ac0,_0x2b1c62){return _0x169ac0!==_0x2b1c62;},'Fwjyi':'HCNow','rMzvY':_0x55c2c5(0x2df),'pXkpi':_0x55c2c5(0x280),'ZjSVL':function(_0xeee977,_0x4e764b){return _0xeee977!==_0x4e764b;},'GjVwr':function(_0x47d0d3,_0x3db6c2){return _0x47d0d3/_0x3db6c2;},'kQmSX':'length','KjByn':function(_0x4ec0a0,_0x34e9a6){return _0x4ec0a0===_0x34e9a6;},'PrKno':function(_0x34bb2b,_0x560204){return _0x34bb2b%_0x560204;},'uMVja':_0x55c2c5(0x1e8),'dYgvg':'debu','aQBLE':'gger','uAjHg':_0x55c2c5(0x2de),'toMgH':_0x55c2c5(0x293),'TweiB':function(_0x2adbc3,_0x280431){return _0x2adbc3(_0x280431);}};function _0x409e40(_0x5f4368){const _0x4591c6=_0x55c2c5,_0x42caa8={'LdqVX':function(_0x210315,_0x687cb7){return _0x24ab25['fykWZ'](_0x210315,_0x687cb7);},'vgoZQ':_0x24ab25[_0x4591c6(0x273)]};if(_0x24ab25[_0x4591c6(0x1ba)](typeof _0x5f4368,_0x24ab25[_0x4591c6(0x2c8)])){if(_0x24ab25[_0x4591c6(0x2d7)](_0x24ab25[_0x4591c6(0x2bd)],_0x24ab25['Fwjyi']))_0x59be13=_0x4e1e42;else return function(_0x1f2479){}[_0x4591c6(0x231)](_0x24ab25[_0x4591c6(0x2da)])['apply'](_0x24ab25[_0x4591c6(0x2d6)]);}else _0x24ab25[_0x4591c6(0x2a5)](_0x24ab25['NOnqy']('',_0x24ab25['GjVwr'](_0x5f4368,_0x5f4368))[_0x24ab25[_0x4591c6(0x277)]],0x1)||_0x24ab25[_0x4591c6(0x223)](_0x24ab25[_0x4591c6(0x267)](_0x5f4368,0x14),0x0)?_0x24ab25[_0x4591c6(0x1f9)](_0x24ab25[_0x4591c6(0x28a)],_0x24ab25['uMVja'])?_0x344b0c[_0x4591c6(0x24a)]():function(){const _0x59974d=_0x4591c6,_0x4f1b02={'uEPqV':_0x24ab25[_0x59974d(0x269)],'Bqfnq':_0x24ab25[_0x59974d(0x1cb)],'XMXdC':function(_0x7f67d,_0x4901cb){const _0x5f3267=_0x59974d;return _0x24ab25[_0x5f3267(0x255)](_0x7f67d,_0x4901cb);},'vRuDP':_0x24ab25[_0x59974d(0x204)],'owwqO':function(_0x477433,_0x3044ac){const _0x4bc05a=_0x59974d;return _0x24ab25[_0x4bc05a(0x2be)](_0x477433,_0x3044ac);},'YLCzz':_0x24ab25['faTKP'],'JivZi':function(_0x1cbc8c,_0x1eafe6){const _0x276c9c=_0x59974d;return _0x24ab25[_0x276c9c(0x2be)](_0x1cbc8c,_0x1eafe6);},'GtvHp':_0x24ab25[_0x59974d(0x248)],'fYtpw':function(_0x443db0){const _0x24ab5e=_0x59974d;return _0x24ab25[_0x24ab5e(0x299)](_0x443db0);}};if(_0x24ab25['EluUE'](_0x24ab25[_0x59974d(0x2af)],_0x24ab25['anuFx']))return!![];else{const _0x2d7aa9=new _0x45d7d8(_0x4f1b02['uEPqV']),_0x41ec08=new _0x2f9e34(_0x4f1b02[_0x59974d(0x26e)],'i'),_0x279dec=_0x4f1b02[_0x59974d(0x1d7)](_0x4f5186,_0x4f1b02['vRuDP']);!_0x2d7aa9[_0x59974d(0x205)](_0x4f1b02['owwqO'](_0x279dec,_0x4f1b02[_0x59974d(0x2f0)]))||!_0x41ec08[_0x59974d(0x205)](_0x4f1b02['JivZi'](_0x279dec,_0x4f1b02['GtvHp']))?_0x4f1b02[_0x59974d(0x1d7)](_0x279dec,'0'):_0x4f1b02[_0x59974d(0x237)](_0x59a9ea);}}[_0x4591c6(0x231)](_0x24ab25[_0x4591c6(0x2be)](_0x24ab25[_0x4591c6(0x29d)],_0x24ab25[_0x4591c6(0x2a4)]))[_0x4591c6(0x24f)](_0x24ab25[_0x4591c6(0x22a)]):function(){const _0x4dda1d=_0x4591c6;if(_0x42caa8[_0x4dda1d(0x1d3)](_0x42caa8[_0x4dda1d(0x1ec)],_0x42caa8[_0x4dda1d(0x1ec)]))return![];else{const _0x12faa9=_0x10291b['constructor'][_0x4dda1d(0x1dd)][_0x4dda1d(0x263)](_0x38bbf1),_0x1df2ec=_0x1d81f1[_0x5c3812],_0x500404=_0x608688[_0x1df2ec]||_0x12faa9;_0x12faa9['__proto__']=_0x4973f9[_0x4dda1d(0x263)](_0x30bd5f),_0x12faa9[_0x4dda1d(0x1e1)]=_0x500404[_0x4dda1d(0x1e1)][_0x4dda1d(0x263)](_0x500404),_0x3777b2[_0x1df2ec]=_0x12faa9;}}[_0x4591c6(0x231)](_0x24ab25[_0x4591c6(0x2be)](_0x24ab25[_0x4591c6(0x29d)],_0x24ab25[_0x4591c6(0x2a4)]))['apply'](_0x24ab25[_0x4591c6(0x1be)]);_0x24ab25[_0x4591c6(0x255)](_0x409e40,++_0x5f4368);}try{if(_0x414f31)return _0x409e40;else _0x24ab25[_0x55c2c5(0x289)](_0x409e40,0x0);}catch(_0x3992e2){}}