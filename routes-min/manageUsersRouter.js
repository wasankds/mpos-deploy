const _0x7f61f6=_0x4875;(function(_0x60efe6,_0x80c7a7){const _0x4a64ee=_0x4875,_0x1be377=_0x60efe6();while(!![]){try{const _0xea8815=parseInt(_0x4a64ee(0x16f))/0x1*(parseInt(_0x4a64ee(0x32d))/0x2)+parseInt(_0x4a64ee(0x316))/0x3*(-parseInt(_0x4a64ee(0x32e))/0x4)+-parseInt(_0x4a64ee(0x15f))/0x5*(-parseInt(_0x4a64ee(0x332))/0x6)+parseInt(_0x4a64ee(0x2d8))/0x7*(parseInt(_0x4a64ee(0x15a))/0x8)+-parseInt(_0x4a64ee(0x31f))/0x9*(-parseInt(_0x4a64ee(0x308))/0xa)+-parseInt(_0x4a64ee(0x2c6))/0xb*(-parseInt(_0x4a64ee(0x348))/0xc)+-parseInt(_0x4a64ee(0x375))/0xd;if(_0xea8815===_0x80c7a7)break;else _0x1be377['push'](_0x1be377['shift']());}catch(_0x41a872){_0x1be377['push'](_0x1be377['shift']());}}}(_0x362b,0xdaab1));const _0x2c3f7c=(function(){const _0x4e0d87=_0x4875,_0x1072c3={'fYfFL':function(_0x259fce,_0x124457){return _0x259fce!==_0x124457;},'iyjPl':function(_0x225a92,_0x4a7565){return _0x225a92==_0x4a7565;},'CgDwF':function(_0x23e3c3,_0x3d55f4){return _0x23e3c3!==_0x3d55f4;},'zYtgG':'NimLH','yXyKd':'zKSVM','GYuGv':_0x4e0d87(0x25a),'VNjjv':function(_0x5b4dce,_0x163f0f){return _0x5b4dce===_0x163f0f;},'OvjwF':'oqQim'};let _0x19bdaa=!![];return function(_0x517921,_0x3dbdfc){const _0xe64300=_0x4e0d87,_0x5ad358={'bCqkE':function(_0x46f781,_0x3c2500){return _0x1072c3['fYfFL'](_0x46f781,_0x3c2500);},'dGcbs':function(_0x3c586e,_0x525989){const _0x12f4be=_0x4875;return _0x1072c3[_0x12f4be(0x1ff)](_0x3c586e,_0x525989);},'epHsB':function(_0x98d7fd,_0x135d6a){const _0x48da2f=_0x4875;return _0x1072c3[_0x48da2f(0x189)](_0x98d7fd,_0x135d6a);},'LEPpm':_0x1072c3['zYtgG'],'HxwWe':_0x1072c3['yXyKd'],'ogxaI':_0x1072c3['GYuGv']};if(_0x1072c3[_0xe64300(0x36b)](_0x1072c3[_0xe64300(0x2d0)],_0x1072c3[_0xe64300(0x2d0)])){const _0x382661=_0x19bdaa?function(){const _0xe0e6c6=_0xe64300,_0x3f5d24={'xSJGk':function(_0x5ab252,_0x3f6d4a){const _0x568015=_0x4875;return _0x5ad358[_0x568015(0x1b8)](_0x5ab252,_0x3f6d4a);},'IMRji':function(_0x4d5d94,_0x497f15){return _0x5ad358['dGcbs'](_0x4d5d94,_0x497f15);},'Nceke':function(_0x11f29b,_0x280b37){return _0x5ad358['bCqkE'](_0x11f29b,_0x280b37);}};if(_0x5ad358[_0xe0e6c6(0x18f)](_0x5ad358[_0xe0e6c6(0x1f2)],_0x5ad358[_0xe0e6c6(0x157)])){if(_0x3dbdfc){if(_0x5ad358[_0xe0e6c6(0x18f)](_0x5ad358[_0xe0e6c6(0x354)],_0x5ad358[_0xe0e6c6(0x354)])){const _0x295a85={'WkNOW':function(_0x23a1b6,_0x27035){const _0x48b706=_0xe0e6c6;return _0x3f5d24[_0x48b706(0x1c9)](_0x23a1b6,_0x27035);},'XzLVx':function(_0x139136,_0x1c9e05){const _0x4d01bf=_0xe0e6c6;return _0x3f5d24[_0x4d01bf(0x378)](_0x139136,_0x1c9e05);},'WwVfn':function(_0x3cad98,_0x16ced4){const _0x4296cf=_0xe0e6c6;return _0x3f5d24[_0x4296cf(0x1df)](_0x3cad98,_0x16ced4);}},_0x12f9ef=_0x3cebe4['userId'];_0x31b3be=_0x57d708[_0xe0e6c6(0x2b7)](_0x27b569=>{const _0x178076=_0xe0e6c6,_0x45d3fa=_0x295a85['WkNOW'](_0x27b569['userAuthority'],'S')||_0x295a85['XzLVx'](_0x27b569[_0x178076(0x1c8)],_0x12f9ef);return _0x295a85[_0x178076(0x23a)](_0x27b569['userAuthority'],'O')&&_0x45d3fa;});}else{const _0x33c7f2=_0x3dbdfc[_0xe0e6c6(0x1b0)](_0x517921,arguments);return _0x3dbdfc=null,_0x33c7f2;}}}else _0x4bac63[_0xe0e6c6(0x2fa)]();}:function(){};return _0x19bdaa=![],_0x382661;}else _0x9f2f29[_0xe64300(0x2fa)]();};}());(function(){const _0xcf850f=_0x4875,_0x5b965d={'IGMSL':function(_0x24abe7,_0x274fdf){return _0x24abe7+_0x274fdf;},'dblmu':_0xcf850f(0x246),'juoco':_0xcf850f(0x142),'RyAcD':_0xcf850f(0x2e1),'WoeQI':function(_0xc19814,_0xf21631){return _0xc19814!==_0xf21631;},'pNFpS':_0xcf850f(0x2e6),'GHLhm':_0xcf850f(0x2bf),'yYDLS':'function\x20*\x5c(\x20*\x5c)','xowYH':_0xcf850f(0x198),'Fvywe':function(_0x1cd36e,_0x23b452){return _0x1cd36e(_0x23b452);},'XHhLZ':_0xcf850f(0x294),'PhDfd':function(_0x392a64,_0xd0da93){return _0x392a64+_0xd0da93;},'oWTeV':_0xcf850f(0x17f),'oUmSf':_0xcf850f(0x271),'yOwbl':function(_0x1b9897,_0x5aaa08){return _0x1b9897===_0x5aaa08;},'rgixc':_0xcf850f(0x1fa),'AalNM':_0xcf850f(0x1d7),'vvJmU':function(_0x1565a2,_0x423334){return _0x1565a2(_0x423334);},'TILYG':_0xcf850f(0x19e),'ZUQgy':_0xcf850f(0x1ad),'wKvlw':function(_0x10a0c2){return _0x10a0c2();},'uzmtF':function(_0x2c1e59,_0x44c842,_0x3e62e7){return _0x2c1e59(_0x44c842,_0x3e62e7);}};_0x5b965d[_0xcf850f(0x164)](_0x2c3f7c,this,function(){const _0x1b59ae=_0xcf850f;if(_0x5b965d[_0x1b59ae(0x244)](_0x5b965d[_0x1b59ae(0x324)],_0x5b965d[_0x1b59ae(0x24e)])){const _0x2464a1=new RegExp(_0x5b965d[_0x1b59ae(0x368)]),_0x13bb66=new RegExp(_0x5b965d[_0x1b59ae(0x254)],'i'),_0x44ac73=_0x5b965d[_0x1b59ae(0x29a)](_0xc9d544,_0x5b965d[_0x1b59ae(0x1cd)]);if(!_0x2464a1[_0x1b59ae(0x1d1)](_0x5b965d[_0x1b59ae(0x288)](_0x44ac73,_0x5b965d['oWTeV']))||!_0x13bb66[_0x1b59ae(0x1d1)](_0x5b965d[_0x1b59ae(0x2fb)](_0x44ac73,_0x5b965d[_0x1b59ae(0x1bb)]))){if(_0x5b965d[_0x1b59ae(0x347)](_0x5b965d['rgixc'],_0x5b965d[_0x1b59ae(0x262)])){if(_0x4659dd){const _0xd9eea=_0x3ae447[_0x1b59ae(0x1b0)](_0x3eca7c,arguments);return _0xf12c59=null,_0xd9eea;}}else _0x5b965d[_0x1b59ae(0x12f)](_0x44ac73,'0');}else{if(_0x5b965d[_0x1b59ae(0x347)](_0x5b965d['TILYG'],_0x5b965d[_0x1b59ae(0x147)]))return![];else _0x5b965d[_0x1b59ae(0x20d)](_0xc9d544);}}else(function(){return!![];}[_0x1b59ae(0x1a6)](_0x5b965d[_0x1b59ae(0x2fb)](_0x5b965d[_0x1b59ae(0x33e)],_0x5b965d[_0x1b59ae(0x241)]))[_0x1b59ae(0x1b2)](_0x5b965d[_0x1b59ae(0x2be)]));})();}());const _0x344029=(function(){const _0x527a1b=_0x4875,_0x2bc942={'JbbyF':_0x527a1b(0x23e),'nqOqS':function(_0x2e4dd4,_0x1747cb){return _0x2e4dd4!==_0x1747cb;},'qCBAH':function(_0x27d596,_0x34f76b){return _0x27d596==_0x34f76b;},'ZIzxN':_0x527a1b(0x231),'Dhale':'HXXDA','FQyLK':function(_0x2472d1,_0x19e140){return _0x2472d1===_0x19e140;},'zCGSP':_0x527a1b(0x140),'eeTCq':_0x527a1b(0x1c7),'bskre':'ctseN'};let _0x16330a=!![];return function(_0x29ea0e,_0x510cb9){const _0xe86a9d=_0x527a1b,_0x13aecc={'FOysR':function(_0x4ffe92,_0x50e562){return _0x2bc942['nqOqS'](_0x4ffe92,_0x50e562);},'PTsWR':function(_0xc4cc95,_0x2456db){return _0x2bc942['qCBAH'](_0xc4cc95,_0x2456db);},'URJBQ':function(_0x5862ad,_0x3f1dd1){const _0x2dbb5c=_0x4875;return _0x2bc942[_0x2dbb5c(0x28f)](_0x5862ad,_0x3f1dd1);},'QriQo':_0x2bc942['ZIzxN'],'YojWB':_0x2bc942[_0xe86a9d(0x1e4)],'Rcvcz':function(_0x2551ef,_0x4f5d25){const _0x2f8590=_0xe86a9d;return _0x2bc942[_0x2f8590(0x31c)](_0x2551ef,_0x4f5d25);},'GoSRq':_0x2bc942[_0xe86a9d(0x2e9)],'LAAVe':_0x2bc942['eeTCq']};if(_0x2bc942['FQyLK'](_0x2bc942[_0xe86a9d(0x19b)],_0x2bc942[_0xe86a9d(0x19b)])){const _0x3ad3bc=_0x16330a?function(){const _0x3cc1c0=_0xe86a9d;if(_0x13aecc[_0x3cc1c0(0x1e1)](_0x13aecc[_0x3cc1c0(0x1b3)],_0x13aecc[_0x3cc1c0(0x163)])){if(_0x510cb9){if(_0x13aecc['Rcvcz'](_0x13aecc[_0x3cc1c0(0x13e)],_0x13aecc[_0x3cc1c0(0x240)])){const _0x187bc6=_0x751db2[_0x3cc1c0(0x1b0)](_0x41f493,arguments);return _0x1a3a03=null,_0x187bc6;}else{const _0x3a29f9=_0x510cb9[_0x3cc1c0(0x1b0)](_0x29ea0e,arguments);return _0x510cb9=null,_0x3a29f9;}}}else{const _0x515e50=_0x13aecc['FOysR'](_0xe1205a['userAuthority'],'S')||_0x13aecc[_0x3cc1c0(0x128)](_0x365cf3['userId'],_0x36a27c);return _0x13aecc[_0x3cc1c0(0x16e)](_0x5890e1[_0x3cc1c0(0x247)],'O')&&_0x515e50;}}:function(){};return _0x16330a=![],_0x3ad3bc;}else _0x57841d[_0xe86a9d(0x333)](_0x2bc942['JbbyF'],_0x3c53af),_0x583d54[_0xe86a9d(0x2f8)](0x194)[_0xe86a9d(0x346)](_0x4295c5);};}()),_0x10b060=_0x344029(this,function(){const _0x38fbe0=_0x4875,_0x37a5e2={'blClS':function(_0x4bdb1f,_0x36708d){return _0x4bdb1f(_0x36708d);},'lMPcb':function(_0x85887c,_0x8a0ec4){return _0x85887c(_0x8a0ec4);},'cwCnZ':_0x38fbe0(0x23e),'iPTyD':_0x38fbe0(0x12d),'pJKZC':'red','pvozS':function(_0x76808c,_0x524f5e){return _0x76808c===_0x524f5e;},'FNTBi':_0x38fbe0(0x12b),'hhuBB':function(_0x58b278,_0x584107){return _0x58b278!==_0x584107;},'emrJW':_0x38fbe0(0x26f),'SkIOl':function(_0x34ca3a,_0x19490f){return _0x34ca3a(_0x19490f);},'AbfEP':function(_0x179715,_0x372d23){return _0x179715+_0x372d23;},'srEQq':_0x38fbe0(0x298),'qwctA':_0x38fbe0(0x2c3),'WwYiG':function(_0x3bbc55,_0x49742c){return _0x3bbc55===_0x49742c;},'xMKzp':_0x38fbe0(0x319),'EHUFR':_0x38fbe0(0x161),'qbyqM':function(_0x5306fc){return _0x5306fc();},'ytYcQ':_0x38fbe0(0x333),'MjcHR':_0x38fbe0(0x17b),'HvNXs':_0x38fbe0(0x204),'qhXWV':'error','MxllW':_0x38fbe0(0x2de),'oRuOU':_0x38fbe0(0x26d),'ToFgw':_0x38fbe0(0x2da),'scNwU':function(_0x1c273f,_0x182c45){return _0x1c273f<_0x182c45;},'kQggy':_0x38fbe0(0x24d)},_0x424793=function(){const _0x390ce3=_0x38fbe0,_0x2bfdd8={'jsVhF':_0x37a5e2['cwCnZ'],'MyhWe':_0x37a5e2[_0x390ce3(0x2a8)],'HwIXh':_0x37a5e2[_0x390ce3(0x167)]};if(_0x37a5e2['pvozS'](_0x37a5e2['FNTBi'],_0x37a5e2[_0x390ce3(0x152)])){let _0xaba997;try{_0x37a5e2[_0x390ce3(0x2d2)](_0x37a5e2[_0x390ce3(0x34f)],_0x37a5e2[_0x390ce3(0x34f)])?(_0x5aedea['userId']=_0x37a5e2[_0x390ce3(0x356)](_0x541b95,_0x3bdb6a[_0x390ce3(0x1c8)]),_0x328598[_0x390ce3(0x25e)]=_0x37a5e2[_0x390ce3(0x30e)](_0xc2b91f,_0xea8eb[_0x390ce3(0x25e)]),_0x3c4482['userIsActive']||(_0x1eefae[_0x390ce3(0x1a0)]=''),_0x534d09['userPhone']||(_0x24d337[_0x390ce3(0x12e)]=''),_0xf68e55['userPrefix']||(_0x13be24[_0x390ce3(0x27a)]=''),_0x4ee6d6[_0x390ce3(0x33c)]||(_0x558318[_0x390ce3(0x33c)]=''),delete _0x5eaad5[_0x390ce3(0x19a)],delete _0x2916f0[_0x390ce3(0x221)],delete _0x302f6d[_0x390ce3(0x230)],delete _0x234150[_0x390ce3(0x19a)]):_0xaba997=_0x37a5e2[_0x390ce3(0x23c)](Function,_0x37a5e2[_0x390ce3(0x181)](_0x37a5e2[_0x390ce3(0x181)](_0x37a5e2['srEQq'],_0x37a5e2['qwctA']),');'))();}catch(_0x4bdf61){_0x37a5e2[_0x390ce3(0x120)](_0x37a5e2[_0x390ce3(0x1a2)],_0x37a5e2['EHUFR'])?_0x18d4b3[_0x390ce3(0x2fa)]():_0xaba997=window;}return _0xaba997;}else return _0x6fba2c[_0x390ce3(0x333)](_0x2bfdd8[_0x390ce3(0x21b)],_0x3d7444),_0x149250[_0x390ce3(0x32a)](_0x2bfdd8[_0x390ce3(0x2a6)],{'class':_0x2bfdd8['HwIXh'],'text':_0x402021[_0x390ce3(0x15d)]}),_0x4e9c23[_0x390ce3(0x31e)](_0x724dca);},_0x1f1bae=_0x37a5e2[_0x38fbe0(0x1e9)](_0x424793),_0xf76ef0=_0x1f1bae[_0x38fbe0(0x214)]=_0x1f1bae['console']||{},_0x107425=[_0x37a5e2[_0x38fbe0(0x312)],_0x37a5e2[_0x38fbe0(0x1e8)],_0x37a5e2[_0x38fbe0(0x276)],_0x37a5e2[_0x38fbe0(0x1d0)],_0x37a5e2[_0x38fbe0(0x144)],_0x37a5e2[_0x38fbe0(0x373)],_0x37a5e2[_0x38fbe0(0x156)]];for(let _0x4357b3=0x0;_0x37a5e2['scNwU'](_0x4357b3,_0x107425[_0x38fbe0(0x218)]);_0x4357b3++){if(_0x37a5e2['hhuBB'](_0x37a5e2[_0x38fbe0(0x292)],_0x37a5e2['kQggy']))return!![];else{const _0x230a67=_0x344029[_0x38fbe0(0x1a6)][_0x38fbe0(0x1a7)]['bind'](_0x344029),_0xf6091c=_0x107425[_0x4357b3],_0x10a5ba=_0xf76ef0[_0xf6091c]||_0x230a67;_0x230a67[_0x38fbe0(0x277)]=_0x344029[_0x38fbe0(0x21e)](_0x344029),_0x230a67[_0x38fbe0(0x2b5)]=_0x10a5ba[_0x38fbe0(0x2b5)]['bind'](_0x10a5ba),_0xf76ef0[_0xf6091c]=_0x230a67;}}});_0x10b060();import _0x28ac99 from'express';import{MongoClient as _0x5e61d3,ObjectId as _0xd3a812}from'mongodb';import _0x4afeee from'bcrypt';const x=_0x28ac99[_0x7f61f6(0x1b9)]();import _0x1a4ade from'multer';import _0xe56422 from'validator';import _0x207e47 from'xlsx';import _0x439ee9 from'path';import _0x121227 from'fs';import _0x42ea7c from'ejs';import _0x5ae4a2 from'../middleware/mainAuth.js';const H=await import('../'+mymoduleFolder+_0x7f61f6(0x35e)),O=await import('../'+mymoduleFolder+'/myDateTime.js'),M=await import(_0x7f61f6(0x2b4)+mymoduleFolder+_0x7f61f6(0x12c)),re=await import(_0x7f61f6(0x2b4)+mymoduleFolder+_0x7f61f6(0x224)),z=await import(_0x7f61f6(0x2b4)+mymoduleFolder+_0x7f61f6(0x364)),b='/manage/users',Q=b+'/save',X=b+_0x7f61f6(0x2af),W=b+_0x7f61f6(0x14d),G=b+_0x7f61f6(0x365),V=b+'/print',Y=b+_0x7f61f6(0x23f),K=b+_0x7f61f6(0x20e),Z=b+'/upload-excel',ne=b['replace'](/\//g,'_'),oe=0x5a0*0x3c;x[_0x7f61f6(0x179)](b,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x230b92,_0x4c54b4)=>{const _0x45e0d1=_0x7f61f6,_0x15e653={'LFgWp':function(_0x261730,_0x4c67ec){return _0x261730(_0x4c67ec);},'KYkQh':function(_0x469477,_0x56775e){return _0x469477!==_0x56775e;},'aWOFg':_0x45e0d1(0x281),'XHgui':function(_0x2ac80a,_0x5e4db2){return _0x2ac80a==_0x5e4db2;},'Aouxs':function(_0x5e4b39,_0x4d63e2){return _0x5e4b39!==_0x4d63e2;},'WWbWu':function(_0x4769f0,_0x468d27){return _0x4769f0(_0x468d27);},'WeiMv':_0x45e0d1(0x23e),'UvyTc':_0x45e0d1(0x2b1),'SxIJy':function(_0x2d5d2e,_0x650237){return _0x2d5d2e(_0x650237);},'zIxrS':function(_0x1e0635,_0x100c2a){return _0x1e0635(_0x100c2a);},'RDach':function(_0x296823,_0x127b80){return _0x296823*_0x127b80;},'CysQa':function(_0x3b0308,_0x36aff4){return _0x3b0308-_0x36aff4;},'ElXlv':function(_0x4452dc,_0x2d06c4){return _0x4452dc!==_0x2d06c4;},'BFnbW':_0x45e0d1(0x1fe),'VArPI':_0x45e0d1(0x29b),'eqcJy':function(_0x1e0108,_0x2c25da){return _0x1e0108!==_0x2c25da;},'avZbR':_0x45e0d1(0x170),'YvILp':_0x45e0d1(0x2c5),'KYSfi':function(_0x5b5f1d,_0x78b625){return _0x5b5f1d(_0x78b625);},'OBLRa':function(_0x4a6c66,_0x429c8b){return _0x4a6c66/_0x429c8b;},'OEMkQ':function(_0x53c792,_0x28b0f5){return _0x53c792<_0x28b0f5;},'jNYnD':function(_0xb28b1e,_0x60b5ad){return _0xb28b1e-_0x60b5ad;},'CgvLU':function(_0x45c9c8,_0x1c08e3){return _0x45c9c8-_0x1c08e3;},'cJuTg':function(_0x2db02a,_0x500533){return _0x2db02a(_0x500533);},'MRHNW':function(_0x287ba0,_0x43d5e3){return _0x287ba0>_0x43d5e3;},'xrDlm':function(_0x38dc6d,_0x4efe2f){return _0x38dc6d+_0x4efe2f;},'eIfNv':function(_0x4878b2,_0x3796f3){return _0x4878b2(_0x3796f3);},'GGPaj':function(_0x369a48,_0x3a7ba1){return _0x369a48(_0x3a7ba1);},'tDPkQ':_0x45e0d1(0x36f),'HfUAa':_0x45e0d1(0x33f),'gAdbM':'$userLastname','tUsVL':_0x45e0d1(0x1be),'tgmNO':_0x45e0d1(0x205),'autPR':_0x45e0d1(0x34d),'LtkDz':function(_0x2914a2,_0x418475){return _0x2914a2===_0x418475;},'JRqMl':_0x45e0d1(0x28a),'PSWYa':'TWsus','DTLbo':function(_0x313021,_0x26ac74){return _0x313021(_0x26ac74);},'BcQmm':_0x45e0d1(0x182),'LfMfG':function(_0x4fdf32,_0x5406b4){return _0x4fdf32===_0x5406b4;},'KIkgq':function(_0x5564c2,_0x5b09a7){return _0x5564c2!==_0x5b09a7;},'RoyIP':_0x45e0d1(0x1c4),'mqFXU':_0x45e0d1(0x2cc),'PBwvA':_0x45e0d1(0x2d9),'tebvm':function(_0x238349,_0x56f6d7){return _0x238349>_0x56f6d7;},'WEzpw':_0x45e0d1(0x1b5),'iDZnh':'msg','rgArb':_0x45e0d1(0x2a2),'SprMJ':function(_0x2e9033,_0x4331c6){return _0x2e9033===_0x4331c6;},'FaCNN':_0x45e0d1(0x291),'zNCVy':_0x45e0d1(0x186)},_0x56336f=_0x230b92[_0x45e0d1(0x197)][_0x45e0d1(0x264)],_0x3a00e0=_0x15e653['SxIJy'](Number,_0x230b92['query'][_0x45e0d1(0x166)])||0x14,_0xb6684a=_0x15e653[_0x45e0d1(0x263)](Number,_0x230b92[_0x45e0d1(0x197)]['page'])||0x1,_0x3e50ba=_0x230b92[_0x45e0d1(0x197)][_0x45e0d1(0x2ab)]||'',_0x4fdd73=_0x15e653[_0x45e0d1(0x243)](Number,_0x15e653['RDach'](_0x15e653[_0x45e0d1(0x18e)](_0xb6684a,0x1),_0x3a00e0)),_0x3ef7d4=O[_0x45e0d1(0x149)](0x0),_0x1158e1=new _0x5e61d3(dbUrl);try{if(_0x15e653[_0x45e0d1(0x1a3)](_0x15e653[_0x45e0d1(0x1f9)],_0x15e653['VArPI'])){await _0x1158e1['connect']();const _0x42605f=_0x1158e1['db'](global[_0x45e0d1(0x1cb)])['collection'](global['dbColl_users']);if(_0x56336f){if(_0x15e653[_0x45e0d1(0x22c)](_0x15e653[_0x45e0d1(0x1aa)],_0x15e653[_0x45e0d1(0x1aa)]))_0x4ff1c4[_0x45e0d1(0x2fa)]();else{const _0x3e31a8=new RegExp(_0x56336f[_0x45e0d1(0x367)](/[.*+?^${}()|[\]\\]/g,_0x15e653['YvILp']),'i');let _0x58e21f={};_0x15e653[_0x45e0d1(0x158)](isNaN,_0x15e653[_0x45e0d1(0x31b)](Number,_0x56336f))?_0x58e21f={'userId':{'$regex':_0x3e31a8}}:_0x58e21f={'userId':_0x15e653[_0x45e0d1(0x14b)](Number,_0x56336f)};var _0x5ead39=await _0x42605f['countDocuments']({'$or':[_0x58e21f,{'username':{'$regex':_0x3e31a8}},{'userFirstname':{'$regex':_0x3e31a8}}]});}}else var _0x5ead39=await _0x42605f[_0x45e0d1(0x32b)]({});const _0x576798=Math['ceil'](_0x15e653[_0x45e0d1(0x2aa)](_0x5ead39,_0x3a00e0)),_0x34f1b5=_0x15e653[_0x45e0d1(0x286)](_0x15e653['jNYnD'](_0x15e653['LFgWp'](Number,_0xb6684a),0x1),0x1)?'-':_0x15e653[_0x45e0d1(0x121)](_0x15e653[_0x45e0d1(0x31b)](Number,_0xb6684a),0x1),_0x43cb15=_0x15e653[_0x45e0d1(0x2bd)](Number,_0xb6684a),_0x11d350=_0x15e653['MRHNW'](_0x15e653[_0x45e0d1(0x260)](_0x15e653['eIfNv'](Number,_0xb6684a),0x1),_0x576798)?'-':_0x15e653[_0x45e0d1(0x260)](_0x15e653[_0x45e0d1(0x305)](Number,_0xb6684a),0x1),_0x5cb996=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x15e653[_0x45e0d1(0x143)],'\x20',_0x15e653[_0x45e0d1(0x22d)],'\x20',_0x15e653[_0x45e0d1(0x174)]]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x15e653[_0x45e0d1(0x21c)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x3ef7d4},'endDate':{'$toDate':_0x15e653[_0x45e0d1(0x1c2)]},'unit':_0x15e653[_0x45e0d1(0x226)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x4fdd73},{'$limit':_0x3a00e0}];if(_0x56336f){if(_0x15e653[_0x45e0d1(0x2c8)](_0x15e653[_0x45e0d1(0x2f4)],_0x15e653[_0x45e0d1(0x27b)])){if(_0x5381dd)return _0x6331cd;else OqToeJ[_0x45e0d1(0x14b)](_0x3a54fd,0x0);}else{const _0x1f7add=_0x56336f?new RegExp(''+_0x56336f,'i'):new RegExp('.*');let _0x3eba79={};_0x15e653[_0x45e0d1(0x228)](isNaN,_0x15e653['zIxrS'](Number,_0x56336f))?_0x3eba79={'userId':{'$regex':_0x1f7add}}:_0x3eba79={'userId':_0x15e653[_0x45e0d1(0x14b)](Number,_0x56336f)},_0x5cb996[_0x45e0d1(0x2b0)]({'$match':{'$or':[_0x3eba79,{'username':{'$regex':_0x1f7add}},{'userFirstname':{'$regex':_0x1f7add}}]}});}}const _0x5bb83c=M[_0x45e0d1(0x30c)](_0x230b92),_0x2d54b5=_0x5bb83c[_0x45e0d1(0x247)];let _0x472548=await _0x42605f[_0x45e0d1(0x14e)](_0x5cb996)[_0x45e0d1(0x155)]();if(['S']['includes'](_0x2d54b5)){if(_0x15e653[_0x45e0d1(0x134)](_0x15e653[_0x45e0d1(0x216)],_0x15e653[_0x45e0d1(0x216)]))_0x40cc6d=_0x15f16f;else{const _0x17ea48=_0x5bb83c[_0x45e0d1(0x1c8)];_0x472548=_0x472548['filter'](_0xf92472=>{const _0x3124fb=_0x45e0d1;if(_0x15e653[_0x3124fb(0x238)](_0x15e653[_0x3124fb(0x30a)],_0x15e653['aWOFg']))_0x680dbf['has'](_0x9ae235[_0x3124fb(0x27d)])?_0x36e3f7[_0x3124fb(0x28b)](_0x587dd1['username']):_0x1d7b4c[_0x3124fb(0x28b)](_0x47bdf3[_0x3124fb(0x27d)]);else{const _0x3dd91d=_0x15e653['KYkQh'](_0xf92472[_0x3124fb(0x247)],'S')||_0x15e653['XHgui'](_0xf92472[_0x3124fb(0x1c8)],_0x17ea48);return _0x15e653[_0x3124fb(0x134)](_0xf92472[_0x3124fb(0x247)],'O')&&_0x3dd91d;}});}}if(_0x3e50ba)var _0x4ec807=await _0x42605f[_0x45e0d1(0x227)]({'_id':new _0xd3a812(_0x3e50ba)},{'projection':{'userPassword':0x0}});else var _0x4ec807={};if(_0x4ec807&&_0x15e653[_0x45e0d1(0x2c1)](Object[_0x45e0d1(0x2d4)](_0x4ec807)['length'],0x0)){if(_0x15e653['KIkgq'](_0x15e653['RoyIP'],_0x15e653[_0x45e0d1(0x160)])){const _0x1c631d=_0x230b92[_0x45e0d1(0x32a)](_0x15e653[_0x45e0d1(0x1fb)]);_0x1c631d&&_0x15e653['tebvm'](_0x1c631d[_0x45e0d1(0x218)],0x0)&&(_0x4ec807={..._0x1c631d[0x0]});}else OqToeJ['WWbWu'](_0x4b487d,0x0);}const _0x5d2991=await H[_0x45e0d1(0x325)](_0x15e653['WEzpw'],_0x4c54b4,{'title':PAGE_MANAGE_USERS,'time':O[_0x45e0d1(0x145)](),'msg':_0x230b92[_0x45e0d1(0x32a)](_0x15e653[_0x45e0d1(0x24f)]),'user':await M[_0x45e0d1(0x30c)](_0x230b92),'settings':await H['getSettings'](),'load_id':_0x3e50ba,'sip':_0x56336f,'rpp':_0x3a00e0,'page':_0xb6684a,'pagePre':_0x34f1b5,'pageAct':_0x43cb15,'pageNxt':_0x11d350,'pageLst':_0x576798,'pageRedirect':b,'data':_0x472548,'dataBranches':await z[_0x45e0d1(0x1f0)]({'branchStatus':_0x15e653[_0x45e0d1(0x1e7)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x4ec807});return _0x4c54b4[_0x45e0d1(0x2d5)](_0x5d2991);}else _0x23b4ce[_0x45e0d1(0x333)](_0x4cba20[_0x45e0d1(0x15d)]),_0x886f2a[_0x45e0d1(0x2f8)](0x194)['sendFile'](_0x31638c);}catch(_0x2c8dac){if(_0x15e653[_0x45e0d1(0x2e5)](_0x15e653['FaCNN'],_0x15e653[_0x45e0d1(0x217)]))console[_0x45e0d1(0x333)](_0x2c8dac[_0x45e0d1(0x15d)]),_0x4c54b4[_0x45e0d1(0x2f8)](0x194)[_0x45e0d1(0x346)](file404);else return _0x31edf3[_0x45e0d1(0x333)](_0x15e653[_0x45e0d1(0x154)],_0x51c44f),_0x58014b[_0x45e0d1(0x2d5)]({'isDownload':!0x1,'color':_0x15e653[_0x45e0d1(0x290)],'msg':_0x13f111[_0x45e0d1(0x15d)]});}finally{if(_0x15e653[_0x45e0d1(0x376)](_0x15e653[_0x45e0d1(0x252)],_0x15e653[_0x45e0d1(0x252)])){const _0x54ef34=_0xe881ee[_0x45e0d1(0x2c0)](new _0x5a437e(_0x8b05ba[_0x45e0d1(0x195)](_0x49c50b=>_0x2b683c['stringify'](_0x49c50b))))[_0x45e0d1(0x195)](_0x854f2a=>_0x5a582e[_0x45e0d1(0x1e3)](_0x854f2a));return _0x3a5e62[_0x45e0d1(0x2d5)]({'isUpload':!0x1,'color':_0x15e653['UvyTc'],'msg':'มีข้อมูลผิดพลาดที่แถว\x20'+_0x54ef34[_0x45e0d1(0x195)](_0x4e6c21=>_0x4e6c21['row'])[_0x45e0d1(0x1e6)](',\x20'),'errorRows':_0x54ef34});}else _0x1158e1[_0x45e0d1(0x2fa)]();}}),x[_0x7f61f6(0x1b7)](W,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x4e5269,_0x4e2217)=>{const _0x362c0b=_0x7f61f6,_0xef46c6={'cSzyD':_0x362c0b(0x12d),'icmfH':_0x362c0b(0x2b1),'qXUNg':function(_0xd30128,_0x4b5812){return _0xd30128(_0x4b5812);},'NEVpX':function(_0x33647d,_0x140df8){return _0x33647d+_0x140df8;},'ARNEj':_0x362c0b(0x298),'aBAvx':'{}.constructor(\x22return\x20this\x22)(\x20)','NHEmY':function(_0x205d93,_0x5046a5){return _0x205d93(_0x5046a5);},'CzgmQ':function(_0x12df09,_0x1979e8){return _0x12df09(_0x1979e8);},'SPqId':function(_0x4bb0a3,_0x332661){return _0x4bb0a3!==_0x332661;},'CiaBL':'XLaAW','kLsdm':'EOaAr','xFngn':_0x362c0b(0x19c),'yFXRm':function(_0x5779fe,_0x31b879){return _0x5779fe===_0x31b879;},'yrPDc':'yoRWV','IuKdY':_0x362c0b(0x30f),'piihO':function(_0x38e40e,_0x2efde0){return _0x38e40e!==_0x2efde0;},'TkydK':_0x362c0b(0x2ac),'ujGUJ':_0x362c0b(0x2d3)},_0x2e41c6=_0x4e5269['body'][_0x362c0b(0x2ab)],_0xaf99f=_0x4e5269[_0x362c0b(0x358)][_0x362c0b(0x264)],_0x32e5ba=_0xef46c6[_0x362c0b(0x299)](Number,_0x4e5269['body'][_0x362c0b(0x166)])||0x14,_0x400bf8=_0xef46c6[_0x362c0b(0x1ec)](Number,_0x4e5269[_0x362c0b(0x358)][_0x362c0b(0x137)])||0x1,_0xff2359=b+'?sip='+_0xaf99f+_0x362c0b(0x1d9)+_0x32e5ba+_0x362c0b(0x13a)+_0x400bf8+'&load_id='+_0x2e41c6,_0x4c552b=new _0x5e61d3(dbUrl);try{return _0xef46c6['SPqId'](_0xef46c6[_0x362c0b(0x297)],_0xef46c6[_0x362c0b(0x1f8)])?(await _0x4c552b['db'](dbName)[_0x362c0b(0x2d6)](dbColl_users)[_0x362c0b(0x227)]({'_id':new _0xd3a812(_0x2e41c6)},{'projection':{'changesHistory':0x0}})?_0x4e5269[_0x362c0b(0x32a)](_0xef46c6[_0x362c0b(0x2ec)],null):_0x4e5269[_0x362c0b(0x32a)](_0xef46c6[_0x362c0b(0x2ec)],{'class':_0xef46c6['icmfH'],'text':new Error(_0xef46c6['xFngn'])+'{{sep}}\x22'+_0x2e41c6+'\x22'}),_0x4e2217[_0x362c0b(0x31e)](_0xff2359)):(_0x654828['log'](_0x387fe8[_0x362c0b(0x15d)]),_0x5e96d7['flash'](_0xef46c6[_0x362c0b(0x2ec)],{'class':_0xef46c6[_0x362c0b(0x131)],'text':''+_0x1255ed[_0x362c0b(0x15d)]}),_0x31e96c[_0x362c0b(0x31e)](_0x2863a8));}catch(_0x554cbb){if(_0xef46c6['yFXRm'](_0xef46c6[_0x362c0b(0x1b6)],_0xef46c6[_0x362c0b(0x259)]))_0x4a377a=QJIUKE[_0x362c0b(0x1bd)](_0x4b70a9,QJIUKE[_0x362c0b(0x2ee)](QJIUKE[_0x362c0b(0x2ee)](QJIUKE['ARNEj'],QJIUKE[_0x362c0b(0x1fd)]),');'))();else return console['log'](_0x554cbb[_0x362c0b(0x15d)]),_0x4e5269['flash'](_0xef46c6[_0x362c0b(0x2ec)],{'class':_0xef46c6['icmfH'],'text':''+_0x554cbb[_0x362c0b(0x15d)]}),_0x4e2217[_0x362c0b(0x31e)](_0xff2359);}finally{_0xef46c6[_0x362c0b(0x2a7)](_0xef46c6[_0x362c0b(0x2ae)],_0xef46c6[_0x362c0b(0x169)])?_0x4c552b['close']():_0x5c53a0[_0x362c0b(0x2fa)]();}}),x[_0x7f61f6(0x1b7)](Q,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x793283,_0x3cd5a)=>{const _0x37baef=_0x7f61f6,_0x3400d1={'fjWjs':function(_0x1f6869,_0x44aa9b){return _0x1f6869!==_0x44aa9b;},'ffHqH':'MHWzG','xmetC':function(_0x262807,_0x19cad6){return _0x262807===_0x19cad6;},'ObogI':function(_0x289525,_0xb9618a){return _0x289525!==_0xb9618a;},'bXUmQ':_0x37baef(0x359),'kngRX':function(_0x1797de,_0x5d0081,_0x1ba4bb){return _0x1797de(_0x5d0081,_0x1ba4bb);},'Cnfoj':function(_0x7e50af){return _0x7e50af();},'bxSPr':function(_0x3cef02,_0x130d48){return _0x3cef02(_0x130d48);},'DkFPL':function(_0x532fd7,_0x4c715c){return _0x532fd7>_0x4c715c;},'OAYis':_0x37baef(0x2d9),'lrhlL':_0x37baef(0x12d),'ltaRa':'green','CLSCh':function(_0x497657,_0x1e45ff){return _0x497657(_0x1e45ff);},'BcXMh':function(_0x5cb28d,_0x13d503){return _0x5cb28d+_0x13d503;},'cLytw':_0x37baef(0x298),'LbDxN':_0x37baef(0x2c3),'tPZkh':'while\x20(true)\x20{}','rzerz':_0x37baef(0x255),'GlMnr':_0x37baef(0x23e),'petYo':_0x37baef(0x2b1),'rLUcZ':_0x37baef(0x2ca),'qdAWI':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','cqdWT':function(_0x5d939a,_0x4516f6){return _0x5d939a(_0x4516f6);},'xyPiA':'init','VljVp':_0x37baef(0x17f),'UufZK':'input','cNoPv':function(_0xe929b9){return _0xe929b9();},'rcltc':function(_0x240747,_0x571a2b){return _0x240747===_0x571a2b;},'NzHWp':_0x37baef(0x135),'JzAOV':function(_0x571e10,_0x2ab825){return _0x571e10(_0x2ab825);},'cmOEO':'รูปแบบอีเมลไม่ถูกต้อง','zIAeM':function(_0x4443a6,_0x59f096){return _0x4443a6===_0x59f096;},'lpNiB':_0x37baef(0x326),'NtxIT':_0x37baef(0x1a1),'vnmSq':function(_0x5e1dc7,_0x241a2f){return _0x5e1dc7===_0x241a2f;},'hBOUW':_0x37baef(0x1ca),'ogzbM':_0x37baef(0x287),'jmWrj':_0x37baef(0x2e3),'mrHcJ':function(_0x4e6c71,_0x5f1257){return _0x4e6c71==_0x5f1257;},'nHShK':_0x37baef(0x2a2),'IeBWE':function(_0x536eb6,_0x7a157b){return _0x536eb6==_0x7a157b;},'SmTNt':function(_0x9eb2fa,_0x36e79d){return _0x9eb2fa==_0x36e79d;},'bGDrT':function(_0x524123,_0x138273){return _0x524123!==_0x138273;},'nMgXz':_0x37baef(0x191),'Ttxyj':_0x37baef(0x16c),'RAQbP':function(_0x1e132d,_0x9e7c0f){return _0x1e132d!==_0x9e7c0f;},'XLpsv':_0x37baef(0x327),'aNXnZ':'{{sep}}[\x20บันทึกการแก้ไข\x20]','nQYdI':_0x37baef(0x15c),'bymRO':function(_0x57ac85,_0x546dd7){return _0x57ac85>_0x546dd7;},'Rkjab':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','uQzww':function(_0x37b3bc,_0x125520){return _0x37b3bc!==_0x125520;},'IUwyO':_0x37baef(0x22b),'TvJSG':function(_0x4a4971,_0x59e3ad){return _0x4a4971<_0x59e3ad;},'qlmxP':function(_0x24de66,_0xf902b0){return _0x24de66<_0xf902b0;},'svwCT':'yellow','BYDSJ':_0x37baef(0x19c),'ZQCke':_0x37baef(0x194),'LMYFj':_0x37baef(0x338),'FLjCm':function(_0x1b8390,_0x4dfda0){return _0x1b8390+_0x4dfda0;},'KEjyi':'tucJh','ygMzf':_0x37baef(0x18a),'Sxmwx':function(_0x15761f,_0x43b3e6){return _0x15761f>_0x43b3e6;},'Wryfu':_0x37baef(0x220),'maohk':function(_0x5a23c4,_0x3eae60){return _0x5a23c4===_0x3eae60;},'obJOw':_0x37baef(0x18d),'kXUkm':function(_0x111b15,_0x358805){return _0x111b15!==_0x358805;},'TGHlR':'QlhFi','XouTV':_0x37baef(0x1dc),'RFJbm':function(_0x418e31){return _0x418e31();}},_0x158e51=[];let _0x3956ab=!0x1;const _0x3e3c78=async()=>{const _0x5f3634=_0x37baef;if(_0x3400d1[_0x5f3634(0x1ac)](_0x3400d1[_0x5f3634(0x1e5)],_0x3400d1[_0x5f3634(0x1e5)]))return _0xf0206a;else{if(_0x3400d1['xmetC'](_0x158e51[_0x5f3634(0x218)],0x0)){if(_0x3400d1['ObogI'](_0x3400d1[_0x5f3634(0x293)],_0x3400d1[_0x5f3634(0x293)])){const _0x26690d=_0x1494e9?function(){if(_0x1d8d02){const _0x195ce5=_0x352ddc['apply'](_0x5b36eb,arguments);return _0x368e28=null,_0x195ce5;}}:function(){};return _0x288c80=![],_0x26690d;}else{_0x3956ab=!0x1;return;}}_0x3956ab=!0x0;const {req:_0x5193fa,res:_0x69bf6d}=_0x158e51['shift']();await _0x3400d1[_0x5f3634(0x274)](_0x3e543b,_0x5193fa,_0x69bf6d),_0x3400d1['Cnfoj'](_0x3e3c78);}},_0x3e543b=async(_0x251a83,_0x41ed9d)=>{const _0x472733=_0x37baef,_0x3eba39={'GNatm':_0x3400d1[_0x472733(0x22f)],'OGOxo':_0x3400d1[_0x472733(0x13d)],'HewlD':_0x3400d1['GlMnr'],'kUXDh':_0x3400d1[_0x472733(0x123)],'kAtMg':_0x3400d1[_0x472733(0x1d5)],'pvvoQ':_0x3400d1[_0x472733(0x1af)],'CfIYb':function(_0x379f8e,_0x6b9760){const _0x4318fb=_0x472733;return _0x3400d1[_0x4318fb(0x17a)](_0x379f8e,_0x6b9760);},'SCBJC':_0x3400d1['xyPiA'],'eFTqi':function(_0x509e08,_0x4c3504){const _0x20b66a=_0x472733;return _0x3400d1[_0x20b66a(0x2f1)](_0x509e08,_0x4c3504);},'EEvoQ':_0x3400d1[_0x472733(0x178)],'SdBmo':function(_0xd4c80c,_0x3f5d87){const _0x1ebcbd=_0x472733;return _0x3400d1[_0x1ebcbd(0x2f1)](_0xd4c80c,_0x3f5d87);},'Omdrs':_0x3400d1[_0x472733(0x1f1)],'uplVn':function(_0x4f2a79){const _0x4c6c99=_0x472733;return _0x3400d1[_0x4c6c99(0x345)](_0x4f2a79);}};if(_0x3400d1[_0x472733(0x377)](_0x3400d1[_0x472733(0x223)],_0x3400d1[_0x472733(0x223)])){const _0xe47020=_0x251a83['body'][_0x472733(0x225)];delete _0x251a83['body'][_0x472733(0x225)];const _0x48546a=_0x251a83[_0x472733(0x358)][_0x472733(0x264)],_0xaa8703=_0x3400d1['JzAOV'](Number,_0x251a83[_0x472733(0x358)][_0x472733(0x166)])||0x14,_0x377645=_0x3400d1[_0x472733(0x17a)](Number,_0x251a83[_0x472733(0x358)][_0x472733(0x137)])||0x1;delete _0x251a83[_0x472733(0x358)][_0x472733(0x166)],delete _0x251a83[_0x472733(0x358)][_0x472733(0x264)],delete _0x251a83[_0x472733(0x358)]['page'],_0x251a83['body'][_0x472733(0x1c8)]=_0x251a83[_0x472733(0x358)][_0x472733(0x1c8)]?_0x3400d1[_0x472733(0x17a)](Number,_0x251a83[_0x472733(0x358)][_0x472733(0x1c8)]):_0x251a83[_0x472733(0x358)][_0x472733(0x1c8)],_0x251a83[_0x472733(0x358)]['branchId']=_0x251a83[_0x472733(0x358)][_0x472733(0x25e)]?_0x3400d1['bxSPr'](Number,_0x251a83['body'][_0x472733(0x25e)]):_0x251a83['body'][_0x472733(0x25e)];const _0x2a9491=_0x251a83[_0x472733(0x358)][_0x472733(0x27d)]?.[_0x472733(0x311)](),_0x2fda92=_0x251a83[_0x472733(0x358)][_0x472733(0x2c7)]?.[_0x472733(0x311)](),_0xbbae64=_0x251a83[_0x472733(0x358)][_0x472733(0x1c8)],_0x4a2e2d=''+b,_0x35f6fb=b+_0x472733(0x2e8)+_0x48546a+_0x472733(0x1d9)+_0xaa8703+_0x472733(0x13a)+_0x377645+_0x472733(0x339)+_0xe47020;if(!new RegExp(USERNAME_PATTERN)[_0x472733(0x1d1)](_0x2a9491))return _0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x29f)],_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x3400d1['lrhlL'],{'class':_0x3400d1[_0x472733(0x123)],'text':USERNAME_DESCRIPTION}),_0x41ed9d[_0x472733(0x31e)](_0x35f6fb);if(_0x2fda92&&!new RegExp(EMAIL_PATTERN)[_0x472733(0x1d1)](_0x2fda92))return _0x251a83['flash'](_0x3400d1[_0x472733(0x29f)],_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x3400d1['lrhlL'],{'class':_0x3400d1[_0x472733(0x123)],'text':_0x3400d1[_0x472733(0x207)]}),_0x41ed9d['redirect'](_0x35f6fb);const _0x233281=new _0x5e61d3(dbUrl);try{if(_0x3400d1[_0x472733(0x315)](_0x3400d1[_0x472733(0x331)],_0x3400d1[_0x472733(0x235)])){_0x15e8a1=!0x1;return;}else{await _0x233281['connect']();const _0xb99044=_0x233281['db'](dbName),_0x2aebf2=_0xb99044[_0x472733(0x2d6)](dbColl_users);if(_0xe47020){if(_0x3400d1[_0x472733(0x2f2)](_0x3400d1[_0x472733(0x190)],_0x3400d1['ogzbM']))_0x418b7f['close']();else{var _0x5b4b97=await _0x2aebf2['findOne']({'_id':{'$ne':new _0xd3a812(_0xe47020)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x2fda92+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x2a9491+'$','i')}},{'userId':_0xbbae64}]});if(_0x5b4b97)return _0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x29f)],_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x123)],'text':_0x3400d1['jmWrj']}),_0x41ed9d['redirect'](_0x35f6fb);const _0x48824e=await _0x2aebf2[_0x472733(0x227)]({'_id':new _0xd3a812(_0xe47020)}),_0x1c2da2=[_0x3400d1[_0x472733(0x2f6)](_0x251a83['body'][_0x472733(0x1a0)],_0x3400d1[_0x472733(0x35d)]),_0x3400d1[_0x472733(0x2f6)](_0x48824e[_0x472733(0x27d)],_0x251a83[_0x472733(0x358)][_0x472733(0x27d)]),_0x3400d1['mrHcJ'](_0x48824e['userEmail'],_0x251a83[_0x472733(0x358)][_0x472733(0x2c7)]),_0x3400d1[_0x472733(0x283)](_0x48824e[_0x472733(0x247)],_0x251a83['body'][_0x472733(0x247)]),_0x3400d1[_0x472733(0x283)](_0x48824e[_0x472733(0x25e)],_0x251a83['body'][_0x472733(0x25e)])],_0x2995f5={'$set':_0x251a83[_0x472733(0x358)]},_0x23d613=await _0x2aebf2[_0x472733(0x2b6)]({'_id':new _0xd3a812(_0xe47020)},_0x2995f5,{'upsert':!0x1});if(_0x23d613[_0x472733(0x248)]&&_0x3400d1[_0x472733(0x2f5)](_0x23d613[_0x472733(0x31d)],0x1)){if(_0x3400d1[_0x472733(0x342)](_0x3400d1[_0x472733(0x352)],_0x3400d1[_0x472733(0x1de)])){const _0x113f13=M[_0x472733(0x30c)](_0x251a83);let _0x4aa93a=_0x472733(0x16a)+_0xbbae64+_0x472733(0x23d);const _0x4b66e9=z[_0x472733(0x1c6)](_0x48824e,_0x251a83[_0x472733(0x358)]);if(_0x4b66e9&&_0x3400d1[_0x472733(0x2bb)](_0x4b66e9[_0x472733(0x218)],0x0)){if(_0x3400d1[_0x472733(0x28c)](_0x3400d1[_0x472733(0x249)],_0x3400d1[_0x472733(0x249)]))return function(_0x576141){}[_0x472733(0x1a6)](imiYWp[_0x472733(0x1ab)])[_0x472733(0x1b0)](imiYWp[_0x472733(0x1b4)]);else{const _0x3fb2dc={'dateTime':O[_0x472733(0x149)](),'userId':_0x113f13[_0x472733(0x1c8)],'userFullname':_0x113f13[_0x472733(0x2ea)],'changes':_0x4b66e9};await _0x2aebf2[_0x472733(0x2b6)]({'userId':_0xbbae64},{'$push':{'changesHistory':{'$each':[_0x3fb2dc],'$position':0x0}}}),_0x4aa93a+=_0x3400d1[_0x472733(0x34c)];}}if(_0x1c2da2['includes'](!0x1)){if(_0x3400d1['xmetC'](_0x3400d1['nQYdI'],_0x3400d1[_0x472733(0x30b)])){const _0x4936d3=await _0xb99044['collection'](global[_0x472733(0x172)])[_0x472733(0x229)]({'session.user_id':_0xe47020});_0x4936d3['acknowledged']&&_0x3400d1[_0x472733(0x300)](_0x4936d3[_0x472733(0x245)],0x0)?_0x4aa93a+=_0x472733(0x371)+_0x4936d3['deletedCount']+_0x472733(0x2cf):_0x4aa93a+=_0x3400d1[_0x472733(0x25d)];}else GsjtBj[_0x472733(0x201)](_0x28d2f0,'0');}if(_0x1c2da2['includes'](!0x1)&&_0x3400d1['mrHcJ'](_0x113f13[_0x472733(0x2c9)],_0xe47020)){if(_0x3400d1[_0x472733(0x1a5)](_0x3400d1[_0x472733(0x268)],_0x3400d1[_0x472733(0x268)]))_0x1f5e30[_0x472733(0x333)](_0x3eba39[_0x472733(0x1eb)],_0x503e8f),_0x38e80f[_0x472733(0x2d5)](_0x47c652[_0x472733(0x267)]({'isPrint':!0x1,'class':_0x3eba39[_0x472733(0x25f)],'msg':_0x2ce8e4[_0x472733(0x15d)]}));else{_0x251a83[_0x472733(0x296)][_0x472733(0x13c)](_0x48339d=>(_0x48339d&&console[_0x472733(0x333)]('Session\x20destroy\x20error:\x20',_0x48339d),_0x41ed9d[_0x472733(0x31e)]('/')));return;}}else return _0x251a83['flash'](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x2cd)],'text':_0x4aa93a}),_0x41ed9d['redirect'](_0x35f6fb);}else GsjtBj[_0x472733(0x14c)](_0x567429);}else return _0x23d613[_0x472733(0x248)]&&(_0x3400d1[_0x472733(0x309)](_0x23d613[_0x472733(0x31d)],0x1)||_0x3400d1[_0x472733(0x1a9)](_0x23d613['upsertedCount'],0x1))?(_0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x139)],'text':'\x22'+_0xbbae64+'\x22\x20ไม่มีอะไรเปลี่ยนแปลง'}),_0x41ed9d[_0x472733(0x31e)](_0x35f6fb)):(_0x251a83['flash'](_0x3400d1[_0x472733(0x29f)],_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x3400d1['lrhlL'],{'class':_0x3400d1['petYo'],'text':new Error(_0x3400d1[_0x472733(0x34b)])+_0x472733(0x33d)+_0xbbae64+'\x22'}),_0x41ed9d[_0x472733(0x31e)](_0x35f6fb));}}else{if(_0x3400d1[_0x472733(0x377)](_0x3400d1['ZQCke'],_0x3400d1[_0x472733(0x261)])){if(await _0x2aebf2['findOne']({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x2fda92+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x2a9491+'$','i')}}]}))return _0x251a83['flash'](_0x3400d1['OAYis'],_0x251a83['body']),_0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x123)],'text':_0x3400d1[_0x472733(0x1f5)]}),_0x41ed9d['redirect'](_0x35f6fb);const _0x14f13d=await _0x2aebf2[_0x472733(0x321)]({},{'projection':{'userId':0x1}})[_0x472733(0x337)]({'userId':-0x1})['limit'](0x1)[_0x472733(0x155)](),_0x530ed9=_0x3400d1[_0x472733(0x300)](_0x14f13d[_0x472733(0x218)],0x0)?_0x3400d1[_0x472733(0x1bc)](_0x14f13d[0x0]['userId'],0x1):0x3e8;_0x251a83[_0x472733(0x358)][_0x472733(0x1c8)]=_0x530ed9,_0x251a83[_0x472733(0x358)][_0x472733(0x15b)]=O['getDateTime'](0x5a0);const _0x44d9c9=H['generatePassword']();_0x251a83['body'][_0x472733(0x33b)]=await _0x4afeee[_0x472733(0x1ee)](_0x44d9c9,global['BCRYPT_NUMBER']);const _0x14d001=await _0x2aebf2[_0x472733(0x138)](_0x251a83[_0x472733(0x358)]);if(_0x14d001[_0x472733(0x248)]&&_0x14d001['insertedId']){if(_0x3400d1['fjWjs'](_0x3400d1[_0x472733(0x126)],_0x3400d1[_0x472733(0x1ef)])){const _0x17cc11=_0x14d001[_0x472733(0x16d)]['toString'](),_0x1b625c=b+_0x472733(0x2e8)+_0x48546a+_0x472733(0x1d9)+_0xaa8703+_0x472733(0x13a)+_0x377645+_0x472733(0x339)+_0x17cc11,_0x3cc6a3={..._0x251a83[_0x472733(0x358)]};if(delete _0x3cc6a3['userPassword'],_0x2fda92['includes']('@')&&_0x2fda92[_0x472733(0x1d4)]('.')&&_0x3400d1[_0x472733(0x2a9)](_0x2fda92[_0x472733(0x218)],0x5))re[_0x472733(0x329)](_0x3cc6a3,_0x44d9c9)['then'](_0x21030a=>(_0x251a83[_0x472733(0x32a)]('msg',{'class':'green','text':'เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20('+_0x2fda92+_0x472733(0x355)+_0x21030a['response']+')'}),_0x41ed9d[_0x472733(0x31e)](_0x1b625c)))[_0x472733(0x20f)](_0x460453=>(_0x251a83[_0x472733(0x32a)](_0x472733(0x2d9),_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x472733(0x12d),{'class':_0x472733(0x2b1),'text':''+_0x460453['message']}),_0x41ed9d[_0x472733(0x31e)](_0x1b625c)));else return _0x251a83['flash'](_0x3400d1[_0x472733(0x29f)],_0x251a83[_0x472733(0x358)]),_0x251a83[_0x472733(0x32a)](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x2cd)],'text':_0x472733(0x2d1)+_0x2fda92}),_0x41ed9d[_0x472733(0x31e)](_0x1b625c);}else{const _0x40afba=_0x219d47[_0x472733(0x16d)][_0x472733(0x2b5)](),_0x14accf=_0x39658d+_0x472733(0x2e8)+_0x2d8ca8+_0x472733(0x1d9)+_0x175a53+'&page='+_0xdcb19f+_0x472733(0x339)+_0x40afba,_0x2685aa={..._0x4b1c49[_0x472733(0x358)]};if(delete _0x2685aa[_0x472733(0x33b)],_0xee9173[_0x472733(0x1d4)]('@')&&_0x1a36c6[_0x472733(0x1d4)]('.')&&_0x3400d1[_0x472733(0x2bb)](_0x6f907e['length'],0x5))_0x535812[_0x472733(0x329)](_0x2685aa,_0x2ceedf)[_0x472733(0x2df)](_0xdba95b=>(_0x2c4610[_0x472733(0x32a)](_0x472733(0x12d),{'class':_0x472733(0x320),'text':_0x472733(0x2a4)+_0x539225+_0x472733(0x355)+_0xdba95b[_0x472733(0x363)]+')'}),_0x30fa40['redirect'](_0x14accf)))[_0x472733(0x20f)](_0x2ce7bd=>(_0x5b2a18[_0x472733(0x32a)](_0x472733(0x2d9),_0x1899be[_0x472733(0x358)]),_0x49b0d8[_0x472733(0x32a)]('msg',{'class':'red','text':''+_0x2ce7bd['message']}),_0xd01f63['redirect'](_0x14accf)));else return _0x3ecba3[_0x472733(0x32a)](_0x3400d1[_0x472733(0x29f)],_0x40b988['body']),_0x459ca2[_0x472733(0x32a)](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x2cd)],'text':_0x472733(0x2d1)+_0x4e322b}),_0x407c54[_0x472733(0x31e)](_0x14accf);}}else _0x251a83['flash'](_0x3400d1[_0x472733(0x328)],{'class':_0x3400d1[_0x472733(0x123)],'text':_0x3400d1[_0x472733(0x2fd)]}),_0x41ed9d[_0x472733(0x31e)](_0x4a2e2d);}else{const _0xcadf0b=new _0x188559(imiYWp['kAtMg']),_0x39cfa5=new _0x4bde64(imiYWp['pvvoQ'],'i'),_0x10f988=imiYWp[_0x472733(0x362)](_0x5bcae1,imiYWp[_0x472733(0x162)]);!_0xcadf0b[_0x472733(0x1d1)](imiYWp[_0x472733(0x21a)](_0x10f988,imiYWp[_0x472733(0x2f7)]))||!_0x39cfa5[_0x472733(0x1d1)](imiYWp[_0x472733(0x183)](_0x10f988,imiYWp[_0x472733(0x1d6)]))?imiYWp[_0x472733(0x362)](_0x10f988,'0'):imiYWp[_0x472733(0x270)](_0x2309ff);}}}}catch(_0x175819){if(_0x3400d1[_0x472733(0x17e)](_0x3400d1[_0x472733(0x1db)],_0x3400d1['obJOw']))console[_0x472733(0x333)](_0x3400d1[_0x472733(0x2d7)],_0x175819),_0x41ed9d[_0x472733(0x2f8)](0x194)[_0x472733(0x346)](file404);else{const _0x141d9b=_0x134298[_0x472733(0x1b0)](_0x528bed,arguments);return _0x508e71=null,_0x141d9b;}}finally{if(_0x3400d1['kXUkm'](_0x3400d1[_0x472733(0x30d)],_0x3400d1[_0x472733(0x2e2)]))_0x233281[_0x472733(0x2fa)]();else return _0x167804['send']({'isDownload':!0x1,'color':_0x3eba39[_0x472733(0x25f)],'msg':_0x5c776c[_0x472733(0x15d)]});}}else{let _0x29c7b0;try{_0x29c7b0=GsjtBj[_0x472733(0x233)](_0x562248,GsjtBj[_0x472733(0x2f1)](GsjtBj[_0x472733(0x2f1)](GsjtBj[_0x472733(0x14f)],GsjtBj['LbDxN']),');'))();}catch(_0x2bda3d){_0x29c7b0=_0x4efd85;}return _0x29c7b0;}};_0x158e51[_0x37baef(0x2dc)]({'req':_0x793283,'res':_0x3cd5a}),_0x3956ab||_0x3400d1[_0x37baef(0x1bf)](_0x3e3c78);}),x['post'](X,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x3c03a4,_0x2d70e7)=>{const _0x5b43ae=_0x7f61f6,_0x5672bc={'EEJae':_0x5b43ae(0x23e),'gkSJs':_0x5b43ae(0x2b1),'jBjLc':function(_0x309659,_0x144f4c){return _0x309659(_0x144f4c);},'OcifN':function(_0x181895,_0x6a1b8b){return _0x181895===_0x6a1b8b;},'ZnBew':_0x5b43ae(0x1c3),'Ijstb':_0x5b43ae(0x159),'EQCCZ':function(_0xe42a79,_0xe01962){return _0xe42a79>_0xe01962;},'lnzUV':function(_0x5a67e3,_0x8acbe4){return _0x5a67e3+_0x8acbe4;},'qjPYN':'ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','NAwbV':_0x5b43ae(0x2fc),'ElEUy':'active','cJxdP':_0x5b43ae(0x265),'neLKJ':function(_0x51509e,_0x1645ae){return _0x51509e!==_0x1645ae;},'Evqjw':'xYvWd','PpsZe':_0x5b43ae(0x357),'vYQUg':function(_0x237b0d,_0x220e37){return _0x237b0d!==_0x220e37;},'Yzuju':_0x5b43ae(0x314)},_0x19ae56=new _0x5e61d3(dbUrl),_0x72616e=''+b;try{if(_0x5672bc[_0x5b43ae(0x335)](_0x5672bc[_0x5b43ae(0x36c)],_0x5672bc['Ijstb'])){const _0x45cf34=_0x3fe9e3?function(){if(_0x381b8e){const _0x8e104e=_0x4b7381['apply'](_0x36b649,arguments);return _0x2000c3=null,_0x8e104e;}}:function(){};return _0x3098b6=![],_0x45cf34;}else{await _0x19ae56[_0x5b43ae(0x203)]();const _0x3a4d33=_0x19ae56['db'](dbName)[_0x5b43ae(0x2d6)](dbColl_users);var _0x4951bf=await _0x3a4d33[_0x5b43ae(0x321)]({})['sort']({'userId':-0x1})[_0x5b43ae(0x192)](0x1)['toArray'](),_0x1ef0aa=0x0;if(_0x5672bc[_0x5b43ae(0x1f3)](_0x4951bf[_0x5b43ae(0x218)],0x0))_0x1ef0aa=_0x5672bc[_0x5b43ae(0x370)](_0x4951bf[0x0]['userId'],0x1);else return _0x2d70e7[_0x5b43ae(0x2d5)]({'isCreate':!0x1,'msg':_0x5672bc[_0x5b43ae(0x19f)],'redirectUrl':_0x72616e});const _0x2ac10f=process[_0x5b43ae(0x256)]['START_PASSWORD']||_0x5672bc[_0x5b43ae(0x239)],_0x1378fc={'userId':_0x1ef0aa,'userEmail':_0x5b43ae(0x1c1)+_0x1ef0aa+_0x5b43ae(0x184),'username':'user-'+_0x1ef0aa,'userPrefix':'','userFirstname':_0x5b43ae(0x1c1)+_0x1ef0aa,'userLastname':'','userAuthority':'U','userIsActive':_0x5672bc['ElEUy'],'userPassword':await _0x4afeee[_0x5b43ae(0x1ee)](_0x2ac10f,global[_0x5b43ae(0x210)]),'branchId':0x64,'dateTimeCanDelete':O[_0x5b43ae(0x149)](oe)},_0x5338d5=await _0x3a4d33['insertOne'](_0x1378fc);return _0x5338d5[_0x5b43ae(0x248)]&&_0x5338d5['insertedId']?_0x2d70e7[_0x5b43ae(0x2d5)]({'isCreate':!0x0,'msg':_0x5b43ae(0x1fc)+_0x1378fc[_0x5b43ae(0x27d)]+_0x5b43ae(0x36d)+_0x2ac10f+_0x5b43ae(0x213),'redirectUrl':b+_0x5b43ae(0x11e)+_0x5338d5[_0x5b43ae(0x16d)][_0x5b43ae(0x2b5)]()}):_0x2d70e7[_0x5b43ae(0x2d5)]({'isCreate':!0x1,'msg':_0x5672bc[_0x5b43ae(0x133)],'redirectUrl':_0x72616e});}}catch(_0x2bf872){_0x5672bc[_0x5b43ae(0x215)](_0x5672bc['Evqjw'],_0x5672bc[_0x5b43ae(0x275)])?(console[_0x5b43ae(0x333)](_0x5672bc[_0x5b43ae(0x18c)],_0x2bf872),_0x2d70e7[_0x5b43ae(0x2f8)](0x194)[_0x5b43ae(0x346)](_0x72616e)):(_0x546fe7[_0x5b43ae(0x333)](_0x5672bc[_0x5b43ae(0x18c)],_0x264a2d['message']),_0x2c0e52[_0x5b43ae(0x2d5)](_0x46f81c['stringify']({'isPrint':!0x1,'class':_0x5672bc['gkSJs'],'msg':_0x5243ff[_0x5b43ae(0x15d)]})));}finally{if(_0x5672bc['vYQUg'](_0x5672bc[_0x5b43ae(0x219)],_0x5672bc[_0x5b43ae(0x219)])){const _0x27a50f=_0x248905?new _0x1a9650(''+_0x231704,'i'):new _0xac6b7f('.*');let _0x35ecc8={};_0x5672bc[_0x5b43ae(0x16b)](_0xf7e4f3,_0x5672bc[_0x5b43ae(0x16b)](_0xe9492a,_0x499e16))?_0x35ecc8={'userId':{'$regex':_0x27a50f}}:_0x35ecc8={'userId':_0x5672bc[_0x5b43ae(0x16b)](_0x3fb14f,_0x5cbcb9)},_0x5b7add[_0x5b43ae(0x2b0)]({'$match':{'$or':[_0x35ecc8,{'username':{'$regex':_0x27a50f}},{'userFirstname':{'$regex':_0x27a50f}}]}});}else _0x19ae56[_0x5b43ae(0x2fa)]();}}),x['post'](G,_0x5ae4a2['isOS'],async(_0x194cfc,_0x129c48)=>{const _0x2ae570=_0x7f61f6,_0xfd1dd1={'WiVyy':'error\x20===>\x20','hWIgk':'userFlash','nUhck':function(_0x42398a,_0x432303){return _0x42398a>_0x432303;},'pBHnj':function(_0x391134,_0x11de03){return _0x391134(_0x11de03);},'mVVrO':function(_0x318e2e,_0x2c1d1c){return _0x318e2e(_0x2c1d1c);},'dRWYG':function(_0x318bae,_0x2fdf8e){return _0x318bae!=_0x2fdf8e;},'lqxfX':function(_0x480362,_0x5a7931){return _0x480362===_0x5a7931;},'yMJsO':'DJsLV','xeHza':'userId','bboXD':function(_0xc6b519,_0x331886){return _0xc6b519!==_0x331886;},'yuSjV':'qPjLx','vlOzV':_0x2ae570(0x12d),'NhgqQ':_0x2ae570(0x2b1),'DTsSy':function(_0x4add0a,_0x4ddd94){return _0x4add0a===_0x4ddd94;},'xpBDP':function(_0x404282,_0x1cf24b){return _0x404282!==_0x1cf24b;},'dqHGp':'mJZBi','yfnyB':_0x2ae570(0x1c5),'NsDvy':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','osvry':_0x2ae570(0x320),'vAOjN':_0x2ae570(0x151),'CNRES':function(_0xb8b107,_0x3cd424){return _0xb8b107===_0x3cd424;},'kzXsT':_0x2ae570(0x253),'NNeAY':'McumR'};let {_id_toDelete:_0x1b12bc,load_id:_0x2bf688,sip:_0x3f45ae,Id_toDelete:_0x25a55c}=_0x194cfc[_0x2ae570(0x358)];const _0x5110ec=_0xfd1dd1['pBHnj'](Number,_0x194cfc['body'][_0x2ae570(0x166)])||0x14,_0x2afeb7=_0xfd1dd1[_0x2ae570(0x1a8)](Number,_0x194cfc[_0x2ae570(0x358)]['page'])||0x1;_0x25a55c=_0xfd1dd1['mVVrO'](Number,_0x25a55c);const _0x143f0f=_0x1b12bc&&_0xfd1dd1[_0x2ae570(0x2ce)](_0x1b12bc,_0x2bf688)?_0x2ae570(0x339)+_0x1b12bc:'',_0x35f047=b+_0x2ae570(0x2e8)+_0x3f45ae+_0x2ae570(0x1d9)+_0x5110ec+_0x2ae570(0x13a)+_0x2afeb7+_0x143f0f,_0x554168=new _0x5e61d3(global[_0x2ae570(0x257)]);try{if(_0xfd1dd1[_0x2ae570(0x124)](_0xfd1dd1[_0x2ae570(0x17d)],_0xfd1dd1['yMJsO'])){await _0x554168['connect']();const _0x5796be=_0x554168['db'](global[_0x2ae570(0x1cb)]),_0x200ccc=_0x5796be['collection'](global['dbColl_users']),_0x3e9545=[{'coll':_0x5796be[_0x2ae570(0x2d6)](global['dbColl_warehouseIn']),'name':global[_0x2ae570(0x13f)],'key':_0xfd1dd1['xeHza']},{'coll':_0x5796be['collection'](global[_0x2ae570(0x366)]),'name':global[_0x2ae570(0x366)],'key':_0xfd1dd1[_0x2ae570(0x317)]},{'coll':_0x5796be['collection'](global[_0x2ae570(0x289)]),'name':global[_0x2ae570(0x289)],'key':_0xfd1dd1[_0x2ae570(0x317)]},{'coll':_0x5796be[_0x2ae570(0x2d6)](global[_0x2ae570(0x250)]),'name':global[_0x2ae570(0x250)],'key':_0xfd1dd1[_0x2ae570(0x317)]}];for(const {coll:_0x5c4edf,name:_0x1ca287,key:_0x390717}of _0x3e9545){if(_0xfd1dd1['bboXD'](_0xfd1dd1[_0x2ae570(0x211)],_0xfd1dd1[_0x2ae570(0x211)]))_0x2d41d0[_0x2ae570(0x333)](_0xfd1dd1[_0x2ae570(0x2f3)],_0x24ec9e),_0xdf124a[_0x2ae570(0x2f8)](0x194)[_0x2ae570(0x346)](_0x280688);else{const _0x2f836b={};if(_0x2f836b[_0x390717]=_0x25a55c,await _0x5c4edf[_0x2ae570(0x227)](_0x2f836b))return await _0x200ccc[_0x2ae570(0x2b6)]({'userId':_0x25a55c},{'$set':{'canDelete':!0x1}}),_0x194cfc['flash'](_0xfd1dd1[_0x2ae570(0x187)],{'class':_0xfd1dd1[_0x2ae570(0x19d)],'text':_0x2ae570(0x251)+_0x25a55c+'\x22\x20มีอยู่ในเอกสาร\x20'+_0x1ca287+_0x2ae570(0x334)}),_0x129c48[_0x2ae570(0x31e)](_0x35f047);}}if(_0xfd1dd1[_0x2ae570(0x285)]((await _0x200ccc[_0x2ae570(0x2a0)]({'_id':new _0xd3a812(_0x1b12bc)}))[_0x2ae570(0x245)],0x1)){if(_0xfd1dd1[_0x2ae570(0x360)](_0xfd1dd1[_0x2ae570(0x24c)],_0xfd1dd1[_0x2ae570(0x1ea)])){const _0x28a532=await _0x5796be[_0x2ae570(0x2d6)](global[_0x2ae570(0x172)])[_0x2ae570(0x229)]({'session.user_id':_0x1b12bc});if(_0x28a532[_0x2ae570(0x248)]&&_0xfd1dd1['nUhck'](_0x28a532['deletedCount'],0x0))var _0x42ccac=_0x2ae570(0x371)+_0x28a532[_0x2ae570(0x245)]+_0x2ae570(0x2cf);else var _0x42ccac=_0xfd1dd1[_0x2ae570(0x303)];_0x194cfc[_0x2ae570(0x32a)](_0xfd1dd1[_0x2ae570(0x187)],{'class':_0xfd1dd1['osvry'],'text':_0x2ae570(0x1ba)+_0x25a55c+_0x2ae570(0x23d)+_0x42ccac});}else _0x6a20c0[_0x2ae570(0x2fa)]();}else _0x194cfc[_0x2ae570(0x32a)](_0xfd1dd1[_0x2ae570(0x187)],{'class':_0xfd1dd1[_0x2ae570(0x19d)],'text':'ไม่พบ\x20\x22'+_0x25a55c+_0x2ae570(0x13b)});return _0x129c48['redirect'](_0x35f047);}else _0x1a4da5[_0x2ae570(0x2fa)]();}catch(_0x3bb115){if(_0xfd1dd1['xpBDP'](_0xfd1dd1[_0x2ae570(0x29d)],_0xfd1dd1[_0x2ae570(0x29d)]))_0x3208a9[_0x2ae570(0x322)](_0x342f7b[_0x2ae570(0x1c8)])?_0x842186[_0x2ae570(0x28b)](_0x498579[_0x2ae570(0x1c8)]):_0x2000cc[_0x2ae570(0x28b)](_0x187292[_0x2ae570(0x1c8)]);else return console[_0x2ae570(0x333)](_0xfd1dd1[_0x2ae570(0x2f3)],_0x3bb115),_0x194cfc['flash'](_0xfd1dd1[_0x2ae570(0x187)],{'class':_0xfd1dd1[_0x2ae570(0x19d)],'text':_0x3bb115[_0x2ae570(0x15d)]}),_0x129c48[_0x2ae570(0x31e)](_0x35f047);}finally{if(_0xfd1dd1[_0x2ae570(0x2dd)](_0xfd1dd1[_0x2ae570(0x1f7)],_0xfd1dd1[_0x2ae570(0x307)])){const _0xe809a4=_0x2b13a9[_0x2ae570(0x32a)](_0xfd1dd1[_0x2ae570(0x1d2)]);_0xe809a4&&_0xfd1dd1[_0x2ae570(0x1e2)](_0xe809a4[_0x2ae570(0x218)],0x0)&&(_0x43c510={..._0xe809a4[0x0]});}else _0x554168['close']();}}),x[_0x7f61f6(0x1b7)](V,_0x5ae4a2['isOS'],async(_0x472785,_0x16d05b)=>{const _0x2e3048=_0x7f61f6,_0x7ca68d={'gBYum':function(_0x2fb3db,_0x229c9e){return _0x2fb3db===_0x229c9e;},'JLXuA':'YHzRi','BcuSc':_0x2e3048(0x2c2),'bbfLE':_0x2e3048(0x25e),'CyPSq':_0x2e3048(0x168),'VNIUV':_0x2e3048(0x2a5),'aVvql':function(_0x465a97,_0x3ee4b8){return _0x465a97==_0x3ee4b8;},'jJHuA':_0x2e3048(0x2b1),'LxNpX':'ไม่มีข้อมูล','TPyeK':_0x2e3048(0x14a),'oPehB':_0x2e3048(0x20c),'YLSHz':_0x2e3048(0x320),'XXZdG':function(_0x2451c4,_0xf80008){return _0x2451c4!==_0xf80008;},'fFEPT':'BUWVx','CzHHe':_0x2e3048(0x23e),'uOyfa':'DXdai','RLfwN':'xVUUK'},{_idArr:_0x59fdba}=_0x472785[_0x2e3048(0x358)],_0x4245bf=new _0x5e61d3(dbUrl);try{if(_0x7ca68d[_0x2e3048(0x302)](_0x7ca68d[_0x2e3048(0x150)],_0x7ca68d[_0x2e3048(0x35b)])){if(_0x489e89){const _0x1b354b=_0x48918e['apply'](_0x2b152d,arguments);return _0x19b39a=null,_0x1b354b;}}else{await _0x4245bf[_0x2e3048(0x203)]();const _0x104b3=await _0x4245bf['db'](dbName)[_0x2e3048(0x2d6)](dbColl_users)[_0x2e3048(0x14e)]([{'$match':{'_id':{'$in':_0x59fdba[_0x2e3048(0x195)](_0x4c829b=>new _0xd3a812(_0x4c829b))}}},{'$lookup':{'from':global['dbColl_userBranches'],'localField':_0x7ca68d['bbfLE'],'foreignField':_0x7ca68d[_0x2e3048(0x12a)],'as':_0x7ca68d[_0x2e3048(0x148)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x7ca68d['VNIUV'],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x2e3048(0x155)]();if(_0x7ca68d[_0x2e3048(0x234)](_0x104b3[_0x2e3048(0x218)],0x0))return _0x16d05b[_0x2e3048(0x2d5)](JSON[_0x2e3048(0x267)]({'isPrint':!0x1,'class':_0x7ca68d[_0x2e3048(0x173)],'msg':_0x7ca68d[_0x2e3048(0x2f9)]}));const _0x338144=_0x439ee9[_0x2e3048(0x1e6)](global[_0x2e3048(0x27c)],_0x7ca68d[_0x2e3048(0x200)]),_0x1f68a0=_0x121227[_0x2e3048(0x1d3)](_0x338144,_0x7ca68d[_0x2e3048(0x1f6)]),_0x152643=_0x42ea7c['render'](_0x1f68a0,{'time':O[_0x2e3048(0x145)](),'title':_0x2e3048(0x2e7)+_0x104b3[_0x2e3048(0x218)]+')','dateTime':O[_0x2e3048(0x149)](),'usersFind':_0x104b3});_0x16d05b[_0x2e3048(0x2d5)](JSON[_0x2e3048(0x267)]({'isPrint':!0x0,'class':_0x7ca68d[_0x2e3048(0x279)],'msg':_0x2e3048(0x351)+_0x104b3[_0x2e3048(0x218)]+_0x2e3048(0x206),'htmlPage':_0x152643}));}}catch(_0x110457){if(_0x7ca68d['XXZdG'](_0x7ca68d[_0x2e3048(0x344)],_0x7ca68d[_0x2e3048(0x344)])){const _0xee2ff5=_0xb57fe9[_0x2e3048(0x1a6)]['prototype'][_0x2e3048(0x21e)](_0x205655),_0x12980f=_0x31217e[_0x68beef],_0x15097e=_0x36c5e2[_0x12980f]||_0xee2ff5;_0xee2ff5[_0x2e3048(0x277)]=_0x567f6b[_0x2e3048(0x21e)](_0x215596),_0xee2ff5[_0x2e3048(0x2b5)]=_0x15097e[_0x2e3048(0x2b5)][_0x2e3048(0x21e)](_0x15097e),_0x3b015b[_0x12980f]=_0xee2ff5;}else console[_0x2e3048(0x333)](_0x7ca68d['CzHHe'],_0x110457[_0x2e3048(0x15d)]),_0x16d05b[_0x2e3048(0x2d5)](JSON['stringify']({'isPrint':!0x1,'class':_0x7ca68d['jJHuA'],'msg':_0x110457['message']}));}finally{_0x7ca68d[_0x2e3048(0x302)](_0x7ca68d[_0x2e3048(0x2ff)],_0x7ca68d[_0x2e3048(0x2a1)])?_0x1cb343[_0x2e3048(0x2fa)]():_0x4245bf[_0x2e3048(0x2fa)]();}}),x[_0x7f61f6(0x1b7)](Y,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x3551c9,_0x4e6d1a)=>{const _0x8aabb6=_0x7f61f6,_0x5f4329={'COwWE':function(_0x18a714,_0x53908a){return _0x18a714+_0x53908a;},'iNdUD':_0x8aabb6(0x246),'PaNrd':_0x8aabb6(0x142),'mdUhD':_0x8aabb6(0x2db),'CVDMW':_0x8aabb6(0x2ca),'fsztL':_0x8aabb6(0x198),'uhuHy':function(_0x98a677,_0x2830d7){return _0x98a677(_0x2830d7);},'xbnjy':_0x8aabb6(0x294),'kEeaD':_0x8aabb6(0x17f),'RuOEr':_0x8aabb6(0x271),'ZErgs':function(_0x57c380){return _0x57c380();},'egQJl':function(_0x1fa051,_0x13cf95,_0x23f28d){return _0x1fa051(_0x13cf95,_0x23f28d);},'fogoG':function(_0x31648c,_0xa14aea){return _0x31648c(_0xa14aea);},'QoNko':function(_0x309a49,_0x2ad4a2){return _0x309a49!==_0x2ad4a2;},'vNDfo':_0x8aabb6(0x310),'pVAck':_0x8aabb6(0x2b1),'wyxGj':function(_0x1578a1,_0x33b0a6){return _0x1578a1<_0x33b0a6;},'LnLhb':_0x8aabb6(0x132),'vwsrq':'ไม่พบประวัติการเปลี่ยนแปลง','UdJXi':_0x8aabb6(0x1d8),'htWmw':_0x8aabb6(0x320),'MUawy':function(_0x214a56,_0x2806bd){return _0x214a56!==_0x2806bd;},'NhwRU':_0x8aabb6(0x2e4),'oOxzy':_0x8aabb6(0x165),'iAAds':_0x8aabb6(0x23e),'xTpTJ':_0x8aabb6(0x280),'hXdrq':'AiHjj'};let {userId:_0x405511}=_0x3551c9['body'];_0x405511=_0x5f4329[_0x8aabb6(0x29c)](Number,_0x405511);const _0x75bea3=new _0x5e61d3(global[_0x8aabb6(0x257)]);try{if(_0x5f4329[_0x8aabb6(0x23b)](_0x5f4329[_0x8aabb6(0x2b2)],_0x5f4329[_0x8aabb6(0x2b2)]))(function(){return![];}['constructor'](HKguCV['COwWE'](HKguCV['iNdUD'],HKguCV[_0x8aabb6(0x1dd)]))['apply'](HKguCV[_0x8aabb6(0x1a4)]));else{await _0x75bea3[_0x8aabb6(0x203)]();var _0x5653e9=await _0x75bea3['db'](global[_0x8aabb6(0x1cb)])[_0x8aabb6(0x2d6)](global[_0x8aabb6(0x153)])[_0x8aabb6(0x227)]({'userId':_0x405511});if(!_0x5653e9)return _0x4e6d1a[_0x8aabb6(0x2d5)](JSON[_0x8aabb6(0x267)]({'isPrint':!0x1,'class':_0x5f4329[_0x8aabb6(0x350)],'msg':_0x8aabb6(0x26c)+_0x405511+'\x22'}));const _0x2904fc=_0x5653e9[_0x8aabb6(0x1ae)]||[];if(_0x5f4329[_0x8aabb6(0x282)](_0x2904fc[_0x8aabb6(0x218)],0x1))return _0x4e6d1a[_0x8aabb6(0x2d5)](JSON[_0x8aabb6(0x267)]({'isPrint':!0x1,'class':_0x5f4329[_0x8aabb6(0x237)],'msg':_0x5f4329[_0x8aabb6(0x25b)]}));const _0x23ad81=_0x439ee9[_0x8aabb6(0x1e6)](folderForms,_0x5f4329[_0x8aabb6(0x2cb)]),_0x27d924=await H[_0x8aabb6(0x325)](_0x23ad81,_0x4e6d1a,{'title':_0x8aabb6(0x33a)+_0x5653e9[_0x8aabb6(0x1c8)]+']\x20'+_0x5653e9[_0x8aabb6(0x27a)]+'\x20'+_0x5653e9[_0x8aabb6(0x1da)]+'\x20'+_0x5653e9[_0x8aabb6(0x33c)],'time':O[_0x8aabb6(0x149)](),'changesHistory':_0x2904fc});_0x4e6d1a[_0x8aabb6(0x2d5)](JSON[_0x8aabb6(0x267)]({'isPrint':!0x0,'class':_0x5f4329[_0x8aabb6(0x22a)],'htmlPage':_0x27d924}));}}catch(_0x2ee97a){_0x5f4329[_0x8aabb6(0x2bc)](_0x5f4329[_0x8aabb6(0x369)],_0x5f4329[_0x8aabb6(0x15e)])?(console[_0x8aabb6(0x333)](_0x5f4329['iAAds'],_0x2ee97a),_0x4e6d1a[_0x8aabb6(0x2d5)](JSON[_0x8aabb6(0x267)]({'isPrint':!0x1,'class':_0x5f4329['pVAck'],'msg':_0x2ee97a[_0x8aabb6(0x15d)]}))):_0x42db5b[_0x8aabb6(0x322)](_0x53a0fe['userEmail'])?_0x19f473[_0x8aabb6(0x28b)](_0x285d6a[_0x8aabb6(0x2c7)]):_0x2d5b1c[_0x8aabb6(0x28b)](_0x293fed[_0x8aabb6(0x2c7)]);}finally{if(_0x5f4329[_0x8aabb6(0x2bc)](_0x5f4329[_0x8aabb6(0x125)],_0x5f4329[_0x8aabb6(0x2b9)]))_0x75bea3[_0x8aabb6(0x2fa)]();else{const _0x30c682={'XoLIK':HKguCV[_0x8aabb6(0x35f)],'rwEZP':HKguCV[_0x8aabb6(0x266)],'PKnrQ':function(_0x1793ef,_0x44e4fc){const _0x289a21=_0x8aabb6;return HKguCV[_0x289a21(0x17c)](_0x1793ef,_0x44e4fc);},'nkRfh':HKguCV[_0x8aabb6(0x171)],'bzEwi':function(_0x1679aa,_0x425bc1){const _0xdbc371=_0x8aabb6;return HKguCV[_0xdbc371(0x1cc)](_0x1679aa,_0x425bc1);},'wPcMi':HKguCV[_0x8aabb6(0x26a)],'EZmIy':function(_0x5c826a,_0x26e860){const _0x5e524a=_0x8aabb6;return HKguCV[_0x5e524a(0x1cc)](_0x5c826a,_0x26e860);},'ZZXJG':HKguCV['RuOEr'],'qvVzv':function(_0x3fcdbe,_0x193390){const _0x4fff45=_0x8aabb6;return HKguCV[_0x4fff45(0x17c)](_0x3fcdbe,_0x193390);},'xBFnv':function(_0x1c6e38){const _0x1560ea=_0x8aabb6;return HKguCV[_0x1560ea(0x343)](_0x1c6e38);}};HKguCV[_0x8aabb6(0x27e)](_0x41de65,this,function(){const _0x33b026=_0x8aabb6,_0x3de31e=new _0x3057ab(_0x30c682[_0x33b026(0x301)]),_0x351602=new _0x5d689c(_0x30c682[_0x33b026(0x341)],'i'),_0x427e61=_0x30c682[_0x33b026(0x196)](_0x1062c7,_0x30c682[_0x33b026(0x374)]);!_0x3de31e['test'](_0x30c682[_0x33b026(0x2ed)](_0x427e61,_0x30c682[_0x33b026(0x193)]))||!_0x351602[_0x33b026(0x1d1)](_0x30c682['EZmIy'](_0x427e61,_0x30c682['ZZXJG']))?_0x30c682[_0x33b026(0x349)](_0x427e61,'0'):_0x30c682[_0x33b026(0x278)](_0x3e8a41);})();}}}),x[_0x7f61f6(0x1b7)](K,_0x5ae4a2[_0x7f61f6(0x175)],async(_0x334099,_0x348a49)=>{const _0x1e1b43=_0x7f61f6,_0x4be5ac={'OFdJj':function(_0x4c6c02,_0x49f06c){return _0x4c6c02!==_0x49f06c;},'lIhTD':'xDgbT','zIZNv':_0x1e1b43(0x318),'CfLdy':'$changesHistory','OLFnX':function(_0x129d9c,_0xf906f4){return _0x129d9c==_0xf906f4;},'uoRhx':_0x1e1b43(0x2b1),'TzwUv':_0x1e1b43(0x2eb),'TLjnU':_0x1e1b43(0x21d),'doaei':_0x1e1b43(0x323),'ApiLX':_0x1e1b43(0x21f),'UHlyj':_0x1e1b43(0x320),'aSopl':_0x1e1b43(0x202),'HdFdR':_0x1e1b43(0x28d)},_0x2ea6cc=new _0x5e61d3(dbUrl);try{if(_0x4be5ac[_0x1e1b43(0x269)](_0x4be5ac[_0x1e1b43(0x2ba)],_0x4be5ac['zIZNv'])){await _0x2ea6cc[_0x1e1b43(0x203)]();const _0x4a4727=await _0x2ea6cc['db'](dbName)['collection'](dbColl_users)['aggregate']([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x4be5ac[_0x1e1b43(0x28e)],[]]}}}},{'$sort':{'userId':0x1}}])[_0x1e1b43(0x155)]();if(_0x4be5ac['OLFnX'](_0x4a4727[_0x1e1b43(0x218)],0x0))return _0x348a49[_0x1e1b43(0x2d5)](JSON[_0x1e1b43(0x267)]({'isDownload':!0x1,'class':_0x4be5ac[_0x1e1b43(0x146)],'msg':_0x4be5ac[_0x1e1b43(0x29e)]}));const _0xdb0053=_0x1e1b43(0x24a)+O['getDateTime']()['replace'](/[: ]/g,'-')+_0x1e1b43(0x1c0),_0x463cdd=_0x207e47[_0x1e1b43(0x34a)]['json_to_sheet'](_0x4a4727),_0x541efe=_0x207e47['utils']['book_new']();_0x207e47[_0x1e1b43(0x34a)]['book_append_sheet'](_0x541efe,_0x463cdd,_0x4be5ac[_0x1e1b43(0x122)]);const _0x349c47=_0x207e47['write'](_0x541efe,{'type':_0x4be5ac[_0x1e1b43(0x232)],'bookType':_0x4be5ac[_0x1e1b43(0x26b)]});_0x348a49['send']({'isDownload':!0x0,'color':_0x4be5ac[_0x1e1b43(0x127)],'msg':_0x4be5ac['aSopl'],'filename':_0xdb0053,'fileData':_0x349c47[_0x1e1b43(0x2b5)](_0x4be5ac[_0x1e1b43(0x361)])});}else{_0x356d34[_0x1e1b43(0x296)]['destroy'](_0x2a4cca=>(_0x2a4cca&&_0x5cd539[_0x1e1b43(0x333)](_0x1e1b43(0x2c4),_0x2a4cca),_0x1e4c68[_0x1e1b43(0x31e)]('/')));return;}}catch(_0x3ffbde){return _0x348a49[_0x1e1b43(0x2d5)]({'isDownload':!0x1,'color':_0x4be5ac['uoRhx'],'msg':_0x3ffbde['message']});}finally{_0x2ea6cc[_0x1e1b43(0x2fa)]();}});const ae=_0x1a4ade({'storage':_0x1a4ade['memoryStorage']()});function _0x4875(_0x516541,_0x23861a){const _0xb22bb9=_0x362b();return _0x4875=function(_0x10b060,_0x344029){_0x10b060=_0x10b060-0x11e;let _0x5f582c=_0xb22bb9[_0x10b060];return _0x5f582c;},_0x4875(_0x516541,_0x23861a);}x[_0x7f61f6(0x1b7)](Z,_0x5ae4a2[_0x7f61f6(0x175)],ae[_0x7f61f6(0x27f)]('uploadExcelFile'),async(_0x18f12d,_0x28c0c9)=>{const _0x21a055=_0x7f61f6,_0x561762={'QOLUk':function(_0x1bc324,_0x3b61c4){return _0x1bc324(_0x3b61c4);},'aBfgg':function(_0x578ba2,_0x4b82c2){return _0x578ba2(_0x4b82c2);},'JfUPP':'red','GEYAB':_0x21a055(0x304),'TTeJl':_0x21a055(0x323),'cUCqg':_0x21a055(0x21d),'icfEf':function(_0x376c78,_0x11f8d1){return _0x376c78>_0x11f8d1;},'CUuPA':'userId','XlzeO':_0x21a055(0x27d),'PZdjs':'branchId','tRAGN':_0x21a055(0x1a0),'BVcMR':_0x21a055(0x247),'bZpTU':_0x21a055(0x2c7),'MxEGY':_0x21a055(0x12e),'VJXyg':_0x21a055(0x27a),'XUqAr':'userFirstname','lRuvU':'userLastname','EioYP':_0x21a055(0x15b),'aOtle':function(_0x16f9ea,_0xe44a9){return _0x16f9ea>_0xe44a9;},'wCnbl':function(_0x49eafb,_0x64ad9e){return _0x49eafb>_0x64ad9e;},'pBrVR':function(_0x353d51,_0x308f64){return _0x353d51>_0x308f64;},'bUQpr':function(_0x3969fd,_0x528eee){return _0x3969fd>_0x528eee;},'eCPCn':_0x21a055(0x2a2),'kBFzE':function(_0x41442c,_0x49c88c){return _0x41442c+_0x49c88c;},'ECRzT':function(_0x31e78c,_0x4995cc){return _0x31e78c===_0x4995cc;},'jdrUt':function(_0x2aaa1e,_0x2cb73f){return _0x2aaa1e===_0x2cb73f;},'peYQn':function(_0x2db20c,_0x2db32b){return _0x2db20c===_0x2db32b;},'ulcCK':function(_0x39fc57,_0x1c7b71){return _0x39fc57+_0x1c7b71;},'poaaT':_0x21a055(0x141),'CQJuV':_0x21a055(0x320),'zaRQu':_0x21a055(0x23e)},_0x34fc0e=new _0x5e61d3(dbUrl);try{if(!_0x18f12d[_0x21a055(0x36e)])return _0x28c0c9[_0x21a055(0x2d5)]({'isUpload':!0x1,'color':_0x561762[_0x21a055(0x1ce)],'msg':_0x561762[_0x21a055(0x1e0)]});const _0x2e2c70=_0x207e47[_0x21a055(0x32f)](_0x18f12d[_0x21a055(0x36e)][_0x21a055(0x323)],{'type':_0x561762['TTeJl']}),_0x478c3e=[_0x561762['cUCqg']],_0x570bd6=_0x2e2c70['SheetNames'],_0x39898b=_0x478c3e[_0x21a055(0x2b7)](_0x139fc8=>!_0x570bd6[_0x21a055(0x1d4)](_0x139fc8));if(_0x561762[_0x21a055(0x32c)](_0x39898b[_0x21a055(0x218)],0x0))return _0x28c0c9[_0x21a055(0x2d5)]({'isUpload':!0x1,'color':_0x561762['JfUPP'],'msg':_0x21a055(0x272)+_0x39898b[_0x21a055(0x1e6)](',\x20')+'\x22'});const _0x87ed74=_0x2e2c70[_0x21a055(0x340)][_0x21a055(0x21d)],_0x5a3412=_0x207e47['utils']['sheet_to_json'](_0x87ed74),_0x54d4c5=[_0x561762[_0x21a055(0x258)],_0x561762[_0x21a055(0x180)],_0x561762[_0x21a055(0x1cf)],_0x561762[_0x21a055(0x129)],_0x561762[_0x21a055(0x209)],_0x561762['bZpTU'],_0x561762[_0x21a055(0x177)],_0x561762[_0x21a055(0x18b)],_0x561762[_0x21a055(0x212)],_0x561762[_0x21a055(0x2b3)],_0x561762['EioYP']][_0x21a055(0x2b7)](_0x578fe4=>!_0x5a3412[_0x21a055(0x208)](_0x569da1=>Object[_0x21a055(0x1a7)][_0x21a055(0x26e)][_0x21a055(0x1b2)](_0x569da1,_0x578fe4)));if(_0x561762['aOtle'](_0x54d4c5[_0x21a055(0x218)],0x0))return _0x28c0c9['send']({'isUpload':!0x1,'color':_0x561762[_0x21a055(0x1ce)],'msg':'ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22'+_0x54d4c5['join'](',\x20')+'\x22'});const _0x16b52b=new Set(),_0x573cfb=new Set();if(_0x5a3412['forEach'](_0x4b80fe=>{const _0x49cbbe=_0x21a055;_0x16b52b[_0x49cbbe(0x322)](_0x4b80fe[_0x49cbbe(0x1c8)])?_0x573cfb[_0x49cbbe(0x28b)](_0x4b80fe['userId']):_0x16b52b[_0x49cbbe(0x28b)](_0x4b80fe['userId']);}),_0x561762[_0x21a055(0x353)](_0x573cfb[_0x21a055(0x273)],0x0))return _0x28c0c9['send']({'isUpload':!0x1,'color':_0x561762[_0x21a055(0x1ce)],'msg':_0x21a055(0x2f0)+Array[_0x21a055(0x2c0)](_0x573cfb)['join'](',\x20')+'\x22'});const _0x35946b=new Set(),_0x50f9a5=new Set();if(_0x5a3412[_0x21a055(0x185)](_0x5b5f63=>{const _0x2e5e6c=_0x21a055;_0x35946b[_0x2e5e6c(0x322)](_0x5b5f63[_0x2e5e6c(0x27d)])?_0x50f9a5[_0x2e5e6c(0x28b)](_0x5b5f63['username']):_0x35946b[_0x2e5e6c(0x28b)](_0x5b5f63[_0x2e5e6c(0x27d)]);}),_0x561762[_0x21a055(0x2b8)](_0x50f9a5[_0x21a055(0x273)],0x0))return _0x28c0c9[_0x21a055(0x2d5)]({'isUpload':!0x1,'color':_0x561762[_0x21a055(0x1ce)],'msg':_0x21a055(0x372)+Array[_0x21a055(0x2c0)](_0x50f9a5)[_0x21a055(0x1e6)](',\x20')+'\x22'});const _0x20d06c=new Set(),_0x5b3567=new Set();if(_0x5a3412[_0x21a055(0x185)](_0x470f8a=>{const _0x2d6ae9=_0x21a055;_0x20d06c[_0x2d6ae9(0x322)](_0x470f8a['userEmail'])?_0x5b3567['add'](_0x470f8a[_0x2d6ae9(0x2c7)]):_0x20d06c[_0x2d6ae9(0x28b)](_0x470f8a[_0x2d6ae9(0x2c7)]);}),_0x561762['bUQpr'](_0x5b3567[_0x21a055(0x273)],0x0))return _0x28c0c9['send']({'isUpload':!0x1,'color':_0x561762['JfUPP'],'msg':_0x21a055(0x295)+Array[_0x21a055(0x2c0)](_0x5b3567)[_0x21a055(0x1e6)](',\x20')+'\x22'});const _0x20e1e2=[],_0x2c8a30=/^\d{3,4}$/,_0x3b061c=new RegExp(global['USERNAME_PATTERN']),_0x522340=/^\d{3}$/,_0x2536e5=[_0x561762['eCPCn'],''];for(const [_0x31c767,_0x5228c3]of _0x5a3412[_0x21a055(0x136)]()){const _0x1f8b37=_0x561762[_0x21a055(0x1ed)](_0x31c767,0x2),_0x3a924e={'userId':_0x5228c3['userId'],'row':_0x1f8b37};if(!_0x5228c3[_0x21a055(0x1c8)]||_0x561762['ECRzT'](_0x2c8a30[_0x21a055(0x1d1)](_0x5228c3[_0x21a055(0x1c8)][_0x21a055(0x2b5)]()),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x27d)]||_0x561762[_0x21a055(0x2e0)](_0x3b061c['test'](_0x5228c3[_0x21a055(0x27d)]),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3['branchId']||_0x561762['jdrUt'](_0x522340[_0x21a055(0x1d1)](_0x5228c3['branchId'][_0x21a055(0x2b5)]()),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x1a0)]||_0x561762[_0x21a055(0x31a)](_0x2536e5[_0x21a055(0x1d4)](_0x5228c3['userIsActive']),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x247)]||_0x561762[_0x21a055(0x35c)](global['USER_AUTHORITIES'][_0x21a055(0x1d4)](_0x5228c3[_0x21a055(0x247)]),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x2c7)]||_0x561762[_0x21a055(0x35c)](_0xe56422[_0x21a055(0x2ad)](_0x5228c3[_0x21a055(0x2c7)]),!0x1)){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x1da)]||_0x561762[_0x21a055(0x35c)](_0x5228c3[_0x21a055(0x1da)][_0x21a055(0x311)](),'')){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}if(!_0x5228c3[_0x21a055(0x15b)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/['test'](_0x5228c3[_0x21a055(0x15b)])){_0x20e1e2[_0x21a055(0x2dc)](_0x3a924e);continue;}}if(_0x561762[_0x21a055(0x353)](_0x20e1e2['length'],0x0)){const _0x5eff4=Array[_0x21a055(0x2c0)](new Set(_0x20e1e2[_0x21a055(0x195)](_0x4c01c7=>JSON['stringify'](_0x4c01c7))))[_0x21a055(0x195)](_0x171e0b=>JSON['parse'](_0x171e0b));return _0x28c0c9[_0x21a055(0x2d5)]({'isUpload':!0x1,'color':_0x561762[_0x21a055(0x1ce)],'msg':_0x21a055(0x2a3)+_0x5eff4[_0x21a055(0x195)](_0x2710e7=>_0x2710e7[_0x21a055(0x20a)])['join'](',\x20'),'errorRows':_0x5eff4});}_0x5a3412[_0x21a055(0x185)](_0x28a9f7=>{const _0x3e1e0d=_0x21a055;_0x28a9f7[_0x3e1e0d(0x1c8)]=_0x561762[_0x3e1e0d(0x1b1)](Number,_0x28a9f7[_0x3e1e0d(0x1c8)]),_0x28a9f7[_0x3e1e0d(0x25e)]=_0x561762['aBfgg'](Number,_0x28a9f7[_0x3e1e0d(0x25e)]),_0x28a9f7[_0x3e1e0d(0x1a0)]||(_0x28a9f7[_0x3e1e0d(0x1a0)]=''),_0x28a9f7[_0x3e1e0d(0x12e)]||(_0x28a9f7['userPhone']=''),_0x28a9f7[_0x3e1e0d(0x27a)]||(_0x28a9f7[_0x3e1e0d(0x27a)]=''),_0x28a9f7[_0x3e1e0d(0x33c)]||(_0x28a9f7['userLastname']=''),delete _0x28a9f7[_0x3e1e0d(0x19a)],delete _0x28a9f7[_0x3e1e0d(0x221)],delete _0x28a9f7['userNormalLoginCount'],delete _0x28a9f7[_0x3e1e0d(0x19a)];}),await _0x34fc0e[_0x21a055(0x203)]();const _0x20dab5=_0x34fc0e['db'](dbName)['collection'](dbColl_users),_0x165b3a=[];for(const _0x3532b5 of _0x5a3412){const _0x1a5706=await _0x20dab5[_0x21a055(0x2b6)]({'userId':_0x3532b5[_0x21a055(0x1c8)]},{'$set':_0x3532b5},{'upsert':!0x0});_0x165b3a[_0x21a055(0x2dc)]({'userId':_0x3532b5[_0x21a055(0x1c8)],'matchedCount':_0x1a5706[_0x21a055(0x313)],'upsertedCount':_0x1a5706[_0x21a055(0x35a)]});}const _0x20c6f8=_0x561762[_0x21a055(0x32c)](_0x165b3a['length'],0x0)?_0x561762[_0x21a055(0x25c)](_0x21a055(0x2ef)+_0x165b3a[_0x21a055(0x2b7)](_0x1b11d1=>_0x1b11d1[_0x21a055(0x313)]>0x0)[_0x21a055(0x218)]+_0x21a055(0x188),(_0x21a055(0x20b)+_0x165b3a[_0x21a055(0x2b7)](_0x1f0d54=>_0x1f0d54[_0x21a055(0x35a)]>0x0)['length']+_0x21a055(0x188))['trim']()):_0x561762[_0x21a055(0x11f)];return _0x28c0c9['send']({'isUpload':!0x0,'color':_0x561762[_0x21a055(0x284)],'msg':_0x20c6f8});}catch(_0xd3cebe){return console[_0x21a055(0x333)](_0x561762['zaRQu'],_0xd3cebe),_0x28c0c9[_0x21a055(0x2d5)]({'isDownload':!0x1,'color':_0x561762['JfUPP'],'msg':_0xd3cebe[_0x21a055(0x15d)]});}finally{_0x34fc0e[_0x21a055(0x2fa)]();}});function _0x362b(){const _0x34fa2b=['ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','size','kngRX','PpsZe','HvNXs','__proto__','xBFnv','YLSHz','userPrefix','PSWYa','folderForms','username','egQJl','single','UjmyC','dYMmZ','wyxGj','IeBWE','CQJuV','DTsSy','OEMkQ','FpjkQ','PhDfd','dbColl_sales','sVRIn','add','RAQbP','base64','CfLdy','nqOqS','UvyTc','wxRGT','kQggy','bXUmQ','init','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','session','CiaBL','return\x20(function()\x20','NHEmY','Fvywe','KZQyM','fogoG','vAOjN','TzwUv','OAYis','deleteOne','RLfwN','active','มีข้อมูลผิดพลาดที่แถว\x20','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','$branchInfo.branchName','MyhWe','piihO','iPTyD','Sxmwx','OBLRa','load_id','jqJux','isEmail','TkydK','/new','unshift','red','vNDfo','lRuvU','../','toString','updateOne','filter','pBrVR','hXdrq','lIhTD','DkFPL','MUawy','cJuTg','RyAcD','bWiXD','from','LfMfG','Mtncv','{}.constructor(\x22return\x20this\x22)(\x20)','Session\x20destroy\x20error:\x20','\x5c$&','11XzFENe','userEmail','LtkDz','user_id','function\x20*\x5c(\x20*\x5c)','UdJXi','PlTLh','ltaRa','dRWYG','\x22\x20เรียบร้อยแล้ว\x20)','OvjwF','เพิ่มยูสเซอร์\x20','hhuBB','zIMtj','keys','send','collection','GlMnr','14VBZGNi','userFlash','trace','stateObject','push','CNRES','exception','then','jdrUt','action','XouTV','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','SdiOD','SprMJ','QUdpZ','ยูสเซอร์\x20(','?sip=','zCGSP','userFullname','ไม่มีข้อมูล','cSzyD','bzEwi','NEVpX','อัปเดท\x20','มี\x20userId\x20ซ้ำกัน:\x20\x22','BcXMh','vnmSq','WiVyy','JRqMl','SmTNt','mrHcJ','EEvoQ','status','LxNpX','close','IGMSL','qwerty','Wryfu','iGtUM','uOyfa','bymRO','XoLIK','gBYum','NsDvy','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','GGPaj','VmrPD','NNeAY','16581470YZtDxG','TvJSG','aWOFg','nQYdI','getSessionData','TGHlR','lMPcb','RMpXI','skRZv','trim','ytYcQ','matchedCount','cCnMY','zIAeM','254703WjXpGv','xeHza','iJGvz','MgkaN','ECRzT','KYSfi','FQyLK','modifiedCount','redirect','9BomUyf','green','find','has','buffer','pNFpS','renderView','nCloO','sqGju','lrhlL','sendRegisterUserEmail','flash','countDocuments','icfEf','2fYgDpZ','16OGMrQJ','read','vDpVY','lpNiB','18rHPaUb','log','{{sep}}ไม่สามารถลบได้','OcifN','KVjmU','sort','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','&load_id=','ประวัติการแก้ไขยูสเซอร์\x20:\x20[','userPassword','userLastname','{{sep}}\x22','dblmu','$userFirstname','Sheets','rwEZP','bGDrT','ZErgs','fFEPT','cNoPv','sendFile','yOwbl','5403732fVRkGY','qvVzv','utils','BYDSJ','aNXnZ','minute','VGFtc','emrJW','pVAck','พิมพ์ข้อมูล\x20','nMgXz','wCnbl','ogxaI','){{sep}}(CODE\x20:\x20','blClS','XaAFh','body','ZRjyy','upsertedCount','BcuSc','peYQn','nHShK','/myModule.js','CVDMW','xpBDP','HdFdR','CfIYb','response','/myData.js','/delete','dbColl_warehouseOut','replace','yYDLS','NhwRU','zVjeG','VNjjv','ZnBew','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','file','$userPrefix','lnzUV','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','มี\x20username\x20ซ้ำกัน:\x20\x22','oRuOU','nkRfh','50999494CPIGMF','KIkgq','rcltc','IMRji','?rpp=20&page=1&load_id=','poaaT','WwYiG','CgvLU','TLjnU','petYo','lqxfX','xTpTJ','KEjyi','UHlyj','PTsWR','tRAGN','bbfLE','EEsSo','/myUsers.js','msg','userPhone','vvJmU','TIVby','icmfH','yellow','cJxdP','Aouxs','HSlDb','entries','page','insertOne','svwCT','&page=','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','destroy','rzerz','GoSRq','dbColl_warehouseIn','vStFO','ไม่มีข้อมูลที่อัปเดท','gger','tDPkQ','MxllW','getDate','uoRhx','ZUQgy','CyPSq','getDateTime','print_users.ejs','LFgWp','Cnfoj','/load','aggregate','cLytw','JLXuA','HGlVx','FNTBi','dbColl_users','WeiMv','toArray','ToFgw','HxwWe','SxIJy','ZTBFy','5262200RTeQUH','dateTimeCanDelete','UBBTx','message','oOxzy','2727260jLekFZ','mqFXU','BhTIc','SCBJC','YojWB','uzmtF','Atpll','rpp','pJKZC','branchInfo','ujGUJ','อัปเดท\x20\x22','jBjLc','GLhlz','insertedId','FOysR','97943DQBxfa','cRSsa','xbnjy','dbColl_sessions','jJHuA','gAdbM','isOS','while\x20(true)\x20{}','MxEGY','VljVp','get','cqdWT','warn','uhuHy','yMJsO','maohk','chain','XlzeO','AbfEP','XZfth','SdBmo','@gmail.com','forEach','YXdqC','vlOzV','\x20รายการ','CgDwF','FowKW','VJXyg','EEJae','KqEGi','CysQa','epHsB','hBOUW','rOXIC','limit','wPcMi','InqAb','map','PKnrQ','query','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','xHVyI','userLastLogin','bskre','Not\x20Found','NhgqQ','jpobN','qjPYN','userIsActive','yxJay','xMKzp','ElXlv','mdUhD','uQzww','constructor','prototype','mVVrO','qlmxP','avZbR','GNatm','fjWjs','tqzEj','changesHistory','qdAWI','apply','QOLUk','call','QriQo','OGOxo','manageUsers','yrPDc','post','bCqkE','Router','ลบยูสเซอร์\x20\x22','oUmSf','FLjCm','qXUNg','$changesHistory','RFJbm','.xlsx','user-','tgmNO','GuAkH','HzngM','uuBuz','getChangeHistory','mrwlJ','userId','xSJGk','XUQNQ','dbName','COwWE','XHhLZ','JfUPP','PZdjs','qhXWV','test','hWIgk','readFileSync','includes','rLUcZ','Omdrs','TQsVi','doc_changes.ejs','&rpp=','userFirstname','obJOw','VGHJt','PaNrd','Ttxyj','Nceke','GEYAB','URJBQ','nUhck','parse','Dhale','ffHqH','join','rgArb','MjcHR','qbyqM','yfnyB','HewlD','CzgmQ','kBFzE','hash','ygMzf','getUserBranches','UufZK','LEPpm','EQCCZ','kNxte','LMYFj','oPehB','kzXsT','kLsdm','BFnbW','zcYsX','PBwvA','สร้างผู้ใช้ใหม่\x20\x22','aBAvx','EKaIN','iyjPl','TPyeK','bxSPr','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','connect','info','$dateTimeCanDelete','\x20ยูสเซอร์เรียบร้อยแล้ว','cmOEO','some','BVcMR','row','{{sep}}เพิ่มใหม่\x20','utf8','wKvlw','/download-excel','catch','BCRYPT_NUMBER','yuSjV','XUqAr','\x22\x20)','console','neLKJ','BcQmm','FaCNN','length','Yzuju','eFTqi','jsVhF','tUsVL','users','bind','xlsx','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','changesHistoryCount','RjXok','NzHWp','/mySendmail.js','_id','autPR','findOne','DTLbo','deleteMany','htWmw','DchQW','eqcJy','HfUAa','hnjHD','tPZkh','userNormalLoginCount','pyFeK','doaei','CLSCh','aVvql','NtxIT','dnjqo','LnLhb','KYkQh','NAwbV','WwVfn','QoNko','SkIOl','\x22\x20เรียบร้อยแล้ว','error\x20===>\x20','/changes','LAAVe','juoco','yAKwB','WWbWu','WoeQI','deletedCount','debu','userAuthority','acknowledged','XLpsv','users_','mcfvL','dqHGp','SvMIF','GHLhm','iDZnh','dbColl_return','ยูสเซอร์\x20\x22','zNCVy','GBvor','xowYH','counter','env','dbUrl','CUuPA','IuKdY','BRKbG','vwsrq','ulcCK','Rkjab','branchId','kUXDh','xrDlm','ZQCke','AalNM','zIxrS','sip','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','fsztL','stringify','IUwyO','OFdJj','kEeaD','ApiLX','ไม่พบ\x20\x22','table','hasOwnProperty','tSUQk','uplVn','input'];_0x362b=function(){return _0x34fa2b;};return _0x362b();}export default x;function _0xc9d544(_0x1bbe57){const _0x51f5ef=_0x7f61f6,_0x3e9c1a={'VmrPD':function(_0x44632f,_0x34fff2){return _0x44632f===_0x34fff2;},'iGtUM':'string','mcfvL':_0x51f5ef(0x176),'KVjmU':_0x51f5ef(0x255),'RjXok':function(_0x4507c4,_0x2881da){return _0x4507c4!==_0x2881da;},'xHVyI':function(_0x28dddf,_0x4a8001){return _0x28dddf+_0x4a8001;},'TkdiP':function(_0x402f34,_0x73b3bf){return _0x402f34/_0x73b3bf;},'dnjqo':_0x51f5ef(0x218),'vDpVY':function(_0x222e50,_0x175281){return _0x222e50===_0x175281;},'VGFtc':function(_0x668e5b,_0x493107){return _0x668e5b%_0x493107;},'frYax':function(_0x2461d2,_0x314e2e){return _0x2461d2+_0x314e2e;},'yAKwB':_0x51f5ef(0x246),'ORgNS':_0x51f5ef(0x142),'zVjeG':'action','kNxte':function(_0x4b7fcd,_0x421a4e){return _0x4b7fcd+_0x421a4e;},'hnjHD':_0x51f5ef(0x2db),'TIVby':function(_0x169d92,_0x3bbd72){return _0x169d92(_0x3bbd72);}};function _0x3fdd86(_0x78636d){const _0x185976=_0x51f5ef;if(_0x3e9c1a[_0x185976(0x306)](typeof _0x78636d,_0x3e9c1a[_0x185976(0x2fe)]))return function(_0x42118a){}['constructor'](_0x3e9c1a[_0x185976(0x24b)])['apply'](_0x3e9c1a[_0x185976(0x336)]);else _0x3e9c1a[_0x185976(0x222)](_0x3e9c1a[_0x185976(0x199)]('',_0x3e9c1a['TkdiP'](_0x78636d,_0x78636d))[_0x3e9c1a[_0x185976(0x236)]],0x1)||_0x3e9c1a[_0x185976(0x330)](_0x3e9c1a[_0x185976(0x34e)](_0x78636d,0x14),0x0)?function(){return!![];}[_0x185976(0x1a6)](_0x3e9c1a['frYax'](_0x3e9c1a['yAKwB'],_0x3e9c1a['ORgNS']))[_0x185976(0x1b2)](_0x3e9c1a[_0x185976(0x36a)]):function(){return![];}[_0x185976(0x1a6)](_0x3e9c1a[_0x185976(0x1f4)](_0x3e9c1a[_0x185976(0x242)],_0x3e9c1a['ORgNS']))[_0x185976(0x1b0)](_0x3e9c1a[_0x185976(0x22e)]);_0x3e9c1a[_0x185976(0x130)](_0x3fdd86,++_0x78636d);}try{if(_0x1bbe57)return _0x3fdd86;else _0x3e9c1a[_0x51f5ef(0x130)](_0x3fdd86,0x0);}catch(_0x493b47){}}