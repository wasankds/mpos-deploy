const _0x14631=_0x5a8c;(function(_0x2b47af,_0xa887a8){const _0x25dcdb=_0x5a8c,_0x4b478e=_0x2b47af();while(!![]){try{const _0x24d9a2=-parseInt(_0x25dcdb(0x226))/0x1+parseInt(_0x25dcdb(0x22c))/0x2*(-parseInt(_0x25dcdb(0x358))/0x3)+parseInt(_0x25dcdb(0x2b8))/0x4+parseInt(_0x25dcdb(0x16d))/0x5*(-parseInt(_0x25dcdb(0x22e))/0x6)+parseInt(_0x25dcdb(0x166))/0x7+-parseInt(_0x25dcdb(0x2ed))/0x8*(-parseInt(_0x25dcdb(0x2da))/0x9)+parseInt(_0x25dcdb(0x32f))/0xa*(parseInt(_0x25dcdb(0x2fb))/0xb);if(_0x24d9a2===_0xa887a8)break;else _0x4b478e['push'](_0x4b478e['shift']());}catch(_0xeb45ad){_0x4b478e['push'](_0x4b478e['shift']());}}}(_0x1a51,0xc2d2e));function _0x1a51(){const _0x4b61ff=['/myUsers.js','render','FpHXQ','lumcH','fHXKI','modifiedCount','3573729dOBPxh','SFYYy','connect','return\x20(function()\x20','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','green','$userPrefix','sGZQm','Psxqz','wMzmu','redirect','xJBoX','dbWQs','อัปเดท\x20','manageUsers','QWdoB','wcBUd','UNRNo','base64','32pKVjNm','XdlKf','bzoct','มีข้อมูลผิดพลาดที่แถว\x20','umUHP','{{sep}}(\x20ไม่พบเซสชั่น\x20)','userFirstname','fyRKU','cuqQx','nYiSD','kdSiq','JppYw','debu','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','1713558XmKjQw','bsVoV','YZfcS','NgbYv','YMwnj','_id','XTavM','userPassword','error','exception','{}.constructor(\x22return\x20this\x22)(\x20)','bYvxg','userPrefix','SaBls','Dvyao','NpyMi','TEyLT','QWHBB','apply','getUserBranches','vWdvI','userId','){{sep}}(CODE\x20:\x20','userLastname','FvieY','MDBEm','myjwt','active','ntwJG','xwdUk','uCKSJ','sIMvq','xaFZo','uBDiU','unyYf','FFQUb','ySXIv','QEdWT','SheetNames','YgOkZ','dbColl_return','&load_id=','aggregate','replace','mvNDI','hash','isOS','WYHwd','qMPzC','Peawy','Fabrc','mAObL','10iCSlYI','pNDRc','OvrFk','mrjsa','kwnae','HNAcu','post','lQizT','NhpnD','../','hNUHl','HdoyP','book_append_sheet','action','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','trim','memoryStorage','zhMIP','uJoRp','HfhJN','init','/load','body','FacAN','uCOUk','mQKsj','FmBUV','nXtpX','xegwy','length','Ytcbr','qKUgp','WXuru','sendFile','Opyzg','pqxuq','session','eIGHa','upsertedCount','bbQsC','ziTXa','2334fnjdgX','sKeGC','row','response','userAuthority','upDGz','BrDdu','toString','while\x20(true)\x20{}','RJqcN','/print','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','dtFec','xDUmA','gztMK','PvXGM','FYXhX','qgQKe','?sip=','eVPHN','countDocuments','shCAP','CFLeY','deletedCount','map','GgaFC','GWpeX','fvmyr','JXfum','veIcY','luERZ','BXgqR','OMCtx','HQjBh','/new','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','Not\x20Found','test','lDrEB','dbUrl','doc_changes.ejs','{{sep}}[\x20บันทึกการแก้ไข\x20]','fNuwh','aPLya','SRgUa','oEAhQ','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','QyeXJ','$changesHistory','log','entries','xLRvh','hTlDG','/myDateTime.js','xOhqo','utf8','rJHNH','sZtCm','join','dateTimeCanDelete','getChangeHistory','SAGYs','iMVNO','VQNBA','yhEnd','sort','JfDml','acknowledged','Router','buffer','get','พิมพ์ข้อมูล\x20','zdwDe','vXkRm','bVLiq','Gukup','XwYyQ','XNBnn','LMtNW','dbColl_sessions','SOWPt','user-','woPUJ','console','table','userNormalLoginCount','11160730rkQBGv','generatePassword','matchedCount','gelEG','\x22\x20มีอยู่ในเอกสาร\x20','VISBr','collection','45DzQYhT','FAHto','MLPHz','IlOMK','add','dbColl_sales','NCpOB','uiqRq','flash','noCar','CgBgG','GSHCe','DWbzP','loKLk','destroy','minute','gKila','uHdHd','KaxeB','?rpp=20&page=1&load_id=','qNLoG','xlFJw','JISjh','username','XmPMi','print_users.ejs','slgJA','cjiBM','kaFHj','Lvvqw','FJcrU','XiXjS','qZvQo','getDateTime','lbbrB','vUyvX','gVCyf','PqwiA','usyCC','lnPWe','ULzeO','xUNJZ','yNsSN','UDnUe','single','userFullname','iILKe','&rpp=','lGFZr','FWCrM','insertOne','TCgfn','zlQav','jjVjS','trace','folderForms','info','VibSR','function\x20*\x5c(\x20*\x5c)','utils','Sheets','GmuHR','BWiEz','YBJOZ','MSQuK','constructor','sfpeV','file','XQDiu','OfvaN','qDvAu','yqEid','chain','dbColl_warehouseIn','KPzXH','QuBxg','mBeWG','SMTxw','{{sep}}\x22','findOne','MJSdi','getDate','QDWqN','pZafQ','Ebbvu','YUyze','jTpva','waYYp','dbColl_warehouseOut','MPVAn','ujNtX','wXlEn','sOjmB','__proto__','arkNz','status','close','NaGxQ','jZPsM','call','EmLOI','XkWzz','ySIwH','ORTqO','XGdDi','Ttibq','catch','shift','HXhyN','has','xmYDM','zBBjB','kJHrl','SkMgC','LaxeZ','yPKTx','some','YNzHK','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','send','vgdlX','rSwoM','message','WWFws','ลบยูสเซอร์\x20\x22','Epnex','yOzmt','มี\x20username\x20ซ้ำกัน:\x20\x22','agYcP','/changes','load_id','insertedId','$branchInfo.branchName','JCEUi','ezjEh','รูปแบบอีเมลไม่ถูกต้อง','aZBPi','mTgTt','.xlsx','qoxaY','SBGRJ','XFtCM','NILiC','QFpGn','geQuJ','warn','FKPfQ','hasOwnProperty','gTbzw','UJpCl','iLSML','from','ZbBnj','qoUQF','stateObject','aXRwa','XwPec','XTJri','xoOzq','CaqAZ','KONDW','nAtHj','branchId','rISES','UVddg','UtqPq','yvPIY','caAAX','keys','skRok','dWrKt','branchInfo','userLastLogin','&page=','\x22\x20เรียบร้อยแล้ว\x20)','GJpoe','red','write','users','akuJX','changesHistory','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','TEvTn','JPKcf','qwerty','1199109mkUPCr','yfDAh','ไม่พบ\x20\x22','updateOne','rpp','rwVSb','3086oqvSsc','AVKmr','790206zOhawP','BCRYPT_NUMBER','ยูสเซอร์\x20\x22','error\x20===>\x20','getSettings','WJmxC','YZpRS','bind','euyQQ','vzcrv','forEach','userFlash','kFUex','xGrFI','uJZoA','HGoWw','LCRyx','USER_AUTHORITIES','yfXmR','size','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','SOesh','มี\x20userId\x20ซ้ำกัน:\x20\x22','WtyCl','ecOur','find','BOqFY','DJJzj','PKqjp','vvfHM','GpDMo','deleteOne','query','renderView','iSuCa','PgBFS','vcBDk','filter','{{sep}}เพิ่มใหม่\x20','ALBff','readFileSync','xwABF','isEmail','QKICa','ALAaw','dbName','EpXzN','ไม่มีข้อมูล','AjSyg','BGTjD','sip','wzoBQ','cdLva','stringify','tXnqX','dbColl_users','hAYJH','srgGY','FEDQG','TrfhN','nGKPG','dNlfq','jSmHV','page','HJcHS','KzhIu','input','deleteMany','bcAQL','mLeUs','cztWL','MbdUG','spDps','then','rKAbY','push','lIZke','book_new','wmrWt','BIDiq','vpMgc','exVxu','TSxit','\x20ยูสเซอร์เรียบร้อยแล้ว','GSvzM','JuErh','iMhMv','RwuUR','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','WwBBu','KyCSW','qffnT','เพิ่มยูสเซอร์\x20','/mySendmail.js','gUUSq','rkFov','Pecuy','MMGxd','gKxeg','userEmail','oHzBX','kkaPp','yqRtJ','ATVRq','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','parse','fIPWv','rqQvv','hbGBI','NdLbW','uNuqA','klwuU','unshift','nFrjI','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','iYUVd','changesHistoryCount','TuuQR','jUUwz','toArray','Dvmwy','/manage/users','userPhone','kXCXB','ghddQ','IiAsy','MNxNj','includes','qkdeq','UHSxu','azWzw','\x20รายการ','nPVit','PDafZ','limit','msg','อัปเดท\x20\x22','jullu','4177512hmBIpJ','cQFCK','{{sep}}ไม่สามารถลบได้','TBNRk','GnqnG','prototype','exvfz','bWENM','ยูสเซอร์\x20(','getSessionData','hqbcR','uNvEV','phLnL','EiEXZ','LMoDz','Session\x20destroy\x20error:\x20','BTrux','userIsActive','yellow','gger','VZfzP','AZuRk','Fqqoe','BibVi','SGhGM','CkcjE','uGxGM','ไม่พบประวัติการเปลี่ยนแปลง'];_0x1a51=function(){return _0x4b61ff;};return _0x1a51();}const _0x29f549=(function(){const _0x5bf109=_0x5a8c,_0x293c9e={'JuErh':function(_0x1be60b,_0x1ccdce){return _0x1be60b===_0x1ccdce;},'cNfJz':'IUBaK','XkWzz':_0x5bf109(0x240),'FAHto':function(_0x5362be,_0x4c445c){return _0x5362be!==_0x4c445c;},'qoUQF':_0x5bf109(0x27d),'vUyvX':function(_0x2c66fa,_0x60275d){return _0x2c66fa(_0x60275d);},'yqEid':'amUGH','Epnex':_0x5bf109(0x212)};let _0x3c1987=!![];return function(_0x40b9be,_0x349e9e){const _0x5413b1=_0x5bf109,_0x3b6f30={'NpyMi':function(_0x2e80cf,_0x850e21){const _0x158681=_0x5a8c;return _0x293c9e[_0x158681(0x190)](_0x2e80cf,_0x850e21);}};if(_0x293c9e['JuErh'](_0x293c9e[_0x5413b1(0x1b4)],_0x293c9e[_0x5413b1(0x1ea)])){_0x2d3bfa=!0x1;return;}else{const _0xe62099=_0x3c1987?function(){const _0x180045=_0x5413b1;if(_0x293c9e[_0x180045(0x283)](_0x293c9e['cNfJz'],_0x293c9e[_0x180045(0x1d2)]))_0x20520b=_0x5ab97c;else{if(_0x349e9e){if(_0x293c9e[_0x180045(0x16e)](_0x293c9e[_0x180045(0x206)],_0x293c9e[_0x180045(0x206)]))_0x51088e[_0x180045(0x310)]=_0x3b6f30[_0x180045(0x30a)](_0x2bbe71,_0x26e6e0[_0x180045(0x310)]),_0x33725f[_0x180045(0x20f)]=_0x3b6f30[_0x180045(0x30a)](_0x10eae1,_0x5ad4bc['branchId']),_0x17e31e['userIsActive']||(_0x5d8300[_0x180045(0x2c9)]=''),_0x37a243['userPhone']||(_0x22e2ad[_0x180045(0x2a8)]=''),_0x2579be[_0x180045(0x307)]||(_0x542d7a['userPrefix']=''),_0x3a6ca5[_0x180045(0x312)]||(_0x288ce4[_0x180045(0x312)]=''),delete _0x1c416e[_0x180045(0x219)],delete _0x122fdb['changesHistoryCount'],delete _0x50009e[_0x180045(0x165)],delete _0x55de79[_0x180045(0x219)];else{const _0x28d727=_0x349e9e['apply'](_0x40b9be,arguments);return _0x349e9e=null,_0x28d727;}}}}:function(){};return _0x3c1987=![],_0xe62099;}};}());(function(){const _0x5cb352=_0x5a8c,_0x9aa531={'VISBr':'error\x20===>\x20','WsaGM':_0x5cb352(0x21d),'caAAX':function(_0x135073,_0x1e6f85){return _0x135073(_0x1e6f85);},'SAGYs':function(_0xf7420,_0x452fb4){return _0xf7420!==_0x452fb4;},'tXnqX':_0x5cb352(0x378),'CWiSA':_0x5cb352(0x1a7),'LJfvX':_0x5cb352(0x33d),'GnqnG':function(_0x41bd69,_0x583485){return _0x41bd69(_0x583485);},'XwPec':_0x5cb352(0x343),'mAObL':function(_0x2217b9,_0x3c865a){return _0x2217b9+_0x3c865a;},'aqEvF':'chain','vgdlX':function(_0x1b0bec,_0x1bb3aa){return _0x1b0bec+_0x1bb3aa;},'mgAKl':'input','Ebbvu':_0x5cb352(0x375),'gKxeg':'pyVrF','Ttibq':_0x5cb352(0x365),'WtyCl':function(_0xfa18da){return _0xfa18da();},'CaqAZ':function(_0x41e9ce,_0x593d13,_0x2e4a74){return _0x41e9ce(_0x593d13,_0x2e4a74);}};_0x9aa531[_0x5cb352(0x20c)](_0x29f549,this,function(){const _0x4a2867=_0x5cb352,_0x517a11={'mBeWG':function(_0x2b601c,_0x2551fc){const _0x340fbd=_0x5a8c;return _0x9aa531[_0x340fbd(0x214)](_0x2b601c,_0x2551fc);}};if(_0x9aa531[_0x4a2867(0x395)](_0x9aa531[_0x4a2867(0x264)],_0x9aa531[_0x4a2867(0x264)])){if(_0x4d18d4){const _0x5aaa56=_0x13e77a[_0x4a2867(0x30d)](_0x2c22c0,arguments);return _0x3fbac8=null,_0x5aaa56;}}else{const _0x3083e1=new RegExp(_0x9aa531['CWiSA']),_0x30da15=new RegExp(_0x9aa531['LJfvX'],'i'),_0x396f11=_0x9aa531[_0x4a2867(0x2bc)](_0x46ee96,_0x9aa531[_0x4a2867(0x209)]);!_0x3083e1['test'](_0x9aa531[_0x4a2867(0x32e)](_0x396f11,_0x9aa531['aqEvF']))||!_0x30da15['test'](_0x9aa531[_0x4a2867(0x1e5)](_0x396f11,_0x9aa531['mgAKl']))?_0x9aa531[_0x4a2867(0x395)](_0x9aa531[_0x4a2867(0x1c1)],_0x9aa531[_0x4a2867(0x290)])?_0x9aa531['caAAX'](_0x396f11,'0'):_0x517a11[_0x4a2867(0x1b9)](_0x113f34,'0'):_0x9aa531[_0x4a2867(0x395)](_0x9aa531[_0x4a2867(0x1d6)],_0x9aa531[_0x4a2867(0x1d6)])?(_0x300c2c[_0x4a2867(0x389)](_0x9aa531[_0x4a2867(0x16b)],_0x2b1214[_0x4a2867(0x1e7)]),_0x3538e1[_0x4a2867(0x1e4)](_0x255e86[_0x4a2867(0x263)]({'isPrint':!0x1,'class':_0x9aa531['WsaGM'],'msg':_0x210b12[_0x4a2867(0x1e7)]}))):_0x9aa531[_0x4a2867(0x245)](_0x46ee96);}})();}());const _0x5b26a5=(function(){const _0x53c04e=_0x5a8c,_0x371fbc={'kXCXB':function(_0x146436,_0x1d4e6b){return _0x146436!==_0x1d4e6b;},'hAYJH':'naNvE','mrjsa':function(_0x505638,_0x542256){return _0x505638!==_0x542256;},'AVKmr':_0x53c04e(0x2ab),'ecOur':'red','ItAZN':function(_0x9c2494,_0xa8b0c7){return _0x9c2494!==_0xa8b0c7;},'TSxit':_0x53c04e(0x333),'woPUJ':_0x53c04e(0x23e)};let _0x2f5cb8=!![];return function(_0x327782,_0x5b59d5){const _0x5bb109=_0x53c04e,_0x1f0a6c={'cztWL':_0x371fbc[_0x5bb109(0x246)]};if(_0x371fbc['ItAZN'](_0x371fbc[_0x5bb109(0x280)],_0x371fbc[_0x5bb109(0x162)])){const _0x398c65=_0x2f5cb8?function(){const _0x134e0c=_0x5bb109;if(_0x371fbc[_0x134e0c(0x2a9)](_0x371fbc[_0x134e0c(0x266)],_0x371fbc[_0x134e0c(0x266)]))return![];else{if(_0x5b59d5){if(_0x371fbc[_0x134e0c(0x332)](_0x371fbc[_0x134e0c(0x22d)],_0x371fbc['AVKmr'])){const _0x43e244=_0x191203['from'](new _0x4b94cc(_0x1101f6[_0x134e0c(0x370)](_0x1f0348=>_0x488457[_0x134e0c(0x263)](_0x1f0348))))[_0x134e0c(0x370)](_0x4bc592=>_0x407375[_0x134e0c(0x297)](_0x4bc592));return _0x28c346[_0x134e0c(0x1e4)]({'isUpload':!0x1,'color':_0x1f0a6c[_0x134e0c(0x274)],'msg':_0x134e0c(0x2f0)+_0x43e244[_0x134e0c(0x370)](_0x3d2d14=>_0x3d2d14[_0x134e0c(0x35a)])[_0x134e0c(0x392)](',\x20'),'errorRows':_0x43e244});}else{const _0x2dc84a=_0x5b59d5['apply'](_0x327782,arguments);return _0x5b59d5=null,_0x2dc84a;}}}}:function(){};return _0x2f5cb8=![],_0x398c65;}else _0x229069[_0x5bb109(0x1cd)]();};}()),_0x5dc6f7=_0x5b26a5(this,function(){const _0x432483=_0x5a8c,_0xa6353c={'xaFZo':function(_0x43338d,_0x171abd){return _0x43338d!==_0x171abd;},'lIZke':function(_0x4b37ac,_0x3c40b8){return _0x4b37ac==_0x3c40b8;},'NaGxQ':_0x432483(0x1a7),'RwuUR':_0x432483(0x33d),'aPLya':function(_0x39aacf,_0x260729){return _0x39aacf(_0x260729);},'BibVi':_0x432483(0x343),'DJrII':function(_0x3ded40,_0x435718){return _0x3ded40+_0x435718;},'aZBPi':_0x432483(0x1b5),'ntwJG':_0x432483(0x270),'HGoWw':function(_0xe3e399,_0x58616e){return _0xe3e399(_0x58616e);},'lbbrB':function(_0xa27a){return _0xa27a();},'JPKcf':function(_0x5b9360,_0x26052c,_0x30e7b1){return _0x5b9360(_0x26052c,_0x30e7b1);},'NdLbW':function(_0x1cc0f3,_0x25096f){return _0x1cc0f3===_0x25096f;},'GSvzM':'WuEPD','LKKFx':_0x432483(0x272),'fyRKU':function(_0x15ce43,_0xcf4c51){return _0x15ce43!==_0xcf4c51;},'shCAP':_0x432483(0x1d5),'KzhIu':_0x432483(0x385),'JISjh':function(_0x238b26,_0x3d39d6){return _0x238b26+_0x3d39d6;},'uNvEV':'return\x20(function()\x20','NhpnD':'{}.constructor(\x22return\x20this\x22)(\x20)','GWjaI':'aonhy','xQNPv':'HLgJu','HQjBh':function(_0x55b573,_0x481213){return _0x55b573(_0x481213);},'QyeXJ':_0x432483(0x389),'qkdeq':_0x432483(0x1fe),'lDrEB':_0x432483(0x1a5),'jjVjS':_0x432483(0x303),'spDps':_0x432483(0x304),'mQKsj':_0x432483(0x164),'bYvxg':_0x432483(0x1a3),'Pecuy':function(_0x76490b,_0x462a7a){return _0x76490b<_0x462a7a;},'gztMK':_0x432483(0x15b),'OfvaN':_0x432483(0x25f)},_0x28b7b1=function(){const _0xc5e879=_0x432483,_0x235731={'bbQsC':_0xa6353c[_0xc5e879(0x1ce)],'yqRtJ':_0xa6353c[_0xc5e879(0x285)],'TrfhN':function(_0x2720fc,_0x4c54c6){return _0xa6353c['aPLya'](_0x2720fc,_0x4c54c6);},'zqWHS':_0xa6353c[_0xc5e879(0x2cf)],'QWdoB':function(_0x1ea95f,_0x2381cb){return _0xa6353c['DJrII'](_0x1ea95f,_0x2381cb);},'mTgTt':_0xa6353c[_0xc5e879(0x1f5)],'slgJA':_0xa6353c[_0xc5e879(0x317)],'exvfz':function(_0x31dde7,_0x33a5e2){const _0x16bb97=_0xc5e879;return _0xa6353c[_0x16bb97(0x23d)](_0x31dde7,_0x33a5e2);},'DGpTb':function(_0x15bfa8){const _0xa5e39d=_0xc5e879;return _0xa6353c[_0xa5e39d(0x18f)](_0x15bfa8);},'bfKuW':function(_0xe13bdb,_0xb08858,_0x41c84b){const _0x3e34fb=_0xc5e879;return _0xa6353c[_0x3e34fb(0x224)](_0xe13bdb,_0xb08858,_0x41c84b);}};if(_0xa6353c[_0xc5e879(0x29b)](_0xa6353c[_0xc5e879(0x282)],_0xa6353c['LKKFx']))_0x235731['bfKuW'](_0x13bb1e,this,function(){const _0x39723b=_0xc5e879,_0x2c9687=new _0x4fceb6(_0x235731[_0x39723b(0x356)]),_0x43e607=new _0x2d4f90(_0x235731[_0x39723b(0x294)],'i'),_0x22c9f9=_0x235731[_0x39723b(0x269)](_0xbbabda,_0x235731['zqWHS']);!_0x2c9687['test'](_0x235731[_0x39723b(0x2e9)](_0x22c9f9,_0x235731[_0x39723b(0x1f6)]))||!_0x43e607[_0x39723b(0x37d)](_0x235731[_0x39723b(0x2e9)](_0x22c9f9,_0x235731[_0x39723b(0x187)]))?_0x235731[_0x39723b(0x2be)](_0x22c9f9,'0'):_0x235731['DGpTb'](_0x58d521);})();else{let _0x5b66b0;try{if(_0xa6353c[_0xc5e879(0x2f4)](_0xa6353c[_0xc5e879(0x36d)],_0xa6353c[_0xc5e879(0x26f)]))_0x5b66b0=_0xa6353c[_0xc5e879(0x383)](Function,_0xa6353c[_0xc5e879(0x183)](_0xa6353c['JISjh'](_0xa6353c[_0xc5e879(0x2c3)],_0xa6353c[_0xc5e879(0x337)]),');'))();else{const _0x3c04ce=_0xa6353c[_0xc5e879(0x31b)](_0x1355ca['userAuthority'],'S')||_0xa6353c[_0xc5e879(0x27a)](_0x19b742[_0xc5e879(0x310)],_0x23480a);return _0xa6353c[_0xc5e879(0x31b)](_0x1b48ff[_0xc5e879(0x35c)],'O')&&_0x3c04ce;}}catch(_0x19369f){_0xa6353c[_0xc5e879(0x29b)](_0xa6353c['GWjaI'],_0xa6353c['xQNPv'])?_0x1fab5f[_0xc5e879(0x1cd)]():_0x5b66b0=window;}return _0x5b66b0;}},_0x27e327=_0xa6353c['lbbrB'](_0x28b7b1),_0x39e2be=_0x27e327[_0x432483(0x163)]=_0x27e327['console']||{},_0x5c7d62=[_0xa6353c[_0x432483(0x387)],_0xa6353c[_0x432483(0x2ae)],_0xa6353c[_0x432483(0x37e)],_0xa6353c[_0x432483(0x1a2)],_0xa6353c[_0x432483(0x276)],_0xa6353c[_0x432483(0x348)],_0xa6353c[_0x432483(0x306)]];for(let _0x54736a=0x0;_0xa6353c[_0x432483(0x28e)](_0x54736a,_0x5c7d62['length']);_0x54736a++){if(_0xa6353c[_0x432483(0x2f4)](_0xa6353c[_0x432483(0x366)],_0xa6353c[_0x432483(0x1b2)])){const _0x5e8d2c=_0x5b26a5['constructor'][_0x432483(0x2bd)]['bind'](_0x5b26a5),_0x3fa1e0=_0x5c7d62[_0x54736a],_0x4f4873=_0x39e2be[_0x3fa1e0]||_0x5e8d2c;_0x5e8d2c[_0x432483(0x1ca)]=_0x5b26a5[_0x432483(0x235)](_0x5b26a5),_0x5e8d2c[_0x432483(0x35f)]=_0x4f4873[_0x432483(0x35f)][_0x432483(0x235)](_0x4f4873),_0x39e2be[_0x3fa1e0]=_0x5e8d2c;}else _0xa6353c[_0x432483(0x379)](_0x19eb29,0x0);}});_0x5dc6f7();import _0x598a45 from'express';import{MongoClient as _0x5685e5,ObjectId as _0x56af28}from'mongodb';import _0x518a4b from'bcrypt';const x=_0x598a45[_0x14631(0x154)]();import _0x5e04ca from'multer';import _0x488224 from'validator';import _0xbe1a93 from'xlsx';import _0x3ec976 from'path';import _0x38595e from'fs';import _0x2108bc from'ejs';import _0x1ad336 from'../middleware/mainAuth.js';function _0x5a8c(_0x1b3066,_0x24b3da){const _0x30c462=_0x1a51();return _0x5a8c=function(_0x5dc6f7,_0x5b26a5){_0x5dc6f7=_0x5dc6f7-0x153;let _0x32ca35=_0x30c462[_0x5dc6f7];return _0x32ca35;},_0x5a8c(_0x1b3066,_0x24b3da);}const H=await import(_0x14631(0x338)+mymoduleFolder+'/myModule.js'),O=await import(_0x14631(0x338)+mymoduleFolder+_0x14631(0x38d)),M=await import(_0x14631(0x338)+mymoduleFolder+_0x14631(0x2d4)),re=await import('../'+mymoduleFolder+_0x14631(0x28b)),z=await import(_0x14631(0x338)+mymoduleFolder+'/myData.js'),b=_0x14631(0x2a7),Q=b+'/save',X=b+_0x14631(0x37a),W=b+_0x14631(0x344),G=b+'/delete',V=b+_0x14631(0x362),Y=b+_0x14631(0x1ee),K=b+'/download-excel',Z=b+'/upload-excel',ne=b[_0x14631(0x326)](/\//g,'_'),oe=0x5a0*0x3c;x[_0x14631(0x156)](b,_0x1ad336[_0x14631(0x329)],async(_0x59fffa,_0x25e676)=>{const _0x4337cf=_0x14631,_0x25fbc6={'uiqRq':'error\x20===>\x20','kQADd':'while\x20(true)\x20{}','TEyLT':'counter','VZfzP':_0x4337cf(0x21d),'dNlfq':function(_0x37da88,_0x301930){return _0x37da88===_0x301930;},'rQqwY':_0x4337cf(0x2e2),'exVxu':function(_0x3a1a30,_0x4a9c8f){return _0x3a1a30!==_0x4a9c8f;},'lnPWe':function(_0x5b9600,_0x39ec0a){return _0x5b9600==_0x39ec0a;},'Qkdzg':function(_0x4b20d1,_0x3396b8){return _0x4b20d1!==_0x3396b8;},'FWCrM':function(_0xbb4182,_0x13b202){return _0xbb4182(_0x13b202);},'xJBoX':function(_0x34331a,_0x469d4f){return _0x34331a+_0x469d4f;},'uJoRp':_0x4337cf(0x2dd),'VaMvJ':_0x4337cf(0x305),'WXuru':function(_0x1c4f38){return _0x1c4f38();},'nPVit':function(_0x2616de,_0x27786f){return _0x2616de+_0x27786f;},'FFQUb':_0x4337cf(0x2f9),'llBkl':_0x4337cf(0x2cb),'uCKSJ':_0x4337cf(0x33c),'ocVfT':function(_0x5abe8c,_0xf2f109){return _0x5abe8c(_0xf2f109);},'srgGY':function(_0x51c062,_0x495304){return _0x51c062(_0x495304);},'vcBDk':function(_0xe1b553,_0x2b401c){return _0xe1b553(_0x2b401c);},'SOWPt':function(_0x2d1508,_0x376566){return _0x2d1508*_0x376566;},'Opyzg':function(_0x3071da,_0xcc4c98){return _0x3071da-_0xcc4c98;},'SkMgC':_0x4337cf(0x233),'jSPnS':'KPWfg','uNuqA':function(_0x42f3f2,_0x1c7981){return _0x42f3f2!==_0x1c7981;},'FacAN':_0x4337cf(0x1dd),'vGWec':'\x5c$&','XiXjS':function(_0x2d805f,_0x1d7c7a){return _0x2d805f(_0x1d7c7a);},'iILKe':function(_0x1ce866,_0x4f46c9){return _0x1ce866/_0x4f46c9;},'vWdvI':function(_0x14eac0,_0x44011e){return _0x14eac0<_0x44011e;},'fHXKI':function(_0x2faf16,_0x1980b4){return _0x2faf16-_0x1980b4;},'zdwDe':function(_0x37d6cd,_0x2eb9d9){return _0x37d6cd(_0x2eb9d9);},'cdLva':function(_0x477a13,_0x98df91){return _0x477a13(_0x98df91);},'Dvyao':function(_0x54d631,_0x2318cf){return _0x54d631>_0x2318cf;},'kfWXf':function(_0x5887b0,_0x2a71cc){return _0x5887b0+_0x2a71cc;},'qoxaY':function(_0x19e4b3,_0xf8663c){return _0x19e4b3+_0xf8663c;},'yPKTx':_0x4337cf(0x2e0),'lGFZr':'$userFirstname','xwABF':'$userLastname','rSwoM':_0x4337cf(0x388),'NgbYv':'$dateTimeCanDelete','oHzBX':_0x4337cf(0x17c),'GgaFC':_0x4337cf(0x275),'ULzeO':_0x4337cf(0x192),'yfDAh':function(_0x49a4a7,_0x26bede){return _0x49a4a7(_0x26bede);},'ySXIv':function(_0x2c89e5,_0x48ecca){return _0x2c89e5(_0x48ecca);},'gTbzw':function(_0x5a088d,_0x1beb46){return _0x5a088d(_0x1beb46);},'TEvTn':_0x4337cf(0x372),'SBGRJ':_0x4337cf(0x39a),'LaxeZ':_0x4337cf(0x1ad),'KPzXH':_0x4337cf(0x239),'oVYRf':function(_0x2be746,_0x2f535e){return _0x2be746>_0x2f535e;},'zkpBU':_0x4337cf(0x2e8),'uYkzQ':_0x4337cf(0x2b5),'unyYf':_0x4337cf(0x316),'qNLoG':'dRYSp','ZTXjF':function(_0x2ec9e7,_0x132009){return _0x2ec9e7!==_0x132009;},'WWFws':_0x4337cf(0x182),'QKICa':_0x4337cf(0x1eb)},_0xe62a6a=_0x59fffa[_0x4337cf(0x24e)][_0x4337cf(0x260)],_0x14e511=_0x25fbc6['ocVfT'](Number,_0x59fffa[_0x4337cf(0x24e)]['rpp'])||0x14,_0x593801=_0x25fbc6[_0x4337cf(0x267)](Number,_0x59fffa[_0x4337cf(0x24e)][_0x4337cf(0x26d)])||0x1,_0x4c894a=_0x59fffa[_0x4337cf(0x24e)][_0x4337cf(0x1ef)]||'',_0x2a46c3=_0x25fbc6[_0x4337cf(0x252)](Number,_0x25fbc6[_0x4337cf(0x160)](_0x25fbc6[_0x4337cf(0x351)](_0x593801,0x1),_0x14e511)),_0xe0deab=O[_0x4337cf(0x18e)](0x0),_0x470e18=new _0x5685e5(dbUrl);try{if(_0x25fbc6[_0x4337cf(0x26b)](_0x25fbc6[_0x4337cf(0x1de)],_0x25fbc6['jSPnS']))_0x400600[_0x4337cf(0x389)](_0x25fbc6[_0x4337cf(0x174)],_0x3f907f),_0x14a95c['status'](0x194)[_0x4337cf(0x350)](_0x5d197b);else{await _0x470e18[_0x4337cf(0x2dc)]();const _0x1fd927=_0x470e18['db'](global[_0x4337cf(0x25b)])[_0x4337cf(0x16c)](global[_0x4337cf(0x265)]);if(_0xe62a6a){if(_0x25fbc6['uNuqA'](_0x25fbc6[_0x4337cf(0x346)],_0x25fbc6[_0x4337cf(0x346)]))return function(_0x763ccf){}[_0x4337cf(0x1ae)](yHrLPG['kQADd'])[_0x4337cf(0x30d)](yHrLPG[_0x4337cf(0x30b)]);else{const _0x543a69=new RegExp(_0xe62a6a[_0x4337cf(0x326)](/[.*+?^${}()|[\]\\]/g,_0x25fbc6['vGWec']),'i');let _0x6c86c9={};_0x25fbc6[_0x4337cf(0x267)](isNaN,_0x25fbc6[_0x4337cf(0x252)](Number,_0xe62a6a))?_0x6c86c9={'userId':{'$regex':_0x543a69}}:_0x6c86c9={'userId':_0x25fbc6[_0x4337cf(0x18c)](Number,_0xe62a6a)};var _0x87131=await _0x1fd927[_0x4337cf(0x36c)]({'$or':[_0x6c86c9,{'username':{'$regex':_0x543a69}},{'userFirstname':{'$regex':_0x543a69}}]});}}else var _0x87131=await _0x1fd927[_0x4337cf(0x36c)]({});const _0x4db99e=Math['ceil'](_0x25fbc6[_0x4337cf(0x19b)](_0x87131,_0x14e511)),_0x17d9ca=_0x25fbc6[_0x4337cf(0x30f)](_0x25fbc6[_0x4337cf(0x2d8)](_0x25fbc6[_0x4337cf(0x158)](Number,_0x593801),0x1),0x1)?'-':_0x25fbc6[_0x4337cf(0x351)](_0x25fbc6[_0x4337cf(0x252)](Number,_0x593801),0x1),_0x2287a0=_0x25fbc6[_0x4337cf(0x262)](Number,_0x593801),_0x1c3b01=_0x25fbc6[_0x4337cf(0x309)](_0x25fbc6['kfWXf'](_0x25fbc6[_0x4337cf(0x19e)](Number,_0x593801),0x1),_0x4db99e)?'-':_0x25fbc6[_0x4337cf(0x1f8)](_0x25fbc6[_0x4337cf(0x262)](Number,_0x593801),0x1),_0x5a0417=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x25fbc6[_0x4337cf(0x1e0)],'\x20',_0x25fbc6[_0x4337cf(0x19d)],'\x20',_0x25fbc6[_0x4337cf(0x257)]]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x25fbc6[_0x4337cf(0x1e6)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0xe0deab},'endDate':{'$toDate':_0x25fbc6[_0x4337cf(0x2fe)]},'unit':_0x25fbc6[_0x4337cf(0x292)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x2a46c3},{'$limit':_0x14e511}];if(_0xe62a6a){if(_0x25fbc6[_0x4337cf(0x29c)](_0x25fbc6[_0x4337cf(0x371)],_0x25fbc6[_0x4337cf(0x195)])){const _0x46596e=_0xe62a6a?new RegExp(''+_0xe62a6a,'i'):new RegExp('.*');let _0x59bae={};_0x25fbc6[_0x4337cf(0x227)](isNaN,_0x25fbc6[_0x4337cf(0x31f)](Number,_0xe62a6a))?_0x59bae={'userId':{'$regex':_0x46596e}}:_0x59bae={'userId':_0x25fbc6[_0x4337cf(0x201)](Number,_0xe62a6a)},_0x5a0417['unshift']({'$match':{'$or':[_0x59bae,{'username':{'$regex':_0x46596e}},{'userFirstname':{'$regex':_0x46596e}}]}});}else _0x2e9cf1[_0x4337cf(0x1cd)]();}const _0x110ee9=M[_0x4337cf(0x2c1)](_0x59fffa),_0x5ad907=_0x110ee9['userAuthority'];let _0x733d13=await _0x1fd927['aggregate'](_0x5a0417)['toArray']();if(['S'][_0x4337cf(0x2ad)](_0x5ad907)){if(_0x25fbc6['dNlfq'](_0x25fbc6[_0x4337cf(0x223)],_0x25fbc6[_0x4337cf(0x223)])){const _0x5bfbd4=_0x110ee9['userId'];_0x733d13=_0x733d13['filter'](_0x5e22ba=>{const _0x4db7ff=_0x4337cf,_0x2d93d1={'tZEhy':_0x25fbc6[_0x4db7ff(0x174)],'luERZ':_0x25fbc6[_0x4db7ff(0x2cc)]};if(_0x25fbc6['dNlfq'](_0x25fbc6['rQqwY'],_0x25fbc6['rQqwY'])){const _0x3dc388=_0x25fbc6[_0x4db7ff(0x27f)](_0x5e22ba[_0x4db7ff(0x35c)],'S')||_0x25fbc6[_0x4db7ff(0x194)](_0x5e22ba[_0x4db7ff(0x310)],_0x5bfbd4);return _0x25fbc6['Qkdzg'](_0x5e22ba[_0x4db7ff(0x35c)],'O')&&_0x3dc388;}else return _0x46f957[_0x4db7ff(0x389)](_0x2d93d1['tZEhy'],_0xe1f7e8),_0xf50249[_0x4db7ff(0x1e4)]({'isDownload':!0x1,'color':_0x2d93d1[_0x4db7ff(0x376)],'msg':_0x323ddf[_0x4db7ff(0x1e7)]});});}else{let _0x55dedd;try{_0x55dedd=yHrLPG[_0x4337cf(0x19e)](_0x5d7dca,yHrLPG['xJBoX'](yHrLPG[_0x4337cf(0x2e5)](yHrLPG[_0x4337cf(0x341)],yHrLPG['VaMvJ']),');'))();}catch(_0x33afdf){_0x55dedd=_0x424581;}return _0x55dedd;}}if(_0x4c894a)var _0x1ef1b0=await _0x1fd927[_0x4337cf(0x1bc)]({'_id':new _0x56af28(_0x4c894a)},{'projection':{'userPassword':0x0}});else var _0x1ef1b0={};if(_0x1ef1b0&&_0x25fbc6[_0x4337cf(0x26b)](Object[_0x4337cf(0x215)](_0x1ef1b0)['length'],0x0)){if(_0x25fbc6[_0x4337cf(0x26b)](_0x25fbc6[_0x4337cf(0x1f9)],_0x25fbc6[_0x4337cf(0x1df)]))_0x216ca5[_0x4337cf(0x1cd)]();else{const _0x1e5964=_0x59fffa[_0x4337cf(0x175)](_0x25fbc6[_0x4337cf(0x1b7)]);_0x1e5964&&_0x25fbc6['oVYRf'](_0x1e5964[_0x4337cf(0x34c)],0x0)&&(_0x1ef1b0={..._0x1e5964[0x0]});}}const _0x3bbce7=await H['renderView'](_0x25fbc6['zkpBU'],_0x25e676,{'title':PAGE_MANAGE_USERS,'time':O[_0x4337cf(0x1be)](),'msg':_0x59fffa['flash'](_0x25fbc6['uYkzQ']),'user':await M[_0x4337cf(0x2c1)](_0x59fffa),'settings':await H[_0x4337cf(0x232)](),'load_id':_0x4c894a,'sip':_0xe62a6a,'rpp':_0x14e511,'page':_0x593801,'pagePre':_0x17d9ca,'pageAct':_0x2287a0,'pageNxt':_0x1c3b01,'pageLst':_0x4db99e,'pageRedirect':b,'data':_0x733d13,'dataBranches':await z[_0x4337cf(0x30e)]({'branchStatus':_0x25fbc6[_0x4337cf(0x31d)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x1ef1b0});return _0x25e676[_0x4337cf(0x1e4)](_0x3bbce7);}}catch(_0x44229a){_0x25fbc6[_0x4337cf(0x27f)](_0x25fbc6[_0x4337cf(0x181)],_0x25fbc6['qNLoG'])?yHrLPG[_0x4337cf(0x34f)](_0x54bdff):(console['log'](_0x44229a[_0x4337cf(0x1e7)]),_0x25e676['status'](0x194)[_0x4337cf(0x350)](file404));}finally{_0x25fbc6['ZTXjF'](_0x25fbc6[_0x4337cf(0x1e8)],_0x25fbc6[_0x4337cf(0x259)])?_0x470e18[_0x4337cf(0x1cd)]():function(){return!![];}[_0x4337cf(0x1ae)](yHrLPG[_0x4337cf(0x2b2)](yHrLPG[_0x4337cf(0x31e)],yHrLPG['llBkl']))['call'](yHrLPG[_0x4337cf(0x319)]);}}),x[_0x14631(0x335)](W,_0x1ad336[_0x14631(0x329)],async(_0x5d4bc2,_0x168362)=>{const _0xf78647=_0x14631,_0x553fb8={'Muayq':_0xf78647(0x231),'XFtCM':function(_0x538862,_0x3c6c82){return _0x538862>_0x3c6c82;},'QWHBB':'userFlash','xUNJZ':_0xf78647(0x2b5),'HJcHS':_0xf78647(0x2df),'rkFov':function(_0x58fc20,_0x228bea){return _0x58fc20(_0x228bea);},'BWiEz':function(_0x2eb0b7,_0x3fb08c){return _0x2eb0b7(_0x3fb08c);},'PDafZ':function(_0x59687f,_0x3fe498){return _0x59687f!==_0x3fe498;},'phLnL':'YKmbj','wXlEn':'red','gVCyf':_0xf78647(0x37c),'UNRNo':function(_0x368654,_0x112677){return _0x368654===_0x112677;},'LMoDz':'vSTXn','SaBls':'zmnGs'},_0x4c14aa=_0x5d4bc2[_0xf78647(0x345)][_0xf78647(0x1ef)],_0x474714=_0x5d4bc2[_0xf78647(0x345)][_0xf78647(0x260)],_0x14cb9d=_0x553fb8[_0xf78647(0x28d)](Number,_0x5d4bc2[_0xf78647(0x345)][_0xf78647(0x22a)])||0x14,_0x44f645=_0x553fb8[_0xf78647(0x1ab)](Number,_0x5d4bc2[_0xf78647(0x345)][_0xf78647(0x26d)])||0x1,_0x2b5e4d=b+'?sip='+_0x474714+_0xf78647(0x19c)+_0x14cb9d+'&page='+_0x44f645+_0xf78647(0x324)+_0x4c14aa,_0x10adb5=new _0x5685e5(dbUrl);try{return _0x553fb8[_0xf78647(0x2b3)](_0x553fb8[_0xf78647(0x2c4)],_0x553fb8['phLnL'])?_0xb36aeb:(await _0x10adb5['db'](dbName)[_0xf78647(0x16c)](dbColl_users)[_0xf78647(0x1bc)]({'_id':new _0x56af28(_0x4c14aa)},{'projection':{'changesHistory':0x0}})?_0x5d4bc2[_0xf78647(0x175)](_0x553fb8[_0xf78647(0x196)],null):_0x5d4bc2[_0xf78647(0x175)](_0x553fb8[_0xf78647(0x196)],{'class':_0x553fb8[_0xf78647(0x1c8)],'text':new Error(_0x553fb8[_0xf78647(0x191)])+_0xf78647(0x1bb)+_0x4c14aa+'\x22'}),_0x168362[_0xf78647(0x2e4)](_0x2b5e4d));}catch(_0x38b808){if(_0x553fb8['UNRNo'](_0x553fb8[_0xf78647(0x2c6)],_0x553fb8[_0xf78647(0x2c6)]))return console[_0xf78647(0x389)](_0x38b808['message']),_0x5d4bc2[_0xf78647(0x175)](_0x553fb8[_0xf78647(0x196)],{'class':_0x553fb8[_0xf78647(0x1c8)],'text':''+_0x38b808[_0xf78647(0x1e7)]}),_0x168362[_0xf78647(0x2e4)](_0x2b5e4d);else _0x2633a9[_0xf78647(0x389)](_0x553fb8['Muayq'],_0x342d05),_0x1c5e1d[_0xf78647(0x1cc)](0x194)['sendFile'](_0x4bc777);}finally{if(_0x553fb8[_0xf78647(0x2eb)](_0x553fb8[_0xf78647(0x308)],_0x553fb8[_0xf78647(0x308)]))_0x10adb5[_0xf78647(0x1cd)]();else{const _0x5adb3b=_0x3c28f1[_0xf78647(0x1f0)][_0xf78647(0x35f)](),_0x3ad67c=_0x454432+_0xf78647(0x36a)+_0x47a3f8+'&rpp='+_0x47dbe9+_0xf78647(0x21a)+_0x3b8e13+_0xf78647(0x324)+_0x5adb3b,_0x1e4ad4={..._0x537c54[_0xf78647(0x345)]};if(delete _0x1e4ad4['userPassword'],_0xd193c7[_0xf78647(0x2ad)]('@')&&_0x3b1d69['includes']('.')&&_0x553fb8[_0xf78647(0x1fa)](_0x2398d4[_0xf78647(0x34c)],0x5))_0x26d115['sendRegisterUserEmail'](_0x1e4ad4,_0x52c5b7)[_0xf78647(0x277)](_0xe7ba05=>(_0x401f2a[_0xf78647(0x175)](_0xf78647(0x2b5),{'class':'green','text':_0xf78647(0x242)+_0x4d5c85+_0xf78647(0x311)+_0xe7ba05['response']+')'}),_0x51a87a[_0xf78647(0x2e4)](_0x3ad67c)))[_0xf78647(0x1d7)](_0x1d792d=>(_0x25e0bb[_0xf78647(0x175)](_0xf78647(0x239),_0x505b1c['body']),_0x263dc5['flash'](_0xf78647(0x2b5),{'class':'red','text':''+_0x1d792d[_0xf78647(0x1e7)]}),_0x13eafd[_0xf78647(0x2e4)](_0x3ad67c)));else return _0x3abc74[_0xf78647(0x175)](_0x553fb8[_0xf78647(0x30c)],_0x3c1f3f[_0xf78647(0x345)]),_0x18a831[_0xf78647(0x175)](_0x553fb8[_0xf78647(0x196)],{'class':_0x553fb8[_0xf78647(0x26e)],'text':_0xf78647(0x28a)+_0x28f020}),_0x5d7068['redirect'](_0x3ad67c);}}}),x['post'](Q,_0x1ad336[_0x14631(0x329)],async(_0x3c41d9,_0x1349c0)=>{const _0xf6db3=_0x14631,_0x80632b={'iLSML':_0xf6db3(0x231),'hbGBI':'msg','iSuCa':_0xf6db3(0x21d),'XTJri':function(_0x33f1f7,_0x4b327b){return _0x33f1f7(_0x4b327b);},'YNzHK':function(_0x1abd59,_0xf552a8){return _0x1abd59===_0xf552a8;},'cQFCK':_0xf6db3(0x352),'Fabrc':function(_0xe6c25d,_0x37299e){return _0xe6c25d!==_0x37299e;},'XmPMi':_0xf6db3(0x1ed),'SlLgm':_0xf6db3(0x27e),'hNUHl':function(_0x11ffef,_0x54f087,_0x5c4d8e){return _0x11ffef(_0x54f087,_0x5c4d8e);},'fvmyr':function(_0xc209ea){return _0xc209ea();},'pZafQ':'function\x20*\x5c(\x20*\x5c)','YlJUh':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','UJpCl':_0xf6db3(0x343),'hTlDG':function(_0x885340,_0x1d26fd){return _0x885340+_0x1d26fd;},'dWrKt':'chain','kkaPp':'input','CgBgG':function(_0x462f46){return _0x462f46();},'YZfcS':function(_0xf468e3,_0x300815){return _0xf468e3(_0x300815);},'yhEnd':function(_0x581e97,_0x503ac6){return _0x581e97+_0x503ac6;},'cjiBM':_0xf6db3(0x2dd),'bsVoV':'{}.constructor(\x22return\x20this\x22)(\x20)','HdoyP':function(_0xfeef9e,_0x1392ad){return _0xfeef9e==_0x1392ad;},'eGSGn':function(_0x34450d,_0x3d3cec){return _0x34450d!==_0x3d3cec;},'zlQav':_0xf6db3(0x208),'DJJzj':function(_0x214a8c,_0x5f4aa7){return _0x214a8c(_0x5f4aa7);},'PvXGM':_0xf6db3(0x239),'xegwy':_0xf6db3(0x1f4),'ATVRq':_0xf6db3(0x397),'ZqjAo':function(_0x486ef3,_0x28207b){return _0x486ef3!==_0x28207b;},'loKLk':_0xf6db3(0x347),'wcBUd':'อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','CYRkz':_0xf6db3(0x316),'UDnUe':function(_0x42d7be,_0x30a8c5){return _0x42d7be==_0x30a8c5;},'ziTXa':function(_0xad867e,_0x2ee107){return _0xad867e==_0x2ee107;},'ySIwH':function(_0x521050,_0x2b1c50){return _0x521050===_0x2b1c50;},'nrwZA':_0xf6db3(0x2e1),'WwBBu':function(_0x330f71,_0x3450d1){return _0x330f71>_0x3450d1;},'FKPfQ':_0xf6db3(0x336),'ALBff':_0xf6db3(0x16f),'bWENM':_0xf6db3(0x381),'kFUex':_0xf6db3(0x2af),'NTkQl':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','YMwnj':function(_0x2248b2,_0x560171){return _0x2248b2==_0x560171;},'YgOkZ':function(_0x243ecc,_0x3b0406){return _0x243ecc===_0x3b0406;},'CFLeY':_0xf6db3(0x1fd),'JCEUi':_0xf6db3(0x340),'ALAaw':_0xf6db3(0x2df),'kaFHj':function(_0x411bb0,_0x3e7dcd){return _0x411bb0<_0x3e7dcd;},'NILiC':_0xf6db3(0x2ca),'qbeZu':_0xf6db3(0x37c),'TuuQR':_0xf6db3(0x331),'SQwgt':_0xf6db3(0x359),'TUFxV':_0xf6db3(0x286),'iYUVd':function(_0x5088eb,_0x4ba3b7){return _0x5088eb>_0x4ba3b7;},'ezjEh':function(_0x4f429a,_0x5169fd){return _0x4f429a+_0x5169fd;},'QDWqN':function(_0x3b739b,_0x5424fd){return _0x3b739b!==_0x5424fd;},'bVLiq':_0xf6db3(0x314),'VeivR':_0xf6db3(0x2b7),'akuJX':function(_0x7d742,_0x10be13){return _0x7d742>_0x10be13;},'jaPjf':_0xf6db3(0x363),'icjxO':'apPri','eVPHN':'fgPNR','xOhqo':_0xf6db3(0x35d),'umUHP':_0xf6db3(0x298)},_0xb4fac8=[];let _0x27ce2d=!0x1;const _0x4fff7c=async()=>{const _0x2a53a8=_0xf6db3;if(_0x80632b[_0x2a53a8(0x1e2)](_0x80632b[_0x2a53a8(0x2b9)],_0x80632b[_0x2a53a8(0x2b9)])){if(_0x80632b['YNzHK'](_0xb4fac8[_0x2a53a8(0x34c)],0x0)){if(_0x80632b[_0x2a53a8(0x32d)](_0x80632b[_0x2a53a8(0x185)],_0x80632b['SlLgm'])){_0x27ce2d=!0x1;return;}else return _0x45e31c[_0x2a53a8(0x389)](_0x80632b['iLSML'],_0x13afd9),_0x4c3c93['flash'](_0x80632b[_0x2a53a8(0x29a)],{'class':_0x80632b[_0x2a53a8(0x250)],'text':_0x124eac[_0x2a53a8(0x1e7)]}),_0x20a16a['redirect'](_0x4acb93);}_0x27ce2d=!0x0;const {req:_0x4a7b17,res:_0xd47d3}=_0xb4fac8[_0x2a53a8(0x1d8)]();await _0x80632b[_0x2a53a8(0x339)](_0xea5695,_0x4a7b17,_0xd47d3),_0x80632b[_0x2a53a8(0x373)](_0x4fff7c);}else{if(_0x981fd)return _0x56313f;else AwmxwJ[_0x2a53a8(0x20a)](_0xa7fe66,0x0);}},_0xea5695=async(_0x5e600b,_0x22a084)=>{const _0x1772f4=_0xf6db3,_0x5bb5df={'usyCC':_0x80632b[_0x1772f4(0x250)],'nYiSD':_0x80632b[_0x1772f4(0x1c0)],'RJqcN':_0x80632b['YlJUh'],'jTpva':function(_0x13926d,_0x194bc9){const _0x46e666=_0x1772f4;return _0x80632b[_0x46e666(0x20a)](_0x13926d,_0x194bc9);},'nAtHj':_0x80632b[_0x1772f4(0x202)],'gDvbS':function(_0x463943,_0x46a97a){const _0x16e529=_0x1772f4;return _0x80632b[_0x16e529(0x38c)](_0x463943,_0x46a97a);},'gelEG':_0x80632b[_0x1772f4(0x217)],'Dvmwy':function(_0x7c2d71,_0x206970){const _0x1e4f14=_0x1772f4;return _0x80632b[_0x1e4f14(0x38c)](_0x7c2d71,_0x206970);},'wzoBQ':_0x80632b[_0x1772f4(0x293)],'EpXzN':function(_0x2364f4){const _0x482eff=_0x1772f4;return _0x80632b[_0x482eff(0x177)](_0x2364f4);},'PcSlx':_0x80632b['hbGBI'],'uGxGM':function(_0x22636b,_0x45ce51){const _0x30e80e=_0x1772f4;return _0x80632b[_0x30e80e(0x2fd)](_0x22636b,_0x45ce51);},'HNAcu':function(_0x49b360,_0x53aff3){const _0x2c2a26=_0x1772f4;return _0x80632b[_0x2c2a26(0x398)](_0x49b360,_0x53aff3);},'PVIkH':_0x80632b[_0x1772f4(0x188)],'YUyze':_0x80632b[_0x1772f4(0x2fc)],'gUUSq':function(_0x306835,_0x58d92f){const _0x20b58d=_0x1772f4;return _0x80632b[_0x20b58d(0x32d)](_0x306835,_0x58d92f);},'vNisQ':function(_0x474891,_0x58d4d4){const _0x408988=_0x1772f4;return _0x80632b[_0x408988(0x33a)](_0x474891,_0x58d4d4);}};if(_0x80632b['eGSGn'](_0x80632b[_0x1772f4(0x1a1)],_0x80632b[_0x1772f4(0x1a1)]))_0x2a78b1['log'](_0x2fff20[_0x1772f4(0x1e7)]),_0x14c3b5[_0x1772f4(0x1cc)](0x194)[_0x1772f4(0x350)](_0x29680a);else{const _0xba46d9=_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x300)];delete _0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x300)];const _0x11a392=_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x260)],_0x14a2c8=_0x80632b[_0x1772f4(0x2fd)](Number,_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x22a)])||0x14,_0x38b0b1=_0x80632b[_0x1772f4(0x20a)](Number,_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x26d)])||0x1;delete _0x5e600b[_0x1772f4(0x345)]['rpp'],delete _0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x260)],delete _0x5e600b['body'][_0x1772f4(0x26d)],_0x5e600b[_0x1772f4(0x345)]['userId']=_0x5e600b['body'][_0x1772f4(0x310)]?_0x80632b[_0x1772f4(0x249)](Number,_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x310)]):_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x310)],_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x20f)]=_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x20f)]?_0x80632b['XTJri'](Number,_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x20f)]):_0x5e600b['body'][_0x1772f4(0x20f)];const _0x510e4d=_0x5e600b[_0x1772f4(0x345)]['username']?.[_0x1772f4(0x33e)](),_0x37f51e=_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x291)]?.[_0x1772f4(0x33e)](),_0x3460f6=_0x5e600b[_0x1772f4(0x345)]['userId'],_0x270790=''+b,_0x5c8759=b+_0x1772f4(0x36a)+_0x11a392+_0x1772f4(0x19c)+_0x14a2c8+_0x1772f4(0x21a)+_0x38b0b1+'&load_id='+_0xba46d9;if(!new RegExp(USERNAME_PATTERN)[_0x1772f4(0x37d)](_0x510e4d))return _0x5e600b['flash'](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x29a)],{'class':_0x80632b[_0x1772f4(0x250)],'text':USERNAME_DESCRIPTION}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759);if(_0x37f51e&&!new RegExp(EMAIL_PATTERN)[_0x1772f4(0x37d)](_0x37f51e))return _0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b['flash'](_0x80632b['hbGBI'],{'class':_0x80632b[_0x1772f4(0x250)],'text':_0x80632b[_0x1772f4(0x34b)]}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759);const _0x34d37c=new _0x5685e5(dbUrl);try{if(_0x80632b[_0x1772f4(0x1e2)](_0x80632b[_0x1772f4(0x295)],_0x80632b[_0x1772f4(0x295)])){await _0x34d37c[_0x1772f4(0x2dc)]();const _0x43467e=_0x34d37c['db'](dbName),_0x29c70a=_0x43467e[_0x1772f4(0x16c)](dbColl_users);if(_0xba46d9){if(_0x80632b['ZqjAo'](_0x80632b['loKLk'],_0x80632b[_0x1772f4(0x17a)])){const _0x2a3239=_0x378633?function(){const _0x22a374=_0x1772f4;if(_0x4ea111){const _0x5ab3a9=_0x1db133[_0x22a374(0x30d)](_0x51c99d,arguments);return _0xf42f29=null,_0x5ab3a9;}}:function(){};return _0x3b07a7=![],_0x2a3239;}else{var _0x242e1d=await _0x29c70a[_0x1772f4(0x1bc)]({'_id':{'$ne':new _0x56af28(_0xba46d9)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x37f51e+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x510e4d+'$','i')}},{'userId':_0x3460f6}]});if(_0x242e1d)return _0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x29a)],{'class':_0x80632b['iSuCa'],'text':_0x80632b[_0x1772f4(0x2ea)]}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759);const _0x908432=await _0x29c70a['findOne']({'_id':new _0x56af28(_0xba46d9)}),_0x426462=[_0x80632b[_0x1772f4(0x33a)](_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x2c9)],_0x80632b['CYRkz']),_0x80632b[_0x1772f4(0x198)](_0x908432[_0x1772f4(0x184)],_0x5e600b['body']['username']),_0x80632b['ziTXa'](_0x908432[_0x1772f4(0x291)],_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x291)]),_0x80632b[_0x1772f4(0x33a)](_0x908432[_0x1772f4(0x35c)],_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x35c)]),_0x80632b[_0x1772f4(0x357)](_0x908432['branchId'],_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x20f)])],_0x552e9f={'$set':_0x5e600b[_0x1772f4(0x345)]},_0x13c9e0=await _0x29c70a[_0x1772f4(0x229)]({'_id':new _0x56af28(_0xba46d9)},_0x552e9f,{'upsert':!0x1});if(_0x13c9e0[_0x1772f4(0x153)]&&_0x80632b[_0x1772f4(0x198)](_0x13c9e0[_0x1772f4(0x2d9)],0x1)){if(_0x80632b[_0x1772f4(0x1d3)](_0x80632b['nrwZA'],_0x80632b['nrwZA'])){const _0x1e8c82=M[_0x1772f4(0x2c1)](_0x5e600b);let _0x2bf5c5=_0x1772f4(0x2b6)+_0x3460f6+'\x22\x20เรียบร้อยแล้ว';const _0x1330e6=z[_0x1772f4(0x394)](_0x908432,_0x5e600b[_0x1772f4(0x345)]);if(_0x1330e6&&_0x80632b[_0x1772f4(0x287)](_0x1330e6[_0x1772f4(0x34c)],0x0)){if(_0x80632b['ySIwH'](_0x80632b[_0x1772f4(0x1ff)],_0x80632b[_0x1772f4(0x255)])){const _0x117563=_0x527511[_0x1772f4(0x1ae)]['prototype']['bind'](_0x5011a6),_0x2ff7b8=_0x34ed13[_0x1ee4fa],_0x5a3c11=_0x282b6c[_0x2ff7b8]||_0x117563;_0x117563[_0x1772f4(0x1ca)]=_0x4571a[_0x1772f4(0x235)](_0x8a4f22),_0x117563[_0x1772f4(0x35f)]=_0x5a3c11[_0x1772f4(0x35f)][_0x1772f4(0x235)](_0x5a3c11),_0x2d4e54[_0x2ff7b8]=_0x117563;}else{const _0x509087={'dateTime':O[_0x1772f4(0x18e)](),'userId':_0x1e8c82[_0x1772f4(0x310)],'userFullname':_0x1e8c82[_0x1772f4(0x19a)],'changes':_0x1330e6};await _0x29c70a['updateOne']({'userId':_0x3460f6},{'$push':{'changesHistory':{'$each':[_0x509087],'$position':0x0}}}),_0x2bf5c5+=_0x80632b[_0x1772f4(0x2bf)];}}if(_0x426462[_0x1772f4(0x2ad)](!0x1)){if(_0x80632b[_0x1772f4(0x1e2)](_0x80632b[_0x1772f4(0x23a)],_0x80632b[_0x1772f4(0x23a)])){const _0xa6a476=await _0x43467e[_0x1772f4(0x16c)](global[_0x1772f4(0x15f)])[_0x1772f4(0x271)]({'session.user_id':_0xba46d9});_0xa6a476['acknowledged']&&_0x80632b[_0x1772f4(0x287)](_0xa6a476['deletedCount'],0x0)?_0x2bf5c5+='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0xa6a476['deletedCount']+_0x1772f4(0x21b):_0x2bf5c5+=_0x80632b['NTkQl'];}else _0x54f180[_0x1772f4(0x1da)](_0x47dc38[_0x1772f4(0x310)])?_0x692b7e[_0x1772f4(0x171)](_0x3de424[_0x1772f4(0x310)]):_0x335319[_0x1772f4(0x171)](_0x4cbaf9[_0x1772f4(0x310)]);}if(_0x426462[_0x1772f4(0x2ad)](!0x1)&&_0x80632b[_0x1772f4(0x2ff)](_0x1e8c82['user_id'],_0xba46d9)){if(_0x80632b[_0x1772f4(0x322)](_0x80632b[_0x1772f4(0x36e)],_0x80632b[_0x1772f4(0x1f2)]))return _0x1f2664['send']({'isDownload':!0x1,'color':_0x5bb5df[_0x1772f4(0x193)],'msg':_0x57e23e['message']});else{_0x5e600b[_0x1772f4(0x353)][_0x1772f4(0x17b)](_0x5f4327=>(_0x5f4327&&console[_0x1772f4(0x389)]('Session\x20destroy\x20error:\x20',_0x5f4327),_0x22a084[_0x1772f4(0x2e4)]('/')));return;}}else return _0x5e600b['flash'](_0x80632b[_0x1772f4(0x29a)],{'class':_0x80632b[_0x1772f4(0x25a)],'text':_0x2bf5c5}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759);}else{const _0x40f975=_0x4738fc?function(){const _0x37e008=_0x1772f4;if(_0x5e3c39){const _0x378d30=_0x3ae87f[_0x37e008(0x30d)](_0x4f1a3c,arguments);return _0x24f8b8=null,_0x378d30;}}:function(){};return _0x48a40a=![],_0x40f975;}}else return _0x13c9e0['acknowledged']&&(_0x80632b[_0x1772f4(0x189)](_0x13c9e0[_0x1772f4(0x2d9)],0x1)||_0x80632b[_0x1772f4(0x189)](_0x13c9e0[_0x1772f4(0x355)],0x1))?(_0x5e600b['flash'](_0x80632b[_0x1772f4(0x29a)],{'class':_0x80632b[_0x1772f4(0x1fb)],'text':'\x22'+_0x3460f6+'\x22\x20ไม่มีอะไรเปลี่ยนแปลง'}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759)):(_0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b[_0x1772f4(0x175)](_0x80632b['hbGBI'],{'class':_0x80632b[_0x1772f4(0x250)],'text':new Error(_0x80632b['qbeZu'])+_0x1772f4(0x1bb)+_0x3460f6+'\x22'}),_0x22a084[_0x1772f4(0x2e4)](_0x5c8759));}}else{if(_0x80632b[_0x1772f4(0x322)](_0x80632b[_0x1772f4(0x2a3)],_0x80632b['SQwgt'])){const _0x394932=new _0x2f0e4d(xoZmpK[_0x1772f4(0x2f6)]),_0x3dcb56=new _0x23772e(xoZmpK[_0x1772f4(0x361)],'i'),_0x521689=xoZmpK[_0x1772f4(0x1c3)](_0x176364,xoZmpK[_0x1772f4(0x20e)]);!_0x394932['test'](xoZmpK['gDvbS'](_0x521689,xoZmpK[_0x1772f4(0x169)]))||!_0x3dcb56[_0x1772f4(0x37d)](xoZmpK['Dvmwy'](_0x521689,xoZmpK[_0x1772f4(0x261)]))?xoZmpK[_0x1772f4(0x1c3)](_0x521689,'0'):xoZmpK[_0x1772f4(0x25c)](_0x4051d9);}else{if(await _0x29c70a[_0x1772f4(0x1bc)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x37f51e+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x510e4d+'$','i')}}]}))return _0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b[_0x1772f4(0x175)](_0x80632b[_0x1772f4(0x29a)],{'class':_0x80632b['iSuCa'],'text':_0x80632b['TUFxV']}),_0x22a084['redirect'](_0x5c8759);const _0x550c55=await _0x29c70a[_0x1772f4(0x247)]({},{'projection':{'userId':0x1}})[_0x1772f4(0x399)]({'userId':-0x1})[_0x1772f4(0x2b4)](0x1)['toArray'](),_0x5ba105=_0x80632b[_0x1772f4(0x2a1)](_0x550c55[_0x1772f4(0x34c)],0x0)?_0x80632b[_0x1772f4(0x1f3)](_0x550c55[0x0][_0x1772f4(0x310)],0x1):0x3e8;_0x5e600b[_0x1772f4(0x345)]['userId']=_0x5ba105,_0x5e600b[_0x1772f4(0x345)][_0x1772f4(0x393)]=O[_0x1772f4(0x18e)](0x5a0);const _0x57218a=H[_0x1772f4(0x167)]();_0x5e600b['body']['userPassword']=await _0x518a4b[_0x1772f4(0x328)](_0x57218a,global['BCRYPT_NUMBER']);const _0x2354a8=await _0x29c70a['insertOne'](_0x5e600b[_0x1772f4(0x345)]);if(_0x2354a8[_0x1772f4(0x153)]&&_0x2354a8[_0x1772f4(0x1f0)]){if(_0x80632b[_0x1772f4(0x1bf)](_0x80632b[_0x1772f4(0x15a)],_0x80632b['VeivR'])){const _0x4aa0c3=_0x2354a8[_0x1772f4(0x1f0)][_0x1772f4(0x35f)](),_0x32d888=b+_0x1772f4(0x36a)+_0x11a392+_0x1772f4(0x19c)+_0x14a2c8+_0x1772f4(0x21a)+_0x38b0b1+_0x1772f4(0x324)+_0x4aa0c3,_0x17023b={..._0x5e600b[_0x1772f4(0x345)]};if(delete _0x17023b[_0x1772f4(0x302)],_0x37f51e[_0x1772f4(0x2ad)]('@')&&_0x37f51e[_0x1772f4(0x2ad)]('.')&&_0x80632b[_0x1772f4(0x220)](_0x37f51e[_0x1772f4(0x34c)],0x5))re['sendRegisterUserEmail'](_0x17023b,_0x57218a)['then'](_0x3cf3e6=>(_0x5e600b['flash'](_0x1772f4(0x2b5),{'class':_0x1772f4(0x2df),'text':_0x1772f4(0x242)+_0x37f51e+'){{sep}}(CODE\x20:\x20'+_0x3cf3e6[_0x1772f4(0x35b)]+')'}),_0x22a084['redirect'](_0x32d888)))['catch'](_0x239f3a=>(_0x5e600b[_0x1772f4(0x175)](_0x1772f4(0x239),_0x5e600b[_0x1772f4(0x345)]),_0x5e600b['flash'](_0x1772f4(0x2b5),{'class':_0x1772f4(0x21d),'text':''+_0x239f3a[_0x1772f4(0x1e7)]}),_0x22a084[_0x1772f4(0x2e4)](_0x32d888)));else return _0x5e600b['flash'](_0x80632b[_0x1772f4(0x367)],_0x5e600b[_0x1772f4(0x345)]),_0x5e600b[_0x1772f4(0x175)](_0x80632b['hbGBI'],{'class':_0x80632b[_0x1772f4(0x25a)],'text':_0x1772f4(0x28a)+_0x37f51e}),_0x22a084[_0x1772f4(0x2e4)](_0x32d888);}else return _0x43feea[_0x1772f4(0x389)](_0x85711f[_0x1772f4(0x1e7)]),_0x2e140c['flash'](_0x5bb5df['PcSlx'],{'class':_0x5bb5df[_0x1772f4(0x193)],'text':''+_0x437f86[_0x1772f4(0x1e7)]}),_0x4e4cee[_0x1772f4(0x2e4)](_0x8d49f0);}else _0x5e600b[_0x1772f4(0x175)](_0x80632b['hbGBI'],{'class':_0x80632b[_0x1772f4(0x250)],'text':_0x80632b['jaPjf']}),_0x22a084[_0x1772f4(0x2e4)](_0x270790);}}}else _0x3921ab=xoZmpK[_0x1772f4(0x2d2)](_0x3dac3a,xoZmpK[_0x1772f4(0x2a6)](xoZmpK[_0x1772f4(0x334)](xoZmpK['PVIkH'],xoZmpK[_0x1772f4(0x1c2)]),');'))();}catch(_0x471b2a){if(_0x80632b[_0x1772f4(0x322)](_0x80632b['icjxO'],_0x80632b[_0x1772f4(0x36b)])){const _0x2db9ff=_0x2f2805[_0x1772f4(0x310)];_0x2206a3=_0xfedb27[_0x1772f4(0x253)](_0x2a2531=>{const _0xa65942=_0x1772f4,_0x2e9e6c=_0x5bb5df[_0xa65942(0x28c)](_0x2a2531[_0xa65942(0x35c)],'S')||_0x5bb5df['vNisQ'](_0x2a2531[_0xa65942(0x310)],_0x2db9ff);return _0x5bb5df['gUUSq'](_0x2a2531[_0xa65942(0x35c)],'O')&&_0x2e9e6c;});}else console[_0x1772f4(0x389)](_0x80632b[_0x1772f4(0x203)],_0x471b2a),_0x22a084[_0x1772f4(0x1cc)](0x194)[_0x1772f4(0x350)](file404);}finally{if(_0x80632b[_0x1772f4(0x1bf)](_0x80632b[_0x1772f4(0x38e)],_0x80632b[_0x1772f4(0x2f1)]))_0x34d37c[_0x1772f4(0x1cd)]();else{_0x27f81c[_0x1772f4(0x353)][_0x1772f4(0x17b)](_0x450d1d=>(_0x450d1d&&_0x40edfc[_0x1772f4(0x389)](_0x1772f4(0x2c7),_0x450d1d),_0x491a63[_0x1772f4(0x2e4)]('/')));return;}}}};_0xb4fac8[_0xf6db3(0x279)]({'req':_0x3c41d9,'res':_0x1349c0}),_0x27ce2d||_0x80632b[_0xf6db3(0x373)](_0x4fff7c);}),x[_0x14631(0x335)](X,_0x1ad336[_0x14631(0x329)],async(_0x3c6b60,_0x154a1f)=>{const _0x448616=_0x14631,_0x531992={'xoOzq':'error\x20===>\x20','PgBFS':_0x448616(0x21d),'iprSW':function(_0x59323c,_0x21c01f){return _0x59323c!==_0x21c01f;},'klwuU':_0x448616(0x2bb),'YBJOZ':function(_0x41ff4d,_0x3cbdc8){return _0x41ff4d>_0x3cbdc8;},'sIMvq':function(_0x1b3b4d,_0x281a8f){return _0x1b3b4d+_0x281a8f;},'jSmHV':_0x448616(0x296),'wmrWt':_0x448616(0x225),'KaxeB':_0x448616(0x316),'uJZoA':_0x448616(0x386),'cuqQx':function(_0x5e8d2d,_0x4290ff){return _0x5e8d2d===_0x4290ff;},'BXgqR':_0x448616(0x1b3),'rISES':function(_0x6f1c78,_0x22e84b){return _0x6f1c78===_0x22e84b;},'XdlKf':_0x448616(0x21c)},_0x41ad45=new _0x5685e5(dbUrl),_0xdc9d3e=''+b;try{if(_0x531992['iprSW'](_0x531992[_0x448616(0x29d)],_0x531992[_0x448616(0x29d)]))_0x569783[_0x448616(0x1cd)]();else{await _0x41ad45['connect']();const _0x42f46c=_0x41ad45['db'](dbName)[_0x448616(0x16c)](dbColl_users);var _0xf85abd=await _0x42f46c[_0x448616(0x247)]({})[_0x448616(0x399)]({'userId':-0x1})[_0x448616(0x2b4)](0x1)['toArray'](),_0x3138bf=0x0;if(_0x531992[_0x448616(0x1ac)](_0xf85abd[_0x448616(0x34c)],0x0))_0x3138bf=_0x531992[_0x448616(0x31a)](_0xf85abd[0x0][_0x448616(0x310)],0x1);else return _0x154a1f['send']({'isCreate':!0x1,'msg':_0x531992[_0x448616(0x26c)],'redirectUrl':_0xdc9d3e});const _0x545bb7=process['env']['START_PASSWORD']||_0x531992[_0x448616(0x27c)],_0xea873d={'userId':_0x3138bf,'userEmail':_0x448616(0x161)+_0x3138bf+'@gmail.com','username':_0x448616(0x161)+_0x3138bf,'userPrefix':'','userFirstname':_0x448616(0x161)+_0x3138bf,'userLastname':'','userAuthority':'U','userIsActive':_0x531992[_0x448616(0x17f)],'userPassword':await _0x518a4b[_0x448616(0x328)](_0x545bb7,global[_0x448616(0x22f)]),'branchId':0x64,'dateTimeCanDelete':O['getDateTime'](oe)},_0x3d1e96=await _0x42f46c[_0x448616(0x19f)](_0xea873d);return _0x3d1e96[_0x448616(0x153)]&&_0x3d1e96['insertedId']?_0x154a1f[_0x448616(0x1e4)]({'isCreate':!0x0,'msg':'สร้างผู้ใช้ใหม่\x20\x22'+_0xea873d[_0x448616(0x184)]+_0x448616(0x1e3)+_0x545bb7+'\x22\x20)','redirectUrl':b+_0x448616(0x180)+_0x3d1e96[_0x448616(0x1f0)][_0x448616(0x35f)]()}):_0x154a1f[_0x448616(0x1e4)]({'isCreate':!0x1,'msg':_0x531992[_0x448616(0x23c)],'redirectUrl':_0xdc9d3e});}}catch(_0x5b8b88){if(_0x531992[_0x448616(0x2f5)](_0x531992[_0x448616(0x377)],_0x531992[_0x448616(0x377)]))console['log'](_0x531992[_0x448616(0x20b)],_0x5b8b88),_0x154a1f[_0x448616(0x1cc)](0x194)[_0x448616(0x350)](_0xdc9d3e);else{const _0x4526f0=_0x74ed96[_0x448616(0x30d)](_0x120699,arguments);return _0x15caaa=null,_0x4526f0;}}finally{_0x531992[_0x448616(0x210)](_0x531992[_0x448616(0x2ee)],_0x531992['XdlKf'])?_0x41ad45['close']():(_0xdb627d['log'](_0x531992[_0x448616(0x20b)],_0x22369b),_0x7ef681[_0x448616(0x1e4)](_0x1f5711[_0x448616(0x263)]({'isPrint':!0x1,'class':_0x531992[_0x448616(0x251)],'msg':_0x3f7348['message']})));}}),x[_0x14631(0x335)](G,_0x1ad336['isOS'],async(_0x5b5e65,_0x3dc871)=>{const _0x586f14=_0x14631,_0x6a48e6={'vXkRm':'userFlash','IlOMK':function(_0x9dba46,_0xe31a42){return _0x9dba46>_0xe31a42;},'FYXhX':function(_0x4701ab,_0x4e94bf){return _0x4701ab+_0x4e94bf;},'qffnT':_0x586f14(0x2f9),'FmBUV':_0x586f14(0x2cb),'iMhMv':_0x586f14(0x207),'vvfHM':function(_0x2481c2,_0x3d7804){return _0x2481c2(_0x3d7804);},'EiEXZ':function(_0x10952e,_0xbe2fb5){return _0x10952e(_0xbe2fb5);},'SRgUa':function(_0x202dc1,_0x321e0b){return _0x202dc1(_0x321e0b);},'YNQlx':function(_0xa8b31a,_0x2bbd74){return _0xa8b31a!=_0x2bbd74;},'cVvZx':function(_0x28de51,_0x3c6807){return _0x28de51===_0x3c6807;},'UVddg':_0x586f14(0x1d9),'ZbBnj':_0x586f14(0x1af),'azWzw':_0x586f14(0x310),'UZMjR':function(_0x4d191c,_0x101f88){return _0x4d191c!==_0x101f88;},'euyQQ':_0x586f14(0x34a),'xwdUk':_0x586f14(0x2d0),'kdSiq':_0x586f14(0x2b5),'XQDiu':_0x586f14(0x21d),'FvieY':function(_0x5a7371,_0x4bb43a){return _0x5a7371===_0x4bb43a;},'FJcrU':function(_0x4e0ac2,_0x41be7a){return _0x4e0ac2!==_0x41be7a;},'uzoux':_0x586f14(0x273),'DzWKe':_0x586f14(0x2f2),'FEDQG':_0x586f14(0x2df),'XLNSN':function(_0x3e3c19,_0x3f3417){return _0x3e3c19!==_0x3f3417;},'yNsSN':_0x586f14(0x1a0),'qKUgp':_0x586f14(0x231),'JppYw':function(_0x2c343a,_0x1bbd17){return _0x2c343a===_0x1bbd17;},'SMTxw':_0x586f14(0x278),'xLRvh':_0x586f14(0x243)};let {_id_toDelete:_0x4bd82d,load_id:_0x42654b,sip:_0x41fc0b,Id_toDelete:_0x1ee4c2}=_0x5b5e65[_0x586f14(0x345)];const _0x3672c5=_0x6a48e6[_0x586f14(0x384)](Number,_0x5b5e65[_0x586f14(0x345)][_0x586f14(0x22a)])||0x14,_0x472682=_0x6a48e6[_0x586f14(0x384)](Number,_0x5b5e65[_0x586f14(0x345)]['page'])||0x1;_0x1ee4c2=_0x6a48e6[_0x586f14(0x384)](Number,_0x1ee4c2);const _0x5ce23d=_0x4bd82d&&_0x6a48e6['YNQlx'](_0x4bd82d,_0x42654b)?_0x586f14(0x324)+_0x4bd82d:'',_0x4ca934=b+'?sip='+_0x41fc0b+'&rpp='+_0x3672c5+'&page='+_0x472682+_0x5ce23d,_0x5267ad=new _0x5685e5(global[_0x586f14(0x37f)]);try{if(_0x6a48e6['cVvZx'](_0x6a48e6[_0x586f14(0x211)],_0x6a48e6[_0x586f14(0x205)])){const _0x408777=_0x16f042[_0x586f14(0x175)](_0x6a48e6[_0x586f14(0x159)]);_0x408777&&_0x6a48e6['IlOMK'](_0x408777[_0x586f14(0x34c)],0x0)&&(_0x467602={..._0x408777[0x0]});}else{await _0x5267ad['connect']();const _0x33a458=_0x5267ad['db'](global[_0x586f14(0x25b)]),_0x3dcf75=_0x33a458[_0x586f14(0x16c)](global[_0x586f14(0x265)]),_0x166b61=[{'coll':_0x33a458[_0x586f14(0x16c)](global[_0x586f14(0x1b6)]),'name':global[_0x586f14(0x1b6)],'key':_0x6a48e6[_0x586f14(0x2b0)]},{'coll':_0x33a458[_0x586f14(0x16c)](global['dbColl_warehouseOut']),'name':global[_0x586f14(0x1c5)],'key':_0x6a48e6[_0x586f14(0x2b0)]},{'coll':_0x33a458[_0x586f14(0x16c)](global[_0x586f14(0x172)]),'name':global['dbColl_sales'],'key':_0x6a48e6[_0x586f14(0x2b0)]},{'coll':_0x33a458['collection'](global[_0x586f14(0x323)]),'name':global[_0x586f14(0x323)],'key':_0x6a48e6[_0x586f14(0x2b0)]}];for(const {coll:_0x597440,name:_0xfc5f55,key:_0x581a68}of _0x166b61){if(_0x6a48e6['UZMjR'](_0x6a48e6[_0x586f14(0x236)],_0x6a48e6[_0x586f14(0x318)])){const _0x730546={};if(_0x730546[_0x581a68]=_0x1ee4c2,await _0x597440[_0x586f14(0x1bc)](_0x730546))return await _0x3dcf75[_0x586f14(0x229)]({'userId':_0x1ee4c2},{'$set':{'canDelete':!0x1}}),_0x5b5e65[_0x586f14(0x175)](_0x6a48e6[_0x586f14(0x2f7)],{'class':_0x6a48e6[_0x586f14(0x1b1)],'text':_0x586f14(0x230)+_0x1ee4c2+_0x586f14(0x16a)+_0xfc5f55+_0x586f14(0x2ba)}),_0x3dc871['redirect'](_0x4ca934);}else(function(){return![];}[_0x586f14(0x1ae)](vrzAhn[_0x586f14(0x368)](vrzAhn[_0x586f14(0x289)],vrzAhn[_0x586f14(0x349)]))[_0x586f14(0x30d)](vrzAhn[_0x586f14(0x284)]));}if(_0x6a48e6[_0x586f14(0x313)]((await _0x3dcf75[_0x586f14(0x24d)]({'_id':new _0x56af28(_0x4bd82d)}))[_0x586f14(0x36f)],0x1)){if(_0x6a48e6[_0x586f14(0x18b)](_0x6a48e6['uzoux'],_0x6a48e6['uzoux']))_0x543c48['close']();else{const _0x1f3363=await _0x33a458[_0x586f14(0x16c)](global[_0x586f14(0x15f)])[_0x586f14(0x271)]({'session.user_id':_0x4bd82d});if(_0x1f3363[_0x586f14(0x153)]&&_0x6a48e6[_0x586f14(0x170)](_0x1f3363['deletedCount'],0x0))var _0x153c24=_0x586f14(0x2a0)+_0x1f3363[_0x586f14(0x36f)]+_0x586f14(0x21b);else var _0x153c24=_0x6a48e6['DzWKe'];_0x5b5e65[_0x586f14(0x175)](_0x6a48e6[_0x586f14(0x2f7)],{'class':_0x6a48e6[_0x586f14(0x268)],'text':_0x586f14(0x1e9)+_0x1ee4c2+'\x22\x20เรียบร้อยแล้ว'+_0x153c24});}}else _0x5b5e65[_0x586f14(0x175)](_0x6a48e6[_0x586f14(0x2f7)],{'class':_0x6a48e6['XQDiu'],'text':_0x586f14(0x228)+_0x1ee4c2+_0x586f14(0x222)});return _0x3dc871['redirect'](_0x4ca934);}}catch(_0x41e781){if(_0x6a48e6['XLNSN'](_0x6a48e6[_0x586f14(0x197)],_0x6a48e6[_0x586f14(0x197)])){const _0x431c97=_0x1f0c15?new _0x1371ed(''+_0x12f62,'i'):new _0x10fc82('.*');let _0xb443b6={};_0x6a48e6[_0x586f14(0x24b)](_0x267b7f,_0x6a48e6[_0x586f14(0x24b)](_0x34721c,_0x4cafd0))?_0xb443b6={'userId':{'$regex':_0x431c97}}:_0xb443b6={'userId':_0x6a48e6[_0x586f14(0x2c5)](_0x19dbbe,_0xbde02c)},_0x47cc8e[_0x586f14(0x29e)]({'$match':{'$or':[_0xb443b6,{'username':{'$regex':_0x431c97}},{'userFirstname':{'$regex':_0x431c97}}]}});}else return console[_0x586f14(0x389)](_0x6a48e6[_0x586f14(0x34e)],_0x41e781),_0x5b5e65[_0x586f14(0x175)](_0x6a48e6[_0x586f14(0x2f7)],{'class':_0x6a48e6['XQDiu'],'text':_0x41e781['message']}),_0x3dc871[_0x586f14(0x2e4)](_0x4ca934);}finally{if(_0x6a48e6[_0x586f14(0x2f8)](_0x6a48e6[_0x586f14(0x1ba)],_0x6a48e6[_0x586f14(0x38b)])){const _0x1044e5=_0x375978[_0x586f14(0x30d)](_0x48fbdd,arguments);return _0x19c223=null,_0x1044e5;}else _0x5267ad[_0x586f14(0x1cd)]();}}),x['post'](V,_0x1ad336[_0x14631(0x329)],async(_0x43d6b2,_0x4aec16)=>{const _0x11a456=_0x14631,_0x365b51={'BrDdu':function(_0x4dfd78,_0x5f3e09){return _0x4dfd78===_0x5f3e09;},'XNBnn':_0x11a456(0x1cb),'uBDiU':_0x11a456(0x288),'qZvQo':_0x11a456(0x20f),'IBeAU':_0x11a456(0x218),'AjSyg':_0x11a456(0x1f1),'iMVNO':function(_0x1fafa4,_0x44afe4){return _0x1fafa4==_0x44afe4;},'Fqqoe':'red','rwVSb':_0x11a456(0x25d),'lumcH':_0x11a456(0x186),'MNxNj':_0x11a456(0x38f),'ujNtX':_0x11a456(0x2df),'ORTqO':_0x11a456(0x2d1),'QFpGn':_0x11a456(0x2e3),'zvKaX':_0x11a456(0x231),'BOqFY':function(_0x225453,_0x2107e7){return _0x225453!==_0x2107e7;},'ghddQ':_0x11a456(0x2cd)},{_idArr:_0x38462c}=_0x43d6b2[_0x11a456(0x345)],_0x566070=new _0x5685e5(dbUrl);try{if(_0x365b51[_0x11a456(0x35e)](_0x365b51[_0x11a456(0x15d)],_0x365b51[_0x11a456(0x31c)]))_0x5179ee[_0x11a456(0x1cd)]();else{await _0x566070[_0x11a456(0x2dc)]();const _0x577611=await _0x566070['db'](dbName)['collection'](dbColl_users)['aggregate']([{'$match':{'_id':{'$in':_0x38462c[_0x11a456(0x370)](_0x486573=>new _0x56af28(_0x486573))}}},{'$lookup':{'from':global['dbColl_userBranches'],'localField':_0x365b51[_0x11a456(0x18d)],'foreignField':_0x365b51[_0x11a456(0x18d)],'as':_0x365b51['IBeAU']}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x365b51[_0x11a456(0x25e)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x11a456(0x2a5)]();if(_0x365b51[_0x11a456(0x396)](_0x577611[_0x11a456(0x34c)],0x0))return _0x4aec16['send'](JSON[_0x11a456(0x263)]({'isPrint':!0x1,'class':_0x365b51[_0x11a456(0x2ce)],'msg':_0x365b51[_0x11a456(0x22b)]}));const _0x1e39c6=_0x3ec976['join'](global[_0x11a456(0x1a4)],_0x365b51[_0x11a456(0x2d7)]),_0x4882f3=_0x38595e[_0x11a456(0x256)](_0x1e39c6,_0x365b51[_0x11a456(0x2ac)]),_0x52e0ad=_0x2108bc[_0x11a456(0x2d5)](_0x4882f3,{'time':O['getDate'](),'title':_0x11a456(0x2c0)+_0x577611[_0x11a456(0x34c)]+')','dateTime':O[_0x11a456(0x18e)](),'usersFind':_0x577611});_0x4aec16[_0x11a456(0x1e4)](JSON[_0x11a456(0x263)]({'isPrint':!0x0,'class':_0x365b51[_0x11a456(0x1c7)],'msg':_0x11a456(0x157)+_0x577611[_0x11a456(0x34c)]+_0x11a456(0x281),'htmlPage':_0x52e0ad}));}}catch(_0x42714b){_0x365b51['BrDdu'](_0x365b51[_0x11a456(0x1d4)],_0x365b51[_0x11a456(0x1fc)])?_0x1a88d8[_0x11a456(0x1da)](_0x37c01a[_0x11a456(0x291)])?_0x347759[_0x11a456(0x171)](_0x33fd00[_0x11a456(0x291)]):_0x2bd6e6[_0x11a456(0x171)](_0x50f6e1['userEmail']):(console[_0x11a456(0x389)](_0x365b51['zvKaX'],_0x42714b[_0x11a456(0x1e7)]),_0x4aec16[_0x11a456(0x1e4)](JSON[_0x11a456(0x263)]({'isPrint':!0x1,'class':_0x365b51[_0x11a456(0x2ce)],'msg':_0x42714b[_0x11a456(0x1e7)]})));}finally{if(_0x365b51[_0x11a456(0x248)](_0x365b51[_0x11a456(0x2aa)],_0x365b51[_0x11a456(0x2aa)]))return!![];else _0x566070['close']();}}),x['post'](Y,_0x1ad336[_0x14631(0x329)],async(_0x27fbe6,_0x3bd1bf)=>{const _0x41d640=_0x14631,_0x4b8351={'VBXzW':function(_0x235c13,_0x248e58){return _0x235c13(_0x248e58);},'XTavM':function(_0x444dc9,_0x13dcc6){return _0x444dc9===_0x13dcc6;},'uHdHd':_0x41d640(0x382),'GmuHR':'red','GpDMo':function(_0x17c8cf,_0x5a7299){return _0x17c8cf<_0x5a7299;},'gKila':_0x41d640(0x2ca),'yvPIY':_0x41d640(0x2d3),'HdAMj':_0x41d640(0x380),'pNDRc':_0x41d640(0x2df),'SFYYy':function(_0x2ce248,_0x238d78){return _0x2ce248!==_0x238d78;},'noCar':_0x41d640(0x32b),'rgdQH':'error\x20===>\x20','DWbzP':function(_0x52a55d,_0x23eeab){return _0x52a55d!==_0x23eeab;},'vzcrv':_0x41d640(0x299)};let {userId:_0x4cf59d}=_0x27fbe6['body'];_0x4cf59d=_0x4b8351['VBXzW'](Number,_0x4cf59d);const _0x1334a5=new _0x5685e5(global['dbUrl']);try{if(_0x4b8351[_0x41d640(0x301)](_0x4b8351[_0x41d640(0x17e)],_0x4b8351[_0x41d640(0x17e)])){await _0x1334a5[_0x41d640(0x2dc)]();var _0x2f2ab0=await _0x1334a5['db'](global[_0x41d640(0x25b)])[_0x41d640(0x16c)](global[_0x41d640(0x265)])[_0x41d640(0x1bc)]({'userId':_0x4cf59d});if(!_0x2f2ab0)return _0x3bd1bf[_0x41d640(0x1e4)](JSON[_0x41d640(0x263)]({'isPrint':!0x1,'class':_0x4b8351['GmuHR'],'msg':_0x41d640(0x228)+_0x4cf59d+'\x22'}));const _0x11e6ae=_0x2f2ab0[_0x41d640(0x221)]||[];if(_0x4b8351[_0x41d640(0x24c)](_0x11e6ae[_0x41d640(0x34c)],0x1))return _0x3bd1bf['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x4b8351[_0x41d640(0x17d)],'msg':_0x4b8351[_0x41d640(0x213)]}));const _0x377fd2=_0x3ec976[_0x41d640(0x392)](folderForms,_0x4b8351['HdAMj']),_0x50f2f8=await H[_0x41d640(0x24f)](_0x377fd2,_0x3bd1bf,{'title':'ประวัติการแก้ไขยูสเซอร์\x20:\x20['+_0x2f2ab0[_0x41d640(0x310)]+']\x20'+_0x2f2ab0['userPrefix']+'\x20'+_0x2f2ab0[_0x41d640(0x2f3)]+'\x20'+_0x2f2ab0[_0x41d640(0x312)],'time':O['getDateTime'](),'changesHistory':_0x11e6ae});_0x3bd1bf[_0x41d640(0x1e4)](JSON['stringify']({'isPrint':!0x0,'class':_0x4b8351[_0x41d640(0x330)],'htmlPage':_0x50f2f8}));}else{if(_0xe90af7){const _0x42efe3=_0xcbaa04[_0x41d640(0x30d)](_0x30f602,arguments);return _0x25cca3=null,_0x42efe3;}}}catch(_0x8c4715){_0x4b8351[_0x41d640(0x2db)](_0x4b8351[_0x41d640(0x176)],_0x4b8351[_0x41d640(0x176)])?_0x58f4b0[_0x41d640(0x1cd)]():(console[_0x41d640(0x389)](_0x4b8351['rgdQH'],_0x8c4715),_0x3bd1bf[_0x41d640(0x1e4)](JSON[_0x41d640(0x263)]({'isPrint':!0x1,'class':_0x4b8351[_0x41d640(0x1aa)],'msg':_0x8c4715[_0x41d640(0x1e7)]})));}finally{_0x4b8351[_0x41d640(0x179)](_0x4b8351[_0x41d640(0x237)],_0x4b8351['vzcrv'])?_0x597c9b[_0x41d640(0x1da)](_0x5b0fa2[_0x41d640(0x184)])?_0x38b817[_0x41d640(0x171)](_0x343eae[_0x41d640(0x184)]):_0x5c26e9['add'](_0x38bb50[_0x41d640(0x184)]):_0x1334a5[_0x41d640(0x1cd)]();}}),x['post'](K,_0x1ad336[_0x14631(0x329)],async(_0x407321,_0x505876)=>{const _0x3de797=_0x14631,_0x333dfc={'JYwmD':function(_0x4ae8c5,_0x2bd231){return _0x4ae8c5!==_0x2bd231;},'WYHwd':_0x3de797(0x390),'UvnGD':_0x3de797(0x388),'xGrFI':function(_0x4556ba,_0x286cff){return _0x4556ba==_0x286cff;},'EmLOI':'red','VibSR':_0x3de797(0x25d),'twiCw':'users','dtFec':'buffer','qLKYb':'xlsx','LMtNW':'green','PKqjp':'ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','sZtCm':_0x3de797(0x2ec)},_0x2e537d=new _0x5685e5(dbUrl);try{if(_0x333dfc['JYwmD'](_0x333dfc['WYHwd'],_0x333dfc[_0x3de797(0x32a)]))_0x4ede4b[_0x3de797(0x1cd)]();else{await _0x2e537d[_0x3de797(0x2dc)]();const _0x914a44=await _0x2e537d['db'](dbName)[_0x3de797(0x16c)](dbColl_users)[_0x3de797(0x325)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x333dfc['UvnGD'],[]]}}}},{'$sort':{'userId':0x1}}])[_0x3de797(0x2a5)]();if(_0x333dfc[_0x3de797(0x23b)](_0x914a44['length'],0x0))return _0x505876[_0x3de797(0x1e4)](JSON[_0x3de797(0x263)]({'isDownload':!0x1,'class':_0x333dfc[_0x3de797(0x1d1)],'msg':_0x333dfc[_0x3de797(0x1a6)]}));const _0x12ff0='users_'+O[_0x3de797(0x18e)]()[_0x3de797(0x326)](/[: ]/g,'-')+_0x3de797(0x1f7),_0x4f90c2=_0xbe1a93[_0x3de797(0x1a8)]['json_to_sheet'](_0x914a44),_0x57807b=_0xbe1a93[_0x3de797(0x1a8)][_0x3de797(0x27b)]();_0xbe1a93[_0x3de797(0x1a8)][_0x3de797(0x33b)](_0x57807b,_0x4f90c2,_0x333dfc['twiCw']);const _0x27b4d7=_0xbe1a93[_0x3de797(0x21e)](_0x57807b,{'type':_0x333dfc[_0x3de797(0x364)],'bookType':_0x333dfc['qLKYb']});_0x505876[_0x3de797(0x1e4)]({'isDownload':!0x0,'color':_0x333dfc[_0x3de797(0x15e)],'msg':_0x333dfc[_0x3de797(0x24a)],'filename':_0x12ff0,'fileData':_0x27b4d7['toString'](_0x333dfc[_0x3de797(0x391)])});}}catch(_0x5784f1){return _0x505876[_0x3de797(0x1e4)]({'isDownload':!0x1,'color':_0x333dfc[_0x3de797(0x1d1)],'msg':_0x5784f1[_0x3de797(0x1e7)]});}finally{_0x2e537d[_0x3de797(0x1cd)]();}});const ae=_0x5e04ca({'storage':_0x5e04ca[_0x14631(0x33f)]()});x['post'](Z,_0x1ad336[_0x14631(0x329)],ae[_0x14631(0x199)]('uploadExcelFile'),async(_0x1030df,_0x1af52a)=>{const _0x48fdef=_0x14631,_0x25b194={'jZPsM':function(_0x5e50fb,_0x40e521){return _0x5e50fb(_0x40e521);},'eIGHa':function(_0x41c1cd,_0x352229){return _0x41c1cd(_0x352229);},'YZpRS':_0x48fdef(0x21d),'vKxmb':_0x48fdef(0x2fa),'FpHXQ':_0x48fdef(0x155),'myjwt':_0x48fdef(0x21f),'mvNDI':function(_0x760603,_0x8c2de3){return _0x760603>_0x8c2de3;},'pHCzf':'userId','MbLGw':_0x48fdef(0x184),'Ytcbr':'branchId','waYYp':'userIsActive','mOHdQ':_0x48fdef(0x35c),'zqrVq':_0x48fdef(0x291),'nGKPG':_0x48fdef(0x2a8),'Peawy':_0x48fdef(0x307),'vXhOq':'userFirstname','MPVAn':_0x48fdef(0x312),'zBBjB':_0x48fdef(0x393),'KONDW':function(_0x543543,_0x2095f1){return _0x543543>_0x2095f1;},'gwEAn':_0x48fdef(0x316),'MJSdi':function(_0xc56e4b,_0x5bbb71){return _0xc56e4b+_0x5bbb71;},'QEdWT':function(_0x4a82e3,_0x3aedaa){return _0x4a82e3===_0x3aedaa;},'qgQKe':function(_0xfe760e,_0x4a6bbb){return _0xfe760e===_0x4a6bbb;},'hqbcR':function(_0x500466,_0x3c75ad){return _0x500466===_0x3c75ad;},'BTrux':function(_0x32936b,_0x53f45b){return _0x32936b===_0x53f45b;},'YRFro':function(_0x7bdd72,_0x531b29){return _0x7bdd72===_0x531b29;},'hyqDT':function(_0x2b660d,_0x1e061d){return _0x2b660d===_0x1e061d;},'MMGxd':function(_0x535955,_0x2bf342){return _0x535955+_0x2bf342;},'xmYDM':'ไม่มีข้อมูลที่อัปเดท','XVMhT':_0x48fdef(0x2df),'dbWQs':'error\x20===>\x20'},_0x5c2a7a=new _0x5685e5(dbUrl);try{if(!_0x1030df[_0x48fdef(0x1b0)])return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x25b194['vKxmb']});const _0x2c82f9=_0xbe1a93['read'](_0x1030df[_0x48fdef(0x1b0)][_0x48fdef(0x155)],{'type':_0x25b194[_0x48fdef(0x2d6)]}),_0x509f6c=[_0x25b194[_0x48fdef(0x315)]],_0x1e86bc=_0x2c82f9[_0x48fdef(0x321)],_0x32ccc8=_0x509f6c[_0x48fdef(0x253)](_0x56481b=>!_0x1e86bc[_0x48fdef(0x2ad)](_0x56481b));if(_0x25b194[_0x48fdef(0x327)](_0x32ccc8[_0x48fdef(0x34c)],0x0))return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':'ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22'+_0x32ccc8[_0x48fdef(0x392)](',\x20')+'\x22'});const _0x45a94d=_0x2c82f9[_0x48fdef(0x1a9)][_0x48fdef(0x21f)],_0x20fb8b=_0xbe1a93[_0x48fdef(0x1a8)]['sheet_to_json'](_0x45a94d),_0x552442=[_0x25b194['pHCzf'],_0x25b194['MbLGw'],_0x25b194[_0x48fdef(0x34d)],_0x25b194[_0x48fdef(0x1c4)],_0x25b194['mOHdQ'],_0x25b194['zqrVq'],_0x25b194[_0x48fdef(0x26a)],_0x25b194[_0x48fdef(0x32c)],_0x25b194['vXhOq'],_0x25b194[_0x48fdef(0x1c6)],_0x25b194[_0x48fdef(0x1dc)]][_0x48fdef(0x253)](_0x4f65b1=>!_0x20fb8b[_0x48fdef(0x1e1)](_0x3830c0=>Object['prototype'][_0x48fdef(0x200)]['call'](_0x3830c0,_0x4f65b1)));if(_0x25b194[_0x48fdef(0x20d)](_0x552442[_0x48fdef(0x34c)],0x0))return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x48fdef(0x2de)+_0x552442[_0x48fdef(0x392)](',\x20')+'\x22'});const _0x194505=new Set(),_0x37b497=new Set();if(_0x20fb8b['forEach'](_0x41c849=>{const _0x55bf34=_0x48fdef;_0x194505[_0x55bf34(0x1da)](_0x41c849[_0x55bf34(0x310)])?_0x37b497[_0x55bf34(0x171)](_0x41c849[_0x55bf34(0x310)]):_0x194505[_0x55bf34(0x171)](_0x41c849[_0x55bf34(0x310)]);}),_0x25b194['KONDW'](_0x37b497[_0x48fdef(0x241)],0x0))return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x48fdef(0x244)+Array[_0x48fdef(0x204)](_0x37b497)[_0x48fdef(0x392)](',\x20')+'\x22'});const _0x476bc4=new Set(),_0x435dc6=new Set();if(_0x20fb8b[_0x48fdef(0x238)](_0x37d235=>{const _0x13b652=_0x48fdef;_0x476bc4[_0x13b652(0x1da)](_0x37d235[_0x13b652(0x184)])?_0x435dc6[_0x13b652(0x171)](_0x37d235[_0x13b652(0x184)]):_0x476bc4['add'](_0x37d235[_0x13b652(0x184)]);}),_0x25b194['mvNDI'](_0x435dc6[_0x48fdef(0x241)],0x0))return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x48fdef(0x1ec)+Array[_0x48fdef(0x204)](_0x435dc6)[_0x48fdef(0x392)](',\x20')+'\x22'});const _0x227ca4=new Set(),_0x49f6f6=new Set();if(_0x20fb8b[_0x48fdef(0x238)](_0x131337=>{const _0x152c51=_0x48fdef;_0x227ca4[_0x152c51(0x1da)](_0x131337[_0x152c51(0x291)])?_0x49f6f6['add'](_0x131337[_0x152c51(0x291)]):_0x227ca4[_0x152c51(0x171)](_0x131337[_0x152c51(0x291)]);}),_0x25b194[_0x48fdef(0x327)](_0x49f6f6['size'],0x0))return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x48fdef(0x37b)+Array[_0x48fdef(0x204)](_0x49f6f6)[_0x48fdef(0x392)](',\x20')+'\x22'});const _0x3f8c74=[],_0x32b952=/^\d{3,4}$/,_0x2b6d59=new RegExp(global['USERNAME_PATTERN']),_0x37f600=/^\d{3}$/,_0x593e24=[_0x25b194['gwEAn'],''];for(const [_0x338a2d,_0x5bb2eb]of _0x20fb8b[_0x48fdef(0x38a)]()){const _0xaed67b=_0x25b194[_0x48fdef(0x1bd)](_0x338a2d,0x2),_0x37b9d9={'userId':_0x5bb2eb[_0x48fdef(0x310)],'row':_0xaed67b};if(!_0x5bb2eb[_0x48fdef(0x310)]||_0x25b194[_0x48fdef(0x320)](_0x32b952[_0x48fdef(0x37d)](_0x5bb2eb[_0x48fdef(0x310)]['toString']()),!0x1)){_0x3f8c74[_0x48fdef(0x279)](_0x37b9d9);continue;}if(!_0x5bb2eb['username']||_0x25b194[_0x48fdef(0x369)](_0x2b6d59[_0x48fdef(0x37d)](_0x5bb2eb[_0x48fdef(0x184)]),!0x1)){_0x3f8c74[_0x48fdef(0x279)](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x20f)]||_0x25b194[_0x48fdef(0x2c2)](_0x37f600[_0x48fdef(0x37d)](_0x5bb2eb[_0x48fdef(0x20f)][_0x48fdef(0x35f)]()),!0x1)){_0x3f8c74['push'](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x2c9)]||_0x25b194[_0x48fdef(0x2c8)](_0x593e24[_0x48fdef(0x2ad)](_0x5bb2eb[_0x48fdef(0x2c9)]),!0x1)){_0x3f8c74['push'](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x35c)]||_0x25b194[_0x48fdef(0x2c2)](global[_0x48fdef(0x23f)]['includes'](_0x5bb2eb['userAuthority']),!0x1)){_0x3f8c74[_0x48fdef(0x279)](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x291)]||_0x25b194['YRFro'](_0x488224[_0x48fdef(0x258)](_0x5bb2eb['userEmail']),!0x1)){_0x3f8c74['push'](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x2f3)]||_0x25b194['hyqDT'](_0x5bb2eb[_0x48fdef(0x2f3)][_0x48fdef(0x33e)](),'')){_0x3f8c74['push'](_0x37b9d9);continue;}if(!_0x5bb2eb[_0x48fdef(0x393)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x48fdef(0x37d)](_0x5bb2eb[_0x48fdef(0x393)])){_0x3f8c74[_0x48fdef(0x279)](_0x37b9d9);continue;}}if(_0x25b194[_0x48fdef(0x20d)](_0x3f8c74[_0x48fdef(0x34c)],0x0)){const _0x2beaaf=Array['from'](new Set(_0x3f8c74[_0x48fdef(0x370)](_0x41e36b=>JSON['stringify'](_0x41e36b))))[_0x48fdef(0x370)](_0x725a9c=>JSON[_0x48fdef(0x297)](_0x725a9c));return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x48fdef(0x2f0)+_0x2beaaf[_0x48fdef(0x370)](_0x5c6f2a=>_0x5c6f2a['row'])['join'](',\x20'),'errorRows':_0x2beaaf});}_0x20fb8b[_0x48fdef(0x238)](_0x1bc37d=>{const _0x25caba=_0x48fdef;_0x1bc37d['userId']=_0x25b194[_0x25caba(0x1cf)](Number,_0x1bc37d[_0x25caba(0x310)]),_0x1bc37d[_0x25caba(0x20f)]=_0x25b194[_0x25caba(0x354)](Number,_0x1bc37d[_0x25caba(0x20f)]),_0x1bc37d[_0x25caba(0x2c9)]||(_0x1bc37d['userIsActive']=''),_0x1bc37d['userPhone']||(_0x1bc37d[_0x25caba(0x2a8)]=''),_0x1bc37d[_0x25caba(0x307)]||(_0x1bc37d[_0x25caba(0x307)]=''),_0x1bc37d[_0x25caba(0x312)]||(_0x1bc37d[_0x25caba(0x312)]=''),delete _0x1bc37d[_0x25caba(0x219)],delete _0x1bc37d[_0x25caba(0x2a2)],delete _0x1bc37d[_0x25caba(0x165)],delete _0x1bc37d[_0x25caba(0x219)];}),await _0x5c2a7a[_0x48fdef(0x2dc)]();const _0x4aaf83=_0x5c2a7a['db'](dbName)[_0x48fdef(0x16c)](dbColl_users),_0x26eb39=[];for(const _0x36a5e8 of _0x20fb8b){const _0x3ac020=await _0x4aaf83[_0x48fdef(0x229)]({'userId':_0x36a5e8[_0x48fdef(0x310)]},{'$set':_0x36a5e8},{'upsert':!0x0});_0x26eb39[_0x48fdef(0x279)]({'userId':_0x36a5e8['userId'],'matchedCount':_0x3ac020[_0x48fdef(0x168)],'upsertedCount':_0x3ac020['upsertedCount']});}const _0x15bff4=_0x25b194[_0x48fdef(0x20d)](_0x26eb39[_0x48fdef(0x34c)],0x0)?_0x25b194[_0x48fdef(0x28f)](_0x48fdef(0x2e7)+_0x26eb39['filter'](_0x472802=>_0x472802['matchedCount']>0x0)[_0x48fdef(0x34c)]+'\x20รายการ',(_0x48fdef(0x254)+_0x26eb39[_0x48fdef(0x253)](_0x9f358c=>_0x9f358c[_0x48fdef(0x355)]>0x0)[_0x48fdef(0x34c)]+_0x48fdef(0x2b1))[_0x48fdef(0x33e)]()):_0x25b194[_0x48fdef(0x1db)];return _0x1af52a[_0x48fdef(0x1e4)]({'isUpload':!0x0,'color':_0x25b194['XVMhT'],'msg':_0x15bff4});}catch(_0x2fcced){return console[_0x48fdef(0x389)](_0x25b194[_0x48fdef(0x2e6)],_0x2fcced),_0x1af52a[_0x48fdef(0x1e4)]({'isDownload':!0x1,'color':_0x25b194[_0x48fdef(0x234)],'msg':_0x2fcced['message']});}finally{_0x5c2a7a[_0x48fdef(0x1cd)]();}});export default x;function _0x46ee96(_0x193fed){const _0x376fb0=_0x14631,_0x1b114b={'NCpOB':function(_0x2d7773,_0x50380d){return _0x2d7773===_0x50380d;},'JXfum':'string','QuBxg':_0x376fb0(0x360),'Wcpqg':'counter','Vshhn':function(_0x43a180,_0x1885c7){return _0x43a180!==_0x1885c7;},'HfhJN':function(_0x379c32,_0x5eadbd){return _0x379c32+_0x5eadbd;},'neFgu':function(_0x4ad8bb,_0x4b2d5f){return _0x4ad8bb/_0x4b2d5f;},'GSHCe':_0x376fb0(0x34c),'bzoct':function(_0x58af1d,_0x23a564){return _0x58af1d%_0x23a564;},'sOjmB':function(_0x2783f9,_0x8c6c83){return _0x2783f9+_0x8c6c83;},'nFrjI':_0x376fb0(0x2f9),'skRok':'gger','jUUwz':'action','XwYyQ':function(_0x2b1eac,_0x471283){return _0x2b1eac+_0x471283;},'dWJvM':_0x376fb0(0x207),'Lvvqw':function(_0x2c8776,_0x435cc9){return _0x2c8776(_0x435cc9);}};function _0x2a3001(_0x31068b){const _0x4f6fa4=_0x376fb0;if(_0x1b114b[_0x4f6fa4(0x173)](typeof _0x31068b,_0x1b114b[_0x4f6fa4(0x374)]))return function(_0x3c4b95){}[_0x4f6fa4(0x1ae)](_0x1b114b[_0x4f6fa4(0x1b8)])['apply'](_0x1b114b['Wcpqg']);else _0x1b114b['Vshhn'](_0x1b114b[_0x4f6fa4(0x342)]('',_0x1b114b['neFgu'](_0x31068b,_0x31068b))[_0x1b114b[_0x4f6fa4(0x178)]],0x1)||_0x1b114b[_0x4f6fa4(0x173)](_0x1b114b[_0x4f6fa4(0x2ef)](_0x31068b,0x14),0x0)?function(){return!![];}[_0x4f6fa4(0x1ae)](_0x1b114b[_0x4f6fa4(0x1c9)](_0x1b114b[_0x4f6fa4(0x29f)],_0x1b114b[_0x4f6fa4(0x216)]))[_0x4f6fa4(0x1d0)](_0x1b114b[_0x4f6fa4(0x2a4)]):function(){return![];}[_0x4f6fa4(0x1ae)](_0x1b114b[_0x4f6fa4(0x15c)](_0x1b114b[_0x4f6fa4(0x29f)],_0x1b114b[_0x4f6fa4(0x216)]))[_0x4f6fa4(0x30d)](_0x1b114b['dWJvM']);_0x1b114b[_0x4f6fa4(0x18a)](_0x2a3001,++_0x31068b);}try{if(_0x193fed)return _0x2a3001;else _0x1b114b[_0x376fb0(0x18a)](_0x2a3001,0x0);}catch(_0x13001d){}}