const _0x38e7d8=_0x419d;(function(_0x2d17b2,_0x5aff84){const _0x5a70c2=_0x419d,_0x533c60=_0x2d17b2();while(!![]){try{const _0x4f49ea=-parseInt(_0x5a70c2(0x20b))/0x1*(parseInt(_0x5a70c2(0x31f))/0x2)+parseInt(_0x5a70c2(0x1dd))/0x3+parseInt(_0x5a70c2(0x306))/0x4+-parseInt(_0x5a70c2(0x325))/0x5+-parseInt(_0x5a70c2(0x20c))/0x6+-parseInt(_0x5a70c2(0x1b6))/0x7+parseInt(_0x5a70c2(0x217))/0x8;if(_0x4f49ea===_0x5aff84)break;else _0x533c60['push'](_0x533c60['shift']());}catch(_0x5e58dc){_0x533c60['push'](_0x533c60['shift']());}}}(_0x9089,0x6857f));const _0x13f101=(function(){const _0x9dc7c3=_0x419d,_0x12a184={'qCZKc':_0x9dc7c3(0x33a),'KWgTL':_0x9dc7c3(0x392),'xDZjk':function(_0x1bb1ef){return _0x1bb1ef();},'XVvCA':function(_0x200018,_0x3404c3){return _0x200018===_0x3404c3;},'AfxTw':_0x9dc7c3(0x214),'WTeIB':function(_0x1529cc,_0x4fbb7e){return _0x1529cc!==_0x4fbb7e;},'RDrni':'LgDuk','LZFCx':_0x9dc7c3(0x3b8),'kFfeW':function(_0x3c362e,_0x158a12){return _0x3c362e!==_0x158a12;},'HGZtp':_0x9dc7c3(0x23f)};let _0x245be7=!![];return function(_0x2147d7,_0x3bcad9){const _0x5e964b=_0x9dc7c3,_0x40e4e1={'fVSSJ':function(_0x20d659){return _0x12a184['xDZjk'](_0x20d659);},'eZRst':function(_0x36a961,_0x11806c){return _0x12a184['XVvCA'](_0x36a961,_0x11806c);},'zegDH':_0x12a184[_0x5e964b(0x399)],'nzCbY':function(_0x26f068,_0x4af775){const _0x3b9826=_0x5e964b;return _0x12a184[_0x3b9826(0x1f6)](_0x26f068,_0x4af775);},'uFSnD':_0x12a184[_0x5e964b(0x3d3)],'tHBKB':_0x12a184['LZFCx']};if(_0x12a184[_0x5e964b(0x346)](_0x12a184[_0x5e964b(0x25b)],_0x12a184[_0x5e964b(0x25b)]))return function(_0x504e66){}[_0x5e964b(0x29b)](_0x12a184[_0x5e964b(0x289)])[_0x5e964b(0x234)](_0x12a184[_0x5e964b(0x3b3)]);else{const _0x5c7361=_0x245be7?function(){const _0xaee661=_0x5e964b;if(_0x40e4e1[_0xaee661(0x30a)](_0x40e4e1[_0xaee661(0x363)],_0x40e4e1[_0xaee661(0x363)])){if(_0x3bcad9){if(_0x40e4e1['nzCbY'](_0x40e4e1[_0xaee661(0x238)],_0x40e4e1[_0xaee661(0x30d)])){const _0x35dcb0=_0x3bcad9[_0xaee661(0x234)](_0x2147d7,arguments);return _0x3bcad9=null,_0x35dcb0;}else _0x40e4e1['fVSSJ'](_0x158764);}}else{const _0x15b65b=_0x3c6773[_0xaee661(0x29b)][_0xaee661(0x36d)][_0xaee661(0x31e)](_0x5867e1),_0x5f2962=_0x4ec204[_0x288278],_0x40a5e0=_0x3c68d7[_0x5f2962]||_0x15b65b;_0x15b65b[_0xaee661(0x22d)]=_0x140738['bind'](_0x17ba6c),_0x15b65b[_0xaee661(0x1ee)]=_0x40a5e0[_0xaee661(0x1ee)][_0xaee661(0x31e)](_0x40a5e0),_0x352992[_0x5f2962]=_0x15b65b;}}:function(){};return _0x245be7=![],_0x5c7361;}};}());(function(){const _0x3aeb44=_0x419d,_0x576a8d={'EHmGn':function(_0x29120a,_0x561bf4){return _0x29120a!==_0x561bf4;},'cpCIs':function(_0x6f7f82,_0x59568b){return _0x6f7f82==_0x59568b;},'EThTq':function(_0x4e3eb7,_0xe145c0){return _0x4e3eb7===_0xe145c0;},'BPwIH':_0x3aeb44(0x32d),'MngjQ':_0x3aeb44(0x225),'LeVut':_0x3aeb44(0x38d),'bAkOw':_0x3aeb44(0x30c),'edNiu':function(_0x328852,_0x5d3427){return _0x328852(_0x5d3427);},'CHTuL':'init','nTaIM':function(_0x44907d,_0x535fd1){return _0x44907d+_0x535fd1;},'fobjW':'chain','KIJbL':_0x3aeb44(0x3a0),'XdhcJ':_0x3aeb44(0x360),'VlnrO':_0x3aeb44(0x239),'ntSoN':function(_0x4db2a5,_0x5d8035){return _0x4db2a5(_0x5d8035);},'bvomv':_0x3aeb44(0x1ed),'gEDJK':function(_0x31f806){return _0x31f806();},'aQOTP':function(_0x178c02,_0x41329b,_0x1830c0){return _0x178c02(_0x41329b,_0x1830c0);}};_0x576a8d[_0x3aeb44(0x28e)](_0x13f101,this,function(){const _0x21b284=_0x3aeb44,_0x32ced7={'EGvXR':function(_0x5543f1,_0x18604a){const _0x8506ec=_0x419d;return _0x576a8d[_0x8506ec(0x354)](_0x5543f1,_0x18604a);},'vKlFv':function(_0xe44861,_0x29df73){const _0x5a8f14=_0x419d;return _0x576a8d[_0x5a8f14(0x27f)](_0xe44861,_0x29df73);},'EBqeM':function(_0x5d1477,_0xd8374d){return _0x576a8d['EHmGn'](_0x5d1477,_0xd8374d);}};if(_0x576a8d[_0x21b284(0x33d)](_0x576a8d[_0x21b284(0x3c7)],_0x576a8d[_0x21b284(0x229)])){const _0x2e734b=_0x2d4506[_0x21b284(0x2f6)];_0x190778=_0x5fdad8[_0x21b284(0x35c)](_0x2af1b7=>{const _0x2c8585=_0x21b284,_0x4f7254=_0x32ced7[_0x2c8585(0x25d)](_0x2af1b7[_0x2c8585(0x25f)],'S')||_0x32ced7[_0x2c8585(0x3a9)](_0x2af1b7[_0x2c8585(0x2f6)],_0x2e734b);return _0x32ced7[_0x2c8585(0x370)](_0x2af1b7[_0x2c8585(0x25f)],'O')&&_0x4f7254;});}else{const _0x3390cb=new RegExp(_0x576a8d[_0x21b284(0x1d7)]),_0x458483=new RegExp(_0x576a8d[_0x21b284(0x337)],'i'),_0x2a6858=_0x576a8d[_0x21b284(0x3c2)](_0x3b5419,_0x576a8d[_0x21b284(0x2ab)]);!_0x3390cb[_0x21b284(0x36a)](_0x576a8d[_0x21b284(0x1b1)](_0x2a6858,_0x576a8d['fobjW']))||!_0x458483[_0x21b284(0x36a)](_0x576a8d[_0x21b284(0x1b1)](_0x2a6858,_0x576a8d[_0x21b284(0x2c6)]))?_0x576a8d['EThTq'](_0x576a8d[_0x21b284(0x2ae)],_0x576a8d['VlnrO'])?_0x228fe0[_0x21b284(0x2a1)](_0x3aba1b[_0x21b284(0x1e8)])?_0x590cc9[_0x21b284(0x3bc)](_0x26f992[_0x21b284(0x1e8)]):_0x48af5c[_0x21b284(0x3bc)](_0x14b364['username']):_0x576a8d[_0x21b284(0x1df)](_0x2a6858,'0'):_0x576a8d['EHmGn'](_0x576a8d[_0x21b284(0x282)],_0x576a8d[_0x21b284(0x282)])?_0x2973d6[_0x21b284(0x345)]():_0x576a8d[_0x21b284(0x3b6)](_0x3b5419);}})();}());const _0xebe36=(function(){const _0x4178a7=_0x419d,_0x2204ca={'nmcsi':_0x4178a7(0x2f7),'unQPa':_0x4178a7(0x267),'zFeur':function(_0x30a363,_0x2d7e8f){return _0x30a363!==_0x2d7e8f;},'Pkoqb':_0x4178a7(0x240),'kdMmv':_0x4178a7(0x207),'vnZOD':_0x4178a7(0x338),'mUylF':function(_0x393d46,_0x296662){return _0x393d46(_0x296662);},'kwPlD':_0x4178a7(0x245),'MzHtL':'gQSOf'};let _0x304df8=!![];return function(_0x51a364,_0x37c4c0){const _0x4d9ea7=_0x4178a7,_0x21e80b={'XpqMy':function(_0x43f033,_0x249307){const _0x37dc3f=_0x419d;return _0x2204ca[_0x37dc3f(0x26a)](_0x43f033,_0x249307);},'TkYWq':function(_0x21d7de,_0x1a2b92){const _0x3331c3=_0x419d;return _0x2204ca[_0x3331c3(0x26a)](_0x21d7de,_0x1a2b92);}};if(_0x2204ca['zFeur'](_0x2204ca[_0x4d9ea7(0x30b)],_0x2204ca['MzHtL'])){const _0xa3a5cd=_0x304df8?function(){const _0x4026ef=_0x4d9ea7,_0x349817={'XOYIh':_0x2204ca[_0x4026ef(0x31d)],'jwcfE':_0x2204ca[_0x4026ef(0x2c3)]};if(_0x2204ca['zFeur'](_0x2204ca[_0x4026ef(0x385)],_0x2204ca['kdMmv'])){if(_0x37c4c0){if(_0x2204ca[_0x4026ef(0x2a0)](_0x2204ca[_0x4026ef(0x1e1)],_0x2204ca[_0x4026ef(0x1e1)]))return _0x196e7d[_0x4026ef(0x253)](_0x5e3005['message']),_0xded26[_0x4026ef(0x1ca)](_0x349817[_0x4026ef(0x262)],{'class':_0x349817['jwcfE'],'text':''+_0x5edfcf[_0x4026ef(0x324)]}),_0x474d1f[_0x4026ef(0x3a4)](_0x7eee3f);else{const _0x16e433=_0x37c4c0['apply'](_0x51a364,arguments);return _0x37c4c0=null,_0x16e433;}}}else _0x2d34c3[_0x4026ef(0x345)]();}:function(){};return _0x304df8=![],_0xa3a5cd;}else{const _0x302386=_0xc73794?new _0x79c537(''+_0x17056b,'i'):new _0x256e7f('.*');let _0x54d3b2={};_0x21e80b[_0x4d9ea7(0x203)](_0x355e39,_0x21e80b[_0x4d9ea7(0x22a)](_0x7c3e25,_0x7ca957))?_0x54d3b2={'userId':{'$regex':_0x302386}}:_0x54d3b2={'userId':_0x21e80b[_0x4d9ea7(0x203)](_0x176736,_0x52c39e)},_0x1b5292[_0x4d9ea7(0x236)]({'$match':{'$or':[_0x54d3b2,{'username':{'$regex':_0x302386}},{'userFirstname':{'$regex':_0x302386}}]}});}};}()),_0xa4edf9=_0xebe36(this,function(){const _0x52e71b=_0x419d,_0x22ca8d={'ElbNF':_0x52e71b(0x38d),'oaZNM':_0x52e71b(0x30c),'OXWyb':function(_0x404968,_0x379fc0){return _0x404968(_0x379fc0);},'ZwQnf':_0x52e71b(0x2ea),'NQkKi':function(_0x3bc398,_0x596b86){return _0x3bc398+_0x596b86;},'Inxpu':_0x52e71b(0x270),'dBOFJ':'input','hqrMf':function(_0x384b7b,_0x2edd6f){return _0x384b7b(_0x2edd6f);},'PAhsY':function(_0x521ed7){return _0x521ed7();},'fFaHV':function(_0x6b70f,_0x6ea4ee,_0x1faed4){return _0x6b70f(_0x6ea4ee,_0x1faed4);},'WBlnT':function(_0x5c5d99,_0x165159){return _0x5c5d99===_0x165159;},'IlTjK':_0x52e71b(0x3d9),'ypZbS':function(_0x2b4b81,_0x2fbe94){return _0x2b4b81!==_0x2fbe94;},'fMxMD':'fHbpi','iwtkF':_0x52e71b(0x200),'fImPG':function(_0x3a06f,_0x5f24bd){return _0x3a06f(_0x5f24bd);},'XuIvZ':function(_0x22b3d4,_0x287937){return _0x22b3d4+_0x287937;},'PebZj':'return\x20(function()\x20','UBSsD':_0x52e71b(0x383),'hddad':function(_0x219d74,_0x324028){return _0x219d74===_0x324028;},'dkkAG':_0x52e71b(0x341),'LoWNX':'error\x20===>\x20','qxgaZ':_0x52e71b(0x267),'LFzxT':'log','anfCe':_0x52e71b(0x327),'zqXJm':'info','sNOUF':'error','vgPNt':'exception','nxtZd':_0x52e71b(0x315),'uTfFQ':'trace','iWtDZ':function(_0xb7b55b,_0x2c9dcb){return _0xb7b55b<_0x2c9dcb;},'MrZdt':_0x52e71b(0x3dc),'vPixC':_0x52e71b(0x2ba)},_0x41534a=function(){const _0x44178a=_0x52e71b,_0x336aae={'ZdoiK':_0x22ca8d['ElbNF'],'whCxl':_0x22ca8d[_0x44178a(0x2ad)],'rfPfn':function(_0x3e9cf3,_0x3c3827){return _0x22ca8d['OXWyb'](_0x3e9cf3,_0x3c3827);},'wWVrz':_0x22ca8d[_0x44178a(0x395)],'aEEed':function(_0x36b1b1,_0x3e0014){const _0x2ca5ff=_0x44178a;return _0x22ca8d[_0x2ca5ff(0x35f)](_0x36b1b1,_0x3e0014);},'RFtLp':_0x22ca8d[_0x44178a(0x1c8)],'WBLVO':function(_0x4735f5,_0x9fc5bd){return _0x22ca8d['NQkKi'](_0x4735f5,_0x9fc5bd);},'QWRLm':_0x22ca8d['dBOFJ'],'ZfFSo':function(_0x18c8a5,_0x4b277a){const _0x523917=_0x44178a;return _0x22ca8d[_0x523917(0x2f8)](_0x18c8a5,_0x4b277a);},'EGHiB':function(_0x3d6950){const _0x36fb56=_0x44178a;return _0x22ca8d[_0x36fb56(0x2cf)](_0x3d6950);},'hfllO':function(_0x229ced,_0x4cb552,_0x45a35b){return _0x22ca8d['fFaHV'](_0x229ced,_0x4cb552,_0x45a35b);},'hRPJh':function(_0x36784e,_0x5820aa){const _0xa96d51=_0x44178a;return _0x22ca8d[_0xa96d51(0x2f8)](_0x36784e,_0x5820aa);}};if(_0x22ca8d[_0x44178a(0x1bb)](_0x22ca8d['IlTjK'],_0x22ca8d[_0x44178a(0x36f)])){let _0x5f1a16;try{_0x22ca8d[_0x44178a(0x2d3)](_0x22ca8d[_0x44178a(0x2c4)],_0x22ca8d[_0x44178a(0x310)])?_0x5f1a16=_0x22ca8d['fImPG'](Function,_0x22ca8d['NQkKi'](_0x22ca8d[_0x44178a(0x29a)](_0x22ca8d[_0x44178a(0x274)],_0x22ca8d[_0x44178a(0x3e5)]),');'))():_0x336aae[_0x44178a(0x3c1)](_0x433a6e,this,function(){const _0xed2c31=_0x44178a,_0xdc6bee=new _0x479f88(_0x336aae[_0xed2c31(0x33f)]),_0x460d70=new _0x24878e(_0x336aae[_0xed2c31(0x265)],'i'),_0x2eeb37=_0x336aae[_0xed2c31(0x37d)](_0xbbdb99,_0x336aae[_0xed2c31(0x3d5)]);!_0xdc6bee[_0xed2c31(0x36a)](_0x336aae[_0xed2c31(0x373)](_0x2eeb37,_0x336aae[_0xed2c31(0x35e)]))||!_0x460d70[_0xed2c31(0x36a)](_0x336aae[_0xed2c31(0x39c)](_0x2eeb37,_0x336aae[_0xed2c31(0x2b3)]))?_0x336aae[_0xed2c31(0x318)](_0x2eeb37,'0'):_0x336aae[_0xed2c31(0x202)](_0x47ff43);})();}catch(_0x37554c){if(_0x22ca8d[_0x44178a(0x313)](_0x22ca8d['dkkAG'],_0x22ca8d['dkkAG']))_0x5f1a16=window;else{const _0x348503=_0xf3b114[_0x44178a(0x234)](_0xcf8342,arguments);return _0x108ab8=null,_0x348503;}}return _0x5f1a16;}else _0x336aae['hRPJh'](_0x3c2708,'0');},_0x1fa51f=_0x22ca8d[_0x52e71b(0x2cf)](_0x41534a),_0x7ff6a9=_0x1fa51f[_0x52e71b(0x397)]=_0x1fa51f[_0x52e71b(0x397)]||{},_0x1cfac1=[_0x22ca8d[_0x52e71b(0x328)],_0x22ca8d[_0x52e71b(0x248)],_0x22ca8d[_0x52e71b(0x201)],_0x22ca8d[_0x52e71b(0x21b)],_0x22ca8d[_0x52e71b(0x3a3)],_0x22ca8d['nxtZd'],_0x22ca8d['uTfFQ']];for(let _0xb8fddc=0x0;_0x22ca8d['iWtDZ'](_0xb8fddc,_0x1cfac1[_0x52e71b(0x3ca)]);_0xb8fddc++){if(_0x22ca8d[_0x52e71b(0x313)](_0x22ca8d[_0x52e71b(0x1dc)],_0x22ca8d[_0x52e71b(0x1b2)]))_0x5142e5[_0x52e71b(0x253)](_0x22ca8d[_0x52e71b(0x21d)],_0x492f44[_0x52e71b(0x324)]),_0x498d70[_0x52e71b(0x3ba)](_0x2847aa['stringify']({'isPrint':!0x1,'class':_0x22ca8d[_0x52e71b(0x36e)],'msg':_0x198fba['message']}));else{const _0x20797c=_0xebe36[_0x52e71b(0x29b)][_0x52e71b(0x36d)]['bind'](_0xebe36),_0x286092=_0x1cfac1[_0xb8fddc],_0x4cb73f=_0x7ff6a9[_0x286092]||_0x20797c;_0x20797c[_0x52e71b(0x22d)]=_0xebe36[_0x52e71b(0x31e)](_0xebe36),_0x20797c['toString']=_0x4cb73f[_0x52e71b(0x1ee)][_0x52e71b(0x31e)](_0x4cb73f),_0x7ff6a9[_0x286092]=_0x20797c;}}});_0xa4edf9();function _0x9089(){const _0x1951b3=['replace','row','fnocl','jagFy','BXsuo','RHedu','AkQBw','cpCIs','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','มี\x20username\x20ซ้ำกัน:\x20\x22','bvomv','nNeuW','ceil','hdVpk','/myUsers.js','ZpEqz','\x5c$&','qCZKc','START_PASSWORD','YxkEv','iWbrt','เพิ่มยูสเซอร์\x20','aQOTP','qwerty','oFssX','BdshV','userEmail','jKeML','destroy','BCRYPT_NUMBER','BlbzE','map','IDYjm','&load_id=','XuIvZ','constructor','some','AxxQS','forEach','RhCXN','zFeur','has','pgFOb','\x22\x20เรียบร้อยแล้ว\x20)','ประวัติการแก้ไขยูสเซอร์\x20:\x20[','twZYV','EBlzZ','wItFg','XyXaT','UpRxe','taNrE','CHTuL','rLtEs','oaZNM','XdhcJ','phYRU','qWPmG','PDeeR','mvsbn','QWRLm','xGAii','VKNJK','changesHistoryCount','sort','TUUmG','THYnY','zRqai','userPrefix','vLvBo','vqTVR','aRimV','LZOBS','inzyt','ZYzap','hCUmq','unQPa','fMxMD','hash','KIJbL','TsGbq','dbColl_users','gmjWf','Bigqd','lBDfn','doc_changes.ejs','call','read','PAhsY','fPLlc','HlOIK','uHyxV','ypZbS','DvRZn','XXUOj','dbColl_return','query','error\x20===>\x20','USseW','Lbftj','_id','gSZQR','agNPm','fxbqC','/new','JQSYM','ไม่พบ\x20\x22','WAANn','JibbE','TkQqS','aggregate','catch','stateObject','sydVm','FslxC','init','NpiLt','zoePh','BDQqu','dWTVi','ooTCD','connect','muGjs','hIKim','modifiedCount','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','ghAuD','userId','msg','hqrMf','vRQpN','piKNv','GYtMe','){{sep}}(CODE\x20:\x20','matchedCount','AbwUB','RgvcA','Teftf','active','\x20ยูสเซอร์เรียบร้อยแล้ว','zvlpK','EFXBz','oheXO','683768cLWvOy','pDZGt','DxutM','LYbaL','eZRst','kwPlD','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','tHBKB','isEmail','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','iwtkF','wmgas','Wejkv','hddad','/delete','table','join','AgHtf','ZfFSo','branchId','dbUrl','RhueH','/myData.js','nmcsi','bind','74626kWCLjV','ไม่พบประวัติการเปลี่ยนแปลง','Session\x20destroy\x20error:\x20','ยูสเซอร์\x20(','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','message','1796150gCGUrp','/changes','warn','LFzxT','GRCNc','userIsActive','NQJvl','wYBzj','sXSEQ','iVbwd','USERNAME_PATTERN','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','NEOef','IMwye','Fwjcc','KqDvy','TzRHJ','KBUmr','bAkOw','PbWPK','book_new','while\x20(true)\x20{}','userFirstname','return\x20(function()\x20','EThTq','updateOne','ZdoiK','pjUaB','ajqWl','getSettings','\x22\x20)','QTKEU','close','kFfeW','deleteMany','FYEzR','{{sep}}ไม่สามารถลบได้','userFlash','aaqKo','uploadExcelFile','post','TmaVD','limit','pAyPN','findOne','AbWkC','WxDAZ','EHmGn','dbColl_sales','YnXqS','kXtyR','อัปเดท\x20','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','byqRO','GyNrZ','filter','YCxfI','RFtLp','NQkKi','tWwKf','?sip=','JyrKf','zegDH','folderForms','{{sep}}[\x20บันทึกการแก้ไข\x20]','QYBSq','entries','TOuQZ','PdnqZ','test','tKMKx','userPassword','prototype','qxgaZ','IlTjK','EBqeM','QPHeR','lkIOc','aEEed','มี\x20userId\x20ซ้ำกัน:\x20\x22','EMScY','tQBnW','status','DMtNZ','Psxfa','NKlEc','nJCgh','minute','rfPfn','NFSsF','XsZXj','EzLvH','$dateTimeCanDelete','yellow','{}.constructor(\x22return\x20this\x22)(\x20)','tyVgE','Pkoqb','bhXEw','mWpSi','sip','XKPfC','WcCsa','response','oeUCn','function\x20*\x5c(\x20*\x5c)','/mySendmail.js','OgGgb','LQdRr','rpp','counter','zWIMV','/manage/users','ZwQnf','xJqar','console','bwWxz','AfxTw','?rpp=20&page=1&load_id=','rhmxe','WBLVO','OjCVw','oZVUy','CVRbA','input','ZtDFK','OjdAi','vgPNt','redirect','getSessionData','userFullname','$changesHistory','WVtfU','vKlFv','QECui','ZtqrB','wgeRp','UZyxB','ueVwG','มีข้อมูลผิดพลาดที่แถว\x20','NgRnl','jTSQZ','YQtjk','KWgTL','fdvKp','qPagc','gEDJK','cUtHw','WipBB','zEMNr','send','gger','add','iSgXP','cPIit','chLLG','find','hfllO','edNiu','vGiyX','vgccu','OuyTJ','memoryStorage','BPwIH','{{sep}}(\x20ไม่พบเซสชั่น\x20)','parse','length','push','sRoKg','$userLastname','body','udrzc','render','WgiTt','ychwH','RDrni','write','wWVrz','userPhone','bqJNs','dUkGh','vvFit','mCpdP','jTebb','JPthd','countDocuments','iSsKD','getUserBranches','ไม่มีข้อมูล','UzJSS','dateTimeCanDelete','GHTQU','CTIvW','UBSsD','AtqHb','qUcaK','{{sep}}\x22','rjXBO','FXnuG','isOS','tyHfX','user-','insertedId','&rpp=','acknowledged','lYDmR','nTaIM','vPixC','tinRa','string','/download-excel','937258TQASOu','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','QvHmF','single','jPtXd','WBlnT','qoGco','NTlfT','HzgQD','FcWGa','LhKgd','สร้างผู้ใช้ใหม่\x20\x22','tjIRs','trim','mFBOv','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','QYjhS','NsQyE','Inxpu','userNormalLoginCount','flash','userLastLogin','get','insertOne','session','gdHkl','dbName','ooXdo','vqErx','then','CQqfa','cLcUS','oYzwW','LeVut','branchInfo','toArray','sDULk','yoGuA','MrZdt','1154526RLPshf','manageUsers','ntSoN','&page=','vnZOD','renderView','ozxQO','size','pMGLl','UUcOx','wIZXl','username','dbColl_sessions','base64','GWaLJ','รูปแบบอีเมลไม่ถูกต้อง','dkKjR','toString','BhHeK','GkgSp','collection','hasOwnProperty','GjDxw','userLastname','page','WTeIB','NTViD','.xlsx','FAbfE','zroUC','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','upsertedCount','buffer','readFileSync','lZxfN','xAwcc','zqXJm','EGHiB','XpqMy','/save','VATmD','fPNeo','xFuwG','akRYz','getChangeHistory','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','19Fvzkpb','564234uoTLAj','Pjssa','hRuYe','LiLPD','book_append_sheet','fzABA','hBlzL','dbColl_warehouseIn','uSHWk','GfbPU','KcZlG','9341736ybKkek','iymWw','stringify','nciqu','sNOUF','Eyyhp','LoWNX','พิมพ์ข้อมูล\x20','QDfGV','UXLNV','drZUz','deletedCount','/load','lgwAS','mbEdU','HCEgT','QSOXC','utils','MngjQ','TkYWq','JiaYE','rIARU','__proto__','sendRegisterUserEmail','sendFile','NlIQl','VxZzp','iuiEp','heEZu','apply','RqSaJ','unshift','NJLPQ','uFSnD','tIfRu','xqAOh','/upload-excel','yJMzg','oTPpN','getDate','pQtJT','CGfjP','OlAfc','$branchInfo.branchName','PVSQJ','miSyA','mokRb','aSYZD','WngpD','anfCe','yrTGG','MEEMd','ACXgC','AbOiU','gVndv','gQgJB','DEncd','IGKAJ','jGrXe','IPfkp','log','klqXn','ไม่มีข้อมูลที่อัปเดท','includes','action','iNyfI','green','\x22\x20เรียบร้อยแล้ว','HGZtp','/myModule.js','EGvXR','GqtQI','userAuthority','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','../','XOYIh','debu','CCgWT','whCxl','bOBCY','red','nNZjJ','LyEtt','mUylF','vRvbI','TsJdG','pYLGQ','from','getDateTime','chain','pHkaZ','pWNGx','users','PebZj','SjBaO','gzqYT','EEBNA'];_0x9089=function(){return _0x1951b3;};return _0x9089();}import _0x3e117 from'express';import{MongoClient as _0x418e1d,ObjectId as _0x8352e7}from'mongodb';import _0x3a6468 from'bcrypt';const x=_0x3e117['Router']();import _0x58ec85 from'multer';function _0x419d(_0x2f42d7,_0x176cb5){const _0x3046ba=_0x9089();return _0x419d=function(_0xa4edf9,_0xebe36){_0xa4edf9=_0xa4edf9-0x1a9;let _0x477934=_0x3046ba[_0xa4edf9];return _0x477934;},_0x419d(_0x2f42d7,_0x176cb5);}import _0x4f86d9 from'validator';import _0xbd7032 from'xlsx';import _0x8495c from'path';import _0xebc1f2 from'fs';import _0x23e73c from'ejs';import _0x1ca211 from'../middleware/mainAuth.js';const H=await import('../'+mymoduleFolder+_0x38e7d8(0x25c)),O=await import(_0x38e7d8(0x261)+mymoduleFolder+'/myDateTime.js'),M=await import(_0x38e7d8(0x261)+mymoduleFolder+_0x38e7d8(0x286)),re=await import(_0x38e7d8(0x261)+mymoduleFolder+_0x38e7d8(0x38e)),z=await import(_0x38e7d8(0x261)+mymoduleFolder+_0x38e7d8(0x31c)),b=_0x38e7d8(0x394),Q=b+_0x38e7d8(0x204),X=b+_0x38e7d8(0x2df),W=b+_0x38e7d8(0x223),G=b+_0x38e7d8(0x314),V=b+'/print',Y=b+_0x38e7d8(0x326),K=b+_0x38e7d8(0x1b5),Z=b+_0x38e7d8(0x23b),ne=b[_0x38e7d8(0x278)](/\//g,'_'),oe=0x5a0*0x3c;x[_0x38e7d8(0x1cc)](b,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x41d5f1,_0x3babc8)=>{const _0x27807b=_0x38e7d8,_0x296864={'fbIhY':function(_0x84144b,_0x1e7936){return _0x84144b(_0x1e7936);},'QECui':function(_0x4672bd,_0x5e5f2b){return _0x4672bd+_0x5e5f2b;},'CVRbA':_0x27807b(0x263),'GjDxw':_0x27807b(0x3bb),'iSgXP':_0x27807b(0x257),'NJLPQ':function(_0x5344db,_0x476db3){return _0x5344db===_0x476db3;},'akRYz':_0x27807b(0x23d),'iymWw':'Owjbn','qUcaK':function(_0x257889,_0x5799c7){return _0x257889!==_0x5799c7;},'HlOIK':function(_0x3573a3,_0x1dba8a){return _0x3573a3==_0x1dba8a;},'HCEgT':function(_0x1dffa9,_0x3ce227){return _0x1dffa9!==_0x3ce227;},'OyLBY':function(_0x3b2a60,_0x4b8be6){return _0x3b2a60+_0x4b8be6;},'eOGYQ':_0x27807b(0x2e7),'inzyt':function(_0x2e2126,_0x52cc23){return _0x2e2126(_0x52cc23);},'udrzc':function(_0x141341,_0x1a5cd6){return _0x141341(_0x1a5cd6);},'MJidd':function(_0x3a0613,_0x5cbc5d){return _0x3a0613*_0x5cbc5d;},'tjIRs':function(_0x11f24e,_0x2fbb82){return _0x11f24e-_0x2fbb82;},'QPHeR':_0x27807b(0x233),'ZtqrB':_0x27807b(0x2fb),'vRvbI':_0x27807b(0x288),'jKeML':function(_0x6e977d,_0xdf2795){return _0x6e977d(_0xdf2795);},'PQaJQ':function(_0x5d4a3b,_0x4baa84){return _0x5d4a3b/_0x4baa84;},'hIKim':function(_0x460631,_0x17c825){return _0x460631<_0x17c825;},'WAANn':function(_0x26fd1a,_0x3efdb0){return _0x26fd1a>_0x3efdb0;},'ftffn':function(_0x3ea060,_0x45e957){return _0x3ea060+_0x45e957;},'tyHfX':function(_0x3135b9,_0x4754af){return _0x3135b9+_0x4754af;},'oZVUy':function(_0x130e59,_0x362bc8){return _0x130e59(_0x362bc8);},'AbWkC':'$userPrefix','PDeeR':'$userFirstname','nFKZy':_0x27807b(0x3cd),'LhKgd':_0x27807b(0x3a7),'PVSQJ':_0x27807b(0x381),'lBDfn':_0x27807b(0x37c),'QDfGV':_0x27807b(0x1e7),'NlIQl':_0x27807b(0x2b8),'RgvcA':function(_0x4425dd,_0xb45b9c){return _0x4425dd(_0xb45b9c);},'gjnGL':function(_0x27731f,_0x4544ad){return _0x27731f(_0x4544ad);},'FaHEl':function(_0x232594,_0x4b374a){return _0x232594===_0x4b374a;},'mgYuC':_0x27807b(0x2c9),'sRoKg':_0x27807b(0x2b9),'RgctH':function(_0x560d45,_0xe3832e){return _0x560d45===_0xe3832e;},'CCgWT':'IYgtx','BlQbU':'userFlash','AbOiU':_0x27807b(0x1de),'wmgas':_0x27807b(0x2f7),'Bigqd':_0x27807b(0x301),'QdkQX':function(_0x4d8c0,_0x53e872){return _0x4d8c0===_0x53e872;},'AxxQS':_0x27807b(0x1ba),'hdVpk':_0x27807b(0x1e6),'WxDAZ':_0x27807b(0x2b5)},_0x4000e9=_0x41d5f1['query'][_0x27807b(0x388)],_0x51631b=_0x296864['fbIhY'](Number,_0x41d5f1[_0x27807b(0x2d7)]['rpp'])||0x14,_0x2bb255=_0x296864[_0x27807b(0x2c0)](Number,_0x41d5f1[_0x27807b(0x2d7)][_0x27807b(0x1f5)])||0x1,_0x8a750a=_0x41d5f1[_0x27807b(0x2d7)]['load_id']||'',_0xc55b96=_0x296864['udrzc'](Number,_0x296864['MJidd'](_0x296864[_0x27807b(0x1c2)](_0x2bb255,0x1),_0x51631b)),_0x2cf10d=O['getDateTime'](0x0),_0x33dbc2=new _0x418e1d(dbUrl);try{if(_0x296864[_0x27807b(0x237)](_0x296864[_0x27807b(0x371)],_0x296864[_0x27807b(0x371)])){await _0x33dbc2[_0x27807b(0x2f0)]();const _0x1dd0a9=_0x33dbc2['db'](global[_0x27807b(0x1d0)])[_0x27807b(0x1f1)](global[_0x27807b(0x2c8)]);if(_0x4000e9){if(_0x296864['NJLPQ'](_0x296864[_0x27807b(0x3ab)],_0x296864[_0x27807b(0x3ab)])){const _0x3b7519=new RegExp(_0x4000e9[_0x27807b(0x278)](/[.*+?^${}()|[\]\\]/g,_0x296864[_0x27807b(0x26b)]),'i');let _0x43deee={};_0x296864[_0x27807b(0x2c0)](isNaN,_0x296864['fbIhY'](Number,_0x4000e9))?_0x43deee={'userId':{'$regex':_0x3b7519}}:_0x43deee={'userId':_0x296864['jKeML'](Number,_0x4000e9)};var _0x498fa8=await _0x1dd0a9[_0x27807b(0x3dd)]({'$or':[_0x43deee,{'username':{'$regex':_0x3b7519}},{'userFirstname':{'$regex':_0x3b7519}}]});}else{if(_0x4fbc70)return _0x245b2c;else Neulzn['fbIhY'](_0x53f054,0x0);}}else var _0x498fa8=await _0x1dd0a9[_0x27807b(0x3dd)]({});const _0x4673d7=Math[_0x27807b(0x284)](_0x296864['PQaJQ'](_0x498fa8,_0x51631b)),_0x2d5a6d=_0x296864[_0x27807b(0x2f2)](_0x296864[_0x27807b(0x1c2)](_0x296864[_0x27807b(0x3cf)](Number,_0x2bb255),0x1),0x1)?'-':_0x296864[_0x27807b(0x1c2)](_0x296864[_0x27807b(0x293)](Number,_0x2bb255),0x1),_0x8dc399=_0x296864[_0x27807b(0x2c0)](Number,_0x2bb255),_0x61f991=_0x296864['WAANn'](_0x296864['ftffn'](_0x296864[_0x27807b(0x293)](Number,_0x2bb255),0x1),_0x4673d7)?'-':_0x296864[_0x27807b(0x1ab)](_0x296864[_0x27807b(0x39e)](Number,_0x2bb255),0x1),_0x4cee73=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x296864[_0x27807b(0x352)],'\x20',_0x296864[_0x27807b(0x2b1)],'\x20',_0x296864['nFKZy']]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x296864[_0x27807b(0x1c0)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x2cf10d},'endDate':{'$toDate':_0x296864[_0x27807b(0x243)]},'unit':_0x296864[_0x27807b(0x2cb)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0xc55b96},{'$limit':_0x51631b}];if(_0x4000e9){if(_0x296864[_0x27807b(0x3e7)](_0x296864[_0x27807b(0x21f)],_0x296864[_0x27807b(0x230)])){const _0x278046=_0x4000e9?new RegExp(''+_0x4000e9,'i'):new RegExp('.*');let _0x328a3e={};_0x296864[_0x27807b(0x2ff)](isNaN,_0x296864[_0x27807b(0x39e)](Number,_0x4000e9))?_0x328a3e={'userId':{'$regex':_0x278046}}:_0x328a3e={'userId':_0x296864['gjnGL'](Number,_0x4000e9)},_0x4cee73[_0x27807b(0x236)]({'$match':{'$or':[_0x328a3e,{'username':{'$regex':_0x278046}},{'userFirstname':{'$regex':_0x278046}}]}});}else{const _0x16bdfc=_0x3a89a6?function(){const _0x3727ee=_0x27807b;if(_0x55cbbb){const _0x1da999=_0x59f8e9[_0x3727ee(0x234)](_0x26d42d,arguments);return _0x30f99d=null,_0x1da999;}}:function(){};return _0x2dfd92=![],_0x16bdfc;}}const _0x2b4a64=M[_0x27807b(0x3a5)](_0x41d5f1),_0x121faa=_0x2b4a64[_0x27807b(0x25f)];let _0x528158=await _0x1dd0a9[_0x27807b(0x2e5)](_0x4cee73)[_0x27807b(0x1d9)]();if(['S']['includes'](_0x121faa)){if(_0x296864['FaHEl'](_0x296864['mgYuC'],_0x296864[_0x27807b(0x3cc)]))Neulzn['fbIhY'](_0x3f7f76,0x0);else{const _0x346847=_0x2b4a64[_0x27807b(0x2f6)];_0x528158=_0x528158['filter'](_0x1dfe4a=>{const _0x7b239e=_0x27807b;if(_0x296864[_0x7b239e(0x237)](_0x296864[_0x7b239e(0x208)],_0x296864[_0x7b239e(0x218)]))(function(){return!![];}[_0x7b239e(0x29b)](Neulzn[_0x7b239e(0x3aa)](Neulzn[_0x7b239e(0x39f)],Neulzn[_0x7b239e(0x1f3)]))[_0x7b239e(0x2cd)](Neulzn[_0x7b239e(0x3bd)]));else{const _0xe195ef=_0x296864[_0x7b239e(0x3e7)](_0x1dfe4a[_0x7b239e(0x25f)],'S')||_0x296864[_0x7b239e(0x2d1)](_0x1dfe4a[_0x7b239e(0x2f6)],_0x346847);return _0x296864[_0x7b239e(0x226)](_0x1dfe4a[_0x7b239e(0x25f)],'O')&&_0xe195ef;}});}}if(_0x8a750a)var _0x52ab2e=await _0x1dd0a9['findOne']({'_id':new _0x8352e7(_0x8a750a)},{'projection':{'userPassword':0x0}});else var _0x52ab2e={};if(_0x52ab2e&&_0x296864[_0x27807b(0x237)](Object['keys'](_0x52ab2e)[_0x27807b(0x3ca)],0x0)){if(_0x296864['RgctH'](_0x296864[_0x27807b(0x264)],_0x296864[_0x27807b(0x264)])){const _0x584e51=_0x41d5f1[_0x27807b(0x1ca)](_0x296864['BlQbU']);_0x584e51&&_0x296864[_0x27807b(0x2e2)](_0x584e51[_0x27807b(0x3ca)],0x0)&&(_0x52ab2e={..._0x584e51[0x0]});}else(function(){return![];}['constructor'](Neulzn['OyLBY'](Neulzn[_0x27807b(0x39f)],Neulzn[_0x27807b(0x1f3)]))[_0x27807b(0x234)](Neulzn['eOGYQ']));}const _0x12ca5e=await H[_0x27807b(0x1e2)](_0x296864[_0x27807b(0x24c)],_0x3babc8,{'title':PAGE_MANAGE_USERS,'time':O[_0x27807b(0x23e)](),'msg':_0x41d5f1[_0x27807b(0x1ca)](_0x296864[_0x27807b(0x311)]),'user':await M[_0x27807b(0x3a5)](_0x41d5f1),'settings':await H[_0x27807b(0x342)](),'load_id':_0x8a750a,'sip':_0x4000e9,'rpp':_0x51631b,'page':_0x2bb255,'pagePre':_0x2d5a6d,'pageAct':_0x8dc399,'pageNxt':_0x61f991,'pageLst':_0x4673d7,'pageRedirect':b,'data':_0x528158,'dataBranches':await z[_0x27807b(0x3df)]({'branchStatus':_0x296864[_0x27807b(0x2ca)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x52ab2e});return _0x3babc8['send'](_0x12ca5e);}else _0x317f76[_0x27807b(0x345)]();}catch(_0x1d92d0){_0x296864['QdkQX'](_0x296864[_0x27807b(0x29d)],_0x296864[_0x27807b(0x29d)])?(console[_0x27807b(0x253)](_0x1d92d0[_0x27807b(0x324)]),_0x3babc8[_0x27807b(0x377)](0x194)[_0x27807b(0x22f)](file404)):_0x3719c8['close']();}finally{if(_0x296864[_0x27807b(0x226)](_0x296864[_0x27807b(0x285)],_0x296864[_0x27807b(0x353)]))_0x33dbc2[_0x27807b(0x345)]();else return!![];}}),x['post'](W,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x12d66b,_0x4d9ba9)=>{const _0x122638=_0x38e7d8,_0x43f9ff={'LdooM':function(_0x170729,_0x3c4bb3){return _0x170729(_0x3c4bb3);},'YQtjk':function(_0x168d3d,_0x444a7b){return _0x168d3d(_0x444a7b);},'Lbftj':function(_0x4ff706,_0x43ab3f){return _0x4ff706===_0x43ab3f;},'sSGRL':_0x122638(0x3b7),'EMScY':_0x122638(0x34e),'rIARU':_0x122638(0x2f7),'bOBCY':_0x122638(0x267),'pDZGt':'Not\x20Found','BlbzE':function(_0x1e1e45,_0x25e6dd){return _0x1e1e45===_0x25e6dd;},'ODNqE':_0x122638(0x1c4),'UpRxe':_0x122638(0x362),'Padwy':_0x122638(0x3b1),'YnXqS':_0x122638(0x2d5)},_0x2c12d2=_0x12d66b[_0x122638(0x3ce)]['load_id'],_0x12b887=_0x12d66b['body'][_0x122638(0x388)],_0x4fb768=_0x43f9ff['LdooM'](Number,_0x12d66b['body'][_0x122638(0x391)])||0x14,_0x2e8d5d=_0x43f9ff[_0x122638(0x3b2)](Number,_0x12d66b[_0x122638(0x3ce)][_0x122638(0x1f5)])||0x1,_0x4dec79=b+_0x122638(0x361)+_0x12b887+_0x122638(0x1ae)+_0x4fb768+_0x122638(0x1e0)+_0x2e8d5d+'&load_id='+_0x2c12d2,_0x531ebb=new _0x418e1d(dbUrl);try{return _0x43f9ff[_0x122638(0x2da)](_0x43f9ff['sSGRL'],_0x43f9ff[_0x122638(0x375)])?![]:(await _0x531ebb['db'](dbName)['collection'](dbColl_users)[_0x122638(0x351)]({'_id':new _0x8352e7(_0x2c12d2)},{'projection':{'changesHistory':0x0}})?_0x12d66b[_0x122638(0x1ca)](_0x43f9ff[_0x122638(0x22c)],null):_0x12d66b[_0x122638(0x1ca)](_0x43f9ff['rIARU'],{'class':_0x43f9ff[_0x122638(0x266)],'text':new Error(_0x43f9ff[_0x122638(0x307)])+_0x122638(0x3e8)+_0x2c12d2+'\x22'}),_0x4d9ba9[_0x122638(0x3a4)](_0x4dec79));}catch(_0x12f3dd){if(_0x43f9ff[_0x122638(0x296)](_0x43f9ff['ODNqE'],_0x43f9ff[_0x122638(0x2a9)]))_0x381bd2[_0x122638(0x2a1)](_0x4761f7['userId'])?_0x51654d[_0x122638(0x3bc)](_0x14327f[_0x122638(0x2f6)]):_0x2e349f[_0x122638(0x3bc)](_0xacfc24[_0x122638(0x2f6)]);else return console[_0x122638(0x253)](_0x12f3dd[_0x122638(0x324)]),_0x12d66b['flash'](_0x43f9ff['rIARU'],{'class':_0x43f9ff[_0x122638(0x266)],'text':''+_0x12f3dd[_0x122638(0x324)]}),_0x4d9ba9[_0x122638(0x3a4)](_0x4dec79);}finally{_0x43f9ff[_0x122638(0x2da)](_0x43f9ff['Padwy'],_0x43f9ff[_0x122638(0x356)])?_0x5567bc[_0x122638(0x345)]():_0x531ebb[_0x122638(0x345)]();}}),x[_0x38e7d8(0x34d)](Q,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x2ae736,_0x51eb8f)=>{const _0x237ee2=_0x38e7d8,_0x47bb25={'zPWCd':function(_0x4481e1,_0xe27fb1){return _0x4481e1!==_0xe27fb1;},'WJcEv':'gfhZD','TkQqS':_0x237ee2(0x376),'QYBSq':function(_0x15a531,_0x3578fc){return _0x15a531===_0x3578fc;},'TOuQZ':function(_0x96be41,_0x47b9c5){return _0x96be41!==_0x47b9c5;},'EEBNA':_0x237ee2(0x275),'cPIit':function(_0x159888,_0x489b65,_0x469dcd){return _0x159888(_0x489b65,_0x469dcd);},'CQqfa':function(_0x4ceefc){return _0x4ceefc();},'gdHkl':function(_0x35e260,_0x10d9ed){return _0x35e260(_0x10d9ed);},'GkgSp':function(_0x41d203,_0x43aae9){return _0x41d203+_0x43aae9;},'DEncd':function(_0x43baad,_0xd68047){return _0x43baad+_0xd68047;},'uHyxV':_0x237ee2(0x33c),'IPfkp':_0x237ee2(0x383),'FAbfE':_0x237ee2(0x2d8),'oeUCn':function(_0x70691d,_0x5ced43){return _0x70691d+_0x5ced43;},'rLtEs':function(_0x57d099,_0x49a777){return _0x57d099(_0x49a777);},'rjXBO':function(_0x114f3f,_0x184011){return _0x114f3f!==_0x184011;},'XKPfC':function(_0x40bdd4,_0x279130){return _0x40bdd4==_0x279130;},'NsQyE':'userFlash','nNZjJ':function(_0x4527a1,_0x409507){return _0x4527a1>_0x409507;},'AtqHb':_0x237ee2(0x309),'lkIOc':function(_0x8b35a9,_0x40e928){return _0x8b35a9(_0x40e928);},'taNrE':_0x237ee2(0x2f7),'IMwye':_0x237ee2(0x267),'USseW':_0x237ee2(0x1ec),'lgwAS':_0x237ee2(0x1be),'RhCXN':'RIUoq','FcWGa':function(_0x3529ec,_0x187d01){return _0x3529ec!==_0x187d01;},'KqDvy':_0x237ee2(0x2a2),'hBlzL':_0x237ee2(0x2e3),'Fwjcc':_0x237ee2(0x1b7),'muGjs':function(_0x4b12d9,_0x217a51){return _0x4b12d9==_0x217a51;},'tbhVv':'active','tKMKx':function(_0x512419,_0x423299){return _0x512419==_0x423299;},'OuyTJ':function(_0x2e50c2,_0x49b451){return _0x2e50c2==_0x49b451;},'mWpSi':function(_0x4cf791,_0x331bad){return _0x4cf791==_0x331bad;},'nciqu':function(_0x447a8d,_0x3e20b5){return _0x447a8d==_0x3e20b5;},'EBlzZ':function(_0x528edc,_0xabc46e){return _0x528edc===_0xabc46e;},'RhueH':_0x237ee2(0x28c),'NEOef':_0x237ee2(0x2dc),'pWNGx':function(_0xe8e4ad,_0x4acaa4){return _0xe8e4ad===_0x4acaa4;},'nNeuW':_0x237ee2(0x26d),'NQJvl':'TBcyS','QTKEU':_0x237ee2(0x365),'jTebb':'mqhrt','wYBzj':_0x237ee2(0x1ef),'LkNbM':_0x237ee2(0x3c8),'hCUmq':'CEJHG','WgiTt':_0x237ee2(0x3b9),'iNyfI':_0x237ee2(0x259),'Eyyhp':function(_0x34f091,_0x3ce468){return _0x34f091<_0x3ce468;},'fzABA':function(_0x35c99,_0x574494){return _0x35c99<_0x574494;},'kXtyR':_0x237ee2(0x382),'ARwQU':'Not\x20Found','gVndv':_0x237ee2(0x300),'iVbwd':'อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','LZOBS':function(_0x3b8001,_0x27279f){return _0x3b8001>_0x27279f;},'lYDmR':function(_0x3145f2,_0x166f04){return _0x3145f2===_0x166f04;},'pFQmB':_0x237ee2(0x3ac),'FslxC':_0x237ee2(0x2f5),'iSsKD':'เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','bqJNs':function(_0x46b295,_0x18db02){return _0x46b295!==_0x18db02;},'zvlpK':_0x237ee2(0x312),'fnocl':_0x237ee2(0x241),'BDQqu':function(_0x3081d2,_0x31321c){return _0x3081d2===_0x31321c;},'drZUz':_0x237ee2(0x2a8),'BgECT':function(_0xb0e0c3){return _0xb0e0c3();}},_0xcc968c=[];let _0x39af86=!0x1;const _0x177c23=async()=>{const _0x20e78e=_0x237ee2;if(_0x47bb25['zPWCd'](_0x47bb25['WJcEv'],_0x47bb25[_0x20e78e(0x2e4)])){if(_0x47bb25['QYBSq'](_0xcc968c['length'],0x0)){if(_0x47bb25[_0x20e78e(0x368)](_0x47bb25['EEBNA'],_0x47bb25[_0x20e78e(0x277)])){if(_0x3da8d2){const _0x30e520=_0x467943[_0x20e78e(0x234)](_0x24f299,arguments);return _0x4c86e0=null,_0x30e520;}}else{_0x39af86=!0x1;return;}}_0x39af86=!0x0;const {req:_0x29307a,res:_0x387a78}=_0xcc968c['shift']();await _0x47bb25[_0x20e78e(0x3be)](_0xbec4ad,_0x29307a,_0x387a78),_0x47bb25[_0x20e78e(0x1d4)](_0x177c23);}else _0x473f57['close']();},_0xbec4ad=async(_0x935713,_0x2043cd)=>{const _0x546da6=_0x237ee2,_0x587880={'Pjssa':_0x47bb25[_0x546da6(0x1f9)],'iuiEp':function(_0x25059f,_0x22120c){const _0x155e8a=_0x546da6;return _0x47bb25[_0x155e8a(0x1cf)](_0x25059f,_0x22120c);},'WkfQl':function(_0x3a168,_0xe0e237){return _0x47bb25['oeUCn'](_0x3a168,_0xe0e237);},'RHedu':_0x47bb25['uHyxV'],'WKzoj':_0x47bb25['IPfkp'],'GyNrZ':function(_0xb6c3de,_0xbac6ca){return _0x47bb25['rLtEs'](_0xb6c3de,_0xbac6ca);},'WcCsa':function(_0x1d36a7,_0x38dece){const _0x28495e=_0x546da6;return _0x47bb25[_0x28495e(0x3e9)](_0x1d36a7,_0x38dece);},'dEXjZ':function(_0x19a869,_0xe3ae9b){const _0x2a4b2d=_0x546da6;return _0x47bb25[_0x2a4b2d(0x389)](_0x19a869,_0xe3ae9b);},'jGrXe':_0x47bb25['NsQyE'],'VxZzp':function(_0x47864a,_0x14b49d){return _0x47bb25['nNZjJ'](_0x47864a,_0x14b49d);}};if(_0x47bb25[_0x546da6(0x368)](_0x47bb25[_0x546da6(0x3e6)],_0x47bb25[_0x546da6(0x3e6)])){let _0x5f9db8;try{_0x5f9db8=zLxRiT[_0x546da6(0x1cf)](_0x35df91,zLxRiT[_0x546da6(0x1f0)](zLxRiT[_0x546da6(0x24f)](zLxRiT[_0x546da6(0x2d2)],zLxRiT[_0x546da6(0x252)]),');'))();}catch(_0x4171a7){_0x5f9db8=_0x435a7c;}return _0x5f9db8;}else{const _0x21f65f=_0x935713[_0x546da6(0x3ce)][_0x546da6(0x2db)];delete _0x935713['body'][_0x546da6(0x2db)];const _0x298b7a=_0x935713[_0x546da6(0x3ce)][_0x546da6(0x388)],_0x28fe5e=_0x47bb25[_0x546da6(0x1cf)](Number,_0x935713[_0x546da6(0x3ce)][_0x546da6(0x391)])||0x14,_0x17f177=_0x47bb25[_0x546da6(0x372)](Number,_0x935713[_0x546da6(0x3ce)][_0x546da6(0x1f5)])||0x1;delete _0x935713[_0x546da6(0x3ce)][_0x546da6(0x391)],delete _0x935713[_0x546da6(0x3ce)][_0x546da6(0x388)],delete _0x935713[_0x546da6(0x3ce)][_0x546da6(0x1f5)],_0x935713['body']['userId']=_0x935713[_0x546da6(0x3ce)]['userId']?_0x47bb25[_0x546da6(0x2ac)](Number,_0x935713[_0x546da6(0x3ce)][_0x546da6(0x2f6)]):_0x935713[_0x546da6(0x3ce)][_0x546da6(0x2f6)],_0x935713[_0x546da6(0x3ce)][_0x546da6(0x319)]=_0x935713[_0x546da6(0x3ce)][_0x546da6(0x319)]?_0x47bb25[_0x546da6(0x2ac)](Number,_0x935713[_0x546da6(0x3ce)]['branchId']):_0x935713[_0x546da6(0x3ce)][_0x546da6(0x319)];const _0x158f40=_0x935713['body'][_0x546da6(0x1e8)]?.[_0x546da6(0x1c3)](),_0x3ee0be=_0x935713['body'][_0x546da6(0x292)]?.[_0x546da6(0x1c3)](),_0x231bae=_0x935713[_0x546da6(0x3ce)][_0x546da6(0x2f6)],_0xb403f0=''+b,_0x550560=b+_0x546da6(0x361)+_0x298b7a+'&rpp='+_0x28fe5e+_0x546da6(0x1e0)+_0x17f177+_0x546da6(0x299)+_0x21f65f;if(!new RegExp(USERNAME_PATTERN)['test'](_0x158f40))return _0x935713[_0x546da6(0x1ca)](_0x47bb25['NsQyE'],_0x935713[_0x546da6(0x3ce)]),_0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x332)],'text':USERNAME_DESCRIPTION}),_0x2043cd['redirect'](_0x550560);if(_0x3ee0be&&!new RegExp(EMAIL_PATTERN)[_0x546da6(0x36a)](_0x3ee0be))return _0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x1c7)],_0x935713['body']),_0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25['IMwye'],'text':_0x47bb25[_0x546da6(0x2d9)]}),_0x2043cd[_0x546da6(0x3a4)](_0x550560);const _0x3e5dc8=new _0x418e1d(dbUrl);try{if(_0x47bb25[_0x546da6(0x3e9)](_0x47bb25[_0x546da6(0x224)],_0x47bb25[_0x546da6(0x29f)])){await _0x3e5dc8[_0x546da6(0x2f0)]();const _0x44ecbe=_0x3e5dc8['db'](dbName),_0x547e3a=_0x44ecbe[_0x546da6(0x1f1)](dbColl_users);if(_0x21f65f){if(_0x47bb25[_0x546da6(0x1bf)](_0x47bb25[_0x546da6(0x334)],_0x47bb25[_0x546da6(0x212)])){var _0x393fdf=await _0x547e3a[_0x546da6(0x351)]({'_id':{'$ne':new _0x8352e7(_0x21f65f)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x3ee0be+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x158f40+'$','i')}},{'userId':_0x231bae}]});if(_0x393fdf)return _0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x1c7)],_0x935713['body']),_0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x332)],'text':_0x47bb25[_0x546da6(0x333)]}),_0x2043cd['redirect'](_0x550560);const _0x1582e8=await _0x547e3a[_0x546da6(0x351)]({'_id':new _0x8352e7(_0x21f65f)}),_0x4922dd=[_0x47bb25['muGjs'](_0x935713[_0x546da6(0x3ce)][_0x546da6(0x32a)],_0x47bb25['tbhVv']),_0x47bb25[_0x546da6(0x36b)](_0x1582e8[_0x546da6(0x1e8)],_0x935713[_0x546da6(0x3ce)][_0x546da6(0x1e8)]),_0x47bb25[_0x546da6(0x3c5)](_0x1582e8[_0x546da6(0x292)],_0x935713['body'][_0x546da6(0x292)]),_0x47bb25[_0x546da6(0x387)](_0x1582e8[_0x546da6(0x25f)],_0x935713[_0x546da6(0x3ce)][_0x546da6(0x25f)]),_0x47bb25[_0x546da6(0x21a)](_0x1582e8[_0x546da6(0x319)],_0x935713['body']['branchId'])],_0x22c115={'$set':_0x935713[_0x546da6(0x3ce)]},_0x56e805=await _0x547e3a[_0x546da6(0x33e)]({'_id':new _0x8352e7(_0x21f65f)},_0x22c115,{'upsert':!0x1});if(_0x56e805['acknowledged']&&_0x47bb25['muGjs'](_0x56e805[_0x546da6(0x2f3)],0x1)){if(_0x47bb25[_0x546da6(0x2a6)](_0x47bb25[_0x546da6(0x31b)],_0x47bb25[_0x546da6(0x331)])){_0x5b21f8=!0x1;return;}else{const _0x222248=M['getSessionData'](_0x935713);let _0x5f31a1='อัปเดท\x20\x22'+_0x231bae+'\x22\x20เรียบร้อยแล้ว';const _0x53a2f5=z[_0x546da6(0x209)](_0x1582e8,_0x935713[_0x546da6(0x3ce)]);if(_0x53a2f5&&_0x47bb25[_0x546da6(0x268)](_0x53a2f5[_0x546da6(0x3ca)],0x0)){if(_0x47bb25['pWNGx'](_0x47bb25[_0x546da6(0x283)],_0x47bb25[_0x546da6(0x32b)]))_0x1aaa96[_0x546da6(0x253)](_0x2b9a62[_0x546da6(0x324)]),_0x8a5251[_0x546da6(0x377)](0x194)[_0x546da6(0x22f)](_0x5d03f2);else{const _0x272b55={'dateTime':O['getDateTime'](),'userId':_0x222248[_0x546da6(0x2f6)],'userFullname':_0x222248[_0x546da6(0x3a6)],'changes':_0x53a2f5};await _0x547e3a[_0x546da6(0x33e)]({'userId':_0x231bae},{'$push':{'changesHistory':{'$each':[_0x272b55],'$position':0x0}}}),_0x5f31a1+=_0x47bb25[_0x546da6(0x344)];}}if(_0x4922dd[_0x546da6(0x256)](!0x1)){if(_0x47bb25[_0x546da6(0x366)](_0x47bb25[_0x546da6(0x3db)],_0x47bb25[_0x546da6(0x32c)]))_0x41798a[_0x546da6(0x253)](_0x587880[_0x546da6(0x20d)],_0x48d963),_0x302898['status'](0x194)[_0x546da6(0x22f)](_0xb0dc96);else{const _0x1b134d=await _0x44ecbe['collection'](global['dbColl_sessions'])[_0x546da6(0x347)]({'session.user_id':_0x21f65f});_0x1b134d['acknowledged']&&_0x47bb25[_0x546da6(0x268)](_0x1b134d[_0x546da6(0x222)],0x0)?_0x5f31a1+=_0x546da6(0x359)+_0x1b134d['deletedCount']+_0x546da6(0x2a3):_0x5f31a1+=_0x47bb25['LkNbM'];}}if(_0x4922dd[_0x546da6(0x256)](!0x1)&&_0x47bb25[_0x546da6(0x2f1)](_0x222248['user_id'],_0x21f65f)){if(_0x47bb25['pWNGx'](_0x47bb25[_0x546da6(0x2c2)],_0x47bb25[_0x546da6(0x3d1)]))_0x5db99c[_0x546da6(0x345)]();else{_0x935713[_0x546da6(0x1ce)][_0x546da6(0x294)](_0x511f44=>(_0x511f44&&console[_0x546da6(0x253)](_0x546da6(0x321),_0x511f44),_0x2043cd[_0x546da6(0x3a4)]('/')));return;}}else return _0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x258)],'text':_0x5f31a1}),_0x2043cd[_0x546da6(0x3a4)](_0x550560);}}else return _0x56e805[_0x546da6(0x1af)]&&(_0x47bb25[_0x546da6(0x21c)](_0x56e805[_0x546da6(0x2f3)],0x1)||_0x47bb25[_0x546da6(0x211)](_0x56e805['upsertedCount'],0x1))?(_0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x357)],'text':'\x22'+_0x231bae+_0x546da6(0x1c5)}),_0x2043cd[_0x546da6(0x3a4)](_0x550560)):(_0x935713['flash'](_0x47bb25[_0x546da6(0x1c7)],_0x935713[_0x546da6(0x3ce)]),_0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x332)],'text':new Error(_0x47bb25['ARwQU'])+_0x546da6(0x3e8)+_0x231bae+'\x22'}),_0x2043cd[_0x546da6(0x3a4)](_0x550560));}else _0x27af74=mfFeVf['iuiEp'](_0x23446a,mfFeVf['WkfQl'](mfFeVf['WkfQl'](mfFeVf[_0x546da6(0x27d)],mfFeVf['WKzoj']),');'))();}else{if(_0x47bb25[_0x546da6(0x272)](_0x47bb25[_0x546da6(0x24d)],_0x47bb25[_0x546da6(0x24d)])){if(await _0x547e3a[_0x546da6(0x351)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x3ee0be+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x158f40+'$','i')}}]}))return _0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x1c7)],_0x935713[_0x546da6(0x3ce)]),_0x935713['flash'](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x332)],'text':_0x47bb25[_0x546da6(0x32e)]}),_0x2043cd[_0x546da6(0x3a4)](_0x550560);const _0x4d7539=await _0x547e3a['find']({},{'projection':{'userId':0x1}})[_0x546da6(0x2b7)]({'userId':-0x1})[_0x546da6(0x34f)](0x1)[_0x546da6(0x1d9)](),_0x53a900=_0x47bb25[_0x546da6(0x2bf)](_0x4d7539[_0x546da6(0x3ca)],0x0)?_0x47bb25[_0x546da6(0x38c)](_0x4d7539[0x0][_0x546da6(0x2f6)],0x1):0x3e8;_0x935713[_0x546da6(0x3ce)][_0x546da6(0x2f6)]=_0x53a900,_0x935713[_0x546da6(0x3ce)][_0x546da6(0x3e2)]=O[_0x546da6(0x26f)](0x5a0);const _0x35adee=H['generatePassword']();_0x935713[_0x546da6(0x3ce)]['userPassword']=await _0x3a6468['hash'](_0x35adee,global[_0x546da6(0x295)]);const _0x41d140=await _0x547e3a[_0x546da6(0x1cd)](_0x935713['body']);if(_0x41d140[_0x546da6(0x1af)]&&_0x41d140['insertedId']){if(_0x47bb25[_0x546da6(0x1b0)](_0x47bb25['pFQmB'],_0x47bb25[_0x546da6(0x2e9)]))_0x5fcab3[_0x546da6(0x345)]();else{const _0x372bc7=_0x41d140[_0x546da6(0x1ad)][_0x546da6(0x1ee)](),_0x2aa318=b+_0x546da6(0x361)+_0x298b7a+_0x546da6(0x1ae)+_0x28fe5e+_0x546da6(0x1e0)+_0x17f177+_0x546da6(0x299)+_0x372bc7,_0x4ac8ff={..._0x935713['body']};if(delete _0x4ac8ff[_0x546da6(0x36c)],_0x3ee0be[_0x546da6(0x256)]('@')&&_0x3ee0be['includes']('.')&&_0x47bb25[_0x546da6(0x268)](_0x3ee0be[_0x546da6(0x3ca)],0x5))re['sendRegisterUserEmail'](_0x4ac8ff,_0x35adee)[_0x546da6(0x1d3)](_0x489fea=>(_0x935713[_0x546da6(0x1ca)](_0x546da6(0x2f7),{'class':_0x546da6(0x259),'text':_0x546da6(0x280)+_0x3ee0be+_0x546da6(0x2fc)+_0x489fea[_0x546da6(0x38b)]+')'}),_0x2043cd['redirect'](_0x2aa318)))[_0x546da6(0x2e6)](_0x57c2fa=>(_0x935713[_0x546da6(0x1ca)](_0x546da6(0x34a),_0x935713[_0x546da6(0x3ce)]),_0x935713[_0x546da6(0x1ca)](_0x546da6(0x2f7),{'class':_0x546da6(0x267),'text':''+_0x57c2fa[_0x546da6(0x324)]}),_0x2043cd[_0x546da6(0x3a4)](_0x2aa318)));else return _0x935713[_0x546da6(0x1ca)](_0x47bb25[_0x546da6(0x1c7)],_0x935713[_0x546da6(0x3ce)]),_0x935713['flash'](_0x47bb25[_0x546da6(0x2aa)],{'class':_0x47bb25[_0x546da6(0x258)],'text':'เพิ่มยูสเซอร์\x20'+_0x3ee0be}),_0x2043cd[_0x546da6(0x3a4)](_0x2aa318);}}else _0x935713[_0x546da6(0x1ca)](_0x47bb25['taNrE'],{'class':_0x47bb25['IMwye'],'text':_0x47bb25[_0x546da6(0x3de)]}),_0x2043cd[_0x546da6(0x3a4)](_0xb403f0);}else _0x2f4d88[_0x546da6(0x2f6)]=_0x587880[_0x546da6(0x35b)](_0x23b4a5,_0x473f9c[_0x546da6(0x2f6)]),_0x41b231[_0x546da6(0x319)]=_0x587880[_0x546da6(0x232)](_0x3b34f7,_0x36124c[_0x546da6(0x319)]),_0x41b107[_0x546da6(0x32a)]||(_0x345cbd[_0x546da6(0x32a)]=''),_0x17cebc[_0x546da6(0x3d6)]||(_0x58c86d['userPhone']=''),_0xfb0faf[_0x546da6(0x2bb)]||(_0x532b24[_0x546da6(0x2bb)]=''),_0x357f00[_0x546da6(0x1f4)]||(_0x5f0a1f['userLastname']=''),delete _0x140d80['userLastLogin'],delete _0x5b1783[_0x546da6(0x2b6)],delete _0x3066dd['userNormalLoginCount'],delete _0x199f36[_0x546da6(0x1cb)];}}else{const _0x571b1e=_0x587880[_0x546da6(0x38a)](_0x36ce7e[_0x546da6(0x25f)],'S')||_0x587880['dEXjZ'](_0x5c58e1[_0x546da6(0x2f6)],_0x222c01);return _0x587880[_0x546da6(0x38a)](_0x63f805[_0x546da6(0x25f)],'O')&&_0x571b1e;}}catch(_0x26609b){if(_0x47bb25[_0x546da6(0x3d7)](_0x47bb25[_0x546da6(0x303)],_0x47bb25[_0x546da6(0x27a)]))console['log'](_0x47bb25[_0x546da6(0x1f9)],_0x26609b),_0x2043cd[_0x546da6(0x377)](0x194)[_0x546da6(0x22f)](file404);else{if(_0x17af7c){const _0x2888a2=_0x35a85e[_0x546da6(0x234)](_0x3a8e05,arguments);return _0x6f71a4=null,_0x2888a2;}}}finally{if(_0x47bb25[_0x546da6(0x2ed)](_0x47bb25[_0x546da6(0x221)],_0x47bb25[_0x546da6(0x221)]))_0x3e5dc8[_0x546da6(0x345)]();else{const _0x96a4f8=_0x5da2ec[_0x546da6(0x1ca)](_0x587880[_0x546da6(0x251)]);_0x96a4f8&&_0x587880[_0x546da6(0x231)](_0x96a4f8['length'],0x0)&&(_0x5d4701={..._0x96a4f8[0x0]});}}}};_0xcc968c[_0x237ee2(0x3cb)]({'req':_0x2ae736,'res':_0x51eb8f}),_0x39af86||_0x47bb25['BgECT'](_0x177c23);}),x[_0x38e7d8(0x34d)](X,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x4ed6b0,_0x310b36)=>{const _0x37c857=_0x38e7d8,_0x47fd65={'vgccu':_0x37c857(0x2d8),'LKaGO':'msg','hRuYe':_0x37c857(0x267),'klqXn':function(_0x596fb4,_0x54a517){return _0x596fb4!==_0x54a517;},'xJqar':_0x37c857(0x246),'oPeGz':'cBJgY','oFssX':function(_0x53aef9,_0x429a46){return _0x53aef9>_0x429a46;},'oheXO':function(_0x4b9af9,_0x39c8bc){return _0x4b9af9+_0x39c8bc;},'bUNDb':_0x37c857(0x1fb),'fPLlc':_0x37c857(0x28f),'tinRa':_0x37c857(0x301),'DxutM':_0x37c857(0x330),'pqbIM':_0x37c857(0x2e0),'OgGgb':'qOCxW','IDYjm':_0x37c857(0x24b),'Slcnu':_0x37c857(0x317)},_0x52fbfe=new _0x418e1d(dbUrl),_0x11adb7=''+b;try{if(_0x47fd65[_0x37c857(0x254)](_0x47fd65[_0x37c857(0x396)],_0x47fd65['oPeGz'])){await _0x52fbfe[_0x37c857(0x2f0)]();const _0x500c94=_0x52fbfe['db'](dbName)['collection'](dbColl_users);var _0x553808=await _0x500c94[_0x37c857(0x3c0)]({})['sort']({'userId':-0x1})[_0x37c857(0x34f)](0x1)[_0x37c857(0x1d9)](),_0x4aec57=0x0;if(_0x47fd65[_0x37c857(0x290)](_0x553808[_0x37c857(0x3ca)],0x0))_0x4aec57=_0x47fd65[_0x37c857(0x305)](_0x553808[0x0][_0x37c857(0x2f6)],0x1);else return _0x310b36[_0x37c857(0x3ba)]({'isCreate':!0x1,'msg':_0x47fd65['bUNDb'],'redirectUrl':_0x11adb7});const _0x5a2a5a=process['env'][_0x37c857(0x28a)]||_0x47fd65[_0x37c857(0x2d0)],_0x2c5412={'userId':_0x4aec57,'userEmail':_0x37c857(0x1ac)+_0x4aec57+'@gmail.com','username':_0x37c857(0x1ac)+_0x4aec57,'userPrefix':'','userFirstname':'user-'+_0x4aec57,'userLastname':'','userAuthority':'U','userIsActive':_0x47fd65[_0x37c857(0x1b3)],'userPassword':await _0x3a6468[_0x37c857(0x2c5)](_0x5a2a5a,global[_0x37c857(0x295)]),'branchId':0x64,'dateTimeCanDelete':O[_0x37c857(0x26f)](oe)},_0x1fe82d=await _0x500c94[_0x37c857(0x1cd)](_0x2c5412);return _0x1fe82d[_0x37c857(0x1af)]&&_0x1fe82d['insertedId']?_0x310b36['send']({'isCreate':!0x0,'msg':_0x37c857(0x1c1)+_0x2c5412[_0x37c857(0x1e8)]+_0x37c857(0x260)+_0x5a2a5a+_0x37c857(0x343),'redirectUrl':b+_0x37c857(0x39a)+_0x1fe82d[_0x37c857(0x1ad)][_0x37c857(0x1ee)]()}):_0x310b36[_0x37c857(0x3ba)]({'isCreate':!0x1,'msg':_0x47fd65[_0x37c857(0x308)],'redirectUrl':_0x11adb7});}else return _0x33c658['log'](_0x47fd65[_0x37c857(0x3c4)],_0x5cac22),_0x381dbc[_0x37c857(0x1ca)](_0x47fd65['LKaGO'],{'class':_0x47fd65[_0x37c857(0x20e)],'text':_0x576818['message']}),_0x15f24e[_0x37c857(0x3a4)](_0x11db57);}catch(_0x212ffe){if(_0x47fd65['klqXn'](_0x47fd65['pqbIM'],_0x47fd65[_0x37c857(0x38f)]))console['log'](_0x47fd65[_0x37c857(0x3c4)],_0x212ffe),_0x310b36[_0x37c857(0x377)](0x194)[_0x37c857(0x22f)](_0x11adb7);else{const _0x366c05=_0x4d6062?function(){const _0x4b9bea=_0x37c857;if(_0x1dfb1f){const _0x2ca672=_0x2d52f0[_0x4b9bea(0x234)](_0x344d01,arguments);return _0x4668d2=null,_0x2ca672;}}:function(){};return _0x44523a=![],_0x366c05;}}finally{_0x47fd65[_0x37c857(0x254)](_0x47fd65[_0x37c857(0x298)],_0x47fd65['Slcnu'])?_0x52fbfe['close']():_0x1696a8[_0x37c857(0x2a1)](_0x10593b['userEmail'])?_0x5c69c4[_0x37c857(0x3bc)](_0x4aa383[_0x37c857(0x292)]):_0x341deb[_0x37c857(0x3bc)](_0x40f029[_0x37c857(0x292)]);}}),x[_0x38e7d8(0x34d)](G,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x1b3b93,_0x182aa3)=>{const _0x36a82b=_0x38e7d8,_0x1d7bf6={'WngpD':function(_0x48d2b5,_0x29f9a1){return _0x48d2b5>_0x29f9a1;},'ZYzap':_0x36a82b(0x34a),'JiaYE':_0x36a82b(0x2f7),'cLcUS':_0x36a82b(0x259),'ueVwG':_0x36a82b(0x2d8),'KcZlG':function(_0x3c4a62,_0x526c15){return _0x3c4a62(_0x526c15);},'jagFy':function(_0x296422,_0x57469e){return _0x296422!=_0x57469e;},'RqSaJ':function(_0x48149a,_0x15b413){return _0x48149a===_0x15b413;},'qPagc':'CgWkR','GWaLJ':'JCiMr','Psxfa':'userId','yJMzg':function(_0x45e3ad,_0x50c463){return _0x45e3ad===_0x50c463;},'aRimV':'BLZvJ','ZpEqz':_0x36a82b(0x37a),'wItFg':_0x36a82b(0x267),'UzJSS':'CuaaX','agNPm':_0x36a82b(0x3c8),'TsJdG':function(_0x464938,_0x448f85){return _0x464938===_0x448f85;},'oOiQk':_0x36a82b(0x269),'MEEMd':_0x36a82b(0x24e),'vqErx':'KFaDu'};let {_id_toDelete:_0x6e31cd,load_id:_0x1f7f77,sip:_0x3fe1fc,Id_toDelete:_0x65d5d8}=_0x1b3b93['body'];const _0x3c9d5e=_0x1d7bf6[_0x36a82b(0x216)](Number,_0x1b3b93[_0x36a82b(0x3ce)]['rpp'])||0x14,_0x9b5c37=_0x1d7bf6[_0x36a82b(0x216)](Number,_0x1b3b93[_0x36a82b(0x3ce)][_0x36a82b(0x1f5)])||0x1;_0x65d5d8=_0x1d7bf6[_0x36a82b(0x216)](Number,_0x65d5d8);const _0x21163b=_0x6e31cd&&_0x1d7bf6[_0x36a82b(0x27b)](_0x6e31cd,_0x1f7f77)?_0x36a82b(0x299)+_0x6e31cd:'',_0x21acf0=b+'?sip='+_0x3fe1fc+_0x36a82b(0x1ae)+_0x3c9d5e+_0x36a82b(0x1e0)+_0x9b5c37+_0x21163b,_0x59b8b7=new _0x418e1d(global[_0x36a82b(0x31a)]);try{if(_0x1d7bf6[_0x36a82b(0x235)](_0x1d7bf6[_0x36a82b(0x3b5)],_0x1d7bf6[_0x36a82b(0x1eb)]))return _0x3f01b2;else{await _0x59b8b7['connect']();const _0x27ac82=_0x59b8b7['db'](global[_0x36a82b(0x1d0)]),_0x3cf4c3=_0x27ac82[_0x36a82b(0x1f1)](global['dbColl_users']),_0x3f75f9=[{'coll':_0x27ac82[_0x36a82b(0x1f1)](global[_0x36a82b(0x213)]),'name':global[_0x36a82b(0x213)],'key':_0x1d7bf6[_0x36a82b(0x379)]},{'coll':_0x27ac82[_0x36a82b(0x1f1)](global['dbColl_warehouseOut']),'name':global['dbColl_warehouseOut'],'key':_0x1d7bf6[_0x36a82b(0x379)]},{'coll':_0x27ac82[_0x36a82b(0x1f1)](global[_0x36a82b(0x355)]),'name':global[_0x36a82b(0x355)],'key':_0x1d7bf6['Psxfa']},{'coll':_0x27ac82['collection'](global[_0x36a82b(0x2d6)]),'name':global[_0x36a82b(0x2d6)],'key':_0x1d7bf6[_0x36a82b(0x379)]}];for(const {coll:_0x2236d,name:_0x198ce7,key:_0x24f718}of _0x3f75f9){if(_0x1d7bf6[_0x36a82b(0x23c)](_0x1d7bf6[_0x36a82b(0x2be)],_0x1d7bf6[_0x36a82b(0x287)])){const _0x44f61d=_0x328d1d[_0x36a82b(0x1ad)]['toString'](),_0xda0a34=_0x21b5d0+'?sip='+_0x58b2c2+_0x36a82b(0x1ae)+_0x1258fe+_0x36a82b(0x1e0)+_0x1d0c7d+_0x36a82b(0x299)+_0x44f61d,_0x163b41={..._0xfc82b4['body']};if(delete _0x163b41[_0x36a82b(0x36c)],_0x3287f3[_0x36a82b(0x256)]('@')&&_0x5ab1ee['includes']('.')&&_0x1d7bf6[_0x36a82b(0x247)](_0x105ac2[_0x36a82b(0x3ca)],0x5))_0xf948ab[_0x36a82b(0x22e)](_0x163b41,_0x7155e0)[_0x36a82b(0x1d3)](_0x22a720=>(_0x17d643[_0x36a82b(0x1ca)](_0x36a82b(0x2f7),{'class':_0x36a82b(0x259),'text':_0x36a82b(0x280)+_0x5ea67a+'){{sep}}(CODE\x20:\x20'+_0x22a720['response']+')'}),_0x4f3da6[_0x36a82b(0x3a4)](_0xda0a34)))[_0x36a82b(0x2e6)](_0x2903b2=>(_0x50cea0[_0x36a82b(0x1ca)]('userFlash',_0x19948b[_0x36a82b(0x3ce)]),_0xcc385f[_0x36a82b(0x1ca)]('msg',{'class':'red','text':''+_0x2903b2['message']}),_0x359573['redirect'](_0xda0a34)));else return _0x29ee22[_0x36a82b(0x1ca)](_0x1d7bf6[_0x36a82b(0x2c1)],_0x8b11a2['body']),_0x5d8f5e[_0x36a82b(0x1ca)](_0x1d7bf6[_0x36a82b(0x22b)],{'class':_0x1d7bf6[_0x36a82b(0x1d5)],'text':_0x36a82b(0x28d)+_0x3ca2e7}),_0x4b0fcf['redirect'](_0xda0a34);}else{const _0x329d55={};if(_0x329d55[_0x24f718]=_0x65d5d8,await _0x2236d[_0x36a82b(0x351)](_0x329d55))return await _0x3cf4c3[_0x36a82b(0x33e)]({'userId':_0x65d5d8},{'$set':{'canDelete':!0x1}}),_0x1b3b93['flash'](_0x1d7bf6[_0x36a82b(0x22b)],{'class':_0x1d7bf6[_0x36a82b(0x2a7)],'text':'ยูสเซอร์\x20\x22'+_0x65d5d8+'\x22\x20มีอยู่ในเอกสาร\x20'+_0x198ce7+_0x36a82b(0x349)}),_0x182aa3[_0x36a82b(0x3a4)](_0x21acf0);}}if(_0x1d7bf6[_0x36a82b(0x23c)]((await _0x3cf4c3['deleteOne']({'_id':new _0x8352e7(_0x6e31cd)}))['deletedCount'],0x1)){if(_0x1d7bf6[_0x36a82b(0x23c)](_0x1d7bf6[_0x36a82b(0x3e1)],_0x1d7bf6[_0x36a82b(0x3e1)])){const _0x437a55=await _0x27ac82[_0x36a82b(0x1f1)](global[_0x36a82b(0x1e9)])['deleteMany']({'session.user_id':_0x6e31cd});if(_0x437a55[_0x36a82b(0x1af)]&&_0x1d7bf6['WngpD'](_0x437a55[_0x36a82b(0x222)],0x0))var _0x819b7a='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0x437a55[_0x36a82b(0x222)]+_0x36a82b(0x2a3);else var _0x819b7a=_0x1d7bf6[_0x36a82b(0x2dd)];_0x1b3b93['flash'](_0x1d7bf6[_0x36a82b(0x22b)],{'class':_0x1d7bf6['cLcUS'],'text':'ลบยูสเซอร์\x20\x22'+_0x65d5d8+_0x36a82b(0x25a)+_0x819b7a});}else{const _0x4d450e=_0x4195c0['apply'](_0x318146,arguments);return _0x439958=null,_0x4d450e;}}else _0x1b3b93[_0x36a82b(0x1ca)](_0x1d7bf6[_0x36a82b(0x22b)],{'class':_0x1d7bf6[_0x36a82b(0x2a7)],'text':_0x36a82b(0x2e1)+_0x65d5d8+_0x36a82b(0x30f)});return _0x182aa3[_0x36a82b(0x3a4)](_0x21acf0);}}catch(_0x584e18){if(_0x1d7bf6[_0x36a82b(0x26c)](_0x1d7bf6['oOiQk'],_0x1d7bf6[_0x36a82b(0x24a)]))_0x149b62=_0xbf2400;else return console[_0x36a82b(0x253)](_0x1d7bf6[_0x36a82b(0x3ae)],_0x584e18),_0x1b3b93[_0x36a82b(0x1ca)](_0x1d7bf6[_0x36a82b(0x22b)],{'class':_0x1d7bf6['wItFg'],'text':_0x584e18[_0x36a82b(0x324)]}),_0x182aa3['redirect'](_0x21acf0);}finally{_0x1d7bf6[_0x36a82b(0x235)](_0x1d7bf6['vqErx'],_0x1d7bf6[_0x36a82b(0x1d2)])?_0x59b8b7[_0x36a82b(0x345)]():(_0x3136f6['log'](_0x1d7bf6[_0x36a82b(0x3ae)],_0x3b74e6),_0x55167e[_0x36a82b(0x377)](0x194)[_0x36a82b(0x22f)](_0x22e256));}}),x[_0x38e7d8(0x34d)](V,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x17bdeb,_0x21dadf)=>{const _0x22fef5=_0x38e7d8,_0x137c41={'WVtfU':_0x22fef5(0x2d8),'vRQpN':_0x22fef5(0x267),'LiLPD':_0x22fef5(0x38d),'lZxfN':_0x22fef5(0x30c),'EBZke':function(_0x358559,_0xfa6c38){return _0x358559(_0xfa6c38);},'KpteJ':_0x22fef5(0x2ea),'ooXdo':function(_0x1bc287,_0x491cd8){return _0x1bc287+_0x491cd8;},'xGAii':'chain','YCxfI':_0x22fef5(0x3a0),'piKNv':function(_0x503e75,_0x2a8d60){return _0x503e75(_0x2a8d60);},'qWPmG':function(_0x4c310f){return _0x4c310f();},'NgRnl':function(_0x35b8e1,_0x211d47){return _0x35b8e1!==_0x211d47;},'YxkEv':_0x22fef5(0x1f7),'nuPFy':'DnypS','byqRO':'branchId','yrTGG':_0x22fef5(0x1d8),'DMtNZ':_0x22fef5(0x242),'oYzwW':function(_0x14f87d,_0x8688b8){return _0x14f87d==_0x8688b8;},'QYjhS':_0x22fef5(0x3e0),'aaqKo':'print_users.ejs','ybbSS':'utf8','znuvl':'green','chLLG':function(_0x5329a4,_0x2f4b75){return _0x5329a4===_0x2f4b75;},'cUjch':_0x22fef5(0x3a2),'IGKAJ':_0x22fef5(0x384),'atexg':_0x22fef5(0x3b4),'TDEPB':'KRTfd'},{_idArr:_0xb9c0b5}=_0x17bdeb[_0x22fef5(0x3ce)],_0x154146=new _0x418e1d(dbUrl);try{if(_0x137c41[_0x22fef5(0x3b0)](_0x137c41[_0x22fef5(0x28b)],_0x137c41['nuPFy'])){await _0x154146[_0x22fef5(0x2f0)]();const _0x172c4d=await _0x154146['db'](dbName)[_0x22fef5(0x1f1)](dbColl_users)[_0x22fef5(0x2e5)]([{'$match':{'_id':{'$in':_0xb9c0b5['map'](_0x55dfa2=>new _0x8352e7(_0x55dfa2))}}},{'$lookup':{'from':global['dbColl_userBranches'],'localField':_0x137c41[_0x22fef5(0x35a)],'foreignField':_0x137c41[_0x22fef5(0x35a)],'as':_0x137c41[_0x22fef5(0x249)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x137c41[_0x22fef5(0x378)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x22fef5(0x1d9)]();if(_0x137c41[_0x22fef5(0x1d6)](_0x172c4d[_0x22fef5(0x3ca)],0x0))return _0x21dadf[_0x22fef5(0x3ba)](JSON[_0x22fef5(0x219)]({'isPrint':!0x1,'class':_0x137c41[_0x22fef5(0x2f9)],'msg':_0x137c41[_0x22fef5(0x1c6)]}));const _0x4f2694=_0x8495c[_0x22fef5(0x316)](global[_0x22fef5(0x364)],_0x137c41[_0x22fef5(0x34b)]),_0x28c04b=_0xebc1f2[_0x22fef5(0x1fe)](_0x4f2694,_0x137c41['ybbSS']),_0x844a0d=_0x23e73c[_0x22fef5(0x3d0)](_0x28c04b,{'time':O['getDate'](),'title':_0x22fef5(0x322)+_0x172c4d['length']+')','dateTime':O['getDateTime'](),'usersFind':_0x172c4d});_0x21dadf[_0x22fef5(0x3ba)](JSON[_0x22fef5(0x219)]({'isPrint':!0x0,'class':_0x137c41['znuvl'],'msg':_0x22fef5(0x21e)+_0x172c4d[_0x22fef5(0x3ca)]+_0x22fef5(0x302),'htmlPage':_0x844a0d}));}else{_0x15e4de['session']['destroy'](_0x35bc16=>(_0x35bc16&&_0x4e5b1b[_0x22fef5(0x253)](_0x22fef5(0x321),_0x35bc16),_0x563909['redirect']('/')));return;}}catch(_0x273d91){if(_0x137c41[_0x22fef5(0x3bf)](_0x137c41['cUjch'],_0x137c41[_0x22fef5(0x250)]))return _0x2bfcf1['log'](_0x137c41[_0x22fef5(0x3a8)],_0xfe13cf),_0xade736[_0x22fef5(0x3ba)]({'isDownload':!0x1,'color':_0x137c41['vRQpN'],'msg':_0x45b6e6[_0x22fef5(0x324)]});else console['log'](_0x137c41[_0x22fef5(0x3a8)],_0x273d91[_0x22fef5(0x324)]),_0x21dadf[_0x22fef5(0x3ba)](JSON[_0x22fef5(0x219)]({'isPrint':!0x1,'class':_0x137c41[_0x22fef5(0x2f9)],'msg':_0x273d91[_0x22fef5(0x324)]}));}finally{if(_0x137c41[_0x22fef5(0x3b0)](_0x137c41['atexg'],_0x137c41['TDEPB']))_0x154146[_0x22fef5(0x345)]();else{const _0x165b9b=new _0x23b5ba(MbWHUa[_0x22fef5(0x20f)]),_0x533f2f=new _0x588dab(MbWHUa[_0x22fef5(0x1ff)],'i'),_0x223571=MbWHUa['EBZke'](_0x4bc188,MbWHUa['KpteJ']);!_0x165b9b[_0x22fef5(0x36a)](MbWHUa['ooXdo'](_0x223571,MbWHUa[_0x22fef5(0x2b4)]))||!_0x533f2f[_0x22fef5(0x36a)](MbWHUa[_0x22fef5(0x1d1)](_0x223571,MbWHUa[_0x22fef5(0x35d)]))?MbWHUa[_0x22fef5(0x2fa)](_0x223571,'0'):MbWHUa[_0x22fef5(0x2b0)](_0x175837);}}}),x[_0x38e7d8(0x34d)](Y,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x2bace7,_0x19d494)=>{const _0x28fea7=_0x38e7d8,_0x483e33={'mvsbn':'error\x20===>\x20','TsGbq':_0x28fea7(0x267),'ozxQO':function(_0x104c7d,_0x3b9c07){return _0x104c7d(_0x3b9c07);},'ychwH':function(_0x31e37a,_0x477aa0){return _0x31e37a===_0x477aa0;},'nsBRz':_0x28fea7(0x336),'pMGLl':_0x28fea7(0x393),'twZYV':function(_0x1057da,_0x2940fd){return _0x1057da<_0x2940fd;},'ooTCD':_0x28fea7(0x382),'QSOXC':_0x28fea7(0x320),'IaOCH':_0x28fea7(0x2cc),'BdshV':_0x28fea7(0x259),'QSpNQ':function(_0x337540,_0xb782c7){return _0x337540!==_0xb782c7;},'ceroD':_0x28fea7(0x3a1),'pjUaB':function(_0x2599ac,_0x258eb1){return _0x2599ac===_0x258eb1;},'TzRHJ':_0x28fea7(0x1db),'qoGco':'DwOdW'};let {userId:_0x130a79}=_0x2bace7[_0x28fea7(0x3ce)];_0x130a79=_0x483e33[_0x28fea7(0x1e3)](Number,_0x130a79);const _0x8b6b6c=new _0x418e1d(global[_0x28fea7(0x31a)]);try{if(_0x483e33[_0x28fea7(0x3d2)](_0x483e33['nsBRz'],_0x483e33[_0x28fea7(0x1e5)]))_0x1604bc['close']();else{await _0x8b6b6c[_0x28fea7(0x2f0)]();var _0x43e245=await _0x8b6b6c['db'](global[_0x28fea7(0x1d0)])[_0x28fea7(0x1f1)](global[_0x28fea7(0x2c8)])[_0x28fea7(0x351)]({'userId':_0x130a79});if(!_0x43e245)return _0x19d494[_0x28fea7(0x3ba)](JSON[_0x28fea7(0x219)]({'isPrint':!0x1,'class':_0x483e33[_0x28fea7(0x2c7)],'msg':_0x28fea7(0x2e1)+_0x130a79+'\x22'}));const _0x56c350=_0x43e245['changesHistory']||[];if(_0x483e33[_0x28fea7(0x2a5)](_0x56c350[_0x28fea7(0x3ca)],0x1))return _0x19d494['send'](JSON[_0x28fea7(0x219)]({'isPrint':!0x1,'class':_0x483e33[_0x28fea7(0x2ef)],'msg':_0x483e33[_0x28fea7(0x227)]}));const _0x25fabe=_0x8495c[_0x28fea7(0x316)](folderForms,_0x483e33['IaOCH']),_0x3c995c=await H[_0x28fea7(0x1e2)](_0x25fabe,_0x19d494,{'title':_0x28fea7(0x2a4)+_0x43e245[_0x28fea7(0x2f6)]+']\x20'+_0x43e245[_0x28fea7(0x2bb)]+'\x20'+_0x43e245['userFirstname']+'\x20'+_0x43e245['userLastname'],'time':O['getDateTime'](),'changesHistory':_0x56c350});_0x19d494[_0x28fea7(0x3ba)](JSON[_0x28fea7(0x219)]({'isPrint':!0x0,'class':_0x483e33[_0x28fea7(0x291)],'htmlPage':_0x3c995c}));}}catch(_0x37db55){_0x483e33['QSpNQ'](_0x483e33['ceroD'],_0x483e33['ceroD'])?(_0x5aad07[_0x28fea7(0x253)](_0x483e33[_0x28fea7(0x2b2)],_0x25da58),_0x4065c6['send'](_0x1a94e6[_0x28fea7(0x219)]({'isPrint':!0x1,'class':_0x483e33[_0x28fea7(0x2c7)],'msg':_0x1e1229[_0x28fea7(0x324)]}))):(console['log'](_0x483e33['mvsbn'],_0x37db55),_0x19d494[_0x28fea7(0x3ba)](JSON[_0x28fea7(0x219)]({'isPrint':!0x1,'class':_0x483e33[_0x28fea7(0x2c7)],'msg':_0x37db55[_0x28fea7(0x324)]})));}finally{if(_0x483e33[_0x28fea7(0x340)](_0x483e33[_0x28fea7(0x335)],_0x483e33[_0x28fea7(0x1bc)]))return _0x404593[_0x28fea7(0x3ba)]({'isDownload':!0x1,'color':_0x483e33[_0x28fea7(0x2c7)],'msg':_0x51d0b6[_0x28fea7(0x324)]});else _0x8b6b6c[_0x28fea7(0x345)]();}}),x[_0x38e7d8(0x34d)](K,_0x1ca211[_0x38e7d8(0x1aa)],async(_0x2dcbdb,_0x7c33fb)=>{const _0x12164e=_0x38e7d8,_0x5990ff={'mCpdP':_0x12164e(0x267),'LQdRr':function(_0x5bfb8c,_0x5aaf51){return _0x5bfb8c===_0x5aaf51;},'NpiLt':_0x12164e(0x25e),'QvHmF':_0x12164e(0x3a7),'zroUC':function(_0x3f20a6,_0xb08a12){return _0x3f20a6==_0xb08a12;},'GfbPU':_0x12164e(0x3e0),'OjCVw':_0x12164e(0x273),'Dtysj':_0x12164e(0x1fd),'FXnuG':'xlsx','fxbqC':_0x12164e(0x259),'VATmD':'ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','UZyxB':_0x12164e(0x1ea)},_0x45546a=new _0x418e1d(dbUrl);try{if(_0x5990ff[_0x12164e(0x390)](_0x5990ff['NpiLt'],_0x5990ff[_0x12164e(0x2eb)])){await _0x45546a[_0x12164e(0x2f0)]();const _0x4d6f5f=await _0x45546a['db'](dbName)[_0x12164e(0x1f1)](dbColl_users)[_0x12164e(0x2e5)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x5990ff[_0x12164e(0x1b8)],[]]}}}},{'$sort':{'userId':0x1}}])[_0x12164e(0x1d9)]();if(_0x5990ff[_0x12164e(0x1fa)](_0x4d6f5f['length'],0x0))return _0x7c33fb[_0x12164e(0x3ba)](JSON[_0x12164e(0x219)]({'isDownload':!0x1,'class':_0x5990ff[_0x12164e(0x3da)],'msg':_0x5990ff[_0x12164e(0x215)]}));const _0x5c078f='users_'+O['getDateTime']()['replace'](/[: ]/g,'-')+_0x12164e(0x1f8),_0x376a3e=_0xbd7032[_0x12164e(0x228)]['json_to_sheet'](_0x4d6f5f),_0x2983a9=_0xbd7032[_0x12164e(0x228)][_0x12164e(0x339)]();_0xbd7032['utils'][_0x12164e(0x210)](_0x2983a9,_0x376a3e,_0x5990ff[_0x12164e(0x39d)]);const _0x1be378=_0xbd7032[_0x12164e(0x3d4)](_0x2983a9,{'type':_0x5990ff['Dtysj'],'bookType':_0x5990ff[_0x12164e(0x1a9)]});_0x7c33fb[_0x12164e(0x3ba)]({'isDownload':!0x0,'color':_0x5990ff[_0x12164e(0x2de)],'msg':_0x5990ff[_0x12164e(0x205)],'filename':_0x5c078f,'fileData':_0x1be378['toString'](_0x5990ff[_0x12164e(0x3ad)])});}else{const _0x3393a3=_0x40df37[_0x12164e(0x26e)](new _0x34224d(_0x2032a6[_0x12164e(0x297)](_0x99bcb0=>_0x3a38f7[_0x12164e(0x219)](_0x99bcb0))))[_0x12164e(0x297)](_0x13c782=>_0x127eba[_0x12164e(0x3c9)](_0x13c782));return _0x415ebf['send']({'isUpload':!0x1,'color':_0x5990ff[_0x12164e(0x3da)],'msg':'มีข้อมูลผิดพลาดที่แถว\x20'+_0x3393a3[_0x12164e(0x297)](_0x491dd5=>_0x491dd5[_0x12164e(0x279)])[_0x12164e(0x316)](',\x20'),'errorRows':_0x3393a3});}}catch(_0x3e2619){return _0x7c33fb[_0x12164e(0x3ba)]({'isDownload':!0x1,'color':_0x5990ff[_0x12164e(0x3da)],'msg':_0x3e2619['message']});}finally{_0x45546a[_0x12164e(0x345)]();}});const ae=_0x58ec85({'storage':_0x58ec85[_0x38e7d8(0x3c6)]()});x[_0x38e7d8(0x34d)](Z,_0x1ca211[_0x38e7d8(0x1aa)],ae[_0x38e7d8(0x1b9)](_0x38e7d8(0x34c)),async(_0x2a86f7,_0x2febc8)=>{const _0x16cc37=_0x38e7d8,_0xc40700={'sDULk':function(_0x20d6ab,_0x48c648){return _0x20d6ab(_0x48c648);},'vqTVR':'red','uvnUr':_0x16cc37(0x323),'pAyPN':_0x16cc37(0x1fd),'XMUcB':_0x16cc37(0x273),'EFXBz':function(_0x46ee77,_0x4c6f99){return _0x46ee77>_0x4c6f99;},'BOjxo':'userId','nJCgh':_0x16cc37(0x1e8),'AkdEF':_0x16cc37(0x319),'NTlfT':'userIsActive','IlvTS':_0x16cc37(0x25f),'pHkaZ':_0x16cc37(0x292),'EzLvH':_0x16cc37(0x3d6),'KtBBZ':_0x16cc37(0x2bb),'AbwUB':_0x16cc37(0x33b),'sydVm':_0x16cc37(0x1f4),'mjNZj':_0x16cc37(0x3e2),'FYEzR':function(_0x162979,_0x32629e){return _0x162979>_0x32629e;},'gzqYT':function(_0x1614d6,_0x34d63e){return _0x1614d6>_0x34d63e;},'bhXEw':function(_0x362769,_0x446b15){return _0x362769>_0x446b15;},'dUkGh':_0x16cc37(0x301),'kToGg':function(_0x18d890,_0x3a2710){return _0x18d890+_0x3a2710;},'UXLNV':function(_0x34083a,_0x333460){return _0x34083a===_0x333460;},'fPNeo':function(_0x35d183,_0x5b1b1e){return _0x35d183===_0x5b1b1e;},'bwWxz':function(_0x432bdb,_0x5878ff){return _0x432bdb===_0x5878ff;},'vGiyX':function(_0x57b71d,_0x1ff745){return _0x57b71d===_0x1ff745;},'GRCNc':function(_0xf4604c,_0x38a4e3){return _0xf4604c===_0x38a4e3;},'BXsuo':_0x16cc37(0x255),'phYRU':_0x16cc37(0x259),'GHTQU':_0x16cc37(0x2d8)},_0x3b0da6=new _0x418e1d(dbUrl);try{if(!_0x2a86f7['file'])return _0x2febc8['send']({'isUpload':!0x1,'color':_0xc40700['vqTVR'],'msg':_0xc40700['uvnUr']});const _0x3b70f7=_0xbd7032[_0x16cc37(0x2ce)](_0x2a86f7['file'][_0x16cc37(0x1fd)],{'type':_0xc40700[_0x16cc37(0x350)]}),_0x20426c=[_0xc40700['XMUcB']],_0x962ffa=_0x3b70f7['SheetNames'],_0x3d5e4a=_0x20426c['filter'](_0x172d57=>!_0x962ffa['includes'](_0x172d57));if(_0xc40700[_0x16cc37(0x304)](_0x3d5e4a[_0x16cc37(0x3ca)],0x0))return _0x2febc8['send']({'isUpload':!0x1,'color':_0xc40700[_0x16cc37(0x2bd)],'msg':'ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22'+_0x3d5e4a['join'](',\x20')+'\x22'});const _0xaece9c=_0x3b70f7['Sheets']['users'],_0x1f9052=_0xbd7032[_0x16cc37(0x228)]['sheet_to_json'](_0xaece9c),_0x2d6c72=[_0xc40700['BOjxo'],_0xc40700[_0x16cc37(0x37b)],_0xc40700['AkdEF'],_0xc40700[_0x16cc37(0x1bd)],_0xc40700['IlvTS'],_0xc40700[_0x16cc37(0x271)],_0xc40700[_0x16cc37(0x380)],_0xc40700['KtBBZ'],_0xc40700[_0x16cc37(0x2fe)],_0xc40700[_0x16cc37(0x2e8)],_0xc40700['mjNZj']][_0x16cc37(0x35c)](_0x6b3553=>!_0x1f9052[_0x16cc37(0x29c)](_0x1696f8=>Object[_0x16cc37(0x36d)][_0x16cc37(0x1f2)]['call'](_0x1696f8,_0x6b3553)));if(_0xc40700[_0x16cc37(0x348)](_0x2d6c72[_0x16cc37(0x3ca)],0x0))return _0x2febc8[_0x16cc37(0x3ba)]({'isUpload':!0x1,'color':_0xc40700[_0x16cc37(0x2bd)],'msg':_0x16cc37(0x20a)+_0x2d6c72[_0x16cc37(0x316)](',\x20')+'\x22'});const _0x493f1e=new Set(),_0x23ec3e=new Set();if(_0x1f9052[_0x16cc37(0x29e)](_0x269a2e=>{const _0x35add1=_0x16cc37;_0x493f1e[_0x35add1(0x2a1)](_0x269a2e[_0x35add1(0x2f6)])?_0x23ec3e[_0x35add1(0x3bc)](_0x269a2e[_0x35add1(0x2f6)]):_0x493f1e[_0x35add1(0x3bc)](_0x269a2e[_0x35add1(0x2f6)]);}),_0xc40700['FYEzR'](_0x23ec3e['size'],0x0))return _0x2febc8[_0x16cc37(0x3ba)]({'isUpload':!0x1,'color':_0xc40700['vqTVR'],'msg':_0x16cc37(0x374)+Array['from'](_0x23ec3e)[_0x16cc37(0x316)](',\x20')+'\x22'});const _0x117ab6=new Set(),_0x1a45b1=new Set();if(_0x1f9052['forEach'](_0x20be7f=>{const _0x39f268=_0x16cc37;_0x117ab6['has'](_0x20be7f[_0x39f268(0x1e8)])?_0x1a45b1[_0x39f268(0x3bc)](_0x20be7f[_0x39f268(0x1e8)]):_0x117ab6[_0x39f268(0x3bc)](_0x20be7f[_0x39f268(0x1e8)]);}),_0xc40700[_0x16cc37(0x276)](_0x1a45b1[_0x16cc37(0x1e4)],0x0))return _0x2febc8['send']({'isUpload':!0x1,'color':_0xc40700[_0x16cc37(0x2bd)],'msg':_0x16cc37(0x281)+Array[_0x16cc37(0x26e)](_0x1a45b1)[_0x16cc37(0x316)](',\x20')+'\x22'});const _0x1ec3da=new Set(),_0x3dbea3=new Set();if(_0x1f9052['forEach'](_0x5057ca=>{const _0x42edc1=_0x16cc37;_0x1ec3da[_0x42edc1(0x2a1)](_0x5057ca[_0x42edc1(0x292)])?_0x3dbea3[_0x42edc1(0x3bc)](_0x5057ca[_0x42edc1(0x292)]):_0x1ec3da['add'](_0x5057ca[_0x42edc1(0x292)]);}),_0xc40700[_0x16cc37(0x386)](_0x3dbea3['size'],0x0))return _0x2febc8['send']({'isUpload':!0x1,'color':_0xc40700['vqTVR'],'msg':_0x16cc37(0x2f4)+Array[_0x16cc37(0x26e)](_0x3dbea3)[_0x16cc37(0x316)](',\x20')+'\x22'});const _0xdea35=[],_0x4828a1=/^\d{3,4}$/,_0x2518da=new RegExp(global[_0x16cc37(0x32f)]),_0xeebf65=/^\d{3}$/,_0x45a630=[_0xc40700[_0x16cc37(0x3d8)],''];for(const [_0x2263a3,_0x59c8df]of _0x1f9052[_0x16cc37(0x367)]()){const _0x4b0473=_0xc40700['kToGg'](_0x2263a3,0x2),_0x288e43={'userId':_0x59c8df[_0x16cc37(0x2f6)],'row':_0x4b0473};if(!_0x59c8df[_0x16cc37(0x2f6)]||_0xc40700[_0x16cc37(0x220)](_0x4828a1[_0x16cc37(0x36a)](_0x59c8df['userId'][_0x16cc37(0x1ee)]()),!0x1)){_0xdea35['push'](_0x288e43);continue;}if(!_0x59c8df[_0x16cc37(0x1e8)]||_0xc40700[_0x16cc37(0x206)](_0x2518da['test'](_0x59c8df[_0x16cc37(0x1e8)]),!0x1)){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df[_0x16cc37(0x319)]||_0xc40700[_0x16cc37(0x398)](_0xeebf65[_0x16cc37(0x36a)](_0x59c8df['branchId']['toString']()),!0x1)){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df[_0x16cc37(0x32a)]||_0xc40700['UXLNV'](_0x45a630[_0x16cc37(0x256)](_0x59c8df[_0x16cc37(0x32a)]),!0x1)){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df[_0x16cc37(0x25f)]||_0xc40700['vGiyX'](global['USER_AUTHORITIES'][_0x16cc37(0x256)](_0x59c8df[_0x16cc37(0x25f)]),!0x1)){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df[_0x16cc37(0x292)]||_0xc40700[_0x16cc37(0x3c3)](_0x4f86d9[_0x16cc37(0x30e)](_0x59c8df[_0x16cc37(0x292)]),!0x1)){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df['userFirstname']||_0xc40700[_0x16cc37(0x329)](_0x59c8df['userFirstname'][_0x16cc37(0x1c3)](),'')){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}if(!_0x59c8df['dateTimeCanDelete']||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/['test'](_0x59c8df[_0x16cc37(0x3e2)])){_0xdea35[_0x16cc37(0x3cb)](_0x288e43);continue;}}if(_0xc40700[_0x16cc37(0x276)](_0xdea35[_0x16cc37(0x3ca)],0x0)){const _0x3a2a70=Array[_0x16cc37(0x26e)](new Set(_0xdea35['map'](_0x3f33b2=>JSON['stringify'](_0x3f33b2))))[_0x16cc37(0x297)](_0x4b9431=>JSON[_0x16cc37(0x3c9)](_0x4b9431));return _0x2febc8[_0x16cc37(0x3ba)]({'isUpload':!0x1,'color':_0xc40700[_0x16cc37(0x2bd)],'msg':_0x16cc37(0x3af)+_0x3a2a70[_0x16cc37(0x297)](_0x341f48=>_0x341f48['row'])[_0x16cc37(0x316)](',\x20'),'errorRows':_0x3a2a70});}_0x1f9052[_0x16cc37(0x29e)](_0x41e383=>{const _0x3c9f11=_0x16cc37;_0x41e383[_0x3c9f11(0x2f6)]=_0xc40700['sDULk'](Number,_0x41e383[_0x3c9f11(0x2f6)]),_0x41e383['branchId']=_0xc40700[_0x3c9f11(0x1da)](Number,_0x41e383[_0x3c9f11(0x319)]),_0x41e383[_0x3c9f11(0x32a)]||(_0x41e383[_0x3c9f11(0x32a)]=''),_0x41e383[_0x3c9f11(0x3d6)]||(_0x41e383[_0x3c9f11(0x3d6)]=''),_0x41e383[_0x3c9f11(0x2bb)]||(_0x41e383[_0x3c9f11(0x2bb)]=''),_0x41e383[_0x3c9f11(0x1f4)]||(_0x41e383['userLastname']=''),delete _0x41e383[_0x3c9f11(0x1cb)],delete _0x41e383[_0x3c9f11(0x2b6)],delete _0x41e383[_0x3c9f11(0x1c9)],delete _0x41e383[_0x3c9f11(0x1cb)];}),await _0x3b0da6['connect']();const _0x431485=_0x3b0da6['db'](dbName)[_0x16cc37(0x1f1)](dbColl_users),_0x5418e4=[];for(const _0x2db9ee of _0x1f9052){const _0x5de76c=await _0x431485[_0x16cc37(0x33e)]({'userId':_0x2db9ee[_0x16cc37(0x2f6)]},{'$set':_0x2db9ee},{'upsert':!0x0});_0x5418e4[_0x16cc37(0x3cb)]({'userId':_0x2db9ee['userId'],'matchedCount':_0x5de76c[_0x16cc37(0x2fd)],'upsertedCount':_0x5de76c[_0x16cc37(0x1fc)]});}const _0x5cc6e3=_0xc40700[_0x16cc37(0x304)](_0x5418e4[_0x16cc37(0x3ca)],0x0)?_0xc40700['kToGg'](_0x16cc37(0x358)+_0x5418e4[_0x16cc37(0x35c)](_0x8357cf=>_0x8357cf[_0x16cc37(0x2fd)]>0x0)[_0x16cc37(0x3ca)]+'\x20รายการ',('{{sep}}เพิ่มใหม่\x20'+_0x5418e4[_0x16cc37(0x35c)](_0x30d9a0=>_0x30d9a0['upsertedCount']>0x0)[_0x16cc37(0x3ca)]+'\x20รายการ')[_0x16cc37(0x1c3)]()):_0xc40700[_0x16cc37(0x27c)];return _0x2febc8[_0x16cc37(0x3ba)]({'isUpload':!0x0,'color':_0xc40700[_0x16cc37(0x2af)],'msg':_0x5cc6e3});}catch(_0x5e9261){return console['log'](_0xc40700[_0x16cc37(0x3e3)],_0x5e9261),_0x2febc8['send']({'isDownload':!0x1,'color':_0xc40700[_0x16cc37(0x2bd)],'msg':_0x5e9261[_0x16cc37(0x324)]});}finally{_0x3b0da6[_0x16cc37(0x345)]();}});export default x;function _0x3b5419(_0x9b368b){const _0x4920e4=_0x38e7d8,_0x10ea60={'vLvBo':function(_0xe20eb0,_0x5e3ca6){return _0xe20eb0===_0x5e3ca6;},'rhmxe':_0x4920e4(0x1b4),'xqAOh':_0x4920e4(0x33a),'NFSsF':'counter','XsZXj':function(_0x5c0cc9,_0x341e98){return _0x5c0cc9!==_0x341e98;},'AkQBw':function(_0xc4e9b6,_0x575430){return _0xc4e9b6+_0x575430;},'jgtmq':function(_0x5d5bce,_0x45b212){return _0x5d5bce/_0x45b212;},'DvRZn':_0x4920e4(0x3ca),'MiDRj':function(_0x56d7ed,_0x7a732f){return _0x56d7ed%_0x7a732f;},'dWTVi':_0x4920e4(0x263),'miSyA':_0x4920e4(0x3bb),'PdnqZ':_0x4920e4(0x257),'CTIvW':'stateObject','zoePh':function(_0x305c78,_0x46a5b3){return _0x305c78(_0x46a5b3);}};function _0x58a1a7(_0x2d005f){const _0x20c64f=_0x4920e4;if(_0x10ea60[_0x20c64f(0x2bc)](typeof _0x2d005f,_0x10ea60[_0x20c64f(0x39b)]))return function(_0x205ebd){}[_0x20c64f(0x29b)](_0x10ea60[_0x20c64f(0x23a)])[_0x20c64f(0x234)](_0x10ea60[_0x20c64f(0x37e)]);else _0x10ea60[_0x20c64f(0x37f)](_0x10ea60[_0x20c64f(0x27e)]('',_0x10ea60['jgtmq'](_0x2d005f,_0x2d005f))[_0x10ea60[_0x20c64f(0x2d4)]],0x1)||_0x10ea60[_0x20c64f(0x2bc)](_0x10ea60['MiDRj'](_0x2d005f,0x14),0x0)?function(){return!![];}[_0x20c64f(0x29b)](_0x10ea60[_0x20c64f(0x27e)](_0x10ea60[_0x20c64f(0x2ee)],_0x10ea60[_0x20c64f(0x244)]))[_0x20c64f(0x2cd)](_0x10ea60[_0x20c64f(0x369)]):function(){return![];}[_0x20c64f(0x29b)](_0x10ea60[_0x20c64f(0x27e)](_0x10ea60['dWTVi'],_0x10ea60[_0x20c64f(0x244)]))[_0x20c64f(0x234)](_0x10ea60[_0x20c64f(0x3e4)]);_0x10ea60[_0x20c64f(0x2ec)](_0x58a1a7,++_0x2d005f);}try{if(_0x9b368b)return _0x58a1a7;else _0x10ea60[_0x4920e4(0x2ec)](_0x58a1a7,0x0);}catch(_0x131e38){}}