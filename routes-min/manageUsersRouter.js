const _0x1ae8b1=_0x5225;(function(_0xd1f316,_0x3ea8a8){const _0x42956a=_0x5225,_0x1e3e03=_0xd1f316();while(!![]){try{const _0x12a2cd=parseInt(_0x42956a(0x2a1))/0x1*(-parseInt(_0x42956a(0x343))/0x2)+parseInt(_0x42956a(0x18e))/0x3+-parseInt(_0x42956a(0x175))/0x4+-parseInt(_0x42956a(0x1b2))/0x5+parseInt(_0x42956a(0x287))/0x6+parseInt(_0x42956a(0x21b))/0x7*(-parseInt(_0x42956a(0x25d))/0x8)+parseInt(_0x42956a(0x1a5))/0x9*(parseInt(_0x42956a(0x2a0))/0xa);if(_0x12a2cd===_0x3ea8a8)break;else _0x1e3e03['push'](_0x1e3e03['shift']());}catch(_0x18ca2d){_0x1e3e03['push'](_0x1e3e03['shift']());}}}(_0x4dad,0x4274b));const _0x3c4547=(function(){const _0x204097=_0x5225,_0x49b7c8={'JPIgQ':'error\x20===>\x20','QiMhm':_0x204097(0x229),'JPLuh':function(_0x57bd52,_0x2676ea){return _0x57bd52===_0x2676ea;},'vKAMC':_0x204097(0x159),'XuRQF':_0x204097(0x1d7),'dXmBA':'pNLqI','sClDd':function(_0x587ffc,_0x19b10b){return _0x587ffc!==_0x19b10b;},'sSTBU':_0x204097(0x2e0)};let _0x484f41=!![];return function(_0x2d46f2,_0x19dce4){const _0x21df68=_0x204097;if(_0x49b7c8[_0x21df68(0x36a)](_0x49b7c8[_0x21df68(0x20d)],_0x49b7c8[_0x21df68(0x20d)]))_0x5d1558['log'](_0x49b7c8[_0x21df68(0x215)],_0x502978[_0x21df68(0x2ed)]),_0x4a1134[_0x21df68(0x21d)](_0x1210a5[_0x21df68(0x271)]({'isPrint':!0x1,'class':_0x49b7c8['QiMhm'],'msg':_0x2be7ba['message']}));else{const _0xdbe639=_0x484f41?function(){const _0xbf022b=_0x21df68;if(_0x49b7c8[_0xbf022b(0x2fa)](_0x49b7c8[_0xbf022b(0x310)],_0x49b7c8[_0xbf022b(0x310)])){if(_0x19dce4){if(_0x49b7c8[_0xbf022b(0x2fa)](_0x49b7c8['XuRQF'],_0x49b7c8[_0xbf022b(0x284)]))_0x4eeab1[_0xbf022b(0x349)]();else{const _0x9fb1c4=_0x19dce4[_0xbf022b(0x20e)](_0x2d46f2,arguments);return _0x19dce4=null,_0x9fb1c4;}}}else _0x30e16a[_0xbf022b(0x349)]();}:function(){};return _0x484f41=![],_0xdbe639;}};}());(function(){const _0x594a61=_0x5225,_0x44fa89={'khmEq':_0x594a61(0x2a9),'mPkRu':_0x594a61(0x229),'HOHfA':function(_0x728e61){return _0x728e61();},'AHLZh':function(_0x14d974,_0xaccfd4){return _0x14d974!==_0xaccfd4;},'gPkNA':_0x594a61(0x2b2),'CoHDx':_0x594a61(0x17b),'xQeuz':_0x594a61(0x2e3),'OgGba':function(_0x1392cc,_0x890e18){return _0x1392cc(_0x890e18);},'brusY':'init','xFMZk':function(_0x28b373,_0x3eed24){return _0x28b373+_0x3eed24;},'iwkdC':_0x594a61(0x339),'KvYGu':_0x594a61(0x1bb),'OaeAs':function(_0x105d87,_0x9b1e62){return _0x105d87===_0x9b1e62;},'jLnqs':'beAnK','vMHoL':'MOxhW','lhOej':function(_0xf50187,_0x50cb04){return _0xf50187(_0x50cb04);},'qdsqc':function(_0x5ecba1,_0x16bef9){return _0x5ecba1!==_0x16bef9;},'HgljF':'OXFps','Bzwxu':function(_0x209c59){return _0x209c59();},'TWXGM':function(_0x218ac1,_0x54afd1,_0x147190){return _0x218ac1(_0x54afd1,_0x147190);}};_0x44fa89[_0x594a61(0x358)](_0x3c4547,this,function(){const _0x3e4f77=_0x594a61,_0x11ed6d={'tUhCh':function(_0x1f2045){const _0x489fdd=_0x5225;return _0x44fa89[_0x489fdd(0x242)](_0x1f2045);}};if(_0x44fa89[_0x3e4f77(0x398)](_0x44fa89['gPkNA'],_0x44fa89['gPkNA']))_0x285849[_0x3e4f77(0x1f6)](_0x44fa89[_0x3e4f77(0x39a)],_0x300d7c),_0x5612aa[_0x3e4f77(0x21d)](_0x509b37[_0x3e4f77(0x271)]({'isPrint':!0x1,'class':_0x44fa89[_0x3e4f77(0x2d3)],'msg':_0x5e5238['message']}));else{const _0x1825de=new RegExp(_0x44fa89[_0x3e4f77(0x233)]),_0x2ef91e=new RegExp(_0x44fa89[_0x3e4f77(0x367)],'i'),_0x2ecc73=_0x44fa89[_0x3e4f77(0x383)](_0x46d9ca,_0x44fa89['brusY']);if(!_0x1825de[_0x3e4f77(0x369)](_0x44fa89[_0x3e4f77(0x15c)](_0x2ecc73,_0x44fa89[_0x3e4f77(0x36f)]))||!_0x2ef91e[_0x3e4f77(0x369)](_0x44fa89[_0x3e4f77(0x15c)](_0x2ecc73,_0x44fa89[_0x3e4f77(0x387)]))){if(_0x44fa89[_0x3e4f77(0x1de)](_0x44fa89[_0x3e4f77(0x39b)],_0x44fa89['vMHoL'])){const _0x145c43=_0x117976['apply'](_0x68a5de,arguments);return _0x5c5820=null,_0x145c43;}else _0x44fa89['lhOej'](_0x2ecc73,'0');}else _0x44fa89[_0x3e4f77(0x2d5)](_0x44fa89[_0x3e4f77(0x1ae)],_0x44fa89[_0x3e4f77(0x1ae)])?_0x11ed6d['tUhCh'](_0x50d843):_0x44fa89[_0x3e4f77(0x1ea)](_0x46d9ca);}})();}());const _0x2851ed=(function(){const _0x536b96=_0x5225,_0x54bfc3={'hZror':function(_0x185557,_0x5b7c65){return _0x185557(_0x5b7c65);},'TPVty':function(_0x36b525,_0x3048b5){return _0x36b525+_0x3048b5;},'klfHu':_0x536b96(0x2ca),'ZwqbI':_0x536b96(0x172),'wknFx':function(_0x21f780){return _0x21f780();},'EiMFz':'log','TInzS':'warn','gxxxk':_0x536b96(0x1fd),'eZBlH':_0x536b96(0x25f),'slOVw':'exception','bTuZL':_0x536b96(0x320),'hCoSH':_0x536b96(0x16b),'lHuiu':function(_0x17f074,_0x292161){return _0x17f074<_0x292161;},'WdMoo':function(_0x5a7251,_0x5d0afb){return _0x5a7251===_0x5d0afb;},'rGfvA':_0x536b96(0x241),'ItgPV':'OeYCe','QdwXe':function(_0x5c9556,_0x1d76c0){return _0x5c9556!==_0x1d76c0;},'hnDNZ':_0x536b96(0x1e2),'uIawM':_0x536b96(0x33c),'rKTvt':_0x536b96(0x22c),'NLqsH':'red','xLqlQ':function(_0xd34d3d,_0x399997){return _0xd34d3d!==_0x399997;},'LbHWi':_0x536b96(0x1db),'XPwQu':_0x536b96(0x1d2)};let _0x24a337=!![];return function(_0x131cdc,_0x17cdbd){const _0x4f0943=_0x536b96;if(_0x54bfc3[_0x4f0943(0x27a)](_0x54bfc3['LbHWi'],_0x54bfc3[_0x4f0943(0x2a2)])){const _0x47b4bc=_0x24a337?function(){const _0xc82fb7=_0x4f0943,_0x48d21d={'dJSzj':function(_0x5aed2a,_0xa4c250){return _0x54bfc3['hZror'](_0x5aed2a,_0xa4c250);},'KAfgE':function(_0x164ce9,_0x533d0b){return _0x54bfc3['TPVty'](_0x164ce9,_0x533d0b);},'iAfrt':_0x54bfc3[_0xc82fb7(0x386)],'uDGGc':_0x54bfc3[_0xc82fb7(0x17e)],'IhmrX':function(_0xf06337){const _0x398d3e=_0xc82fb7;return _0x54bfc3[_0x398d3e(0x16d)](_0xf06337);},'jknDT':_0x54bfc3['EiMFz'],'aTGoE':_0x54bfc3[_0xc82fb7(0x28b)],'OyLlQ':_0x54bfc3[_0xc82fb7(0x371)],'dOmqc':_0x54bfc3[_0xc82fb7(0x24d)],'hCFHu':_0x54bfc3[_0xc82fb7(0x38f)],'zQRIl':_0x54bfc3['bTuZL'],'anQEm':_0x54bfc3[_0xc82fb7(0x17f)],'oAeSC':function(_0x3716f6,_0x11e0e1){const _0x4340e0=_0xc82fb7;return _0x54bfc3[_0x4340e0(0x340)](_0x3716f6,_0x11e0e1);}};if(_0x54bfc3[_0xc82fb7(0x337)](_0x54bfc3[_0xc82fb7(0x1e5)],_0x54bfc3[_0xc82fb7(0x322)]))_0x1ff105[_0xc82fb7(0x2bb)](_0x22f844['userEmail'])?_0x2995c1[_0xc82fb7(0x2a6)](_0x5a267e[_0xc82fb7(0x248)]):_0x1c5b44['add'](_0x1aa3f9['userEmail']);else{if(_0x17cdbd){if(_0x54bfc3[_0xc82fb7(0x2fd)](_0x54bfc3[_0xc82fb7(0x316)],_0x54bfc3[_0xc82fb7(0x1d0)])){const _0x129f27=_0x17cdbd[_0xc82fb7(0x20e)](_0x131cdc,arguments);return _0x17cdbd=null,_0x129f27;}else{let _0xfd8e19;try{const _0x95520b=_0x48d21d[_0xc82fb7(0x268)](_0x4a2124,_0x48d21d[_0xc82fb7(0x2ec)](_0x48d21d[_0xc82fb7(0x2ec)](_0x48d21d['iAfrt'],_0x48d21d['uDGGc']),');'));_0xfd8e19=_0x48d21d[_0xc82fb7(0x31a)](_0x95520b);}catch(_0x2885f9){_0xfd8e19=_0x25a67a;}const _0x5802a7=_0xfd8e19[_0xc82fb7(0x1b3)]=_0xfd8e19['console']||{},_0x3dc274=[_0x48d21d[_0xc82fb7(0x231)],_0x48d21d[_0xc82fb7(0x1c3)],_0x48d21d[_0xc82fb7(0x2e2)],_0x48d21d[_0xc82fb7(0x161)],_0x48d21d[_0xc82fb7(0x357)],_0x48d21d[_0xc82fb7(0x2aa)],_0x48d21d[_0xc82fb7(0x1d9)]];for(let _0x241e48=0x0;_0x48d21d[_0xc82fb7(0x30f)](_0x241e48,_0x3dc274[_0xc82fb7(0x189)]);_0x241e48++){const _0x2326e9=_0x36baa2[_0xc82fb7(0x2de)][_0xc82fb7(0x355)][_0xc82fb7(0x315)](_0x41aa56),_0x277f47=_0x3dc274[_0x241e48],_0x479740=_0x5802a7[_0x277f47]||_0x2326e9;_0x2326e9['__proto__']=_0x5e900['bind'](_0x40e351),_0x2326e9['toString']=_0x479740[_0xc82fb7(0x356)][_0xc82fb7(0x315)](_0x479740),_0x5802a7[_0x277f47]=_0x2326e9;}}}}}:function(){};return _0x24a337=![],_0x47b4bc;}else return _0x4bc3a2[_0x4f0943(0x1f6)](_0x4010f3[_0x4f0943(0x2ed)]),_0x3fa541[_0x4f0943(0x292)](_0x54bfc3[_0x4f0943(0x2e6)],{'class':_0x54bfc3['NLqsH'],'text':''+_0x3122ed[_0x4f0943(0x2ed)]}),_0x28d45a[_0x4f0943(0x182)](_0x5e45db);};}()),_0x3332c0=_0x2851ed(this,function(){const _0x2413a7=_0x5225,_0x2aa0d9={'vuMiz':_0x2413a7(0x17b),'gxvwp':_0x2413a7(0x2e3),'sWJaC':function(_0x314977,_0x2ad868){return _0x314977(_0x2ad868);},'WwKGv':_0x2413a7(0x35e),'QnYCM':function(_0x56fc40,_0x93f862){return _0x56fc40+_0x93f862;},'vKdyJ':_0x2413a7(0x339),'sDqcj':'input','yXTYF':function(_0x10b6c8){return _0x10b6c8();},'CeWTb':function(_0x256408,_0x54d7fd){return _0x256408!==_0x54d7fd;},'klTDX':_0x2413a7(0x31c),'YMYTL':'zOVpP','dpBEN':function(_0x2539dd,_0x530d96){return _0x2539dd(_0x530d96);},'smkDv':function(_0x107710,_0x4b1a1a){return _0x107710+_0x4b1a1a;},'OMuBf':function(_0x4a6906,_0x3e32f4){return _0x4a6906+_0x3e32f4;},'oxckN':_0x2413a7(0x2ca),'bUaxu':_0x2413a7(0x172),'AhOPk':function(_0x35eba5){return _0x35eba5();},'dDtvB':_0x2413a7(0x1aa),'tWqTv':'RUKCk','XgmpN':_0x2413a7(0x1f6),'abpYj':_0x2413a7(0x18c),'hSdCa':_0x2413a7(0x1fd),'MAIrF':'error','gHVwT':_0x2413a7(0x347),'VwLEb':'table','sghLU':_0x2413a7(0x16b),'ddUtA':function(_0x489f80,_0x490115){return _0x489f80<_0x490115;},'BzNGY':function(_0xff290e,_0x1db1c3){return _0xff290e===_0x1db1c3;},'cSQfu':_0x2413a7(0x239)};let _0x413161;try{if(_0x2aa0d9['CeWTb'](_0x2aa0d9[_0x2413a7(0x19d)],_0x2aa0d9[_0x2413a7(0x277)])){const _0x39c6b6=_0x2aa0d9['dpBEN'](Function,_0x2aa0d9['smkDv'](_0x2aa0d9['OMuBf'](_0x2aa0d9[_0x2413a7(0x26c)],_0x2aa0d9[_0x2413a7(0x238)]),');'));_0x413161=_0x2aa0d9[_0x2413a7(0x1b0)](_0x39c6b6);}else{const _0x447e50=new _0x13d866(_0x2aa0d9[_0x2413a7(0x1da)]),_0x5ec990=new _0x57c5dd(_0x2aa0d9['gxvwp'],'i'),_0x29ce49=_0x2aa0d9[_0x2413a7(0x24f)](_0x17ec15,_0x2aa0d9[_0x2413a7(0x178)]);!_0x447e50[_0x2413a7(0x369)](_0x2aa0d9[_0x2413a7(0x1a9)](_0x29ce49,_0x2aa0d9['vKdyJ']))||!_0x5ec990[_0x2413a7(0x369)](_0x2aa0d9[_0x2413a7(0x1a9)](_0x29ce49,_0x2aa0d9['sDqcj']))?_0x2aa0d9['sWJaC'](_0x29ce49,'0'):_0x2aa0d9[_0x2413a7(0x2d6)](_0x464f66);}}catch(_0x534ed3){if(_0x2aa0d9[_0x2413a7(0x332)](_0x2aa0d9['dDtvB'],_0x2aa0d9[_0x2413a7(0x299)]))_0x413161=window;else{if(_0x52fbcc){const _0x4816b2=_0x43837b[_0x2413a7(0x20e)](_0x45fd3f,arguments);return _0x55416a=null,_0x4816b2;}}}const _0xaeeb7a=_0x413161[_0x2413a7(0x1b3)]=_0x413161[_0x2413a7(0x1b3)]||{},_0xf5b98a=[_0x2aa0d9[_0x2413a7(0x1cc)],_0x2aa0d9['abpYj'],_0x2aa0d9[_0x2413a7(0x1a7)],_0x2aa0d9[_0x2413a7(0x39c)],_0x2aa0d9[_0x2413a7(0x314)],_0x2aa0d9[_0x2413a7(0x25e)],_0x2aa0d9[_0x2413a7(0x218)]];for(let _0x284d2c=0x0;_0x2aa0d9[_0x2413a7(0x246)](_0x284d2c,_0xf5b98a['length']);_0x284d2c++){if(_0x2aa0d9['BzNGY'](_0x2aa0d9[_0x2413a7(0x39e)],_0x2aa0d9[_0x2413a7(0x39e)])){const _0x12847f=_0x2851ed[_0x2413a7(0x2de)][_0x2413a7(0x355)][_0x2413a7(0x315)](_0x2851ed),_0x446288=_0xf5b98a[_0x284d2c],_0x5a7210=_0xaeeb7a[_0x446288]||_0x12847f;_0x12847f[_0x2413a7(0x35a)]=_0x2851ed[_0x2413a7(0x315)](_0x2851ed),_0x12847f[_0x2413a7(0x356)]=_0x5a7210[_0x2413a7(0x356)][_0x2413a7(0x315)](_0x5a7210),_0xaeeb7a[_0x446288]=_0x12847f;}else _0x3c98ea['close']();}});_0x3332c0();import _0x20f380 from'express';import{MongoClient as _0xde0c70,ObjectId as _0x4183a3}from'mongodb';import _0x17e491 from'bcrypt';const x=_0x20f380[_0x1ae8b1(0x2b9)]();import _0x212f1d from'multer';import _0x4cb2f6 from'validator';import _0x37a832 from'xlsx';import _0x5d4804 from'path';import _0x17b3ef from'fs';import _0x1e4d9c from'ejs';import _0x49493d from'../middleware/mainAuth.js';const H=await import(_0x1ae8b1(0x379)+mymoduleFolder+_0x1ae8b1(0x395)),O=await import(_0x1ae8b1(0x379)+mymoduleFolder+'/myDateTime.js'),M=await import(_0x1ae8b1(0x379)+mymoduleFolder+_0x1ae8b1(0x311)),re=await import('../'+mymoduleFolder+'/mySendmail.js'),z=await import(_0x1ae8b1(0x379)+mymoduleFolder+_0x1ae8b1(0x2f3)),b='/manage/users',Q=b+'/save',X=b+_0x1ae8b1(0x38c),W=b+_0x1ae8b1(0x28c),G=b+_0x1ae8b1(0x30e),V=b+_0x1ae8b1(0x2e7),Y=b+_0x1ae8b1(0x36b),K=b+'/download-excel',Z=b+_0x1ae8b1(0x362),ne=b[_0x1ae8b1(0x281)](/\//g,'_'),oe=0x5a0*0x3c;x['get'](b,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x5eccf0,_0x2aca2e)=>{const _0x15185d=_0x1ae8b1,_0x31615d={'qtUki':function(_0x1f2d64,_0x2c7cad){return _0x1f2d64(_0x2c7cad);},'Pvpqe':function(_0x3d2637,_0x44a99d){return _0x3d2637+_0x44a99d;},'QNSPS':_0x15185d(0x247),'rDpJm':'gger','lpWQG':_0x15185d(0x1a2),'RWuPW':_0x15185d(0x229),'EYFYE':function(_0x368c33,_0xcdef23){return _0x368c33!==_0xcdef23;},'fPdAh':_0x15185d(0x32a),'NkaXJ':function(_0x59383c,_0x4634ce){return _0x59383c==_0x4634ce;},'GtTNt':function(_0x711572,_0x456570){return _0x711572(_0x456570);},'ClOJP':'error\x20===>\x20','XcwZr':function(_0xf3b0e5,_0x200c67){return _0xf3b0e5(_0x200c67);},'NpxVL':function(_0x58e4d2,_0x1f70d9){return _0x58e4d2*_0x1f70d9;},'ftGIl':function(_0x4445bf,_0x52a816){return _0x4445bf-_0x52a816;},'ZvrAT':function(_0x31c52f,_0x27ae3d){return _0x31c52f===_0x27ae3d;},'KJhaG':_0x15185d(0x260),'ScSPg':_0x15185d(0x165),'cBHaI':'JDsHs','hMXsV':_0x15185d(0x2a5),'lzbps':function(_0xf64e2c,_0x51898f){return _0xf64e2c(_0x51898f);},'UpuVD':function(_0xb0df40,_0x35fcaa){return _0xb0df40/_0x35fcaa;},'AdSNG':function(_0x44d9f4,_0x52d369){return _0x44d9f4<_0x52d369;},'KmtQc':function(_0x2d120d,_0x1cdd20){return _0x2d120d-_0x1cdd20;},'JNcpJ':function(_0x55f177,_0x50db1c){return _0x55f177(_0x50db1c);},'QiCwt':function(_0x421bb7,_0x5d6624){return _0x421bb7>_0x5d6624;},'mUhtZ':function(_0x94de82,_0x12d58d){return _0x94de82(_0x12d58d);},'huIoZ':function(_0x42c5c5,_0x18aaab){return _0x42c5c5(_0x18aaab);},'YjBbb':'$userPrefix','lcMnS':_0x15185d(0x1d5),'FzQQq':_0x15185d(0x1be),'MdAJd':_0x15185d(0x2fc),'KgiWt':_0x15185d(0x22f),'Wqxsq':'minute','PYTsP':'PkgzL','lLGnC':_0x15185d(0x399),'EsdgN':function(_0x19fe3e,_0x141a91){return _0x19fe3e===_0x141a91;},'kEgNC':_0x15185d(0x377),'amSea':_0x15185d(0x39d),'RiyQq':'userFlash','WTPyN':'manageUsers','dcybO':_0x15185d(0x22c),'JvyHO':'active','YYIgY':_0x15185d(0x33a),'ahaIc':_0x15185d(0x255),'RMlaJ':_0x15185d(0x365)},_0xb2f362=_0x5eccf0[_0x15185d(0x1c9)][_0x15185d(0x29a)],_0x4be3d2=_0x31615d[_0x15185d(0x2f5)](Number,_0x5eccf0[_0x15185d(0x1c9)][_0x15185d(0x2c0)])||0x14,_0x13839a=_0x31615d['XcwZr'](Number,_0x5eccf0['query'][_0x15185d(0x28a)])||0x1,_0x7f551d=_0x5eccf0['query']['load_id']||'',_0x873ea9=_0x31615d[_0x15185d(0x1e6)](Number,_0x31615d[_0x15185d(0x374)](_0x31615d[_0x15185d(0x1cb)](_0x13839a,0x1),_0x4be3d2)),_0x1ca985=O['getDateTime'](0x0),_0x6729a5=new _0xde0c70(dbUrl);try{if(_0x31615d['ZvrAT'](_0x31615d['KJhaG'],_0x31615d[_0x15185d(0x217)]))nHhwYs['qtUki'](_0x28e6ca,0x0);else{await _0x6729a5[_0x15185d(0x254)]();const _0x45bab1=_0x6729a5['db'](global['dbName'])['collection'](global[_0x15185d(0x345)]);if(_0xb2f362){if(_0x31615d[_0x15185d(0x282)](_0x31615d['cBHaI'],_0x31615d['cBHaI'])){const _0x5713db=new RegExp(_0xb2f362[_0x15185d(0x281)](/[.*+?^${}()|[\]\\]/g,_0x31615d[_0x15185d(0x191)]),'i');let _0x2b85f9={};_0x31615d[_0x15185d(0x2f5)](isNaN,_0x31615d[_0x15185d(0x366)](Number,_0xb2f362))?_0x2b85f9={'userId':{'$regex':_0x5713db}}:_0x2b85f9={'userId':_0x31615d['XcwZr'](Number,_0xb2f362)};var _0x303552=await _0x45bab1[_0x15185d(0x291)]({'$or':[_0x2b85f9,{'username':{'$regex':_0x5713db}},{'userFirstname':{'$regex':_0x5713db}}]});}else(function(){return![];}[_0x15185d(0x2de)](nHhwYs[_0x15185d(0x237)](nHhwYs[_0x15185d(0x2e4)],nHhwYs[_0x15185d(0x23c)]))['apply'](nHhwYs[_0x15185d(0x32d)]));}else var _0x303552=await _0x45bab1['countDocuments']({});const _0x3c6f54=Math[_0x15185d(0x304)](_0x31615d[_0x15185d(0x1f8)](_0x303552,_0x4be3d2)),_0x15e650=_0x31615d['AdSNG'](_0x31615d[_0x15185d(0x1cb)](_0x31615d[_0x15185d(0x366)](Number,_0x13839a),0x1),0x1)?'-':_0x31615d[_0x15185d(0x290)](_0x31615d[_0x15185d(0x3a1)](Number,_0x13839a),0x1),_0x5cf123=_0x31615d[_0x15185d(0x3a1)](Number,_0x13839a),_0x2c61b9=_0x31615d[_0x15185d(0x1b6)](_0x31615d['Pvpqe'](_0x31615d[_0x15185d(0x1e9)](Number,_0x13839a),0x1),_0x3c6f54)?'-':_0x31615d[_0x15185d(0x237)](_0x31615d[_0x15185d(0x244)](Number,_0x13839a),0x1),_0xd6b6c=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x31615d['YjBbb'],'\x20',_0x31615d[_0x15185d(0x326)],'\x20',_0x31615d[_0x15185d(0x378)]]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x31615d[_0x15185d(0x201)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x1ca985},'endDate':{'$toDate':_0x31615d[_0x15185d(0x29d)]},'unit':_0x31615d[_0x15185d(0x24a)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x873ea9},{'$limit':_0x4be3d2}];if(_0xb2f362){if(_0x31615d[_0x15185d(0x180)](_0x31615d[_0x15185d(0x15a)],_0x31615d[_0x15185d(0x15a)])){const _0x1eb5f9=_0x50dbc4[_0x15185d(0x156)](new _0x5ada19(_0x5a15bb[_0x15185d(0x2b6)](_0x361acc=>_0x450248[_0x15185d(0x271)](_0x361acc))))[_0x15185d(0x2b6)](_0x47685f=>_0x28083f[_0x15185d(0x2df)](_0x47685f));return _0x3c135c['send']({'isUpload':!0x1,'color':_0x31615d[_0x15185d(0x29c)],'msg':_0x15185d(0x264)+_0x1eb5f9[_0x15185d(0x2b6)](_0x3104bc=>_0x3104bc[_0x15185d(0x1ca)])[_0x15185d(0x1df)](',\x20'),'errorRows':_0x1eb5f9});}else{const _0x5efc1a=_0xb2f362?new RegExp(''+_0xb2f362,'i'):new RegExp('.*');let _0x3d4198={};_0x31615d['mUhtZ'](isNaN,_0x31615d[_0x15185d(0x2f5)](Number,_0xb2f362))?_0x3d4198={'userId':{'$regex':_0x5efc1a}}:_0x3d4198={'userId':_0x31615d[_0x15185d(0x366)](Number,_0xb2f362)},_0xd6b6c['unshift']({'$match':{'$or':[_0x3d4198,{'username':{'$regex':_0x5efc1a}},{'userFirstname':{'$regex':_0x5efc1a}}]}});}}const _0x4780d5=M[_0x15185d(0x2ae)](_0x5eccf0),_0x2eca20=_0x4780d5[_0x15185d(0x397)];let _0x15ecc1=await _0x45bab1[_0x15185d(0x360)](_0xd6b6c)[_0x15185d(0x187)]();if(['S'][_0x15185d(0x32f)](_0x2eca20)){if(_0x31615d[_0x15185d(0x282)](_0x31615d[_0x15185d(0x368)],_0x31615d[_0x15185d(0x368)])){const _0x23b63f=_0x4780d5[_0x15185d(0x2e5)];_0x15ecc1=_0x15ecc1[_0x15185d(0x384)](_0x2171fb=>{const _0x208533=_0x15185d;if(_0x31615d[_0x208533(0x180)](_0x31615d[_0x208533(0x210)],_0x31615d[_0x208533(0x210)]))_0x54bf7e['close']();else{const _0x23e37a=_0x31615d[_0x208533(0x180)](_0x2171fb['userAuthority'],'S')||_0x31615d[_0x208533(0x1fa)](_0x2171fb['userId'],_0x23b63f);return _0x31615d[_0x208533(0x180)](_0x2171fb['userAuthority'],'O')&&_0x23e37a;}});}else{if(_0x3ff382){const _0x241a21=_0x420522[_0x15185d(0x20e)](_0x401930,arguments);return _0x206c57=null,_0x241a21;}}}if(_0x7f551d)var _0x1887ef=await _0x45bab1[_0x15185d(0x279)]({'_id':new _0x4183a3(_0x7f551d)},{'projection':{'userPassword':0x0}});else var _0x1887ef={};if(_0x1887ef&&_0x31615d[_0x15185d(0x282)](Object[_0x15185d(0x303)](_0x1887ef)[_0x15185d(0x189)],0x0)){if(_0x31615d[_0x15185d(0x38a)](_0x31615d[_0x15185d(0x18d)],_0x31615d[_0x15185d(0x1d1)]))_0x2dabc8[_0x15185d(0x349)]();else{const _0x5623ba=_0x5eccf0['flash'](_0x31615d[_0x15185d(0x324)]);_0x5623ba&&_0x31615d[_0x15185d(0x1b6)](_0x5623ba['length'],0x0)&&(_0x1887ef={..._0x5623ba[0x0]});}}const _0x5812b6=await H[_0x15185d(0x1f7)](_0x31615d[_0x15185d(0x166)],_0x2aca2e,{'title':PAGE_MANAGE_USERS,'time':O[_0x15185d(0x185)](),'msg':_0x5eccf0[_0x15185d(0x292)](_0x31615d[_0x15185d(0x221)]),'user':await M[_0x15185d(0x2ae)](_0x5eccf0),'settings':await H[_0x15185d(0x2ef)](),'load_id':_0x7f551d,'sip':_0xb2f362,'rpp':_0x4be3d2,'page':_0x13839a,'pagePre':_0x15e650,'pageAct':_0x5cf123,'pageNxt':_0x2c61b9,'pageLst':_0x3c6f54,'pageRedirect':b,'data':_0x15ecc1,'dataBranches':await z[_0x15185d(0x342)]({'branchStatus':_0x31615d[_0x15185d(0x295)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x1887ef});return _0x2aca2e[_0x15185d(0x21d)](_0x5812b6);}}catch(_0x25199e){if(_0x31615d[_0x15185d(0x180)](_0x31615d[_0x15185d(0x26b)],_0x31615d[_0x15185d(0x26b)])){if(_0x3bb3a1)return _0x53e040;else nHhwYs['GtTNt'](_0x4af599,0x0);}else console[_0x15185d(0x1f6)](_0x25199e[_0x15185d(0x2ed)]),_0x2aca2e[_0x15185d(0x37a)](0x194)['sendFile'](file404);}finally{_0x31615d[_0x15185d(0x282)](_0x31615d['ahaIc'],_0x31615d[_0x15185d(0x236)])?(_0x59b7f5[_0x15185d(0x1f6)](_0x31615d[_0x15185d(0x18a)],_0xe7de74),_0x38f2c2['status'](0x194)[_0x15185d(0x200)](_0xb1b1e1)):_0x6729a5['close']();}}),x[_0x1ae8b1(0x167)](W,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x4e403c,_0x2d26a6)=>{const _0x2bef04=_0x1ae8b1,_0x14be11={'pcVkY':_0x2bef04(0x2a9),'qXszk':'red','SbGBY':_0x2bef04(0x17b),'mFQPu':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','wYPVN':function(_0x2b5b90,_0x4db576){return _0x2b5b90(_0x4db576);},'INAcl':_0x2bef04(0x35e),'iEKNF':function(_0x15a5e7,_0x4113a9){return _0x15a5e7+_0x4113a9;},'eFbaU':'chain','BihmL':_0x2bef04(0x1bb),'VYmQW':function(_0x5ab1a7){return _0x5ab1a7();},'ydMzd':function(_0x46ab5c,_0x440aa2,_0x361e5a){return _0x46ab5c(_0x440aa2,_0x361e5a);},'uhoxi':function(_0x3d4a78,_0x350b52){return _0x3d4a78(_0x350b52);},'GDlCW':function(_0xf2dad6,_0x108871){return _0xf2dad6(_0x108871);},'hbBgY':function(_0x52611b,_0x1f72de){return _0x52611b!==_0x1f72de;},'hTUQI':_0x2bef04(0x298),'Jyfqo':'pZMLi','xKgdR':_0x2bef04(0x22c),'DbiCE':'Not\x20Found','oCAfg':function(_0x31af8a,_0x57b3cd){return _0x31af8a!==_0x57b3cd;},'tOyBp':_0x2bef04(0x1e1),'prRwH':function(_0x176182,_0x55fb6b){return _0x176182===_0x55fb6b;},'bFopw':_0x2bef04(0x2af)},_0x5c54a5=_0x4e403c[_0x2bef04(0x266)]['load_id'],_0x6229c9=_0x4e403c[_0x2bef04(0x266)]['sip'],_0x348805=_0x14be11['GDlCW'](Number,_0x4e403c[_0x2bef04(0x266)][_0x2bef04(0x2c0)])||0x14,_0x7eac79=_0x14be11['uhoxi'](Number,_0x4e403c[_0x2bef04(0x266)][_0x2bef04(0x28a)])||0x1,_0x3b1d6f=b+_0x2bef04(0x1d3)+_0x6229c9+_0x2bef04(0x1c4)+_0x348805+_0x2bef04(0x37e)+_0x7eac79+_0x2bef04(0x198)+_0x5c54a5,_0x13d2bf=new _0xde0c70(dbUrl);try{return _0x14be11[_0x2bef04(0x20c)](_0x14be11[_0x2bef04(0x199)],_0x14be11['Jyfqo'])?(await _0x13d2bf['db'](dbName)[_0x2bef04(0x307)](dbColl_users)[_0x2bef04(0x279)]({'_id':new _0x4183a3(_0x5c54a5)},{'projection':{'changesHistory':0x0}})?_0x4e403c['flash'](_0x14be11[_0x2bef04(0x30c)],null):_0x4e403c[_0x2bef04(0x292)](_0x14be11['xKgdR'],{'class':_0x14be11[_0x2bef04(0x2b4)],'text':new Error(_0x14be11[_0x2bef04(0x19b)])+_0x2bef04(0x2c6)+_0x5c54a5+'\x22'}),_0x2d26a6[_0x2bef04(0x182)](_0x3b1d6f)):(_0xa555c6[_0x2bef04(0x1f6)](_0x14be11[_0x2bef04(0x2f9)],_0x29c4a9),_0x51674f['send']({'isDownload':!0x1,'color':_0x14be11[_0x2bef04(0x2b4)],'msg':_0x2d4d85[_0x2bef04(0x2ed)]}));}catch(_0x501d4b){if(_0x14be11[_0x2bef04(0x22b)](_0x14be11['tOyBp'],_0x14be11[_0x2bef04(0x22d)]))culTcW[_0x2bef04(0x212)](_0x2c1f89,this,function(){const _0x3a5880=_0x2bef04,_0x5270d2=new _0x1aaca3(culTcW['SbGBY']),_0x38c5ca=new _0x18e8bb(culTcW[_0x3a5880(0x25a)],'i'),_0x18252a=culTcW[_0x3a5880(0x1dd)](_0x1d1f4a,culTcW[_0x3a5880(0x1b1)]);!_0x5270d2[_0x3a5880(0x369)](culTcW[_0x3a5880(0x37f)](_0x18252a,culTcW[_0x3a5880(0x204)]))||!_0x38c5ca['test'](culTcW[_0x3a5880(0x37f)](_0x18252a,culTcW[_0x3a5880(0x2c3)]))?culTcW['wYPVN'](_0x18252a,'0'):culTcW[_0x3a5880(0x30d)](_0x387370);})();else return console[_0x2bef04(0x1f6)](_0x501d4b[_0x2bef04(0x2ed)]),_0x4e403c[_0x2bef04(0x292)](_0x14be11[_0x2bef04(0x30c)],{'class':_0x14be11[_0x2bef04(0x2b4)],'text':''+_0x501d4b[_0x2bef04(0x2ed)]}),_0x2d26a6[_0x2bef04(0x182)](_0x3b1d6f);}finally{_0x14be11[_0x2bef04(0x2c2)](_0x14be11[_0x2bef04(0x31d)],_0x14be11[_0x2bef04(0x31d)])?_0x13d2bf['close']():culTcW[_0x2bef04(0x308)](_0x169ae8,'0');}}),x[_0x1ae8b1(0x167)](Q,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x13e963,_0x249a09)=>{const _0x31a912=_0x1ae8b1,_0x4a2c2e={'GbSDI':_0x31a912(0x229),'JKUkj':function(_0x2caa75,_0x4b1794){return _0x2caa75!==_0x4b1794;},'YZbGG':function(_0x1b8f8b,_0x3b7176){return _0x1b8f8b==_0x3b7176;},'IyaNd':function(_0x2d5fd8,_0x5c07ce){return _0x2d5fd8!==_0x5c07ce;},'SkfwS':function(_0x59af5d,_0x562277){return _0x59af5d!==_0x562277;},'IeIvZ':_0x31a912(0x190),'jpoRc':function(_0x11e789,_0x5b0855){return _0x11e789===_0x5b0855;},'andOS':function(_0x5d4528,_0x40148b){return _0x5d4528!==_0x40148b;},'UKLfU':_0x31a912(0x21e),'nQRAy':'ubAUO','xWszf':function(_0x18c3e0,_0x6819ae,_0x39417c){return _0x18c3e0(_0x6819ae,_0x39417c);},'NOaOA':function(_0x19b374){return _0x19b374();},'FrrGu':function(_0x26b0b6,_0x18b548){return _0x26b0b6>_0x18b548;},'parws':_0x31a912(0x39f),'IYYop':'msg','pZZkP':_0x31a912(0x33b),'AChGi':function(_0x11534c,_0x43f82f){return _0x11534c+_0x43f82f;},'EiPPS':_0x31a912(0x247),'baPqF':_0x31a912(0x1f1),'lHcvg':_0x31a912(0x2bd),'nCGNh':function(_0x3ab007,_0x38a4a9){return _0x3ab007==_0x38a4a9;},'EVKlb':'TPPeB','urOEJ':function(_0x3c675c,_0x423c7a){return _0x3c675c(_0x423c7a);},'keqrk':function(_0x984b0b,_0x5de70f){return _0x984b0b(_0x5de70f);},'mxyBX':function(_0x957bdb,_0x155c41){return _0x957bdb(_0x155c41);},'yDKqJ':_0x31a912(0x23d),'EeGHx':function(_0x3941c3,_0x304294){return _0x3941c3!==_0x304294;},'gqrVN':_0x31a912(0x37d),'FNzzJ':function(_0x495597,_0x33b995){return _0x495597===_0x33b995;},'Etuio':_0x31a912(0x1c7),'GtieE':_0x31a912(0x2c8),'Snqdc':_0x31a912(0x16a),'pEzbc':function(_0xb832fa,_0x97d5ab){return _0xb832fa==_0x97d5ab;},'lvBXe':_0x31a912(0x2e1),'SDiVs':function(_0x5891cd,_0x59abd8){return _0x5891cd==_0x59abd8;},'ZecKY':function(_0x172ded,_0xdb3ef9){return _0x172ded==_0xdb3ef9;},'MSeQL':_0x31a912(0x22e),'ylVAt':function(_0x3ee006,_0x97794){return _0x3ee006>_0x97794;},'ICXGb':_0x31a912(0x2d4),'LpxIt':_0x31a912(0x1ac),'kwpPu':_0x31a912(0x353),'UUSuP':_0x31a912(0x163),'FfPAo':_0x31a912(0x32c),'axHmA':function(_0x2c0fd9,_0x4588cb){return _0x2c0fd9>_0x4588cb;},'oXdVy':'{{sep}}(\x20ไม่พบเซสชั่น\x20)','aISnG':function(_0x767c49,_0x3391a5){return _0x767c49!==_0x3391a5;},'QcHrl':'tYTlK','Xoxhu':function(_0x44847f,_0x38eeb4){return _0x44847f<_0x38eeb4;},'HXdPM':function(_0x178f44,_0x514ead){return _0x178f44<_0x514ead;},'fMGRa':_0x31a912(0x33e),'XyLKz':_0x31a912(0x390),'AZCSR':function(_0x1ffcba,_0x141928){return _0x1ffcba!==_0x141928;},'acTSA':_0x31a912(0x2d2),'CGnqC':_0x31a912(0x35c),'NlmkX':_0x31a912(0x23e),'mFYEb':function(_0x4e559a,_0x47b9a4){return _0x4e559a>_0x47b9a4;},'bLlYW':_0x31a912(0x1b9),'PhAcS':_0x31a912(0x1b8),'GBlTv':function(_0x492ecb,_0x390fb8){return _0x492ecb>_0x390fb8;},'kgFAP':_0x31a912(0x181),'hXXXu':function(_0xc29765,_0x4b915d){return _0xc29765!==_0x4b915d;},'LcAkO':_0x31a912(0x274),'YYkts':_0x31a912(0x32b),'cVsXR':_0x31a912(0x2a9),'DKXhh':function(_0x1a1871,_0x412f14){return _0x1a1871!==_0x412f14;},'cCgHc':_0x31a912(0x269),'SjmrW':function(_0x113b50){return _0x113b50();}},_0x351773=[];let _0x5703db=!0x1;const _0x2ed2db=async()=>{const _0x134915=_0x31a912;if(_0x4a2c2e['SkfwS'](_0x4a2c2e[_0x134915(0x235)],_0x4a2c2e[_0x134915(0x235)]))return _0x5134d8[_0x134915(0x21d)]({'isDownload':!0x1,'color':_0x4a2c2e['GbSDI'],'msg':_0x11c766[_0x134915(0x2ed)]});else{if(_0x4a2c2e['jpoRc'](_0x351773[_0x134915(0x189)],0x0)){if(_0x4a2c2e[_0x134915(0x205)](_0x4a2c2e[_0x134915(0x16e)],_0x4a2c2e[_0x134915(0x37c)])){_0x5703db=!0x1;return;}else{const _0x1afbd9=_0x4a2c2e['JKUkj'](_0xdc4ec2[_0x134915(0x397)],'S')||_0x4a2c2e[_0x134915(0x170)](_0x202758[_0x134915(0x2e5)],_0x5bb9dd);return _0x4a2c2e[_0x134915(0x24b)](_0x3c8f44[_0x134915(0x397)],'O')&&_0x1afbd9;}}_0x5703db=!0x0;const {req:_0x34482d,res:_0x4b49bd}=_0x351773[_0x134915(0x35d)]();await _0x4a2c2e['xWszf'](_0x16c810,_0x34482d,_0x4b49bd),_0x4a2c2e[_0x134915(0x17c)](_0x2ed2db);}},_0x16c810=async(_0x2033f3,_0x5f0be2)=>{const _0x1146c1=_0x31a912,_0x21b618={'JIqCn':function(_0x333397,_0x450d53){return _0x4a2c2e['andOS'](_0x333397,_0x450d53);},'TERhl':function(_0x4bfb44,_0x5dd5e1){const _0x243b25=_0x5225;return _0x4a2c2e[_0x243b25(0x2cd)](_0x4bfb44,_0x5dd5e1);},'MVoSr':function(_0x5d1b47,_0x2fcdf3){const _0xf38ec9=_0x5225;return _0x4a2c2e[_0xf38ec9(0x24b)](_0x5d1b47,_0x2fcdf3);}};if(_0x4a2c2e['jpoRc'](_0x4a2c2e[_0x1146c1(0x214)],_0x4a2c2e['EVKlb'])){const _0x56af5d=_0x2033f3['body'][_0x1146c1(0x2b8)];delete _0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2b8)];const _0x5caaf2=_0x2033f3[_0x1146c1(0x266)]['sip'],_0x4302b7=_0x4a2c2e[_0x1146c1(0x267)](Number,_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2c0)])||0x14,_0x12010f=_0x4a2c2e[_0x1146c1(0x174)](Number,_0x2033f3[_0x1146c1(0x266)]['page'])||0x1;delete _0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2c0)],delete _0x2033f3['body'][_0x1146c1(0x29a)],delete _0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x28a)],_0x2033f3['body']['userId']=_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2e5)]?_0x4a2c2e[_0x1146c1(0x18b)](Number,_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2e5)]):_0x2033f3[_0x1146c1(0x266)]['userId'],_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x211)]=_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x211)]?_0x4a2c2e[_0x1146c1(0x267)](Number,_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x211)]):_0x2033f3['body'][_0x1146c1(0x211)];const _0x5dd059=_0x2033f3['body']['username']?.['trim'](),_0x2ea1f5=_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x248)]?.[_0x1146c1(0x305)](),_0x4b6316=_0x2033f3[_0x1146c1(0x266)]['userId'],_0x5221c8=''+b,_0x2a865b=b+_0x1146c1(0x1d3)+_0x5caaf2+'&rpp='+_0x4302b7+'&page='+_0x12010f+_0x1146c1(0x198)+_0x56af5d;if(!new RegExp(USERNAME_PATTERN)[_0x1146c1(0x369)](_0x5dd059))return _0x2033f3['flash'](_0x4a2c2e[_0x1146c1(0x300)],_0x2033f3[_0x1146c1(0x266)]),_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e[_0x1146c1(0x38e)],'text':USERNAME_DESCRIPTION}),_0x5f0be2['redirect'](_0x2a865b);if(_0x2ea1f5&&!new RegExp(EMAIL_PATTERN)[_0x1146c1(0x369)](_0x2ea1f5))return _0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x300)],_0x2033f3[_0x1146c1(0x266)]),_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e[_0x1146c1(0x38e)],'text':_0x4a2c2e[_0x1146c1(0x2c5)]}),_0x5f0be2[_0x1146c1(0x182)](_0x2a865b);const _0x4d6bfb=new _0xde0c70(dbUrl);try{if(_0x4a2c2e[_0x1146c1(0x192)](_0x4a2c2e[_0x1146c1(0x2a8)],_0x4a2c2e[_0x1146c1(0x2a8)])){const _0x292a92=_0x212d64[_0x1146c1(0x346)]['toString'](),_0x4ed5ae=_0x534c0c+_0x1146c1(0x1d3)+_0x59e951+_0x1146c1(0x1c4)+_0x1117be+_0x1146c1(0x37e)+_0x5b162c+_0x1146c1(0x198)+_0x292a92,_0x4093e1={..._0x61b1ae[_0x1146c1(0x266)]};if(delete _0x4093e1[_0x1146c1(0x21f)],_0x38819e[_0x1146c1(0x32f)]('@')&&_0x24d523['includes']('.')&&_0x4a2c2e[_0x1146c1(0x317)](_0x42bbea[_0x1146c1(0x189)],0x5))_0x264cc0[_0x1146c1(0x309)](_0x4093e1,_0x46265d)[_0x1146c1(0x186)](_0x1e0ef3=>(_0x54e09b[_0x1146c1(0x292)]('msg',{'class':_0x1146c1(0x33b),'text':_0x1146c1(0x351)+_0x42d3ae+'){{sep}}(CODE\x20:\x20'+_0x1e0ef3[_0x1146c1(0x334)]+')'}),_0x3d02fc[_0x1146c1(0x182)](_0x4ed5ae)))[_0x1146c1(0x1b5)](_0x3b3b8b=>(_0x32b1f6[_0x1146c1(0x292)]('userFlash',_0x4165a6[_0x1146c1(0x266)]),_0x3fddb5[_0x1146c1(0x292)]('msg',{'class':_0x1146c1(0x229),'text':''+_0x3b3b8b['message']}),_0x125fa0[_0x1146c1(0x182)](_0x4ed5ae)));else return _0x39dac5['flash'](_0x4a2c2e[_0x1146c1(0x300)],_0x1edb1e[_0x1146c1(0x266)]),_0x333582['flash'](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e['pZZkP'],'text':_0x1146c1(0x20a)+_0x35839b}),_0x2835d7['redirect'](_0x4ed5ae);}else{await _0x4d6bfb[_0x1146c1(0x254)]();const _0x26130a=_0x4d6bfb['db'](dbName),_0x42cd82=_0x26130a['collection'](dbColl_users);if(_0x56af5d){if(_0x4a2c2e[_0x1146c1(0x270)](_0x4a2c2e['Etuio'],_0x4a2c2e[_0x1146c1(0x1ab)]))_0x2de577[_0x1146c1(0x349)]();else{var _0x1c947=await _0x42cd82[_0x1146c1(0x279)]({'_id':{'$ne':new _0x4183a3(_0x56af5d)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x2ea1f5+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x5dd059+'$','i')}},{'userId':_0x4b6316}]});if(_0x1c947)return _0x2033f3[_0x1146c1(0x292)](_0x4a2c2e['parws'],_0x2033f3['body']),_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e[_0x1146c1(0x38e)],'text':_0x4a2c2e[_0x1146c1(0x176)]}),_0x5f0be2[_0x1146c1(0x182)](_0x2a865b);const _0x49699f=await _0x42cd82[_0x1146c1(0x279)]({'_id':new _0x4183a3(_0x56af5d)}),_0xf28fae=[_0x4a2c2e[_0x1146c1(0x28e)](_0x2033f3[_0x1146c1(0x266)][_0x1146c1(0x2dc)],_0x4a2c2e[_0x1146c1(0x301)]),_0x4a2c2e['SDiVs'](_0x49699f[_0x1146c1(0x1f9)],_0x2033f3['body']['username']),_0x4a2c2e['nCGNh'](_0x49699f[_0x1146c1(0x248)],_0x2033f3[_0x1146c1(0x266)]['userEmail']),_0x4a2c2e[_0x1146c1(0x225)](_0x49699f[_0x1146c1(0x397)],_0x2033f3['body'][_0x1146c1(0x397)]),_0x4a2c2e[_0x1146c1(0x2cd)](_0x49699f[_0x1146c1(0x211)],_0x2033f3[_0x1146c1(0x266)]['branchId'])],_0x747f={'$set':_0x2033f3['body']},_0x1b50b6=await _0x42cd82['updateOne']({'_id':new _0x4183a3(_0x56af5d)},_0x747f,{'upsert':!0x1});if(_0x1b50b6[_0x1146c1(0x328)]&&_0x4a2c2e[_0x1146c1(0x2cd)](_0x1b50b6[_0x1146c1(0x1e0)],0x1)){if(_0x4a2c2e['jpoRc'](_0x4a2c2e[_0x1146c1(0x364)],_0x4a2c2e[_0x1146c1(0x364)])){const _0x5ac31e=M[_0x1146c1(0x2ae)](_0x2033f3);let _0xa371ec=_0x1146c1(0x34e)+_0x4b6316+'\x22\x20เรียบร้อยแล้ว';const _0x1b6834=z[_0x1146c1(0x31f)](_0x49699f,_0x2033f3['body']);if(_0x1b6834&&_0x4a2c2e[_0x1146c1(0x209)](_0x1b6834['length'],0x0)){if(_0x4a2c2e[_0x1146c1(0x169)](_0x4a2c2e[_0x1146c1(0x1f3)],_0x4a2c2e[_0x1146c1(0x24c)])){const _0x473b14={'dateTime':O[_0x1146c1(0x35b)](),'userId':_0x5ac31e[_0x1146c1(0x2e5)],'userFullname':_0x5ac31e['userFullname'],'changes':_0x1b6834};await _0x42cd82['updateOne']({'userId':_0x4b6316},{'$push':{'changesHistory':{'$each':[_0x473b14],'$position':0x0}}}),_0xa371ec+=_0x4a2c2e[_0x1146c1(0x373)];}else(function(){return!![];}['constructor'](bRtwIV[_0x1146c1(0x2a3)](bRtwIV[_0x1146c1(0x27e)],bRtwIV['baPqF']))[_0x1146c1(0x2c9)](bRtwIV[_0x1146c1(0x36c)]));}if(_0xf28fae[_0x1146c1(0x32f)](!0x1)){if(_0x4a2c2e[_0x1146c1(0x2c7)](_0x4a2c2e['UUSuP'],_0x4a2c2e[_0x1146c1(0x258)]))_0x5e7265[_0x1146c1(0x2bb)](_0x300929['userId'])?_0x1b7dec[_0x1146c1(0x2a6)](_0x7eb4ef['userId']):_0x351a65[_0x1146c1(0x2a6)](_0x4e6566[_0x1146c1(0x2e5)]);else{const _0x5217e0=await _0x26130a[_0x1146c1(0x307)](global[_0x1146c1(0x19e)])['deleteMany']({'session.user_id':_0x56af5d});_0x5217e0[_0x1146c1(0x328)]&&_0x4a2c2e[_0x1146c1(0x25b)](_0x5217e0[_0x1146c1(0x232)],0x0)?_0xa371ec+=_0x1146c1(0x2f7)+_0x5217e0['deletedCount']+_0x1146c1(0x341):_0xa371ec+=_0x4a2c2e[_0x1146c1(0x1b4)];}}if(_0xf28fae[_0x1146c1(0x32f)](!0x1)&&_0x4a2c2e['nCGNh'](_0x5ac31e[_0x1146c1(0x1d6)],_0x56af5d)){if(_0x4a2c2e[_0x1146c1(0x388)](_0x4a2c2e[_0x1146c1(0x288)],_0x4a2c2e[_0x1146c1(0x288)])){const _0x505919=_0x3ac2b3?function(){const _0x36c09a=_0x1146c1;if(_0x114bce){const _0x140264=_0x1801a9[_0x36c09a(0x20e)](_0x4a5699,arguments);return _0x4e7dc7=null,_0x140264;}}:function(){};return _0x3f1962=![],_0x505919;}else{_0x2033f3[_0x1146c1(0x27b)][_0x1146c1(0x2b3)](_0x5d8bd1=>(_0x5d8bd1&&console['log'](_0x1146c1(0x1fe),_0x5d8bd1),_0x5f0be2[_0x1146c1(0x182)]('/')));return;}}else return _0x2033f3['flash'](_0x4a2c2e['IYYop'],{'class':_0x4a2c2e[_0x1146c1(0x296)],'text':_0xa371ec}),_0x5f0be2[_0x1146c1(0x182)](_0x2a865b);}else{const _0x250cf3=_0x2bd759?function(){const _0x3f9594=_0x1146c1;if(_0x2d9b61){const _0x506645=_0x364dd5[_0x3f9594(0x20e)](_0x283027,arguments);return _0xd67ae1=null,_0x506645;}}:function(){};return _0x4faa64=![],_0x250cf3;}}else return _0x1b50b6[_0x1146c1(0x328)]&&(_0x4a2c2e[_0x1146c1(0x29f)](_0x1b50b6[_0x1146c1(0x1e0)],0x1)||_0x4a2c2e[_0x1146c1(0x36e)](_0x1b50b6[_0x1146c1(0x251)],0x1))?(_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e[_0x1146c1(0x394)],'text':'\x22'+_0x4b6316+_0x1146c1(0x25c)}),_0x5f0be2[_0x1146c1(0x182)](_0x2a865b)):(_0x2033f3['flash'](_0x4a2c2e['parws'],_0x2033f3[_0x1146c1(0x266)]),_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e['GbSDI'],'text':new Error(_0x4a2c2e[_0x1146c1(0x2c1)])+_0x1146c1(0x2c6)+_0x4b6316+'\x22'}),_0x5f0be2['redirect'](_0x2a865b));}}else{if(_0x4a2c2e['AZCSR'](_0x4a2c2e[_0x1146c1(0x2ee)],_0x4a2c2e[_0x1146c1(0x20b)])){if(await _0x42cd82[_0x1146c1(0x279)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x2ea1f5+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x5dd059+'$','i')}}]}))return _0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x300)],_0x2033f3[_0x1146c1(0x266)]),_0x2033f3['flash'](_0x4a2c2e['IYYop'],{'class':_0x4a2c2e['GbSDI'],'text':_0x4a2c2e['NlmkX']}),_0x5f0be2[_0x1146c1(0x182)](_0x2a865b);const _0x2e47e8=await _0x42cd82['find']({},{'projection':{'userId':0x1}})[_0x1146c1(0x2da)]({'userId':-0x1})[_0x1146c1(0x193)](0x1)[_0x1146c1(0x187)](),_0x4a713c=_0x4a2c2e[_0x1146c1(0x19a)](_0x2e47e8[_0x1146c1(0x189)],0x0)?_0x4a2c2e['AChGi'](_0x2e47e8[0x0][_0x1146c1(0x2e5)],0x1):0x3e8;_0x2033f3[_0x1146c1(0x266)]['userId']=_0x4a713c,_0x2033f3['body'][_0x1146c1(0x336)]=O[_0x1146c1(0x35b)](0x5a0);const _0x255b32=H[_0x1146c1(0x262)]();_0x2033f3[_0x1146c1(0x266)]['userPassword']=await _0x17e491[_0x1146c1(0x3a3)](_0x255b32,global[_0x1146c1(0x35f)]);const _0x56de95=await _0x42cd82[_0x1146c1(0x253)](_0x2033f3[_0x1146c1(0x266)]);if(_0x56de95[_0x1146c1(0x328)]&&_0x56de95[_0x1146c1(0x346)]){if(_0x4a2c2e[_0x1146c1(0x24b)](_0x4a2c2e[_0x1146c1(0x1dc)],_0x4a2c2e['PhAcS'])){const _0xb36756=_0x56de95[_0x1146c1(0x346)][_0x1146c1(0x356)](),_0x7dc845=b+_0x1146c1(0x1d3)+_0x5caaf2+_0x1146c1(0x1c4)+_0x4302b7+'&page='+_0x12010f+_0x1146c1(0x198)+_0xb36756,_0x52802b={..._0x2033f3[_0x1146c1(0x266)]};if(delete _0x52802b[_0x1146c1(0x21f)],_0x2ea1f5[_0x1146c1(0x32f)]('@')&&_0x2ea1f5[_0x1146c1(0x32f)]('.')&&_0x4a2c2e[_0x1146c1(0x38d)](_0x2ea1f5[_0x1146c1(0x189)],0x5))re[_0x1146c1(0x309)](_0x52802b,_0x255b32)['then'](_0x11bb65=>(_0x2033f3[_0x1146c1(0x292)]('msg',{'class':_0x1146c1(0x33b),'text':_0x1146c1(0x351)+_0x2ea1f5+_0x1146c1(0x234)+_0x11bb65[_0x1146c1(0x334)]+')'}),_0x5f0be2[_0x1146c1(0x182)](_0x7dc845)))[_0x1146c1(0x1b5)](_0x235f4b=>(_0x2033f3[_0x1146c1(0x292)]('userFlash',_0x2033f3['body']),_0x2033f3[_0x1146c1(0x292)](_0x1146c1(0x22c),{'class':'red','text':''+_0x235f4b[_0x1146c1(0x2ed)]}),_0x5f0be2[_0x1146c1(0x182)](_0x7dc845)));else return _0x2033f3[_0x1146c1(0x292)](_0x4a2c2e['parws'],_0x2033f3[_0x1146c1(0x266)]),_0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e[_0x1146c1(0x296)],'text':'เพิ่มยูสเซอร์\x20'+_0x2ea1f5}),_0x5f0be2[_0x1146c1(0x182)](_0x7dc845);}else _0x579b14[_0x1146c1(0x349)]();}else _0x2033f3[_0x1146c1(0x292)](_0x4a2c2e[_0x1146c1(0x2be)],{'class':_0x4a2c2e['GbSDI'],'text':_0x4a2c2e[_0x1146c1(0x1d4)]}),_0x5f0be2[_0x1146c1(0x182)](_0x5221c8);}else{_0x59eb5a=!0x1;return;}}}}catch(_0x2820c1){_0x4a2c2e['hXXXu'](_0x4a2c2e[_0x1146c1(0x1e4)],_0x4a2c2e[_0x1146c1(0x33d)])?(console[_0x1146c1(0x1f6)](_0x4a2c2e[_0x1146c1(0x382)],_0x2820c1),_0x5f0be2['status'](0x194)['sendFile'](file404)):_0xad3371=_0x44b97b;}finally{if(_0x4a2c2e[_0x1146c1(0x29e)](_0x4a2c2e['cCgHc'],_0x4a2c2e[_0x1146c1(0x1ff)])){const _0xe8a54a=_0x311f6f[_0x1146c1(0x2e5)];_0x36d4b3=_0x43379b[_0x1146c1(0x384)](_0x33bd4c=>{const _0xae7222=_0x1146c1,_0x10ad93=_0x21b618[_0xae7222(0x188)](_0x33bd4c[_0xae7222(0x397)],'S')||_0x21b618['TERhl'](_0x33bd4c[_0xae7222(0x2e5)],_0xe8a54a);return _0x21b618[_0xae7222(0x318)](_0x33bd4c['userAuthority'],'O')&&_0x10ad93;});}else _0x4d6bfb[_0x1146c1(0x349)]();}}else{const _0x293a45=_0x279f8e['apply'](_0x4c4e87,arguments);return _0x527166=null,_0x293a45;}};_0x351773['push']({'req':_0x13e963,'res':_0x249a09}),_0x5703db||_0x4a2c2e[_0x31a912(0x1b7)](_0x2ed2db);}),x[_0x1ae8b1(0x167)](X,_0x49493d['isOS'],async(_0x2f7e3a,_0x4c37f7)=>{const _0x41c711=_0x1ae8b1,_0x453bf1={'SByhz':_0x41c711(0x2d0),'fsscz':'counter','GzkVc':_0x41c711(0x2a9),'JNHmp':function(_0x4679c2,_0x551066){return _0x4679c2!==_0x551066;},'VHbSg':_0x41c711(0x333),'QJcWa':function(_0x3ad029,_0x5401b5){return _0x3ad029>_0x5401b5;},'AHnSm':function(_0x3ff285,_0xda4b9a){return _0x3ff285+_0xda4b9a;},'EFJlH':_0x41c711(0x27d),'CzpDH':_0x41c711(0x283),'iwRMd':'active','OWuId':_0x41c711(0x2d1),'XEFOU':function(_0x498877,_0x1f8390){return _0x498877===_0x1f8390;},'phgTa':_0x41c711(0x297),'MbaJJ':_0x41c711(0x38b)},_0x47c05a=new _0xde0c70(dbUrl),_0x4b2647=''+b;try{if(_0x453bf1['JNHmp'](_0x453bf1['VHbSg'],_0x453bf1[_0x41c711(0x20f)])){_0x5e168c['session'][_0x41c711(0x2b3)](_0x230b99=>(_0x230b99&&_0x98feab[_0x41c711(0x1f6)](_0x41c711(0x1fe),_0x230b99),_0x2b45a9['redirect']('/')));return;}else{await _0x47c05a[_0x41c711(0x254)]();const _0x2ad80a=_0x47c05a['db'](dbName)[_0x41c711(0x307)](dbColl_users);var _0x163cb9=await _0x2ad80a[_0x41c711(0x206)]({})['sort']({'userId':-0x1})['limit'](0x1)[_0x41c711(0x187)](),_0x3285aa=0x0;if(_0x453bf1[_0x41c711(0x2ba)](_0x163cb9['length'],0x0))_0x3285aa=_0x453bf1[_0x41c711(0x363)](_0x163cb9[0x0][_0x41c711(0x2e5)],0x1);else return _0x4c37f7['send']({'isCreate':!0x1,'msg':_0x453bf1['EFJlH'],'redirectUrl':_0x4b2647});const _0x3fc716=process[_0x41c711(0x31b)][_0x41c711(0x179)]||_0x453bf1['CzpDH'],_0x3d197b={'userId':_0x3285aa,'userEmail':_0x41c711(0x158)+_0x3285aa+_0x41c711(0x2fe),'username':'user-'+_0x3285aa,'userPrefix':'','userFirstname':'user-'+_0x3285aa,'userLastname':'','userAuthority':'U','userIsActive':_0x453bf1[_0x41c711(0x36d)],'userPassword':await _0x17e491[_0x41c711(0x3a3)](_0x3fc716,global[_0x41c711(0x35f)]),'branchId':0x64,'dateTimeCanDelete':O[_0x41c711(0x35b)](oe)},_0x29c417=await _0x2ad80a[_0x41c711(0x253)](_0x3d197b);return _0x29c417[_0x41c711(0x328)]&&_0x29c417['insertedId']?_0x4c37f7[_0x41c711(0x21d)]({'isCreate':!0x0,'msg':'สร้างผู้ใช้ใหม่\x20\x22'+_0x3d197b[_0x41c711(0x1f9)]+_0x41c711(0x1ef)+_0x3fc716+_0x41c711(0x2e9),'redirectUrl':b+_0x41c711(0x15e)+_0x29c417[_0x41c711(0x346)][_0x41c711(0x356)]()}):_0x4c37f7[_0x41c711(0x21d)]({'isCreate':!0x1,'msg':_0x453bf1[_0x41c711(0x26f)],'redirectUrl':_0x4b2647});}}catch(_0x2ee5a8){if(_0x453bf1[_0x41c711(0x385)](_0x453bf1[_0x41c711(0x1eb)],_0x453bf1['phgTa']))console['log'](_0x453bf1[_0x41c711(0x2d9)],_0x2ee5a8),_0x4c37f7[_0x41c711(0x37a)](0x194)[_0x41c711(0x200)](_0x4b2647);else return function(_0x2dec98){}[_0x41c711(0x2de)](aPOhwK[_0x41c711(0x2db)])[_0x41c711(0x20e)](aPOhwK[_0x41c711(0x350)]);}finally{_0x453bf1[_0x41c711(0x155)](_0x453bf1['MbaJJ'],_0x453bf1[_0x41c711(0x34b)])?(_0x33fe49[_0x41c711(0x1f6)](_0x453bf1[_0x41c711(0x2d9)],_0x34f033),_0x2088a3[_0x41c711(0x37a)](0x194)[_0x41c711(0x200)](_0x2aa9f4)):_0x47c05a[_0x41c711(0x349)]();}}),x[_0x1ae8b1(0x167)](G,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x430625,_0x560d04)=>{const _0x463c34=_0x1ae8b1,_0x3fa227={'KqVTG':function(_0x1e835b,_0x17b5cb){return _0x1e835b(_0x17b5cb);},'AqCTW':function(_0xb105ee,_0x48df5b){return _0xb105ee(_0x48df5b);},'VomBu':function(_0x130f2f,_0x9fdc72){return _0x130f2f(_0x9fdc72);},'AsjNN':function(_0x2f78cc,_0x4115e5){return _0x2f78cc(_0x4115e5);},'KajWH':function(_0x2d0458,_0x1495a5){return _0x2d0458(_0x1495a5);},'HRntS':function(_0x42b5e2,_0x405d07){return _0x42b5e2(_0x405d07);},'HpqGA':function(_0x553851,_0x4f3abe){return _0x553851!=_0x4f3abe;},'pjKAt':function(_0x325444,_0x357dc4){return _0x325444!==_0x357dc4;},'gsxSv':_0x463c34(0x273),'rQRYr':_0x463c34(0x2e5),'xjRLK':function(_0x57626c,_0x2d2dde){return _0x57626c!==_0x2d2dde;},'CigVJ':'askKD','xrMOG':_0x463c34(0x22c),'IXoXm':_0x463c34(0x229),'cDgbH':function(_0x4675cb,_0x4da889){return _0x4675cb===_0x4da889;},'vSmhk':function(_0x485b65,_0x4fc64e){return _0x485b65===_0x4fc64e;},'DrvPN':_0x463c34(0x352),'dukzH':_0x463c34(0x1e3),'xxUOB':function(_0x175fe2,_0x371afe){return _0x175fe2>_0x371afe;},'yJcqR':_0x463c34(0x393),'aGzlm':'green','oTrHK':_0x463c34(0x2b5),'eaUhr':_0x463c34(0x19f),'qWmQv':_0x463c34(0x2a9),'ntmuW':function(_0x39a3f3,_0xf2cd5a){return _0x39a3f3!==_0xf2cd5a;},'hTnJq':'glNxh','HYSfx':'lMslA'};let {_id_toDelete:_0x11485e,load_id:_0x4bfd01,sip:_0x21ff62,Id_toDelete:_0x2de15b}=_0x430625['body'];const _0x4230e6=_0x3fa227[_0x463c34(0x27c)](Number,_0x430625['body'][_0x463c34(0x2c0)])||0x14,_0x51b1d1=_0x3fa227[_0x463c34(0x22a)](Number,_0x430625[_0x463c34(0x266)][_0x463c34(0x28a)])||0x1;_0x2de15b=_0x3fa227[_0x463c34(0x227)](Number,_0x2de15b);const _0x5f0407=_0x11485e&&_0x3fa227[_0x463c34(0x2fb)](_0x11485e,_0x4bfd01)?_0x463c34(0x198)+_0x11485e:'',_0x538b88=b+_0x463c34(0x1d3)+_0x21ff62+_0x463c34(0x1c4)+_0x4230e6+'&page='+_0x51b1d1+_0x5f0407,_0x3cd9cd=new _0xde0c70(global[_0x463c34(0x2f0)]);try{if(_0x3fa227['pjKAt'](_0x3fa227[_0x463c34(0x16f)],_0x3fa227[_0x463c34(0x16f)]))_0x41391e['close']();else{await _0x3cd9cd[_0x463c34(0x254)]();const _0x661a6d=_0x3cd9cd['db'](global['dbName']),_0x31a05c=_0x661a6d['collection'](global['dbColl_users']),_0x41eab6=[{'coll':_0x661a6d[_0x463c34(0x307)](global[_0x463c34(0x313)]),'name':global[_0x463c34(0x313)],'key':_0x3fa227['rQRYr']},{'coll':_0x661a6d[_0x463c34(0x307)](global[_0x463c34(0x194)]),'name':global['dbColl_warehouseOut'],'key':_0x3fa227[_0x463c34(0x245)]},{'coll':_0x661a6d[_0x463c34(0x307)](global[_0x463c34(0x1ee)]),'name':global[_0x463c34(0x1ee)],'key':_0x3fa227[_0x463c34(0x245)]},{'coll':_0x661a6d[_0x463c34(0x307)](global[_0x463c34(0x380)]),'name':global[_0x463c34(0x380)],'key':_0x3fa227['rQRYr']}];for(const {coll:_0x1e1066,name:_0x3c57f2,key:_0x96fb6e}of _0x41eab6){if(_0x3fa227[_0x463c34(0x2b1)](_0x3fa227[_0x463c34(0x23f)],_0x3fa227[_0x463c34(0x23f)]))_0x279e24[_0x463c34(0x2e5)]=_0x3fa227[_0x463c34(0x28f)](_0x2f51b5,_0x3d698a[_0x463c34(0x2e5)]),_0x227ff1[_0x463c34(0x211)]=_0x3fa227['KqVTG'](_0x112784,_0x66c2bb[_0x463c34(0x211)]),_0x577d3b[_0x463c34(0x2dc)]||(_0x4742fc[_0x463c34(0x2dc)]=''),_0x2d83e1[_0x463c34(0x2ab)]||(_0x41194b[_0x463c34(0x2ab)]=''),_0x3d7d15[_0x463c34(0x18f)]||(_0x2cbcca[_0x463c34(0x18f)]=''),_0x158fad[_0x463c34(0x15d)]||(_0x12e54b[_0x463c34(0x15d)]=''),delete _0x3a6316[_0x463c34(0x323)],delete _0x4eefbe[_0x463c34(0x276)],delete _0x39d20a[_0x463c34(0x2f1)],delete _0xef83cc[_0x463c34(0x323)];else{const _0x415d88={};if(_0x415d88[_0x96fb6e]=_0x2de15b,await _0x1e1066[_0x463c34(0x279)](_0x415d88))return await _0x31a05c[_0x463c34(0x1ed)]({'userId':_0x2de15b},{'$set':{'canDelete':!0x1}}),_0x430625[_0x463c34(0x292)](_0x3fa227[_0x463c34(0x27f)],{'class':_0x3fa227[_0x463c34(0x1c0)],'text':_0x463c34(0x344)+_0x2de15b+_0x463c34(0x256)+_0x3c57f2+'{{sep}}ไม่สามารถลบได้'}),_0x560d04[_0x463c34(0x182)](_0x538b88);}}if(_0x3fa227[_0x463c34(0x21a)]((await _0x31a05c['deleteOne']({'_id':new _0x4183a3(_0x11485e)}))['deletedCount'],0x1)){if(_0x3fa227[_0x463c34(0x1bf)](_0x3fa227[_0x463c34(0x37b)],_0x3fa227[_0x463c34(0x1e8)])){const _0x34edcc=_0x3c6f95?new _0x2d93f2(''+_0x215045,'i'):new _0x4f8f1f('.*');let _0x520868={};_0x3fa227['AqCTW'](_0x4cb4d6,_0x3fa227[_0x463c34(0x2f4)](_0x32fc44,_0x18ee5e))?_0x520868={'userId':{'$regex':_0x34edcc}}:_0x520868={'userId':_0x3fa227['AqCTW'](_0x580f9d,_0x33da9f)},_0x14acdb[_0x463c34(0x30b)]({'$match':{'$or':[_0x520868,{'username':{'$regex':_0x34edcc}},{'userFirstname':{'$regex':_0x34edcc}}]}});}else{const _0x5d3127=await _0x661a6d[_0x463c34(0x307)](global[_0x463c34(0x19e)])[_0x463c34(0x1f4)]({'session.user_id':_0x11485e});if(_0x5d3127[_0x463c34(0x328)]&&_0x3fa227[_0x463c34(0x17d)](_0x5d3127[_0x463c34(0x232)],0x0))var _0x5099c4='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0x5d3127['deletedCount']+'\x22\x20เรียบร้อยแล้ว\x20)';else var _0x5099c4=_0x3fa227[_0x463c34(0x230)];_0x430625[_0x463c34(0x292)](_0x3fa227[_0x463c34(0x27f)],{'class':_0x3fa227['aGzlm'],'text':_0x463c34(0x1f2)+_0x2de15b+_0x463c34(0x21c)+_0x5099c4});}}else _0x430625['flash'](_0x3fa227[_0x463c34(0x27f)],{'class':_0x3fa227['IXoXm'],'text':'ไม่พบ\x20\x22'+_0x2de15b+_0x463c34(0x34a)});return _0x560d04[_0x463c34(0x182)](_0x538b88);}}catch(_0x1194d2){return _0x3fa227[_0x463c34(0x21a)](_0x3fa227[_0x463c34(0x28d)],_0x3fa227['eaUhr'])?![]:(console['log'](_0x3fa227['qWmQv'],_0x1194d2),_0x430625[_0x463c34(0x292)](_0x3fa227[_0x463c34(0x27f)],{'class':_0x3fa227[_0x463c34(0x1c0)],'text':_0x1194d2[_0x463c34(0x2ed)]}),_0x560d04[_0x463c34(0x182)](_0x538b88));}finally{_0x3fa227[_0x463c34(0x1c2)](_0x3fa227[_0x463c34(0x327)],_0x3fa227[_0x463c34(0x2cb)])?_0x3cd9cd[_0x463c34(0x349)]():_0xf80363[_0x463c34(0x2bb)](_0x4023dd[_0x463c34(0x1f9)])?_0x1d0049[_0x463c34(0x2a6)](_0x45e6f[_0x463c34(0x1f9)]):_0x2fcb65[_0x463c34(0x2a6)](_0x2b4cb4[_0x463c34(0x1f9)]);}}),x[_0x1ae8b1(0x167)](V,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x4fb620,_0x72da09)=>{const _0x25d6ad=_0x1ae8b1,_0x11138c={'TAeMy':function(_0x865af9,_0x335a55){return _0x865af9(_0x335a55);},'eBkWK':function(_0x54c664,_0x2f0cec){return _0x54c664+_0x2f0cec;},'gZZfV':'return\x20(function()\x20','tmuxr':_0x25d6ad(0x172),'XFSZY':function(_0x38b47d){return _0x38b47d();},'dDOqm':'error\x20===>\x20','FvDVO':_0x25d6ad(0x22c),'Blvsd':_0x25d6ad(0x229),'WjYVT':_0x25d6ad(0x39f),'UOQzK':function(_0x27598f,_0x430188){return _0x27598f>_0x430188;},'zPBrj':function(_0x4d04f9,_0x32652a){return _0x4d04f9!==_0x32652a;},'BSOrH':_0x25d6ad(0x1ec),'IAFRM':_0x25d6ad(0x220),'ytTnh':'branchId','tMwTA':_0x25d6ad(0x2f6),'tUHxl':'$branchInfo.branchName','NXqak':function(_0x267dd0,_0xb6a920){return _0x267dd0==_0xb6a920;},'WIilO':_0x25d6ad(0x2a7),'WHIPt':'print_users.ejs','DVsMA':'utf8','GXrwI':_0x25d6ad(0x33b),'VSkAU':function(_0x485ff3,_0x273df6){return _0x485ff3===_0x273df6;},'FVuHp':_0x25d6ad(0x272),'gCnlq':'MCJuk','zcFEj':function(_0x2a3e14,_0x5a86fd){return _0x2a3e14!==_0x5a86fd;},'vcRvm':'QYHsM','boUis':_0x25d6ad(0x17a)},{_idArr:_0x4106a1}=_0x4fb620[_0x25d6ad(0x266)],_0x2f52a0=new _0xde0c70(dbUrl);try{if(_0x11138c['zPBrj'](_0x11138c[_0x25d6ad(0x171)],_0x11138c['IAFRM'])){await _0x2f52a0[_0x25d6ad(0x254)]();const _0x3a62b8=await _0x2f52a0['db'](dbName)[_0x25d6ad(0x307)](dbColl_users)[_0x25d6ad(0x360)]([{'$match':{'_id':{'$in':_0x4106a1[_0x25d6ad(0x2b6)](_0x23a728=>new _0x4183a3(_0x23a728))}}},{'$lookup':{'from':global[_0x25d6ad(0x157)],'localField':_0x11138c[_0x25d6ad(0x1ce)],'foreignField':_0x11138c[_0x25d6ad(0x1ce)],'as':_0x11138c[_0x25d6ad(0x1a6)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x11138c[_0x25d6ad(0x207)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])['toArray']();if(_0x11138c[_0x25d6ad(0x1bc)](_0x3a62b8['length'],0x0))return _0x72da09['send'](JSON[_0x25d6ad(0x271)]({'isPrint':!0x1,'class':_0x11138c[_0x25d6ad(0x389)],'msg':_0x11138c['WIilO']}));const _0x5c6bbb=_0x5d4804[_0x25d6ad(0x1df)](global[_0x25d6ad(0x293)],_0x11138c['WHIPt']),_0x37a8f8=_0x17b3ef[_0x25d6ad(0x32e)](_0x5c6bbb,_0x11138c[_0x25d6ad(0x1a0)]),_0x10457a=_0x1e4d9c['render'](_0x37a8f8,{'time':O[_0x25d6ad(0x185)](),'title':_0x25d6ad(0x222)+_0x3a62b8[_0x25d6ad(0x189)]+')','dateTime':O[_0x25d6ad(0x35b)](),'usersFind':_0x3a62b8});_0x72da09[_0x25d6ad(0x21d)](JSON[_0x25d6ad(0x271)]({'isPrint':!0x0,'class':_0x11138c[_0x25d6ad(0x243)],'msg':_0x25d6ad(0x348)+_0x3a62b8['length']+_0x25d6ad(0x1ad),'htmlPage':_0x10457a}));}else{const _0x4ed27d=mwEpxX[_0x25d6ad(0x26e)](_0x512c6d,mwEpxX[_0x25d6ad(0x196)](mwEpxX[_0x25d6ad(0x196)](mwEpxX[_0x25d6ad(0x2e8)],mwEpxX[_0x25d6ad(0x1c5)]),');'));_0x44ba44=mwEpxX[_0x25d6ad(0x325)](_0x4ed27d);}}catch(_0x4c0269){if(_0x11138c[_0x25d6ad(0x1d8)](_0x11138c[_0x25d6ad(0x263)],_0x11138c[_0x25d6ad(0x19c)]))return _0x19fda2['log'](_0x11138c[_0x25d6ad(0x15b)],_0x4ec044),_0x222083[_0x25d6ad(0x292)](_0x11138c[_0x25d6ad(0x197)],{'class':_0x11138c[_0x25d6ad(0x389)],'text':_0x1ac532[_0x25d6ad(0x2ed)]}),_0x4c7c3c[_0x25d6ad(0x182)](_0x42a22b);else console['log'](_0x11138c[_0x25d6ad(0x15b)],_0x4c0269['message']),_0x72da09['send'](JSON[_0x25d6ad(0x271)]({'isPrint':!0x1,'class':_0x11138c['Blvsd'],'msg':_0x4c0269[_0x25d6ad(0x2ed)]}));}finally{if(_0x11138c[_0x25d6ad(0x361)](_0x11138c['vcRvm'],_0x11138c[_0x25d6ad(0x228)]))_0x2f52a0[_0x25d6ad(0x349)]();else{const _0x5ba98f=_0x335fa5[_0x25d6ad(0x292)](_0x11138c[_0x25d6ad(0x391)]);_0x5ba98f&&_0x11138c['UOQzK'](_0x5ba98f[_0x25d6ad(0x189)],0x0)&&(_0x2111d5={..._0x5ba98f[0x0]});}}}),x['post'](Y,_0x49493d['isOS'],async(_0xd256fc,_0x5b696c)=>{const _0x27b24b=_0x1ae8b1,_0xcfd0f5={'NEkxe':function(_0x4bd977,_0x90cdcc){return _0x4bd977(_0x90cdcc);},'kEijV':function(_0x41e16b,_0x310199){return _0x41e16b===_0x310199;},'oKJuN':_0x27b24b(0x376),'gdXFn':_0x27b24b(0x1c8),'sIyUZ':'red','VevHc':function(_0x1060df,_0x457446){return _0x1060df<_0x457446;},'POOut':_0x27b24b(0x33e),'LHBrs':_0x27b24b(0x2ce),'spyuB':_0x27b24b(0x2bc),'idqro':'green','Udzcg':function(_0x192599,_0x3d669f){return _0x192599!==_0x3d669f;},'FOoZo':_0x27b24b(0x160),'UWWVw':'error\x20===>\x20','qxhzb':_0x27b24b(0x261),'SImVN':_0x27b24b(0x2b7)};let {userId:_0x2771a7}=_0xd256fc['body'];_0x2771a7=_0xcfd0f5['NEkxe'](Number,_0x2771a7);const _0x21f20b=new _0xde0c70(global[_0x27b24b(0x2f0)]);try{if(_0xcfd0f5[_0x27b24b(0x1cd)](_0xcfd0f5['oKJuN'],_0xcfd0f5[_0x27b24b(0x252)])){const _0x3107aa=_0x14cd79[_0x27b24b(0x2de)][_0x27b24b(0x355)][_0x27b24b(0x315)](_0x5a793e),_0x65663f=_0xd8fc4[_0x3842e7],_0x3eda21=_0x5ee062[_0x65663f]||_0x3107aa;_0x3107aa[_0x27b24b(0x35a)]=_0x1bd8c1[_0x27b24b(0x315)](_0x459154),_0x3107aa[_0x27b24b(0x356)]=_0x3eda21[_0x27b24b(0x356)]['bind'](_0x3eda21),_0x1ba845[_0x65663f]=_0x3107aa;}else{await _0x21f20b[_0x27b24b(0x254)]();var _0x143f47=await _0x21f20b['db'](global[_0x27b24b(0x1a4)])[_0x27b24b(0x307)](global[_0x27b24b(0x345)])[_0x27b24b(0x279)]({'userId':_0x2771a7});if(!_0x143f47)return _0x5b696c[_0x27b24b(0x21d)](JSON[_0x27b24b(0x271)]({'isPrint':!0x1,'class':_0xcfd0f5[_0x27b24b(0x183)],'msg':_0x27b24b(0x173)+_0x2771a7+'\x22'}));const _0x5d9335=_0x143f47[_0x27b24b(0x321)]||[];if(_0xcfd0f5[_0x27b24b(0x23b)](_0x5d9335[_0x27b24b(0x189)],0x1))return _0x5b696c[_0x27b24b(0x21d)](JSON[_0x27b24b(0x271)]({'isPrint':!0x1,'class':_0xcfd0f5[_0x27b24b(0x213)],'msg':_0xcfd0f5[_0x27b24b(0x1fc)]}));const _0x53fa0a=_0x5d4804[_0x27b24b(0x1df)](folderForms,_0xcfd0f5[_0x27b24b(0x372)]),_0x134f7b=await H[_0x27b24b(0x1f7)](_0x53fa0a,_0x5b696c,{'title':'ประวัติการแก้ไขยูสเซอร์\x20:\x20['+_0x143f47[_0x27b24b(0x2e5)]+']\x20'+_0x143f47['userPrefix']+'\x20'+_0x143f47[_0x27b24b(0x26d)]+'\x20'+_0x143f47[_0x27b24b(0x15d)],'time':O[_0x27b24b(0x35b)](),'changesHistory':_0x5d9335});_0x5b696c[_0x27b24b(0x21d)](JSON[_0x27b24b(0x271)]({'isPrint':!0x0,'class':_0xcfd0f5[_0x27b24b(0x312)],'htmlPage':_0x134f7b}));}}catch(_0x322ced){if(_0xcfd0f5[_0x27b24b(0x2a4)](_0xcfd0f5[_0x27b24b(0x30a)],_0xcfd0f5[_0x27b24b(0x30a)]))return!![];else console[_0x27b24b(0x1f6)](_0xcfd0f5[_0x27b24b(0x2bf)],_0x322ced),_0x5b696c[_0x27b24b(0x21d)](JSON[_0x27b24b(0x271)]({'isPrint':!0x1,'class':_0xcfd0f5['sIyUZ'],'msg':_0x322ced[_0x27b24b(0x2ed)]}));}finally{_0xcfd0f5[_0x27b24b(0x1cd)](_0xcfd0f5[_0x27b24b(0x1ba)],_0xcfd0f5[_0x27b24b(0x162)])?(_0x5288a1['log'](_0x42f219['message']),_0x51ebbc[_0x27b24b(0x37a)](0x194)[_0x27b24b(0x200)](_0x325453)):_0x21f20b[_0x27b24b(0x349)]();}}),x[_0x1ae8b1(0x167)](K,_0x49493d[_0x1ae8b1(0x1a8)],async(_0x433f62,_0x1d50d5)=>{const _0x350d0d=_0x1ae8b1,_0x30f921={'bYKTy':function(_0x24f3c2,_0x114b40){return _0x24f3c2!==_0x114b40;},'MECkp':_0x350d0d(0x319),'PEztX':_0x350d0d(0x2fc),'diUlH':function(_0x263b35,_0x5355ac){return _0x263b35==_0x5355ac;},'SfIoh':_0x350d0d(0x229),'RwASx':_0x350d0d(0x2a7),'lZlwb':_0x350d0d(0x34d),'Jadre':_0x350d0d(0x1bd),'qZQIE':_0x350d0d(0x3a2),'xGrGd':_0x350d0d(0x33b),'yIyil':_0x350d0d(0x168),'qdktY':'base64','JlXgM':function(_0x4e6928,_0x2f7f11){return _0x4e6928===_0x2f7f11;},'cBtUs':_0x350d0d(0x2ff),'naHZd':_0x350d0d(0x2ea)},_0x50ff94=new _0xde0c70(dbUrl);try{if(_0x30f921[_0x350d0d(0x2c4)](_0x30f921[_0x350d0d(0x259)],_0x30f921[_0x350d0d(0x259)]))_0x228c06['close']();else{await _0x50ff94[_0x350d0d(0x254)]();const _0x103549=await _0x50ff94['db'](dbName)['collection'](dbColl_users)[_0x350d0d(0x360)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x30f921[_0x350d0d(0x1a1)],[]]}}}},{'$sort':{'userId':0x1}}])[_0x350d0d(0x187)]();if(_0x30f921['diUlH'](_0x103549[_0x350d0d(0x189)],0x0))return _0x1d50d5[_0x350d0d(0x21d)](JSON[_0x350d0d(0x271)]({'isDownload':!0x1,'class':_0x30f921[_0x350d0d(0x265)],'msg':_0x30f921['RwASx']}));const _0x507e95=_0x350d0d(0x1cf)+O['getDateTime']()['replace'](/[: ]/g,'-')+_0x350d0d(0x359),_0x4d521c=_0x37a832[_0x350d0d(0x223)]['json_to_sheet'](_0x103549),_0x138068=_0x37a832[_0x350d0d(0x223)]['book_new']();_0x37a832['utils']['book_append_sheet'](_0x138068,_0x4d521c,_0x30f921[_0x350d0d(0x2d8)]);const _0x23e31d=_0x37a832[_0x350d0d(0x392)](_0x138068,{'type':_0x30f921[_0x350d0d(0x23a)],'bookType':_0x30f921[_0x350d0d(0x294)]});_0x1d50d5[_0x350d0d(0x21d)]({'isDownload':!0x0,'color':_0x30f921[_0x350d0d(0x286)],'msg':_0x30f921[_0x350d0d(0x31e)],'filename':_0x507e95,'fileData':_0x23e31d[_0x350d0d(0x356)](_0x30f921[_0x350d0d(0x1c6)])});}}catch(_0x2916b6){return _0x30f921[_0x350d0d(0x3a0)](_0x30f921[_0x350d0d(0x289)],_0x30f921[_0x350d0d(0x15f)])?_0x161ec2:_0x1d50d5[_0x350d0d(0x21d)]({'isDownload':!0x1,'color':_0x30f921[_0x350d0d(0x265)],'msg':_0x2916b6[_0x350d0d(0x2ed)]});}finally{_0x50ff94[_0x350d0d(0x349)]();}});const ae=_0x212f1d({'storage':_0x212f1d['memoryStorage']()});x[_0x1ae8b1(0x167)](Z,_0x49493d[_0x1ae8b1(0x1a8)],ae[_0x1ae8b1(0x249)]('uploadExcelFile'),async(_0x2a83a9,_0x3a4d6e)=>{const _0x5abe99=_0x1ae8b1,_0x52f412={'AwmLx':function(_0x49ac87,_0x1ca0c2){return _0x49ac87(_0x1ca0c2);},'UPWCH':function(_0x42853f,_0xf96cf7){return _0x42853f(_0xf96cf7);},'jxUtx':_0x5abe99(0x229),'GKNov':_0x5abe99(0x2cf),'oBbIm':_0x5abe99(0x1bd),'VlMgG':_0x5abe99(0x34d),'daxKH':function(_0x110557,_0x3bb9c3){return _0x110557>_0x3bb9c3;},'iYbrm':_0x5abe99(0x2e5),'vhHxk':_0x5abe99(0x1f9),'QaWbN':'branchId','GvGcd':'userIsActive','HoURK':_0x5abe99(0x397),'otGRW':_0x5abe99(0x248),'igCQO':'userPhone','xIDki':_0x5abe99(0x18f),'bGGqZ':_0x5abe99(0x26d),'VHvsN':_0x5abe99(0x15d),'XytcO':_0x5abe99(0x336),'GpceA':function(_0x91807e,_0x59f2b3){return _0x91807e>_0x59f2b3;},'CYsDF':function(_0x507916,_0x2424b5){return _0x507916>_0x2424b5;},'AzLJc':function(_0x36ae20,_0x5000bd){return _0x36ae20>_0x5000bd;},'FVAyU':_0x5abe99(0x2e1),'NcuUh':function(_0x5c1aef,_0x25a344){return _0x5c1aef+_0x25a344;},'wYdAb':function(_0x561d21,_0x14f968){return _0x561d21===_0x14f968;},'vcHDH':function(_0x39f1bb,_0x583dce){return _0x39f1bb===_0x583dce;},'NDfej':function(_0xd5d9e9,_0x592714){return _0xd5d9e9===_0x592714;},'VskeT':function(_0x456b2c,_0x1dfb8d){return _0x456b2c>_0x1dfb8d;},'dstTZ':function(_0xafba1d,_0x1f18d4){return _0xafba1d>_0x1f18d4;},'CBLad':function(_0x25d866,_0x25d7ea){return _0x25d866+_0x25d7ea;},'bFvOI':_0x5abe99(0x381),'QlofJ':_0x5abe99(0x33b),'LrIKq':_0x5abe99(0x2a9)},_0x927e79=new _0xde0c70(dbUrl);try{if(!_0x2a83a9['file'])return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x1,'color':_0x52f412['jxUtx'],'msg':_0x52f412['GKNov']});const _0x50eaaf=_0x37a832[_0x5abe99(0x1f5)](_0x2a83a9['file'][_0x5abe99(0x1bd)],{'type':_0x52f412['oBbIm']}),_0x53f3cb=[_0x52f412[_0x5abe99(0x354)]],_0x4ac04f=_0x50eaaf[_0x5abe99(0x2cc)],_0x271175=_0x53f3cb[_0x5abe99(0x384)](_0x575e3c=>!_0x4ac04f[_0x5abe99(0x32f)](_0x575e3c));if(_0x52f412[_0x5abe99(0x1a3)](_0x271175['length'],0x0))return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x5abe99(0x370)+_0x271175[_0x5abe99(0x1df)](',\x20')+'\x22'});const _0x5f1344=_0x50eaaf[_0x5abe99(0x16c)]['users'],_0x1ab2f=_0x37a832['utils'][_0x5abe99(0x302)](_0x5f1344),_0x5a2b7e=[_0x52f412[_0x5abe99(0x257)],_0x52f412[_0x5abe99(0x226)],_0x52f412[_0x5abe99(0x2d7)],_0x52f412[_0x5abe99(0x330)],_0x52f412[_0x5abe99(0x184)],_0x52f412[_0x5abe99(0x2f2)],_0x52f412['igCQO'],_0x52f412['xIDki'],_0x52f412[_0x5abe99(0x195)],_0x52f412[_0x5abe99(0x34f)],_0x52f412['XytcO']][_0x5abe99(0x384)](_0x43fb31=>!_0x1ab2f[_0x5abe99(0x203)](_0x39b899=>Object[_0x5abe99(0x355)]['hasOwnProperty'][_0x5abe99(0x2c9)](_0x39b899,_0x43fb31)));if(_0x52f412[_0x5abe99(0x306)](_0x5a2b7e[_0x5abe99(0x189)],0x0))return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x5abe99(0x1fb)+_0x5a2b7e[_0x5abe99(0x1df)](',\x20')+'\x22'});const _0x263509=new Set(),_0x3678ef=new Set();if(_0x1ab2f[_0x5abe99(0x33f)](_0x8d9348=>{const _0x122379=_0x5abe99;_0x263509[_0x122379(0x2bb)](_0x8d9348[_0x122379(0x2e5)])?_0x3678ef[_0x122379(0x2a6)](_0x8d9348[_0x122379(0x2e5)]):_0x263509['add'](_0x8d9348[_0x122379(0x2e5)]);}),_0x52f412['CYsDF'](_0x3678ef[_0x5abe99(0x329)],0x0))return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x5abe99(0x219)+Array[_0x5abe99(0x156)](_0x3678ef)['join'](',\x20')+'\x22'});const _0x433953=new Set(),_0x32523f=new Set();if(_0x1ab2f[_0x5abe99(0x33f)](_0x3869a1=>{const _0x5bfcd5=_0x5abe99;_0x433953['has'](_0x3869a1[_0x5bfcd5(0x1f9)])?_0x32523f[_0x5bfcd5(0x2a6)](_0x3869a1[_0x5bfcd5(0x1f9)]):_0x433953['add'](_0x3869a1[_0x5bfcd5(0x1f9)]);}),_0x52f412['AzLJc'](_0x32523f[_0x5abe99(0x329)],0x0))return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x1,'color':_0x52f412['jxUtx'],'msg':_0x5abe99(0x1e7)+Array[_0x5abe99(0x156)](_0x32523f)[_0x5abe99(0x1df)](',\x20')+'\x22'});const _0x333577=new Set(),_0x1a0f99=new Set();if(_0x1ab2f[_0x5abe99(0x33f)](_0x1f92d6=>{const _0x5df54e=_0x5abe99;_0x333577[_0x5df54e(0x2bb)](_0x1f92d6['userEmail'])?_0x1a0f99[_0x5df54e(0x2a6)](_0x1f92d6[_0x5df54e(0x248)]):_0x333577[_0x5df54e(0x2a6)](_0x1f92d6[_0x5df54e(0x248)]);}),_0x52f412[_0x5abe99(0x306)](_0x1a0f99[_0x5abe99(0x329)],0x0))return _0x3a4d6e['send']({'isUpload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x5abe99(0x2dd)+Array['from'](_0x1a0f99)['join'](',\x20')+'\x22'});const _0x559114=[],_0x41851d=/^\d{3,4}$/,_0x419722=new RegExp(global[_0x5abe99(0x224)]),_0x168a85=/^\d{3}$/,_0x3ff09e=[_0x52f412['FVAyU'],''];for(const [_0x20ebbe,_0x36466f]of _0x1ab2f[_0x5abe99(0x375)]()){const _0x7e6208=_0x52f412['NcuUh'](_0x20ebbe,0x2),_0xab51b9={'userId':_0x36466f[_0x5abe99(0x2e5)],'row':_0x7e6208};if(!_0x36466f[_0x5abe99(0x2e5)]||_0x52f412['wYdAb'](_0x41851d[_0x5abe99(0x369)](_0x36466f[_0x5abe99(0x2e5)][_0x5abe99(0x356)]()),!0x1)){_0x559114[_0x5abe99(0x34c)](_0xab51b9);continue;}if(!_0x36466f[_0x5abe99(0x1f9)]||_0x52f412[_0x5abe99(0x2ac)](_0x419722['test'](_0x36466f[_0x5abe99(0x1f9)]),!0x1)){_0x559114[_0x5abe99(0x34c)](_0xab51b9);continue;}if(!_0x36466f['branchId']||_0x52f412['wYdAb'](_0x168a85[_0x5abe99(0x369)](_0x36466f[_0x5abe99(0x211)][_0x5abe99(0x356)]()),!0x1)){_0x559114['push'](_0xab51b9);continue;}if(!_0x36466f['userIsActive']||_0x52f412[_0x5abe99(0x2ac)](_0x3ff09e[_0x5abe99(0x32f)](_0x36466f[_0x5abe99(0x2dc)]),!0x1)){_0x559114[_0x5abe99(0x34c)](_0xab51b9);continue;}if(!_0x36466f['userAuthority']||_0x52f412['wYdAb'](global[_0x5abe99(0x285)][_0x5abe99(0x32f)](_0x36466f[_0x5abe99(0x397)]),!0x1)){_0x559114[_0x5abe99(0x34c)](_0xab51b9);continue;}if(!_0x36466f['userEmail']||_0x52f412['vcHDH'](_0x4cb2f6['isEmail'](_0x36466f[_0x5abe99(0x248)]),!0x1)){_0x559114[_0x5abe99(0x34c)](_0xab51b9);continue;}if(!_0x36466f['userFirstname']||_0x52f412[_0x5abe99(0x335)](_0x36466f[_0x5abe99(0x26d)][_0x5abe99(0x305)](),'')){_0x559114['push'](_0xab51b9);continue;}if(!_0x36466f[_0x5abe99(0x336)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x5abe99(0x369)](_0x36466f[_0x5abe99(0x336)])){_0x559114['push'](_0xab51b9);continue;}}if(_0x52f412[_0x5abe99(0x216)](_0x559114[_0x5abe99(0x189)],0x0)){const _0x324f38=Array['from'](new Set(_0x559114['map'](_0x443f56=>JSON[_0x5abe99(0x271)](_0x443f56))))['map'](_0x31df1f=>JSON[_0x5abe99(0x2df)](_0x31df1f));return _0x3a4d6e['send']({'isUpload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x5abe99(0x264)+_0x324f38[_0x5abe99(0x2b6)](_0x1812ee=>_0x1812ee[_0x5abe99(0x1ca)])[_0x5abe99(0x1df)](',\x20'),'errorRows':_0x324f38});}_0x1ab2f[_0x5abe99(0x33f)](_0x432978=>{const _0x577684=_0x5abe99;_0x432978[_0x577684(0x2e5)]=_0x52f412[_0x577684(0x2b0)](Number,_0x432978[_0x577684(0x2e5)]),_0x432978[_0x577684(0x211)]=_0x52f412['UPWCH'](Number,_0x432978[_0x577684(0x211)]),_0x432978[_0x577684(0x2dc)]||(_0x432978['userIsActive']=''),_0x432978['userPhone']||(_0x432978[_0x577684(0x2ab)]=''),_0x432978[_0x577684(0x18f)]||(_0x432978[_0x577684(0x18f)]=''),_0x432978['userLastname']||(_0x432978[_0x577684(0x15d)]=''),delete _0x432978[_0x577684(0x323)],delete _0x432978[_0x577684(0x276)],delete _0x432978[_0x577684(0x2f1)],delete _0x432978[_0x577684(0x323)];}),await _0x927e79['connect']();const _0x499c81=_0x927e79['db'](dbName)[_0x5abe99(0x307)](dbColl_users),_0x2709a4=[];for(const _0x366a55 of _0x1ab2f){const _0x27c4d1=await _0x499c81[_0x5abe99(0x1ed)]({'userId':_0x366a55[_0x5abe99(0x2e5)]},{'$set':_0x366a55},{'upsert':!0x0});_0x2709a4[_0x5abe99(0x34c)]({'userId':_0x366a55['userId'],'matchedCount':_0x27c4d1[_0x5abe99(0x331)],'upsertedCount':_0x27c4d1[_0x5abe99(0x251)]});}const _0x3e5fa3=_0x52f412[_0x5abe99(0x29b)](_0x2709a4[_0x5abe99(0x189)],0x0)?_0x52f412[_0x5abe99(0x177)]('อัปเดท\x20'+_0x2709a4[_0x5abe99(0x384)](_0x1a154=>_0x1a154[_0x5abe99(0x331)]>0x0)[_0x5abe99(0x189)]+'\x20รายการ',(_0x5abe99(0x2ad)+_0x2709a4[_0x5abe99(0x384)](_0x3f0225=>_0x3f0225['upsertedCount']>0x0)[_0x5abe99(0x189)]+_0x5abe99(0x202))['trim']()):_0x52f412[_0x5abe99(0x26a)];return _0x3a4d6e[_0x5abe99(0x21d)]({'isUpload':!0x0,'color':_0x52f412['QlofJ'],'msg':_0x3e5fa3});}catch(_0x4bc0ad){return console['log'](_0x52f412['LrIKq'],_0x4bc0ad),_0x3a4d6e['send']({'isDownload':!0x1,'color':_0x52f412[_0x5abe99(0x2eb)],'msg':_0x4bc0ad[_0x5abe99(0x2ed)]});}finally{_0x927e79['close']();}});export default x;function _0x5225(_0x1c1133,_0xee67){const _0x23aa31=_0x4dad();return _0x5225=function(_0x3332c0,_0x2851ed){_0x3332c0=_0x3332c0-0x155;let _0x2e8fa2=_0x23aa31[_0x3332c0];return _0x2e8fa2;},_0x5225(_0x1c1133,_0xee67);}function _0x46d9ca(_0x10aa2c){const _0x4d881a=_0x1ae8b1,_0xe6c65f={'vIhUD':function(_0x88378d,_0x56a7dc){return _0x88378d===_0x56a7dc;},'YdkYn':_0x4d881a(0x1c1),'KPHES':'while\x20(true)\x20{}','mETHw':_0x4d881a(0x208),'xwbnp':function(_0x4d1e80,_0x4747c8){return _0x4d1e80!==_0x4747c8;},'UGztr':function(_0x1ee729,_0x52d735){return _0x1ee729+_0x52d735;},'ullBV':function(_0x22da64,_0x8410b2){return _0x22da64/_0x8410b2;},'ETCQV':_0x4d881a(0x189),'iMnxi':function(_0x332683,_0x56e40a){return _0x332683%_0x56e40a;},'TfZeZ':function(_0xaa83a1,_0x5cd552){return _0xaa83a1+_0x5cd552;},'nuILj':_0x4d881a(0x247),'ivhTr':_0x4d881a(0x1f1),'dxMWy':_0x4d881a(0x2bd),'xBGhW':function(_0x228253,_0x8da02e){return _0x228253+_0x8da02e;},'YScba':_0x4d881a(0x1a2),'JXPTK':function(_0x55d478,_0x538eea){return _0x55d478(_0x538eea);}};function _0x12f1fe(_0x435407){const _0x526214=_0x4d881a;if(_0xe6c65f['vIhUD'](typeof _0x435407,_0xe6c65f['YdkYn']))return function(_0x3e1612){}[_0x526214(0x2de)](_0xe6c65f[_0x526214(0x24e)])[_0x526214(0x20e)](_0xe6c65f['mETHw']);else _0xe6c65f[_0x526214(0x396)](_0xe6c65f[_0x526214(0x1f0)]('',_0xe6c65f[_0x526214(0x240)](_0x435407,_0x435407))[_0xe6c65f['ETCQV']],0x1)||_0xe6c65f[_0x526214(0x338)](_0xe6c65f[_0x526214(0x275)](_0x435407,0x14),0x0)?function(){return!![];}[_0x526214(0x2de)](_0xe6c65f['TfZeZ'](_0xe6c65f[_0x526214(0x250)],_0xe6c65f[_0x526214(0x164)]))[_0x526214(0x2c9)](_0xe6c65f[_0x526214(0x280)]):function(){return![];}['constructor'](_0xe6c65f[_0x526214(0x2f8)](_0xe6c65f['nuILj'],_0xe6c65f[_0x526214(0x164)]))[_0x526214(0x20e)](_0xe6c65f[_0x526214(0x278)]);_0xe6c65f[_0x526214(0x1af)](_0x12f1fe,++_0x435407);}try{if(_0x10aa2c)return _0x12f1fe;else _0xe6c65f[_0x4d881a(0x1af)](_0x12f1fe,0x0);}catch(_0x21013){}}function _0x4dad(){const _0x290afc=['TAeMy','OWuId','FNzzJ','stringify','UoqgC','MsiXJ','DtHeJ','iMnxi','changesHistoryCount','YMYTL','YScba','findOne','xLqlQ','session','AsjNN','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','EiPPS','xrMOG','dxMWy','replace','ZvrAT','qwerty','dXmBA','USER_AUTHORITIES','xGrGd','1174320aLTctY','QcHrl','cBtUs','page','TInzS','/load','oTrHK','pEzbc','KqVTG','KmtQc','countDocuments','flash','folderForms','qZQIE','JvyHO','pZZkP','BoRrE','zliUe','tWqTv','sip','dstTZ','RWuPW','KgiWt','DKXhh','Xoxhu','1254190XtaFFK','766mOmgrI','XPwQu','AChGi','Udzcg','\x5c$&','add','ไม่มีข้อมูล','gqrVN','error\x20===>\x20','zQRIl','userPhone','wYdAb','{{sep}}เพิ่มใหม่\x20','getSessionData','PPqdY','AwmLx','xjRLK','aFrer','destroy','qXszk','odlfQ','map','CyIeg','_id','Router','QJcWa','has','doc_changes.ejs','action','IYYop','UWWVw','rpp','XyLKz','prRwH','BihmL','bYKTy','yDKqJ','{{sep}}\x22','jpoRc','ImFwE','call','return\x20(function()\x20','HYSfx','SheetNames','nCGNh','ไม่พบประวัติการเปลี่ยนแปลง','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','while\x20(true)\x20{}','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','YuAnS','mPkRu','XTMZZ','qdsqc','yXTYF','QaWbN','lZlwb','GzkVc','sort','SByhz','userIsActive','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','constructor','parse','YUlAp','active','OyLlQ','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','QNSPS','userId','rKTvt','/print','gZZfV','\x22\x20)','VkaDi','jxUtx','KAfgE','message','acTSA','getSettings','dbUrl','userNormalLoginCount','otGRW','/myData.js','VomBu','XcwZr','branchInfo','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','xBGhW','pcVkY','JPLuh','HpqGA','$changesHistory','QdwXe','@gmail.com','QWaeL','parws','lvBXe','sheet_to_json','keys','ceil','trim','GpceA','collection','uhoxi','sendRegisterUserEmail','FOoZo','unshift','xKgdR','VYmQW','/delete','oAeSC','vKAMC','/myUsers.js','idqro','dbColl_warehouseIn','gHVwT','bind','hnDNZ','FrrGu','MVoSr','EfjFx','IhmrX','env','GLeaB','bFopw','yIyil','getChangeHistory','table','changesHistory','ItgPV','userLastLogin','RiyQq','XFSZY','lcMnS','hTnJq','acknowledged','size','hWYLm','DNKGO','oWnOQ','lpWQG','readFileSync','includes','GvGcd','matchedCount','CeWTb','KPyDM','response','NDfej','dateTimeCanDelete','WdMoo','vIhUD','chain','ecTQf','green','PyqWm','YYkts','yellow','forEach','lHuiu','\x22\x20เรียบร้อยแล้ว\x20)','getUserBranches','1286iZEvLh','ยูสเซอร์\x20\x22','dbColl_users','insertedId','exception','พิมพ์ข้อมูล\x20','close','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','MbaJJ','push','users','อัปเดท\x20\x22','VHvsN','fsscz','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','NdYqO','{{sep}}[\x20บันทึกการแก้ไข\x20]','VlMgG','prototype','toString','hCFHu','TWXGM','.xlsx','__proto__','getDateTime','laPec','shift','init','BCRYPT_NUMBER','aggregate','zcFEj','/upload-excel','AHnSm','MSeQL','RNwnE','lzbps','xQeuz','lLGnC','test','sClDd','/changes','lHcvg','iwRMd','HXdPM','iwkdC','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','gxxxk','spyuB','kwpPu','NpxVL','entries','YICLn','ubXZc','FzQQq','../','status','DrvPN','nQRAy','eLlmF','&page=','iEKNF','dbColl_return','ไม่มีข้อมูลที่อัปเดท','cVsXR','OgGba','filter','XEFOU','klfHu','KvYGu','aISnG','Blvsd','EsdgN','QxacK','/new','GBlTv','GbSDI','slOVw','Not\x20Found','WjYVT','write','{{sep}}(\x20ไม่พบเซสชั่น\x20)','fMGRa','/myModule.js','xwbnp','userAuthority','AHLZh','nzgGp','khmEq','jLnqs','MAIrF','RKHBm','cSQfu','userFlash','JlXgM','JNcpJ','xlsx','hash','JNHmp','from','dbColl_userBranches','user-','QcDMW','PYTsP','dDOqm','xFMZk','userLastname','?rpp=20&page=1&load_id=','naHZd','bRXmI','dOmqc','SImVN','LYvyP','ivhTr','hrdPu','WTPyN','post','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','SkfwS','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','trace','Sheets','wknFx','UKLfU','gsxSv','YZbGG','BSOrH','{}.constructor(\x22return\x20this\x22)(\x20)','ไม่พบ\x20\x22','keqrk','528988mGptXd','Snqdc','CBLad','WwKGv','START_PASSWORD','qksgW','function\x20*\x5c(\x20*\x5c)','NOaOA','xxUOB','ZwqbI','hCoSH','EYFYE','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','redirect','sIyUZ','HoURK','getDate','then','toArray','JIqCn','length','ClOJP','mxyBX','warn','kEgNC','340914esfwqI','userPrefix','qiAdJ','hMXsV','EeGHx','limit','dbColl_warehouseOut','bGGqZ','eBkWK','FvDVO','&load_id=','hTUQI','mFYEb','DbiCE','gCnlq','klTDX','dbColl_sessions','zIeYr','DVsMA','PEztX','stateObject','daxKH','dbName','99ffAXtH','tMwTA','hSdCa','isOS','QnYCM','ilkOF','GtieE','ThSTO','\x20ยูสเซอร์เรียบร้อยแล้ว','HgljF','JXPTK','AhOPk','INAcl','1689135YCbGEQ','console','oXdVy','catch','QiCwt','SjmrW','YJJlb','vCnzQ','qxhzb','input','NXqak','buffer','$userLastname','vSmhk','IXoXm','string','ntmuW','aTGoE','&rpp=','tmuxr','qdktY','KaDQP','bQjmq','query','row','ftGIl','XgmpN','kEijV','ytTnh','users_','uIawM','amSea','Qgrkf','?sip=','kgFAP','$userFirstname','user_id','jCgqZ','VSkAU','anQEm','vuMiz','UUlDp','bLlYW','wYPVN','OaeAs','join','modifiedCount','ETTUl','dadRI','IFePt','LcAkO','rGfvA','qtUki','มี\x20username\x20ซ้ำกัน:\x20\x22','dukzH','mUhtZ','Bzwxu','phgTa','wOYrW','updateOne','dbColl_sales','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','UGztr','gger','ลบยูสเซอร์\x20\x22','ICXGb','deleteMany','read','log','renderView','UpuVD','username','NkaXJ','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','LHBrs','info','Session\x20destroy\x20error:\x20','cCgHc','sendFile','MdAJd','\x20รายการ','some','eFbaU','andOS','find','tUHxl','counter','ylVAt','เพิ่มยูสเซอร์\x20','CGnqC','hbBgY','sSTBU','apply','VHbSg','fPdAh','branchId','ydMzd','POOut','EVKlb','JPIgQ','VskeT','ScSPg','sghLU','มี\x20userId\x20ซ้ำกัน:\x20\x22','cDgbH','1778kZONLk','\x22\x20เรียบร้อยแล้ว','send','JaUZu','userPassword','GWHUP','dcybO','ยูสเซอร์\x20(','utils','USERNAME_PATTERN','ZecKY','vhHxk','HRntS','boUis','red','KajWH','oCAfg','msg','tOyBp','EIEMb','$dateTimeCanDelete','yJcqR','jknDT','deletedCount','CoHDx','){{sep}}(CODE\x20:\x20','IeIvZ','RMlaJ','Pvpqe','bUaxu','UeTWH','Jadre','VevHc','rDpJm','รูปแบบอีเมลไม่ถูกต้อง','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','CigVJ','ullBV','flvOI','HOHfA','GXrwI','huIoZ','rQRYr','ddUtA','debu','userEmail','single','Wqxsq','IyaNd','LpxIt','eZBlH','KPHES','sWJaC','nuILj','upsertedCount','gdXFn','insertOne','connect','ECDaD','\x22\x20มีอยู่ในเอกสาร\x20','iYbrm','FfPAo','MECkp','mFQPu','axHmA','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','14304QkNTOk','VwLEb','error','cdjzw','FThXP','generatePassword','FVuHp','มีข้อมูลผิดพลาดที่แถว\x20','SfIoh','body','urOEJ','dJSzj','PqeMs','bFvOI','YYIgY','oxckN','userFirstname'];_0x4dad=function(){return _0x290afc;};return _0x4dad();}