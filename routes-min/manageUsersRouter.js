function _0x5afe(){const _0x2fa56a=['uhPHs','\x22\x20เรียบร้อยแล้ว\x20)','renderView','WjwHS','\x22\x20เรียบร้อยแล้ว','shift','XJnDA','includes','readFileSync','STXTt','userPrefix','OIaYD','bdyes','join','มีข้อมูลผิดพลาดที่แถว\x20','pKuKI','TTEje','LMvYI','rjZug','PajIH','bNyfb','duPrZ','/myData.js','RfAsC','call','ltPHr','DhuQQ','VjssS','acknowledged','MkGGk','fHsjI','green','bWRhw','lbhQY','vahCG','lJEEs','KitMj','response','XDFmj','\x5c$&','dOZbS','send','KAazS','status','สร้างผู้ใช้ใหม่\x20\x22','HaZGS','RmVRe','EurAP','hlyKn','minute','SbVeb','ZuGNB','nFYTF','oFhBn','DbzhY','dbColl_sessions','UVVar','limit','ogEKe','ไม่มีข้อมูล','xlsx','rIvxS','flash','HVLiB','OFAqe','UHcTG','userLastLogin','apply','bJapg','dYEWw','has','kjsyg','gUUqn','changesHistoryCount','xjUHU','uploadExcelFile','init','ajUpi','BWzWn','connect','return\x20(function()\x20','users','Ptnof','getDate','lhcCN','XOkxQ','fEtkI','jeznR','dXNTg','KYBTz','gger','{}.constructor(\x22return\x20this\x22)(\x20)','xOiLf','IpWxR','vvSjf','Ytkvj','EJRAM','wIMDi','Kawab','sheet_to_json','yncrG','ceil','CqcvP','pZOrL','YfBWX','manageUsers','zbXnj','{{sep}}[\x20บันทึกการแก้ไข\x20]','insertOne','awjyd','EUsrx','yVSsl','qtkoU','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','JDfUD','Router','mtaNF','ลบยูสเซอร์\x20\x22','cPdGj','ZgPOl','IXCqB','CFvDC','VFZWB','hnieC','zWDgv','zBaAU','&page=','USERNAME_PATTERN','tqFRC','get','GiGBv','XIcMW','USER_AUTHORITIES','/load','eRkLF','redirect','AIeaS','iuKmO','\x20ยูสเซอร์เรียบร้อยแล้ว','Bmdqr','prototype','jKlQo','nicWs','VqzAt','1036524CUErxc','iNqNL','GpNmu','BAkwj','242812rGBEhE','deletedCount','GbYmI','body','BWypA','162673ioyOHL','rpwAb','BzPzX','rOjhO','IGWUm','tZAoo','userPassword','YSjMZ','ehYYc','jfyVM','rpp','YOTcy','hasOwnProperty','bnrUw','trim','Bkkqb','red','VzaGi','56zFwSki','nnSBS','upsertedCount','kKJEI','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','kuPZL','{{sep}}\x22','vVDPD','CkolY','stringify','wQQGw','mbpjE','FPiAz','yfLSm','KAwdq','map','bwwpE','FHCiM','console','user-','15672LQSFBN','kVUZi','snhaB','gWLdw','dapte','branchInfo','JxNyh','message','kfiqM','add','7202585LAwPPp','raeVx','ไม่พบประวัติการเปลี่ยนแปลง','iLswI','userFullname','toString','$dateTimeCanDelete','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','sendRegisterUserEmail','ncUnY','fBZfh','Session\x20destroy\x20error:\x20','ประวัติการแก้ไขยูสเซอร์\x20:\x20[','KiiwQ','OzZyK','ANzPq','zbvwe','jlyBF','GjFSb','userFlash','\x20รายการ','size','ENAOe','QTWpt','KBaAJ','aFZhw','110QEmfDv','RDmQJ','VOKhg','QargO','userAuthority','fixOU','from','../','RwgYy','qdfdM','dbColl_users','zNKri','log','sYMZQ','ZdSDV','qGrjv','fkExd','mXZEn','\x22\x20)','TAHOQ','YELJV','find','mcbkM','iHteH','length','__proto__','KOUGl','uuBFB','destroy','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','jLulR','Not\x20Found','eUJMj','EYdHO','toArray','GVPIc','jACqF','isEmail','ALFuX','uVjdd','branchId','24mYsZMz','ubMnx','oplYy','YIHpJ','vgxos','dbUrl','whUqe','memoryStorage','insertedId','kIsdg','dbName','OZcGG','SVCtf','warn','rrEOc','forEach','vDPoh','jrSEz','5bkvoUR','OocWY','close','userNormalLoginCount','catch','?rpp=20&page=1&load_id=','qkkaL','DQTlx','input','generatePassword','uqfzX','$changesHistory','ExiRy','JUooq','&load_id=','RyHZD','getSettings','userIsActive','/new','/myModule.js','$userLastname','zWcxZ','render','oOVrY','ElmPS','PuHvv','LBhhm','ETWTZ','gzXoK','qrnVG','page','LWXen','DtJnL','HVJCd','utils','base64','IrcyT','bind','uCJxU','/changes','gioKR','WUojT','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','RHXNR','string','then','action','isOS','rwFvv','active','env','LqAej','DKSip','BCRYPT_NUMBER','aggregate','doc_changes.ejs','keys','qSUik','/manage/users','lxJLc','getDateTime','ZAMup','hash','/myDateTime.js','ggZYG','function\x20*\x5c(\x20*\x5c)','EZPFt','อัปเดท\x20\x22','AAyKt','load_id','DmkUI','มี\x20userId\x20ซ้ำกัน:\x20\x22','LdvMf','findOne','&rpp=','updateOne','sip','AiltL','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','701206PwlwuO','CGwRp','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','dbColl_userBranches','wifLH','ZrKXs','uvAAj','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','userFirstname','_id','EcXCa','jvIWB','YoCgP','START_PASSWORD','ZzMzE','msg','HUuOo','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','KcKpN','userEmail','ไม่มีข้อมูลที่อัปเดท','lyUSV','buffer','GTaWt','dbColl_warehouseIn','PqGoX','lEuhq','fjHXv','Tpzks','WoJcz','hyQgE','error\x20===>\x20','vnOGD','changesHistory','trOCM','TxoCc','dOghS','kDkPc','IpEmJ','47934qgGJBc','NbKiV','HKGtI','kmISu','GVRay','QXEUc','dFSka','DhxBk','TZSEa','Jvupn','push','OIhmv','book_new','SaVzu','collection','tamWb','iZbuv','unshift','KMIHN','session','wjNhR','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','Tkyiq','lKRct','pkJhL','cCYXh','NTmuZ','FElXs','mQSCa','{{sep}}ไม่สามารถลบได้','UDIKz','AKBTH','UziVP','parse','aiPEW','ZnTTc','CJnlj','/mySendmail.js','deleteOne','มี\x20username\x20ซ้ำกัน:\x20\x22','{{sep}}(\x20ไม่พบเซสชั่น\x20)','jSQNc','JmxfK','zRonF','NrfYt','bAkXl','mmnXP','4kMcaPF','stateObject','some','Uwbvi','LHJWl','yXNhU','single','test','VIkBc','GPVKk','jgmjy','userId','TspuS','QFTxy','YZcju','/download-excel','entries','file','MJaId','read','HmdJU','GAdLe','fbzKq','users_','iYhLT','XKeCh','bQymh','cYxwi','suDST','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','info','bwojv','dbColl_warehouseOut','kCACe','VvCYR','SrzyW','userLastname','wbdci','fEmSb','feGGp','row','hQfWr','อัปเดท\x20','nOVlp','deoZw','xLKks','QvRtb','OLlKF','qqWyD','wjYga','dbColl_sales','username','ZQkWb','wtlNx','nxUvx','replace','AFCzl','debu','$userPrefix','ctoHH','utf8','EqpFM','?sip=','HZahh','yHBve','dateTimeCanDelete','KeAcV','ktQgg','post','nwuEA','xqCUP','chain','deleteMany','hrVtu','qwerty','fsAPP','GVnrm','xUVkH','dMlGr','filter','counter','){{sep}}(CODE\x20:\x20','/print','FZowy','$branchInfo.branchName','uXYkM','vxQyk','constructor','ujWXG','FUvTJ','nEOvM','matchedCount','json_to_sheet','UBcln','query','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','CNvZE','UEjAR','PSXYE','DniHr','XlazQ','/delete','sendFile','88YwDdew','YPJSQ','AvkDU','OSbpv','trace','modifiedCount','deGTk','IiYsl','write','pcNpK','{{sep}}เพิ่มใหม่\x20','userPhone','xxKRT','AhiTH','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','countDocuments','rfKLF','hIfZw','evyVi','รูปแบบอีเมลไม่ถูกต้อง','พิมพ์ข้อมูล\x20','SnPeZ','wRuRf','ยูสเซอร์\x20\x22','kuwfV','WZffP','EXDEX','HIonC','error','UyDVT','xlULQ','\x22\x20มีอยู่ในเอกสาร\x20','getSessionData'];_0x5afe=function(){return _0x2fa56a;};return _0x5afe();}function _0x537f(_0x3510fe,_0x5a0f77){const _0x59aae4=_0x5afe();return _0x537f=function(_0x5e53a8,_0xaf2e8a){_0x5e53a8=_0x5e53a8-0xbd;let _0xcd0f0e=_0x59aae4[_0x5e53a8];return _0xcd0f0e;},_0x537f(_0x3510fe,_0x5a0f77);}const _0x674a7b=_0x537f;(function(_0x586cbc,_0x2a0d2c){const _0x4ea7ea=_0x537f,_0x2edbb4=_0x586cbc();while(!![]){try{const _0x6ddc87=-parseInt(_0x4ea7ea(0x15f))/0x1*(parseInt(_0x4ea7ea(0x27b))/0x2)+parseInt(_0x4ea7ea(0x2a6))/0x3*(parseInt(_0x4ea7ea(0x292))/0x4)+parseInt(_0x4ea7ea(0x305))/0x5*(parseInt(_0x4ea7ea(0x277))/0x6)+parseInt(_0x4ea7ea(0x280))/0x7*(-parseInt(_0x4ea7ea(0x1c6))/0x8)+parseInt(_0x4ea7ea(0x130))/0x9*(parseInt(_0x4ea7ea(0x2ca))/0xa)+parseInt(_0x4ea7ea(0x109))/0xb*(parseInt(_0x4ea7ea(0x2f3))/0xc)+parseInt(_0x4ea7ea(0x2b0))/0xd;if(_0x6ddc87===_0x2a0d2c)break;else _0x2edbb4['push'](_0x2edbb4['shift']());}catch(_0x3a3a7f){_0x2edbb4['push'](_0x2edbb4['shift']());}}}(_0x5afe,0x3bc18));const _0x54c215=(function(){const _0x509bff=_0x537f,_0x5283f4={'zWcxZ':_0x509bff(0x128),'KcKpN':_0x509bff(0x290),'IiYsl':function(_0x371768,_0x57db36){return _0x371768!==_0x57db36;},'mmnXP':function(_0x187a7b,_0x28e0d1){return _0x187a7b==_0x28e0d1;},'tismB':_0x509bff(0x239),'ExiRy':'fYFof','vgxos':function(_0x6e51ef,_0x3df00a){return _0x6e51ef!==_0x3df00a;},'TxoCc':_0x509bff(0x216)};let _0x850af9=!![];return function(_0x40d258,_0x57e3e3){const _0x39fd92=_0x509bff,_0xa6d442={'MVOBO':_0x5283f4[_0x39fd92(0xcf)],'AfJZG':_0x5283f4[_0x39fd92(0x11b)],'lxJLc':function(_0x4f2f88,_0x5f0555){const _0x3004c3=_0x39fd92;return _0x5283f4[_0x3004c3(0x1cd)](_0x4f2f88,_0x5f0555);},'apxPH':function(_0x4501ab,_0x48ac8d){const _0x6aebea=_0x39fd92;return _0x5283f4[_0x6aebea(0x15e)](_0x4501ab,_0x48ac8d);},'ZuGNB':_0x5283f4['tismB'],'GPVKk':function(_0x417941,_0x2ec3bb){const _0x149e02=_0x39fd92;return _0x5283f4[_0x149e02(0x1cd)](_0x417941,_0x2ec3bb);},'wjYga':_0x5283f4[_0x39fd92(0xc6)]};if(_0x5283f4[_0x39fd92(0x2f7)](_0x5283f4[_0x39fd92(0x12c)],_0x5283f4[_0x39fd92(0x12c)])){const _0x36bceb=_0x197ea2?function(){const _0x3e3bde=_0x39fd92;if(_0x37ca5e){const _0x4d0fba=_0x3c6869[_0x3e3bde(0x22a)](_0x34e3a2,arguments);return _0x533543=null,_0x4d0fba;}}:function(){};return _0x8211b6=![],_0x36bceb;}else{const _0x106d4f=_0x850af9?function(){const _0x33724d=_0x39fd92,_0x45e3d1={'ENAOe':_0xa6d442['MVOBO'],'sHGVO':_0xa6d442['AfJZG'],'yVSsl':function(_0x36c41c,_0xee544b){const _0xaf27fe=_0x537f;return _0xa6d442[_0xaf27fe(0xf5)](_0x36c41c,_0xee544b);},'WrXoZ':function(_0xe70083,_0x39f564){return _0xa6d442['apxPH'](_0xe70083,_0x39f564);}};if(_0xa6d442[_0x33724d(0xf5)](_0xa6d442[_0x33724d(0x21a)],_0xa6d442[_0x33724d(0x21a)]))_0x1eb725[_0x33724d(0x2d6)](_0x45e3d1[_0x33724d(0x2c6)],_0x48a9e3[_0x33724d(0x2ad)]),_0xf27009[_0x33724d(0x210)](_0x4c294b[_0x33724d(0x29b)]({'isPrint':!0x1,'class':_0x45e3d1['sHGVO'],'msg':_0x15af85[_0x33724d(0x2ad)]}));else{if(_0x57e3e3){if(_0xa6d442[_0x33724d(0x168)](_0xa6d442[_0x33724d(0x190)],_0xa6d442[_0x33724d(0x190)])){const _0x4e15dc=_0x3cf2c6[_0x33724d(0x16a)];_0x2855dd=_0x137b3e[_0x33724d(0x1ae)](_0x13be5f=>{const _0x4dd7bf=_0x33724d,_0x126582=_0x45e3d1[_0x4dd7bf(0x256)](_0x13be5f[_0x4dd7bf(0x2ce)],'S')||_0x45e3d1['WrXoZ'](_0x13be5f[_0x4dd7bf(0x16a)],_0x4e15dc);return _0x45e3d1[_0x4dd7bf(0x256)](_0x13be5f[_0x4dd7bf(0x2ce)],'O')&&_0x126582;});}else{const _0x3ecfd8=_0x57e3e3['apply'](_0x40d258,arguments);return _0x57e3e3=null,_0x3ecfd8;}}}}:function(){};return _0x850af9=![],_0x106d4f;}};}());(function(){const _0x3bf969=_0x537f,_0xe7dea8={'xlULQ':_0x3bf969(0x128),'ajUpi':'red','qqjDk':function(_0x1d2311,_0x17cc5e){return _0x1d2311!==_0x17cc5e;},'iZbuv':_0x3bf969(0x102),'ZzMzE':'function\x20*\x5c(\x20*\x5c)','tqFRC':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','KiiwQ':function(_0x18b7e7,_0x328a57){return _0x18b7e7(_0x328a57);},'nicWs':'init','jKlQo':function(_0x35c309,_0x506e47){return _0x35c309+_0x506e47;},'vahCG':_0x3bf969(0x1a6),'uuBFB':_0x3bf969(0xc2),'QTWpt':function(_0x20ca46,_0x104742){return _0x20ca46!==_0x104742;},'TZIHw':_0x3bf969(0x289),'BsZah':'ieiQd','oIttV':function(_0x2ea914,_0x24d74a){return _0x2ea914(_0x24d74a);},'lJEEs':_0x3bf969(0x148),'DbzhY':function(_0x4af4aa){return _0x4af4aa();},'ubMnx':function(_0x4bc459,_0x1179f7,_0x19c1bf){return _0x4bc459(_0x1179f7,_0x19c1bf);}};_0xe7dea8[_0x3bf969(0x2f4)](_0x54c215,this,function(){const _0x494088=_0x3bf969;if(_0xe7dea8['qqjDk'](_0xe7dea8[_0x494088(0x140)],_0xe7dea8[_0x494088(0x140)]))_0x1ad170[_0x494088(0x307)]();else{const _0x1c612e=new RegExp(_0xe7dea8[_0x494088(0x117)]),_0x3e85c4=new RegExp(_0xe7dea8[_0x494088(0x267)],'i'),_0x26cd51=_0xe7dea8[_0x494088(0x2bd)](_0x35b100,_0xe7dea8[_0x494088(0x275)]);if(!_0x1c612e['test'](_0xe7dea8[_0x494088(0x274)](_0x26cd51,_0xe7dea8[_0x494088(0x209)]))||!_0x3e85c4[_0x494088(0x166)](_0xe7dea8[_0x494088(0x274)](_0x26cd51,_0xe7dea8[_0x494088(0x2e5)])))_0xe7dea8[_0x494088(0x2c7)](_0xe7dea8['TZIHw'],_0xe7dea8['BsZah'])?_0xe7dea8['oIttV'](_0x26cd51,'0'):(_0x42eb86[_0x494088(0x2d6)](_0xe7dea8[_0x494088(0x1e4)],_0xe67640),_0x403536['status'](0x194)[_0x494088(0x1c5)](_0x3126fa));else{if(_0xe7dea8[_0x494088(0x2c7)](_0xe7dea8['lJEEs'],_0xe7dea8[_0x494088(0x20a)])){const _0x38119c=_0xb8ed09[_0x494088(0x2d0)](new _0x102f4a(_0x5eb7a3['map'](_0x30e1e2=>_0x9919d1[_0x494088(0x29b)](_0x30e1e2))))[_0x494088(0x2a1)](_0x1cfe52=>_0x41c972[_0x494088(0x151)](_0x1cfe52));return _0xa7b556['send']({'isUpload':!0x1,'color':_0xe7dea8[_0x494088(0x234)],'msg':_0x494088(0x1f5)+_0x38119c['map'](_0x39e053=>_0x39e053[_0x494088(0x187)])[_0x494088(0x1f4)](',\x20'),'errorRows':_0x38119c});}else _0xe7dea8[_0x494088(0x21d)](_0x35b100);}}})();}());const _0xaf2e8a=(function(){const _0x3a7d73=_0x537f,_0x4097c6={'fEtkI':function(_0x4c46c3,_0x426af0){return _0x4c46c3===_0x426af0;},'eXFSG':_0x3a7d73(0x16c),'HIonC':_0x3a7d73(0x152),'bwwpE':_0x3a7d73(0x184),'Zjlup':_0x3a7d73(0x163),'ZVIhS':_0x3a7d73(0x2e0)};let _0x3b10e5=!![];return function(_0x18a756,_0x69cd69){const _0x349e8b=_0x3a7d73;if(_0x4097c6[_0x349e8b(0x23d)](_0x4097c6['Zjlup'],_0x4097c6['ZVIhS']))return![];else{const _0x65689a=_0x3b10e5?function(){const _0x2ce5df=_0x349e8b;if(_0x4097c6[_0x2ce5df(0x23d)](_0x4097c6['eXFSG'],_0x4097c6[_0x2ce5df(0x1e1)]))return!![];else{if(_0x69cd69){if(_0x4097c6[_0x2ce5df(0x23d)](_0x4097c6[_0x2ce5df(0x2a2)],_0x4097c6[_0x2ce5df(0x2a2)])){const _0x2b0a8d=_0x69cd69[_0x2ce5df(0x22a)](_0x18a756,arguments);return _0x69cd69=null,_0x2b0a8d;}else{if(_0x45a10b){const _0x5eefc7=_0x49bb52[_0x2ce5df(0x22a)](_0x95acb0,arguments);return _0xff9fdc=null,_0x5eefc7;}}}}}:function(){};return _0x3b10e5=![],_0x65689a;}};}()),_0x5e53a8=_0xaf2e8a(this,function(){const _0x4c12bf=_0x537f,_0xfb8f2e={'GbYmI':_0x4c12bf(0x118),'jvIWB':'red','wifLH':function(_0x2e00ab,_0x5c41c6){return _0x2e00ab(_0x5c41c6);},'nFYTF':function(_0x5e2f20,_0x47716d){return _0x5e2f20+_0x47716d;},'pKuKI':_0x4c12bf(0x237),'deQmN':'{}.constructor(\x22return\x20this\x22)(\x20)','Bmdqr':function(_0xd587b){return _0xd587b();},'OuhhF':function(_0x2fc383,_0xc58cb3){return _0x2fc383===_0xc58cb3;},'UziVP':_0x4c12bf(0x1bc),'ZmbYN':'tDJeK','hIfZw':function(_0x3036a4,_0x29f17b){return _0x3036a4(_0x29f17b);},'lbhQY':function(_0x4b0bc9,_0x3e10e8){return _0x4b0bc9+_0x3e10e8;},'sKzGC':function(_0x541082,_0x53064d){return _0x541082+_0x53064d;},'RDmQJ':function(_0x26e709,_0x5c9b64){return _0x26e709!==_0x5c9b64;},'NbKiV':_0x4c12bf(0x1ab),'PkvlQ':_0x4c12bf(0x2d6),'qrnVG':_0x4c12bf(0x300),'IrcyT':_0x4c12bf(0x17d),'yncrG':_0x4c12bf(0x1e2),'IpEmJ':'exception','yHBve':'table','GTaWt':'trace','VFZWB':function(_0x570097,_0x2eb1ad){return _0x570097<_0x2eb1ad;},'lNbti':function(_0x3d080f,_0x343501){return _0x3d080f===_0x343501;},'KeAcV':_0x4c12bf(0xe2)};let _0x28d4e1;try{if(_0xfb8f2e['OuhhF'](_0xfb8f2e[_0x4c12bf(0x150)],_0xfb8f2e['ZmbYN']))_0xd3ed0c[_0x4c12bf(0x307)]();else{const _0x50c420=_0xfb8f2e[_0x4c12bf(0x1d7)](Function,_0xfb8f2e[_0x4c12bf(0x208)](_0xfb8f2e['sKzGC'](_0xfb8f2e[_0x4c12bf(0x1f6)],_0xfb8f2e['deQmN']),');'));_0x28d4e1=_0xfb8f2e['Bmdqr'](_0x50c420);}}catch(_0x4108ae){if(_0xfb8f2e[_0x4c12bf(0x2cb)](_0xfb8f2e[_0x4c12bf(0x131)],_0xfb8f2e[_0x4c12bf(0x131)]))return _0x15b168[_0x4c12bf(0x2d6)](_0xe95276[_0x4c12bf(0x2ad)]),_0x31f66e[_0x4c12bf(0x225)](_0xfb8f2e[_0x4c12bf(0x27d)],{'class':_0xfb8f2e[_0x4c12bf(0x114)],'text':''+_0x3ae7ed[_0x4c12bf(0x2ad)]}),_0x209fd5[_0x4c12bf(0x26e)](_0x39b391);else _0x28d4e1=window;}const _0x3f57f4=_0x28d4e1[_0x4c12bf(0x2a4)]=_0x28d4e1[_0x4c12bf(0x2a4)]||{},_0x1748d5=[_0xfb8f2e['PkvlQ'],_0xfb8f2e[_0x4c12bf(0xd7)],_0xfb8f2e[_0x4c12bf(0xde)],_0xfb8f2e[_0x4c12bf(0x24b)],_0xfb8f2e[_0x4c12bf(0x12f)],_0xfb8f2e[_0x4c12bf(0x19f)],_0xfb8f2e[_0x4c12bf(0x120)]];for(let _0x27e816=0x0;_0xfb8f2e[_0x4c12bf(0x261)](_0x27e816,_0x1748d5['length']);_0x27e816++){if(_0xfb8f2e['lNbti'](_0xfb8f2e['KeAcV'],_0xfb8f2e[_0x4c12bf(0x1a1)])){const _0x40cb27=_0xaf2e8a[_0x4c12bf(0x1b6)]['prototype'][_0x4c12bf(0xdf)](_0xaf2e8a),_0x158deb=_0x1748d5[_0x27e816],_0x2ca6b7=_0x3f57f4[_0x158deb]||_0x40cb27;_0x40cb27['__proto__']=_0xaf2e8a[_0x4c12bf(0xdf)](_0xaf2e8a),_0x40cb27['toString']=_0x2ca6b7[_0x4c12bf(0x2b5)]['bind'](_0x2ca6b7),_0x3f57f4[_0x158deb]=_0x40cb27;}else{const _0x13f0e2=_0xfb8f2e[_0x4c12bf(0x10d)](_0x5e82f8,_0xfb8f2e[_0x4c12bf(0x21b)](_0xfb8f2e[_0x4c12bf(0x21b)](_0xfb8f2e[_0x4c12bf(0x1f6)],_0xfb8f2e['deQmN']),');'));_0x2594ad=_0xfb8f2e[_0x4c12bf(0x272)](_0x13f0e2);}}});_0x5e53a8();import _0x6ee961 from'express';import{MongoClient as _0x381a0c,ObjectId as _0x111ca4}from'mongodb';import _0x98da1c from'bcrypt';const x=_0x6ee961[_0x674a7b(0x25a)]();import _0x5a223d from'multer';import _0x1a8d5f from'validator';import _0x373efb from'xlsx';import _0xfe5e1e from'path';import _0x3f08ff from'fs';import _0x178b4d from'ejs';import _0x38fc58 from'../middleware/mainAuth.js';const H=await import(_0x674a7b(0x2d1)+mymoduleFolder+_0x674a7b(0xcd)),O=await import(_0x674a7b(0x2d1)+mymoduleFolder+_0x674a7b(0xf9)),M=await import(_0x674a7b(0x2d1)+mymoduleFolder+'/myUsers.js'),re=await import(_0x674a7b(0x2d1)+mymoduleFolder+_0x674a7b(0x155)),z=await import('../'+mymoduleFolder+_0x674a7b(0x1fd)),b=_0x674a7b(0xf4),Q=b+'/save',X=b+_0x674a7b(0xcc),W=b+_0x674a7b(0x26c),G=b+_0x674a7b(0x1c4),V=b+_0x674a7b(0x1b1),Y=b+_0x674a7b(0xe1),K=b+_0x674a7b(0x16e),Z=b+'/upload-excel',ne=b[_0x674a7b(0x196)](/\//g,'_'),oe=0x5a0*0x3c;x[_0x674a7b(0x268)](b,_0x38fc58[_0x674a7b(0xe9)],async(_0x57015e,_0x1c15ae)=>{const _0x3507a0=_0x674a7b,_0x3eed84={'LwtDc':_0x3507a0(0x128),'CkolY':'msg','LBhhm':_0x3507a0(0x290),'bnrUw':function(_0x2d8785,_0xe8121b){return _0x2d8785!==_0xe8121b;},'kIsdg':'QkzfY','vvSjf':_0x3507a0(0x29c),'HVJCd':function(_0x38e747,_0x194621){return _0x38e747!==_0x194621;},'yfLSm':function(_0x47e98c,_0x63ca61){return _0x47e98c==_0x63ca61;},'rrEOc':function(_0x11cf74,_0x42e7f4){return _0x11cf74(_0x42e7f4);},'qhXTu':function(_0x4d8ca2,_0x1f7960){return _0x4d8ca2(_0x1f7960);},'UaMzS':function(_0x1ae7ed,_0x4f41eb){return _0x1ae7ed(_0x4f41eb);},'GpNmu':function(_0x3dd2a3,_0x235acb){return _0x3dd2a3(_0x235acb);},'CqcvP':function(_0x4d6ab4,_0x2be34b){return _0x4d6ab4*_0x2be34b;},'oFhBn':function(_0x394ce5,_0x4fd182){return _0x394ce5-_0x4fd182;},'raeVx':'pRLhF','SftoK':function(_0x45e8f8,_0x238643){return _0x45e8f8!==_0x238643;},'OocWY':'NyvOj','GNfyd':_0x3507a0(0x20e),'WUojT':function(_0x4dd286,_0x495bef){return _0x4dd286(_0x495bef);},'HUuOo':function(_0x439ba2,_0x52969b){return _0x439ba2(_0x52969b);},'wjNhR':function(_0x512702,_0x26b3fb){return _0x512702/_0x26b3fb;},'rOjhO':function(_0x3e45f9,_0x27c098){return _0x3e45f9<_0x27c098;},'whUqe':function(_0x51c387,_0x31b7be){return _0x51c387-_0x31b7be;},'QvRtb':function(_0x6d2b65,_0x36bdc0){return _0x6d2b65-_0x36bdc0;},'bwojv':function(_0x44dd31,_0x1d8fe5){return _0x44dd31(_0x1d8fe5);},'rjZug':function(_0x26ee73,_0x557ec5){return _0x26ee73>_0x557ec5;},'YoCgP':function(_0xa1a637,_0x2cb3e0){return _0xa1a637+_0x2cb3e0;},'EbIwG':function(_0x1ea7fd,_0x1288d1){return _0x1ea7fd(_0x1288d1);},'IoJhQ':function(_0x5e2c4a,_0x163af6){return _0x5e2c4a+_0x163af6;},'jSQNc':function(_0x5aabcb,_0x902e70){return _0x5aabcb(_0x902e70);},'EqpFM':_0x3507a0(0x199),'zbvwe':'$userFirstname','kjsyg':_0x3507a0(0xce),'ncUnY':_0x3507a0(0xc5),'ALFuX':_0x3507a0(0x2b6),'bJapg':_0x3507a0(0x218),'rwFvv':function(_0x4745b6,_0x119160){return _0x4745b6!==_0x119160;},'hyQgE':'fHwFB','MJaId':function(_0x1f3fa1,_0x1e0d9a){return _0x1f3fa1(_0x1e0d9a);},'OLlKF':function(_0x1006c4,_0x49117c){return _0x1006c4(_0x49117c);},'VJZRI':function(_0x1ac61d,_0x22c341){return _0x1ac61d===_0x22c341;},'SaVzu':_0x3507a0(0x10f),'YELJV':_0x3507a0(0x2e1),'KitMj':function(_0x4845c4,_0x5935bf){return _0x4845c4===_0x5935bf;},'uqfzX':'IcjCg','qdfdM':_0x3507a0(0x2c3),'GAdLe':function(_0x19b1af,_0x33e22c){return _0x19b1af>_0x33e22c;},'uXYkM':_0x3507a0(0x250),'Tkyiq':_0x3507a0(0xeb),'PuHvv':function(_0x4c348d,_0x59e089){return _0x4c348d!==_0x59e089;},'nnSBS':_0x3507a0(0x1aa),'AFCzl':'QMHaK','tamWb':function(_0x41e17a,_0x53f52e){return _0x41e17a===_0x53f52e;},'cYxwi':_0x3507a0(0x303)},_0x4073af=_0x57015e[_0x3507a0(0x1bd)][_0x3507a0(0x106)],_0x14fde9=_0x3eed84['qhXTu'](Number,_0x57015e[_0x3507a0(0x1bd)][_0x3507a0(0x28a)])||0x14,_0x321cd6=_0x3eed84['UaMzS'](Number,_0x57015e[_0x3507a0(0x1bd)][_0x3507a0(0xd8)])||0x1,_0x3ff964=_0x57015e['query'][_0x3507a0(0xff)]||'',_0x3e128c=_0x3eed84[_0x3507a0(0x279)](Number,_0x3eed84[_0x3507a0(0x24d)](_0x3eed84[_0x3507a0(0x21c)](_0x321cd6,0x1),_0x14fde9)),_0x4c9041=O[_0x3507a0(0xf6)](0x0),_0x2e9a8e=new _0x381a0c(dbUrl);try{if(_0x3eed84[_0x3507a0(0xdb)](_0x3eed84['raeVx'],_0x3eed84[_0x3507a0(0x2b1)])){const _0x104d31=_0x33cc41[_0x3507a0(0x22a)](_0x471a44,arguments);return _0x23b91f=null,_0x104d31;}else{await _0x2e9a8e[_0x3507a0(0x236)]();const _0x2cb1d9=_0x2e9a8e['db'](global[_0x3507a0(0x2fd)])['collection'](global[_0x3507a0(0x2d4)]);if(_0x4073af){if(_0x3eed84['SftoK'](_0x3eed84[_0x3507a0(0x306)],_0x3eed84['OocWY']))_0x5caedd[_0x3507a0(0x307)]();else{const _0x57756c=new RegExp(_0x4073af[_0x3507a0(0x196)](/[.*+?^${}()|[\]\\]/g,_0x3eed84['GNfyd']),'i');let _0xf07c52={};_0x3eed84[_0x3507a0(0xe3)](isNaN,_0x3eed84['HUuOo'](Number,_0x4073af))?_0xf07c52={'userId':{'$regex':_0x57756c}}:_0xf07c52={'userId':_0x3eed84['UaMzS'](Number,_0x4073af)};var _0x2d5697=await _0x2cb1d9[_0x3507a0(0x1d5)]({'$or':[_0xf07c52,{'username':{'$regex':_0x57756c}},{'userFirstname':{'$regex':_0x57756c}}]});}}else var _0x2d5697=await _0x2cb1d9['countDocuments']({});const _0x12bd83=Math[_0x3507a0(0x24c)](_0x3eed84[_0x3507a0(0x144)](_0x2d5697,_0x14fde9)),_0x11274b=_0x3eed84[_0x3507a0(0x283)](_0x3eed84[_0x3507a0(0x2f9)](_0x3eed84[_0x3507a0(0x119)](Number,_0x321cd6),0x1),0x1)?'-':_0x3eed84[_0x3507a0(0x18d)](_0x3eed84[_0x3507a0(0x279)](Number,_0x321cd6),0x1),_0x4431e8=_0x3eed84[_0x3507a0(0x17e)](Number,_0x321cd6),_0x39c932=_0x3eed84[_0x3507a0(0x1f9)](_0x3eed84[_0x3507a0(0x115)](_0x3eed84['EbIwG'](Number,_0x321cd6),0x1),_0x12bd83)?'-':_0x3eed84['IoJhQ'](_0x3eed84[_0x3507a0(0x159)](Number,_0x321cd6),0x1),_0x26a85f=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x3eed84[_0x3507a0(0x19c)],'\x20',_0x3eed84[_0x3507a0(0x2c0)],'\x20',_0x3eed84[_0x3507a0(0x22e)]]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x3eed84[_0x3507a0(0x2b9)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x4c9041},'endDate':{'$toDate':_0x3eed84[_0x3507a0(0x2f0)]},'unit':_0x3eed84[_0x3507a0(0x22b)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x3e128c},{'$limit':_0x14fde9}];if(_0x4073af){if(_0x3eed84[_0x3507a0(0xea)](_0x3eed84['hyQgE'],_0x3eed84[_0x3507a0(0x127)])){const _0x50ee6e=_0x32c911?function(){const _0x4c3785=_0x3507a0;if(_0x21526f){const _0x2c8fdf=_0x7c62e7[_0x4c3785(0x22a)](_0x3175c,arguments);return _0x35146d=null,_0x2c8fdf;}}:function(){};return _0x160150=![],_0x50ee6e;}else{const _0x490bf3=_0x4073af?new RegExp(''+_0x4073af,'i'):new RegExp('.*');let _0x484c9c={};_0x3eed84[_0x3507a0(0x279)](isNaN,_0x3eed84[_0x3507a0(0x171)](Number,_0x4073af))?_0x484c9c={'userId':{'$regex':_0x490bf3}}:_0x484c9c={'userId':_0x3eed84[_0x3507a0(0x18e)](Number,_0x4073af)},_0x26a85f['unshift']({'$match':{'$or':[_0x484c9c,{'username':{'$regex':_0x490bf3}},{'userFirstname':{'$regex':_0x490bf3}}]}});}}const _0x39e439=M[_0x3507a0(0x1e6)](_0x57015e),_0x4fd03e=_0x39e439[_0x3507a0(0x2ce)];let _0x3f3364=await _0x2cb1d9['aggregate'](_0x26a85f)[_0x3507a0(0x2ec)]();if(['S'][_0x3507a0(0x1ee)](_0x4fd03e)){if(_0x3eed84['VJZRI'](_0x3eed84[_0x3507a0(0x13d)],_0x3eed84[_0x3507a0(0x2de)]))return _0x2a5da6['log'](_0x3eed84['LwtDc'],_0x23ca40),_0x56405e['flash'](_0x3eed84['CkolY'],{'class':_0x3eed84[_0x3507a0(0xd4)],'text':_0x434c8e[_0x3507a0(0x2ad)]}),_0x890d4a[_0x3507a0(0x26e)](_0x52cf9a);else{const _0x2038e3=_0x39e439[_0x3507a0(0x16a)];_0x3f3364=_0x3f3364[_0x3507a0(0x1ae)](_0x3a498a=>{const _0x2137b0=_0x3507a0;if(_0x3eed84[_0x2137b0(0x28d)](_0x3eed84[_0x2137b0(0x2fc)],_0x3eed84[_0x2137b0(0x245)])){const _0x58a9ea=_0x3eed84['HVJCd'](_0x3a498a[_0x2137b0(0x2ce)],'S')||_0x3eed84[_0x2137b0(0x29f)](_0x3a498a[_0x2137b0(0x16a)],_0x2038e3);return _0x3eed84[_0x2137b0(0x28d)](_0x3a498a[_0x2137b0(0x2ce)],'O')&&_0x58a9ea;}else return _0x5e6d10[_0x2137b0(0x210)]({'isDownload':!0x1,'color':_0x3eed84[_0x2137b0(0xd4)],'msg':_0xf6d2d2[_0x2137b0(0x2ad)]});});}}if(_0x3ff964)var _0x55cd82=await _0x2cb1d9[_0x3507a0(0x103)]({'_id':new _0x111ca4(_0x3ff964)},{'projection':{'userPassword':0x0}});else var _0x55cd82={};if(_0x55cd82&&_0x3eed84[_0x3507a0(0x20b)](Object[_0x3507a0(0xf2)](_0x55cd82)[_0x3507a0(0x2e2)],0x0)){if(_0x3eed84[_0x3507a0(0x20b)](_0x3eed84['uqfzX'],_0x3eed84[_0x3507a0(0xc4)])){const _0x2cbe61=_0x57015e[_0x3507a0(0x225)](_0x3eed84[_0x3507a0(0x2d3)]);_0x2cbe61&&_0x3eed84[_0x3507a0(0x174)](_0x2cbe61['length'],0x0)&&(_0x55cd82={..._0x2cbe61[0x0]});}else{const _0x1ef03e=_0x4bd32f[_0x3507a0(0x1b6)]['prototype']['bind'](_0x8996e0),_0x15e063=_0x1cc578[_0x4cdb95],_0x42d411=_0x174edd[_0x15e063]||_0x1ef03e;_0x1ef03e['__proto__']=_0x446f87['bind'](_0x4a652b),_0x1ef03e[_0x3507a0(0x2b5)]=_0x42d411['toString']['bind'](_0x42d411),_0x8beb89[_0x15e063]=_0x1ef03e;}}const _0x51219d=await H[_0x3507a0(0x1e9)](_0x3eed84[_0x3507a0(0x1b4)],_0x1c15ae,{'title':PAGE_MANAGE_USERS,'time':O[_0x3507a0(0x23a)](),'msg':_0x57015e[_0x3507a0(0x225)](_0x3eed84[_0x3507a0(0x29a)]),'user':await M['getSessionData'](_0x57015e),'settings':await H[_0x3507a0(0xca)](),'load_id':_0x3ff964,'sip':_0x4073af,'rpp':_0x14fde9,'page':_0x321cd6,'pagePre':_0x11274b,'pageAct':_0x4431e8,'pageNxt':_0x39c932,'pageLst':_0x12bd83,'pageRedirect':b,'data':_0x3f3364,'dataBranches':await z['getUserBranches']({'branchStatus':_0x3eed84[_0x3507a0(0x146)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x55cd82});return _0x1c15ae[_0x3507a0(0x210)](_0x51219d);}}catch(_0x58d731){_0x3eed84[_0x3507a0(0xd3)](_0x3eed84[_0x3507a0(0x293)],_0x3eed84[_0x3507a0(0x197)])?(console[_0x3507a0(0x2d6)](_0x58d731['message']),_0x1c15ae[_0x3507a0(0x212)](0x194)[_0x3507a0(0x1c5)](file404)):SLVMHD[_0x3507a0(0x301)](_0x886911,'0');}finally{_0x3eed84[_0x3507a0(0x13f)](_0x3eed84[_0x3507a0(0x17a)],_0x3eed84[_0x3507a0(0x17a)])?_0x2e9a8e[_0x3507a0(0x307)]():_0x9c1008['close']();}}),x[_0x674a7b(0x1a3)](W,_0x38fc58[_0x674a7b(0xe9)],async(_0x4a72b3,_0xdf3eb2)=>{const _0x361ff4=_0x674a7b,_0x1713c3={'jeznR':_0x361ff4(0xfb),'bAkXl':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','lEuhq':function(_0x354ca1,_0x4202d9){return _0x354ca1(_0x4202d9);},'kCACe':_0x361ff4(0x233),'DQTlx':function(_0x36cd82,_0x463e26){return _0x36cd82+_0x463e26;},'hnieC':_0x361ff4(0x1a6),'YZcju':function(_0x2f9c4a,_0x4fa50a){return _0x2f9c4a+_0x4fa50a;},'ZgPOl':_0x361ff4(0xc2),'xjUHU':function(_0xb56089,_0x18a40f){return _0xb56089(_0x18a40f);},'gaLVF':function(_0x579e33){return _0x579e33();},'uhPHs':function(_0xc244dd,_0x1e3189,_0x186c99){return _0xc244dd(_0x1e3189,_0x186c99);},'YOTcy':function(_0x194158,_0x51f508){return _0x194158>_0x51f508;},'zBaAU':'userFlash','FElXs':_0x361ff4(0x118),'WZffP':_0x361ff4(0x206),'HVLiB':function(_0x3f1f77,_0x2e01b1){return _0x3f1f77===_0x2e01b1;},'feGGp':_0x361ff4(0x27a),'hQfWr':_0x361ff4(0x290),'snhaB':_0x361ff4(0x2e9),'EUsrx':function(_0xed3220,_0x258f56){return _0xed3220!==_0x258f56;},'SVCtf':_0x361ff4(0x107),'kuwfV':_0x361ff4(0x1e3),'UVVar':_0x361ff4(0x1a8)},_0x2c117f=_0x4a72b3[_0x361ff4(0x27e)][_0x361ff4(0xff)],_0xd7064=_0x4a72b3[_0x361ff4(0x27e)][_0x361ff4(0x106)],_0x3c8073=_0x1713c3['xjUHU'](Number,_0x4a72b3[_0x361ff4(0x27e)][_0x361ff4(0x28a)])||0x14,_0x523bde=_0x1713c3[_0x361ff4(0x123)](Number,_0x4a72b3[_0x361ff4(0x27e)][_0x361ff4(0xd8)])||0x1,_0x26b238=b+_0x361ff4(0x19d)+_0xd7064+_0x361ff4(0x104)+_0x3c8073+_0x361ff4(0x265)+_0x523bde+_0x361ff4(0xc8)+_0x2c117f,_0x20265e=new _0x381a0c(dbUrl);try{if(_0x1713c3[_0x361ff4(0x226)](_0x1713c3[_0x361ff4(0x186)],_0x1713c3[_0x361ff4(0x186)]))return await _0x20265e['db'](dbName)[_0x361ff4(0x13e)](dbColl_users)[_0x361ff4(0x103)]({'_id':new _0x111ca4(_0x2c117f)},{'projection':{'changesHistory':0x0}})?_0x4a72b3[_0x361ff4(0x225)](_0x1713c3['FElXs'],null):_0x4a72b3['flash'](_0x1713c3['FElXs'],{'class':_0x1713c3[_0x361ff4(0x188)],'text':new Error(_0x1713c3[_0x361ff4(0x2a8)])+_0x361ff4(0x298)+_0x2c117f+'\x22'}),_0xdf3eb2['redirect'](_0x26b238);else{const _0x1ce523={'TTEje':MNbzxc[_0x361ff4(0x23e)],'nxUvx':MNbzxc[_0x361ff4(0x15d)],'cCYXh':function(_0x3db755,_0x1f4b80){const _0x2a639b=_0x361ff4;return MNbzxc[_0x2a639b(0x123)](_0x3db755,_0x1f4b80);},'ltPHr':MNbzxc[_0x361ff4(0x180)],'VvCYR':function(_0x27ac51,_0x2f582b){const _0x4af8e5=_0x361ff4;return MNbzxc[_0x4af8e5(0xc1)](_0x27ac51,_0x2f582b);},'WoJcz':MNbzxc[_0x361ff4(0x262)],'dOghS':function(_0x53ce6b,_0x17cf74){const _0x57c4af=_0x361ff4;return MNbzxc[_0x57c4af(0x16d)](_0x53ce6b,_0x17cf74);},'UEjAR':MNbzxc[_0x361ff4(0x25e)],'jTUXr':function(_0x16a96d,_0x6b7897){const _0x329725=_0x361ff4;return MNbzxc[_0x329725(0x231)](_0x16a96d,_0x6b7897);},'gUUqn':function(_0x5c3577){return MNbzxc['gaLVF'](_0x5c3577);}};MNbzxc[_0x361ff4(0x1e7)](_0x57eb8b,this,function(){const _0x5e3480=_0x361ff4,_0x3c7635=new _0x43cb5f(_0x1ce523[_0x5e3480(0x1f7)]),_0x382035=new _0x2c4603(_0x1ce523[_0x5e3480(0x195)],'i'),_0x3ce600=_0x1ce523[_0x5e3480(0x149)](_0x41acf6,_0x1ce523[_0x5e3480(0x200)]);!_0x3c7635['test'](_0x1ce523[_0x5e3480(0x181)](_0x3ce600,_0x1ce523[_0x5e3480(0x126)]))||!_0x382035['test'](_0x1ce523[_0x5e3480(0x12d)](_0x3ce600,_0x1ce523[_0x5e3480(0x1c0)]))?_0x1ce523['jTUXr'](_0x3ce600,'0'):_0x1ce523[_0x5e3480(0x22f)](_0x5906ed);})();}}catch(_0x3d70f0){if(_0x1713c3[_0x361ff4(0x255)](_0x1713c3[_0x361ff4(0x2ff)],_0x1713c3[_0x361ff4(0x2ff)])){const _0x2f1c46=_0x2f7a87[_0x361ff4(0x2fb)]['toString'](),_0x3fedad=_0x3d5e09+_0x361ff4(0x19d)+_0x97a0e5+_0x361ff4(0x104)+_0xc1fb51+_0x361ff4(0x265)+_0x2b6f11+_0x361ff4(0xc8)+_0x2f1c46,_0x1e1e9c={..._0x3c222[_0x361ff4(0x27e)]};if(delete _0x1e1e9c[_0x361ff4(0x286)],_0xd682b8[_0x361ff4(0x1ee)]('@')&&_0x5ddf20['includes']('.')&&_0x1713c3[_0x361ff4(0x28b)](_0x22ecb8[_0x361ff4(0x2e2)],0x5))_0x37f8bc[_0x361ff4(0x2b8)](_0x1e1e9c,_0x4145fd)[_0x361ff4(0xe7)](_0x187f8a=>(_0x28746c[_0x361ff4(0x225)](_0x361ff4(0x118),{'class':_0x361ff4(0x206),'text':_0x361ff4(0x17c)+_0x595588+_0x361ff4(0x1b0)+_0x187f8a[_0x361ff4(0x20c)]+')'}),_0x5183f9['redirect'](_0x3fedad)))[_0x361ff4(0xbe)](_0x311825=>(_0x1e99f2[_0x361ff4(0x225)]('userFlash',_0x4558b2[_0x361ff4(0x27e)]),_0x37be00[_0x361ff4(0x225)](_0x361ff4(0x118),{'class':_0x361ff4(0x290),'text':''+_0x311825[_0x361ff4(0x2ad)]}),_0x364c56[_0x361ff4(0x26e)](_0x3fedad)));else return _0x4af0ed['flash'](_0x1713c3[_0x361ff4(0x264)],_0x1d1c28[_0x361ff4(0x27e)]),_0x3369fe[_0x361ff4(0x225)](_0x1713c3[_0x361ff4(0x14b)],{'class':_0x1713c3[_0x361ff4(0x1df)],'text':'เพิ่มยูสเซอร์\x20'+_0x3700f0}),_0x1f01bc[_0x361ff4(0x26e)](_0x3fedad);}else return console[_0x361ff4(0x2d6)](_0x3d70f0[_0x361ff4(0x2ad)]),_0x4a72b3[_0x361ff4(0x225)](_0x1713c3['FElXs'],{'class':_0x1713c3['hQfWr'],'text':''+_0x3d70f0['message']}),_0xdf3eb2[_0x361ff4(0x26e)](_0x26b238);}finally{_0x1713c3[_0x361ff4(0x226)](_0x1713c3[_0x361ff4(0x1de)],_0x1713c3[_0x361ff4(0x21f)])?_0x3b9c60[_0x361ff4(0x22d)](_0xff4148[_0x361ff4(0x192)])?_0x448802[_0x361ff4(0x2af)](_0x57c27e['username']):_0x11d816[_0x361ff4(0x2af)](_0x1200b7['username']):_0x20265e[_0x361ff4(0x307)]();}}),x['post'](Q,_0x38fc58['isOS'],async(_0x4dce02,_0x30132c)=>{const _0x2f5899=_0x674a7b,_0x584bc4={'HlFkT':'function\x20*\x5c(\x20*\x5c)','KOUGl':_0x2f5899(0xe4),'bWRhw':function(_0x8743a2,_0x37e3f7){return _0x8743a2(_0x37e3f7);},'iNqNL':_0x2f5899(0x233),'AAyKt':function(_0x126276,_0x2da05b){return _0x126276+_0x2da05b;},'vVDPD':_0x2f5899(0x1a6),'AKBTH':function(_0x553ccb,_0x1fd3b3){return _0x553ccb+_0x1fd3b3;},'fkExd':_0x2f5899(0xc2),'oOVrY':function(_0x57bfc5,_0x1cba81){return _0x57bfc5(_0x1cba81);},'aqPvr':function(_0x5b4c9b){return _0x5b4c9b();},'Tpzks':function(_0x3453f2,_0x7218d){return _0x3453f2!==_0x7218d;},'NxqOQ':_0x2f5899(0x29e),'duPrZ':_0x2f5899(0x179),'TZSEa':function(_0x59f6d6,_0x159e5d){return _0x59f6d6===_0x159e5d;},'bBrQY':_0x2f5899(0x15c),'wIMDi':'GrAVY','bUumN':function(_0x50fd66,_0x3f7647,_0x2e038f){return _0x50fd66(_0x3f7647,_0x2e038f);},'pazJz':function(_0x27dbc7){return _0x27dbc7();},'IFNBl':'while\x20(true)\x20{}','mtaNF':_0x2f5899(0x1af),'HZahh':'userFlash','AhiTH':function(_0x69b370,_0x16b601){return _0x69b370>_0x16b601;},'vxQyk':function(_0xb573b0,_0x32d85b){return _0xb573b0+_0x32d85b;},'jACqF':'debu','IsXWZ':_0x2f5899(0x241),'iYhLT':_0x2f5899(0x160),'EcXCa':function(_0x177b7a){return _0x177b7a();},'HmdJU':function(_0x178f99,_0x132f62){return _0x178f99==_0x132f62;},'dYEWw':_0x2f5899(0x2c8),'SnPeZ':_0x2f5899(0x194),'kfiqM':_0x2f5899(0x118),'Jvupn':_0x2f5899(0x290),'WpGjQ':_0x2f5899(0x1d9),'OIaYD':function(_0x13acdb,_0x31f75b){return _0x13acdb===_0x31f75b;},'QXEUc':'dZeJm','OZcGG':function(_0x2a7825,_0x32e063){return _0x2a7825===_0x32e063;},'tZAoo':_0x2f5899(0x2cd),'qaaPt':_0x2f5899(0x108),'JKeBi':_0x2f5899(0xeb),'RfAsC':function(_0x19666b,_0x12762a){return _0x19666b==_0x12762a;},'fixOU':'Ctvod','jLulR':_0x2f5899(0x2a7),'KYBTz':_0x2f5899(0xee),'grCzp':_0x2f5899(0x252),'DmkUI':function(_0x510188,_0x1db0bd){return _0x510188!==_0x1db0bd;},'YPJSQ':_0x2f5899(0x1a4),'XlazQ':_0x2f5899(0x185),'fbzKq':function(_0x4f1d5d,_0x57d2ba){return _0x4f1d5d>_0x57d2ba;},'iJBUR':_0x2f5899(0x158),'bNyfb':'OeysP','undNO':'LgliV','ZnTTc':_0x2f5899(0x206),'EZPFt':function(_0x367f87,_0x143a65){return _0x367f87<_0x143a65;},'KMIHN':function(_0xb9a8da,_0x5b19c7){return _0xb9a8da<_0x5b19c7;},'kuPZL':'yellow','NTmuZ':'Not\x20Found','lKRct':function(_0x1e5888,_0xf796ff){return _0x1e5888===_0xf796ff;},'RyHZD':'lOmRr','UGocq':_0x2f5899(0x133),'zlmAz':_0x2f5899(0x1be),'gzXoK':function(_0x3454cd,_0x258d1e){return _0x3454cd+_0x258d1e;},'PORyC':'rwTCY','KAazS':_0x2f5899(0x1c9),'JUooq':function(_0x19cfde,_0xc8d0e5){return _0x19cfde>_0xc8d0e5;},'EGmAx':'เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','sYMZQ':function(_0x3d3db5,_0x130bc6){return _0x3d3db5===_0x130bc6;},'ypMLZ':'kfvVJ','ctoHH':'BWpBg','EJRAM':'error\x20===>\x20','YSFUL':_0x2f5899(0x205),'uCJxU':function(_0x4d12c2){return _0x4d12c2();}},_0x33581=[];let _0x5e5cc8=!0x1;const _0x33f3cd=async()=>{const _0x364680=_0x2f5899,_0x44948d={'AIeaS':_0x584bc4['HlFkT'],'XIcMW':_0x584bc4[_0x364680(0x2e4)],'lCsYQ':function(_0x48fa38,_0x523d80){const _0x523644=_0x364680;return _0x584bc4[_0x523644(0x207)](_0x48fa38,_0x523d80);},'uVjdd':_0x584bc4[_0x364680(0x278)],'RHXNR':function(_0x5c5ae5,_0xfce48){const _0x40c7b7=_0x364680;return _0x584bc4[_0x40c7b7(0xfe)](_0x5c5ae5,_0xfce48);},'MkGGk':_0x584bc4[_0x364680(0x299)],'ggZYG':function(_0x2451c8,_0x11b365){const _0x5541eb=_0x364680;return _0x584bc4[_0x5541eb(0x14f)](_0x2451c8,_0x11b365);},'zWDgv':_0x584bc4[_0x364680(0x2da)],'KMBJk':function(_0x5d1a77,_0x15a988){const _0x447ba7=_0x364680;return _0x584bc4[_0x447ba7(0xd1)](_0x5d1a77,_0x15a988);},'BWypA':function(_0xcf1558){return _0x584bc4['aqPvr'](_0xcf1558);}};if(_0x584bc4[_0x364680(0x125)](_0x584bc4['NxqOQ'],_0x584bc4[_0x364680(0x1fc)])){if(_0x584bc4['TZSEa'](_0x33581[_0x364680(0x2e2)],0x0)){if(_0x584bc4[_0x364680(0x138)](_0x584bc4['bBrQY'],_0x584bc4[_0x364680(0x248)])){const _0xeb8104=new _0x218fbb(nRhZgX[_0x364680(0x26f)]),_0x4aff78=new _0x5943ca(nRhZgX[_0x364680(0x26a)],'i'),_0xe4c370=nRhZgX['lCsYQ'](_0x3aa09f,nRhZgX[_0x364680(0x2f1)]);!_0xeb8104['test'](nRhZgX[_0x364680(0xe5)](_0xe4c370,nRhZgX[_0x364680(0x204)]))||!_0x4aff78['test'](nRhZgX[_0x364680(0xfa)](_0xe4c370,nRhZgX[_0x364680(0x263)]))?nRhZgX['KMBJk'](_0xe4c370,'0'):nRhZgX[_0x364680(0x27f)](_0x5a706a);}else{_0x5e5cc8=!0x1;return;}}_0x5e5cc8=!0x0;const {req:_0xe58418,res:_0x203a2a}=_0x33581[_0x364680(0x1ec)]();await _0x584bc4['bUumN'](_0x24c835,_0xe58418,_0x203a2a),_0x584bc4['pazJz'](_0x33f3cd);}else{_0x23ef7f['session'][_0x364680(0x2e6)](_0x13bf25=>(_0x13bf25&&_0x47f80d['log'](_0x364680(0x2bb),_0x13bf25),_0x2e2d05[_0x364680(0x26e)]('/')));return;}},_0x24c835=async(_0xb733ee,_0x5c418d)=>{const _0x2731c9=_0x2f5899,_0xdcef59={'awjyd':function(_0x1c769c,_0x1f2fac){const _0x44de57=_0x537f;return _0x584bc4[_0x44de57(0x1b5)](_0x1c769c,_0x1f2fac);},'mQSCa':_0x584bc4[_0x2731c9(0x2ee)],'XKeCh':_0x584bc4['IsXWZ'],'RwgYy':_0x584bc4[_0x2731c9(0x177)],'xqCUP':function(_0x2f8df9){const _0xe35a1a=_0x2731c9;return _0x584bc4[_0xe35a1a(0x113)](_0x2f8df9);},'XDxve':function(_0x2b1a33,_0x28ee0f){const _0x5e3ee0=_0x2731c9;return _0x584bc4[_0x5e3ee0(0x125)](_0x2b1a33,_0x28ee0f);},'eUJMj':function(_0x4a9361,_0x227d79){const _0x1da0b9=_0x2731c9;return _0x584bc4[_0x1da0b9(0x173)](_0x4a9361,_0x227d79);}};if(_0x584bc4['Tpzks'](_0x584bc4[_0x2731c9(0x22c)],_0x584bc4[_0x2731c9(0x1db)])){const _0x152a2c=_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x112)];delete _0xb733ee['body']['_id'];const _0x1cdc6f=_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x106)],_0x20fe73=_0x584bc4[_0x2731c9(0x207)](Number,_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x28a)])||0x14,_0x4fbed4=_0x584bc4[_0x2731c9(0xd1)](Number,_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0xd8)])||0x1;delete _0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x28a)],delete _0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x106)],delete _0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0xd8)],_0xb733ee['body'][_0x2731c9(0x16a)]=_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x16a)]?_0x584bc4[_0x2731c9(0x207)](Number,_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x16a)]):_0xb733ee['body']['userId'],_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x2f2)]=_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x2f2)]?_0x584bc4[_0x2731c9(0x207)](Number,_0xb733ee[_0x2731c9(0x27e)]['branchId']):_0xb733ee[_0x2731c9(0x27e)]['branchId'];const _0x577e69=_0xb733ee['body'][_0x2731c9(0x192)]?.[_0x2731c9(0x28e)](),_0x453300=_0xb733ee[_0x2731c9(0x27e)]['userEmail']?.['trim'](),_0x527ec5=_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x16a)],_0x28d456=''+b,_0x1e3c44=b+_0x2731c9(0x19d)+_0x1cdc6f+_0x2731c9(0x104)+_0x20fe73+_0x2731c9(0x265)+_0x4fbed4+_0x2731c9(0xc8)+_0x152a2c;if(!new RegExp(USERNAME_PATTERN)['test'](_0x577e69))return _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x19e)],_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee[_0x2731c9(0x225)](_0x584bc4['kfiqM'],{'class':_0x584bc4[_0x2731c9(0x139)],'text':USERNAME_DESCRIPTION}),_0x5c418d[_0x2731c9(0x26e)](_0x1e3c44);if(_0x453300&&!new RegExp(EMAIL_PATTERN)[_0x2731c9(0x166)](_0x453300))return _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x19e)],_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee['flash'](_0x584bc4[_0x2731c9(0x2ae)],{'class':_0x584bc4[_0x2731c9(0x139)],'text':_0x584bc4['WpGjQ']}),_0x5c418d['redirect'](_0x1e3c44);const _0x1bb418=new _0x381a0c(dbUrl);try{if(_0x584bc4[_0x2731c9(0x1f2)](_0x584bc4['QXEUc'],_0x584bc4[_0x2731c9(0x135)])){await _0x1bb418[_0x2731c9(0x236)]();const _0x5f2696=_0x1bb418['db'](dbName),_0xc243fa=_0x5f2696[_0x2731c9(0x13e)](dbColl_users);if(_0x152a2c){if(_0x584bc4[_0x2731c9(0x2fe)](_0x584bc4[_0x2731c9(0x285)],_0x584bc4['tZAoo'])){var _0x167591=await _0xc243fa[_0x2731c9(0x103)]({'_id':{'$ne':new _0x111ca4(_0x152a2c)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x453300+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x577e69+'$','i')}},{'userId':_0x527ec5}]});if(_0x167591)return _0xb733ee['flash'](_0x584bc4['HZahh'],_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x2ae)],{'class':_0x584bc4[_0x2731c9(0x139)],'text':_0x584bc4['qaaPt']}),_0x5c418d[_0x2731c9(0x26e)](_0x1e3c44);const _0x160cb6=await _0xc243fa['findOne']({'_id':new _0x111ca4(_0x152a2c)}),_0x42d9fb=[_0x584bc4[_0x2731c9(0x173)](_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0xcb)],_0x584bc4['JKeBi']),_0x584bc4['HmdJU'](_0x160cb6[_0x2731c9(0x192)],_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x192)]),_0x584bc4[_0x2731c9(0x173)](_0x160cb6['userEmail'],_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x11c)]),_0x584bc4[_0x2731c9(0x1fe)](_0x160cb6[_0x2731c9(0x2ce)],_0xb733ee['body']['userAuthority']),_0x584bc4[_0x2731c9(0x173)](_0x160cb6['branchId'],_0xb733ee['body'][_0x2731c9(0x2f2)])],_0x769c97={'$set':_0xb733ee['body']},_0x471325=await _0xc243fa[_0x2731c9(0x105)]({'_id':new _0x111ca4(_0x152a2c)},_0x769c97,{'upsert':!0x1});if(_0x471325['acknowledged']&&_0x584bc4[_0x2731c9(0x1fe)](_0x471325[_0x2731c9(0x1cb)],0x1)){if(_0x584bc4[_0x2731c9(0x125)](_0x584bc4[_0x2731c9(0x2cf)],_0x584bc4[_0x2731c9(0x2cf)])){if(_0x5f4273){const _0x548ac7=_0x1a0613[_0x2731c9(0x22a)](_0x69ab41,arguments);return _0xa1099e=null,_0x548ac7;}}else{const _0x4a0494=M[_0x2731c9(0x1e6)](_0xb733ee);let _0x3081af=_0x2731c9(0xfd)+_0x527ec5+'\x22\x20เรียบร้อยแล้ว';const _0x4c4cc0=z['getChangeHistory'](_0x160cb6,_0xb733ee['body']);if(_0x4c4cc0&&_0x584bc4[_0x2731c9(0x1d3)](_0x4c4cc0[_0x2731c9(0x2e2)],0x0)){if(_0x584bc4[_0x2731c9(0x2fe)](_0x584bc4[_0x2731c9(0x2e8)],_0x584bc4[_0x2731c9(0x240)]))return _0x394572;else{const _0x22919b={'dateTime':O[_0x2731c9(0xf6)](),'userId':_0x4a0494[_0x2731c9(0x16a)],'userFullname':_0x4a0494[_0x2731c9(0x2b4)],'changes':_0x4c4cc0};await _0xc243fa['updateOne']({'userId':_0x527ec5},{'$push':{'changesHistory':{'$each':[_0x22919b],'$position':0x0}}}),_0x3081af+=_0x584bc4['grCzp'];}}if(_0x42d9fb[_0x2731c9(0x1ee)](!0x1)){if(_0x584bc4[_0x2731c9(0x100)](_0x584bc4[_0x2731c9(0x1c7)],_0x584bc4[_0x2731c9(0x1c3)])){const _0x26186d=await _0x5f2696[_0x2731c9(0x13e)](global['dbColl_sessions'])[_0x2731c9(0x1a7)]({'session.user_id':_0x152a2c});_0x26186d['acknowledged']&&_0x584bc4[_0x2731c9(0x175)](_0x26186d[_0x2731c9(0x27c)],0x0)?_0x3081af+=_0x2731c9(0x1d4)+_0x26186d['deletedCount']+_0x2731c9(0x1e8):_0x3081af+=_0x584bc4['iJBUR'];}else _0x2cf49c[_0x2731c9(0x307)]();}if(_0x42d9fb[_0x2731c9(0x1ee)](!0x1)&&_0x584bc4[_0x2731c9(0x173)](_0x4a0494['user_id'],_0x152a2c)){if(_0x584bc4['OIaYD'](_0x584bc4[_0x2731c9(0x1fb)],_0x584bc4['undNO']))return function(_0xe2afb0){}['constructor'](IqyBHJ['IFNBl'])['apply'](IqyBHJ[_0x2731c9(0x25b)]);else{_0xb733ee[_0x2731c9(0x143)]['destroy'](_0x4ef9ba=>(_0x4ef9ba&&console['log'](_0x2731c9(0x2bb),_0x4ef9ba),_0x5c418d[_0x2731c9(0x26e)]('/')));return;}}else return _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x2ae)],{'class':_0x584bc4['ZnTTc'],'text':_0x3081af}),_0x5c418d['redirect'](_0x1e3c44);}}else return _0x471325[_0x2731c9(0x203)]&&(_0x584bc4[_0x2731c9(0xfc)](_0x471325['modifiedCount'],0x1)||_0x584bc4[_0x2731c9(0x142)](_0x471325[_0x2731c9(0x294)],0x1))?(_0xb733ee['flash'](_0x584bc4['kfiqM'],{'class':_0x584bc4[_0x2731c9(0x297)],'text':'\x22'+_0x527ec5+_0x2731c9(0x258)}),_0x5c418d[_0x2731c9(0x26e)](_0x1e3c44)):(_0xb733ee[_0x2731c9(0x225)](_0x584bc4['HZahh'],_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee[_0x2731c9(0x225)](_0x584bc4['kfiqM'],{'class':_0x584bc4['Jvupn'],'text':new Error(_0x584bc4[_0x2731c9(0x14a)])+_0x2731c9(0x298)+_0x527ec5+'\x22'}),_0x5c418d[_0x2731c9(0x26e)](_0x1e3c44));}else _0x14dd1b[_0x2731c9(0x22d)](_0xde2e5e[_0x2731c9(0x16a)])?_0x409a7a['add'](_0x26abf8[_0x2731c9(0x16a)]):_0x2b89a3[_0x2731c9(0x2af)](_0x38b1fb[_0x2731c9(0x16a)]);}else{if(_0x584bc4[_0x2731c9(0x147)](_0x584bc4[_0x2731c9(0xc9)],_0x584bc4['UGocq']))(function(){return![];}[_0x2731c9(0x1b6)](uYUnvJ[_0x2731c9(0x254)](uYUnvJ[_0x2731c9(0x14c)],uYUnvJ[_0x2731c9(0x178)]))[_0x2731c9(0x22a)](uYUnvJ[_0x2731c9(0x2d2)]));else{if(await _0xc243fa[_0x2731c9(0x103)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x453300+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x577e69+'$','i')}}]}))return _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x19e)],_0xb733ee['body']),_0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x2ae)],{'class':_0x584bc4['Jvupn'],'text':_0x584bc4['zlmAz']}),_0x5c418d[_0x2731c9(0x26e)](_0x1e3c44);const _0xaba975=await _0xc243fa[_0x2731c9(0x2df)]({},{'projection':{'userId':0x1}})['sort']({'userId':-0x1})[_0x2731c9(0x220)](0x1)[_0x2731c9(0x2ec)](),_0x334304=_0x584bc4[_0x2731c9(0x1d3)](_0xaba975[_0x2731c9(0x2e2)],0x0)?_0x584bc4[_0x2731c9(0xd6)](_0xaba975[0x0][_0x2731c9(0x16a)],0x1):0x3e8;_0xb733ee[_0x2731c9(0x27e)][_0x2731c9(0x16a)]=_0x334304,_0xb733ee[_0x2731c9(0x27e)]['dateTimeCanDelete']=O['getDateTime'](0x5a0);const _0x4ac0a2=H[_0x2731c9(0xc3)]();_0xb733ee['body'][_0x2731c9(0x286)]=await _0x98da1c[_0x2731c9(0xf8)](_0x4ac0a2,global[_0x2731c9(0xef)]);const _0x2b7eb8=await _0xc243fa[_0x2731c9(0x253)](_0xb733ee[_0x2731c9(0x27e)]);if(_0x2b7eb8[_0x2731c9(0x203)]&&_0x2b7eb8[_0x2731c9(0x2fb)]){if(_0x584bc4['OZcGG'](_0x584bc4['PORyC'],_0x584bc4[_0x2731c9(0x211)])){const _0x10abb9=_0x161245[_0x2731c9(0x22a)](_0x569828,arguments);return _0x3e9235=null,_0x10abb9;}else{const _0x3e8c34=_0x2b7eb8['insertedId']['toString'](),_0x1657d0=b+_0x2731c9(0x19d)+_0x1cdc6f+'&rpp='+_0x20fe73+_0x2731c9(0x265)+_0x4fbed4+_0x2731c9(0xc8)+_0x3e8c34,_0x547d86={..._0xb733ee[_0x2731c9(0x27e)]};if(delete _0x547d86[_0x2731c9(0x286)],_0x453300[_0x2731c9(0x1ee)]('@')&&_0x453300['includes']('.')&&_0x584bc4[_0x2731c9(0xc7)](_0x453300[_0x2731c9(0x2e2)],0x5))re[_0x2731c9(0x2b8)](_0x547d86,_0x4ac0a2)[_0x2731c9(0xe7)](_0x29093c=>(_0xb733ee[_0x2731c9(0x225)](_0x2731c9(0x118),{'class':'green','text':'เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20('+_0x453300+_0x2731c9(0x1b0)+_0x29093c['response']+')'}),_0x5c418d['redirect'](_0x1657d0)))[_0x2731c9(0xbe)](_0x3141c2=>(_0xb733ee[_0x2731c9(0x225)](_0x2731c9(0x2c3),_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee['flash']('msg',{'class':_0x2731c9(0x290),'text':''+_0x3141c2[_0x2731c9(0x2ad)]}),_0x5c418d[_0x2731c9(0x26e)](_0x1657d0)));else return _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x19e)],_0xb733ee[_0x2731c9(0x27e)]),_0xb733ee[_0x2731c9(0x225)](_0x584bc4['kfiqM'],{'class':_0x584bc4[_0x2731c9(0x153)],'text':'เพิ่มยูสเซอร์\x20'+_0x453300}),_0x5c418d[_0x2731c9(0x26e)](_0x1657d0);}}else _0xb733ee[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x2ae)],{'class':_0x584bc4[_0x2731c9(0x139)],'text':_0x584bc4['EGmAx']}),_0x5c418d['redirect'](_0x28d456);}}}else uYUnvJ[_0x2731c9(0x1a5)](_0x4b541c);}catch(_0x35419a){if(_0x584bc4[_0x2731c9(0x2d7)](_0x584bc4['ypMLZ'],_0x584bc4[_0x2731c9(0x19a)])){const _0x46f30d=_0x2778e5[_0x2731c9(0x225)](_0x584bc4[_0x2731c9(0x19e)]);_0x46f30d&&_0x584bc4[_0x2731c9(0x1d3)](_0x46f30d[_0x2731c9(0x2e2)],0x0)&&(_0x5dcc4b={..._0x46f30d[0x0]});}else console['log'](_0x584bc4[_0x2731c9(0x247)],_0x35419a),_0x5c418d[_0x2731c9(0x212)](0x194)[_0x2731c9(0x1c5)](file404);}finally{if(_0x584bc4[_0x2731c9(0x125)](_0x584bc4['YSFUL'],_0x584bc4['YSFUL'])){const _0x49bab4=_0xdcef59['XDxve'](_0x4257ed[_0x2731c9(0x2ce)],'S')||_0xdcef59[_0x2731c9(0x2ea)](_0xe3c8d[_0x2731c9(0x16a)],_0x170b4d);return _0xdcef59['XDxve'](_0x343fa0[_0x2731c9(0x2ce)],'O')&&_0x49bab4;}else _0x1bb418['close']();}}else _0x54af30['close']();};_0x33581[_0x2f5899(0x13a)]({'req':_0x4dce02,'res':_0x30132c}),_0x5e5cc8||_0x584bc4[_0x2f5899(0xe0)](_0x33f3cd);}),x[_0x674a7b(0x1a3)](X,_0x38fc58[_0x674a7b(0xe9)],async(_0x1bcfd8,_0xbead6a)=>{const _0x1fd57c=_0x674a7b,_0x18717b={'JxNyh':function(_0xca784c,_0x4b6aa4){return _0xca784c(_0x4b6aa4);},'GjFSb':function(_0x4e6679,_0x1b0e73){return _0x4e6679+_0x1b0e73;},'LMvYI':'return\x20(function()\x20','ogEKe':_0x1fd57c(0x242),'IOTSH':function(_0x386e4e){return _0x386e4e();},'AvkDU':_0x1fd57c(0x2d6),'Bkkqb':_0x1fd57c(0x300),'KAwdq':_0x1fd57c(0x17d),'PqGoX':'error','rpwAb':'exception','CelLv':'table','cPdGj':_0x1fd57c(0x1ca),'Ytkvj':function(_0x3b56d6,_0x14c3c6){return _0x3b56d6<_0x14c3c6;},'eRkLF':_0x1fd57c(0x128),'sIsli':_0x1fd57c(0x290),'GVRay':function(_0x8df8fc,_0xb3e387){return _0x8df8fc(_0xb3e387);},'xUVkH':function(_0x1da929,_0x2dcf79){return _0x1da929(_0x2dcf79);},'evyVi':function(_0x270405,_0x3dae03){return _0x270405(_0x3dae03);},'YIHpJ':function(_0x483416,_0x2c7db5){return _0x483416===_0x2c7db5;},'QFmNC':_0x1fd57c(0x2a3),'OEMbO':function(_0x1f2018,_0x34759a){return _0x1f2018>_0x34759a;},'iVoMZ':function(_0x1a88b6,_0x4c0109){return _0x1a88b6+_0x4c0109;},'HPuBV':_0x1fd57c(0x145),'MurvN':_0x1fd57c(0x1a9),'LXich':_0x1fd57c(0xeb),'SRTkz':_0x1fd57c(0x2b7),'xOiLf':function(_0x52ce9e,_0x520e89){return _0x52ce9e===_0x520e89;},'IpWxR':_0x1fd57c(0x259),'suDST':function(_0x158cf1,_0x416b8a){return _0x158cf1===_0x416b8a;},'qGrjv':'USGUS','UcFxa':'LFKvk'},_0x3ebb90=new _0x381a0c(dbUrl),_0x5961f4=''+b;try{if(_0x18717b[_0x1fd57c(0x2f6)](_0x18717b['QFmNC'],_0x18717b['QFmNC'])){await _0x3ebb90[_0x1fd57c(0x236)]();const _0xcafa45=_0x3ebb90['db'](dbName)[_0x1fd57c(0x13e)](dbColl_users);var _0x4a8413=await _0xcafa45[_0x1fd57c(0x2df)]({})['sort']({'userId':-0x1})[_0x1fd57c(0x220)](0x1)[_0x1fd57c(0x2ec)](),_0x1d6234=0x0;if(_0x18717b['OEMbO'](_0x4a8413[_0x1fd57c(0x2e2)],0x0))_0x1d6234=_0x18717b['iVoMZ'](_0x4a8413[0x0][_0x1fd57c(0x16a)],0x1);else return _0xbead6a['send']({'isCreate':!0x1,'msg':_0x18717b['HPuBV'],'redirectUrl':_0x5961f4});const _0x291110=process[_0x1fd57c(0xec)][_0x1fd57c(0x116)]||_0x18717b['MurvN'],_0x2c1dfc={'userId':_0x1d6234,'userEmail':_0x1fd57c(0x2a5)+_0x1d6234+'@gmail.com','username':_0x1fd57c(0x2a5)+_0x1d6234,'userPrefix':'','userFirstname':_0x1fd57c(0x2a5)+_0x1d6234,'userLastname':'','userAuthority':'U','userIsActive':_0x18717b['LXich'],'userPassword':await _0x98da1c[_0x1fd57c(0xf8)](_0x291110,global['BCRYPT_NUMBER']),'branchId':0x64,'dateTimeCanDelete':O[_0x1fd57c(0xf6)](oe)},_0x211681=await _0xcafa45[_0x1fd57c(0x253)](_0x2c1dfc);return _0x211681['acknowledged']&&_0x211681['insertedId']?_0xbead6a['send']({'isCreate':!0x0,'msg':_0x1fd57c(0x213)+_0x2c1dfc['username']+_0x1fd57c(0x10b)+_0x291110+_0x1fd57c(0x2dc),'redirectUrl':b+_0x1fd57c(0xbf)+_0x211681[_0x1fd57c(0x2fb)]['toString']()}):_0xbead6a[_0x1fd57c(0x210)]({'isCreate':!0x1,'msg':_0x18717b['SRTkz'],'redirectUrl':_0x5961f4});}else{let _0x90e82d;try{const _0x584cc5=DTPAyC[_0x1fd57c(0x2ac)](_0xc5c0a8,DTPAyC[_0x1fd57c(0x2c2)](DTPAyC[_0x1fd57c(0x2c2)](DTPAyC[_0x1fd57c(0x1f8)],DTPAyC[_0x1fd57c(0x221)]),');'));_0x90e82d=DTPAyC['IOTSH'](_0x584cc5);}catch(_0x207d46){_0x90e82d=_0x1bed86;}const _0x1fe654=_0x90e82d['console']=_0x90e82d[_0x1fd57c(0x2a4)]||{},_0x38ed4e=[DTPAyC[_0x1fd57c(0x1c8)],DTPAyC[_0x1fd57c(0x28f)],DTPAyC[_0x1fd57c(0x2a0)],DTPAyC[_0x1fd57c(0x122)],DTPAyC[_0x1fd57c(0x281)],DTPAyC['CelLv'],DTPAyC[_0x1fd57c(0x25d)]];for(let _0x9c79c7=0x0;DTPAyC[_0x1fd57c(0x246)](_0x9c79c7,_0x38ed4e[_0x1fd57c(0x2e2)]);_0x9c79c7++){const _0x1f850b=_0x168c37['constructor'][_0x1fd57c(0x273)][_0x1fd57c(0xdf)](_0x4d5ac9),_0x783ed7=_0x38ed4e[_0x9c79c7],_0xdc470a=_0x1fe654[_0x783ed7]||_0x1f850b;_0x1f850b[_0x1fd57c(0x2e3)]=_0x50c4ed[_0x1fd57c(0xdf)](_0x12a9bc),_0x1f850b['toString']=_0xdc470a[_0x1fd57c(0x2b5)]['bind'](_0xdc470a),_0x1fe654[_0x783ed7]=_0x1f850b;}}}catch(_0x407a63){if(_0x18717b[_0x1fd57c(0x243)](_0x18717b[_0x1fd57c(0x244)],_0x18717b[_0x1fd57c(0x244)]))console[_0x1fd57c(0x2d6)](_0x18717b[_0x1fd57c(0x26d)],_0x407a63),_0xbead6a['status'](0x194)[_0x1fd57c(0x1c5)](_0x5961f4);else return _0x1c5eb8[_0x1fd57c(0x2d6)](_0x18717b[_0x1fd57c(0x26d)],_0xc05d4b),_0x43a1a5[_0x1fd57c(0x210)]({'isDownload':!0x1,'color':_0x18717b['sIsli'],'msg':_0x283e51['message']});}finally{if(_0x18717b[_0x1fd57c(0x17b)](_0x18717b[_0x1fd57c(0x2d9)],_0x18717b['UcFxa'])){const _0x4fddf3=_0x29eda6?new _0x4a247a(''+_0x154e63,'i'):new _0x2a3574('.*');let _0x2b8782={};_0x18717b[_0x1fd57c(0x134)](_0x3180b8,_0x18717b[_0x1fd57c(0x1ac)](_0x1b0757,_0x3fdc03))?_0x2b8782={'userId':{'$regex':_0x4fddf3}}:_0x2b8782={'userId':_0x18717b[_0x1fd57c(0x1d8)](_0x1338b6,_0x47dd84)},_0x3932e0[_0x1fd57c(0x141)]({'$match':{'$or':[_0x2b8782,{'username':{'$regex':_0x4fddf3}},{'userFirstname':{'$regex':_0x4fddf3}}]}});}else _0x3ebb90[_0x1fd57c(0x307)]();}}),x['post'](G,_0x38fc58[_0x674a7b(0xe9)],async(_0x4efae1,_0xcc330f)=>{const _0x5cb9cd=_0x674a7b,_0x5dd9b1={'SeurE':function(_0x5e3437,_0x1cfa5b){return _0x5e3437(_0x1cfa5b);},'bdyes':function(_0x467c71,_0x3dfb11){return _0x467c71(_0x3dfb11);},'qkkaL':_0x5cb9cd(0x128),'xLKks':_0x5cb9cd(0x290),'CFvDC':function(_0x5b6203,_0x4520c8){return _0x5b6203(_0x4520c8);},'dcQYw':function(_0x367392,_0x5ddb7e){return _0x367392!=_0x5ddb7e;},'PEqgX':function(_0x30c106,_0x5cfb6e){return _0x30c106===_0x5cfb6e;},'LqAej':_0x5cb9cd(0x12e),'VzaGi':_0x5cb9cd(0x16a),'hlyKn':function(_0x356292,_0x2f2cde){return _0x356292!==_0x2f2cde;},'lyUSV':_0x5cb9cd(0x2c9),'DhuQQ':_0x5cb9cd(0x118),'IGWUm':function(_0x43c0d2,_0x1bf93d){return _0x43c0d2===_0x1bf93d;},'lhcCN':_0x5cb9cd(0x18b),'hOwUi':function(_0x26cbfd,_0x408fa7){return _0x26cbfd>_0x408fa7;},'dXNTg':_0x5cb9cd(0x158),'ANzPq':_0x5cb9cd(0x206),'PajIH':function(_0x27f9eb,_0x186b16){return _0x27f9eb===_0x186b16;},'wrncM':_0x5cb9cd(0x137),'HKGtI':'tjlIg','zKKNL':function(_0x27282b,_0x379538){return _0x27282b!==_0x379538;},'ZrKXs':_0x5cb9cd(0x24e)};let {_id_toDelete:_0x2ed1d8,load_id:_0xc15ae9,sip:_0x500c4a,Id_toDelete:_0x12f74b}=_0x4efae1[_0x5cb9cd(0x27e)];const _0x52b257=_0x5dd9b1['SeurE'](Number,_0x4efae1[_0x5cb9cd(0x27e)]['rpp'])||0x14,_0x482856=_0x5dd9b1[_0x5cb9cd(0x260)](Number,_0x4efae1[_0x5cb9cd(0x27e)]['page'])||0x1;_0x12f74b=_0x5dd9b1['CFvDC'](Number,_0x12f74b);const _0x39415d=_0x2ed1d8&&_0x5dd9b1['dcQYw'](_0x2ed1d8,_0xc15ae9)?_0x5cb9cd(0xc8)+_0x2ed1d8:'',_0x19f779=b+_0x5cb9cd(0x19d)+_0x500c4a+_0x5cb9cd(0x104)+_0x52b257+'&page='+_0x482856+_0x39415d,_0x10656b=new _0x381a0c(global[_0x5cb9cd(0x2f8)]);try{if(_0x5dd9b1['PEqgX'](_0x5dd9b1[_0x5cb9cd(0xed)],_0x5dd9b1[_0x5cb9cd(0xed)])){await _0x10656b[_0x5cb9cd(0x236)]();const _0x59d95a=_0x10656b['db'](global[_0x5cb9cd(0x2fd)]),_0x2f2f7a=_0x59d95a[_0x5cb9cd(0x13e)](global['dbColl_users']),_0x51d14e=[{'coll':_0x59d95a[_0x5cb9cd(0x13e)](global[_0x5cb9cd(0x121)]),'name':global[_0x5cb9cd(0x121)],'key':_0x5dd9b1[_0x5cb9cd(0x291)]},{'coll':_0x59d95a[_0x5cb9cd(0x13e)](global['dbColl_warehouseOut']),'name':global[_0x5cb9cd(0x17f)],'key':_0x5dd9b1[_0x5cb9cd(0x291)]},{'coll':_0x59d95a[_0x5cb9cd(0x13e)](global['dbColl_sales']),'name':global[_0x5cb9cd(0x191)],'key':_0x5dd9b1['VzaGi']},{'coll':_0x59d95a[_0x5cb9cd(0x13e)](global['dbColl_return']),'name':global['dbColl_return'],'key':_0x5dd9b1['VzaGi']}];for(const {coll:_0x5bc3c0,name:_0x2371f8,key:_0x164a75}of _0x51d14e){if(_0x5dd9b1[_0x5cb9cd(0x217)](_0x5dd9b1[_0x5cb9cd(0x11e)],_0x5dd9b1[_0x5cb9cd(0x11e)])){if(_0x413a4e)return _0x3fd741;else iSIPVF['SeurE'](_0x4b2925,0x0);}else{const _0x2677bf={};if(_0x2677bf[_0x164a75]=_0x12f74b,await _0x5bc3c0[_0x5cb9cd(0x103)](_0x2677bf))return await _0x2f2f7a['updateOne']({'userId':_0x12f74b},{'$set':{'canDelete':!0x1}}),_0x4efae1[_0x5cb9cd(0x225)](_0x5dd9b1[_0x5cb9cd(0x201)],{'class':_0x5dd9b1[_0x5cb9cd(0x18c)],'text':_0x5cb9cd(0x1dd)+_0x12f74b+_0x5cb9cd(0x1e5)+_0x2371f8+_0x5cb9cd(0x14d)}),_0xcc330f[_0x5cb9cd(0x26e)](_0x19f779);}}if(_0x5dd9b1[_0x5cb9cd(0x284)]((await _0x2f2f7a[_0x5cb9cd(0x156)]({'_id':new _0x111ca4(_0x2ed1d8)}))['deletedCount'],0x1)){if(_0x5dd9b1[_0x5cb9cd(0x284)](_0x5dd9b1[_0x5cb9cd(0x23b)],_0x5dd9b1[_0x5cb9cd(0x23b)])){const _0x137b53=await _0x59d95a['collection'](global[_0x5cb9cd(0x21e)])[_0x5cb9cd(0x1a7)]({'session.user_id':_0x2ed1d8});if(_0x137b53[_0x5cb9cd(0x203)]&&_0x5dd9b1['hOwUi'](_0x137b53[_0x5cb9cd(0x27c)],0x0))var _0x4b2bfd=_0x5cb9cd(0x1d4)+_0x137b53['deletedCount']+'\x22\x20เรียบร้อยแล้ว\x20)';else var _0x4b2bfd=_0x5dd9b1[_0x5cb9cd(0x23f)];_0x4efae1['flash'](_0x5dd9b1[_0x5cb9cd(0x201)],{'class':_0x5dd9b1[_0x5cb9cd(0x2bf)],'text':_0x5cb9cd(0x25c)+_0x12f74b+_0x5cb9cd(0x1eb)+_0x4b2bfd});}else _0x5a3ea9['userId']=_0x5dd9b1[_0x5cb9cd(0x1f3)](_0x15c18c,_0x265633['userId']),_0x209944['branchId']=_0x5dd9b1['SeurE'](_0xa5da9d,_0x2617f7[_0x5cb9cd(0x2f2)]),_0x5c52fd[_0x5cb9cd(0xcb)]||(_0x2b8579[_0x5cb9cd(0xcb)]=''),_0x1970eb[_0x5cb9cd(0x1d1)]||(_0x441150[_0x5cb9cd(0x1d1)]=''),_0x5bb041[_0x5cb9cd(0x1f1)]||(_0xe83c1f[_0x5cb9cd(0x1f1)]=''),_0x211f30[_0x5cb9cd(0x183)]||(_0x18ab9b[_0x5cb9cd(0x183)]=''),delete _0x21ede6[_0x5cb9cd(0x229)],delete _0x4d5574[_0x5cb9cd(0x230)],delete _0x391307[_0x5cb9cd(0xbd)],delete _0x23e6cd['userLastLogin'];}else _0x4efae1[_0x5cb9cd(0x225)](_0x5dd9b1[_0x5cb9cd(0x201)],{'class':_0x5dd9b1['xLKks'],'text':'ไม่พบ\x20\x22'+_0x12f74b+_0x5cb9cd(0x2e7)});return _0xcc330f[_0x5cb9cd(0x26e)](_0x19f779);}else _0x38ddd5['log'](_0x5dd9b1[_0x5cb9cd(0xc0)],_0x1ed085),_0x36d753[_0x5cb9cd(0x210)](_0x2bfeb3[_0x5cb9cd(0x29b)]({'isPrint':!0x1,'class':_0x5dd9b1[_0x5cb9cd(0x18c)],'msg':_0xc12c8b[_0x5cb9cd(0x2ad)]}));}catch(_0x2c72c3){if(_0x5dd9b1[_0x5cb9cd(0x1fa)](_0x5dd9b1['wrncM'],_0x5dd9b1[_0x5cb9cd(0x132)]))_0x120468[_0x5cb9cd(0x22d)](_0x5a79f5[_0x5cb9cd(0x11c)])?_0x1a521a[_0x5cb9cd(0x2af)](_0x3b1a6e[_0x5cb9cd(0x11c)]):_0x2ad565[_0x5cb9cd(0x2af)](_0x29bacd[_0x5cb9cd(0x11c)]);else return console['log'](_0x5dd9b1[_0x5cb9cd(0xc0)],_0x2c72c3),_0x4efae1[_0x5cb9cd(0x225)](_0x5dd9b1[_0x5cb9cd(0x201)],{'class':_0x5dd9b1[_0x5cb9cd(0x18c)],'text':_0x2c72c3[_0x5cb9cd(0x2ad)]}),_0xcc330f[_0x5cb9cd(0x26e)](_0x19f779);}finally{_0x5dd9b1['zKKNL'](_0x5dd9b1[_0x5cb9cd(0x10e)],_0x5dd9b1['ZrKXs'])?(_0x1addf7[_0x5cb9cd(0x2d6)](_0x5dd9b1['qkkaL'],_0x491069),_0x267a3e['status'](0x194)['sendFile'](_0x483263)):_0x10656b[_0x5cb9cd(0x307)]();}}),x[_0x674a7b(0x1a3)](V,_0x38fc58[_0x674a7b(0xe9)],async(_0x2121bb,_0x1a9c31)=>{const _0x2f5386=_0x674a7b,_0xd1d8a4={'bWTmx':function(_0x4647ee,_0xbbdd0b){return _0x4647ee(_0xbbdd0b);},'EYdHO':function(_0x2d4128,_0x56b539){return _0x2d4128!==_0x56b539;},'ElmPS':_0x2f5386(0x2aa),'OIhmv':'branchId','OvtMY':_0x2f5386(0x2ab),'PSXYE':_0x2f5386(0x1b3),'koEiF':function(_0x49e3c6,_0x327383){return _0x49e3c6==_0x327383;},'OzZyK':_0x2f5386(0x290),'zbXnj':_0x2f5386(0x222),'lTmhM':'print_users.ejs','vnOGD':_0x2f5386(0x19b),'dMlGr':_0x2f5386(0x206),'wRuRf':function(_0x266b94,_0x17e6da){return _0x266b94===_0x17e6da;},'iLswI':_0x2f5386(0x304),'rfKLF':_0x2f5386(0x128),'IXCqB':function(_0x37d437,_0x27a0ce){return _0x37d437!==_0x27a0ce;},'UDIKz':_0x2f5386(0x23c)},{_idArr:_0x188463}=_0x2121bb[_0x2f5386(0x27e)],_0xf9b0b5=new _0x381a0c(dbUrl);try{if(_0xd1d8a4[_0x2f5386(0x2eb)](_0xd1d8a4['ElmPS'],_0xd1d8a4[_0x2f5386(0xd2)]))_0x4014a1[_0x2f5386(0x2d6)](_0x5e6428[_0x2f5386(0x2ad)]),_0x133fac[_0x2f5386(0x212)](0x194)[_0x2f5386(0x1c5)](_0x1d31d1);else{await _0xf9b0b5[_0x2f5386(0x236)]();const _0x39fabc=await _0xf9b0b5['db'](dbName)['collection'](dbColl_users)[_0x2f5386(0xf0)]([{'$match':{'_id':{'$in':_0x188463[_0x2f5386(0x2a1)](_0x253e8d=>new _0x111ca4(_0x253e8d))}}},{'$lookup':{'from':global[_0x2f5386(0x10c)],'localField':_0xd1d8a4[_0x2f5386(0x13b)],'foreignField':_0xd1d8a4['OIhmv'],'as':_0xd1d8a4['OvtMY']}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0xd1d8a4[_0x2f5386(0x1c1)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x2f5386(0x2ec)]();if(_0xd1d8a4['koEiF'](_0x39fabc['length'],0x0))return _0x1a9c31[_0x2f5386(0x210)](JSON[_0x2f5386(0x29b)]({'isPrint':!0x1,'class':_0xd1d8a4[_0x2f5386(0x2be)],'msg':_0xd1d8a4[_0x2f5386(0x251)]}));const _0x302985=_0xfe5e1e[_0x2f5386(0x1f4)](global['folderForms'],_0xd1d8a4['lTmhM']),_0x5ece43=_0x3f08ff[_0x2f5386(0x1ef)](_0x302985,_0xd1d8a4[_0x2f5386(0x129)]),_0x3ad66e=_0x178b4d[_0x2f5386(0xd0)](_0x5ece43,{'time':O[_0x2f5386(0x23a)](),'title':'ยูสเซอร์\x20('+_0x39fabc[_0x2f5386(0x2e2)]+')','dateTime':O[_0x2f5386(0xf6)](),'usersFind':_0x39fabc});_0x1a9c31[_0x2f5386(0x210)](JSON[_0x2f5386(0x29b)]({'isPrint':!0x0,'class':_0xd1d8a4[_0x2f5386(0x1ad)],'msg':_0x2f5386(0x1da)+_0x39fabc[_0x2f5386(0x2e2)]+_0x2f5386(0x271),'htmlPage':_0x3ad66e}));}}catch(_0x43eb5a){_0xd1d8a4[_0x2f5386(0x1dc)](_0xd1d8a4[_0x2f5386(0x2b3)],_0xd1d8a4[_0x2f5386(0x2b3)])?(console['log'](_0xd1d8a4[_0x2f5386(0x1d6)],_0x43eb5a[_0x2f5386(0x2ad)]),_0x1a9c31['send'](JSON[_0x2f5386(0x29b)]({'isPrint':!0x1,'class':_0xd1d8a4[_0x2f5386(0x2be)],'msg':_0x43eb5a[_0x2f5386(0x2ad)]}))):wwKPHD['bWTmx'](_0x28ab17,0x0);}finally{if(_0xd1d8a4[_0x2f5386(0x25f)](_0xd1d8a4[_0x2f5386(0x14e)],_0xd1d8a4[_0x2f5386(0x14e)])){_0x344bd3=!0x1;return;}else _0xf9b0b5[_0x2f5386(0x307)]();}}),x[_0x674a7b(0x1a3)](Y,_0x38fc58[_0x674a7b(0xe9)],async(_0xc8ddd0,_0x2baa31)=>{const _0x3b3235=_0x674a7b,_0x3d0b5d={'FUvTJ':function(_0x45a0bf,_0x133fb9){return _0x45a0bf(_0x133fb9);},'SbVeb':function(_0x4687c8,_0x3a9912){return _0x4687c8!==_0x3a9912;},'zmoGt':_0x3b3235(0x10a),'SrzyW':_0x3b3235(0x1e0),'fjHXv':_0x3b3235(0x290),'jlyBF':function(_0x4e75f4,_0x384418){return _0x4e75f4<_0x384418;},'uAFfa':'yellow','WjwHS':_0x3b3235(0x2b2),'DtJnL':_0x3b3235(0xf1),'RmgBX':_0x3b3235(0x206),'RVOaB':function(_0x3d7816,_0x556dfb){return _0x3d7816===_0x556dfb;},'UmqWY':_0x3b3235(0x1f0),'kKJEI':_0x3b3235(0x1c2),'qUIzk':_0x3b3235(0x128),'dFSka':function(_0x331ff1,_0x41ac13){return _0x331ff1!==_0x41ac13;},'ZAMup':_0x3b3235(0x288)};let {userId:_0x593970}=_0xc8ddd0[_0x3b3235(0x27e)];_0x593970=_0x3d0b5d[_0x3b3235(0x1b8)](Number,_0x593970);const _0xf88d7b=new _0x381a0c(global[_0x3b3235(0x2f8)]);try{if(_0x3d0b5d[_0x3b3235(0x219)](_0x3d0b5d['zmoGt'],_0x3d0b5d[_0x3b3235(0x182)])){await _0xf88d7b[_0x3b3235(0x236)]();var _0xe925fc=await _0xf88d7b['db'](global[_0x3b3235(0x2fd)])[_0x3b3235(0x13e)](global['dbColl_users'])[_0x3b3235(0x103)]({'userId':_0x593970});if(!_0xe925fc)return _0x2baa31['send'](JSON[_0x3b3235(0x29b)]({'isPrint':!0x1,'class':_0x3d0b5d[_0x3b3235(0x124)],'msg':'ไม่พบ\x20\x22'+_0x593970+'\x22'}));const _0x5188ca=_0xe925fc[_0x3b3235(0x12a)]||[];if(_0x3d0b5d[_0x3b3235(0x2c1)](_0x5188ca[_0x3b3235(0x2e2)],0x1))return _0x2baa31[_0x3b3235(0x210)](JSON[_0x3b3235(0x29b)]({'isPrint':!0x1,'class':_0x3d0b5d['uAFfa'],'msg':_0x3d0b5d[_0x3b3235(0x1ea)]}));const _0x250b18=_0xfe5e1e[_0x3b3235(0x1f4)](folderForms,_0x3d0b5d[_0x3b3235(0xda)]),_0x46ccf0=await H[_0x3b3235(0x1e9)](_0x250b18,_0x2baa31,{'title':_0x3b3235(0x2bc)+_0xe925fc[_0x3b3235(0x16a)]+']\x20'+_0xe925fc['userPrefix']+'\x20'+_0xe925fc[_0x3b3235(0x111)]+'\x20'+_0xe925fc[_0x3b3235(0x183)],'time':O[_0x3b3235(0xf6)](),'changesHistory':_0x5188ca});_0x2baa31['send'](JSON[_0x3b3235(0x29b)]({'isPrint':!0x0,'class':_0x3d0b5d['RmgBX'],'htmlPage':_0x46ccf0}));}else _0x11344a['close']();}catch(_0x3a1f51){_0x3d0b5d['RVOaB'](_0x3d0b5d['UmqWY'],_0x3d0b5d[_0x3b3235(0x295)])?_0x4b415e['close']():(console[_0x3b3235(0x2d6)](_0x3d0b5d['qUIzk'],_0x3a1f51),_0x2baa31[_0x3b3235(0x210)](JSON['stringify']({'isPrint':!0x1,'class':_0x3d0b5d['fjHXv'],'msg':_0x3a1f51[_0x3b3235(0x2ad)]})));}finally{_0x3d0b5d[_0x3b3235(0x136)](_0x3d0b5d[_0x3b3235(0xf7)],_0x3d0b5d['ZAMup'])?_0x20a5a9=_0x14fda3:_0xf88d7b['close']();}}),x['post'](K,_0x38fc58[_0x674a7b(0xe9)],async(_0x21448e,_0x526ae1)=>{const _0x575e76=_0x674a7b,_0x314a01={'RmVRe':function(_0x182ab8,_0x34a033){return _0x182ab8+_0x34a033;},'VOKhg':_0x575e76(0x198),'trOCM':_0x575e76(0x241),'CJnlj':'action','lphgN':function(_0x120170,_0x1c88b2){return _0x120170!==_0x1c88b2;},'YfBWX':_0x575e76(0x249),'CNvZE':_0x575e76(0xc5),'YSjMZ':function(_0x41889c,_0x152dac){return _0x41889c==_0x152dac;},'XDFmj':'red','FZowy':_0x575e76(0x222),'BzPzX':_0x575e76(0x238),'HaZGS':_0x575e76(0x11f),'dOZbS':_0x575e76(0x223),'AojjA':'green','nOVlp':'ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','ALXra':_0x575e76(0xdd),'nxrLb':function(_0x496bcb,_0x5a72f6){return _0x496bcb===_0x5a72f6;},'xxKRT':'EHLua'},_0x210fd3=new _0x381a0c(dbUrl);try{if(_0x314a01['lphgN'](_0x314a01['YfBWX'],_0x314a01[_0x575e76(0x24f)]))(function(){return!![];}[_0x575e76(0x1b6)](EqWjQA[_0x575e76(0x215)](EqWjQA[_0x575e76(0x2cc)],EqWjQA[_0x575e76(0x12b)]))['call'](EqWjQA[_0x575e76(0x154)]));else{await _0x210fd3[_0x575e76(0x236)]();const _0x31f7a0=await _0x210fd3['db'](dbName)['collection'](dbColl_users)[_0x575e76(0xf0)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x314a01[_0x575e76(0x1bf)],[]]}}}},{'$sort':{'userId':0x1}}])['toArray']();if(_0x314a01[_0x575e76(0x287)](_0x31f7a0['length'],0x0))return _0x526ae1[_0x575e76(0x210)](JSON[_0x575e76(0x29b)]({'isDownload':!0x1,'class':_0x314a01[_0x575e76(0x20d)],'msg':_0x314a01[_0x575e76(0x1b2)]}));const _0x542bd4=_0x575e76(0x176)+O[_0x575e76(0xf6)]()[_0x575e76(0x196)](/[: ]/g,'-')+'.xlsx',_0x3b7428=_0x373efb[_0x575e76(0xdc)][_0x575e76(0x1bb)](_0x31f7a0),_0x4022c3=_0x373efb['utils'][_0x575e76(0x13c)]();_0x373efb[_0x575e76(0xdc)]['book_append_sheet'](_0x4022c3,_0x3b7428,_0x314a01[_0x575e76(0x282)]);const _0x3f92f6=_0x373efb[_0x575e76(0x1ce)](_0x4022c3,{'type':_0x314a01[_0x575e76(0x214)],'bookType':_0x314a01[_0x575e76(0x20f)]});_0x526ae1['send']({'isDownload':!0x0,'color':_0x314a01['AojjA'],'msg':_0x314a01[_0x575e76(0x18a)],'filename':_0x542bd4,'fileData':_0x3f92f6['toString'](_0x314a01['ALXra'])});}}catch(_0x94fcae){if(_0x314a01['nxrLb'](_0x314a01['xxKRT'],_0x314a01[_0x575e76(0x1d2)]))return _0x526ae1[_0x575e76(0x210)]({'isDownload':!0x1,'color':_0x314a01['XDFmj'],'msg':_0x94fcae['message']});else _0x3a4bc1['close']();}finally{_0x210fd3[_0x575e76(0x307)]();}});const ae=_0x5a223d({'storage':_0x5a223d[_0x674a7b(0x2fa)]()});x['post'](Z,_0x38fc58[_0x674a7b(0xe9)],ae[_0x674a7b(0x165)](_0x674a7b(0x232)),async(_0x3906fc,_0x52c314)=>{const _0x1dc7a3=_0x674a7b,_0xf2afe2={'VqzAt':function(_0x3981ee,_0x556185){return _0x3981ee(_0x556185);},'gWLdw':_0x1dc7a3(0x290),'JmxfK':_0x1dc7a3(0x11a),'qqWyD':_0x1dc7a3(0x11f),'nEOvM':_0x1dc7a3(0x238),'TAHOQ':function(_0x3afb50,_0x318d52){return _0x3afb50>_0x318d52;},'VnoEk':_0x1dc7a3(0x16a),'oplYy':_0x1dc7a3(0x192),'zVzUd':_0x1dc7a3(0x2f2),'VIkBc':_0x1dc7a3(0xcb),'WctLf':'userAuthority','jgmjy':'userEmail','qtkoU':_0x1dc7a3(0x1d1),'HDJZu':_0x1dc7a3(0x1f1),'XJnDA':_0x1dc7a3(0x111),'BWzWn':_0x1dc7a3(0x183),'NRoUq':_0x1dc7a3(0x1a0),'ujWXG':function(_0x20146a,_0x4d1bbc){return _0x20146a>_0x4d1bbc;},'deGTk':function(_0x22caa4,_0x583878){return _0x22caa4>_0x583878;},'lxwkU':_0x1dc7a3(0xeb),'UHcTG':function(_0x555a33,_0x519fcb){return _0x555a33+_0x519fcb;},'vuLzb':function(_0x1d39a2,_0x468be2){return _0x1d39a2===_0x468be2;},'zRonF':function(_0x3c4f8a,_0x4ec192){return _0x3c4f8a===_0x4ec192;},'rIvxS':function(_0x2f93b4,_0x5cb01f){return _0x2f93b4===_0x5cb01f;},'zNKri':function(_0x24396d,_0x4c85e3){return _0x24396d===_0x4c85e3;},'JGLni':function(_0x9b9245,_0x163d12){return _0x9b9245===_0x163d12;},'ZdSDV':function(_0x32fc9f,_0x7a29bb){return _0x32fc9f===_0x7a29bb;},'OFAqe':function(_0x1e1663,_0x3b79f0){return _0x1e1663===_0x3b79f0;},'VjssS':function(_0x576688,_0x3d4950){return _0x576688>_0x3d4950;},'SDEEh':_0x1dc7a3(0x11d),'ETWTZ':_0x1dc7a3(0x206),'NMqoc':_0x1dc7a3(0x128)},_0xea7900=new _0x381a0c(dbUrl);try{if(!_0x3906fc['file'])return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':_0xf2afe2[_0x1dc7a3(0x15a)]});const _0x5a57d0=_0x373efb[_0x1dc7a3(0x172)](_0x3906fc[_0x1dc7a3(0x170)][_0x1dc7a3(0x11f)],{'type':_0xf2afe2[_0x1dc7a3(0x18f)]}),_0x4ab39d=[_0xf2afe2[_0x1dc7a3(0x1b9)]],_0x33b1fa=_0x5a57d0['SheetNames'],_0x1118ce=_0x4ab39d[_0x1dc7a3(0x1ae)](_0x535c4a=>!_0x33b1fa[_0x1dc7a3(0x1ee)](_0x535c4a));if(_0xf2afe2[_0x1dc7a3(0x2dd)](_0x1118ce[_0x1dc7a3(0x2e2)],0x0))return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':_0x1dc7a3(0x110)+_0x1118ce[_0x1dc7a3(0x1f4)](',\x20')+'\x22'});const _0x4d1b04=_0x5a57d0['Sheets'][_0x1dc7a3(0x238)],_0x482fd3=_0x373efb[_0x1dc7a3(0xdc)][_0x1dc7a3(0x24a)](_0x4d1b04),_0x5373c4=[_0xf2afe2['VnoEk'],_0xf2afe2[_0x1dc7a3(0x2f5)],_0xf2afe2['zVzUd'],_0xf2afe2[_0x1dc7a3(0x167)],_0xf2afe2['WctLf'],_0xf2afe2[_0x1dc7a3(0x169)],_0xf2afe2[_0x1dc7a3(0x257)],_0xf2afe2['HDJZu'],_0xf2afe2[_0x1dc7a3(0x1ed)],_0xf2afe2[_0x1dc7a3(0x235)],_0xf2afe2['NRoUq']][_0x1dc7a3(0x1ae)](_0x14e771=>!_0x482fd3[_0x1dc7a3(0x161)](_0x1e8b27=>Object['prototype'][_0x1dc7a3(0x28c)][_0x1dc7a3(0x1ff)](_0x1e8b27,_0x14e771)));if(_0xf2afe2[_0x1dc7a3(0x2dd)](_0x5373c4[_0x1dc7a3(0x2e2)],0x0))return _0x52c314['send']({'isUpload':!0x1,'color':_0xf2afe2['gWLdw'],'msg':_0x1dc7a3(0x296)+_0x5373c4[_0x1dc7a3(0x1f4)](',\x20')+'\x22'});const _0x2bff1e=new Set(),_0xeedc8=new Set();if(_0x482fd3[_0x1dc7a3(0x302)](_0x330ac3=>{const _0x458d88=_0x1dc7a3;_0x2bff1e[_0x458d88(0x22d)](_0x330ac3['userId'])?_0xeedc8['add'](_0x330ac3[_0x458d88(0x16a)]):_0x2bff1e[_0x458d88(0x2af)](_0x330ac3[_0x458d88(0x16a)]);}),_0xf2afe2[_0x1dc7a3(0x1b7)](_0xeedc8['size'],0x0))return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':_0x1dc7a3(0x101)+Array[_0x1dc7a3(0x2d0)](_0xeedc8)[_0x1dc7a3(0x1f4)](',\x20')+'\x22'});const _0x389633=new Set(),_0x195d12=new Set();if(_0x482fd3[_0x1dc7a3(0x302)](_0x14d712=>{const _0x4ad03d=_0x1dc7a3;_0x389633['has'](_0x14d712['username'])?_0x195d12['add'](_0x14d712[_0x4ad03d(0x192)]):_0x389633[_0x4ad03d(0x2af)](_0x14d712[_0x4ad03d(0x192)]);}),_0xf2afe2[_0x1dc7a3(0x2dd)](_0x195d12['size'],0x0))return _0x52c314['send']({'isUpload':!0x1,'color':_0xf2afe2['gWLdw'],'msg':_0x1dc7a3(0x157)+Array[_0x1dc7a3(0x2d0)](_0x195d12)[_0x1dc7a3(0x1f4)](',\x20')+'\x22'});const _0xef3cf2=new Set(),_0x28f8f2=new Set();if(_0x482fd3['forEach'](_0x22ca0a=>{const _0x32a7c8=_0x1dc7a3;_0xef3cf2[_0x32a7c8(0x22d)](_0x22ca0a[_0x32a7c8(0x11c)])?_0x28f8f2['add'](_0x22ca0a['userEmail']):_0xef3cf2[_0x32a7c8(0x2af)](_0x22ca0a[_0x32a7c8(0x11c)]);}),_0xf2afe2['deGTk'](_0x28f8f2[_0x1dc7a3(0x2c5)],0x0))return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':'มี\x20userEmail\x20ซ้ำกัน:\x20\x22'+Array[_0x1dc7a3(0x2d0)](_0x28f8f2)[_0x1dc7a3(0x1f4)](',\x20')+'\x22'});const _0x53d457=[],_0x59b2df=/^\d{3,4}$/,_0x329a00=new RegExp(global[_0x1dc7a3(0x266)]),_0x2049ad=/^\d{3}$/,_0x151bd5=[_0xf2afe2['lxwkU'],''];for(const [_0x185419,_0x3e3076]of _0x482fd3[_0x1dc7a3(0x16f)]()){const _0x51ba89=_0xf2afe2[_0x1dc7a3(0x228)](_0x185419,0x2),_0x2896c0={'userId':_0x3e3076[_0x1dc7a3(0x16a)],'row':_0x51ba89};if(!_0x3e3076[_0x1dc7a3(0x16a)]||_0xf2afe2['vuLzb'](_0x59b2df[_0x1dc7a3(0x166)](_0x3e3076[_0x1dc7a3(0x16a)][_0x1dc7a3(0x2b5)]()),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076['username']||_0xf2afe2[_0x1dc7a3(0x15b)](_0x329a00[_0x1dc7a3(0x166)](_0x3e3076['username']),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076[_0x1dc7a3(0x2f2)]||_0xf2afe2[_0x1dc7a3(0x224)](_0x2049ad[_0x1dc7a3(0x166)](_0x3e3076['branchId']['toString']()),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076[_0x1dc7a3(0xcb)]||_0xf2afe2[_0x1dc7a3(0x2d5)](_0x151bd5[_0x1dc7a3(0x1ee)](_0x3e3076['userIsActive']),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076['userAuthority']||_0xf2afe2['JGLni'](global[_0x1dc7a3(0x26b)]['includes'](_0x3e3076[_0x1dc7a3(0x2ce)]),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076[_0x1dc7a3(0x11c)]||_0xf2afe2[_0x1dc7a3(0x2d8)](_0x1a8d5f[_0x1dc7a3(0x2ef)](_0x3e3076['userEmail']),!0x1)){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076[_0x1dc7a3(0x111)]||_0xf2afe2[_0x1dc7a3(0x227)](_0x3e3076['userFirstname'][_0x1dc7a3(0x28e)](),'')){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}if(!_0x3e3076['dateTimeCanDelete']||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x1dc7a3(0x166)](_0x3e3076[_0x1dc7a3(0x1a0)])){_0x53d457[_0x1dc7a3(0x13a)](_0x2896c0);continue;}}if(_0xf2afe2[_0x1dc7a3(0x202)](_0x53d457['length'],0x0)){const _0x51c95f=Array[_0x1dc7a3(0x2d0)](new Set(_0x53d457[_0x1dc7a3(0x2a1)](_0x26eaca=>JSON[_0x1dc7a3(0x29b)](_0x26eaca))))['map'](_0x9a167=>JSON[_0x1dc7a3(0x151)](_0x9a167));return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':_0x1dc7a3(0x1f5)+_0x51c95f[_0x1dc7a3(0x2a1)](_0xc52283=>_0xc52283[_0x1dc7a3(0x187)])[_0x1dc7a3(0x1f4)](',\x20'),'errorRows':_0x51c95f});}_0x482fd3[_0x1dc7a3(0x302)](_0x501d99=>{const _0x420bd0=_0x1dc7a3;_0x501d99[_0x420bd0(0x16a)]=_0xf2afe2[_0x420bd0(0x276)](Number,_0x501d99[_0x420bd0(0x16a)]),_0x501d99[_0x420bd0(0x2f2)]=_0xf2afe2[_0x420bd0(0x276)](Number,_0x501d99[_0x420bd0(0x2f2)]),_0x501d99[_0x420bd0(0xcb)]||(_0x501d99[_0x420bd0(0xcb)]=''),_0x501d99[_0x420bd0(0x1d1)]||(_0x501d99[_0x420bd0(0x1d1)]=''),_0x501d99[_0x420bd0(0x1f1)]||(_0x501d99['userPrefix']=''),_0x501d99['userLastname']||(_0x501d99[_0x420bd0(0x183)]=''),delete _0x501d99['userLastLogin'],delete _0x501d99['changesHistoryCount'],delete _0x501d99[_0x420bd0(0xbd)],delete _0x501d99[_0x420bd0(0x229)];}),await _0xea7900['connect']();const _0x8e5728=_0xea7900['db'](dbName)[_0x1dc7a3(0x13e)](dbColl_users),_0x150aae=[];for(const _0x367405 of _0x482fd3){const _0x5af357=await _0x8e5728[_0x1dc7a3(0x105)]({'userId':_0x367405[_0x1dc7a3(0x16a)]},{'$set':_0x367405},{'upsert':!0x0});_0x150aae[_0x1dc7a3(0x13a)]({'userId':_0x367405[_0x1dc7a3(0x16a)],'matchedCount':_0x5af357[_0x1dc7a3(0x1ba)],'upsertedCount':_0x5af357['upsertedCount']});}const _0x5f4a44=_0xf2afe2[_0x1dc7a3(0x1cc)](_0x150aae[_0x1dc7a3(0x2e2)],0x0)?_0xf2afe2[_0x1dc7a3(0x228)](_0x1dc7a3(0x189)+_0x150aae['filter'](_0x297085=>_0x297085[_0x1dc7a3(0x1ba)]>0x0)['length']+_0x1dc7a3(0x2c4),(_0x1dc7a3(0x1d0)+_0x150aae[_0x1dc7a3(0x1ae)](_0x2f3447=>_0x2f3447[_0x1dc7a3(0x294)]>0x0)[_0x1dc7a3(0x2e2)]+'\x20รายการ')[_0x1dc7a3(0x28e)]()):_0xf2afe2['SDEEh'];return _0x52c314[_0x1dc7a3(0x210)]({'isUpload':!0x0,'color':_0xf2afe2[_0x1dc7a3(0xd5)],'msg':_0x5f4a44});}catch(_0x3d97bc){return console[_0x1dc7a3(0x2d6)](_0xf2afe2['NMqoc'],_0x3d97bc),_0x52c314[_0x1dc7a3(0x210)]({'isDownload':!0x1,'color':_0xf2afe2[_0x1dc7a3(0x2a9)],'msg':_0x3d97bc['message']});}finally{_0xea7900[_0x1dc7a3(0x307)]();}});export default x;function _0x35b100(_0x46218a){const _0x571f2b=_0x674a7b,_0x35e065={'mbpjE':function(_0x28165f,_0x221db9){return _0x28165f===_0x221db9;},'LWXen':_0x571f2b(0xe6),'fBZfh':'while\x20(true)\x20{}','mXZEn':_0x571f2b(0x1af),'yXNhU':function(_0x14d75d,_0xe3ae84){return _0x14d75d!==_0xe3ae84;},'GiGBv':function(_0x296b22,_0x437b4f){return _0x296b22+_0x437b4f;},'ZQkWb':function(_0x42e3bb,_0x4c3e47){return _0x42e3bb/_0x4c3e47;},'Uwbvi':_0x571f2b(0x2e2),'pcNpK':function(_0x193b6d,_0x1ed7b3){return _0x193b6d===_0x1ed7b3;},'jBmOY':function(_0x5cfc29,_0x13ea53){return _0x5cfc29%_0x13ea53;},'GVPIc':_0x571f2b(0x198),'qSUik':_0x571f2b(0x241),'iuKmO':_0x571f2b(0xe8),'ktQgg':_0x571f2b(0x160),'TspuS':function(_0x85f9a5,_0x296697){return _0x85f9a5(_0x296697);}};function _0x5140df(_0x1a82ef){const _0x3fb36b=_0x571f2b;if(_0x35e065[_0x3fb36b(0x29d)](typeof _0x1a82ef,_0x35e065[_0x3fb36b(0xd9)]))return function(_0x117c67){}[_0x3fb36b(0x1b6)](_0x35e065[_0x3fb36b(0x2ba)])['apply'](_0x35e065[_0x3fb36b(0x2db)]);else _0x35e065[_0x3fb36b(0x164)](_0x35e065[_0x3fb36b(0x269)]('',_0x35e065[_0x3fb36b(0x193)](_0x1a82ef,_0x1a82ef))[_0x35e065[_0x3fb36b(0x162)]],0x1)||_0x35e065[_0x3fb36b(0x1cf)](_0x35e065['jBmOY'](_0x1a82ef,0x14),0x0)?function(){return!![];}['constructor'](_0x35e065['GiGBv'](_0x35e065[_0x3fb36b(0x2ed)],_0x35e065[_0x3fb36b(0xf3)]))[_0x3fb36b(0x1ff)](_0x35e065[_0x3fb36b(0x270)]):function(){return![];}[_0x3fb36b(0x1b6)](_0x35e065[_0x3fb36b(0x269)](_0x35e065[_0x3fb36b(0x2ed)],_0x35e065[_0x3fb36b(0xf3)]))[_0x3fb36b(0x22a)](_0x35e065[_0x3fb36b(0x1a2)]);_0x35e065['TspuS'](_0x5140df,++_0x1a82ef);}try{if(_0x46218a)return _0x5140df;else _0x35e065[_0x571f2b(0x16b)](_0x5140df,0x0);}catch(_0x36d9e4){}}