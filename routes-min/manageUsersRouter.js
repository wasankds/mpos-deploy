function _0x423a(){const _0x64f8be=['tKCgG','cGtRA','getDateTime','AZvOZ','JfDch','sendRegisterUserEmail','deleteMany','GTYHH','/myModule.js','MNpzM','{{sep}}(\x20ไม่พบเซสชั่น\x20)','userAuthority','RHngU','Ilhox','includes','QQgZh','error\x20===>\x20','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','jXhTj','/myDateTime.js','tJVNl','5502664PsRyYa','EKWBS','userPrefix','pvhCh','branchId','MpOhL','VXskY','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ZvywR','dateTimeCanDelete','FgBop','prototype','sNTfE','aVAcu','single','pvqUK','?sip=','cwcbu','มีข้อมูลผิดพลาดที่แถว\x20','phJoe','ISnlS','jFVAZ','flash','bctlY','dbName','tUbBk','minute','kJhST','userFullname','PyywL','hNOgD','VoPlc','getDate','aggregate','hasOwnProperty','ixasi','CtYWc','replace','ไม่มีข้อมูล','row','limit','/mySendmail.js','getChangeHistory','dbColl_sessions','getSettings','jTeLF','jBLZo','userIsActive','ไม่พบประวัติการเปลี่ยนแปลง','LcXOl','_id','stringify','QDOfl','\x22\x20เรียบร้อยแล้ว\x20)','\x22\x20มีอยู่ในเอกสาร\x20','fOSPn','catch','pbWls','dbUrl','Uwwfn','CijwD','YMrLD','xXERl','branchInfo','string','userLastname','SNxcO','countDocuments','xSFrG','tDeqW','ORgdc','GWkWK','../','buffer','MDrkB','bqCRH','LRfHM','fsqmx','zPgXR','QnYta','sort','tPLBZ','Fnhqr','ZLrPX','GHAwr','zrSLi','Pcjkp','FkBKE','query','changesHistoryCount','GLjcw','HUHfx','redirect','/download-excel','dbColl_sales','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','eZxhv','MDIcM','getSessionData','apFxQ','Wyorf','yellow','tKgoV','qXuyp','apply','dWaer','aVYRe','\x20ยูสเซอร์เรียบร้อยแล้ว','$branchInfo.branchName','WkWBX','ygbvL','MLtkz','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','ZtfbP','file','kUqOZ','1486832VenEGl','sheet_to_json','ryvLd','FlZWQ','&page=','RcoCc','RGGPi','KnyWg','deleteOne','stateObject','call','RciQC','kSZgE','jigkg','GVDap','xzXAe','CTPwf','Wznhw','ZkPgB','qPVYU','Nkxwn','updateOne','pdVoX','DUpPU','ysWRg','BarGo','SzcLl','from','/changes','counter','qTeWz','MCMhm','ajBNn','iacdZ','rkRAi','{{sep}}\x22','JafxI','GiBXB','msg','iBDWf','GqdGL','constructor','green','iCDxa','QlMpi','test','ykbaT','SDRzE','dbColl_return','sLIzK','users','PENaX','gger','info','CuTOd','ebhiT','toString','renderView','qtaAD','ZFqQt','generatePassword','GMfsr','XiMXw','pALCZ','OCSOK','base64','isOS','cARSB','DSgCj','Session\x20destroy\x20error:\x20','/manage/users','matchedCount','entries','sAvmw','NJukW','function\x20*\x5c(\x20*\x5c)','userNormalLoginCount','WzSpq','Siyuj','Iingq','sGQSE','DZwqR','syiCz','push','RGHXU','OOWPa','RAOUk','BODfR','WeStV','Nowbt','YIWNA','lSDuF','IqBgG','XYPmB','QjKks','nYOEJ','zggls','UzfYC','มี\x20username\x20ซ้ำกัน:\x20\x22','session','ndcRy','mRCGb','gugKm','Nqomn','VLLgX','visRN','active','อัปเดท\x20\x22','yaJsF','aJaoh','trace','message','connect','xqMzE','zZZEX','TnkPu','tTNZY','mxEID','map','Router','JcpHF','clUDa','LYFqi','uuzFt','jxqQh','userId','add','TJvHe','rZDeE','VGtIH','read','dMZsj','Not\x20Found','iQcCz','BPGwC','OIAzl','vVLYh','WRbXw','uHtHt','เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','TaDUc','USER_AUTHORITIES','ibEqC','Zjsqu','DqdDz','iTDSh','OMnsz','ceil','eraYA','debu','uploadExcelFile','log','MLPml','HMxIZ','yMgCh','JkflI','xlsx','userPhone','qrlVv','console','upsertedCount','wLcJp','jpZal','?rpp=20&page=1&load_id=','AoFWn','input','utils','size','return\x20(function()\x20','get','ruAQX','OcOol','ZNfSb','vUaGz','bVwhW','TcwRN','iOVPf','มี\x20userId\x20ซ้ำกัน:\x20\x22','WZLQa','LGUZW','eJdII','readFileSync','orKAm','hutak','AYhPO','UCxHu','BCEYr','\x22\x20)','xLzRC','unshift','ryykl','RVsKp','utAhe','243dtNlCG','BFwDE','sendFile','fDdQF','qUNwB','bdGiS','TvsrR','เพิ่มยูสเซอร์\x20','CERhF','deletedCount','userEmail','19493749IWgckC','action','user_id','sip','getUserBranches','xedno','bind','userFirstname','\x22\x20เรียบร้อยแล้ว','/myData.js','jcwEM','lSmjD','สร้างผู้ใช้ใหม่\x20\x22','username','hBTXc','QIJWS','tuTaG','modifiedCount','OOcVD','Gqowi','ghINZ','ยูสเซอร์\x20\x22','SGJDT','ZZgyE','xLNsa','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','nwsMS','csLOJ','trim','gWXPb','vgytC','HqKqu','load_id','RwtvE','MAVqh','ktDCs','JJmLZ','CCDrb','WNyWh','lGwFg','hWiex','FpUOH','fuCYU','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','dbColl_users','&load_id=','mRCUf','kXVTZ','denIw','userFlash','collection','bAITw','lTsGy','body','5144dYaIBr','hash','oHDzA','tYeDS','VitqM','jqFXs','EjglS','insertOne','hzDXR','YBHOu','cwKrA','Fbaoy','อัปเดท\x20','$userPrefix','JumFz','Sheets','red','tdpnt','{}.constructor(\x22return\x20this\x22)(\x20)','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','Aceyi','GxpQh','fixko','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','oYocB','error','jqOZo','IFlop','page','GoMFj','AtllG','book_append_sheet','zufON','WTWWE','JNXfp','szgCl','YoReL','manageUsers','QpZse','WcHmz','YNUKn','mKHih','cAMCp','lwsVl','warn','pFCKH','mvpnp','BbZZi','$dateTimeCanDelete','upMTn','CnFHl','init','/new','XjXzf','ryryY','toArray','PbEJz','rhDTJ','RfFJS','{{sep}}ไม่สามารถลบได้','OJnKQ','table','192xXJQwb','mrfTy','/myUsers.js','post','gJtvb','yZHGu','LnhlX','&rpp=','XqIjB','tkSLj','VsoEk','rGyUs','NkICP','wfiko','TGETl','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','mLxXY','VwmzQ','IeLCC','qblhF','turIx','ExNHF','while\x20(true)\x20{}','jMzFQ','aoLFD','/upload-excel','join','qZbvD','TlENw','rvmhU','findOne','bKgtN','){{sep}}(CODE\x20:\x20','filter','xxkLo','SZUzj','acknowledged','vLbQz','NIfXc','GyLee','insertedId','gFuJk','TMagZ','VDVvR','hTuXl','411590tcAcMH','anaAG','folderForms','DgwWj','json_to_sheet','uwwzt','WmqNG','JDrjn','IEHEp','lEOtg','BcbJt','NtrCs','userLastLogin','close','dbColl_warehouseOut','render','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','XwBef','user-','rpp','__proto__','LNCqM','ODewX','RVzke','OJQjj','epXbD','fVdGB','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','mgwEd','userPassword','@gmail.com','$userLastname','yxqMw','chOYS','then','response','MmXzY','3lWjiaJ','DfIaP','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','uQegi','EnYDo','GEJHX','XiBPL','76356diZHXZ','length','qwNpw','2980148hVBOHy','mKpJn','book_new','HTopl','SIioQ','ZCRyp','status','aZVMZ','dbColl_warehouseIn','FysTB','changesHistory','rziOL','TxkqP','xfhBp','has','ไม่พบ\x20\x22','send','Qwjsu','eVEZl','/print','forEach','TSNou','rFkLS','USERNAME_PATTERN','ppkDF','2915JGkbtE','Ljsjf','VdtlO','DHcSh','\x20รายการ','chain','some','IAxuP','zsaPF','WDLsv','write','destroy','UJQCO','$changesHistory','GUUAN','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','atsSV','gYjBb','GGfft','dbColl_userBranches'];_0x423a=function(){return _0x64f8be;};return _0x423a();}const _0x69ed0=_0x52c7;(function(_0x15dc41,_0x4a6641){const _0x12d202=_0x52c7,_0x2bee31=_0x15dc41();while(!![]){try{const _0x3e709c=-parseInt(_0x12d202(0x32c))/0x1+-parseInt(_0x12d202(0x276))/0x2*(-parseInt(_0x12d202(0x26c))/0x3)+-parseInt(_0x12d202(0x1dc))/0x4*(parseInt(_0x12d202(0x28f))/0x5)+-parseInt(_0x12d202(0x21a))/0x6*(-parseInt(_0x12d202(0x273))/0x7)+parseInt(_0x12d202(0x2b8))/0x8+parseInt(_0x12d202(0x3ed))/0x9*(-parseInt(_0x12d202(0x247))/0xa)+parseInt(_0x12d202(0x3f8))/0xb;if(_0x3e709c===_0x4a6641)break;else _0x2bee31['push'](_0x2bee31['shift']());}catch(_0x419f48){_0x2bee31['push'](_0x2bee31['shift']());}}}(_0x423a,0xe83db));const _0x1a6718=(function(){const _0xed7422=_0x52c7,_0x491e50={'QjKks':function(_0x50242b,_0x5ecceb){return _0x50242b(_0x5ecceb);},'bKgtN':function(_0x179ab6,_0xe308ad){return _0x179ab6+_0xe308ad;},'BPGwC':'return\x20(function()\x20','sEZvR':_0xed7422(0x1ee),'jpZal':function(_0x355422){return _0x355422();},'upMTn':function(_0x2d8e3f,_0x4a9c76){return _0x2d8e3f===_0x4a9c76;},'atsSV':_0xed7422(0x3d0),'mHWfG':_0xed7422(0x2c5),'PENaX':function(_0xb0cbf2,_0x33b05a){return _0xb0cbf2!==_0x33b05a;},'TJBgC':_0xed7422(0x394),'WcHmz':_0xed7422(0x358),'jcwEM':_0xed7422(0x291),'iTDSh':'BXsbv'};let _0x2afc45=!![];return function(_0x590d37,_0x5233d9){const _0x12d31a=_0xed7422,_0x3b64cc={'jxqQh':function(_0x38cba6){const _0xc8361a=_0x52c7;return _0x491e50[_0xc8361a(0x3ce)](_0x38cba6);},'Wznhw':function(_0x31ecd9,_0x258afc){const _0x405192=_0x52c7;return _0x491e50[_0x405192(0x20d)](_0x31ecd9,_0x258afc);},'gWXPb':_0x491e50[_0x12d31a(0x29f)],'BcbJt':_0x491e50['mHWfG'],'dWaer':function(_0x4151bd,_0x302271){return _0x491e50['PENaX'](_0x4151bd,_0x302271);},'JkflI':_0x491e50['TJBgC'],'pTqRp':_0x491e50[_0x12d31a(0x203)]};if(_0x491e50[_0x12d31a(0x35f)](_0x491e50[_0x12d31a(0x402)],_0x491e50[_0x12d31a(0x3bd)])){const _0x12e369=_0x2afc45?function(){const _0x36a92a=_0x12d31a;if(_0x3b64cc[_0x36a92a(0x33d)](_0x3b64cc[_0x36a92a(0x415)],_0x3b64cc[_0x36a92a(0x251)]))_0x2c77ea[_0x36a92a(0x254)]();else{if(_0x5233d9){if(_0x3b64cc[_0x36a92a(0x321)](_0x3b64cc[_0x36a92a(0x3c7)],_0x3b64cc['pTqRp'])){const _0x2bfb09=_0x5233d9[_0x36a92a(0x320)](_0x590d37,arguments);return _0x5233d9=null,_0x2bfb09;}else _0x3b64cc[_0x36a92a(0x3a8)](_0x32d47c);}}}:function(){};return _0x2afc45=![],_0x12e369;}else{let _0x527938;try{_0x527938=_0x491e50[_0x12d31a(0x38a)](_0x5a09ed,_0x491e50[_0x12d31a(0x239)](_0x491e50[_0x12d31a(0x239)](_0x491e50[_0x12d31a(0x3b2)],_0x491e50['sEZvR']),');'))();}catch(_0x4ef050){_0x527938=_0x413de5;}return _0x527938;}};}());(function(){const _0x141421=_0x52c7,_0xa2f903={'GyLee':function(_0x57f018,_0x1a05f0){return _0x57f018(_0x1a05f0);},'SGJDT':function(_0x568a4a,_0x3e0b0f){return _0x568a4a(_0x3e0b0f);},'LnhlX':function(_0x53c9db,_0x53ff9d){return _0x53c9db===_0x53ff9d;},'mjqFd':_0x141421(0x2d6),'rziOL':_0x141421(0x297),'PUdjk':_0x141421(0x377),'TbbjD':_0x141421(0x2bf),'jXhTj':_0x141421(0x20f),'GHAwr':function(_0x3f4e24,_0x412a9c){return _0x3f4e24+_0x412a9c;},'Uwwfn':_0x141421(0x294),'hsGGr':_0x141421(0x3d1),'mtNsP':_0x141421(0x3f3),'HUHfx':'ceHKp','tLjth':function(_0x194040,_0x127bd2){return _0x194040===_0x127bd2;},'MLtkz':_0x141421(0x3c4),'KtPLN':_0x141421(0x2f5),'xLNsa':function(_0x4a63c3){return _0x4a63c3();},'xfhBp':function(_0x52cd62,_0x426c96,_0x1764d7){return _0x52cd62(_0x426c96,_0x1764d7);}};_0xa2f903[_0x141421(0x283)](_0x1a6718,this,function(){const _0x23014d=_0x141421;if(_0xa2f903[_0x23014d(0x220)](_0xa2f903['mjqFd'],_0xa2f903[_0x23014d(0x281)]))_0x1adc5d[_0x23014d(0x284)](_0x453903[_0x23014d(0x405)])?_0x18677d[_0x23014d(0x3aa)](_0x529ce5[_0x23014d(0x405)]):_0x48eed3[_0x23014d(0x3aa)](_0x2aa7d9[_0x23014d(0x405)]);else{const _0x592b6a=new RegExp(_0xa2f903['PUdjk']),_0x4a710a=new RegExp(_0xa2f903['TbbjD'],'i'),_0x344ebe=_0xa2f903['GyLee'](_0x284ce1,_0xa2f903[_0x23014d(0x2b5)]);!_0x592b6a[_0x23014d(0x359)](_0xa2f903[_0x23014d(0x30c)](_0x344ebe,_0xa2f903[_0x23014d(0x2f3)]))||!_0x4a710a[_0x23014d(0x359)](_0xa2f903[_0x23014d(0x30c)](_0x344ebe,_0xa2f903['hsGGr']))?_0xa2f903[_0x23014d(0x220)](_0xa2f903['mtNsP'],_0xa2f903[_0x23014d(0x313)])?(_0x398fa5[_0x23014d(0x3a9)]=_0xa2f903[_0x23014d(0x241)](_0x1ffc63,_0x403f2f[_0x23014d(0x3a9)]),_0x39418e['branchId']=_0xa2f903[_0x23014d(0x40e)](_0x61f1df,_0x2129af[_0x23014d(0x2bc)]),_0x5248e6[_0x23014d(0x2e7)]||(_0x32f781[_0x23014d(0x2e7)]=''),_0x3d7678[_0x23014d(0x3c9)]||(_0x4577fe[_0x23014d(0x3c9)]=''),_0x74cc6a[_0x23014d(0x2ba)]||(_0x5d634b['userPrefix']=''),_0x33dd47['userLastname']||(_0x5cfbb7[_0x23014d(0x2f9)]=''),delete _0x944907['userLastLogin'],delete _0x25fa3e['changesHistoryCount'],delete _0x778de5[_0x23014d(0x378)],delete _0x57b0af['userLastLogin']):_0xa2f903[_0x23014d(0x40e)](_0x344ebe,'0'):_0xa2f903['tLjth'](_0xa2f903[_0x23014d(0x327)],_0xa2f903['KtPLN'])?_0xcec946[_0x23014d(0x254)]():_0xa2f903[_0x23014d(0x410)](_0x284ce1);}})();}());const _0x391f58=(function(){const _0x23fa36=_0x52c7,_0x2ca9d8={'GWkWK':_0x23fa36(0x2b3),'CTPwf':_0x23fa36(0x1ec),'Pcjkp':function(_0x50d544,_0x10c7bd){return _0x50d544!==_0x10c7bd;},'tTNZY':_0x23fa36(0x34a),'SpEvx':'rxDPe','IvRfW':_0x23fa36(0x22f),'ruAQX':_0x23fa36(0x26f),'mrfTy':function(_0x207e6a,_0x15a657){return _0x207e6a(_0x15a657);},'ryvLd':function(_0x5c2a4d,_0x47144c){return _0x5c2a4d+_0x47144c;},'rkRAi':function(_0x54e58e,_0xd7e58c){return _0x54e58e+_0xd7e58c;},'ZvywR':_0x23fa36(0x3d4),'kSZgE':_0x23fa36(0x1ee),'wwouZ':'msg','pFCKH':function(_0x14c1d3,_0x13a7e7){return _0x14c1d3!==_0x13a7e7;},'DZwqR':_0x23fa36(0x2c7),'ryryY':_0x23fa36(0x20e)};let _0x3b5740=!![];return function(_0x3bdf82,_0x257501){const _0x5b4f4f=_0x23fa36,_0x28cf93={'qXsLj':_0x2ca9d8[_0x5b4f4f(0x2ff)],'XiMXw':_0x2ca9d8['wwouZ'],'ZtfbP':_0x2ca9d8[_0x5b4f4f(0x33c)]};if(_0x2ca9d8[_0x5b4f4f(0x209)](_0x2ca9d8[_0x5b4f4f(0x37d)],_0x2ca9d8[_0x5b4f4f(0x212)])){const _0x401536=_0x3b5740?function(){const _0x3d9d4d=_0x5b4f4f,_0x2f2592={'jTeLF':_0x2ca9d8[_0x3d9d4d(0x2ff)],'ZFqQt':_0x2ca9d8[_0x3d9d4d(0x33c)]};if(_0x2ca9d8[_0x3d9d4d(0x30e)](_0x2ca9d8[_0x3d9d4d(0x3a0)],_0x2ca9d8['SpEvx'])){if(_0x257501){if(_0x2ca9d8[_0x3d9d4d(0x30e)](_0x2ca9d8['IvRfW'],_0x2ca9d8[_0x3d9d4d(0x3d6)])){const _0x856ef1=_0x257501[_0x3d9d4d(0x320)](_0x3bdf82,arguments);return _0x257501=null,_0x856ef1;}else return _0x5d62f9[_0x3d9d4d(0x3c3)](_0x28cf93['qXsLj'],_0xe65a56),_0x1e7c9e[_0x3d9d4d(0x2ce)](_0x28cf93[_0x3d9d4d(0x36a)],{'class':_0x28cf93[_0x3d9d4d(0x329)],'text':_0x2b068b['message']}),_0x56d82b['redirect'](_0x6d0cb1);}}else _0x10490d[_0x3d9d4d(0x3c3)](_0x2f2592[_0x3d9d4d(0x2e5)],_0x4f87ea[_0x3d9d4d(0x39b)]),_0x282aef[_0x3d9d4d(0x286)](_0x2c2418[_0x3d9d4d(0x2eb)]({'isPrint':!0x1,'class':_0x2f2592[_0x3d9d4d(0x367)],'msg':_0x37cfc8[_0x3d9d4d(0x39b)]}));}:function(){};return _0x3b5740=![],_0x401536;}else _0x16b9f0=_0x2ca9d8[_0x5b4f4f(0x21b)](_0x21f14f,_0x2ca9d8[_0x5b4f4f(0x32e)](_0x2ca9d8[_0x5b4f4f(0x34e)](_0x2ca9d8[_0x5b4f4f(0x2c0)],_0x2ca9d8[_0x5b4f4f(0x338)]),');'))();};}()),_0x4f18c1=_0x391f58(this,function(){const _0x5b0f79=_0x52c7,_0x8e2736={'DHcSh':_0x5b0f79(0x2b3),'SIJGl':'red','lEOtg':function(_0x4d52c3,_0x45c5e2){return _0x4d52c3===_0x45c5e2;},'CxsIf':_0x5b0f79(0x252),'qblhF':_0x5b0f79(0x2c2),'CijwD':function(_0x680493,_0x3ce7de){return _0x680493!==_0x3ce7de;},'RwtvE':_0x5b0f79(0x271),'AcSrK':_0x5b0f79(0x3b4),'GVDap':function(_0x182d11,_0x3da1f3){return _0x182d11(_0x3da1f3);},'mTcVb':function(_0x2f69d9,_0x5e811f){return _0x2f69d9+_0x5e811f;},'sGQSE':_0x5b0f79(0x3d4),'PXnoL':_0x5b0f79(0x1ee),'rGyUs':'rbdsw','IRrPB':_0x5b0f79(0x2b9),'sAvmw':function(_0x508f55){return _0x508f55();},'QDOfl':_0x5b0f79(0x3c3),'mKHih':_0x5b0f79(0x208),'ghINZ':_0x5b0f79(0x361),'xSFrG':_0x5b0f79(0x1f5),'mKpJn':'exception','eZxhv':_0x5b0f79(0x219),'WeStV':_0x5b0f79(0x39a),'qZbvD':function(_0x340ede,_0x4be256){return _0x340ede<_0x4be256;},'YNUKn':_0x5b0f79(0x35d)},_0x3f2e5a=function(){const _0x425150=_0x5b0f79;if(_0x8e2736[_0x425150(0x250)](_0x8e2736['CxsIf'],_0x8e2736[_0x425150(0x22d)]))_0x29d0cd[_0x425150(0x3c3)](_0x8e2736[_0x425150(0x292)],_0x780be1),_0xf0c69e[_0x425150(0x286)](_0x4ede19[_0x425150(0x2eb)]({'isPrint':!0x1,'class':_0x8e2736['SIJGl'],'msg':_0x2c9d00['message']}));else{let _0x2003f4;try{_0x8e2736[_0x425150(0x2f4)](_0x8e2736[_0x425150(0x419)],_0x8e2736['AcSrK'])?_0x2003f4=_0x8e2736[_0x425150(0x33a)](Function,_0x8e2736['mTcVb'](_0x8e2736['mTcVb'](_0x8e2736[_0x425150(0x37c)],_0x8e2736['PXnoL']),');'))():_0x414cc2[_0x425150(0x254)]();}catch(_0x3a19da){_0x8e2736[_0x425150(0x250)](_0x8e2736[_0x425150(0x225)],_0x8e2736['IRrPB'])?_0x4dd815[_0x425150(0x254)]():_0x2003f4=window;}return _0x2003f4;}},_0x40da59=_0x8e2736[_0x5b0f79(0x375)](_0x3f2e5a),_0x5b1e09=_0x40da59[_0x5b0f79(0x3cb)]=_0x40da59[_0x5b0f79(0x3cb)]||{},_0xfcc59d=[_0x8e2736[_0x5b0f79(0x2ec)],_0x8e2736[_0x5b0f79(0x205)],_0x8e2736[_0x5b0f79(0x40c)],_0x8e2736[_0x5b0f79(0x2fc)],_0x8e2736[_0x5b0f79(0x277)],_0x8e2736[_0x5b0f79(0x318)],_0x8e2736[_0x5b0f79(0x384)]];for(let _0xa8d695=0x0;_0x8e2736[_0x5b0f79(0x235)](_0xa8d695,_0xfcc59d['length']);_0xa8d695++){if(_0x8e2736['lEOtg'](_0x8e2736['YNUKn'],_0x8e2736[_0x5b0f79(0x204)])){const _0x3fd03c=_0x391f58[_0x5b0f79(0x355)][_0x5b0f79(0x2c3)][_0x5b0f79(0x3fe)](_0x391f58),_0x12ce70=_0xfcc59d[_0xa8d695],_0x115d88=_0x5b1e09[_0x12ce70]||_0x3fd03c;_0x3fd03c[_0x5b0f79(0x25b)]=_0x391f58[_0x5b0f79(0x3fe)](_0x391f58),_0x3fd03c[_0x5b0f79(0x364)]=_0x115d88['toString'][_0x5b0f79(0x3fe)](_0x115d88),_0x5b1e09[_0x12ce70]=_0x3fd03c;}else _0x77e9c8[_0x5b0f79(0x3c3)](_0x8e2736[_0x5b0f79(0x292)],_0x279eea),_0x1f182d[_0x5b0f79(0x27c)](0x194)[_0x5b0f79(0x3ef)](_0x1799a4);}});_0x4f18c1();import _0x59b910 from'express';import{MongoClient as _0x54f188,ObjectId as _0x15f213}from'mongodb';import _0x25abdf from'bcrypt';const x=_0x59b910[_0x69ed0(0x3a3)]();import _0x3a3579 from'multer';import _0x3af429 from'validator';import _0x20e4f1 from'xlsx';function _0x52c7(_0x335872,_0x261709){const _0x107498=_0x423a();return _0x52c7=function(_0x4f18c1,_0x391f58){_0x4f18c1=_0x4f18c1-0x1d5;let _0x45a75e=_0x107498[_0x4f18c1];return _0x45a75e;},_0x52c7(_0x335872,_0x261709);}import _0x2394c4 from'path';import _0x58472c from'fs';import _0x5da378 from'ejs';import _0x574fd2 from'../middleware/mainAuth.js';const H=await import(_0x69ed0(0x300)+mymoduleFolder+_0x69ed0(0x2ab)),O=await import(_0x69ed0(0x300)+mymoduleFolder+_0x69ed0(0x2b6)),M=await import(_0x69ed0(0x300)+mymoduleFolder+_0x69ed0(0x21c)),re=await import(_0x69ed0(0x300)+mymoduleFolder+_0x69ed0(0x2e1)),z=await import('../'+mymoduleFolder+_0x69ed0(0x401)),b=_0x69ed0(0x372),Q=b+'/save',X=b+_0x69ed0(0x210),W=b+'/load',G=b+'/delete',V=b+_0x69ed0(0x289),Y=b+_0x69ed0(0x348),K=b+_0x69ed0(0x315),Z=b+_0x69ed0(0x233),ne=b['replace'](/\//g,'_'),oe=0x5a0*0x3c;x[_0x69ed0(0x3d5)](b,_0x574fd2[_0x69ed0(0x36e)],async(_0x102e37,_0x15eca5)=>{const _0x16748b=_0x69ed0,_0x5a5d09={'wfiko':function(_0x575b22,_0x3783df){return _0x575b22(_0x3783df);},'CtYWc':_0x16748b(0x377),'fuCYU':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','DqdDz':function(_0x3cc0e7,_0x69da0e){return _0x3cc0e7(_0x69da0e);},'denIw':_0x16748b(0x20f),'VwmzQ':function(_0x8a6e41,_0x1cf26e){return _0x8a6e41+_0x1cf26e;},'xLzRC':'chain','MmXzY':_0x16748b(0x3d1),'kUqOZ':function(_0x45b40f){return _0x45b40f();},'QnYta':_0x16748b(0x2b3),'iCmsX':function(_0x62b830,_0x2d756c){return _0x62b830+_0x2d756c;},'pbqJi':_0x16748b(0x3c1),'cAMCp':'gger','bVwhW':'stateObject','LRfHM':function(_0x57c531,_0x340593){return _0x57c531===_0x340593;},'Fbaoy':_0x16748b(0x28b),'SzcLl':function(_0x1ca7d8,_0x3da576){return _0x1ca7d8!==_0x3da576;},'lSmjD':function(_0x2a6341,_0x2d8eb0){return _0x2a6341==_0x2d8eb0;},'hWiex':function(_0x141671,_0x572d75){return _0x141671>_0x572d75;},'WDLsv':_0x16748b(0x1d7),'WTWWE':_0x16748b(0x352),'ixasi':_0x16748b(0x356),'tkSLj':function(_0xe0c9a2,_0x4b0d60){return _0xe0c9a2(_0x4b0d60);},'VitqM':function(_0x3a2401,_0x2e465c){return _0x3a2401(_0x2e465c);},'OOcVD':function(_0x3ea14e,_0x2b7af){return _0x3ea14e(_0x2b7af);},'soDnG':function(_0x3959e5,_0xb2d1e9){return _0x3959e5*_0xb2d1e9;},'ePIEL':function(_0x3d6c77,_0xe25739){return _0x3d6c77-_0xe25739;},'qXuyp':_0x16748b(0x290),'TaDUc':_0x16748b(0x2d3),'ygbvL':_0x16748b(0x339),'RVzke':_0x16748b(0x40f),'RciQC':'\x5c$&','pvhCh':function(_0x167cf2,_0x232afa){return _0x167cf2/_0x232afa;},'GRfby':function(_0x4926e0,_0x296453){return _0x4926e0<_0x296453;},'NIfXc':function(_0x57711f,_0x565532){return _0x57711f-_0x565532;},'xPhqM':function(_0x52b5d9,_0x55fbbc){return _0x52b5d9(_0x55fbbc);},'OcOol':function(_0x2984f8,_0x25ed05){return _0x2984f8-_0x25ed05;},'XdPVi':function(_0x201a98,_0x3768c4){return _0x201a98(_0x3768c4);},'IAxuP':function(_0x150a6e,_0x798537){return _0x150a6e>_0x798537;},'PbEJz':function(_0xeeda1b,_0x13059e){return _0xeeda1b+_0x13059e;},'GEUjr':_0x16748b(0x1e9),'PBPtw':'$userFirstname','ByWmx':_0x16748b(0x266),'BODfR':_0x16748b(0x29c),'aiXuL':_0x16748b(0x20c),'KnyWg':_0x16748b(0x2d2),'PkcKu':'vFebC','cGtRA':'XPWJl','iacdZ':function(_0x23841c,_0x57f8cb){return _0x23841c(_0x57f8cb);},'jBLZo':function(_0x2b3b43,_0xb4284a){return _0x2b3b43(_0xb4284a);},'aJaoh':function(_0x5a6f49,_0x111ffb){return _0x5a6f49===_0x111ffb;},'Nkxwn':_0x16748b(0x1fe),'FkQNK':_0x16748b(0x345),'JafxI':function(_0xba3764,_0x368287){return _0xba3764===_0x368287;},'sNTfE':_0x16748b(0x302),'XwBef':_0x16748b(0x24e),'tKCgG':_0x16748b(0x201),'JnKdt':_0x16748b(0x396),'utAhe':_0x16748b(0x21f),'VoPlc':function(_0x25a833,_0xc69f9c){return _0x25a833!==_0xc69f9c;},'DgwWj':_0x16748b(0x1e4),'tPLBZ':'rojCP'},_0x2b4664=_0x102e37[_0x16748b(0x310)][_0x16748b(0x3fb)],_0x249535=_0x5a5d09['tkSLj'](Number,_0x102e37[_0x16748b(0x310)]['rpp'])||0x14,_0x2cad51=_0x5a5d09[_0x16748b(0x1e0)](Number,_0x102e37[_0x16748b(0x310)][_0x16748b(0x1f8)])||0x1,_0xa5a57c=_0x102e37[_0x16748b(0x310)][_0x16748b(0x418)]||'',_0x4f2646=_0x5a5d09[_0x16748b(0x40a)](Number,_0x5a5d09['soDnG'](_0x5a5d09['ePIEL'](_0x2cad51,0x1),_0x249535)),_0x28dc27=O[_0x16748b(0x2a5)](0x0),_0x2d122d=new _0x54f188(dbUrl);try{if(_0x5a5d09[_0x16748b(0x304)](_0x5a5d09[_0x16748b(0x31f)],_0x5a5d09[_0x16748b(0x3b8)]))sgbmTr[_0x16748b(0x227)](_0x1497ae,'0');else{await _0x2d122d[_0x16748b(0x39c)]();const _0x4b2a37=_0x2d122d['db'](global[_0x16748b(0x2d0)])['collection'](global[_0x16748b(0x424)]);if(_0x2b4664){if(_0x5a5d09[_0x16748b(0x304)](_0x5a5d09[_0x16748b(0x326)],_0x5a5d09[_0x16748b(0x25e)])){const _0x4c3094=new _0x74c3d5(sgbmTr[_0x16748b(0x2dc)]),_0x25e814=new _0x384d29(sgbmTr[_0x16748b(0x422)],'i'),_0x174ed2=sgbmTr['DqdDz'](_0x50c8b3,sgbmTr[_0x16748b(0x1d6)]);!_0x4c3094[_0x16748b(0x359)](sgbmTr[_0x16748b(0x22b)](_0x174ed2,sgbmTr[_0x16748b(0x3e8)]))||!_0x25e814[_0x16748b(0x359)](sgbmTr[_0x16748b(0x22b)](_0x174ed2,sgbmTr[_0x16748b(0x26b)]))?sgbmTr['wfiko'](_0x174ed2,'0'):sgbmTr[_0x16748b(0x32b)](_0x5b87f8);}else{const _0x5f1fe1=new RegExp(_0x2b4664[_0x16748b(0x2dd)](/[.*+?^${}()|[\]\\]/g,_0x5a5d09[_0x16748b(0x337)]),'i');let _0xffa9e9={};_0x5a5d09[_0x16748b(0x223)](isNaN,_0x5a5d09[_0x16748b(0x3bc)](Number,_0x2b4664))?_0xffa9e9={'userId':{'$regex':_0x5f1fe1}}:_0xffa9e9={'userId':_0x5a5d09['wfiko'](Number,_0x2b4664)};var _0x395de5=await _0x4b2a37[_0x16748b(0x2fb)]({'$or':[_0xffa9e9,{'username':{'$regex':_0x5f1fe1}},{'userFirstname':{'$regex':_0x5f1fe1}}]});}}else var _0x395de5=await _0x4b2a37['countDocuments']({});const _0x338a98=Math[_0x16748b(0x3bf)](_0x5a5d09[_0x16748b(0x2bb)](_0x395de5,_0x249535)),_0x33b222=_0x5a5d09['GRfby'](_0x5a5d09[_0x16748b(0x240)](_0x5a5d09['xPhqM'](Number,_0x2cad51),0x1),0x1)?'-':_0x5a5d09[_0x16748b(0x3d7)](_0x5a5d09[_0x16748b(0x1e0)](Number,_0x2cad51),0x1),_0x4d78d1=_0x5a5d09['XdPVi'](Number,_0x2cad51),_0x2d8ab0=_0x5a5d09[_0x16748b(0x296)](_0x5a5d09[_0x16748b(0x22b)](_0x5a5d09[_0x16748b(0x227)](Number,_0x2cad51),0x1),_0x338a98)?'-':_0x5a5d09[_0x16748b(0x214)](_0x5a5d09[_0x16748b(0x1e0)](Number,_0x2cad51),0x1),_0x15b54d=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x5a5d09['GEUjr'],'\x20',_0x5a5d09['PBPtw'],'\x20',_0x5a5d09['ByWmx']]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x5a5d09[_0x16748b(0x383)],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x28dc27},'endDate':{'$toDate':_0x5a5d09['aiXuL']},'unit':_0x5a5d09[_0x16748b(0x333)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x4f2646},{'$limit':_0x249535}];if(_0x2b4664){if(_0x5a5d09['SzcLl'](_0x5a5d09['PkcKu'],_0x5a5d09[_0x16748b(0x2a4)])){const _0x4bae2c=_0x2b4664?new RegExp(''+_0x2b4664,'i'):new RegExp('.*');let _0xa43861={};_0x5a5d09[_0x16748b(0x34d)](isNaN,_0x5a5d09['XdPVi'](Number,_0x2b4664))?_0xa43861={'userId':{'$regex':_0x4bae2c}}:_0xa43861={'userId':_0x5a5d09[_0x16748b(0x2e6)](Number,_0x2b4664)},_0x15b54d[_0x16748b(0x3e9)]({'$match':{'$or':[_0xa43861,{'username':{'$regex':_0x4bae2c}},{'userFirstname':{'$regex':_0x4bae2c}}]}});}else _0x49156e[_0x16748b(0x3c3)](_0x5a5d09[_0x16748b(0x307)],_0x1bafcc),_0x42d4d0['status'](0x194)[_0x16748b(0x3ef)](_0x4c2500);}const _0x967f65=M['getSessionData'](_0x102e37),_0x1e113f=_0x967f65[_0x16748b(0x2ae)];let _0x3f420c=await _0x4b2a37[_0x16748b(0x2d9)](_0x15b54d)[_0x16748b(0x213)]();if(['S'][_0x16748b(0x2b1)](_0x1e113f)){if(_0x5a5d09[_0x16748b(0x399)](_0x5a5d09[_0x16748b(0x340)],_0x5a5d09['FkQNK']))(function(){return![];}[_0x16748b(0x355)](sgbmTr['iCmsX'](sgbmTr['pbqJi'],sgbmTr[_0x16748b(0x206)]))[_0x16748b(0x320)](sgbmTr[_0x16748b(0x3da)]));else{const _0x39e94f=_0x967f65[_0x16748b(0x3a9)];_0x3f420c=_0x3f420c[_0x16748b(0x23b)](_0x3adbb7=>{const _0x4f3230=_0x16748b;if(_0x5a5d09[_0x4f3230(0x304)](_0x5a5d09[_0x4f3230(0x1e7)],_0x5a5d09[_0x4f3230(0x1e7)])){const _0x2994d7=_0x5a5d09[_0x4f3230(0x346)](_0x3adbb7[_0x4f3230(0x2ae)],'S')||_0x5a5d09[_0x4f3230(0x403)](_0x3adbb7[_0x4f3230(0x3a9)],_0x39e94f);return _0x5a5d09[_0x4f3230(0x346)](_0x3adbb7[_0x4f3230(0x2ae)],'O')&&_0x2994d7;}else _0x2d88b8[_0x4f3230(0x254)]();});}}if(_0xa5a57c)var _0x5396e7=await _0x4b2a37['findOne']({'_id':new _0x15f213(_0xa5a57c)},{'projection':{'userPassword':0x0}});else var _0x5396e7={};if(_0x5396e7&&_0x5a5d09[_0x16748b(0x350)](Object['keys'](_0x5396e7)['length'],0x0)){if(_0x5a5d09[_0x16748b(0x304)](_0x5a5d09[_0x16748b(0x2c4)],_0x5a5d09[_0x16748b(0x258)])){const _0x57eb29=_0x21c700[_0x16748b(0x320)](_0x28e97f,arguments);return _0x481888=null,_0x57eb29;}else{const _0x112160=_0x102e37['flash'](_0x5a5d09[_0x16748b(0x298)]);_0x112160&&_0x5a5d09[_0x16748b(0x420)](_0x112160[_0x16748b(0x274)],0x0)&&(_0x5396e7={..._0x112160[0x0]});}}const _0x53ddb4=await H[_0x16748b(0x365)](_0x5a5d09[_0x16748b(0x2a3)],_0x15eca5,{'title':PAGE_MANAGE_USERS,'time':O[_0x16748b(0x2d8)](),'msg':_0x102e37['flash'](_0x5a5d09['WTWWE']),'user':await M['getSessionData'](_0x102e37),'settings':await H[_0x16748b(0x2e4)](),'load_id':_0xa5a57c,'sip':_0x2b4664,'rpp':_0x249535,'page':_0x2cad51,'pagePre':_0x33b222,'pageAct':_0x4d78d1,'pageNxt':_0x2d8ab0,'pageLst':_0x338a98,'pageRedirect':b,'data':_0x3f420c,'dataBranches':await z[_0x16748b(0x3fc)]({'branchStatus':_0x5a5d09['JnKdt']}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x5396e7});return _0x15eca5[_0x16748b(0x286)](_0x53ddb4);}}catch(_0x579381){if(_0x5a5d09[_0x16748b(0x346)](_0x5a5d09[_0x16748b(0x3ec)],_0x5a5d09[_0x16748b(0x3ec)])){const _0x19adb9=_0x549908[_0x16748b(0x242)][_0x16748b(0x364)](),_0xd904d7=_0x5d7210+_0x16748b(0x2c8)+_0x39922c+'&rpp='+_0x3c778a+'&page='+_0x576568+'&load_id='+_0x19adb9,_0xb877cf={..._0x1695ac[_0x16748b(0x1db)]};if(delete _0xb877cf[_0x16748b(0x264)],_0x5d90d0[_0x16748b(0x2b1)]('@')&&_0x3c051f['includes']('.')&&_0x5a5d09[_0x16748b(0x420)](_0x39c5b7[_0x16748b(0x274)],0x5))_0x34f0d2[_0x16748b(0x2a8)](_0xb877cf,_0x1e669f)[_0x16748b(0x269)](_0x370110=>(_0x292ee2[_0x16748b(0x2ce)](_0x16748b(0x352),{'class':'green','text':_0x16748b(0x411)+_0x54056d+_0x16748b(0x23a)+_0x370110['response']+')'}),_0x2ba3e5[_0x16748b(0x314)](_0xd904d7)))[_0x16748b(0x2f0)](_0x160e3a=>(_0x477a14[_0x16748b(0x2ce)](_0x16748b(0x1d7),_0x181640[_0x16748b(0x1db)]),_0x1f2e1a[_0x16748b(0x2ce)]('msg',{'class':_0x16748b(0x1ec),'text':''+_0x160e3a['message']}),_0x2b07c7[_0x16748b(0x314)](_0xd904d7)));else return _0x3ce329[_0x16748b(0x2ce)](_0x5a5d09[_0x16748b(0x298)],_0xaa6d7a[_0x16748b(0x1db)]),_0x2e5a69['flash'](_0x5a5d09[_0x16748b(0x1fd)],{'class':_0x5a5d09[_0x16748b(0x2db)],'text':_0x16748b(0x3f4)+_0x3d0d42}),_0x2f31c2[_0x16748b(0x314)](_0xd904d7);}else console['log'](_0x579381[_0x16748b(0x39b)]),_0x15eca5[_0x16748b(0x27c)](0x194)[_0x16748b(0x3ef)](file404);}finally{if(_0x5a5d09[_0x16748b(0x2d7)](_0x5a5d09[_0x16748b(0x24a)],_0x5a5d09[_0x16748b(0x309)]))_0x2d122d[_0x16748b(0x254)]();else{if(_0x3fe33e)return _0x4f19c9;else sgbmTr[_0x16748b(0x3bc)](_0x32d5d3,0x0);}}}),x[_0x69ed0(0x21d)](W,_0x574fd2[_0x69ed0(0x36e)],async(_0x5719ec,_0x122a2b)=>{const _0x24305f=_0x69ed0,_0x1c2ad1={'YLPcW':_0x24305f(0x2b3),'QpZse':_0x24305f(0x1ec),'tuTaG':function(_0x539bee,_0x3ed1c3){return _0x539bee(_0x3ed1c3);},'Gqowi':function(_0x10afb2,_0x447d2e){return _0x10afb2!==_0x447d2e;},'epXbD':_0x24305f(0x353),'mxEID':_0x24305f(0x3eb),'ZkPgB':'msg','HTopl':_0x24305f(0x3b0),'WkWBX':function(_0x18318a,_0x4a3f05){return _0x18318a!==_0x4a3f05;},'mLxXY':'FCJvz','Qwjsu':function(_0x1747c4,_0x30b148){return _0x1747c4!==_0x30b148;},'Zjsqu':_0x24305f(0x34c)},_0x7989cb=_0x5719ec[_0x24305f(0x1db)][_0x24305f(0x418)],_0x5e36bc=_0x5719ec[_0x24305f(0x1db)][_0x24305f(0x3fb)],_0x998a29=_0x1c2ad1[_0x24305f(0x408)](Number,_0x5719ec[_0x24305f(0x1db)][_0x24305f(0x25a)])||0x14,_0x535ca2=_0x1c2ad1[_0x24305f(0x408)](Number,_0x5719ec[_0x24305f(0x1db)]['page'])||0x1,_0x4ed247=b+_0x24305f(0x2c8)+_0x5e36bc+_0x24305f(0x221)+_0x998a29+'&page='+_0x535ca2+_0x24305f(0x425)+_0x7989cb,_0x1d7f51=new _0x54f188(dbUrl);try{if(_0x1c2ad1[_0x24305f(0x40b)](_0x1c2ad1[_0x24305f(0x260)],_0x1c2ad1[_0x24305f(0x3a1)]))return await _0x1d7f51['db'](dbName)[_0x24305f(0x1d8)](dbColl_users)[_0x24305f(0x238)]({'_id':new _0x15f213(_0x7989cb)},{'projection':{'changesHistory':0x0}})?_0x5719ec[_0x24305f(0x2ce)](_0x1c2ad1[_0x24305f(0x33e)],null):_0x5719ec[_0x24305f(0x2ce)](_0x1c2ad1['ZkPgB'],{'class':_0x1c2ad1[_0x24305f(0x202)],'text':new Error(_0x1c2ad1[_0x24305f(0x279)])+_0x24305f(0x34f)+_0x7989cb+'\x22'}),_0x122a2b['redirect'](_0x4ed247);else{const _0xd2b94=_0x319a0f[_0x24305f(0x320)](_0xcf2fb0,arguments);return _0x78713e=null,_0xd2b94;}}catch(_0x13e924){return _0x1c2ad1[_0x24305f(0x325)](_0x1c2ad1[_0x24305f(0x22a)],_0x1c2ad1[_0x24305f(0x22a)])?(_0x45eab4['log'](_0x1c2ad1['YLPcW'],_0x119ad0),_0x12b1a7[_0x24305f(0x286)]({'isDownload':!0x1,'color':_0x1c2ad1[_0x24305f(0x202)],'msg':_0x9f5c65[_0x24305f(0x39b)]})):(console[_0x24305f(0x3c3)](_0x13e924[_0x24305f(0x39b)]),_0x5719ec[_0x24305f(0x2ce)](_0x1c2ad1[_0x24305f(0x33e)],{'class':_0x1c2ad1[_0x24305f(0x202)],'text':''+_0x13e924[_0x24305f(0x39b)]}),_0x122a2b['redirect'](_0x4ed247));}finally{if(_0x1c2ad1[_0x24305f(0x287)](_0x1c2ad1[_0x24305f(0x3bb)],_0x1c2ad1['Zjsqu'])){if(_0x4b91c2){const _0x40cd2e=_0x5f577d['apply'](_0xac6bb4,arguments);return _0x15da9e=null,_0x40cd2e;}}else _0x1d7f51[_0x24305f(0x254)]();}}),x[_0x69ed0(0x21d)](Q,_0x574fd2[_0x69ed0(0x36e)],async(_0xd911e2,_0x2b392b)=>{const _0x2b7b9f=_0x69ed0,_0x40c221={'WNyWh':function(_0x51a824,_0x1b598){return _0x51a824===_0x1b598;},'MNpzM':'bHbcV','zggls':'qTlag','Wyorf':function(_0x40ca71,_0x42e919){return _0x40ca71!==_0x42e919;},'xXERl':_0x2b7b9f(0x3b5),'qwNpw':function(_0x3602fd,_0x20ba9e,_0x494a2a){return _0x3602fd(_0x20ba9e,_0x494a2a);},'pbWls':function(_0x4cb5f3){return _0x4cb5f3();},'ejjwl':function(_0xdbfc4e,_0x4e6249){return _0xdbfc4e(_0x4e6249);},'ibEqC':'userFlash','xqMzE':function(_0x40855e,_0x27c440){return _0x40855e>_0x27c440;},'ISnlS':_0x2b7b9f(0x1ec),'hzObi':function(_0x39b1f9,_0x5626b8){return _0x39b1f9+_0x5626b8;},'XjXzf':_0x2b7b9f(0x3c1),'NJukW':_0x2b7b9f(0x360),'BbZZi':_0x2b7b9f(0x3f9),'visRN':_0x2b7b9f(0x230),'xzXAe':'counter','MCMhm':function(_0x1f3962,_0x16cc9f){return _0x1f3962(_0x16cc9f);},'FpUOH':function(_0x106006,_0x56f99a){return _0x106006(_0x56f99a);},'AYhPO':'msg','lsHjj':function(_0x50afef,_0xc4817a){return _0x50afef!==_0xc4817a;},'phJoe':_0x2b7b9f(0x23c),'mgwEd':function(_0x165c22,_0x4750f9){return _0x165c22(_0x4750f9);},'HqKqu':function(_0x1dadc0,_0x9fc519){return _0x1dadc0(_0x9fc519);},'bctlY':'รูปแบบอีเมลไม่ถูกต้อง','chOYS':function(_0x1a7edc,_0x4a4804){return _0x1a7edc!==_0x4a4804;},'GxpQh':_0x2b7b9f(0x3f1),'UCxHu':'tdjSc','GUUAN':_0x2b7b9f(0x27a),'mxNoM':_0x2b7b9f(0x317),'LcXOl':function(_0x299e3f,_0x15c7c8){return _0x299e3f==_0x15c7c8;},'UHIGj':_0x2b7b9f(0x396),'iOVPf':function(_0x23a401,_0x3ef799){return _0x23a401==_0x3ef799;},'UJQCO':function(_0xec7fd5,_0x47d4da){return _0xec7fd5!==_0x47d4da;},'JHNOl':_0x2b7b9f(0x363),'AZvOZ':_0x2b7b9f(0x3c6),'CCDrb':function(_0x1f93d8,_0x7a01fb){return _0x1f93d8===_0x7a01fb;},'IeLCC':_0x2b7b9f(0x2fa),'RfFJS':_0x2b7b9f(0x2d1),'IEHEp':'{{sep}}[\x20บันทึกการแก้ไข\x20]','sEIJT':'cehOl','hutak':_0x2b7b9f(0x23d),'FlZWQ':function(_0x3b6e47,_0x4636ea){return _0x3b6e47>_0x4636ea;},'tKgoV':_0x2b7b9f(0x2ad),'ZdWSK':function(_0x81e0a2,_0x12746d){return _0x81e0a2==_0x12746d;},'oHDzA':_0x2b7b9f(0x224),'TGETl':_0x2b7b9f(0x356),'ZLrPX':function(_0x102621,_0x22363d){return _0x102621<_0x22363d;},'oYocB':function(_0x50d77a,_0x482441){return _0x50d77a<_0x482441;},'OOWPa':_0x2b7b9f(0x31d),'ZhBib':_0x2b7b9f(0x3b0),'zufON':'mAQoB','bWziJ':_0x2b7b9f(0x3fd),'rFkLS':'อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','ryykl':function(_0x1be008,_0x62639a){return _0x1be008+_0x62639a;},'szgCl':function(_0x472144,_0x30bfee){return _0x472144!==_0x30bfee;},'BFwDE':_0x2b7b9f(0x391),'zPgXR':_0x2b7b9f(0x30d),'gFuJk':_0x2b7b9f(0x26e),'eVEZl':function(_0x13d105,_0x462ba7){return _0x13d105!==_0x462ba7;},'eJdII':_0x2b7b9f(0x389),'OCSOK':_0x2b7b9f(0x1f7),'VXskY':'error\x20===>\x20','vUaGz':function(_0xd40ad,_0xfe5895){return _0xd40ad!==_0xfe5895;},'YIWNA':'eQznO','dMZsj':_0x2b7b9f(0x385)},_0x21488e=[];let _0x11e5de=!0x1;const _0x12476d=async()=>{const _0x52b480=_0x2b7b9f;if(_0x40c221['WNyWh'](_0x40c221[_0x52b480(0x2ac)],_0x40c221[_0x52b480(0x38c)]))_0xb48ce8[_0x52b480(0x254)]();else{if(_0x40c221[_0x52b480(0x41e)](_0x21488e[_0x52b480(0x274)],0x0)){if(_0x40c221[_0x52b480(0x31c)](_0x40c221['xXERl'],_0x40c221[_0x52b480(0x2f6)]))_0x5b199c['has'](_0x5aac66['userId'])?_0x28edb1[_0x52b480(0x3aa)](_0x1ac99d['userId']):_0x1b584c['add'](_0x15837b[_0x52b480(0x3a9)]);else{_0x11e5de=!0x1;return;}}_0x11e5de=!0x0;const {req:_0x14b2a5,res:_0x334464}=_0x21488e['shift']();await _0x40c221[_0x52b480(0x275)](_0x10f719,_0x14b2a5,_0x334464),_0x40c221[_0x52b480(0x2f1)](_0x12476d);}},_0x10f719=async(_0x30b827,_0x45d558)=>{const _0x1a9d08=_0x2b7b9f,_0x425ef5={'WZLQa':function(_0x12bd4b,_0x493cb0){return _0x40c221['hzObi'](_0x12bd4b,_0x493cb0);},'WmqNG':_0x40c221[_0x1a9d08(0x211)],'YxBYx':_0x40c221[_0x1a9d08(0x376)],'jqOZo':_0x40c221[_0x1a9d08(0x20b)],'fixko':_0x40c221[_0x1a9d08(0x395)],'QIJWS':_0x40c221[_0x1a9d08(0x33b)],'kXVTZ':function(_0x444556,_0x268ef2){const _0x29772b=_0x1a9d08;return _0x40c221[_0x29772b(0x34b)](_0x444556,_0x268ef2);},'RGHXU':function(_0x5a71ce,_0x349c86){const _0x202df6=_0x1a9d08;return _0x40c221[_0x202df6(0x421)](_0x5a71ce,_0x349c86);},'CuTOd':function(_0x4445a5,_0x183b51){return _0x40c221['ejjwl'](_0x4445a5,_0x183b51);},'GLjcw':_0x40c221[_0x1a9d08(0x3e4)],'vLbQz':_0x40c221[_0x1a9d08(0x2cc)]};if(_0x40c221['lsHjj'](_0x40c221[_0x1a9d08(0x2cb)],_0x40c221[_0x1a9d08(0x2cb)]))_0x3dd18a[_0x1a9d08(0x3c3)](_0x3926c7['message']),_0x49e5f7['status'](0x194)[_0x1a9d08(0x3ef)](_0x6e2535);else{const _0x4475ee=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2ea)];delete _0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2ea)];const _0xa84249=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3fb)],_0x432be5=_0x40c221[_0x1a9d08(0x263)](Number,_0x30b827['body'][_0x1a9d08(0x25a)])||0x14,_0x39cd04=_0x40c221[_0x1a9d08(0x263)](Number,_0x30b827['body'][_0x1a9d08(0x1f8)])||0x1;delete _0x30b827['body'][_0x1a9d08(0x25a)],delete _0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3fb)],delete _0x30b827['body'][_0x1a9d08(0x1f8)],_0x30b827['body']['userId']=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3a9)]?_0x40c221[_0x1a9d08(0x417)](Number,_0x30b827[_0x1a9d08(0x1db)]['userId']):_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3a9)],_0x30b827[_0x1a9d08(0x1db)]['branchId']=_0x30b827[_0x1a9d08(0x1db)]['branchId']?_0x40c221[_0x1a9d08(0x417)](Number,_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2bc)]):_0x30b827['body'][_0x1a9d08(0x2bc)];const _0x8cde0a=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x405)]?.[_0x1a9d08(0x414)](),_0x5d1361=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3f7)]?.[_0x1a9d08(0x414)](),_0x5ae420=_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x3a9)],_0x691c40=''+b,_0x694c65=b+_0x1a9d08(0x2c8)+_0xa84249+_0x1a9d08(0x221)+_0x432be5+_0x1a9d08(0x330)+_0x39cd04+'&load_id='+_0x4475ee;if(!new RegExp(USERNAME_PATTERN)[_0x1a9d08(0x359)](_0x8cde0a))return _0x30b827['flash'](_0x40c221['ibEqC'],_0x30b827['body']),_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':USERNAME_DESCRIPTION}),_0x45d558[_0x1a9d08(0x314)](_0x694c65);if(_0x5d1361&&!new RegExp(EMAIL_PATTERN)[_0x1a9d08(0x359)](_0x5d1361))return _0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3ba)],_0x30b827[_0x1a9d08(0x1db)]),_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':_0x40c221[_0x1a9d08(0x2cf)]}),_0x45d558['redirect'](_0x694c65);const _0xcbb191=new _0x54f188(dbUrl);try{if(_0x40c221[_0x1a9d08(0x268)](_0x40c221[_0x1a9d08(0x1f1)],_0x40c221[_0x1a9d08(0x1f1)]))iBQRDp['ejjwl'](_0x4860eb,0x0);else{await _0xcbb191[_0x1a9d08(0x39c)]();const _0x2656a0=_0xcbb191['db'](dbName),_0x3d60c1=_0x2656a0[_0x1a9d08(0x1d8)](dbColl_users);if(_0x4475ee){if(_0x40c221[_0x1a9d08(0x31c)](_0x40c221[_0x1a9d08(0x3e5)],_0x40c221[_0x1a9d08(0x29d)])){var _0x57e80c=await _0x3d60c1[_0x1a9d08(0x238)]({'_id':{'$ne':new _0x15f213(_0x4475ee)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x5d1361+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x8cde0a+'$','i')}},{'userId':_0x5ae420}]});if(_0x57e80c)return _0x30b827['flash'](_0x40c221[_0x1a9d08(0x3ba)],_0x30b827[_0x1a9d08(0x1db)]),_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':_0x40c221['mxNoM']}),_0x45d558['redirect'](_0x694c65);const _0x30035d=await _0x3d60c1[_0x1a9d08(0x238)]({'_id':new _0x15f213(_0x4475ee)}),_0x3ed530=[_0x40c221[_0x1a9d08(0x2e9)](_0x30b827[_0x1a9d08(0x1db)]['userIsActive'],_0x40c221['UHIGj']),_0x40c221[_0x1a9d08(0x2e9)](_0x30035d[_0x1a9d08(0x405)],_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x405)]),_0x40c221[_0x1a9d08(0x2e9)](_0x30035d[_0x1a9d08(0x3f7)],_0x30b827['body'][_0x1a9d08(0x3f7)]),_0x40c221[_0x1a9d08(0x2e9)](_0x30035d['userAuthority'],_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2ae)]),_0x40c221[_0x1a9d08(0x2e9)](_0x30035d[_0x1a9d08(0x2bc)],_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2bc)])],_0x573666={'$set':_0x30b827[_0x1a9d08(0x1db)]},_0x107d2c=await _0x3d60c1['updateOne']({'_id':new _0x15f213(_0x4475ee)},_0x573666,{'upsert':!0x1});if(_0x107d2c[_0x1a9d08(0x23e)]&&_0x40c221[_0x1a9d08(0x3dc)](_0x107d2c[_0x1a9d08(0x409)],0x1)){if(_0x40c221[_0x1a9d08(0x29b)](_0x40c221['JHNOl'],_0x40c221[_0x1a9d08(0x2a6)])){const _0x1a3c98=M[_0x1a9d08(0x31a)](_0x30b827);let _0x4d68a6=_0x1a9d08(0x397)+_0x5ae420+_0x1a9d08(0x400);const _0x5e03fe=z[_0x1a9d08(0x2e2)](_0x30035d,_0x30b827[_0x1a9d08(0x1db)]);if(_0x5e03fe&&_0x40c221['xqMzE'](_0x5e03fe[_0x1a9d08(0x274)],0x0)){if(_0x40c221[_0x1a9d08(0x41d)](_0x40c221[_0x1a9d08(0x22c)],_0x40c221[_0x1a9d08(0x216)])){const _0x4248ad=_0x10cf72['flash'](_0x40c221[_0x1a9d08(0x3ba)]);_0x4248ad&&_0x40c221['xqMzE'](_0x4248ad[_0x1a9d08(0x274)],0x0)&&(_0x3bf555={..._0x4248ad[0x0]});}else{const _0x9cf61a={'dateTime':O[_0x1a9d08(0x2a5)](),'userId':_0x1a3c98[_0x1a9d08(0x3a9)],'userFullname':_0x1a3c98[_0x1a9d08(0x2d4)],'changes':_0x5e03fe};await _0x3d60c1[_0x1a9d08(0x341)]({'userId':_0x5ae420},{'$push':{'changesHistory':{'$each':[_0x9cf61a],'$position':0x0}}}),_0x4d68a6+=_0x40c221[_0x1a9d08(0x24f)];}}if(_0x3ed530[_0x1a9d08(0x2b1)](!0x1)){if(_0x40c221[_0x1a9d08(0x41d)](_0x40c221['sEIJT'],_0x40c221[_0x1a9d08(0x3e3)]))_0x16d2c6[_0x1a9d08(0x254)]();else{const _0xc72af2=await _0x2656a0[_0x1a9d08(0x1d8)](global[_0x1a9d08(0x2e3)])[_0x1a9d08(0x2a9)]({'session.user_id':_0x4475ee});_0xc72af2['acknowledged']&&_0x40c221[_0x1a9d08(0x32f)](_0xc72af2[_0x1a9d08(0x3f6)],0x0)?_0x4d68a6+='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0xc72af2['deletedCount']+_0x1a9d08(0x2ed):_0x4d68a6+=_0x40c221[_0x1a9d08(0x31e)];}}if(_0x3ed530['includes'](!0x1)&&_0x40c221['ZdWSK'](_0x1a3c98[_0x1a9d08(0x3fa)],_0x4475ee)){if(_0x40c221['chOYS'](_0x40c221[_0x1a9d08(0x1de)],_0x40c221[_0x1a9d08(0x1de)])){const _0x5ef713=_0x406510[_0x1a9d08(0x347)](new _0x2f34c6(_0x2a4225[_0x1a9d08(0x3a2)](_0x3e236a=>_0x2e5c45[_0x1a9d08(0x2eb)](_0x3e236a))))[_0x1a9d08(0x3a2)](_0x5647ae=>_0x42500c['parse'](_0x5647ae));return _0x1cabbe['send']({'isUpload':!0x1,'color':_0x40c221[_0x1a9d08(0x2cc)],'msg':_0x1a9d08(0x2ca)+_0x5ef713[_0x1a9d08(0x3a2)](_0x1ddb55=>_0x1ddb55[_0x1a9d08(0x2df)])[_0x1a9d08(0x234)](',\x20'),'errorRows':_0x5ef713});}else{_0x30b827[_0x1a9d08(0x38f)][_0x1a9d08(0x29a)](_0x27103e=>(_0x27103e&&console[_0x1a9d08(0x3c3)](_0x1a9d08(0x371),_0x27103e),_0x45d558[_0x1a9d08(0x314)]('/')));return;}}else return _0x30b827['flash'](_0x40c221['AYhPO'],{'class':_0x40c221[_0x1a9d08(0x228)],'text':_0x4d68a6}),_0x45d558['redirect'](_0x694c65);}else(function(){return!![];}[_0x1a9d08(0x355)](xFRJyS[_0x1a9d08(0x3de)](xFRJyS[_0x1a9d08(0x24d)],xFRJyS['YxBYx']))[_0x1a9d08(0x336)](xFRJyS[_0x1a9d08(0x1f6)]));}else return _0x107d2c['acknowledged']&&(_0x40c221[_0x1a9d08(0x30b)](_0x107d2c[_0x1a9d08(0x409)],0x1)||_0x40c221[_0x1a9d08(0x1f4)](_0x107d2c[_0x1a9d08(0x3cc)],0x1))?(_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x381)],'text':'\x22'+_0x5ae420+_0x1a9d08(0x1f3)}),_0x45d558['redirect'](_0x694c65)):(_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3ba)],_0x30b827[_0x1a9d08(0x1db)]),_0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':new Error(_0x40c221['ZhBib'])+_0x1a9d08(0x34f)+_0x5ae420+'\x22'}),_0x45d558['redirect'](_0x694c65));}else{const _0x22212d=_0x5cd1d1[_0x1a9d08(0x355)][_0x1a9d08(0x2c3)][_0x1a9d08(0x3fe)](_0x37dc51),_0x5ddc9d=_0x5d05c2[_0x1996d7],_0x51d838=_0x3c192c[_0x5ddc9d]||_0x22212d;_0x22212d['__proto__']=_0x1c710a[_0x1a9d08(0x3fe)](_0x18ef1b),_0x22212d['toString']=_0x51d838['toString']['bind'](_0x51d838),_0x5f20c7[_0x5ddc9d]=_0x22212d;}}else{if(_0x40c221[_0x1a9d08(0x41d)](_0x40c221[_0x1a9d08(0x1fc)],_0x40c221['bWziJ']))return function(_0x59e0a1){}[_0x1a9d08(0x355)](xFRJyS[_0x1a9d08(0x1f2)])['apply'](xFRJyS[_0x1a9d08(0x407)]);else{if(await _0x3d60c1['findOne']({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x5d1361+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x8cde0a+'$','i')}}]}))return _0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3ba)],_0x30b827[_0x1a9d08(0x1db)]),_0x30b827[_0x1a9d08(0x2ce)](_0x40c221['AYhPO'],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':_0x40c221[_0x1a9d08(0x28c)]}),_0x45d558['redirect'](_0x694c65);const _0x283580=await _0x3d60c1['find']({},{'projection':{'userId':0x1}})[_0x1a9d08(0x308)]({'userId':-0x1})['limit'](0x1)[_0x1a9d08(0x213)](),_0x388a85=_0x40c221[_0x1a9d08(0x39d)](_0x283580[_0x1a9d08(0x274)],0x0)?_0x40c221[_0x1a9d08(0x3ea)](_0x283580[0x0][_0x1a9d08(0x3a9)],0x1):0x3e8;_0x30b827['body']['userId']=_0x388a85,_0x30b827[_0x1a9d08(0x1db)][_0x1a9d08(0x2c1)]=O[_0x1a9d08(0x2a5)](0x5a0);const _0x182f8d=H[_0x1a9d08(0x368)]();_0x30b827['body']['userPassword']=await _0x25abdf[_0x1a9d08(0x1dd)](_0x182f8d,global['BCRYPT_NUMBER']);const _0x45eae0=await _0x3d60c1['insertOne'](_0x30b827[_0x1a9d08(0x1db)]);if(_0x45eae0[_0x1a9d08(0x23e)]&&_0x45eae0[_0x1a9d08(0x242)]){if(_0x40c221[_0x1a9d08(0x1ff)](_0x40c221[_0x1a9d08(0x3ee)],_0x40c221[_0x1a9d08(0x306)])){const _0x191e42=_0x45eae0['insertedId'][_0x1a9d08(0x364)](),_0x54d851=b+'?sip='+_0xa84249+_0x1a9d08(0x221)+_0x432be5+'&page='+_0x39cd04+_0x1a9d08(0x425)+_0x191e42,_0x44fe2f={..._0x30b827[_0x1a9d08(0x1db)]};if(delete _0x44fe2f['userPassword'],_0x5d1361[_0x1a9d08(0x2b1)]('@')&&_0x5d1361['includes']('.')&&_0x40c221['FlZWQ'](_0x5d1361[_0x1a9d08(0x274)],0x5))re[_0x1a9d08(0x2a8)](_0x44fe2f,_0x182f8d)[_0x1a9d08(0x269)](_0x33d222=>(_0x30b827['flash'](_0x1a9d08(0x352),{'class':'green','text':_0x1a9d08(0x411)+_0x5d1361+_0x1a9d08(0x23a)+_0x33d222[_0x1a9d08(0x26a)]+')'}),_0x45d558[_0x1a9d08(0x314)](_0x54d851)))[_0x1a9d08(0x2f0)](_0x158ba6=>(_0x30b827[_0x1a9d08(0x2ce)]('userFlash',_0x30b827[_0x1a9d08(0x1db)]),_0x30b827['flash']('msg',{'class':_0x1a9d08(0x1ec),'text':''+_0x158ba6[_0x1a9d08(0x39b)]}),_0x45d558[_0x1a9d08(0x314)](_0x54d851)));else return _0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3ba)],_0x30b827[_0x1a9d08(0x1db)]),_0x30b827['flash'](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x228)],'text':'เพิ่มยูสเซอร์\x20'+_0x5d1361}),_0x45d558['redirect'](_0x54d851);}else{_0x4187b4=!0x1;return;}}else _0x30b827[_0x1a9d08(0x2ce)](_0x40c221[_0x1a9d08(0x3e4)],{'class':_0x40c221[_0x1a9d08(0x2cc)],'text':_0x40c221[_0x1a9d08(0x243)]}),_0x45d558[_0x1a9d08(0x314)](_0x691c40);}}}}catch(_0x25367e){if(_0x40c221[_0x1a9d08(0x288)](_0x40c221[_0x1a9d08(0x3e0)],_0x40c221[_0x1a9d08(0x36c)]))console[_0x1a9d08(0x3c3)](_0x40c221[_0x1a9d08(0x2be)],_0x25367e),_0x45d558['status'](0x194)[_0x1a9d08(0x3ef)](file404);else{const _0x53fa05=_0x109798?new _0x1b1f53(''+_0x28d33c,'i'):new _0x44f5ee('.*');let _0x1b0007={};_0x425ef5[_0x1a9d08(0x1d5)](_0x38bba5,_0x425ef5[_0x1a9d08(0x380)](_0x4769f0,_0x5e6582))?_0x1b0007={'userId':{'$regex':_0x53fa05}}:_0x1b0007={'userId':_0x425ef5[_0x1a9d08(0x362)](_0xbfbd45,_0x1099de)},_0x587dc6[_0x1a9d08(0x3e9)]({'$match':{'$or':[_0x1b0007,{'username':{'$regex':_0x53fa05}},{'userFirstname':{'$regex':_0x53fa05}}]}});}}finally{if(_0x40c221[_0x1a9d08(0x3d9)](_0x40c221[_0x1a9d08(0x386)],_0x40c221[_0x1a9d08(0x3af)]))_0xcbb191['close']();else return _0xdff77e[_0x1a9d08(0x3c3)](_0x967ac5[_0x1a9d08(0x39b)]),_0x3eebeb['flash'](_0x425ef5[_0x1a9d08(0x312)],{'class':_0x425ef5[_0x1a9d08(0x23f)],'text':''+_0x2fa5c6[_0x1a9d08(0x39b)]}),_0x3d5769[_0x1a9d08(0x314)](_0x54cc63);}}};_0x21488e['push']({'req':_0xd911e2,'res':_0x2b392b}),_0x11e5de||_0x40c221[_0x2b7b9f(0x2f1)](_0x12476d);}),x[_0x69ed0(0x21d)](X,_0x574fd2[_0x69ed0(0x36e)],async(_0x3d60f7,_0x5ec4d0)=>{const _0x4741e6=_0x69ed0,_0x199398={'tgtXs':_0x4741e6(0x1ec),'TNfQD':function(_0x2680a2,_0x289701){return _0x2680a2!==_0x289701;},'ZCRyp':_0x4741e6(0x3e2),'uHtHt':function(_0x224a26,_0x37b9cd){return _0x224a26>_0x37b9cd;},'tYeDS':function(_0x5cfecd,_0x217f91){return _0x5cfecd+_0x217f91;},'yxqMw':_0x4741e6(0x29e),'OIAzl':'qwerty','jFVAZ':_0x4741e6(0x396),'fxdqs':_0x4741e6(0x3b7),'fVdGB':function(_0x5d1b5e,_0x4b6c84){return _0x5d1b5e===_0x4b6c84;},'aZVMZ':_0x4741e6(0x2a0),'Siyuj':_0x4741e6(0x2fe),'cwcbu':_0x4741e6(0x2b3),'vtHtf':function(_0x220e56,_0x2d0039){return _0x220e56!==_0x2d0039;},'XqIjB':'reMPN','VDVvR':_0x4741e6(0x392)},_0x4d5811=new _0x54f188(dbUrl),_0x362bd3=''+b;try{if(_0x199398['TNfQD'](_0x199398[_0x4741e6(0x27b)],_0x199398[_0x4741e6(0x27b)])){const _0xd43195=_0x28f150?function(){const _0x151c9f=_0x4741e6;if(_0x34fef5){const _0x4df1a9=_0x2071a0[_0x151c9f(0x320)](_0x58881d,arguments);return _0x20f942=null,_0x4df1a9;}}:function(){};return _0x2bbc51=![],_0xd43195;}else{await _0x4d5811[_0x4741e6(0x39c)]();const _0x485eeb=_0x4d5811['db'](dbName)[_0x4741e6(0x1d8)](dbColl_users);var _0x3c40b8=await _0x485eeb['find']({})['sort']({'userId':-0x1})[_0x4741e6(0x2e0)](0x1)[_0x4741e6(0x213)](),_0x28339b=0x0;if(_0x199398[_0x4741e6(0x3b6)](_0x3c40b8['length'],0x0))_0x28339b=_0x199398[_0x4741e6(0x1df)](_0x3c40b8[0x0][_0x4741e6(0x3a9)],0x1);else return _0x5ec4d0[_0x4741e6(0x286)]({'isCreate':!0x1,'msg':_0x199398[_0x4741e6(0x267)],'redirectUrl':_0x362bd3});const _0x3709eb=process['env']['START_PASSWORD']||_0x199398[_0x4741e6(0x3b3)],_0x5613c1={'userId':_0x28339b,'userEmail':_0x4741e6(0x259)+_0x28339b+_0x4741e6(0x265),'username':_0x4741e6(0x259)+_0x28339b,'userPrefix':'','userFirstname':_0x4741e6(0x259)+_0x28339b,'userLastname':'','userAuthority':'U','userIsActive':_0x199398[_0x4741e6(0x2cd)],'userPassword':await _0x25abdf[_0x4741e6(0x1dd)](_0x3709eb,global['BCRYPT_NUMBER']),'branchId':0x64,'dateTimeCanDelete':O[_0x4741e6(0x2a5)](oe)},_0x344f17=await _0x485eeb[_0x4741e6(0x1e3)](_0x5613c1);return _0x344f17['acknowledged']&&_0x344f17[_0x4741e6(0x242)]?_0x5ec4d0[_0x4741e6(0x286)]({'isCreate':!0x0,'msg':_0x4741e6(0x404)+_0x5613c1[_0x4741e6(0x405)]+_0x4741e6(0x328)+_0x3709eb+_0x4741e6(0x3e7),'redirectUrl':b+_0x4741e6(0x3cf)+_0x344f17[_0x4741e6(0x242)]['toString']()}):_0x5ec4d0[_0x4741e6(0x286)]({'isCreate':!0x1,'msg':_0x199398['fxdqs'],'redirectUrl':_0x362bd3});}}catch(_0x1c9c81){if(_0x199398[_0x4741e6(0x261)](_0x199398[_0x4741e6(0x27d)],_0x199398[_0x4741e6(0x37a)]))return _0x2a8e82[_0x4741e6(0x286)]({'isDownload':!0x1,'color':_0x199398['tgtXs'],'msg':_0x1dd843[_0x4741e6(0x39b)]});else console[_0x4741e6(0x3c3)](_0x199398[_0x4741e6(0x2c9)],_0x1c9c81),_0x5ec4d0['status'](0x194)[_0x4741e6(0x3ef)](_0x362bd3);}finally{if(_0x199398['vtHtf'](_0x199398[_0x4741e6(0x222)],_0x199398[_0x4741e6(0x245)]))_0x4d5811['close']();else{const _0x105fed=_0x914bb7?function(){const _0x5258f8=_0x4741e6;if(_0x8ea6f2){const _0x5adf56=_0x13665a[_0x5258f8(0x320)](_0x3e19a4,arguments);return _0xab7a36=null,_0x5adf56;}}:function(){};return _0x1086b9=![],_0x105fed;}}}),x['post'](G,_0x574fd2[_0x69ed0(0x36e)],async(_0x2a1c53,_0x567a1b)=>{const _0x2a782a=_0x69ed0,_0xe9b30c={'cwKrA':function(_0x9118ba,_0xbef47f){return _0x9118ba!==_0xbef47f;},'fDdQF':function(_0x3bea1a,_0x4fb90b){return _0x3bea1a==_0x4fb90b;},'hfPVF':function(_0x509486,_0x569e5f){return _0x509486(_0x569e5f);},'TcwRN':function(_0x55eb22,_0x20d541){return _0x55eb22(_0x20d541);},'yaJsF':function(_0x4db08b,_0x5a1cab){return _0x4db08b!=_0x5a1cab;},'aFtly':function(_0x4a2e87,_0x2a8b85){return _0x4a2e87===_0x2a8b85;},'CERhF':_0x2a782a(0x35a),'cARSB':_0x2a782a(0x41c),'bdGiS':_0x2a782a(0x3a9),'tJVNl':function(_0x2fb5ba,_0x349970){return _0x2fb5ba===_0x349970;},'LNCqM':'nMCWp','eraYA':'msg','tdpnt':_0x2a782a(0x1ec),'FUGpW':'McqHm','TJvHe':_0x2a782a(0x382),'DSgCj':function(_0x6c27f7,_0x562a60){return _0x6c27f7>_0x562a60;},'TxkqP':_0x2a782a(0x2ad),'Aceyi':_0x2a782a(0x356),'TMagZ':function(_0x2cdacf,_0x844c05){return _0x2cdacf===_0x844c05;},'DUpPU':_0x2a782a(0x207),'JcpHF':_0x2a782a(0x2b3),'JumFz':function(_0x10cd2e,_0x2b3d40){return _0x10cd2e!==_0x2b3d40;},'TlENw':'rVDWj','DfIaP':_0x2a782a(0x237)};let {_id_toDelete:_0x29c5e2,load_id:_0x2d43ca,sip:_0x46eec3,Id_toDelete:_0x33027f}=_0x2a1c53[_0x2a782a(0x1db)];const _0x297c5c=_0xe9b30c['hfPVF'](Number,_0x2a1c53['body']['rpp'])||0x14,_0x344c9e=_0xe9b30c['TcwRN'](Number,_0x2a1c53[_0x2a782a(0x1db)][_0x2a782a(0x1f8)])||0x1;_0x33027f=_0xe9b30c[_0x2a782a(0x3db)](Number,_0x33027f);const _0x23ac69=_0x29c5e2&&_0xe9b30c[_0x2a782a(0x398)](_0x29c5e2,_0x2d43ca)?_0x2a782a(0x425)+_0x29c5e2:'',_0x23dc8d=b+_0x2a782a(0x2c8)+_0x46eec3+_0x2a782a(0x221)+_0x297c5c+_0x2a782a(0x330)+_0x344c9e+_0x23ac69,_0x4ab371=new _0x54f188(global[_0x2a782a(0x2f2)]);try{if(_0xe9b30c['aFtly'](_0xe9b30c[_0x2a782a(0x3f5)],_0xe9b30c[_0x2a782a(0x36f)])){const _0x464874=_0xe9b30c['cwKrA'](_0x210c0a['userAuthority'],'S')||_0xe9b30c[_0x2a782a(0x3f0)](_0x158ea5[_0x2a782a(0x3a9)],_0x1362d4);return _0xe9b30c['cwKrA'](_0x58a57b[_0x2a782a(0x2ae)],'O')&&_0x464874;}else{await _0x4ab371[_0x2a782a(0x39c)]();const _0x148a81=_0x4ab371['db'](global[_0x2a782a(0x2d0)]),_0x551b41=_0x148a81[_0x2a782a(0x1d8)](global[_0x2a782a(0x424)]),_0x37e059=[{'coll':_0x148a81['collection'](global[_0x2a782a(0x27e)]),'name':global[_0x2a782a(0x27e)],'key':_0xe9b30c[_0x2a782a(0x3f2)]},{'coll':_0x148a81[_0x2a782a(0x1d8)](global[_0x2a782a(0x255)]),'name':global['dbColl_warehouseOut'],'key':_0xe9b30c[_0x2a782a(0x3f2)]},{'coll':_0x148a81[_0x2a782a(0x1d8)](global[_0x2a782a(0x316)]),'name':global[_0x2a782a(0x316)],'key':_0xe9b30c[_0x2a782a(0x3f2)]},{'coll':_0x148a81[_0x2a782a(0x1d8)](global[_0x2a782a(0x35c)]),'name':global[_0x2a782a(0x35c)],'key':_0xe9b30c[_0x2a782a(0x3f2)]}];for(const {coll:_0x2e3d6f,name:_0x2af5cf,key:_0x1f15a7}of _0x37e059){if(_0xe9b30c[_0x2a782a(0x2b7)](_0xe9b30c['LNCqM'],_0xe9b30c[_0x2a782a(0x25c)])){const _0x342d9c={};if(_0x342d9c[_0x1f15a7]=_0x33027f,await _0x2e3d6f[_0x2a782a(0x238)](_0x342d9c))return await _0x551b41[_0x2a782a(0x341)]({'userId':_0x33027f},{'$set':{'canDelete':!0x1}}),_0x2a1c53[_0x2a782a(0x2ce)](_0xe9b30c[_0x2a782a(0x3c0)],{'class':_0xe9b30c[_0x2a782a(0x1ed)],'text':_0x2a782a(0x40d)+_0x33027f+_0x2a782a(0x2ee)+_0x2af5cf+_0x2a782a(0x217)}),_0x567a1b[_0x2a782a(0x314)](_0x23dc8d);}else _0x328a04[_0x2a782a(0x254)]();}if(_0xe9b30c[_0x2a782a(0x2b7)]((await _0x551b41[_0x2a782a(0x334)]({'_id':new _0x15f213(_0x29c5e2)}))[_0x2a782a(0x3f6)],0x1)){if(_0xe9b30c[_0x2a782a(0x1e6)](_0xe9b30c['FUGpW'],_0xe9b30c[_0x2a782a(0x3ab)])){const _0x18fc56=await _0x148a81[_0x2a782a(0x1d8)](global[_0x2a782a(0x2e3)])[_0x2a782a(0x2a9)]({'session.user_id':_0x29c5e2});if(_0x18fc56[_0x2a782a(0x23e)]&&_0xe9b30c[_0x2a782a(0x370)](_0x18fc56['deletedCount'],0x0))var _0x35e088=_0x2a782a(0x423)+_0x18fc56[_0x2a782a(0x3f6)]+_0x2a782a(0x2ed);else var _0x35e088=_0xe9b30c[_0x2a782a(0x282)];_0x2a1c53['flash'](_0xe9b30c['eraYA'],{'class':_0xe9b30c[_0x2a782a(0x1f0)],'text':'ลบยูสเซอร์\x20\x22'+_0x33027f+'\x22\x20เรียบร้อยแล้ว'+_0x35e088});}else return!![];}else _0x2a1c53[_0x2a782a(0x2ce)](_0xe9b30c[_0x2a782a(0x3c0)],{'class':_0xe9b30c['tdpnt'],'text':_0x2a782a(0x285)+_0x33027f+_0x2a782a(0x1ef)});return _0x567a1b[_0x2a782a(0x314)](_0x23dc8d);}}catch(_0x4f47f5){return _0xe9b30c[_0x2a782a(0x244)](_0xe9b30c[_0x2a782a(0x343)],_0xe9b30c['DUpPU'])?(console[_0x2a782a(0x3c3)](_0xe9b30c[_0x2a782a(0x3a4)],_0x4f47f5),_0x2a1c53[_0x2a782a(0x2ce)](_0xe9b30c['eraYA'],{'class':_0xe9b30c[_0x2a782a(0x1ed)],'text':_0x4f47f5[_0x2a782a(0x39b)]}),_0x567a1b[_0x2a782a(0x314)](_0x23dc8d)):![];}finally{_0xe9b30c[_0x2a782a(0x1ea)](_0xe9b30c[_0x2a782a(0x236)],_0xe9b30c[_0x2a782a(0x26d)])?_0x4ab371[_0x2a782a(0x254)]():_0x14002c[_0x2a782a(0x284)](_0x44736f[_0x2a782a(0x3f7)])?_0x270875['add'](_0x3b2cd8[_0x2a782a(0x3f7)]):_0x30f211[_0x2a782a(0x3aa)](_0x49259a['userEmail']);}}),x[_0x69ed0(0x21d)](V,_0x574fd2['isOS'],async(_0x495569,_0x38d708)=>{const _0x321495=_0x69ed0,_0x556c55={'rZDeE':function(_0x2f0255,_0x152bdf){return _0x2f0255===_0x152bdf;},'LGUZW':_0x321495(0x2b0),'EnYDo':'mofIl','OJnKQ':_0x321495(0x2bc),'OMnsz':_0x321495(0x2f7),'ysWRg':_0x321495(0x324),'mvpnp':function(_0x3016e0,_0x5baba3){return _0x3016e0==_0x5baba3;},'WzSpq':'red','lSDuF':'ไม่มีข้อมูล','tywit':'print_users.ejs','jqFXs':'utf8','siFOu':_0x321495(0x356),'ppkDF':function(_0xd5e9ae,_0x1d918a){return _0xd5e9ae===_0x1d918a;},'ODewX':_0x321495(0x37e),'RGGPi':_0x321495(0x2b3),'FysTB':_0x321495(0x3a5),'lTsGy':_0x321495(0x393)},{_idArr:_0x531a06}=_0x495569['body'],_0x2566af=new _0x54f188(dbUrl);try{if(_0x556c55[_0x321495(0x3ac)](_0x556c55[_0x321495(0x3df)],_0x556c55[_0x321495(0x270)]))_0x148e03['close']();else{await _0x2566af[_0x321495(0x39c)]();const _0x53f6b3=await _0x2566af['db'](dbName)[_0x321495(0x1d8)](dbColl_users)[_0x321495(0x2d9)]([{'$match':{'_id':{'$in':_0x531a06[_0x321495(0x3a2)](_0x1128b2=>new _0x15f213(_0x1128b2))}}},{'$lookup':{'from':global[_0x321495(0x2a2)],'localField':_0x556c55[_0x321495(0x218)],'foreignField':_0x556c55[_0x321495(0x218)],'as':_0x556c55[_0x321495(0x3be)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x556c55[_0x321495(0x344)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x321495(0x213)]();if(_0x556c55[_0x321495(0x20a)](_0x53f6b3[_0x321495(0x274)],0x0))return _0x38d708[_0x321495(0x286)](JSON[_0x321495(0x2eb)]({'isPrint':!0x1,'class':_0x556c55[_0x321495(0x379)],'msg':_0x556c55[_0x321495(0x387)]}));const _0x5eee4e=_0x2394c4[_0x321495(0x234)](global[_0x321495(0x249)],_0x556c55['tywit']),_0x23f4e8=_0x58472c[_0x321495(0x3e1)](_0x5eee4e,_0x556c55[_0x321495(0x1e1)]),_0x4fb327=_0x5da378[_0x321495(0x256)](_0x23f4e8,{'time':O[_0x321495(0x2d8)](),'title':'ยูสเซอร์\x20('+_0x53f6b3[_0x321495(0x274)]+')','dateTime':O[_0x321495(0x2a5)](),'usersFind':_0x53f6b3});_0x38d708[_0x321495(0x286)](JSON[_0x321495(0x2eb)]({'isPrint':!0x0,'class':_0x556c55['siFOu'],'msg':'พิมพ์ข้อมูล\x20'+_0x53f6b3[_0x321495(0x274)]+_0x321495(0x323),'htmlPage':_0x4fb327}));}}catch(_0x4bc612){if(_0x556c55[_0x321495(0x28e)](_0x556c55[_0x321495(0x25d)],_0x556c55[_0x321495(0x25d)]))console['log'](_0x556c55[_0x321495(0x332)],_0x4bc612[_0x321495(0x39b)]),_0x38d708[_0x321495(0x286)](JSON[_0x321495(0x2eb)]({'isPrint':!0x1,'class':_0x556c55[_0x321495(0x379)],'msg':_0x4bc612[_0x321495(0x39b)]}));else{_0x4b8aab[_0x321495(0x38f)][_0x321495(0x29a)](_0x64ce28=>(_0x64ce28&&_0x5c9dc0['log'](_0x321495(0x371),_0x64ce28),_0x164770['redirect']('/')));return;}}finally{if(_0x556c55[_0x321495(0x28e)](_0x556c55[_0x321495(0x27f)],_0x556c55[_0x321495(0x1da)]))return _0x496afa;else _0x2566af[_0x321495(0x254)]();}}),x['post'](Y,_0x574fd2[_0x69ed0(0x36e)],async(_0xec275b,_0x5de948)=>{const _0x6e8c07=_0x69ed0,_0x17892b={'fHOgQ':_0x6e8c07(0x377),'QQgZh':_0x6e8c07(0x2bf),'ndcRy':function(_0x4cde04,_0x4df1a2){return _0x4cde04(_0x4df1a2);},'bAITw':_0x6e8c07(0x20f),'SnBdM':function(_0x399273,_0x1e8a5c){return _0x399273+_0x1e8a5c;},'qtaAD':_0x6e8c07(0x294),'RWTIM':function(_0x4096f4,_0x8177ed){return _0x4096f4+_0x8177ed;},'AtllG':_0x6e8c07(0x3d1),'csLOJ':function(_0x40418b){return _0x40418b();},'sDBiQ':function(_0x13a111,_0x31a5d5,_0x172d9e){return _0x13a111(_0x31a5d5,_0x172d9e);},'iQcCz':function(_0x3522d4,_0x3ada56){return _0x3522d4!==_0x3ada56;},'IqBgG':function(_0x2be20e,_0x35f95e){return _0x2be20e==_0x35f95e;},'uwwzt':'haJAN','wLcJp':_0x6e8c07(0x215),'Fnhqr':'red','mRCUf':function(_0x32c20a,_0x93a9d8){return _0x32c20a<_0x93a9d8;},'VGtIH':_0x6e8c07(0x31d),'qrlVv':_0x6e8c07(0x2e8),'zZZEX':'doc_changes.ejs','nYOEJ':_0x6e8c07(0x356),'HMxIZ':function(_0x1331d8,_0x28c82f){return _0x1331d8===_0x28c82f;},'LYFqi':_0x6e8c07(0x305),'owQNG':_0x6e8c07(0x31b),'JKagm':_0x6e8c07(0x2b3),'UzfYC':'EGmpi'};let {userId:_0x470d7e}=_0xec275b[_0x6e8c07(0x1db)];_0x470d7e=_0x17892b[_0x6e8c07(0x390)](Number,_0x470d7e);const _0x53ed54=new _0x54f188(global[_0x6e8c07(0x2f2)]);try{if(_0x17892b['iQcCz'](_0x17892b[_0x6e8c07(0x24c)],_0x17892b[_0x6e8c07(0x3cd)])){await _0x53ed54[_0x6e8c07(0x39c)]();var _0x165cdc=await _0x53ed54['db'](global['dbName'])[_0x6e8c07(0x1d8)](global[_0x6e8c07(0x424)])[_0x6e8c07(0x238)]({'userId':_0x470d7e});if(!_0x165cdc)return _0x5de948[_0x6e8c07(0x286)](JSON[_0x6e8c07(0x2eb)]({'isPrint':!0x1,'class':_0x17892b[_0x6e8c07(0x30a)],'msg':'ไม่พบ\x20\x22'+_0x470d7e+'\x22'}));const _0x1c1c53=_0x165cdc[_0x6e8c07(0x280)]||[];if(_0x17892b[_0x6e8c07(0x426)](_0x1c1c53[_0x6e8c07(0x274)],0x1))return _0x5de948['send'](JSON[_0x6e8c07(0x2eb)]({'isPrint':!0x1,'class':_0x17892b[_0x6e8c07(0x3ad)],'msg':_0x17892b[_0x6e8c07(0x3ca)]}));const _0x3d6e05=_0x2394c4['join'](folderForms,_0x17892b[_0x6e8c07(0x39e)]),_0x555954=await H[_0x6e8c07(0x365)](_0x3d6e05,_0x5de948,{'title':'ประวัติการแก้ไขยูสเซอร์\x20:\x20['+_0x165cdc[_0x6e8c07(0x3a9)]+']\x20'+_0x165cdc[_0x6e8c07(0x2ba)]+'\x20'+_0x165cdc[_0x6e8c07(0x3ff)]+'\x20'+_0x165cdc[_0x6e8c07(0x2f9)],'time':O[_0x6e8c07(0x2a5)](),'changesHistory':_0x1c1c53});_0x5de948[_0x6e8c07(0x286)](JSON[_0x6e8c07(0x2eb)]({'isPrint':!0x0,'class':_0x17892b[_0x6e8c07(0x38b)],'htmlPage':_0x555954}));}else ZrdZCn['sDBiQ'](_0x4dc91b,this,function(){const _0x346a00=_0x6e8c07,_0x12f7bd=new _0x531044(ZrdZCn['fHOgQ']),_0x52b96c=new _0x2c8ba0(ZrdZCn[_0x346a00(0x2b2)],'i'),_0xeb4f0e=ZrdZCn[_0x346a00(0x390)](_0x76461c,ZrdZCn[_0x346a00(0x1d9)]);!_0x12f7bd[_0x346a00(0x359)](ZrdZCn['SnBdM'](_0xeb4f0e,ZrdZCn[_0x346a00(0x366)]))||!_0x52b96c[_0x346a00(0x359)](ZrdZCn['RWTIM'](_0xeb4f0e,ZrdZCn[_0x346a00(0x1fa)]))?ZrdZCn['ndcRy'](_0xeb4f0e,'0'):ZrdZCn[_0x346a00(0x413)](_0x954066);})();}catch(_0x12e1a2){_0x17892b[_0x6e8c07(0x3c5)](_0x17892b[_0x6e8c07(0x3a6)],_0x17892b['owQNG'])?_0x5aaf46=_0x1be2dc:(console[_0x6e8c07(0x3c3)](_0x17892b['JKagm'],_0x12e1a2),_0x5de948['send'](JSON[_0x6e8c07(0x2eb)]({'isPrint':!0x1,'class':_0x17892b[_0x6e8c07(0x30a)],'msg':_0x12e1a2[_0x6e8c07(0x39b)]})));}finally{if(_0x17892b[_0x6e8c07(0x3b1)](_0x17892b['UzfYC'],_0x17892b[_0x6e8c07(0x38d)])){const _0x441b3c={'YBHOu':function(_0x25de48,_0x447a59){return _0x17892b['iQcCz'](_0x25de48,_0x447a59);},'FyLhT':function(_0x4f15dd,_0x7ad02){const _0x37d2f4=_0x6e8c07;return _0x17892b[_0x37d2f4(0x388)](_0x4f15dd,_0x7ad02);}},_0x36d273=_0x419765[_0x6e8c07(0x3a9)];_0x1b32b8=_0x16d444[_0x6e8c07(0x23b)](_0x20687e=>{const _0x1a98fa=_0x6e8c07,_0x5b95f2=_0x441b3c[_0x1a98fa(0x1e5)](_0x20687e[_0x1a98fa(0x2ae)],'S')||_0x441b3c['FyLhT'](_0x20687e[_0x1a98fa(0x3a9)],_0x36d273);return _0x441b3c[_0x1a98fa(0x1e5)](_0x20687e[_0x1a98fa(0x2ae)],'O')&&_0x5b95f2;});}else _0x53ed54[_0x6e8c07(0x254)]();}}),x[_0x69ed0(0x21d)](K,_0x574fd2['isOS'],async(_0x1016ed,_0x2e470c)=>{const _0x3870af=_0x69ed0,_0x1a8625={'GqdGL':function(_0x5f04ae,_0x47d88f){return _0x5f04ae!==_0x47d88f;},'nwsMS':_0x3870af(0x248),'MDIcM':_0x3870af(0x29c),'jMzFQ':function(_0x1382bf,_0xa8fa89){return _0x1382bf==_0xa8fa89;},'GTYHH':'red','WGeda':_0x3870af(0x2de),'MlQwT':_0x3870af(0x35e),'aoLFD':_0x3870af(0x301),'vgytC':_0x3870af(0x3c8),'RcoCc':_0x3870af(0x356),'iIocw':_0x3870af(0x257),'JfDch':_0x3870af(0x36d)},_0x50a20e=new _0x54f188(dbUrl);try{if(_0x1a8625[_0x3870af(0x354)](_0x1a8625[_0x3870af(0x412)],_0x1a8625['nwsMS'])){if(_0x8b6208){const _0x2be97b=_0x466a71[_0x3870af(0x320)](_0x4108be,arguments);return _0x3cc722=null,_0x2be97b;}}else{await _0x50a20e[_0x3870af(0x39c)]();const _0x45cdab=await _0x50a20e['db'](dbName)[_0x3870af(0x1d8)](dbColl_users)[_0x3870af(0x2d9)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x1a8625[_0x3870af(0x319)],[]]}}}},{'$sort':{'userId':0x1}}])[_0x3870af(0x213)]();if(_0x1a8625[_0x3870af(0x231)](_0x45cdab[_0x3870af(0x274)],0x0))return _0x2e470c[_0x3870af(0x286)](JSON[_0x3870af(0x2eb)]({'isDownload':!0x1,'class':_0x1a8625[_0x3870af(0x2aa)],'msg':_0x1a8625['WGeda']}));const _0x5bc0e0='users_'+O[_0x3870af(0x2a5)]()['replace'](/[: ]/g,'-')+'.xlsx',_0x343918=_0x20e4f1[_0x3870af(0x3d2)][_0x3870af(0x24b)](_0x45cdab),_0x54ea57=_0x20e4f1[_0x3870af(0x3d2)][_0x3870af(0x278)]();_0x20e4f1[_0x3870af(0x3d2)][_0x3870af(0x1fb)](_0x54ea57,_0x343918,_0x1a8625['MlQwT']);const _0x55fc3b=_0x20e4f1[_0x3870af(0x299)](_0x54ea57,{'type':_0x1a8625[_0x3870af(0x232)],'bookType':_0x1a8625[_0x3870af(0x416)]});_0x2e470c[_0x3870af(0x286)]({'isDownload':!0x0,'color':_0x1a8625[_0x3870af(0x331)],'msg':_0x1a8625['iIocw'],'filename':_0x5bc0e0,'fileData':_0x55fc3b[_0x3870af(0x364)](_0x1a8625[_0x3870af(0x2a7)])});}}catch(_0x4d1b22){return _0x2e470c[_0x3870af(0x286)]({'isDownload':!0x1,'color':_0x1a8625[_0x3870af(0x2aa)],'msg':_0x4d1b22[_0x3870af(0x39b)]});}finally{_0x50a20e[_0x3870af(0x254)]();}});const ae=_0x3a3579({'storage':_0x3a3579['memoryStorage']()});x[_0x69ed0(0x21d)](Z,_0x574fd2[_0x69ed0(0x36e)],ae[_0x69ed0(0x2c6)](_0x69ed0(0x3c2)),async(_0x4cdf31,_0x3e32b2)=>{const _0x59607f=_0x69ed0,_0x2d88a3={'GGfft':function(_0x414b54,_0x39db15){return _0x414b54(_0x39db15);},'XiBPL':_0x59607f(0x1ec),'BCEYr':'กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','pKeoo':'buffer','pdVoX':_0x59607f(0x35e),'EjglS':function(_0xd9a8dd,_0x507b2a){return _0xd9a8dd>_0x507b2a;},'uuzFt':_0x59607f(0x3a9),'GiBXB':_0x59607f(0x405),'YoReL':'branchId','UzmAQ':_0x59607f(0x2e7),'oZXCh':_0x59607f(0x2ae),'YuKMO':_0x59607f(0x3f7),'turIx':_0x59607f(0x3c9),'pALCZ':_0x59607f(0x2ba),'Iingq':_0x59607f(0x3ff),'lGwFg':'userLastname','NkICP':_0x59607f(0x2c1),'MAVqh':function(_0x5b46bd,_0xa23cbb){return _0x5b46bd>_0xa23cbb;},'tDeqW':_0x59607f(0x396),'TnkPu':function(_0xd38ea4,_0x5e0ca5){return _0xd38ea4+_0x5e0ca5;},'ktDCs':function(_0x586cd7,_0x5ac4da){return _0x586cd7===_0x5ac4da;},'GMfsr':function(_0x251d51,_0x1acb31){return _0x251d51===_0x1acb31;},'PyywL':function(_0x4f2342,_0x260427){return _0x4f2342===_0x260427;},'bqCRH':function(_0xfc96bc,_0x12d646){return _0xfc96bc>_0x12d646;},'GCHmJ':'ไม่มีข้อมูลที่อัปเดท','GoMFj':'green','hBTXc':'error\x20===>\x20'},_0x4225f2=new _0x54f188(dbUrl);try{if(!_0x4cdf31[_0x59607f(0x32a)])return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x2d88a3[_0x59607f(0x3e6)]});const _0x3bf6f7=_0x20e4f1[_0x59607f(0x3ae)](_0x4cdf31[_0x59607f(0x32a)]['buffer'],{'type':_0x2d88a3['pKeoo']}),_0x47a0c9=[_0x2d88a3[_0x59607f(0x342)]],_0x53e575=_0x3bf6f7['SheetNames'],_0x411745=_0x47a0c9[_0x59607f(0x23b)](_0x2787e3=>!_0x53e575[_0x59607f(0x2b1)](_0x2787e3));if(_0x2d88a3[_0x59607f(0x1e2)](_0x411745[_0x59607f(0x274)],0x0))return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x1,'color':_0x2d88a3['XiBPL'],'msg':_0x59607f(0x262)+_0x411745['join'](',\x20')+'\x22'});const _0x282e4c=_0x3bf6f7[_0x59607f(0x1eb)][_0x59607f(0x35e)],_0x52c484=_0x20e4f1[_0x59607f(0x3d2)][_0x59607f(0x32d)](_0x282e4c),_0x4446c6=[_0x2d88a3[_0x59607f(0x3a7)],_0x2d88a3[_0x59607f(0x351)],_0x2d88a3[_0x59607f(0x200)],_0x2d88a3['UzmAQ'],_0x2d88a3['oZXCh'],_0x2d88a3['YuKMO'],_0x2d88a3[_0x59607f(0x22e)],_0x2d88a3[_0x59607f(0x36b)],_0x2d88a3[_0x59607f(0x37b)],_0x2d88a3[_0x59607f(0x41f)],_0x2d88a3[_0x59607f(0x226)]][_0x59607f(0x23b)](_0x8dd637=>!_0x52c484[_0x59607f(0x295)](_0x34db38=>Object[_0x59607f(0x2c3)][_0x59607f(0x2da)][_0x59607f(0x336)](_0x34db38,_0x8dd637)));if(_0x2d88a3[_0x59607f(0x1e2)](_0x4446c6[_0x59607f(0x274)],0x0))return _0x3e32b2['send']({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x59607f(0x229)+_0x4446c6[_0x59607f(0x234)](',\x20')+'\x22'});const _0x426366=new Set(),_0xb7f99=new Set();if(_0x52c484['forEach'](_0x2961a7=>{const _0x29af09=_0x59607f;_0x426366['has'](_0x2961a7[_0x29af09(0x3a9)])?_0xb7f99[_0x29af09(0x3aa)](_0x2961a7['userId']):_0x426366[_0x29af09(0x3aa)](_0x2961a7[_0x29af09(0x3a9)]);}),_0x2d88a3[_0x59607f(0x41a)](_0xb7f99[_0x59607f(0x3d3)],0x0))return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x59607f(0x3dd)+Array['from'](_0xb7f99)[_0x59607f(0x234)](',\x20')+'\x22'});const _0x102b16=new Set(),_0x2c34db=new Set();if(_0x52c484[_0x59607f(0x28a)](_0x4df13d=>{const _0x20d49a=_0x59607f;_0x102b16[_0x20d49a(0x284)](_0x4df13d[_0x20d49a(0x405)])?_0x2c34db[_0x20d49a(0x3aa)](_0x4df13d[_0x20d49a(0x405)]):_0x102b16[_0x20d49a(0x3aa)](_0x4df13d[_0x20d49a(0x405)]);}),_0x2d88a3['MAVqh'](_0x2c34db[_0x59607f(0x3d3)],0x0))return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x59607f(0x38e)+Array['from'](_0x2c34db)['join'](',\x20')+'\x22'});const _0x12755f=new Set(),_0x252e3c=new Set();if(_0x52c484[_0x59607f(0x28a)](_0x13884c=>{const _0x512549=_0x59607f;_0x12755f[_0x512549(0x284)](_0x13884c['userEmail'])?_0x252e3c[_0x512549(0x3aa)](_0x13884c[_0x512549(0x3f7)]):_0x12755f[_0x512549(0x3aa)](_0x13884c[_0x512549(0x3f7)]);}),_0x2d88a3[_0x59607f(0x1e2)](_0x252e3c[_0x59607f(0x3d3)],0x0))return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x59607f(0x2b4)+Array['from'](_0x252e3c)[_0x59607f(0x234)](',\x20')+'\x22'});const _0x4b8ae1=[],_0xe3dfef=/^\d{3,4}$/,_0x415940=new RegExp(global[_0x59607f(0x28d)]),_0x4e2496=/^\d{3}$/,_0x1423e4=[_0x2d88a3[_0x59607f(0x2fd)],''];for(const [_0xfb76d1,_0x7a2f34]of _0x52c484[_0x59607f(0x374)]()){const _0x5453dd=_0x2d88a3[_0x59607f(0x39f)](_0xfb76d1,0x2),_0x2fd6d0={'userId':_0x7a2f34[_0x59607f(0x3a9)],'row':_0x5453dd};if(!_0x7a2f34[_0x59607f(0x3a9)]||_0x2d88a3[_0x59607f(0x41b)](_0xe3dfef[_0x59607f(0x359)](_0x7a2f34['userId'][_0x59607f(0x364)]()),!0x1)){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x405)]||_0x2d88a3[_0x59607f(0x41b)](_0x415940[_0x59607f(0x359)](_0x7a2f34['username']),!0x1)){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x2bc)]||_0x2d88a3[_0x59607f(0x41b)](_0x4e2496[_0x59607f(0x359)](_0x7a2f34[_0x59607f(0x2bc)][_0x59607f(0x364)]()),!0x1)){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x2e7)]||_0x2d88a3[_0x59607f(0x369)](_0x1423e4['includes'](_0x7a2f34[_0x59607f(0x2e7)]),!0x1)){_0x4b8ae1['push'](_0x2fd6d0);continue;}if(!_0x7a2f34['userAuthority']||_0x2d88a3[_0x59607f(0x41b)](global[_0x59607f(0x3b9)][_0x59607f(0x2b1)](_0x7a2f34['userAuthority']),!0x1)){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x3f7)]||_0x2d88a3[_0x59607f(0x2d5)](_0x3af429['isEmail'](_0x7a2f34['userEmail']),!0x1)){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x3ff)]||_0x2d88a3['PyywL'](_0x7a2f34[_0x59607f(0x3ff)][_0x59607f(0x414)](),'')){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}if(!_0x7a2f34[_0x59607f(0x2c1)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x59607f(0x359)](_0x7a2f34['dateTimeCanDelete'])){_0x4b8ae1[_0x59607f(0x37f)](_0x2fd6d0);continue;}}if(_0x2d88a3[_0x59607f(0x303)](_0x4b8ae1['length'],0x0)){const _0x58f571=Array[_0x59607f(0x347)](new Set(_0x4b8ae1[_0x59607f(0x3a2)](_0x36e34a=>JSON[_0x59607f(0x2eb)](_0x36e34a))))[_0x59607f(0x3a2)](_0x16d1a1=>JSON['parse'](_0x16d1a1));return _0x3e32b2['send']({'isUpload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':'มีข้อมูลผิดพลาดที่แถว\x20'+_0x58f571['map'](_0x1b361b=>_0x1b361b[_0x59607f(0x2df)])['join'](',\x20'),'errorRows':_0x58f571});}_0x52c484[_0x59607f(0x28a)](_0x1cd282=>{const _0x18c134=_0x59607f;_0x1cd282[_0x18c134(0x3a9)]=_0x2d88a3['GGfft'](Number,_0x1cd282[_0x18c134(0x3a9)]),_0x1cd282[_0x18c134(0x2bc)]=_0x2d88a3[_0x18c134(0x2a1)](Number,_0x1cd282[_0x18c134(0x2bc)]),_0x1cd282[_0x18c134(0x2e7)]||(_0x1cd282[_0x18c134(0x2e7)]=''),_0x1cd282['userPhone']||(_0x1cd282[_0x18c134(0x3c9)]=''),_0x1cd282['userPrefix']||(_0x1cd282['userPrefix']=''),_0x1cd282[_0x18c134(0x2f9)]||(_0x1cd282[_0x18c134(0x2f9)]=''),delete _0x1cd282[_0x18c134(0x253)],delete _0x1cd282[_0x18c134(0x311)],delete _0x1cd282[_0x18c134(0x378)],delete _0x1cd282['userLastLogin'];}),await _0x4225f2[_0x59607f(0x39c)]();const _0x44e43f=_0x4225f2['db'](dbName)[_0x59607f(0x1d8)](dbColl_users),_0x186b70=[];for(const _0x440b28 of _0x52c484){const _0x490cb2=await _0x44e43f[_0x59607f(0x341)]({'userId':_0x440b28[_0x59607f(0x3a9)]},{'$set':_0x440b28},{'upsert':!0x0});_0x186b70[_0x59607f(0x37f)]({'userId':_0x440b28[_0x59607f(0x3a9)],'matchedCount':_0x490cb2[_0x59607f(0x373)],'upsertedCount':_0x490cb2[_0x59607f(0x3cc)]});}const _0x4ef142=_0x2d88a3[_0x59607f(0x1e2)](_0x186b70[_0x59607f(0x274)],0x0)?_0x2d88a3['TnkPu'](_0x59607f(0x1e8)+_0x186b70[_0x59607f(0x23b)](_0x322b85=>_0x322b85[_0x59607f(0x373)]>0x0)[_0x59607f(0x274)]+_0x59607f(0x293),('{{sep}}เพิ่มใหม่\x20'+_0x186b70[_0x59607f(0x23b)](_0x5cf5ee=>_0x5cf5ee[_0x59607f(0x3cc)]>0x0)['length']+_0x59607f(0x293))[_0x59607f(0x414)]()):_0x2d88a3['GCHmJ'];return _0x3e32b2[_0x59607f(0x286)]({'isUpload':!0x0,'color':_0x2d88a3[_0x59607f(0x1f9)],'msg':_0x4ef142});}catch(_0x2c03a1){return console[_0x59607f(0x3c3)](_0x2d88a3[_0x59607f(0x406)],_0x2c03a1),_0x3e32b2[_0x59607f(0x286)]({'isDownload':!0x1,'color':_0x2d88a3[_0x59607f(0x272)],'msg':_0x2c03a1[_0x59607f(0x39b)]});}finally{_0x4225f2['close']();}});export default x;function _0x284ce1(_0x1a0dcc){const _0x582bcf=_0x69ed0,_0x499848={'hTuXl':function(_0x26e323,_0xc54321){return _0x26e323===_0xc54321;},'fOSPn':_0x582bcf(0x2f8),'OJQjj':'while\x20(true)\x20{}','qPVYU':_0x582bcf(0x349),'aVYRe':function(_0x38190e,_0x4fb0b9){return _0x38190e!==_0x4fb0b9;},'ZNfSb':function(_0xe2ca05,_0x471618){return _0xe2ca05+_0x471618;},'EOOSg':function(_0x1523d8,_0x5e2dde){return _0x1523d8/_0x5e2dde;},'MpOhL':_0x582bcf(0x274),'tIaVg':function(_0x51d404,_0x448989){return _0x51d404===_0x448989;},'oxdzZ':function(_0x38f815,_0x36cf38){return _0x38f815%_0x36cf38;},'FkBKE':_0x582bcf(0x3c1),'gJtvb':_0x582bcf(0x360),'iCDxa':_0x582bcf(0x3f9),'hICzv':function(_0x347942,_0x5c2cb8){return _0x347942+_0x5c2cb8;},'oTtFU':_0x582bcf(0x335),'RHngU':function(_0x197cb3,_0x52f8e3){return _0x197cb3(_0x52f8e3);},'SDRzE':function(_0x2647ca,_0x23d3a1){return _0x2647ca(_0x23d3a1);}};function _0x4f02df(_0x235660){const _0x438838=_0x582bcf;if(_0x499848[_0x438838(0x246)](typeof _0x235660,_0x499848[_0x438838(0x2ef)]))return function(_0x248055){}[_0x438838(0x355)](_0x499848[_0x438838(0x25f)])[_0x438838(0x320)](_0x499848[_0x438838(0x33f)]);else _0x499848[_0x438838(0x322)](_0x499848[_0x438838(0x3d8)]('',_0x499848['EOOSg'](_0x235660,_0x235660))[_0x499848[_0x438838(0x2bd)]],0x1)||_0x499848['tIaVg'](_0x499848['oxdzZ'](_0x235660,0x14),0x0)?function(){return!![];}['constructor'](_0x499848[_0x438838(0x3d8)](_0x499848['FkBKE'],_0x499848[_0x438838(0x21e)]))[_0x438838(0x336)](_0x499848[_0x438838(0x357)]):function(){return![];}[_0x438838(0x355)](_0x499848['hICzv'](_0x499848[_0x438838(0x30f)],_0x499848[_0x438838(0x21e)]))[_0x438838(0x320)](_0x499848['oTtFU']);_0x499848[_0x438838(0x2af)](_0x4f02df,++_0x235660);}try{if(_0x1a0dcc)return _0x4f02df;else _0x499848[_0x582bcf(0x35b)](_0x4f02df,0x0);}catch(_0xe064f0){}}