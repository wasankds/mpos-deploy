const _0x9698ac=_0x509c;(function(_0x1eef3d,_0x145c54){const _0x2d7932=_0x509c,_0x2eb4fc=_0x1eef3d();while(!![]){try{const _0x390132=-parseInt(_0x2d7932(0x2be))/0x1+-parseInt(_0x2d7932(0x3b8))/0x2+-parseInt(_0x2d7932(0x306))/0x3*(-parseInt(_0x2d7932(0x36d))/0x4)+parseInt(_0x2d7932(0x336))/0x5*(parseInt(_0x2d7932(0x1b8))/0x6)+-parseInt(_0x2d7932(0x209))/0x7*(parseInt(_0x2d7932(0x34b))/0x8)+parseInt(_0x2d7932(0x339))/0x9+parseInt(_0x2d7932(0x214))/0xa;if(_0x390132===_0x145c54)break;else _0x2eb4fc['push'](_0x2eb4fc['shift']());}catch(_0x138510){_0x2eb4fc['push'](_0x2eb4fc['shift']());}}}(_0x4520,0x49b8f));const _0x5ae951=(function(){const _0xfee618=_0x509c,_0x2aa00a={'rSKAx':function(_0x1ed880,_0x1f3781){return _0x1ed880(_0x1f3781);},'xWCoQ':function(_0xfd9a2a,_0x4ddc1e){return _0xfd9a2a+_0x4ddc1e;},'Qidhu':'return\x20(function()\x20','MqElZ':'{}.constructor(\x22return\x20this\x22)(\x20)','qHbcq':function(_0x3c7b68){return _0x3c7b68();},'jZcuJ':function(_0x194468,_0xfcf887){return _0x194468===_0xfcf887;},'adDrR':_0xfee618(0x35f),'ZQolJ':_0xfee618(0x35c),'MvoPi':function(_0x41c101,_0x2a42d4){return _0x41c101===_0x2a42d4;},'jzIzn':'ubwlC','JqxlI':_0xfee618(0x37e),'SEWaz':'error\x20===>\x20','vJpeb':function(_0x9fec8c,_0x5109fb){return _0x9fec8c!==_0x5109fb;},'PDbCS':'owXBr'};let _0x116774=!![];return function(_0x3381da,_0x465554){const _0x871b83=_0xfee618,_0x1746b5={'JHFfO':_0x2aa00a[_0x871b83(0x37a)]};if(_0x2aa00a[_0x871b83(0x323)](_0x2aa00a['PDbCS'],_0x2aa00a[_0x871b83(0x2ea)])){const _0x2c5aa1=_0x2aa00a[_0x871b83(0x267)](_0x344738,_0x2aa00a[_0x871b83(0x26e)](_0x2aa00a[_0x871b83(0x26e)](_0x2aa00a[_0x871b83(0x2c7)],_0x2aa00a[_0x871b83(0x382)]),');'));_0x50a36b=_0x2aa00a[_0x871b83(0x24e)](_0x2c5aa1);}else{const _0x33dfe7=_0x116774?function(){const _0x1df76e=_0x871b83;if(_0x2aa00a[_0x1df76e(0x1af)](_0x2aa00a[_0x1df76e(0x203)],_0x2aa00a[_0x1df76e(0x2ed)]))_0x48c56a['log'](_0x1746b5[_0x1df76e(0x311)],_0x263063),_0x26502a['status'](0x194)[_0x1df76e(0x2dd)](_0x123770);else{if(_0x465554){if(_0x2aa00a['MvoPi'](_0x2aa00a[_0x1df76e(0x2a4)],_0x2aa00a['JqxlI'])){const _0x412dac=_0x26151c[_0x1df76e(0x228)]['prototype'][_0x1df76e(0x248)](_0xeeb4e6),_0x19d083=_0x5449f8[_0x6e82b9],_0x4bf62f=_0x27fc36[_0x19d083]||_0x412dac;_0x412dac[_0x1df76e(0x21d)]=_0x379b1f[_0x1df76e(0x248)](_0x3feacc),_0x412dac['toString']=_0x4bf62f['toString'][_0x1df76e(0x248)](_0x4bf62f),_0x35d392[_0x19d083]=_0x412dac;}else{const _0x40abda=_0x465554[_0x1df76e(0x262)](_0x3381da,arguments);return _0x465554=null,_0x40abda;}}}}:function(){};return _0x116774=![],_0x33dfe7;}};}());(function(){const _0x1befca=_0x509c,_0x3ab6cc={'NCNlu':function(_0x57668d,_0x6dd638){return _0x57668d>_0x6dd638;},'zMqoL':'userFlash','pLxpD':'msg','rXMAu':_0x1befca(0x36e),'UcRoQ':_0x1befca(0x295),'cJPKO':function(_0x4050b1,_0x47acd9){return _0x4050b1===_0x47acd9;},'aJVhP':_0x1befca(0x237),'KeAHf':_0x1befca(0x340),'WjoRc':_0x1befca(0x2f8),'tSryH':function(_0x3773e3,_0x44d91c){return _0x3773e3(_0x44d91c);},'clEpd':'init','saGsb':function(_0x3766b1,_0x51512a){return _0x3766b1+_0x51512a;},'anoay':'chain','kgBsc':'input','stqLe':function(_0x2669ef,_0x4d8c5c){return _0x2669ef===_0x4d8c5c;},'elxYd':_0x1befca(0x1cf),'SOECV':_0x1befca(0x34a),'HwIFC':function(_0x383f40,_0x187115){return _0x383f40(_0x187115);},'xpVKx':function(_0x2b9b7c,_0xf32c47){return _0x2b9b7c===_0xf32c47;},'nFWVf':'cKQXz','NUARC':_0x1befca(0x2d7),'cArUx':function(_0x1cc8ce){return _0x1cc8ce();},'muPQE':function(_0x41d5a0,_0x114aee,_0x4f7c07){return _0x41d5a0(_0x114aee,_0x4f7c07);}};_0x3ab6cc[_0x1befca(0x39a)](_0x5ae951,this,function(){const _0x2d8ba3=_0x1befca,_0x50a838={'UnwUN':_0x3ab6cc['UcRoQ']};if(_0x3ab6cc[_0x2d8ba3(0x3d4)](_0x3ab6cc[_0x2d8ba3(0x212)],_0x3ab6cc[_0x2d8ba3(0x212)])){const _0x2fbebf=new RegExp(_0x3ab6cc['KeAHf']),_0x5e8f06=new RegExp(_0x3ab6cc[_0x2d8ba3(0x337)],'i'),_0x3ec40e=_0x3ab6cc[_0x2d8ba3(0x30a)](_0x4d676b,_0x3ab6cc['clEpd']);if(!_0x2fbebf[_0x2d8ba3(0x1f1)](_0x3ab6cc[_0x2d8ba3(0x266)](_0x3ec40e,_0x3ab6cc[_0x2d8ba3(0x357)]))||!_0x5e8f06[_0x2d8ba3(0x1f1)](_0x3ab6cc[_0x2d8ba3(0x266)](_0x3ec40e,_0x3ab6cc[_0x2d8ba3(0x1c3)])))_0x3ab6cc[_0x2d8ba3(0x1df)](_0x3ab6cc[_0x2d8ba3(0x268)],_0x3ab6cc[_0x2d8ba3(0x35b)])?_0x307847=_0x352e5c:_0x3ab6cc[_0x2d8ba3(0x29d)](_0x3ec40e,'0');else{if(_0x3ab6cc[_0x2d8ba3(0x342)](_0x3ab6cc[_0x2d8ba3(0x365)],_0x3ab6cc[_0x2d8ba3(0x1ec)])){const _0x5a1285=_0x51d1d5[_0x2d8ba3(0x36f)](new _0x548860(_0x45fe85[_0x2d8ba3(0x25a)](_0x19ef56=>_0x3040a4[_0x2d8ba3(0x1f6)](_0x19ef56))))[_0x2d8ba3(0x25a)](_0x2e66d5=>_0x3fc4c7['parse'](_0x2e66d5));return _0x45b85f['send']({'isUpload':!0x1,'color':_0x50a838['UnwUN'],'msg':_0x2d8ba3(0x28b)+_0x5a1285[_0x2d8ba3(0x25a)](_0x24095c=>_0x24095c[_0x2d8ba3(0x1bd)])[_0x2d8ba3(0x20c)](',\x20'),'errorRows':_0x5a1285});}else _0x3ab6cc[_0x2d8ba3(0x3b1)](_0x4d676b);}}else{const _0x479cee=_0x57dfbd[_0x2d8ba3(0x29f)][_0x2d8ba3(0x2d0)](),_0x22a359=_0xe2fb19+_0x2d8ba3(0x1eb)+_0x218e30+_0x2d8ba3(0x217)+_0x53002a+_0x2d8ba3(0x20a)+_0x2447fb+_0x2d8ba3(0x3ba)+_0x479cee,_0x1833eb={..._0x49ad89[_0x2d8ba3(0x34f)]};if(delete _0x1833eb[_0x2d8ba3(0x238)],_0x27fed3[_0x2d8ba3(0x350)]('@')&&_0x5a3a35[_0x2d8ba3(0x350)]('.')&&_0x3ab6cc[_0x2d8ba3(0x213)](_0x3bd6a6[_0x2d8ba3(0x347)],0x5))_0x25ecb7[_0x2d8ba3(0x1fd)](_0x1833eb,_0x46e7d6)[_0x2d8ba3(0x216)](_0x55b078=>(_0x5c6236[_0x2d8ba3(0x35a)](_0x2d8ba3(0x2b9),{'class':_0x2d8ba3(0x36e),'text':_0x2d8ba3(0x309)+_0x68d724+'){{sep}}(CODE\x20:\x20'+_0x55b078[_0x2d8ba3(0x3aa)]+')'}),_0x2d6290[_0x2d8ba3(0x3a0)](_0x22a359)))[_0x2d8ba3(0x301)](_0x4a4c13=>(_0x3146b0[_0x2d8ba3(0x35a)](_0x2d8ba3(0x260),_0x33663f['body']),_0x3ce339[_0x2d8ba3(0x35a)](_0x2d8ba3(0x2b9),{'class':_0x2d8ba3(0x295),'text':''+_0x4a4c13[_0x2d8ba3(0x29a)]}),_0x1f151d['redirect'](_0x22a359)));else return _0x3637cb[_0x2d8ba3(0x35a)](_0x3ab6cc[_0x2d8ba3(0x31c)],_0x39490a[_0x2d8ba3(0x34f)]),_0x58551d[_0x2d8ba3(0x35a)](_0x3ab6cc['pLxpD'],{'class':_0x3ab6cc['rXMAu'],'text':'เพิ่มยูสเซอร์\x20'+_0xed5b1d}),_0xf94cae[_0x2d8ba3(0x3a0)](_0x22a359);}})();}());const _0x5312e9=(function(){const _0x173877=_0x509c,_0x318909={'TkfLZ':'error\x20===>\x20','ilAyu':_0x173877(0x295),'wNrAN':function(_0x3dceb1,_0x36209d){return _0x3dceb1!==_0x36209d;},'BXVtL':_0x173877(0x1bb),'TQBNZ':_0x173877(0x23e),'NoBmI':function(_0x5d4680,_0x4bff45){return _0x5d4680===_0x4bff45;},'ybazl':_0x173877(0x3c4),'NAeuK':function(_0x5c128c,_0x31fe97){return _0x5c128c!==_0x31fe97;},'IVXMl':'wttVG'};let _0x483abf=!![];return function(_0x3650b0,_0x37e8ee){const _0x4cb3bf=_0x173877;if(_0x318909['NAeuK'](_0x318909[_0x4cb3bf(0x341)],_0x318909['IVXMl']))return _0x2a7c8d['log'](_0x318909[_0x4cb3bf(0x2ef)],_0x3df615),_0x3b4692[_0x4cb3bf(0x3bd)]({'isDownload':!0x1,'color':_0x318909[_0x4cb3bf(0x3a9)],'msg':_0x109f0c[_0x4cb3bf(0x29a)]});else{const _0x22bf1c=_0x483abf?function(){const _0x5a94ed=_0x4cb3bf;if(_0x318909[_0x5a94ed(0x360)](_0x318909[_0x5a94ed(0x224)],_0x318909[_0x5a94ed(0x36c)])){if(_0x37e8ee){if(_0x318909[_0x5a94ed(0x24f)](_0x318909['ybazl'],_0x318909[_0x5a94ed(0x2b8)])){const _0x598cf6=_0x37e8ee[_0x5a94ed(0x262)](_0x3650b0,arguments);return _0x37e8ee=null,_0x598cf6;}else{_0x13a214[_0x5a94ed(0x3cf)]['destroy'](_0x2beda7=>(_0x2beda7&&_0x36e838[_0x5a94ed(0x222)]('Session\x20destroy\x20error:\x20',_0x2beda7),_0x4236fe[_0x5a94ed(0x3a0)]('/')));return;}}}else return!![];}:function(){};return _0x483abf=![],_0x22bf1c;}};}()),_0x25235a=_0x5312e9(this,function(){const _0x1d88a7=_0x509c,_0xa7c13b={'rxNBt':function(_0x598339,_0x4993ec){return _0x598339===_0x4993ec;},'GLVxa':_0x1d88a7(0x2ab),'blSid':function(_0x350930,_0x18c958){return _0x350930(_0x18c958);},'xtPOx':function(_0x1b1771,_0x776009){return _0x1b1771+_0x776009;},'BOvPI':function(_0x515359,_0x57b54f){return _0x515359+_0x57b54f;},'oQUCD':_0x1d88a7(0x308),'jXhXW':_0x1d88a7(0x2fc),'qxUUt':function(_0x428541){return _0x428541();},'eiOdA':function(_0x18d4a8,_0x1a62c1){return _0x18d4a8!==_0x1a62c1;},'okurG':'tWmDK','SWxRy':_0x1d88a7(0x2aa),'GDuCx':_0x1d88a7(0x222),'nvUxL':_0x1d88a7(0x2c6),'fxktm':_0x1d88a7(0x33c),'rPzIh':_0x1d88a7(0x252),'IuTND':_0x1d88a7(0x1b2),'gKJcD':_0x1d88a7(0x338),'ETEqB':_0x1d88a7(0x2d8),'DJYbe':function(_0x1d1482,_0x457f7e){return _0x1d1482<_0x457f7e;},'fmvfz':function(_0x1d090d,_0x3f9ee0){return _0x1d090d===_0x3f9ee0;},'bOUgA':_0x1d88a7(0x313),'qMrWA':_0x1d88a7(0x1d1)};let _0x40f821;try{if(_0xa7c13b[_0x1d88a7(0x3d0)](_0xa7c13b[_0x1d88a7(0x25d)],_0xa7c13b[_0x1d88a7(0x25d)])){const _0x5c7cb6=_0xa7c13b[_0x1d88a7(0x283)](Function,_0xa7c13b[_0x1d88a7(0x201)](_0xa7c13b[_0x1d88a7(0x20f)](_0xa7c13b['oQUCD'],_0xa7c13b['jXhXW']),');'));_0x40f821=_0xa7c13b[_0x1d88a7(0x368)](_0x5c7cb6);}else _0x2ae8ab[_0x1d88a7(0x270)]();}catch(_0x270416){_0xa7c13b['eiOdA'](_0xa7c13b[_0x1d88a7(0x24d)],_0xa7c13b[_0x1d88a7(0x1b6)])?_0x40f821=window:_0x362042[_0x1d88a7(0x270)]();}const _0x560cc7=_0x40f821[_0x1d88a7(0x2fa)]=_0x40f821[_0x1d88a7(0x2fa)]||{},_0x159615=[_0xa7c13b['GDuCx'],_0xa7c13b[_0x1d88a7(0x25f)],_0xa7c13b[_0x1d88a7(0x26f)],_0xa7c13b[_0x1d88a7(0x30c)],_0xa7c13b[_0x1d88a7(0x3a8)],_0xa7c13b['gKJcD'],_0xa7c13b[_0x1d88a7(0x3c5)]];for(let _0x7df1d9=0x0;_0xa7c13b[_0x1d88a7(0x3a5)](_0x7df1d9,_0x159615[_0x1d88a7(0x347)]);_0x7df1d9++){if(_0xa7c13b[_0x1d88a7(0x3c1)](_0xa7c13b[_0x1d88a7(0x3a2)],_0xa7c13b[_0x1d88a7(0x229)]))return _0x4664c7;else{const _0x2bcc5d=_0x5312e9[_0x1d88a7(0x228)][_0x1d88a7(0x316)][_0x1d88a7(0x248)](_0x5312e9),_0x1fe469=_0x159615[_0x7df1d9],_0x311ffa=_0x560cc7[_0x1fe469]||_0x2bcc5d;_0x2bcc5d[_0x1d88a7(0x21d)]=_0x5312e9[_0x1d88a7(0x248)](_0x5312e9),_0x2bcc5d[_0x1d88a7(0x2d0)]=_0x311ffa[_0x1d88a7(0x2d0)]['bind'](_0x311ffa),_0x560cc7[_0x1fe469]=_0x2bcc5d;}}});_0x25235a();import _0x9cc1d3 from'express';import{MongoClient as _0x49ccbe,ObjectId as _0x79faf4}from'mongodb';import _0x2528a9 from'bcrypt';function _0x509c(_0x22398c,_0xa74bed){const _0x178bca=_0x4520();return _0x509c=function(_0x25235a,_0x5312e9){_0x25235a=_0x25235a-0x1a9;let _0x2a8546=_0x178bca[_0x25235a];return _0x2a8546;},_0x509c(_0x22398c,_0xa74bed);}const S=_0x9cc1d3[_0x9698ac(0x27d)]();import _0x473d85 from'multer';import _0x346442 from'validator';import _0x1c1f4c from'xlsx';import _0x5b0c1c from'path';import _0x462fc2 from'fs';import _0x57c634 from'ejs';import _0x48d915 from'../middleware/mainAuth.js';function _0x4520(){const _0x3f3f91=['stringify','Kortg','filter','call','buffer','bwSEO','TqEeE','sendRegisterUserEmail','APmlr','vRIdZ','RvkoW','xtPOx','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','adDrR','stateObject','rhhfd','trRKA','ประวัติการแก้ไขยูสเซอร์\x20:\x20[','SheetNames','2471ajCqLi','&page=','ojXTs','join','GnRGb','SZcPa','BOvPI','dbColl_userBranches','uhpas','aJVhP','NCNlu','12159240xrTXAP','ioWKl','then','&rpp=','isOS','oOieL','ไม่มีข้อมูล','okwUD','destroy','__proto__','debu','USERNAME_PATTERN','active','YewbP','log','อัปเดท\x20','BXVtL','BsZOA','nquaW','forEach','constructor','qMrWA','error\x20===>\x20','YsrKY','SVmUr','suuoL','replace','XacWm','findOne','lwfPF','rhPCi','ohVlQ','input','memoryStorage','deletedCount','gFFgI','userPassword','qhRgB','xaiGY','doc_changes.ejs','bbnAK','getDate','tWQvP','dbColl_sales','nvvjH','\x22\x20เรียบร้อยแล้ว','dbColl_sessions','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','WjtkJ','MfLeQ','UKQms','NnJun','bind','utils','sort','CAaHm','username','okurG','qHbcq','NoBmI','ieIho','gsCPC','error','asHMd','getSessionData','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','AEzzl','เพิ่มยูสเซอร์\x20','wyeoc','Pbugm','map','status','query','GLVxa','nndBC','nvUxL','userFlash','counter','apply','getChangeHistory','manageUsers','isEmail','saGsb','rSKAx','elxYd','Sfdpy','chain','mrdyQ','qPrWk','shQPw','xWCoQ','fxktm','close','$changesHistory','/load','xlsx','ziXlc','BjHLN','XgBNa','UKcsH','/changes','acYue','XqyPK','\x20ยูสเซอร์เรียบร้อยแล้ว','TIvtv','Router','eVRmE','LIVwf','MSuNi','NiZxI','dbColl_return','blSid','PYEJm','hCxrP','rpp','yqWuI','JHYCc','kvyXk','KHbTd','มีข้อมูลผิดพลาดที่แถว\x20','TVfDI','IhSpp','OCeVn','cqgbO','hAvjd','aknFH','ไม่พบประวัติการเปลี่ยนแปลง','YjaTR','bdpIr','red','AwfoS','ไม่พบ\x20\x22','TOUqM','ยูสเซอร์\x20(','message','guTAH','ZylME','HwIFC','dbName','insertedId','zjPuZ','KPAFd','BujZt','renderView','jzIzn','dbColl_users','render','YsIEf','users_','shift','budeN','ARxWF','load_id','PNyjE','gLfJa','nvaVI','SZxoE','oAPyW','lRNkS','aXWja','TTboQ','userId','NrIbg','NVPjQ','ybazl','msg','xTeDK','NsNWV','KaNPg','XImUS','568797AIqBtl','xrEjn','EiWTm','TlJln','connect','qhfJM','FeQJe','cbyOh','warn','Qidhu','oPpOk','akXhP','dExAU','unshift','edvCF','zlPet','ไม่มีข้อมูลที่อัปเดท','NtOXN','toString','push','deleteMany','KhhgW','users','XKNdF','WOHiC','cLnoA','trace','nPXHb','KbmlZ','print_users.ejs','dklNW','sendFile','has','aggregate','\x22\x20เรียบร้อยแล้ว\x20)','xXQrQ','/myModule.js','lYSdA','hbuBq','ZEagz','matchedCount','modifiedCount','sumuk','BCRYPT_NUMBER','PDbCS','fqxba','hasOwnProperty','ZQolJ','branchId','TkfLZ','HVmjs','CyXGf','getDateTime','acknowledged','USER_AUTHORITIES','.xlsx','/myUsers.js','dKqAe','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','OtApI','console','XiHWy','{}.constructor(\x22return\x20this\x22)(\x20)','userLastLogin','userAuthority','NHCib','Session\x20destroy\x20error:\x20','catch','pdxpt','lrwUy','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','WLdCQ','47493kvzwxf','KNaxf','return\x20(function()\x20','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','tSryH','AOwsA','rPzIh','read','aYtDn','lhVbn','BMlBW','JHFfO','entries','udHey','xUQyO','THNDT','prototype','lscHa','hMIvm','AVHUv','post','Sheets','zMqoL','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','jyPxY','userPhone','$branchInfo.branchName','sheet_to_json','RbXGR','vJpeb','UYrhQ','SIrLT','while\x20(true)\x20{}','uploadExcelFile','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','/save','qOvGo','GEXCI','kPWkT','pCFom','/upload-excel','EtnEa','base64','\x20รายการ','trim','uSpts','CKWAq','pOCVO','885WzWjrx','WjoRc','table','1228491eeFwhN','RhMso','{{sep}}เพิ่มใหม่\x20','info','ASVRd','tGRrD','lroBA','function\x20*\x5c(\x20*\x5c)','IVXMl','xpVKx','RwCWw','fhoYi','HWmwp','userNormalLoginCount','length','lTjts','\x22\x20มีอยู่ในเอกสาร\x20','HwLUK','13208MPsIue','minute','gger','xAmso','body','includes','vWdRC','oeRXQ','dLExv','WXXRS','FBnKW','updateOne','anoay','Fpauv','upsertedCount','flash','SOECV','AQjPK','benhn','$userPrefix','rvEmT','wNrAN','jCQgP','changesHistory','Mkrme','deleteOne','nFWVf','hash','/delete','qxUUt','OzOva','get','SkFyH','TQBNZ','24eJUwHx','green','from','uvtGP','LQWUX','eWaCf','\x5c$&','KPljE','find','FvKpX','rIvOt','gKwUA','/print','SEWaz','oPqrj','collection','zqftj','CdpOl','Bhzhr','IiSbu','page','MqElZ','qtxCb','userFullname','SiZTN','ยูสเซอร์\x20\x22','iEuZf','sip','keys','ccFEM','FDNZg','มี\x20userId\x20ซ้ำกัน:\x20\x22','ZeNGm','NfSAd','RnKPF','WjFZO','size','mFtJS','zFICa','dateTimeCanDelete','userIsActive','jdEJR','flAFw','zMEkL','NdZAh','muPQE','hTUdL','wSrcf','QSbiR','xqljT','CNfvT','redirect','{{sep}}(\x20ไม่พบเซสชั่น\x20)','bOUgA','oViIu','nsZCv','DJYbe','branchInfo','bKaHy','IuTND','ilAyu','response','CerBU','wXIOG','xWjup','DVNpv','fwHhv','อัปเดท\x20\x22','cArUx','string','uabVY','{{sep}}[\x20บันทึกการแก้ไข\x20]','ORhlV','file','enOoM','696392xhfAIw','rZYXC','&load_id=','wmMTX','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','send','AcPPy','userLastname','hSEdU','fmvfz','utf8','พิมพ์ข้อมูล\x20','gAVsB','ETEqB','gszSy','rXyXK','book_new','RPGso','qczfh','/mySendmail.js','CnMeN','Xjwmg','userEmail','session','rxNBt','lbGwR','zcnNo','PcqmO','cJPKO','FkMDe','Not\x20Found','maWyj','รูปแบบอีเมลไม่ถูกต้อง','iuPxk','yellow','init','ceil','YcdQV','BoEUw','YmoVe','MFhmr','jZcuJ','toArray','BfUYX','exception','QsHTa','aDINA','TfiAc','SWxRy','dbColl_warehouseOut','12012CWzxMO','{{sep}}\x22','SSCEc','HBbUr','มี\x20username\x20ซ้ำกัน:\x20\x22','row','/myDateTime.js','CLTCf','WmmGP','KKPOQ','action','kgBsc','json_to_sheet','userPrefix','kRAOx','wiBlA','dbColl_warehouseIn','MfFCP','WSDko','zGJxy','jfxcH','xuvLc','folderForms','ByDHy','nEOtV','kEglo','JEAWS','apHtC','rySVX','userFirstname','some','LYPRH','parse','rweEc','bobks','BaXCF','ZkGhk','LdiBi','BcncT','stqLe','gEcMp','jyiow','AkrUN','$userLastname','/manage/users','jJwED','RFUnp','BfzsW','bYOBh','../','pgTfi','?sip=','NUARC','Mgmmf','){{sep}}(CODE\x20:\x20','fygvE','add','test','uMniq','sotbb','countDocuments','UkGHN'];_0x4520=function(){return _0x3f3f91;};return _0x4520();}const H=await import(_0x9698ac(0x1e9)+mymoduleFolder+_0x9698ac(0x2e2)),O=await import(_0x9698ac(0x1e9)+mymoduleFolder+_0x9698ac(0x1be)),J=await import('../'+mymoduleFolder+_0x9698ac(0x2f6)),te=await import(_0x9698ac(0x1e9)+mymoduleFolder+_0x9698ac(0x3cb)),B=await import(_0x9698ac(0x1e9)+mymoduleFolder+'/myData.js'),$=_0x9698ac(0x1e4),z=$+_0x9698ac(0x329),Q=$+_0x9698ac(0x272),X=$+_0x9698ac(0x367),G=$+_0x9698ac(0x379),V=$+_0x9698ac(0x278),W=$+'/download-excel',Y=$+_0x9698ac(0x32e),re=$[_0x9698ac(0x22e)](/\//g,'_');S[_0x9698ac(0x36a)]($,_0x48d915[_0x9698ac(0x218)],async(_0x260c78,_0x219b7f)=>{const _0x52dcd3=_0x9698ac,_0x4cf6dd={'fZoMe':'while\x20(true)\x20{}','BakmH':_0x52dcd3(0x261),'WLdCQ':function(_0x42a68e,_0x64771f){return _0x42a68e+_0x64771f;},'BfzsW':_0x52dcd3(0x21e),'ohVlQ':_0x52dcd3(0x34d),'BsZOA':_0x52dcd3(0x1c2),'lbGwR':function(_0x91b2d3,_0x15a1d9){return _0x91b2d3(_0x15a1d9);},'ZyZzZ':'red','hAvjd':function(_0x38ef91,_0xa08feb){return _0x38ef91(_0xa08feb);},'sumuk':function(_0x1df8a7,_0x3d3f03){return _0x1df8a7(_0x3d3f03);},'OzOva':function(_0x1b464c,_0x24c39c){return _0x1b464c(_0x24c39c);},'hWeiU':function(_0x20dc69,_0x52ffeb){return _0x20dc69*_0x52ffeb;},'iEuZf':function(_0x5c5691,_0x578dd8){return _0x5c5691-_0x578dd8;},'AOwsA':function(_0x248f3d,_0x1a662a){return _0x248f3d===_0x1a662a;},'Mkrme':'kTiMf','HWmwp':function(_0x417fc3,_0x307998){return _0x417fc3!==_0x307998;},'wmMTX':_0x52dcd3(0x256),'zjPuZ':_0x52dcd3(0x380),'eJtIM':_0x52dcd3(0x373),'XacWm':function(_0x2450ce,_0x106e4f){return _0x2450ce(_0x106e4f);},'WjFZO':function(_0x2fbad7,_0x392f6f){return _0x2fbad7/_0x392f6f;},'WEAuB':function(_0x11b956,_0x288cb3){return _0x11b956<_0x288cb3;},'MSuNi':function(_0x10d23b,_0x3b8e50){return _0x10d23b-_0x3b8e50;},'gLfJa':function(_0x5c682f,_0x1131bf){return _0x5c682f-_0x1131bf;},'nPXHb':function(_0xd0944a,_0x2a8f6e){return _0xd0944a(_0x2a8f6e);},'lscHa':function(_0x27fb9d,_0x335848){return _0x27fb9d>_0x335848;},'jyPxY':function(_0x48588,_0x1fbe1a){return _0x48588+_0x1fbe1a;},'Pbugm':function(_0x462ba2,_0x558c72){return _0x462ba2(_0x558c72);},'wiBlA':_0x52dcd3(0x35e),'FkMDe':'$userFirstname','MzBZm':_0x52dcd3(0x1e3),'qYcGJ':_0x52dcd3(0x271),'gEcMp':'$dateTimeCanDelete','SSCEc':_0x52dcd3(0x34c),'PNyjE':_0x52dcd3(0x32d),'flAFw':_0x52dcd3(0x38f),'RFkUU':function(_0x259a9c,_0x49ec00){return _0x259a9c(_0x49ec00);},'nEAeu':function(_0x53fc54,_0x1f4dd7){return _0x53fc54===_0x1f4dd7;},'wSrcf':function(_0x2af333,_0x218d6f){return _0x2af333===_0x218d6f;},'rhhfd':'HXisw','WSDko':_0x52dcd3(0x303),'KKPOQ':_0x52dcd3(0x260),'iuPxk':_0x52dcd3(0x264),'UPHnN':_0x52dcd3(0x2b9),'SZxoE':'active','ycjCM':function(_0x4685a2,_0x18739b){return _0x4685a2===_0x18739b;},'RFUnp':_0x52dcd3(0x2fb),'aknFH':_0x52dcd3(0x27a),'nvvjH':_0x52dcd3(0x315)},_0x342ff5=_0x260c78[_0x52dcd3(0x25c)][_0x52dcd3(0x388)],_0x66f178=_0x4cf6dd['hAvjd'](Number,_0x260c78['query'][_0x52dcd3(0x286)])||0x14,_0x231dd7=_0x4cf6dd[_0x52dcd3(0x2e8)](Number,_0x260c78['query'][_0x52dcd3(0x381)])||0x1,_0x9cb317=_0x260c78[_0x52dcd3(0x25c)][_0x52dcd3(0x2ac)]||'',_0x24a918=_0x4cf6dd[_0x52dcd3(0x369)](Number,_0x4cf6dd['hWeiU'](_0x4cf6dd[_0x52dcd3(0x387)](_0x231dd7,0x1),_0x66f178)),_0x2cd225=new _0x49ccbe(dbUrl);try{if(_0x4cf6dd[_0x52dcd3(0x30b)](_0x4cf6dd[_0x52dcd3(0x363)],_0x4cf6dd['Mkrme'])){const _0x1a5933=O[_0x52dcd3(0x2f2)](0x0);await _0x2cd225[_0x52dcd3(0x2c2)]();const _0x527dc6=_0x2cd225['db'](global[_0x52dcd3(0x29e)])[_0x52dcd3(0x37c)](global[_0x52dcd3(0x2a5)]);if(_0x342ff5){if(_0x4cf6dd['HWmwp'](_0x4cf6dd[_0x52dcd3(0x3bb)],_0x4cf6dd[_0x52dcd3(0x2a0)])){const _0x381456=new RegExp(_0x342ff5[_0x52dcd3(0x22e)](/[.*+?^${}()|[\]\\]/g,_0x4cf6dd['eJtIM']),'i');let _0xa87905={};_0x4cf6dd['XacWm'](isNaN,_0x4cf6dd[_0x52dcd3(0x290)](Number,_0x342ff5))?_0xa87905={'userId':{'$regex':_0x381456}}:_0xa87905={'userId':_0x4cf6dd['OzOva'](Number,_0x342ff5)};var _0xea9205=await _0x527dc6[_0x52dcd3(0x1f4)]({'$or':[_0xa87905,{'username':{'$regex':_0x381456}},{'userFirstname':{'$regex':_0x381456}}]});}else return function(_0x1b61e1){}['constructor'](GeyJjr['fZoMe'])[_0x52dcd3(0x262)](GeyJjr['BakmH']);}else var _0xea9205=await _0x527dc6['countDocuments']({});const _0x2debbc=Math[_0x52dcd3(0x1aa)](_0x4cf6dd[_0x52dcd3(0x390)](_0xea9205,_0x66f178)),_0x5507ea=_0x4cf6dd['WEAuB'](_0x4cf6dd[_0x52dcd3(0x280)](_0x4cf6dd[_0x52dcd3(0x22f)](Number,_0x231dd7),0x1),0x1)?'-':_0x4cf6dd[_0x52dcd3(0x2ae)](_0x4cf6dd[_0x52dcd3(0x2d9)](Number,_0x231dd7),0x1),_0x3656f3=_0x4cf6dd[_0x52dcd3(0x22f)](Number,_0x231dd7),_0x2613ab=_0x4cf6dd[_0x52dcd3(0x317)](_0x4cf6dd[_0x52dcd3(0x31e)](_0x4cf6dd[_0x52dcd3(0x259)](Number,_0x231dd7),0x1),_0x2debbc)?'-':_0x4cf6dd[_0x52dcd3(0x31e)](_0x4cf6dd[_0x52dcd3(0x3d1)](Number,_0x231dd7),0x1),_0xed334f=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x4cf6dd[_0x52dcd3(0x1c7)],'\x20',_0x4cf6dd[_0x52dcd3(0x3d5)],'\x20',_0x4cf6dd['MzBZm']]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x4cf6dd['qYcGJ'],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x1a5933},'endDate':{'$toDate':_0x4cf6dd[_0x52dcd3(0x1e0)]},'unit':_0x4cf6dd[_0x52dcd3(0x1ba)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x24a918},{'$limit':_0x66f178}];if(_0x342ff5){if(_0x4cf6dd[_0x52dcd3(0x345)](_0x4cf6dd[_0x52dcd3(0x2ad)],_0x4cf6dd[_0x52dcd3(0x397)])){const _0x33ef14=_0x342ff5?new RegExp(''+_0x342ff5,'i'):new RegExp('.*');let _0x1d11a4={};_0x4cf6dd[_0x52dcd3(0x22f)](isNaN,_0x4cf6dd['OzOva'](Number,_0x342ff5))?_0x1d11a4={'userId':{'$regex':_0x33ef14}}:_0x1d11a4={'userId':_0x4cf6dd['RFkUU'](Number,_0x342ff5)},_0xed334f['unshift']({'$match':{'$or':[_0x1d11a4,{'username':{'$regex':_0x33ef14}},{'userFirstname':{'$regex':_0x33ef14}}]}});}else _0x1ffa81[_0x52dcd3(0x2de)](_0x629b69[_0x52dcd3(0x24c)])?_0x4d0221[_0x52dcd3(0x1f0)](_0x109011[_0x52dcd3(0x24c)]):_0x12ae2b[_0x52dcd3(0x1f0)](_0x5eaf0c[_0x52dcd3(0x24c)]);}const _0x21671d=_0x260c78[_0x52dcd3(0x3cf)][_0x52dcd3(0x2fe)];let _0x4a74aa=await _0x527dc6['aggregate'](_0xed334f)['toArray']();if(_0x4cf6dd['AOwsA'](_0x21671d,'A')&&(_0x4a74aa=_0x4a74aa[_0x52dcd3(0x1f8)](_0x11d0d4=>_0x11d0d4[_0x52dcd3(0x2fe)]!=='O')),_0x9cb317)var _0x596f90=await _0x527dc6['findOne']({'_id':new _0x79faf4(_0x9cb317)},{'projection':{'userPassword':0x0}});else var _0x596f90={};if(_0x596f90&&_0x4cf6dd['nEAeu'](Object[_0x52dcd3(0x389)](_0x596f90)[_0x52dcd3(0x347)],0x0)){if(_0x4cf6dd[_0x52dcd3(0x39c)](_0x4cf6dd[_0x52dcd3(0x205)],_0x4cf6dd[_0x52dcd3(0x1ca)]))(function(){return!![];}[_0x52dcd3(0x228)](GeyJjr[_0x52dcd3(0x305)](GeyJjr[_0x52dcd3(0x1e7)],GeyJjr[_0x52dcd3(0x233)]))['call'](GeyJjr[_0x52dcd3(0x225)]));else{const _0x598fd9=_0x260c78['flash'](_0x4cf6dd[_0x52dcd3(0x1c1)]);_0x598fd9&&_0x4cf6dd[_0x52dcd3(0x317)](_0x598fd9['length'],0x0)&&(_0x596f90={..._0x598fd9[0x0]});}}const _0x4080b4=await H[_0x52dcd3(0x2a3)](_0x4cf6dd[_0x52dcd3(0x3d9)],_0x219b7f,{'title':PAGE_MANAGE_USERS,'time':O['getDate'](),'msg':_0x260c78[_0x52dcd3(0x35a)](_0x4cf6dd['UPHnN']),'user':await J['getSessionData'](_0x260c78),'settings':await H['getSettings'](),'load_id':_0x9cb317,'sip':_0x342ff5,'rpp':_0x66f178,'page':_0x231dd7,'pagePre':_0x5507ea,'pageAct':_0x3656f3,'pageNxt':_0x2613ab,'pageLst':_0x2debbc,'pageRedirect':$,'data':_0x4a74aa,'dataBranches':await B['getUserBranches']({'branchStatus':_0x4cf6dd[_0x52dcd3(0x2b0)]}),'PATH_MAIN':$,'PATH_PRINT':G,'PATH_SAVE':z,'PATH_LOAD':Q,'PATH_DELETE':X,'PATH_CHANGES':V,'PATH_DOWNLOAD_EXCEL':W,'PATH_UPLOAD_EXCEL':Y,'PREFIX':re,'item':_0x596f90});return _0x219b7f[_0x52dcd3(0x3bd)](_0x4080b4);}else _0x4eb46c[_0x52dcd3(0x2b5)]=_0x4cf6dd['lbGwR'](_0x1f76b0,_0x58f27c[_0x52dcd3(0x2b5)]),_0x3aba38[_0x52dcd3(0x2ee)]=_0x4cf6dd[_0x52dcd3(0x3d1)](_0x187547,_0x5805fc[_0x52dcd3(0x2ee)]),_0x45a741[_0x52dcd3(0x395)]||(_0x516b2e['userIsActive']=''),_0x1fcd07[_0x52dcd3(0x31f)]||(_0x2705bd['userPhone']=''),_0x42bbc6['userPrefix']||(_0x5952fd[_0x52dcd3(0x1c5)]=''),_0x1eea72['userLastname']||(_0x2108f7[_0x52dcd3(0x3bf)]=''),delete _0xb469d9[_0x52dcd3(0x2fd)],delete _0x52fc8e['changesHistoryCount'],delete _0x2e02eb[_0x52dcd3(0x346)],delete _0x1abc37['userLastLogin'];}catch(_0x45c6f4){if(_0x4cf6dd['ycjCM'](_0x4cf6dd[_0x52dcd3(0x1e6)],_0x4cf6dd[_0x52dcd3(0x1e6)]))console['log'](_0x45c6f4['message']),_0x219b7f[_0x52dcd3(0x25b)](0x194)['sendFile'](file404);else return _0xecbc76['send']({'isDownload':!0x1,'color':_0x4cf6dd['ZyZzZ'],'msg':_0x494fe1[_0x52dcd3(0x29a)]});}finally{_0x4cf6dd['HWmwp'](_0x4cf6dd[_0x52dcd3(0x291)],_0x4cf6dd[_0x52dcd3(0x240)])?_0x2cd225['close']():_0x1a5a67['close']();}}),S[_0x9698ac(0x31a)](Q,_0x48d915[_0x9698ac(0x218)],async(_0x375e2f,_0x53903d)=>{const _0x3e990a=_0x9698ac,_0x2ede60={'MfLeQ':_0x3e990a(0x260),'MfFCP':function(_0x5815d3,_0x1797ce){return _0x5815d3>_0x1797ce;},'guTAH':_0x3e990a(0x22a),'dExAU':_0x3e990a(0x2b9),'ORhlV':'red','hSEdU':function(_0x39ac9f,_0x1a0f85){return _0x39ac9f(_0x1a0f85);},'JHYCc':function(_0x18b2d7,_0xf943c2){return _0x18b2d7(_0xf943c2);},'vWdRC':function(_0xb21643,_0x463552){return _0xb21643===_0x463552;},'SZcPa':_0x3e990a(0x39f),'fwHhv':'suukO','rweEc':_0x3e990a(0x3d6),'acYue':function(_0x3c74fc,_0x2cde5f){return _0x3c74fc!==_0x2cde5f;},'TVfDI':'PePdM','WMHyK':function(_0x54d2c6,_0x3d121c){return _0x54d2c6!==_0x3d121c;},'oPqrj':_0x3e990a(0x28d),'zlPet':_0x3e990a(0x1cd)},_0x455b70=_0x375e2f[_0x3e990a(0x34f)][_0x3e990a(0x2ac)],_0x383a76=_0x375e2f[_0x3e990a(0x34f)][_0x3e990a(0x388)],_0x25f293=_0x2ede60[_0x3e990a(0x3c0)](Number,_0x375e2f[_0x3e990a(0x34f)][_0x3e990a(0x286)])||0x14,_0x1c9b68=_0x2ede60[_0x3e990a(0x288)](Number,_0x375e2f[_0x3e990a(0x34f)][_0x3e990a(0x381)])||0x1,_0x275cff=$+_0x3e990a(0x1eb)+_0x383a76+_0x3e990a(0x217)+_0x25f293+'&page='+_0x1c9b68+_0x3e990a(0x3ba)+_0x455b70,_0x23281d=new _0x49ccbe(dbUrl);try{if(_0x2ede60[_0x3e990a(0x351)](_0x2ede60[_0x3e990a(0x20e)],_0x2ede60[_0x3e990a(0x3af)])){const _0x46046e=_0x5433b4[_0x3e990a(0x35a)](_0x2ede60[_0x3e990a(0x245)]);_0x46046e&&_0x2ede60[_0x3e990a(0x1c9)](_0x46046e[_0x3e990a(0x347)],0x0)&&(_0x35c372={..._0x46046e[0x0]});}else return await _0x23281d['db'](dbName)[_0x3e990a(0x37c)](dbColl_users)['findOne']({'_id':new _0x79faf4(_0x455b70)},{'projection':{'changesHistory':0x0}})?_0x375e2f['flash'](_0x2ede60['dExAU'],null):_0x375e2f['flash'](_0x2ede60[_0x3e990a(0x2ca)],{'class':_0x2ede60[_0x3e990a(0x3b5)],'text':new Error(_0x2ede60[_0x3e990a(0x1d9)])+'{{sep}}\x22'+_0x455b70+'\x22'}),_0x53903d[_0x3e990a(0x3a0)](_0x275cff);}catch(_0x3a37d7){return _0x2ede60[_0x3e990a(0x279)](_0x2ede60[_0x3e990a(0x28c)],_0x2ede60[_0x3e990a(0x28c)])?(_0x5667e2[_0x3e990a(0x222)](_0x2ede60[_0x3e990a(0x29b)],_0x592391),_0x50d295['flash'](_0x2ede60['dExAU'],{'class':_0x2ede60[_0x3e990a(0x3b5)],'text':_0x9d8550['message']}),_0x4a5dbb[_0x3e990a(0x3a0)](_0x31687a)):(console[_0x3e990a(0x222)](_0x3a37d7[_0x3e990a(0x29a)]),_0x375e2f[_0x3e990a(0x35a)](_0x2ede60[_0x3e990a(0x2ca)],{'class':_0x2ede60['ORhlV'],'text':''+_0x3a37d7['message']}),_0x53903d[_0x3e990a(0x3a0)](_0x275cff));}finally{_0x2ede60['WMHyK'](_0x2ede60[_0x3e990a(0x37b)],_0x2ede60[_0x3e990a(0x2cd)])?_0x23281d[_0x3e990a(0x270)]():(_0x205e53[_0x3e990a(0x222)](_0x2ede60['guTAH'],_0x49a41b),_0x51dc3e['send'](_0x987ffe[_0x3e990a(0x1f6)]({'isPrint':!0x1,'class':_0x2ede60['ORhlV'],'msg':_0x135a59[_0x3e990a(0x29a)]})));}}),S[_0x9698ac(0x31a)](z,_0x48d915[_0x9698ac(0x218)],async(_0x159603,_0x3530f8)=>{const _0x2fd1d7=_0x9698ac,_0x499e94={'vRIdZ':function(_0x17d4a9,_0x5cb3dd){return _0x17d4a9===_0x5cb3dd;},'xrEjn':'lJQyy','WOHiC':_0x2fd1d7(0x376),'SkFyH':function(_0x1ee222,_0xc037a7){return _0x1ee222===_0xc037a7;},'NsNWV':'NAXTO','NfSAd':function(_0x5bc818,_0x3102fa,_0x33ec2d){return _0x5bc818(_0x3102fa,_0x33ec2d);},'kRAOx':function(_0x523f){return _0x523f();},'kiAhk':_0x2fd1d7(0x340),'benhn':_0x2fd1d7(0x2f8),'ZylME':function(_0x21d6f1,_0x435c25){return _0x21d6f1(_0x435c25);},'AzKOI':_0x2fd1d7(0x1a9),'MWqXj':function(_0x260260,_0x5a6613){return _0x260260+_0x5a6613;},'CyXGf':_0x2fd1d7(0x26a),'dMgit':function(_0x3e7449,_0x4f406b){return _0x3e7449+_0x4f406b;},'pdxpt':_0x2fd1d7(0x234),'ieIho':function(_0x31670c){return _0x31670c();},'zFICa':_0x2fd1d7(0x22a),'YmoVe':_0x2fd1d7(0x295),'enOoM':'msg','jyiow':function(_0x5e8e84,_0x2469a4){return _0x5e8e84!==_0x2469a4;},'ZeNGm':'fSVtS','TfiAc':_0x2fd1d7(0x260),'RLWPd':_0x2fd1d7(0x3d8),'xXQrQ':function(_0x4eea8f,_0x1b011c){return _0x4eea8f===_0x1b011c;},'TIvtv':'eWUCc','EiWTm':'dxevT','lYSdA':function(_0x5509ec,_0x1adfcb){return _0x5509ec===_0x1adfcb;},'rySVX':'ZWxKl','NiZxI':'อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','bobks':function(_0x3e2a21,_0x356ba4){return _0x3e2a21==_0x356ba4;},'rIvOt':_0x2fd1d7(0x220),'YcdQV':function(_0x1821ec,_0x468364){return _0x1821ec==_0x468364;},'mFtJS':function(_0x55416e,_0x552e50){return _0x55416e==_0x552e50;},'JUjIP':function(_0x10a5d1,_0x1683ce){return _0x10a5d1!==_0x1683ce;},'xqljT':'YdFNk','gKwUA':_0x2fd1d7(0x3d7),'GnRGb':function(_0xf08271,_0x131425){return _0xf08271>_0x131425;},'ioWKl':_0x2fd1d7(0x324),'MFhmr':_0x2fd1d7(0x3b4),'nvaVI':'onqzz','fCdwV':'UUror','KzUPG':_0x2fd1d7(0x3a1),'edvCF':'KfNPD','TlJln':_0x2fd1d7(0x370),'RPGso':_0x2fd1d7(0x36e),'FDNZg':function(_0x41e5ef,_0x14ecdc){return _0x41e5ef<_0x14ecdc;},'oOieL':_0x2fd1d7(0x3da),'MkhVV':'Not\x20Found','lTjts':_0x2fd1d7(0x26c),'okwUD':_0x2fd1d7(0x247),'rhPCi':'อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','uabVY':function(_0x4fa881,_0x4052f4){return _0x4fa881>_0x4052f4;},'pakcW':function(_0xdd508b,_0x5c52fe){return _0xdd508b+_0x5c52fe;},'TCqaB':function(_0x132159,_0x4c5ec0){return _0x132159!==_0x4c5ec0;},'AcPPy':'lxaQY','RvkoW':_0x2fd1d7(0x244),'wyeoc':function(_0x11ad2c,_0x1de74f){return _0x11ad2c>_0x1de74f;},'UKcsH':_0x2fd1d7(0x202),'UKQms':function(_0x6fb55c,_0x2192ea){return _0x6fb55c===_0x2192ea;},'AkrUN':'vciYi','jdEJR':function(_0x37c940,_0x5414a2){return _0x37c940===_0x5414a2;},'qhRgB':_0x2fd1d7(0x1fc),'SIrLT':function(_0x10339b){return _0x10339b();}},_0xe91382=[];let _0x3be9ba=!0x1;const _0x3ac680=async()=>{const _0x2ab299=_0x2fd1d7;if(_0x499e94[_0x2ab299(0x1ff)](_0x499e94[_0x2ab299(0x2bf)],_0x499e94[_0x2ab299(0x2d6)]))_0x3d51a4[_0x2ab299(0x2de)](_0x3f7212[_0x2ab299(0x3ce)])?_0x31dae3['add'](_0x183853[_0x2ab299(0x3ce)]):_0x36b1b6[_0x2ab299(0x1f0)](_0x516cff[_0x2ab299(0x3ce)]);else{if(_0x499e94[_0x2ab299(0x36b)](_0xe91382[_0x2ab299(0x347)],0x0)){if(_0x499e94[_0x2ab299(0x36b)](_0x499e94['NsNWV'],_0x499e94[_0x2ab299(0x2bb)])){_0x3be9ba=!0x1;return;}else return![];}_0x3be9ba=!0x0;const {req:_0x23c5e6,res:_0x2346b7}=_0xe91382[_0x2ab299(0x2a9)]();await _0x499e94[_0x2ab299(0x38e)](_0x5347c8,_0x23c5e6,_0x2346b7),_0x499e94[_0x2ab299(0x1c6)](_0x3ac680);}},_0x5347c8=async(_0x4f639d,_0x485555)=>{const _0x4ef952=_0x2fd1d7,_0x418e90={'XImUS':_0x499e94[_0x4ef952(0x393)],'nsZCv':_0x499e94[_0x4ef952(0x1ad)],'zMEkL':_0x499e94[_0x4ef952(0x3b7)]};if(_0x499e94['jyiow'](_0x499e94['ZeNGm'],_0x499e94[_0x4ef952(0x38d)]))_0x407cb1[_0x4ef952(0x2de)](_0x53bcfa[_0x4ef952(0x2b5)])?_0x1d9cd1[_0x4ef952(0x1f0)](_0x59cb49['userId']):_0x2ae0db[_0x4ef952(0x1f0)](_0x190ec1[_0x4ef952(0x2b5)]);else{const _0x841a46=_0x4f639d[_0x4ef952(0x34f)]['_id'];delete _0x4f639d[_0x4ef952(0x34f)]['_id'];const _0x1fb236=_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x388)],_0x410b70=_0x499e94[_0x4ef952(0x29c)](Number,_0x4f639d['body']['rpp'])||0x14,_0x9fb44a=_0x499e94[_0x4ef952(0x29c)](Number,_0x4f639d['body'][_0x4ef952(0x381)])||0x1;delete _0x4f639d[_0x4ef952(0x34f)]['rpp'],delete _0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x388)],delete _0x4f639d['body'][_0x4ef952(0x381)],_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2b5)]=_0x4f639d['body']['userId']?_0x499e94[_0x4ef952(0x29c)](Number,_0x4f639d['body'][_0x4ef952(0x2b5)]):_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2b5)],_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2ee)]=_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2ee)]?_0x499e94[_0x4ef952(0x29c)](Number,_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2ee)]):_0x4f639d[_0x4ef952(0x34f)]['branchId'];const _0x3d3e0c=_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x24c)]?.[_0x4ef952(0x332)](),_0x12b33a=_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x3ce)]?.[_0x4ef952(0x332)](),_0x4be9fa=_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2b5)],_0x3f045c=''+$,_0x248bab=$+_0x4ef952(0x1eb)+_0x1fb236+_0x4ef952(0x217)+_0x410b70+'&page='+_0x9fb44a+_0x4ef952(0x3ba)+_0x841a46;if(!new RegExp(USERNAME_PATTERN)[_0x4ef952(0x1f1)](_0x3d3e0c))return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x1b5)],_0x4f639d[_0x4ef952(0x34f)]),_0x4f639d['flash'](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x1ad)],'text':USERNAME_DESCRIPTION}),_0x485555[_0x4ef952(0x3a0)](_0x248bab);if(_0x12b33a&&!new RegExp(EMAIL_PATTERN)[_0x4ef952(0x1f1)](_0x12b33a))return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x1b5)],_0x4f639d[_0x4ef952(0x34f)]),_0x4f639d['flash'](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x1ad)],'text':_0x499e94['RLWPd']}),_0x485555[_0x4ef952(0x3a0)](_0x248bab);const _0x2ac52e=new _0x49ccbe(dbUrl);try{if(_0x499e94[_0x4ef952(0x2e1)](_0x499e94[_0x4ef952(0x27c)],_0x499e94[_0x4ef952(0x2c0)]))_0x2cc9d4[_0x4ef952(0x222)](_0x418e90[_0x4ef952(0x2bd)],_0x2d814e[_0x4ef952(0x29a)]),_0x17d3f0[_0x4ef952(0x3bd)](_0x793393[_0x4ef952(0x1f6)]({'isPrint':!0x1,'class':_0x418e90['nsZCv'],'msg':_0x336698[_0x4ef952(0x29a)]}));else{await _0x2ac52e[_0x4ef952(0x2c2)]();const _0x494de3=_0x2ac52e['db'](dbName),_0x11b3e6=_0x494de3[_0x4ef952(0x37c)](dbColl_users);if(_0x841a46){if(_0x499e94[_0x4ef952(0x2e3)](_0x499e94[_0x4ef952(0x1d4)],_0x499e94[_0x4ef952(0x1d4)])){var _0xb72609=await _0x11b3e6[_0x4ef952(0x230)]({'_id':{'$ne':new _0x79faf4(_0x841a46)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x12b33a+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x3d3e0c+'$','i')}},{'userId':_0x4be9fa}]});if(_0xb72609)return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x1b5)],_0x4f639d[_0x4ef952(0x34f)]),_0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x1ad)],'text':_0x499e94[_0x4ef952(0x281)]}),_0x485555['redirect'](_0x248bab);const _0x4e35c6=await _0x11b3e6[_0x4ef952(0x230)]({'_id':new _0x79faf4(_0x841a46)}),_0x49f0ff=[_0x499e94['bobks'](_0x4f639d[_0x4ef952(0x34f)]['userIsActive'],_0x499e94[_0x4ef952(0x377)]),_0x499e94[_0x4ef952(0x1ab)](_0x4e35c6['username'],_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x24c)]),_0x499e94[_0x4ef952(0x392)](_0x4e35c6['userEmail'],_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x3ce)]),_0x499e94[_0x4ef952(0x1da)](_0x4e35c6['userAuthority'],_0x4f639d[_0x4ef952(0x34f)]['userAuthority']),_0x499e94['bobks'](_0x4e35c6['branchId'],_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2ee)])],_0x595eda={'$set':_0x4f639d[_0x4ef952(0x34f)]},_0x3a2a86=await _0x11b3e6[_0x4ef952(0x356)]({'_id':new _0x79faf4(_0x841a46)},_0x595eda,{'upsert':!0x1});if(_0x3a2a86[_0x4ef952(0x2f3)]&&_0x499e94[_0x4ef952(0x1ab)](_0x3a2a86[_0x4ef952(0x2e7)],0x1)){if(_0x499e94['JUjIP'](_0x499e94[_0x4ef952(0x39e)],_0x499e94[_0x4ef952(0x378)])){const _0x3044de=J[_0x4ef952(0x254)](_0x4f639d);let _0x474444=_0x4ef952(0x3b0)+_0x4be9fa+_0x4ef952(0x241);const _0x17e060=B[_0x4ef952(0x263)](_0x4e35c6,_0x4f639d['body']);if(_0x17e060&&_0x499e94[_0x4ef952(0x20d)](_0x17e060['length'],0x0)){if(_0x499e94[_0x4ef952(0x2e1)](_0x499e94[_0x4ef952(0x215)],_0x499e94[_0x4ef952(0x215)])){const _0x2a9abb={'dateTime':O[_0x4ef952(0x2f2)](),'userId':_0x3044de[_0x4ef952(0x2b5)],'userFullname':_0x3044de[_0x4ef952(0x384)],'changes':_0x17e060};await _0x11b3e6[_0x4ef952(0x356)]({'userId':_0x4be9fa},{'$push':{'changesHistory':{'$each':[_0x2a9abb],'$position':0x0}}}),_0x474444+=_0x499e94[_0x4ef952(0x1ae)];}else{if(_0x1f7521){const _0x20885d=_0xf90f4b['apply'](_0x11763c,arguments);return _0x5d8d25=null,_0x20885d;}}}if(_0x49f0ff[_0x4ef952(0x350)](!0x1)){if(_0x499e94['lYSdA'](_0x499e94[_0x4ef952(0x2af)],_0x499e94['fCdwV']))_0x407395['close']();else{const _0x6ba27=await _0x494de3[_0x4ef952(0x37c)](global[_0x4ef952(0x242)])[_0x4ef952(0x2d2)]({'session.user_id':_0x841a46});_0x6ba27['acknowledged']&&_0x499e94[_0x4ef952(0x20d)](_0x6ba27['deletedCount'],0x0)?_0x474444+=_0x4ef952(0x243)+_0x6ba27['deletedCount']+_0x4ef952(0x2e0):_0x474444+=_0x499e94['KzUPG'];}}if(_0x49f0ff[_0x4ef952(0x350)](!0x1)&&_0x499e94[_0x4ef952(0x1ab)](_0x3044de['user_id'],_0x841a46)){if(_0x499e94[_0x4ef952(0x1e1)](_0x499e94[_0x4ef952(0x2cc)],_0x499e94[_0x4ef952(0x2c1)])){_0x4f639d[_0x4ef952(0x3cf)][_0x4ef952(0x21c)](_0x2d3684=>(_0x2d3684&&console[_0x4ef952(0x222)](_0x4ef952(0x300),_0x2d3684),_0x485555[_0x4ef952(0x3a0)]('/')));return;}else _0x495e08[_0x4ef952(0x270)]();}else return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94['RPGso'],'text':_0x474444}),_0x485555[_0x4ef952(0x3a0)](_0x248bab);}else{if(_0x5cce8d){const _0x995a70=_0x88ed00[_0x4ef952(0x262)](_0x3e48be,arguments);return _0x3b71cb=null,_0x995a70;}}}else return _0x3a2a86[_0x4ef952(0x2f3)]&&(_0x499e94[_0x4ef952(0x38b)](_0x3a2a86[_0x4ef952(0x2e7)],0x1)||_0x499e94['FDNZg'](_0x3a2a86['upsertedCount'],0x1))?(_0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x219)],'text':'\x22'+_0x4be9fa+'\x22\x20ไม่มีอะไรเปลี่ยนแปลง'}),_0x485555[_0x4ef952(0x3a0)](_0x248bab)):(_0x4f639d[_0x4ef952(0x35a)](_0x499e94['TfiAc'],_0x4f639d[_0x4ef952(0x34f)]),_0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94['YmoVe'],'text':new Error(_0x499e94['MkhVV'])+_0x4ef952(0x1b9)+_0x4be9fa+'\x22'}),_0x485555['redirect'](_0x248bab));}else return _0x48f284[_0x4ef952(0x222)](_0x3daacb[_0x4ef952(0x29a)]),_0x4229a0['flash'](_0x418e90[_0x4ef952(0x398)],{'class':_0x418e90[_0x4ef952(0x3a4)],'text':''+_0x2dda46['message']}),_0x26f436[_0x4ef952(0x3a0)](_0x141b6c);}else{if(_0x499e94[_0x4ef952(0x2e3)](_0x499e94[_0x4ef952(0x348)],_0x499e94[_0x4ef952(0x21b)])){const _0x373e22=_0x27067f?function(){if(_0x102076){const _0x5968b8=_0x303fd0['apply'](_0x41e2ef,arguments);return _0x2de7d9=null,_0x5968b8;}}:function(){};return _0x26111c=![],_0x373e22;}else{if(await _0x11b3e6[_0x4ef952(0x230)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x12b33a+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x3d3e0c+'$','i')}}]}))return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x1b5)],_0x4f639d['body']),_0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x1ad)],'text':_0x499e94[_0x4ef952(0x232)]}),_0x485555['redirect'](_0x248bab);const _0x479a64=await _0x11b3e6[_0x4ef952(0x375)]({},{'projection':{'userId':0x1}})[_0x4ef952(0x24a)]({'userId':-0x1})['limit'](0x1)['toArray'](),_0x37cdd4=_0x499e94[_0x4ef952(0x3b3)](_0x479a64[_0x4ef952(0x347)],0x0)?_0x499e94['pakcW'](_0x479a64[0x0][_0x4ef952(0x2b5)],0x1):0x3e8;_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x2b5)]=_0x37cdd4,_0x4f639d[_0x4ef952(0x34f)][_0x4ef952(0x394)]=O['getDateTime'](0x5a0);const _0x3cdd84=H['generatePassword']();_0x4f639d[_0x4ef952(0x34f)]['userPassword']=await _0x2528a9[_0x4ef952(0x366)](_0x3cdd84,global[_0x4ef952(0x2e9)]);const _0x3af5cb=await _0x11b3e6['insertOne'](_0x4f639d[_0x4ef952(0x34f)]);if(_0x3af5cb['acknowledged']&&_0x3af5cb[_0x4ef952(0x29f)]){if(_0x499e94['TCqaB'](_0x499e94[_0x4ef952(0x3be)],_0x499e94[_0x4ef952(0x200)])){const _0x1021dc=_0x3af5cb[_0x4ef952(0x29f)]['toString'](),_0xcc4647=$+_0x4ef952(0x1eb)+_0x1fb236+_0x4ef952(0x217)+_0x410b70+_0x4ef952(0x20a)+_0x9fb44a+_0x4ef952(0x3ba)+_0x1021dc,_0x2493c9={..._0x4f639d['body']};if(delete _0x2493c9[_0x4ef952(0x238)],_0x12b33a[_0x4ef952(0x350)]('@')&&_0x12b33a[_0x4ef952(0x350)]('.')&&_0x499e94[_0x4ef952(0x258)](_0x12b33a[_0x4ef952(0x347)],0x5))te[_0x4ef952(0x1fd)](_0x2493c9,_0x3cdd84)['then'](_0x4f60bb=>(_0x4f639d[_0x4ef952(0x35a)](_0x4ef952(0x2b9),{'class':_0x4ef952(0x36e),'text':_0x4ef952(0x309)+_0x12b33a+_0x4ef952(0x1ee)+_0x4f60bb[_0x4ef952(0x3aa)]+')'}),_0x485555['redirect'](_0xcc4647)))[_0x4ef952(0x301)](_0x4a1178=>(_0x4f639d[_0x4ef952(0x35a)](_0x4ef952(0x260),_0x4f639d[_0x4ef952(0x34f)]),_0x4f639d['flash'](_0x4ef952(0x2b9),{'class':_0x4ef952(0x295),'text':''+_0x4a1178['message']}),_0x485555[_0x4ef952(0x3a0)](_0xcc4647)));else return _0x4f639d[_0x4ef952(0x35a)](_0x499e94[_0x4ef952(0x1b5)],_0x4f639d['body']),_0x4f639d['flash'](_0x499e94['enOoM'],{'class':_0x499e94[_0x4ef952(0x3c9)],'text':_0x4ef952(0x257)+_0x12b33a}),_0x485555[_0x4ef952(0x3a0)](_0xcc4647);}else{const _0x4d4643=new _0x3ce243(RwUsbm['kiAhk']),_0x30a51e=new _0x5e0328(RwUsbm[_0x4ef952(0x35d)],'i'),_0x5bdd76=RwUsbm[_0x4ef952(0x29c)](_0xed1c38,RwUsbm['AzKOI']);!_0x4d4643[_0x4ef952(0x1f1)](RwUsbm['MWqXj'](_0x5bdd76,RwUsbm[_0x4ef952(0x2f1)]))||!_0x30a51e['test'](RwUsbm['dMgit'](_0x5bdd76,RwUsbm[_0x4ef952(0x302)]))?RwUsbm[_0x4ef952(0x29c)](_0x5bdd76,'0'):RwUsbm[_0x4ef952(0x250)](_0x1ea4e1);}}else _0x4f639d['flash'](_0x499e94[_0x4ef952(0x3b7)],{'class':_0x499e94[_0x4ef952(0x1ad)],'text':_0x499e94[_0x4ef952(0x277)]}),_0x485555[_0x4ef952(0x3a0)](_0x3f045c);}}}}catch(_0x2780aa){if(_0x499e94[_0x4ef952(0x246)](_0x499e94[_0x4ef952(0x1e2)],_0x499e94[_0x4ef952(0x1e2)]))console[_0x4ef952(0x222)](_0x499e94[_0x4ef952(0x393)],_0x2780aa),_0x485555['status'](0x194)[_0x4ef952(0x2dd)](file404);else{const _0x467391=_0x5d5616?function(){const _0x44e46d=_0x4ef952;if(_0x39e123){const _0x3c0a25=_0x566a43[_0x44e46d(0x262)](_0x393cb0,arguments);return _0x51f9f4=null,_0x3c0a25;}}:function(){};return _0x1bf4b7=![],_0x467391;}}finally{_0x499e94[_0x4ef952(0x396)](_0x499e94[_0x4ef952(0x239)],_0x499e94['qhRgB'])?_0x2ac52e[_0x4ef952(0x270)]():_0x5a1b64[_0x4ef952(0x270)]();}}};_0xe91382[_0x2fd1d7(0x2d1)]({'req':_0x159603,'res':_0x3530f8}),_0x3be9ba||_0x499e94[_0x2fd1d7(0x325)](_0x3ac680);}),S[_0x9698ac(0x31a)](X,_0x48d915[_0x9698ac(0x218)],async(_0xcd543f,_0x59e4ca)=>{const _0x1bf691=_0x9698ac,_0x492985={'Xjwmg':function(_0x342054,_0x2ac641){return _0x342054(_0x2ac641);},'oAPyW':function(_0x283eef,_0x625cd6){return _0x283eef+_0x625cd6;},'RmzPP':_0x1bf691(0x308),'YsQVM':_0x1bf691(0x2fc),'rXyXK':function(_0x6f9bc0){return _0x6f9bc0();},'FUzsZ':_0x1bf691(0x222),'ASVRd':_0x1bf691(0x2c6),'KaNPg':_0x1bf691(0x33c),'RwCWw':_0x1bf691(0x252),'ZkGhk':_0x1bf691(0x1b2),'tGRrD':_0x1bf691(0x338),'TrKQp':_0x1bf691(0x2d8),'pWvmO':function(_0x428f0d,_0x356fc3){return _0x428f0d<_0x356fc3;},'WmmGP':function(_0x35e8e3,_0x59613f){return _0x35e8e3(_0x59613f);},'FeQJe':function(_0x36ee8a,_0x122bc3){return _0x36ee8a(_0x122bc3);},'xaiGY':function(_0x4463c7,_0x40fb4b){return _0x4463c7(_0x40fb4b);},'DZJhj':function(_0x189efc,_0x58c7fa){return _0x189efc(_0x58c7fa);},'LdiBi':function(_0x17f6a7,_0x44a29e){return _0x17f6a7!=_0x44a29e;},'CnMeN':function(_0x482739,_0x3fdaf4){return _0x482739===_0x3fdaf4;},'BoEUw':_0x1bf691(0x335),'LYPRH':'userId','dklNW':function(_0x4624fc,_0x40790e){return _0x4624fc!==_0x40790e;},'HVmjs':_0x1bf691(0x296),'uSpts':_0x1bf691(0x275),'ccFEM':_0x1bf691(0x2b9),'rZYXC':'red','zGJxy':'prPMU','yqWuI':_0x1bf691(0x1fb),'NdZAh':function(_0x2b4bb7,_0x248113){return _0x2b4bb7>_0x248113;},'xAmso':_0x1bf691(0x3a1),'suuoL':_0x1bf691(0x36e),'SVmUr':function(_0x2e20b7,_0x25760d){return _0x2e20b7!==_0x25760d;},'fqxba':_0x1bf691(0x1e8),'bdpIr':_0x1bf691(0x22a),'PcqmO':_0x1bf691(0x344)};let {_id_toDelete:_0x2776ad,load_id:_0x31b6f5,sip:_0x32a1aa,Id_toDelete:_0x21f28e}=_0xcd543f[_0x1bf691(0x34f)];const _0x32ad28=_0x492985[_0x1bf691(0x23a)](Number,_0xcd543f[_0x1bf691(0x34f)]['rpp'])||0x14,_0x112062=_0x492985[_0x1bf691(0x1c0)](Number,_0xcd543f[_0x1bf691(0x34f)][_0x1bf691(0x381)])||0x1;_0x21f28e=_0x492985['DZJhj'](Number,_0x21f28e);const _0x2ba6c7=_0x2776ad&&_0x492985[_0x1bf691(0x1dd)](_0x2776ad,_0x31b6f5)?'&load_id='+_0x2776ad:'',_0x519e90=$+_0x1bf691(0x1eb)+_0x32a1aa+_0x1bf691(0x217)+_0x32ad28+'&page='+_0x112062+_0x2ba6c7,_0x55fd10=new _0x49ccbe(global['dbUrl']);try{if(_0x492985[_0x1bf691(0x3cc)](_0x492985['BoEUw'],_0x492985[_0x1bf691(0x1ac)])){await _0x55fd10['connect']();const _0x40488e=_0x55fd10['db'](global[_0x1bf691(0x29e)]),_0x50ce0d=_0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x2a5)]),_0x27c9e6=[{'coll':_0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x1c8)]),'name':global['dbColl_warehouseIn'],'key':_0x492985[_0x1bf691(0x1d7)]},{'coll':_0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x1b7)]),'name':global[_0x1bf691(0x1b7)],'key':_0x492985[_0x1bf691(0x1d7)]},{'coll':_0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x23f)]),'name':global['dbColl_sales'],'key':_0x492985['LYPRH']},{'coll':_0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x282)]),'name':global[_0x1bf691(0x282)],'key':_0x492985[_0x1bf691(0x1d7)]}];for(const {coll:_0x4bd342,name:_0x1886d2,key:_0x1f2555}of _0x27c9e6){if(_0x492985[_0x1bf691(0x2dc)](_0x492985[_0x1bf691(0x2f0)],_0x492985[_0x1bf691(0x333)])){const _0x4f47e8={};if(_0x4f47e8[_0x1f2555]=_0x21f28e,await _0x4bd342['findOne'](_0x4f47e8))return await _0x50ce0d[_0x1bf691(0x356)]({'userId':_0x21f28e},{'$set':{'canDelete':!0x1}}),_0xcd543f[_0x1bf691(0x35a)](_0x492985['ccFEM'],{'class':_0x492985[_0x1bf691(0x3b9)],'text':_0x1bf691(0x386)+_0x21f28e+_0x1bf691(0x349)+_0x1886d2+'{{sep}}ไม่สามารถลบได้'}),_0x59e4ca[_0x1bf691(0x3a0)](_0x519e90);}else{let _0x434ace;try{const _0x483a8c=sUHFwC[_0x1bf691(0x3cd)](_0x2a52b0,sUHFwC[_0x1bf691(0x2b1)](sUHFwC[_0x1bf691(0x2b1)](sUHFwC['RmzPP'],sUHFwC['YsQVM']),');'));_0x434ace=sUHFwC[_0x1bf691(0x3c7)](_0x483a8c);}catch(_0x3e7c36){_0x434ace=_0x165fba;}const _0xd16a67=_0x434ace[_0x1bf691(0x2fa)]=_0x434ace['console']||{},_0x5c159d=[sUHFwC['FUzsZ'],sUHFwC[_0x1bf691(0x33d)],sUHFwC[_0x1bf691(0x2bc)],sUHFwC[_0x1bf691(0x343)],sUHFwC[_0x1bf691(0x1dc)],sUHFwC[_0x1bf691(0x33e)],sUHFwC['TrKQp']];for(let _0x41834b=0x0;sUHFwC['pWvmO'](_0x41834b,_0x5c159d[_0x1bf691(0x347)]);_0x41834b++){const _0x498757=_0x37fea4['constructor'][_0x1bf691(0x316)][_0x1bf691(0x248)](_0x329075),_0x49333c=_0x5c159d[_0x41834b],_0x5e4afb=_0xd16a67[_0x49333c]||_0x498757;_0x498757[_0x1bf691(0x21d)]=_0x5b45bb[_0x1bf691(0x248)](_0x4a001d),_0x498757[_0x1bf691(0x2d0)]=_0x5e4afb['toString'][_0x1bf691(0x248)](_0x5e4afb),_0xd16a67[_0x49333c]=_0x498757;}}}if(_0x492985[_0x1bf691(0x3cc)]((await _0x50ce0d[_0x1bf691(0x364)]({'_id':new _0x79faf4(_0x2776ad)}))['deletedCount'],0x1)){if(_0x492985[_0x1bf691(0x3cc)](_0x492985[_0x1bf691(0x1cb)],_0x492985[_0x1bf691(0x287)]))_0x40cb3c[_0x1bf691(0x222)](_0x279fca[_0x1bf691(0x29a)]),_0x4f363d[_0x1bf691(0x25b)](0x194)['sendFile'](_0x45264f);else{const _0x1195a1=await _0x40488e[_0x1bf691(0x37c)](global[_0x1bf691(0x242)])[_0x1bf691(0x2d2)]({'session.user_id':_0x2776ad});if(_0x1195a1[_0x1bf691(0x2f3)]&&_0x492985[_0x1bf691(0x399)](_0x1195a1[_0x1bf691(0x236)],0x0))var _0x389394='{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22'+_0x1195a1['deletedCount']+_0x1bf691(0x2e0);else var _0x389394=_0x492985[_0x1bf691(0x34e)];_0xcd543f[_0x1bf691(0x35a)](_0x492985[_0x1bf691(0x38a)],{'class':_0x492985[_0x1bf691(0x22d)],'text':'ลบยูสเซอร์\x20\x22'+_0x21f28e+_0x1bf691(0x241)+_0x389394});}}else _0xcd543f['flash'](_0x492985[_0x1bf691(0x38a)],{'class':_0x492985[_0x1bf691(0x3b9)],'text':_0x1bf691(0x297)+_0x21f28e+_0x1bf691(0x3bc)});return _0x59e4ca[_0x1bf691(0x3a0)](_0x519e90);}else sUHFwC[_0x1bf691(0x1c0)](_0x53a38a,0x0);}catch(_0x388fba){if(_0x492985[_0x1bf691(0x22c)](_0x492985['fqxba'],_0x492985[_0x1bf691(0x2eb)]))sUHFwC[_0x1bf691(0x2c4)](_0x402f6b,'0');else return console[_0x1bf691(0x222)](_0x492985[_0x1bf691(0x294)],_0x388fba),_0xcd543f[_0x1bf691(0x35a)](_0x492985[_0x1bf691(0x38a)],{'class':_0x492985[_0x1bf691(0x3b9)],'text':_0x388fba[_0x1bf691(0x29a)]}),_0x59e4ca[_0x1bf691(0x3a0)](_0x519e90);}finally{if(_0x492985[_0x1bf691(0x3cc)](_0x492985[_0x1bf691(0x3d3)],_0x492985[_0x1bf691(0x3d3)]))_0x55fd10[_0x1bf691(0x270)]();else{const _0x2fca3b=_0x147845[_0x1bf691(0x262)](_0xc0d4c4,arguments);return _0x4656dd=null,_0x2fca3b;}}}),S[_0x9698ac(0x31a)](G,_0x48d915[_0x9698ac(0x218)],async(_0x1a850d,_0x505ead)=>{const _0x2b17f2=_0x9698ac,_0x854b39={'NtOXN':function(_0x7dfdc,_0x5262d5){return _0x7dfdc(_0x5262d5);},'oknSy':function(_0x2d3ea5,_0x42c88f){return _0x2d3ea5!==_0x42c88f;},'zqftj':_0x2b17f2(0x289),'YsrKY':_0x2b17f2(0x2ee),'Mgmmf':_0x2b17f2(0x3a6),'akXhP':_0x2b17f2(0x320),'JEAWS':function(_0x1d7a49,_0x25cbf8){return _0x1d7a49==_0x25cbf8;},'qhfJM':_0x2b17f2(0x295),'SiZTN':_0x2b17f2(0x21a),'XKNdF':_0x2b17f2(0x2db),'KHbTd':_0x2b17f2(0x3c2),'kPWkT':_0x2b17f2(0x36e),'hCxrP':function(_0x21e987,_0x58e32d){return _0x21e987!==_0x58e32d;},'AVHUv':_0x2b17f2(0x32f),'eWaCf':'oKDqq','xWjup':'error\x20===>\x20','oblzk':function(_0x5c2b54,_0x1a8b7a){return _0x5c2b54===_0x1a8b7a;},'WXXRS':_0x2b17f2(0x298),'TZxwA':_0x2b17f2(0x30e)},{_idArr:_0x30ec36}=_0x1a850d[_0x2b17f2(0x34f)],_0x4ebcf5=new _0x49ccbe(dbUrl);try{if(_0x854b39['oknSy'](_0x854b39[_0x2b17f2(0x37d)],_0x854b39[_0x2b17f2(0x37d)])){const _0x3b9a1b=_0x472b7b['apply'](_0xf4fd36,arguments);return _0x14dd46=null,_0x3b9a1b;}else{await _0x4ebcf5[_0x2b17f2(0x2c2)]();const _0x5b1549=await _0x4ebcf5['db'](dbName)['collection'](dbColl_users)[_0x2b17f2(0x2df)]([{'$match':{'_id':{'$in':_0x30ec36[_0x2b17f2(0x25a)](_0x35ad2c=>new _0x79faf4(_0x35ad2c))}}},{'$lookup':{'from':global[_0x2b17f2(0x210)],'localField':_0x854b39[_0x2b17f2(0x22b)],'foreignField':_0x854b39[_0x2b17f2(0x22b)],'as':_0x854b39[_0x2b17f2(0x1ed)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x854b39[_0x2b17f2(0x2c9)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])[_0x2b17f2(0x1b0)]();if(_0x854b39[_0x2b17f2(0x1d2)](_0x5b1549['length'],0x0))return _0x505ead[_0x2b17f2(0x3bd)](JSON[_0x2b17f2(0x1f6)]({'isPrint':!0x1,'class':_0x854b39[_0x2b17f2(0x2c3)],'msg':_0x854b39[_0x2b17f2(0x385)]}));const _0x4dd213=_0x5b0c1c[_0x2b17f2(0x20c)](global[_0x2b17f2(0x1ce)],_0x854b39[_0x2b17f2(0x2d5)]),_0x552596=_0x462fc2['readFileSync'](_0x4dd213,_0x854b39[_0x2b17f2(0x28a)]),_0x2d23f0=_0x57c634[_0x2b17f2(0x2a6)](_0x552596,{'time':O[_0x2b17f2(0x23d)](),'title':_0x2b17f2(0x299)+_0x5b1549[_0x2b17f2(0x347)]+')','dateTime':O[_0x2b17f2(0x2f2)](),'usersFind':_0x5b1549});_0x505ead[_0x2b17f2(0x3bd)](JSON[_0x2b17f2(0x1f6)]({'isPrint':!0x0,'class':_0x854b39[_0x2b17f2(0x32c)],'msg':_0x2b17f2(0x3c3)+_0x5b1549[_0x2b17f2(0x347)]+_0x2b17f2(0x27b),'htmlPage':_0x2d23f0}));}}catch(_0x39db41){if(_0x854b39[_0x2b17f2(0x285)](_0x854b39[_0x2b17f2(0x319)],_0x854b39[_0x2b17f2(0x372)]))console['log'](_0x854b39[_0x2b17f2(0x3ad)],_0x39db41[_0x2b17f2(0x29a)]),_0x505ead[_0x2b17f2(0x3bd)](JSON[_0x2b17f2(0x1f6)]({'isPrint':!0x1,'class':_0x854b39['qhfJM'],'msg':_0x39db41[_0x2b17f2(0x29a)]}));else{const _0x231347=_0x2bf46f?new _0x38bc01(''+_0x479d6d,'i'):new _0x348f2b('.*');let _0x5e16e8={};_0x854b39[_0x2b17f2(0x2cf)](_0x5b598b,_0x854b39[_0x2b17f2(0x2cf)](_0x2dfdae,_0x4b66f4))?_0x5e16e8={'userId':{'$regex':_0x231347}}:_0x5e16e8={'userId':_0x854b39[_0x2b17f2(0x2cf)](_0x4f055f,_0x3cf5a4)},_0x1b853b[_0x2b17f2(0x2cb)]({'$match':{'$or':[_0x5e16e8,{'username':{'$regex':_0x231347}},{'userFirstname':{'$regex':_0x231347}}]}});}}finally{if(_0x854b39['oblzk'](_0x854b39[_0x2b17f2(0x354)],_0x854b39['TZxwA'])){_0x11faca=!0x1;return;}else _0x4ebcf5['close']();}}),S['post'](V,_0x48d915['isOS'],async(_0x1d0b35,_0x151595)=>{const _0x2205ef=_0x9698ac,_0x2213c5={'xTeDK':function(_0x309fd4,_0x322995){return _0x309fd4+_0x322995;},'XgBNa':_0x2205ef(0x21e),'gXIlW':_0x2205ef(0x34d),'KPAFd':_0x2205ef(0x204),'mijIl':function(_0x37220a,_0x3ac527){return _0x37220a(_0x3ac527);},'APmlr':function(_0x22d746,_0x6da86a){return _0x22d746===_0x6da86a;},'YewbP':_0x2205ef(0x3c6),'apHtC':'red','ZEagz':function(_0x3ade58,_0x531b59){return _0x3ade58<_0x531b59;},'djJCd':_0x2205ef(0x3da),'ojXTs':_0x2205ef(0x292),'ftruv':_0x2205ef(0x23b),'EBTqY':_0x2205ef(0x36e),'cbyOh':function(_0x311d6a,_0x43e740){return _0x311d6a===_0x43e740;},'aXWja':_0x2205ef(0x2a2),'zcnNo':_0x2205ef(0x22a),'TTboQ':_0x2205ef(0x371)};let {userId:_0x43e605}=_0x1d0b35[_0x2205ef(0x34f)];_0x43e605=_0x2213c5['mijIl'](Number,_0x43e605);const _0x1463b3=new _0x49ccbe(global['dbUrl']);try{if(_0x2213c5[_0x2205ef(0x1fe)](_0x2213c5[_0x2205ef(0x221)],_0x2213c5[_0x2205ef(0x221)])){await _0x1463b3[_0x2205ef(0x2c2)]();var _0xe908ad=await _0x1463b3['db'](global[_0x2205ef(0x29e)])['collection'](global[_0x2205ef(0x2a5)])[_0x2205ef(0x230)]({'userId':_0x43e605});if(!_0xe908ad)return _0x151595[_0x2205ef(0x3bd)](JSON['stringify']({'isPrint':!0x1,'class':_0x2213c5[_0x2205ef(0x1d3)],'msg':_0x2205ef(0x297)+_0x43e605+'\x22'}));const _0x242a8d=_0xe908ad[_0x2205ef(0x362)]||[];if(_0x2213c5[_0x2205ef(0x2e5)](_0x242a8d['length'],0x1))return _0x151595['send'](JSON[_0x2205ef(0x1f6)]({'isPrint':!0x1,'class':_0x2213c5['djJCd'],'msg':_0x2213c5[_0x2205ef(0x20b)]}));const _0x459240=_0x5b0c1c['join'](folderForms,_0x2213c5['ftruv']),_0x754745=await H['renderView'](_0x459240,_0x151595,{'title':_0x2205ef(0x207)+_0xe908ad[_0x2205ef(0x2b5)]+']\x20'+_0xe908ad[_0x2205ef(0x1c5)]+'\x20'+_0xe908ad[_0x2205ef(0x1d5)]+'\x20'+_0xe908ad[_0x2205ef(0x3bf)],'time':O[_0x2205ef(0x2f2)](),'changesHistory':_0x242a8d});_0x151595[_0x2205ef(0x3bd)](JSON[_0x2205ef(0x1f6)]({'isPrint':!0x0,'class':_0x2213c5['EBTqY'],'htmlPage':_0x754745}));}else(function(){return![];}['constructor'](FPLWRq[_0x2205ef(0x2ba)](FPLWRq[_0x2205ef(0x276)],FPLWRq['gXIlW']))[_0x2205ef(0x262)](FPLWRq[_0x2205ef(0x2a1)]));}catch(_0x1cfb8b){_0x2213c5[_0x2205ef(0x2c5)](_0x2213c5[_0x2205ef(0x2b3)],_0x2213c5['aXWja'])?(console[_0x2205ef(0x222)](_0x2213c5[_0x2205ef(0x3d2)],_0x1cfb8b),_0x151595['send'](JSON[_0x2205ef(0x1f6)]({'isPrint':!0x1,'class':_0x2213c5[_0x2205ef(0x1d3)],'msg':_0x1cfb8b[_0x2205ef(0x29a)]}))):_0x170ba0[_0x2205ef(0x270)]();}finally{_0x2213c5['cbyOh'](_0x2213c5[_0x2205ef(0x2b4)],_0x2213c5[_0x2205ef(0x2b4)])?_0x1463b3[_0x2205ef(0x270)]():_0x103900[_0x2205ef(0x270)]();}}),S['post'](W,_0x48d915[_0x9698ac(0x218)],async(_0x3f53bd,_0x4a70ec)=>{const _0x1155d=_0x9698ac,_0x35b5f7={'FBnKW':function(_0x16c5e1,_0x31871a){return _0x16c5e1(_0x31871a);},'jCQgP':function(_0x1cfdf7){return _0x1cfdf7();},'KhhgW':_0x1155d(0x340),'NVPjQ':_0x1155d(0x2f8),'oPpOk':function(_0x5a1ee9,_0x25fbdf){return _0x5a1ee9(_0x25fbdf);},'eVRmE':_0x1155d(0x1a9),'CKWAq':function(_0x2f6c69,_0x1a5605){return _0x2f6c69+_0x1a5605;},'PIsGY':_0x1155d(0x26a),'JgKNR':function(_0x2684ff,_0x172c92){return _0x2684ff+_0x172c92;},'hTUdL':'input','lroBA':function(_0x412123,_0x57c4e1){return _0x412123(_0x57c4e1);},'shQPw':function(_0x4a548a,_0x3e9982,_0x4229c8){return _0x4a548a(_0x3e9982,_0x4229c8);},'CAaHm':function(_0x4d5215,_0x3c70e2){return _0x4d5215===_0x3c70e2;},'BcncT':_0x1155d(0x310),'sYyiB':_0x1155d(0x271),'YadEk':function(_0x2c1bb8,_0x1b7bdf){return _0x2c1bb8==_0x1b7bdf;},'KbmlZ':_0x1155d(0x295),'SInne':_0x1155d(0x21a),'jfxcH':_0x1155d(0x2d4),'ifTIz':_0x1155d(0x1fa),'RhMso':_0x1155d(0x273),'ZDrAd':_0x1155d(0x36e),'EIikz':_0x1155d(0x31d),'RbXGR':_0x1155d(0x330),'CerBU':function(_0x269759,_0x1f699b){return _0x269759!==_0x1f699b;},'asHMd':_0x1155d(0x2f9),'trRKA':function(_0x72d906,_0x3918f1){return _0x72d906!==_0x3918f1;},'Kortg':'IYkda'},_0x27f923=new _0x49ccbe(dbUrl);try{if(_0x35b5f7[_0x1155d(0x24b)](_0x35b5f7[_0x1155d(0x1de)],_0x35b5f7[_0x1155d(0x1de)])){await _0x27f923[_0x1155d(0x2c2)]();const _0x6fac79=await _0x27f923['db'](dbName)[_0x1155d(0x37c)](dbColl_users)['aggregate']([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x35b5f7['sYyiB'],[]]}}}},{'$sort':{'userId':0x1}}])[_0x1155d(0x1b0)]();if(_0x35b5f7['YadEk'](_0x6fac79[_0x1155d(0x347)],0x0))return _0x4a70ec[_0x1155d(0x3bd)](JSON[_0x1155d(0x1f6)]({'isDownload':!0x1,'class':_0x35b5f7[_0x1155d(0x2da)],'msg':_0x35b5f7['SInne']}));const _0x42cbd8=_0x1155d(0x2a8)+O[_0x1155d(0x2f2)]()[_0x1155d(0x22e)](/[: ]/g,'-')+_0x1155d(0x2f5),_0x2fa013=_0x1c1f4c['utils'][_0x1155d(0x1c4)](_0x6fac79),_0x288929=_0x1c1f4c[_0x1155d(0x249)][_0x1155d(0x3c8)]();_0x1c1f4c[_0x1155d(0x249)]['book_append_sheet'](_0x288929,_0x2fa013,_0x35b5f7[_0x1155d(0x1cc)]);const _0xf94c20=_0x1c1f4c['write'](_0x288929,{'type':_0x35b5f7['ifTIz'],'bookType':_0x35b5f7[_0x1155d(0x33a)]});_0x4a70ec[_0x1155d(0x3bd)]({'isDownload':!0x0,'color':_0x35b5f7['ZDrAd'],'msg':_0x35b5f7['EIikz'],'filename':_0x42cbd8,'fileData':_0xf94c20[_0x1155d(0x2d0)](_0x35b5f7[_0x1155d(0x322)])});}else{if(_0x1c6ee7)return _0x404971;else RgGKUL[_0x1155d(0x355)](_0x10578b,0x0);}}catch(_0x57462a){if(_0x35b5f7[_0x1155d(0x3ab)](_0x35b5f7['asHMd'],_0x35b5f7[_0x1155d(0x253)]))RgGKUL[_0x1155d(0x361)](_0xbbe05b);else return _0x4a70ec[_0x1155d(0x3bd)]({'isDownload':!0x1,'color':_0x35b5f7[_0x1155d(0x2da)],'msg':_0x57462a[_0x1155d(0x29a)]});}finally{if(_0x35b5f7[_0x1155d(0x206)](_0x35b5f7[_0x1155d(0x1f7)],_0x35b5f7['Kortg'])){const _0x3c5733={'dKqAe':RgGKUL[_0x1155d(0x2d3)],'NHCib':RgGKUL[_0x1155d(0x2b7)],'GEXCI':function(_0x5879bb,_0x2febe1){const _0x4addaa=_0x1155d;return RgGKUL[_0x4addaa(0x2c8)](_0x5879bb,_0x2febe1);},'CLTCf':RgGKUL[_0x1155d(0x27e)],'sotbb':function(_0x4607e9,_0x584e22){const _0x11f56c=_0x1155d;return RgGKUL[_0x11f56c(0x334)](_0x4607e9,_0x584e22);},'EAMvw':RgGKUL['PIsGY'],'qtxCb':function(_0x1a6234,_0x46bdc4){return RgGKUL['JgKNR'](_0x1a6234,_0x46bdc4);},'Sfdpy':RgGKUL[_0x1155d(0x39b)],'xUQyO':function(_0x455ae9,_0x1802ea){const _0x53cd45=_0x1155d;return RgGKUL[_0x53cd45(0x33f)](_0x455ae9,_0x1802ea);},'KNaxf':function(_0x5d645e){const _0x269a18=_0x1155d;return RgGKUL[_0x269a18(0x361)](_0x5d645e);}};RgGKUL[_0x1155d(0x26d)](_0x3f3e6e,this,function(){const _0x30eeb9=_0x1155d,_0x1112f1=new _0x148a0d(_0x3c5733[_0x30eeb9(0x2f7)]),_0x31399c=new _0x29ac8b(_0x3c5733[_0x30eeb9(0x2ff)],'i'),_0x74a668=_0x3c5733[_0x30eeb9(0x32b)](_0x1af3bd,_0x3c5733[_0x30eeb9(0x1bf)]);!_0x1112f1[_0x30eeb9(0x1f1)](_0x3c5733[_0x30eeb9(0x1f3)](_0x74a668,_0x3c5733['EAMvw']))||!_0x31399c[_0x30eeb9(0x1f1)](_0x3c5733[_0x30eeb9(0x383)](_0x74a668,_0x3c5733[_0x30eeb9(0x269)]))?_0x3c5733[_0x30eeb9(0x314)](_0x74a668,'0'):_0x3c5733[_0x30eeb9(0x307)](_0x324a7e);})();}else _0x27f923[_0x1155d(0x270)]();}});const oe=_0x473d85({'storage':_0x473d85[_0x9698ac(0x235)]()});S[_0x9698ac(0x31a)](Y,_0x48d915[_0x9698ac(0x218)],oe['single'](_0x9698ac(0x327)),async(_0x2869a6,_0x51611a)=>{const _0x3237fe=_0x9698ac,_0x234f3f={'nquaW':function(_0x1a679b,_0xd1cee){return _0x1a679b(_0xd1cee);},'YsIEf':_0x3237fe(0x295),'lRNkS':_0x3237fe(0x255),'qOvGo':_0x3237fe(0x1fa),'cqgbO':'users','UkGHN':function(_0x496704,_0x462fe5){return _0x496704>_0x462fe5;},'lwfPF':_0x3237fe(0x2b5),'pgTfi':_0x3237fe(0x24c),'KPljE':_0x3237fe(0x2ee),'LIVwf':'userIsActive','ETGDI':_0x3237fe(0x2fe),'bbnAK':_0x3237fe(0x3ce),'jJwED':_0x3237fe(0x31f),'PYEJm':_0x3237fe(0x1c5),'bKaHy':_0x3237fe(0x1d5),'OCeVn':_0x3237fe(0x3bf),'aDINA':'dateTimeCanDelete','dLExv':function(_0x3a8470,_0x5446c6){return _0x3a8470>_0x5446c6;},'uMniq':_0x3237fe(0x220),'nndBC':function(_0x296d00,_0x5938f4){return _0x296d00+_0x5938f4;},'gsCPC':function(_0x3392d7,_0x50dcf0){return _0x3392d7===_0x50dcf0;},'QSbiR':function(_0x402c09,_0x197286){return _0x402c09===_0x197286;},'lhVbn':function(_0x4141c2,_0x3abefa){return _0x4141c2===_0x3abefa;},'fygvE':function(_0x497bec,_0x3cfca2){return _0x497bec===_0x3cfca2;},'prhZn':function(_0x4402a2,_0x156fae){return _0x4402a2===_0x156fae;},'qczfh':function(_0x118c2a,_0x3c9c58){return _0x118c2a+_0x3c9c58;},'BaXCF':_0x3237fe(0x2ce),'Fpauv':_0x3237fe(0x36e),'ziXlc':_0x3237fe(0x22a)},_0xd09ce3=new _0x49ccbe(dbUrl);try{if(!_0x2869a6[_0x3237fe(0x3b6)])return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x1,'color':_0x234f3f[_0x3237fe(0x2a7)],'msg':_0x234f3f[_0x3237fe(0x2b2)]});const _0x4f6020=_0x1c1f4c[_0x3237fe(0x30d)](_0x2869a6[_0x3237fe(0x3b6)]['buffer'],{'type':_0x234f3f[_0x3237fe(0x32a)]}),_0x468b5e=[_0x234f3f[_0x3237fe(0x28f)]],_0x55952c=_0x4f6020[_0x3237fe(0x208)],_0x968977=_0x468b5e[_0x3237fe(0x1f8)](_0x5a5bb5=>!_0x55952c[_0x3237fe(0x350)](_0x5a5bb5));if(_0x234f3f[_0x3237fe(0x1f5)](_0x968977[_0x3237fe(0x347)],0x0))return _0x51611a['send']({'isUpload':!0x1,'color':_0x234f3f['YsIEf'],'msg':'ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22'+_0x968977[_0x3237fe(0x20c)](',\x20')+'\x22'});const _0x1b7024=_0x4f6020[_0x3237fe(0x31b)]['users'],_0x5ec95f=_0x1c1f4c[_0x3237fe(0x249)][_0x3237fe(0x321)](_0x1b7024),_0x593856=[_0x234f3f[_0x3237fe(0x231)],_0x234f3f[_0x3237fe(0x1ea)],_0x234f3f[_0x3237fe(0x374)],_0x234f3f[_0x3237fe(0x27f)],_0x234f3f['ETGDI'],_0x234f3f[_0x3237fe(0x23c)],_0x234f3f[_0x3237fe(0x1e5)],_0x234f3f[_0x3237fe(0x284)],_0x234f3f[_0x3237fe(0x3a7)],_0x234f3f[_0x3237fe(0x28e)],_0x234f3f[_0x3237fe(0x1b4)]][_0x3237fe(0x1f8)](_0x12e809=>!_0x5ec95f[_0x3237fe(0x1d6)](_0x4660a7=>Object[_0x3237fe(0x316)][_0x3237fe(0x2ec)][_0x3237fe(0x1f9)](_0x4660a7,_0x12e809)));if(_0x234f3f['UkGHN'](_0x593856['length'],0x0))return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x1,'color':_0x234f3f[_0x3237fe(0x2a7)],'msg':_0x3237fe(0x304)+_0x593856[_0x3237fe(0x20c)](',\x20')+'\x22'});const _0xea46b3=new Set(),_0x45ae2d=new Set();if(_0x5ec95f[_0x3237fe(0x227)](_0xd5dee3=>{const _0x2858fd=_0x3237fe;_0xea46b3[_0x2858fd(0x2de)](_0xd5dee3[_0x2858fd(0x2b5)])?_0x45ae2d[_0x2858fd(0x1f0)](_0xd5dee3[_0x2858fd(0x2b5)]):_0xea46b3[_0x2858fd(0x1f0)](_0xd5dee3[_0x2858fd(0x2b5)]);}),_0x234f3f[_0x3237fe(0x353)](_0x45ae2d['size'],0x0))return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x1,'color':_0x234f3f[_0x3237fe(0x2a7)],'msg':_0x3237fe(0x38c)+Array[_0x3237fe(0x36f)](_0x45ae2d)[_0x3237fe(0x20c)](',\x20')+'\x22'});const _0x3bf32b=new Set(),_0x251f71=new Set();if(_0x5ec95f['forEach'](_0xf0e2f1=>{const _0x274b00=_0x3237fe;_0x3bf32b[_0x274b00(0x2de)](_0xf0e2f1['username'])?_0x251f71[_0x274b00(0x1f0)](_0xf0e2f1[_0x274b00(0x24c)]):_0x3bf32b['add'](_0xf0e2f1[_0x274b00(0x24c)]);}),_0x234f3f[_0x3237fe(0x353)](_0x251f71[_0x3237fe(0x391)],0x0))return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x1,'color':_0x234f3f['YsIEf'],'msg':_0x3237fe(0x1bc)+Array[_0x3237fe(0x36f)](_0x251f71)[_0x3237fe(0x20c)](',\x20')+'\x22'});const _0x21ed8d=new Set(),_0x3653fb=new Set();if(_0x5ec95f[_0x3237fe(0x227)](_0x1880ae=>{const _0x121caf=_0x3237fe;_0x21ed8d[_0x121caf(0x2de)](_0x1880ae['userEmail'])?_0x3653fb['add'](_0x1880ae[_0x121caf(0x3ce)]):_0x21ed8d[_0x121caf(0x1f0)](_0x1880ae['userEmail']);}),_0x234f3f[_0x3237fe(0x353)](_0x3653fb[_0x3237fe(0x391)],0x0))return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x1,'color':_0x234f3f[_0x3237fe(0x2a7)],'msg':_0x3237fe(0x328)+Array[_0x3237fe(0x36f)](_0x3653fb)[_0x3237fe(0x20c)](',\x20')+'\x22'});const _0x3ea28f=[],_0x3284f5=/^\d{3,4}$/,_0x8a20cc=new RegExp(global[_0x3237fe(0x21f)]),_0x191b80=/^\d{3}$/,_0x1ad1d3=[_0x234f3f[_0x3237fe(0x1f2)],''];for(const [_0x3f221e,_0x3d411e]of _0x5ec95f[_0x3237fe(0x312)]()){const _0x5e99a2=_0x234f3f[_0x3237fe(0x25e)](_0x3f221e,0x2),_0x28693b={'userId':_0x3d411e['userId'],'row':_0x5e99a2};if(!_0x3d411e['userId']||_0x234f3f[_0x3237fe(0x251)](_0x3284f5['test'](_0x3d411e['userId'][_0x3237fe(0x2d0)]()),!0x1)){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x24c)]||_0x234f3f['QSbiR'](_0x8a20cc[_0x3237fe(0x1f1)](_0x3d411e[_0x3237fe(0x24c)]),!0x1)){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x2ee)]||_0x234f3f[_0x3237fe(0x30f)](_0x191b80[_0x3237fe(0x1f1)](_0x3d411e['branchId'][_0x3237fe(0x2d0)]()),!0x1)){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e['userIsActive']||_0x234f3f['gsCPC'](_0x1ad1d3[_0x3237fe(0x350)](_0x3d411e[_0x3237fe(0x395)]),!0x1)){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x2fe)]||_0x234f3f[_0x3237fe(0x39d)](global[_0x3237fe(0x2f4)]['includes'](_0x3d411e[_0x3237fe(0x2fe)]),!0x1)){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x3ce)]||_0x234f3f[_0x3237fe(0x1ef)](_0x346442[_0x3237fe(0x265)](_0x3d411e[_0x3237fe(0x3ce)]),!0x1)){_0x3ea28f['push'](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x1d5)]||_0x234f3f['prhZn'](_0x3d411e['userFirstname']['trim'](),'')){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}if(!_0x3d411e[_0x3237fe(0x394)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x3237fe(0x1f1)](_0x3d411e['dateTimeCanDelete'])){_0x3ea28f[_0x3237fe(0x2d1)](_0x28693b);continue;}}if(_0x234f3f[_0x3237fe(0x353)](_0x3ea28f['length'],0x0)){const _0x1b5d93=Array[_0x3237fe(0x36f)](new Set(_0x3ea28f[_0x3237fe(0x25a)](_0x126238=>JSON['stringify'](_0x126238))))[_0x3237fe(0x25a)](_0x3ac153=>JSON[_0x3237fe(0x1d8)](_0x3ac153));return _0x51611a['send']({'isUpload':!0x1,'color':_0x234f3f[_0x3237fe(0x2a7)],'msg':_0x3237fe(0x28b)+_0x1b5d93[_0x3237fe(0x25a)](_0x290bc4=>_0x290bc4['row'])[_0x3237fe(0x20c)](',\x20'),'errorRows':_0x1b5d93});}_0x5ec95f['forEach'](_0x50cf75=>{const _0x5df8e1=_0x3237fe;_0x50cf75['userId']=_0x234f3f[_0x5df8e1(0x226)](Number,_0x50cf75[_0x5df8e1(0x2b5)]),_0x50cf75[_0x5df8e1(0x2ee)]=_0x234f3f['nquaW'](Number,_0x50cf75[_0x5df8e1(0x2ee)]),_0x50cf75['userIsActive']||(_0x50cf75[_0x5df8e1(0x395)]=''),_0x50cf75[_0x5df8e1(0x31f)]||(_0x50cf75['userPhone']=''),_0x50cf75[_0x5df8e1(0x1c5)]||(_0x50cf75['userPrefix']=''),_0x50cf75[_0x5df8e1(0x3bf)]||(_0x50cf75[_0x5df8e1(0x3bf)]=''),delete _0x50cf75[_0x5df8e1(0x2fd)],delete _0x50cf75['changesHistoryCount'],delete _0x50cf75[_0x5df8e1(0x346)],delete _0x50cf75[_0x5df8e1(0x2fd)];}),await _0xd09ce3[_0x3237fe(0x2c2)]();const _0x45eb4b=_0xd09ce3['db'](dbName)[_0x3237fe(0x37c)](dbColl_users),_0x3387dd=[];for(const _0x3ab1a0 of _0x5ec95f){const _0x2637de=await _0x45eb4b[_0x3237fe(0x356)]({'userId':_0x3ab1a0[_0x3237fe(0x2b5)]},{'$set':_0x3ab1a0},{'upsert':!0x0});_0x3387dd[_0x3237fe(0x2d1)]({'userId':_0x3ab1a0[_0x3237fe(0x2b5)],'matchedCount':_0x2637de['matchedCount'],'upsertedCount':_0x2637de[_0x3237fe(0x359)]});}const _0x3cc69a=_0x234f3f[_0x3237fe(0x353)](_0x3387dd[_0x3237fe(0x347)],0x0)?_0x234f3f[_0x3237fe(0x3ca)](_0x3237fe(0x223)+_0x3387dd[_0x3237fe(0x1f8)](_0x73bc79=>_0x73bc79[_0x3237fe(0x2e6)]>0x0)['length']+_0x3237fe(0x331),(_0x3237fe(0x33b)+_0x3387dd[_0x3237fe(0x1f8)](_0x1de504=>_0x1de504['upsertedCount']>0x0)[_0x3237fe(0x347)]+_0x3237fe(0x331))['trim']()):_0x234f3f[_0x3237fe(0x1db)];return _0x51611a[_0x3237fe(0x3bd)]({'isUpload':!0x0,'color':_0x234f3f[_0x3237fe(0x358)],'msg':_0x3cc69a});}catch(_0x7e0288){return console['log'](_0x234f3f[_0x3237fe(0x274)],_0x7e0288),_0x51611a[_0x3237fe(0x3bd)]({'isDownload':!0x1,'color':_0x234f3f['YsIEf'],'msg':_0x7e0288['message']});}finally{_0xd09ce3[_0x3237fe(0x270)]();}});export default S;function _0x4d676b(_0x553db6){const _0x1a1fb5=_0x9698ac,_0x452cb9={'uDxbb':function(_0x50160a,_0x1a7aca){return _0x50160a===_0x1a7aca;},'uhpas':_0x1a1fb5(0x3b2),'YXLOX':_0x1a1fb5(0x326),'Bhzhr':_0x1a1fb5(0x261),'NrIbg':function(_0x14e506,_0x2ab734){return _0x14e506!==_0x2ab734;},'BfUYX':function(_0x666d90,_0x1c281c){return _0x666d90+_0x1c281c;},'mrdyQ':function(_0x424c87,_0x7153c5){return _0x424c87/_0x7153c5;},'QsHTa':'length','oeRXQ':function(_0x41634d,_0x2e546b){return _0x41634d===_0x2e546b;},'wXIOG':function(_0x43c3ff,_0x56a05f){return _0x43c3ff%_0x56a05f;},'hbuBq':function(_0x2b80e6,_0x1621a9){return _0x2b80e6+_0x1621a9;},'YjaTR':'debu','oViIu':_0x1a1fb5(0x34d),'Izzyv':_0x1a1fb5(0x1c2),'iAJAP':function(_0x2ee8ba,_0x1a0002){return _0x2ee8ba+_0x1a0002;},'hMIvm':'stateObject','nEOtV':function(_0x40ee6a,_0x1ef216){return _0x40ee6a(_0x1ef216);},'DVNpv':function(_0x57f89d,_0x227236){return _0x57f89d(_0x227236);}};function _0x3fd3(_0xb336e8){const _0x3fe8c2=_0x1a1fb5;if(_0x452cb9['uDxbb'](typeof _0xb336e8,_0x452cb9[_0x3fe8c2(0x211)]))return function(_0x601989){}[_0x3fe8c2(0x228)](_0x452cb9['YXLOX'])['apply'](_0x452cb9[_0x3fe8c2(0x37f)]);else _0x452cb9[_0x3fe8c2(0x2b6)](_0x452cb9[_0x3fe8c2(0x1b1)]('',_0x452cb9[_0x3fe8c2(0x26b)](_0xb336e8,_0xb336e8))[_0x452cb9[_0x3fe8c2(0x1b3)]],0x1)||_0x452cb9[_0x3fe8c2(0x352)](_0x452cb9[_0x3fe8c2(0x3ac)](_0xb336e8,0x14),0x0)?function(){return!![];}['constructor'](_0x452cb9[_0x3fe8c2(0x2e4)](_0x452cb9[_0x3fe8c2(0x293)],_0x452cb9[_0x3fe8c2(0x3a3)]))[_0x3fe8c2(0x1f9)](_0x452cb9['Izzyv']):function(){return![];}[_0x3fe8c2(0x228)](_0x452cb9['iAJAP'](_0x452cb9[_0x3fe8c2(0x293)],_0x452cb9[_0x3fe8c2(0x3a3)]))[_0x3fe8c2(0x262)](_0x452cb9[_0x3fe8c2(0x318)]);_0x452cb9[_0x3fe8c2(0x1d0)](_0x3fd3,++_0xb336e8);}try{if(_0x553db6)return _0x3fd3;else _0x452cb9[_0x1a1fb5(0x3ae)](_0x3fd3,0x0);}catch(_0x2c7f7f){}}