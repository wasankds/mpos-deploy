const _0x1cab3e=_0x1eb9;(function(_0x17033b,_0x256c3c){const _0xb4a301=_0x1eb9,_0x52d3c8=_0x17033b();while(!![]){try{const _0x18a0fa=parseInt(_0xb4a301(0x36c))/0x1*(parseInt(_0xb4a301(0x16c))/0x2)+parseInt(_0xb4a301(0x1c5))/0x3+parseInt(_0xb4a301(0x1a9))/0x4*(-parseInt(_0xb4a301(0x20c))/0x5)+-parseInt(_0xb4a301(0x387))/0x6*(parseInt(_0xb4a301(0x29d))/0x7)+parseInt(_0xb4a301(0x17e))/0x8+-parseInt(_0xb4a301(0x13e))/0x9+parseInt(_0xb4a301(0x1cc))/0xa*(parseInt(_0xb4a301(0x189))/0xb);if(_0x18a0fa===_0x256c3c)break;else _0x52d3c8['push'](_0x52d3c8['shift']());}catch(_0x4262d7){_0x52d3c8['push'](_0x52d3c8['shift']());}}}(_0x4699,0x75621));const _0x5b889e=(function(){const _0x4f8145=_0x1eb9,_0x526439={'HTQnM':function(_0x1e0e9a,_0x33c412){return _0x1e0e9a!==_0x33c412;},'kxxxu':'iMtGd','UXOFu':_0x4f8145(0x35e),'pwbva':'BvAJP','GRQTV':'hnVXO','ZmbJQ':function(_0x3dabd1,_0x14da8a){return _0x3dabd1!==_0x14da8a;},'OfUNG':'OkrKv'};let _0x3c23d6=!![];return function(_0x1386e8,_0x4d8f17){const _0x4b3353=_0x4f8145,_0x378007={'OEsep':function(_0x5c7eb4,_0x1909ba){const _0x3b64f0=_0x1eb9;return _0x526439[_0x3b64f0(0x260)](_0x5c7eb4,_0x1909ba);},'wxVCo':_0x526439[_0x4b3353(0x1a8)],'sfDGj':_0x526439['UXOFu'],'aWBgj':function(_0x3eac60,_0x3e8b70){const _0x2650e3=_0x4b3353;return _0x526439[_0x2650e3(0x260)](_0x3eac60,_0x3e8b70);},'wCDea':_0x526439['pwbva'],'zisxQ':_0x526439[_0x4b3353(0x340)]};if(_0x526439[_0x4b3353(0x368)](_0x526439[_0x4b3353(0x1a2)],_0x526439[_0x4b3353(0x1a2)]))return![];else{const _0x379400=_0x3c23d6?function(){const _0x1d4ca8=_0x4b3353;if(_0x378007[_0x1d4ca8(0x1c7)](_0x378007[_0x1d4ca8(0x227)],_0x378007['sfDGj'])){if(_0x4d8f17){if(_0x378007[_0x1d4ca8(0x1c8)](_0x378007[_0x1d4ca8(0x23e)],_0x378007[_0x1d4ca8(0x145)])){const _0x10542b=_0x4d8f17[_0x1d4ca8(0x32c)](_0x1386e8,arguments);return _0x4d8f17=null,_0x10542b;}else _0x4ac22c[_0x1d4ca8(0x165)]();}}else{const _0xa7fb75=_0x2360da?function(){const _0x486e64=_0x1d4ca8;if(_0x3c3bd6){const _0x58b92f=_0x4abe6e[_0x486e64(0x32c)](_0x473b53,arguments);return _0x52f79d=null,_0x58b92f;}}:function(){};return _0x319ccd=![],_0xa7fb75;}}:function(){};return _0x3c23d6=![],_0x379400;}};}());(function(){const _0x1af37a=_0x1eb9,_0x3be5c7={'nVCCk':_0x1af37a(0x37d),'DdqTp':function(_0x315e3f,_0xb01cb8){return _0x315e3f!==_0xb01cb8;},'yWOsf':_0x1af37a(0x1e5),'wBXEb':_0x1af37a(0x2ca),'hRVHZ':_0x1af37a(0x30d),'fwBMw':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','btOGC':function(_0x4eaa36,_0x2b8d80){return _0x4eaa36(_0x2b8d80);},'vTDos':_0x1af37a(0x2b2),'XxEEv':function(_0x149065,_0x7896fa){return _0x149065+_0x7896fa;},'AHavv':'chain','eqSWH':function(_0xa29b25,_0x32825e){return _0xa29b25+_0x32825e;},'cDPRl':_0x1af37a(0x349),'XvpEW':function(_0x59e194,_0x1ee524){return _0x59e194===_0x1ee524;},'yYfzg':_0x1af37a(0x25e),'mCYji':_0x1af37a(0x345),'CDbZo':function(_0x29f220,_0x342ff1){return _0x29f220!==_0x342ff1;},'TNRfq':'vnHrT','xqEhb':function(_0x8617b2){return _0x8617b2();},'Jnnhe':function(_0x5cff96,_0x43f403,_0x48a542){return _0x5cff96(_0x43f403,_0x48a542);}};_0x3be5c7[_0x1af37a(0x2c9)](_0x5b889e,this,function(){const _0x1bb2e1=_0x1af37a;if(_0x3be5c7[_0x1bb2e1(0x322)](_0x3be5c7['yWOsf'],_0x3be5c7[_0x1bb2e1(0x256)])){const _0x29052c=new RegExp(_0x3be5c7[_0x1bb2e1(0x184)]),_0x46293a=new RegExp(_0x3be5c7[_0x1bb2e1(0x2d1)],'i'),_0x4aa20f=_0x3be5c7[_0x1bb2e1(0x140)](_0x3b8731,_0x3be5c7[_0x1bb2e1(0x2aa)]);if(!_0x29052c[_0x1bb2e1(0x18c)](_0x3be5c7['XxEEv'](_0x4aa20f,_0x3be5c7[_0x1bb2e1(0x1e9)]))||!_0x46293a['test'](_0x3be5c7[_0x1bb2e1(0x175)](_0x4aa20f,_0x3be5c7[_0x1bb2e1(0x2bf)]))){if(_0x3be5c7['XvpEW'](_0x3be5c7['yYfzg'],_0x3be5c7[_0x1bb2e1(0x1f3)])){const _0x37e35d=_0x1de5d5?function(){const _0x296d3d=_0x1bb2e1;if(_0xc8f707){const _0x4347d8=_0x273bb6[_0x296d3d(0x32c)](_0x292db6,arguments);return _0x3d82f7=null,_0x4347d8;}}:function(){};return _0x566919=![],_0x37e35d;}else _0x3be5c7[_0x1bb2e1(0x140)](_0x4aa20f,'0');}else{if(_0x3be5c7['CDbZo'](_0x3be5c7[_0x1bb2e1(0x202)],_0x3be5c7[_0x1bb2e1(0x202)])){const _0x465216=_0xb6357[_0x1bb2e1(0x2a4)](new _0x5094be(_0xa52170[_0x1bb2e1(0x187)](_0x4eca91=>_0x120694['stringify'](_0x4eca91))))[_0x1bb2e1(0x187)](_0x46ba03=>_0x204d16['parse'](_0x46ba03));return _0x2eac5c[_0x1bb2e1(0x1d5)]({'isUpload':!0x1,'color':_0x3be5c7['nVCCk'],'msg':'มีข้อมูลผิดพลาดที่แถว\x20'+_0x465216[_0x1bb2e1(0x187)](_0x518ec5=>_0x518ec5['row'])[_0x1bb2e1(0x1cb)](',\x20'),'errorRows':_0x465216});}else _0x3be5c7[_0x1bb2e1(0x237)](_0x3b8731);}}else{const _0x137a13=_0x1a3e94[_0x1bb2e1(0x243)][_0x1bb2e1(0x186)][_0x1bb2e1(0x234)](_0x5539eb),_0x45e0dc=_0x3ff7a3[_0xa78b82],_0x5c7bac=_0x579bf1[_0x45e0dc]||_0x137a13;_0x137a13[_0x1bb2e1(0x2fd)]=_0x34d2e2[_0x1bb2e1(0x234)](_0x4a0bb),_0x137a13[_0x1bb2e1(0x2c6)]=_0x5c7bac[_0x1bb2e1(0x2c6)]['bind'](_0x5c7bac),_0x216c36[_0x45e0dc]=_0x137a13;}})();}());const _0x20c487=(function(){const _0x3c2a14=_0x1eb9,_0x1d2afc={'xxPpK':_0x3c2a14(0x18a),'WMcCW':_0x3c2a14(0x1d3),'gsbko':function(_0x3e34e4,_0x32108b){return _0x3e34e4(_0x32108b);},'tYGnJ':function(_0x4e889a,_0x243599){return _0x4e889a===_0x243599;},'AiIfd':'uscHe','uujBc':_0x3c2a14(0x247),'ayyOt':function(_0x412e23,_0x1b5165){return _0x412e23!==_0x1b5165;},'UHpVY':'AgtKr','bNTyK':_0x3c2a14(0x1a5),'DIcxk':'AwElT'};let _0x1bc2b8=!![];return function(_0x44dcab,_0x41d094){const _0x150940=_0x3c2a14,_0x1c3473={'TzzUp':_0x1d2afc[_0x150940(0x16a)],'zAMvE':_0x1d2afc[_0x150940(0x38c)],'CIHjB':function(_0x3e3faa,_0x3b5e56){const _0x3f3ae1=_0x150940;return _0x1d2afc[_0x3f3ae1(0x383)](_0x3e3faa,_0x3b5e56);},'ewlqP':function(_0xf1e8b4,_0x3a9e62){const _0x231fe2=_0x150940;return _0x1d2afc[_0x231fe2(0x2d3)](_0xf1e8b4,_0x3a9e62);},'FRlbc':_0x1d2afc[_0x150940(0x1a4)],'MIQMh':_0x1d2afc[_0x150940(0x213)],'KXDoy':function(_0x559256,_0x3e1c0d){const _0x5d5910=_0x150940;return _0x1d2afc[_0x5d5910(0x198)](_0x559256,_0x3e1c0d);},'svLCp':_0x1d2afc['UHpVY'],'nOgMV':_0x1d2afc['bNTyK']};if(_0x1d2afc[_0x150940(0x198)](_0x1d2afc[_0x150940(0x24b)],_0x1d2afc[_0x150940(0x24b)])){if(_0x5b56f7){const _0x530d81=_0x43b425[_0x150940(0x32c)](_0x17ef35,arguments);return _0xcd49f5=null,_0x530d81;}}else{const _0x1a32f8=_0x1bc2b8?function(){const _0x19eb4f=_0x150940,_0x33bf4f={'TZnhp':function(_0x391e12,_0x500cf5){const _0x225a36=_0x1eb9;return _0x1c3473[_0x225a36(0x246)](_0x391e12,_0x500cf5);}};if(_0x1c3473[_0x19eb4f(0x330)](_0x1c3473[_0x19eb4f(0x367)],_0x1c3473[_0x19eb4f(0x1cf)])){if(_0x19f0ce)return _0x478566;else _0x33bf4f[_0x19eb4f(0x2bb)](_0x1a05b8,0x0);}else{if(_0x41d094){if(_0x1c3473[_0x19eb4f(0x356)](_0x1c3473['svLCp'],_0x1c3473[_0x19eb4f(0x272)])){const _0x555a62=_0x41d094[_0x19eb4f(0x32c)](_0x44dcab,arguments);return _0x41d094=null,_0x555a62;}else return function(_0x2ceb09){}[_0x19eb4f(0x243)](_0x1c3473['TzzUp'])[_0x19eb4f(0x32c)](_0x1c3473['zAMvE']);}}}:function(){};return _0x1bc2b8=![],_0x1a32f8;}};}()),_0x3d01e0=_0x20c487(this,function(){const _0x19916b=_0x1eb9,_0x41e0b0={'dVaUl':function(_0x1da0a3,_0x479078){return _0x1da0a3===_0x479078;},'hCDjk':_0x19916b(0x296),'WasFR':_0x19916b(0x2c0),'SUzGp':function(_0x114ff9,_0x5ac0fd){return _0x114ff9(_0x5ac0fd);},'RbLqd':function(_0x567e6c,_0x2889d5){return _0x567e6c+_0x2889d5;},'zjgRf':'return\x20(function()\x20','lTVaz':_0x19916b(0x170),'RmgCe':function(_0x58e499){return _0x58e499();},'HqrzZ':function(_0x2c8e4e,_0x58763f){return _0x2c8e4e!==_0x58763f;},'ISqzX':'BTcez','ZyOjN':_0x19916b(0x22a),'tTrXm':_0x19916b(0x18f),'beNOA':'warn','dZiwP':_0x19916b(0x2ab),'rKzGZ':_0x19916b(0x2b6),'uBXtO':'exception','suObC':_0x19916b(0x2a3),'SfzjQ':_0x19916b(0x365),'xUVuw':function(_0x5ce3d8,_0x65d0){return _0x5ce3d8<_0x65d0;},'qsQDK':_0x19916b(0x1e0),'KUBCW':_0x19916b(0x33b)};let _0x57560b;try{if(_0x41e0b0['dVaUl'](_0x41e0b0[_0x19916b(0x252)],_0x41e0b0[_0x19916b(0x201)])){const _0x1646bd=_0x4b24cc[_0x19916b(0x32c)](_0x31e6e2,arguments);return _0xb192fe=null,_0x1646bd;}else{const _0x298de4=_0x41e0b0[_0x19916b(0x19d)](Function,_0x41e0b0[_0x19916b(0x2a9)](_0x41e0b0[_0x19916b(0x2a9)](_0x41e0b0[_0x19916b(0x2c7)],_0x41e0b0[_0x19916b(0x366)]),');'));_0x57560b=_0x41e0b0[_0x19916b(0x143)](_0x298de4);}}catch(_0x1eb639){_0x41e0b0[_0x19916b(0x327)](_0x41e0b0['ISqzX'],_0x41e0b0[_0x19916b(0x233)])?_0x57560b=window:_0x516616[_0x19916b(0x165)]();}const _0x4c91a4=_0x57560b[_0x19916b(0x26f)]=_0x57560b['console']||{},_0x5eb289=[_0x41e0b0[_0x19916b(0x280)],_0x41e0b0[_0x19916b(0x344)],_0x41e0b0[_0x19916b(0x224)],_0x41e0b0[_0x19916b(0x292)],_0x41e0b0['uBXtO'],_0x41e0b0[_0x19916b(0x2cc)],_0x41e0b0[_0x19916b(0x288)]];for(let _0x571566=0x0;_0x41e0b0[_0x19916b(0x17a)](_0x571566,_0x5eb289[_0x19916b(0x169)]);_0x571566++){if(_0x41e0b0[_0x19916b(0x327)](_0x41e0b0[_0x19916b(0x302)],_0x41e0b0[_0x19916b(0x384)])){const _0xb2f335=_0x20c487['constructor']['prototype'][_0x19916b(0x234)](_0x20c487),_0xb5abad=_0x5eb289[_0x571566],_0x271cd1=_0x4c91a4[_0xb5abad]||_0xb2f335;_0xb2f335[_0x19916b(0x2fd)]=_0x20c487['bind'](_0x20c487),_0xb2f335[_0x19916b(0x2c6)]=_0x271cd1[_0x19916b(0x2c6)][_0x19916b(0x234)](_0x271cd1),_0x4c91a4[_0xb5abad]=_0xb2f335;}else _0x32228e[_0x19916b(0x165)]();}});function _0x1eb9(_0x23bb73,_0x22de39){const _0x35de9e=_0x4699();return _0x1eb9=function(_0x3d01e0,_0x20c487){_0x3d01e0=_0x3d01e0-0x139;let _0x2f12f4=_0x35de9e[_0x3d01e0];return _0x2f12f4;},_0x1eb9(_0x23bb73,_0x22de39);}_0x3d01e0();import _0x167099 from'express';import{MongoClient as _0x1f38fd,ObjectId as _0x3d2ab2}from'mongodb';import _0x511901 from'bcrypt';const x=_0x167099[_0x1cab3e(0x2f7)]();function _0x4699(){const _0x6fda14=['_id','wBXEb','zXNYb','userPassword','LHtEC','gWANj','PpUmb','readFileSync','RSXeK','fBjTt','doc_changes.ejs','HTQnM','ZdAUw','zGkOh','cRXRR','IkrwI','iXqae','OZYzd','xlsx','MeEPG','WXjce','msg','OwLWr','ceil','Mcvdv','YmDhD','console','connect','DZvne','nOgMV','osHOF','TWiiu','UGXxt','debu','KHksu','ลบยูสเซอร์\x20\x22','UtXjk','txaCm','มี\x20userId\x20ซ้ำกัน:\x20\x22','userFullname','xpWYQ','nsTRE','wQHyw','tTrXm','\x20ยูสเซอร์เรียบร้อยแล้ว','userIsActive','mNIJf','bXaxS','users','eYORa','vnlSI','SfzjQ','MgmoS','read','JTvNz','filter','getSettings','OBjzt','/mySendmail.js','renderView','BMrOG','rKzGZ','uxdUX','JSROq','CbEIB','yuyrB','WApYY','lrSqd','OfuoC','env','อีเมล/ชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','ZdrxD','1484Iyyixb','sbwAf','vlvJQ','idYlc','userAuthority','ไฟล์\x20Excel\x20ต้องมีชีทชื่อ\x20\x22','table','from','hVgPv','warn','ยูสเซอร์\x20(','eqQzb','RbLqd','vTDos','info','wUarc','MURnO','ZMYuk','HjDZo','query','เพิ่มยูสเซอร์\x20','init','modifiedCount','/print','wBrgA','error','RdNIe','green','userPrefix','GpChr','TZnhp','load_id','IqerY','WwJsx','cDPRl','YRnAj','qnoJt','$branchInfo.branchName','BWquU','userLastname','fkDGL','toString','zjgRf','eBdff','Jnnhe','OJnGa','deletedCount','suObC','qyjjX','BmPpw','has','NYLth','fwBMw','folderForms','tYGnJ','\x22\x20มีอยู่ในเอกสาร\x20','Frcsp','book_new','deleteOne','{{sep}}(\x20ไม่พบเซสชั่น\x20)','single','TfOCp','getUserBranches','eWIUy','limit','size','\x22\x20)','isEmail','userPhone','jWZSj','QxbSH','TtwBi','obmuP','RxuNv','PpVRd','VorKb','ikjvS','eHAlN','CKrhz','MdoYX','/load','BJLuC','rOWSY','username','buffer','xbwFK','destroy','LzgPI','gEsIB','SOkak','Router','entries','sGzVy','\x22\x20เรียบร้อยแล้ว','sOpXI','isOS','__proto__','\x22\x20เรียบร้อยแล้ว\x20)','active','jplHS','find','qsQDK','bCZVZ','moGTS','ATFNU','rDHtD','utf8','pIUHq','nRedB','minute','yFKzt','kBLXr','function\x20*\x5c(\x20*\x5c)','sendFile','SRYnZ','sgEHh','USER_AUTHORITIES','cNoIc','dbColl_users','hfxyr','dEDWT','vmoyC','ชี้ท\x20\x27users\x27\x20ต้องมีคอลัมน์\x20\x22','etbEu','อัปเดท\x20\x22','error\x20===>\x20','LFIfO','$userFirstname','response','vbrQX','/upload-excel','dateTimeCanDelete','xBQAs','DdqTp','KwBEe','userEmail','ยูสเซอร์\x20\x22','PIcjr','HqrzZ','WGVwG','rWiSS','MyBUs','lkONj','apply','YcqpG','\x22{{sep}}(\x20อาจจะถูกลบไปแล้ว\x20)','UpZmK','ewlqP','dbColl_sales','dbName','LnRTq','?rpp=20&page=1&load_id=','aBAAm','Gspiz','user-','&page=','XxShd','iJpsB','dNawg','มีข้อมูลผิดพลาดที่แถว\x20','EDwvc','KxBAF','acknowledged','GRQTV','ไม่พบ\x20\x22','generatePassword','kmJdJ','beNOA','rdVpQ','hTzKM','/delete','AFROr','input','VoMaM','forEach','Bfmaj','jKOtc','rGBjo','rZcEW','WEyMO','FqhzP','VQATP','body','manageUsers','wkoAC','KXDoy','EtyqD','{{sep}}\x22','zEXUU','sort','QXwZZ','countDocuments','เพิ่มยูสเซอร์และส่งอิเมล์เรียบร้อยแล้ว\x20(','GkefS','{{sep}}เพิ่มใหม่\x20','GwRWy','mAWZp','กรุณาเลือกไฟล์\x20Excel\x20ที่ต้องการอัปโหลด','giOVu','TnejD','trace','lTVaz','FRlbc','ZmbJQ','hash','call','WXmpx','75554ETbRdL','render','kgYWv','YpdgY','pwMbr','HcBBx','aVyOn','pWcYX','xWreT','PiaPY','/myDateTime.js','ZyDcI','QQVdH','ไม่มีข้อมูลที่อัปเดท','PZLaq','{{sep}}ไม่สามารถลบได้','yPFWQ','red','/myModule.js','tXlZX','row','hasOwnProperty','XUxub','gsbko','KUBCW','gger','buoKw','20562HPuuwJ','CLsiU','NfCid','print_users.ejs','skcwY','WMcCW','memoryStorage','RTWWa','dewtt','hKfAO','SBsPB','qFLuL','yDEiw','unshift','userNormalLoginCount','xkjdo','6830928XAfuor','RyPfn','btOGC','YVrme','KwXsI','RmgCe','dVXJZ','zisxQ','EDjEN','trim','redirect','tBWMT','BCRYPT_NUMBER','vHJXW','GaZvZ','\x20รายการ','เกิดข้อผิดพลาดขณะเพิ่ม/ส่งอีเมลไปยังผู้ใช้ใหม่','collection','cPNgW','WSfXe','AGXOj','cUPZu','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ดาวน์โหลด\x20Excel\x20เรียบร้อยแล้ว','HvybE','BLKof','sendRegisterUserEmail','insertedId','kXIBa','KMfIr','string','pMGFB','zoyty','AKlHI','yTIrP','ZFznY','GajoR','&load_id=','\x22\x20ไม่มีอะไรเปลี่ยนแปลง','close','Fjiut','file','BYVJG','length','xxPpK','JGhaJ','22KpfEMe','pgahs','branchInfo','toArray','{}.constructor(\x22return\x20this\x22)(\x20)','yOjvO','TvxTI','updateOne','push','eqSWH','deleteMany','มี\x20username\x20ซ้ำกัน:\x20\x22','Huelv','QBtef','xUVuw','userFlash','KBapU','MYCVp','3420560pGnmXC','.xlsx','BTUDV','{{sep}}[\x20บันทึกการแก้ไข\x20]','userLastLogin','../','hRVHZ','อีเมลหรือชื่อผู้ใช้{{sep}}มีอยู่ในระบบแล้ว','prototype','map','sip','11HAnaBT','while\x20(true)\x20{}','MoToO','test','uSUFr','NSLSt','log','ZeZFH','pxxAU','$changesHistory','LISoy','userFirstname','\x5c$&','$userPrefix','session','ayyOt','fVFKW','phMho','includes','action','SUzGp','rTVAX','eIFbH','PTpMQ','\x22\x20เรียบร้อยแล้ว{{sep}}(\x20รหัสผ่านเริ่มต้น\x20\x22','OfUNG','vbvep','AiIfd','mYVAQ','eaywa','&rpp=','kxxxu','4112wbuDNi','qXyaY','FEveJ','DVHlo','AdbNZ','iiZgm','CWOKq','dbColl_warehouseOut','oWtJH','vQnby','rsMci','getSessionData','shift','replace','IQXKh','utils','tguBo','page','status','keys','fCfdZ','UABwn','aggregate','matchedCount','สร้างผู้ใช้ใหม่\x20\x22','aOcii','sheet_to_json','VryUU','1302582XhYduV','nnAfG','OEsep','aWBgj','findOne','){{sep}}(CODE\x20:\x20','join','8594190AAVDAB','branchId','aLfLp','MIQMh','vqKIa','LvJol','vHVKd','counter','FchXz','send','NuJVF','tPZnc','Session\x20destroy\x20error:\x20','dbColl_return','yellow','มี\x20userEmail\x20ซ้ำกัน:\x20\x22','YRCOU','yjDNk','EEdPv','DbdJb','GkDte','{{sep}}(\x20ลบเซสชั่นทั้งหมดจำนวน\x20\x20\x22','tGCAX','yXLLb','getDate','fYzsD','eKHBk','vuHuQ','getChangeHistory','AHavv','MkAnD','ZdAde','MulKA','changesHistoryCount','cipnV','?sip=','bYlbw','/save','sevvd','mCYji','dbColl_warehouseIn','GGAVe','TQjtR','/download-excel','wtJGh','BDAls','message','shNdj','rCnsG','ZhZle','PSRzz','upsertedCount','RSbES','WasFR','TNRfq','xswNg','parse','WEkHg','catch','get','getDateTime','CJiyN','hIMuK','XtmDX','2850SWLkMd','SBDNX','Not\x20Found','edIzK','jtZZV','WopIJ','pgzWG','uujBc','EVfyX','hCBSE','PMQYe','pCuhz','Jcjxh','FZQkJ','pZVyo','/myData.js','aUxqG','exception','wjDfV','/changes','lPIIO','START_PASSWORD','rpp','iYHsQ','dZiwP','ยังไม่มีผู้ใช้ในระบบเลย\x20ต้องเพิ่มผู้ใช้หลักก่อน','$userLastname','wxVCo','eIDfN','cJFBG','legTB','EaWnd','LmCGN','QOsDl','add','mLwKy','VcpbM','userId','sPfiN','ZyOjN','bind','flash','then','xqEhb','IasWs','NDGRK','keXXj','dbColl_userBranches','mCehq','sGBmJ','wCDea','XlAAj','stringify','mKHzN','biDCF','constructor','hcRKI','ประวัติการแก้ไขยูสเซอร์\x20:\x20[','CIHjB','Speki','cyFnR','post','ytsou','DIcxk','EVEug','/manage/users','sJYQT','insertOne','LrsAj','write','hCDjk','iXglc','kKtUK'];_0x4699=function(){return _0x6fda14;};return _0x4699();}import _0x2190d0 from'multer';import _0x265a0b from'validator';import _0x2b1b4e from'xlsx';import _0x2252af from'path';import _0xf2da5b from'fs';import _0xab1018 from'ejs';import _0x189327 from'../middleware/mainAuth.js';const H=await import('../'+mymoduleFolder+_0x1cab3e(0x37e)),O=await import(_0x1cab3e(0x183)+mymoduleFolder+_0x1cab3e(0x376)),M=await import(_0x1cab3e(0x183)+mymoduleFolder+'/myUsers.js'),re=await import('../'+mymoduleFolder+_0x1cab3e(0x28f)),z=await import(_0x1cab3e(0x183)+mymoduleFolder+_0x1cab3e(0x21b)),b=_0x1cab3e(0x24d),Q=b+_0x1cab3e(0x1f1),X=b+'/new',W=b+_0x1cab3e(0x2ed),G=b+_0x1cab3e(0x347),V=b+_0x1cab3e(0x2b4),Y=b+_0x1cab3e(0x21f),K=b+_0x1cab3e(0x1f7),Z=b+_0x1cab3e(0x31f),ne=b['replace'](/\//g,'_'),oe=0x5a0*0x3c;x[_0x1cab3e(0x207)](b,_0x189327[_0x1cab3e(0x2fc)],async(_0x3f614b,_0x3f8cf6)=>{const _0x2b8f40=_0x1cab3e,_0x25ada6={'yDEiw':_0x2b8f40(0x26a),'EVfyX':_0x2b8f40(0x37d),'aVyOn':function(_0x4ff3da){return _0x4ff3da();},'vgMfH':'error\x20===>\x20','RdNIe':function(_0x13a6e5,_0x37a08c){return _0x13a6e5!==_0x37a08c;},'EVEug':'GudQT','DZvne':function(_0x32a2e8,_0x2adcc7){return _0x32a2e8!==_0x2adcc7;},'EaNFy':function(_0x4a2e07,_0x57e429){return _0x4a2e07==_0x57e429;},'EaWnd':function(_0x56f34e,_0x4c3c95){return _0x56f34e!==_0x4c3c95;},'YhmYx':function(_0x5cb82d,_0x46c41f){return _0x5cb82d!==_0x46c41f;},'tGCAX':function(_0x532a27,_0x32915d){return _0x532a27==_0x32915d;},'keXXj':function(_0x2a3853,_0x10fb59){return _0x2a3853!==_0x10fb59;},'UABwn':function(_0x15fa7f,_0x44a4){return _0x15fa7f(_0x44a4);},'EdIZY':function(_0x5a761b,_0x373b36){return _0x5a761b(_0x373b36);},'bCZVZ':function(_0x358202,_0x3058d3){return _0x358202(_0x3058d3);},'RTWWa':function(_0x4f2c5c,_0x32fbc0){return _0x4f2c5c(_0x32fbc0);},'MgmoS':function(_0x433bd9,_0x5ccc5b){return _0x433bd9(_0x5ccc5b);},'owXkm':function(_0x47a79f,_0x1f6e84){return _0x47a79f*_0x1f6e84;},'ZyDcI':function(_0x3a5e15,_0xf6aa0e){return _0x3a5e15-_0xf6aa0e;},'dVXJZ':function(_0x5b6e6,_0x4e38a6){return _0x5b6e6!==_0x4e38a6;},'vnlSI':'bfVIv','GGAVe':function(_0x26e1ac,_0x4ffc8a){return _0x26e1ac===_0x4ffc8a;},'tPZnc':_0x2b8f40(0x250),'sOpXI':_0x2b8f40(0x195),'UYRjG':function(_0x3bc523,_0x4b3663){return _0x3bc523/_0x4b3663;},'jEjtb':function(_0x4e1282,_0x1efba5){return _0x4e1282<_0x1efba5;},'cipnV':function(_0x508c36,_0x1dab19){return _0x508c36(_0x1dab19);},'LHtEC':function(_0x288b63,_0x49ee32){return _0x288b63>_0x49ee32;},'pIUHq':function(_0x5b6074,_0x5c2c77){return _0x5b6074+_0x5c2c77;},'tUhaM':function(_0x3d7557,_0x2e9efe){return _0x3d7557(_0x2e9efe);},'eIFbH':function(_0x1a9bc0,_0x3c8b70){return _0x1a9bc0+_0x3c8b70;},'SRYnZ':function(_0x1b9b89,_0x26b3ae){return _0x1b9b89(_0x26b3ae);},'mAWZp':_0x2b8f40(0x196),'IAkBa':_0x2b8f40(0x31c),'vqKIa':_0x2b8f40(0x226),'VaRuU':_0x2b8f40(0x192),'rWiSS':'$dateTimeCanDelete','yPFWQ':_0x2b8f40(0x30a),'bYlbw':_0x2b8f40(0x210),'vlvJQ':function(_0x454cef,_0x1e7f27){return _0x454cef(_0x1e7f27);},'phMho':function(_0x331e5f,_0xf40f1a){return _0x331e5f===_0xf40f1a;},'Jcjxh':_0x2b8f40(0x318),'LFIfO':function(_0x4346fc,_0x57fb64){return _0x4346fc===_0x57fb64;},'MURnO':_0x2b8f40(0x33a),'vuHuQ':'userFlash','dXNFq':function(_0x2e45b2,_0x5dd1ca){return _0x2e45b2>_0x5dd1ca;},'FchXz':_0x2b8f40(0x354),'cyFnR':_0x2b8f40(0x2ff),'zXNYb':'RIhuc','mKHzN':_0x2b8f40(0x228),'BJLuC':function(_0x339b4e,_0x3bcca2){return _0x339b4e!==_0x3bcca2;},'aUxqG':_0x2b8f40(0x254),'BDAls':_0x2b8f40(0x2e3)},_0x3114e0=_0x3f614b[_0x2b8f40(0x2b0)][_0x2b8f40(0x188)],_0x3f8cff=_0x25ada6[_0x2b8f40(0x303)](Number,_0x3f614b['query'][_0x2b8f40(0x222)])||0x14,_0x58135d=_0x25ada6['RTWWa'](Number,_0x3f614b['query']['page'])||0x1,_0x109445=_0x3f614b['query'][_0x2b8f40(0x2bc)]||'',_0x42c1f0=_0x25ada6[_0x2b8f40(0x289)](Number,_0x25ada6['owXkm'](_0x25ada6[_0x2b8f40(0x377)](_0x58135d,0x1),_0x3f8cff)),_0x3a9b0c=O[_0x2b8f40(0x208)](0x0),_0x55f314=new _0x1f38fd(dbUrl);try{if(_0x25ada6[_0x2b8f40(0x144)](_0x25ada6[_0x2b8f40(0x287)],_0x25ada6[_0x2b8f40(0x287)]))_0x2ba6a4[_0x2b8f40(0x165)]();else{await _0x55f314['connect']();const _0x5201ac=_0x55f314['db'](global[_0x2b8f40(0x332)])[_0x2b8f40(0x14f)](global['dbColl_users']);if(_0x3114e0){if(_0x25ada6[_0x2b8f40(0x1f5)](_0x25ada6[_0x2b8f40(0x1d7)],_0x25ada6[_0x2b8f40(0x1d7)])){const _0x25e59c=new RegExp(_0x3114e0[_0x2b8f40(0x1b6)](/[.*+?^${}()|[\]\\]/g,_0x25ada6[_0x2b8f40(0x2fb)]),'i');let _0xde5612={};_0x25ada6[_0x2b8f40(0x289)](isNaN,_0x25ada6[_0x2b8f40(0x303)](Number,_0x3114e0))?_0xde5612={'userId':{'$regex':_0x25e59c}}:_0xde5612={'userId':_0x25ada6[_0x2b8f40(0x38e)](Number,_0x3114e0)};var _0x45e031=await _0x5201ac[_0x2b8f40(0x35c)]({'$or':[_0xde5612,{'username':{'$regex':_0x25e59c}},{'userFirstname':{'$regex':_0x25e59c}}]});}else return _0x3b7aa5['log'](_0x454dd5['message']),_0x915f6e[_0x2b8f40(0x235)](_0x25ada6[_0x2b8f40(0x13a)],{'class':_0x25ada6[_0x2b8f40(0x214)],'text':''+_0xe23f4a[_0x2b8f40(0x1fa)]}),_0x548fd8[_0x2b8f40(0x148)](_0x6163a2);}else var _0x45e031=await _0x5201ac[_0x2b8f40(0x35c)]({});const _0x2dd171=Math[_0x2b8f40(0x26c)](_0x25ada6['UYRjG'](_0x45e031,_0x3f8cff)),_0x114633=_0x25ada6['jEjtb'](_0x25ada6[_0x2b8f40(0x377)](_0x25ada6['UABwn'](Number,_0x58135d),0x1),0x1)?'-':_0x25ada6[_0x2b8f40(0x377)](_0x25ada6[_0x2b8f40(0x303)](Number,_0x58135d),0x1),_0x3229e8=_0x25ada6[_0x2b8f40(0x1ee)](Number,_0x58135d),_0x3eebe2=_0x25ada6[_0x2b8f40(0x259)](_0x25ada6[_0x2b8f40(0x308)](_0x25ada6['tUhaM'](Number,_0x58135d),0x1),_0x2dd171)?'-':_0x25ada6[_0x2b8f40(0x19f)](_0x25ada6[_0x2b8f40(0x30f)](Number,_0x58135d),0x1),_0x540d19=[{'$project':{'_id':0x1,'userIsActive':0x1,'userId':0x1,'username':0x1,'userFullname':{'$concat':[_0x25ada6[_0x2b8f40(0x361)],'\x20',_0x25ada6['IAkBa'],'\x20',_0x25ada6[_0x2b8f40(0x1d0)]]},'userAuthority':0x1,'branchId':0x1,'canDelete':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x25ada6['VaRuU'],[]]}},'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x3a9b0c},'endDate':{'$toDate':_0x25ada6[_0x2b8f40(0x329)]},'unit':_0x25ada6[_0x2b8f40(0x37c)]}},0x0]},'then':!0x0,'else':!0x1}}}},{'$sort':{'userId':-0x1}},{'$skip':_0x42c1f0},{'$limit':_0x3f8cff}];if(_0x3114e0){if(_0x25ada6[_0x2b8f40(0x22b)](_0x25ada6[_0x2b8f40(0x1f0)],_0x25ada6[_0x2b8f40(0x1f0)]))uDRDdj[_0x2b8f40(0x372)](_0xdae938);else{const _0x139360=_0x3114e0?new RegExp(''+_0x3114e0,'i'):new RegExp('.*');let _0x5a46be={};_0x25ada6['EdIZY'](isNaN,_0x25ada6['MgmoS'](Number,_0x3114e0))?_0x5a46be={'userId':{'$regex':_0x139360}}:_0x5a46be={'userId':_0x25ada6[_0x2b8f40(0x29f)](Number,_0x3114e0)},_0x540d19[_0x2b8f40(0x13b)]({'$match':{'$or':[_0x5a46be,{'username':{'$regex':_0x139360}},{'userFirstname':{'$regex':_0x139360}}]}});}}const _0x499549=M['getSessionData'](_0x3f614b),_0x4e11c6=_0x499549[_0x2b8f40(0x2a1)];let _0xfa25d1=await _0x5201ac[_0x2b8f40(0x1bf)](_0x540d19)[_0x2b8f40(0x16f)]();if(['S']['includes'](_0x4e11c6)){if(_0x25ada6[_0x2b8f40(0x19a)](_0x25ada6[_0x2b8f40(0x218)],_0x25ada6['Jcjxh'])){const _0x5b39f8=_0x499549[_0x2b8f40(0x231)];_0xfa25d1=_0xfa25d1[_0x2b8f40(0x28c)](_0x2739c9=>{const _0x1be424=_0x2b8f40,_0x100c99={'VvNYL':_0x25ada6['vgMfH']};if(_0x25ada6[_0x1be424(0x2b7)](_0x25ada6[_0x1be424(0x24c)],_0x25ada6[_0x1be424(0x24c)]))_0x54dc33[_0x1be424(0x18f)](_0x100c99['VvNYL'],_0x3e1660),_0x172bfb['status'](0x194)[_0x1be424(0x30e)](_0x7693e8);else{const _0x410415=_0x25ada6[_0x1be424(0x271)](_0x2739c9[_0x1be424(0x2a1)],'S')||_0x25ada6['EaNFy'](_0x2739c9[_0x1be424(0x231)],_0x5b39f8);return _0x25ada6[_0x1be424(0x22b)](_0x2739c9[_0x1be424(0x2a1)],'O')&&_0x410415;}});}else _0x429106[_0x2b8f40(0x165)]();}if(_0x109445)var _0x43ddde=await _0x5201ac[_0x2b8f40(0x1c9)]({'_id':new _0x3d2ab2(_0x109445)},{'projection':{'userPassword':0x0}});else var _0x43ddde={};if(_0x43ddde&&_0x25ada6[_0x2b8f40(0x31b)](Object[_0x2b8f40(0x1bc)](_0x43ddde)[_0x2b8f40(0x169)],0x0)){if(_0x25ada6['LFIfO'](_0x25ada6[_0x2b8f40(0x2ad)],_0x25ada6[_0x2b8f40(0x2ad)])){const _0x2c7a2a=_0x3f614b['flash'](_0x25ada6[_0x2b8f40(0x1e7)]);_0x2c7a2a&&_0x25ada6['dXNFq'](_0x2c7a2a[_0x2b8f40(0x169)],0x0)&&(_0x43ddde={..._0x2c7a2a[0x0]});}else{const _0x29f5e2=_0x25ada6['YhmYx'](_0x594456[_0x2b8f40(0x2a1)],'S')||_0x25ada6[_0x2b8f40(0x1e2)](_0x194973['userId'],_0x1ebbbf);return _0x25ada6[_0x2b8f40(0x23a)](_0x13baf6[_0x2b8f40(0x2a1)],'O')&&_0x29f5e2;}}const _0x908aa5=await H['renderView'](_0x25ada6[_0x2b8f40(0x1d4)],_0x3f8cf6,{'title':PAGE_MANAGE_USERS,'time':O[_0x2b8f40(0x1e4)](),'msg':_0x3f614b[_0x2b8f40(0x235)](_0x25ada6[_0x2b8f40(0x13a)]),'user':await M[_0x2b8f40(0x1b4)](_0x3f614b),'settings':await H[_0x2b8f40(0x28d)](),'load_id':_0x109445,'sip':_0x3114e0,'rpp':_0x3f8cff,'page':_0x58135d,'pagePre':_0x114633,'pageAct':_0x3229e8,'pageNxt':_0x3eebe2,'pageLst':_0x2dd171,'pageRedirect':b,'data':_0xfa25d1,'dataBranches':await z[_0x2b8f40(0x2db)]({'branchStatus':_0x25ada6[_0x2b8f40(0x248)]}),'PATH_MAIN':b,'PATH_PRINT':V,'PATH_SAVE':Q,'PATH_NEW':X,'PATH_LOAD':W,'PATH_DELETE':G,'PATH_CHANGES':Y,'PATH_DOWNLOAD_EXCEL':K,'PATH_UPLOAD_EXCEL':Z,'PREFIX':ne,'item':_0x43ddde});return _0x3f8cf6[_0x2b8f40(0x1d5)](_0x908aa5);}}catch(_0x231075){if(_0x25ada6['phMho'](_0x25ada6[_0x2b8f40(0x257)],_0x25ada6[_0x2b8f40(0x241)])){const _0x2b7b01=_0x1b08bf?new _0x4989bd(''+_0x285ed4,'i'):new _0x413300('.*');let _0x343c63={};_0x25ada6[_0x2b8f40(0x1be)](_0x1a66b6,_0x25ada6['EdIZY'](_0x37531e,_0x47541f))?_0x343c63={'userId':{'$regex':_0x2b7b01}}:_0x343c63={'userId':_0x25ada6[_0x2b8f40(0x1be)](_0x355e84,_0x430826)},_0x3e8dd6[_0x2b8f40(0x13b)]({'$match':{'$or':[_0x343c63,{'username':{'$regex':_0x2b7b01}},{'userFirstname':{'$regex':_0x2b7b01}}]}});}else console[_0x2b8f40(0x18f)](_0x231075[_0x2b8f40(0x1fa)]),_0x3f8cf6['status'](0x194)[_0x2b8f40(0x30e)](file404);}finally{_0x25ada6[_0x2b8f40(0x2ee)](_0x25ada6[_0x2b8f40(0x21c)],_0x25ada6[_0x2b8f40(0x1f9)])?_0x55f314[_0x2b8f40(0x165)]():_0x411579['close']();}}),x[_0x1cab3e(0x249)](W,_0x189327[_0x1cab3e(0x2fc)],async(_0x45f1a8,_0x1b0bed)=>{const _0x289a41=_0x1cab3e,_0x20abf1={'XtmDX':'error\x20===>\x20','iXqae':_0x289a41(0x37d),'shNdj':function(_0x351bad,_0x5eb84d){return _0x351bad(_0x5eb84d);},'SBDNX':function(_0x4a60fb,_0x49de41){return _0x4a60fb!==_0x49de41;},'IkrwI':'eEzmF','sPfiN':_0x289a41(0x27a),'giOVu':'msg','HcBBx':'Not\x20Found','YVrme':_0x289a41(0x2e6),'cRXRR':'VEGrh','AdbNZ':function(_0x169901,_0x4bd27d){return _0x169901!==_0x4bd27d;},'qIxUv':_0x289a41(0x1f8),'LzgPI':_0x289a41(0x294)},_0x3c85ee=_0x45f1a8[_0x289a41(0x353)]['load_id'],_0x1b0758=_0x45f1a8[_0x289a41(0x353)][_0x289a41(0x188)],_0xd7396d=_0x20abf1['shNdj'](Number,_0x45f1a8[_0x289a41(0x353)][_0x289a41(0x222)])||0x14,_0x7e943f=_0x20abf1[_0x289a41(0x1fb)](Number,_0x45f1a8['body'][_0x289a41(0x1ba)])||0x1,_0x164f66=b+_0x289a41(0x1ef)+_0x1b0758+_0x289a41(0x1a7)+_0xd7396d+_0x289a41(0x338)+_0x7e943f+_0x289a41(0x163)+_0x3c85ee,_0x2f3c2a=new _0x1f38fd(dbUrl);try{if(_0x20abf1[_0x289a41(0x20d)](_0x20abf1[_0x289a41(0x264)],_0x20abf1[_0x289a41(0x232)]))return await _0x2f3c2a['db'](dbName)[_0x289a41(0x14f)](dbColl_users)['findOne']({'_id':new _0x3d2ab2(_0x3c85ee)},{'projection':{'changesHistory':0x0}})?_0x45f1a8['flash'](_0x20abf1[_0x289a41(0x363)],null):_0x45f1a8[_0x289a41(0x235)](_0x20abf1[_0x289a41(0x363)],{'class':_0x20abf1[_0x289a41(0x265)],'text':new Error(_0x20abf1[_0x289a41(0x371)])+_0x289a41(0x358)+_0x3c85ee+'\x22'}),_0x1b0bed['redirect'](_0x164f66);else _0x1e9074[_0x289a41(0x2cf)](_0x3d2452[_0x289a41(0x324)])?_0x4beb8b['add'](_0x381579[_0x289a41(0x324)]):_0x3412c6[_0x289a41(0x22e)](_0x214928[_0x289a41(0x324)]);}catch(_0x1e28f7){return _0x20abf1[_0x289a41(0x20d)](_0x20abf1[_0x289a41(0x141)],_0x20abf1[_0x289a41(0x263)])?(console[_0x289a41(0x18f)](_0x1e28f7[_0x289a41(0x1fa)]),_0x45f1a8[_0x289a41(0x235)](_0x20abf1[_0x289a41(0x363)],{'class':_0x20abf1[_0x289a41(0x265)],'text':''+_0x1e28f7['message']}),_0x1b0bed[_0x289a41(0x148)](_0x164f66)):(_0x5a3a47[_0x289a41(0x18f)](_0x20abf1[_0x289a41(0x20b)],_0x5d41f0),_0x3a0f36['send']({'isDownload':!0x1,'color':_0x20abf1[_0x289a41(0x265)],'msg':_0x2928bb[_0x289a41(0x1fa)]}));}finally{_0x20abf1[_0x289a41(0x1ad)](_0x20abf1['qIxUv'],_0x20abf1[_0x289a41(0x2f4)])?_0x2f3c2a[_0x289a41(0x165)]():_0x21efc3['has'](_0x1a2670[_0x289a41(0x231)])?_0x560b40[_0x289a41(0x22e)](_0x3b54b1['userId']):_0x2fd6f4[_0x289a41(0x22e)](_0x31de07[_0x289a41(0x231)]);}}),x[_0x1cab3e(0x249)](Q,_0x189327[_0x1cab3e(0x2fc)],async(_0x39df4a,_0x5078cb)=>{const _0x6c2f2d=_0x1cab3e,_0x5b727d={'eBdff':'red','tguBo':function(_0x36ad17,_0xbca9ab){return _0x36ad17!==_0xbca9ab;},'wkoAC':function(_0x35efa4,_0x59794d){return _0x35efa4==_0x59794d;},'HvybE':_0x6c2f2d(0x2d0),'zGkOh':function(_0x39ef9f,_0x3bfbbc){return _0x39ef9f===_0x3bfbbc;},'idYlc':'AzihH','vXEAo':_0x6c2f2d(0x2c3),'rsMci':function(_0x4a8dc8,_0x55f1e4,_0x808b99){return _0x4a8dc8(_0x55f1e4,_0x808b99);},'iYHsQ':function(_0x3351fc){return _0x3351fc();},'nnAfG':function(_0x398377,_0x4ed19e){return _0x398377+_0x4ed19e;},'iXglc':_0x6c2f2d(0x276),'rGBjo':'gger','qnoJt':'stateObject','gWANj':'error\x20===>\x20','WXjce':function(_0x3088e7,_0x1cd039){return _0x3088e7>_0x1cd039;},'mNIJf':_0x6c2f2d(0x17b),'xpWYQ':'msg','kgYWv':_0x6c2f2d(0x2b8),'pgzWG':function(_0x386663,_0x59d8b9){return _0x386663(_0x59d8b9);},'vrLbp':_0x6c2f2d(0x386),'QQVdH':_0x6c2f2d(0x139),'PSRzz':function(_0x1b74ce,_0x3a1a18){return _0x1b74ce(_0x3a1a18);},'BiWdy':function(_0xc46622,_0x2d474a){return _0xc46622(_0x2d474a);},'obmuP':'รูปแบบอีเมลไม่ถูกต้อง','OoFUh':_0x6c2f2d(0x149),'zdFIZ':_0x6c2f2d(0x323),'PIcjr':function(_0x530794,_0x4b94a6){return _0x530794!==_0x4b94a6;},'yOjvO':'EULOt','apCrY':_0x6c2f2d(0x29b),'YRCOU':function(_0x1da570,_0x4e050b){return _0x1da570==_0x4e050b;},'sbwAf':_0x6c2f2d(0x2ff),'wBrgA':function(_0x5d71ae,_0x4419cd){return _0x5d71ae==_0x4419cd;},'DVHlo':function(_0x498b52,_0x5c43f4){return _0x498b52==_0x5c43f4;},'mCehq':function(_0x4c6e9e,_0x21b31b){return _0x4c6e9e==_0x21b31b;},'fCfdZ':function(_0x5afc5c,_0x2143d4){return _0x5afc5c===_0x2143d4;},'jmBmw':'DWOAP','osHOF':function(_0x5cea3c,_0x53630c){return _0x5cea3c!==_0x53630c;},'aWnjg':_0x6c2f2d(0x21a),'qXyaY':_0x6c2f2d(0x27f),'VoMaM':_0x6c2f2d(0x181),'ZdAde':_0x6c2f2d(0x266),'BTUDV':function(_0x285889,_0x1232ce){return _0x285889>_0x1232ce;},'ZFznY':_0x6c2f2d(0x2d8),'PTpMQ':'MTkGg','WwJsx':function(_0x2fdaaa,_0x2be61a){return _0x2fdaaa<_0x2be61a;},'eaywa':function(_0x427cfa,_0x164ab9){return _0x427cfa<_0x164ab9;},'ATFNU':_0x6c2f2d(0x1da),'Huelv':_0x6c2f2d(0x20e),'yjDNk':_0x6c2f2d(0x17d),'GaZvZ':_0x6c2f2d(0x22f),'QEwCJ':_0x6c2f2d(0x185),'oWtJH':function(_0x17c4c5,_0x4fb1a8){return _0x17c4c5>_0x4fb1a8;},'AKlHI':function(_0x3f734c,_0x38878b){return _0x3f734c+_0x38878b;},'KwXsI':_0x6c2f2d(0x339),'ZuMMf':function(_0x198779,_0x26a7bf){return _0x198779>_0x26a7bf;},'eWIUy':_0x6c2f2d(0x14e),'bUECO':_0x6c2f2d(0x22c),'LENjf':_0x6c2f2d(0x34d),'pwMbr':_0x6c2f2d(0x1fd),'pKPji':'ibszR','CKrhz':function(_0x281a56){return _0x281a56();}},_0x3b1eb4=[];let _0x28bd18=!0x1;const _0x7c6ad1=async()=>{const _0x44d6ca=_0x6c2f2d,_0x1a93e1={'GajoR':_0x5b727d['eBdff'],'YmDhD':function(_0x4b7173,_0x4e2267){const _0x29b87a=_0x1eb9;return _0x5b727d[_0x29b87a(0x1b9)](_0x4b7173,_0x4e2267);},'gcYFn':function(_0x534712,_0x392894){const _0x728b11=_0x1eb9;return _0x5b727d[_0x728b11(0x355)](_0x534712,_0x392894);}};if(_0x5b727d['tguBo'](_0x5b727d['HvybE'],_0x5b727d[_0x44d6ca(0x156)]))return _0x222c73['send']({'isDownload':!0x1,'color':_0x1a93e1[_0x44d6ca(0x162)],'msg':_0x1d482a[_0x44d6ca(0x1fa)]});else{if(_0x5b727d[_0x44d6ca(0x262)](_0x3b1eb4[_0x44d6ca(0x169)],0x0)){if(_0x5b727d[_0x44d6ca(0x262)](_0x5b727d[_0x44d6ca(0x2a0)],_0x5b727d['vXEAo'])){const _0x59b8ab={'jplHS':function(_0x5183fb,_0x37bf89){const _0x451bd8=_0x44d6ca;return _0x1a93e1[_0x451bd8(0x26e)](_0x5183fb,_0x37bf89);},'Frcsp':function(_0x38a72e,_0x3a8d6c){return _0x1a93e1['gcYFn'](_0x38a72e,_0x3a8d6c);},'UpZmK':function(_0x1db57e,_0x1cfa99){const _0x264b2d=_0x44d6ca;return _0x1a93e1[_0x264b2d(0x26e)](_0x1db57e,_0x1cfa99);}},_0x467c4f=_0x443cf6[_0x44d6ca(0x231)];_0x2687d3=_0x38d0c4['filter'](_0x318a72=>{const _0x4f98f9=_0x44d6ca,_0x3f08bf=_0x59b8ab[_0x4f98f9(0x300)](_0x318a72[_0x4f98f9(0x2a1)],'S')||_0x59b8ab[_0x4f98f9(0x2d5)](_0x318a72[_0x4f98f9(0x231)],_0x467c4f);return _0x59b8ab[_0x4f98f9(0x32f)](_0x318a72[_0x4f98f9(0x2a1)],'O')&&_0x3f08bf;});}else{_0x28bd18=!0x1;return;}}_0x28bd18=!0x0;const {req:_0x414883,res:_0x508cfd}=_0x3b1eb4[_0x44d6ca(0x1b5)]();await _0x5b727d[_0x44d6ca(0x1b3)](_0x54b030,_0x414883,_0x508cfd),_0x5b727d[_0x44d6ca(0x223)](_0x7c6ad1);}},_0x54b030=async(_0x17e07b,_0x51d383)=>{const _0x4fe229=_0x6c2f2d,_0x340b66={'LISoy':function(_0x61ea8a,_0x2decae){return _0x5b727d['WXjce'](_0x61ea8a,_0x2decae);},'CLsiU':_0x5b727d['mNIJf'],'xkjdo':_0x5b727d['xpWYQ'],'zOvRb':_0x5b727d['kgYWv'],'MoToO':function(_0x4e0c12,_0x103a96){const _0x597d93=_0x1eb9;return _0x5b727d[_0x597d93(0x212)](_0x4e0c12,_0x103a96);},'aLfLp':_0x5b727d[_0x4fe229(0x25a)],'wjDfV':_0x5b727d['eBdff']};if(_0x5b727d[_0x4fe229(0x262)](_0x5b727d['vrLbp'],_0x5b727d[_0x4fe229(0x378)])){const _0x382f0e=_0x84f65c['apply'](_0x4fd965,arguments);return _0x5b748c=null,_0x382f0e;}else{const _0x55ff3d=_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x255)];delete _0x17e07b[_0x4fe229(0x353)]['_id'];const _0x1eb44f=_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x188)],_0x2631aa=_0x5b727d[_0x4fe229(0x212)](Number,_0x17e07b['body'][_0x4fe229(0x222)])||0x14,_0x5c6355=_0x5b727d['PSRzz'](Number,_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x1ba)])||0x1;delete _0x17e07b['body'][_0x4fe229(0x222)],delete _0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x188)],delete _0x17e07b['body'][_0x4fe229(0x1ba)],_0x17e07b['body']['userId']=_0x17e07b[_0x4fe229(0x353)]['userId']?_0x5b727d[_0x4fe229(0x1fe)](Number,_0x17e07b['body'][_0x4fe229(0x231)]):_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x231)],_0x17e07b['body'][_0x4fe229(0x1cd)]=_0x17e07b['body'][_0x4fe229(0x1cd)]?_0x5b727d['BiWdy'](Number,_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x1cd)]):_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x1cd)];const _0x4284f9=_0x17e07b[_0x4fe229(0x353)]['username']?.['trim'](),_0x19adf5=_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x324)]?.[_0x4fe229(0x147)](),_0x5b4896=_0x17e07b['body'][_0x4fe229(0x231)],_0x4a0cf6=''+b,_0x1536f6=b+_0x4fe229(0x1ef)+_0x1eb44f+_0x4fe229(0x1a7)+_0x2631aa+_0x4fe229(0x338)+_0x5c6355+_0x4fe229(0x163)+_0x55ff3d;if(!new RegExp(USERNAME_PATTERN)[_0x4fe229(0x18c)](_0x4284f9))return _0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x283)],_0x17e07b[_0x4fe229(0x353)]),_0x17e07b['flash'](_0x5b727d['xpWYQ'],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':USERNAME_DESCRIPTION}),_0x51d383[_0x4fe229(0x148)](_0x1536f6);if(_0x19adf5&&!new RegExp(EMAIL_PATTERN)[_0x4fe229(0x18c)](_0x19adf5))return _0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x283)],_0x17e07b[_0x4fe229(0x353)]),_0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x27d)],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':_0x5b727d[_0x4fe229(0x2e5)]}),_0x51d383[_0x4fe229(0x148)](_0x1536f6);const _0x315c92=new _0x1f38fd(dbUrl);try{if(_0x5b727d[_0x4fe229(0x262)](_0x5b727d['OoFUh'],_0x5b727d['zdFIZ']))_0x11019d['log'](_0xc0e93a['message']),_0x408b40[_0x4fe229(0x1bb)](0x194)[_0x4fe229(0x30e)](_0x2f8417);else{await _0x315c92[_0x4fe229(0x270)]();const _0x3f37f4=_0x315c92['db'](dbName),_0x38b1ef=_0x3f37f4['collection'](dbColl_users);if(_0x55ff3d){if(_0x5b727d['PIcjr'](_0x5b727d[_0x4fe229(0x171)],_0x5b727d['yOjvO']))(function(){return![];}[_0x4fe229(0x243)](PqkRMu[_0x4fe229(0x1c6)](PqkRMu[_0x4fe229(0x253)],PqkRMu[_0x4fe229(0x34e)]))[_0x4fe229(0x32c)](PqkRMu[_0x4fe229(0x2c1)]));else{var _0x572671=await _0x38b1ef[_0x4fe229(0x1c9)]({'_id':{'$ne':new _0x3d2ab2(_0x55ff3d)},'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x19adf5+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x4284f9+'$','i')}},{'userId':_0x5b4896}]});if(_0x572671)return _0x17e07b['flash'](_0x5b727d['mNIJf'],_0x17e07b['body']),_0x17e07b[_0x4fe229(0x235)](_0x5b727d['xpWYQ'],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':_0x5b727d['apCrY']}),_0x51d383[_0x4fe229(0x148)](_0x1536f6);const _0x4334a4=await _0x38b1ef['findOne']({'_id':new _0x3d2ab2(_0x55ff3d)}),_0x41b91a=[_0x5b727d[_0x4fe229(0x1dc)](_0x17e07b['body'][_0x4fe229(0x282)],_0x5b727d[_0x4fe229(0x29e)]),_0x5b727d['wkoAC'](_0x4334a4[_0x4fe229(0x2f0)],_0x17e07b['body'][_0x4fe229(0x2f0)]),_0x5b727d[_0x4fe229(0x2b5)](_0x4334a4[_0x4fe229(0x324)],_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x324)]),_0x5b727d[_0x4fe229(0x1ac)](_0x4334a4[_0x4fe229(0x2a1)],_0x17e07b['body'][_0x4fe229(0x2a1)]),_0x5b727d[_0x4fe229(0x23c)](_0x4334a4[_0x4fe229(0x1cd)],_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x1cd)])],_0x59e2c1={'$set':_0x17e07b[_0x4fe229(0x353)]},_0x2183d7=await _0x38b1ef[_0x4fe229(0x173)]({'_id':new _0x3d2ab2(_0x55ff3d)},_0x59e2c1,{'upsert':!0x1});if(_0x2183d7[_0x4fe229(0x33f)]&&_0x5b727d[_0x4fe229(0x1dc)](_0x2183d7[_0x4fe229(0x2b3)],0x1)){if(_0x5b727d[_0x4fe229(0x1bd)](_0x5b727d['jmBmw'],_0x5b727d['jmBmw'])){const _0x2216d5=M['getSessionData'](_0x17e07b);let _0x2ccdb5=_0x4fe229(0x319)+_0x5b4896+'\x22\x20เรียบร้อยแล้ว';const _0x136512=z[_0x4fe229(0x1e8)](_0x4334a4,_0x17e07b[_0x4fe229(0x353)]);if(_0x136512&&_0x5b727d[_0x4fe229(0x269)](_0x136512[_0x4fe229(0x169)],0x0)){if(_0x5b727d[_0x4fe229(0x273)](_0x5b727d['aWnjg'],_0x5b727d[_0x4fe229(0x1aa)])){const _0x3c6f83={'dateTime':O['getDateTime'](),'userId':_0x2216d5[_0x4fe229(0x231)],'userFullname':_0x2216d5[_0x4fe229(0x27c)],'changes':_0x136512};await _0x38b1ef[_0x4fe229(0x173)]({'userId':_0x5b4896},{'$push':{'changesHistory':{'$each':[_0x3c6f83],'$position':0x0}}}),_0x2ccdb5+=_0x5b727d[_0x4fe229(0x34a)];}else _0x36df3b[_0x4fe229(0x165)]();}if(_0x41b91a[_0x4fe229(0x19b)](!0x1)){if(_0x5b727d[_0x4fe229(0x326)](_0x5b727d[_0x4fe229(0x1eb)],_0x5b727d['ZdAde'])){const _0x28ae64=_0x402987['insertedId'][_0x4fe229(0x2c6)](),_0xd6511f=_0x5d645e+'?sip='+_0x48a200+'&rpp='+_0x1e8b3b+_0x4fe229(0x338)+_0x5380af+_0x4fe229(0x163)+_0x28ae64,_0x51605e={..._0x36ee4d['body']};if(delete _0x51605e[_0x4fe229(0x258)],_0x5d5bad['includes']('@')&&_0x5de8f7['includes']('.')&&_0x340b66[_0x4fe229(0x193)](_0x2761c2[_0x4fe229(0x169)],0x5))_0x17c1d5[_0x4fe229(0x158)](_0x51605e,_0x3c524c)[_0x4fe229(0x236)](_0x2b04ee=>(_0x1a4a39[_0x4fe229(0x235)](_0x4fe229(0x26a),{'class':'green','text':_0x4fe229(0x35d)+_0x4b140b+_0x4fe229(0x1ca)+_0x2b04ee['response']+')'}),_0xc3b1c2[_0x4fe229(0x148)](_0xd6511f)))[_0x4fe229(0x206)](_0x2f070d=>(_0x429615[_0x4fe229(0x235)](_0x4fe229(0x17b),_0x3469b1['body']),_0x3daf14[_0x4fe229(0x235)](_0x4fe229(0x26a),{'class':_0x4fe229(0x37d),'text':''+_0x2f070d['message']}),_0x55cff0[_0x4fe229(0x148)](_0xd6511f)));else return _0x47a88a[_0x4fe229(0x235)](_0x340b66[_0x4fe229(0x388)],_0x57370a[_0x4fe229(0x353)]),_0x5de076[_0x4fe229(0x235)](_0x340b66[_0x4fe229(0x13d)],{'class':_0x340b66['zOvRb'],'text':_0x4fe229(0x2b1)+_0x48722d}),_0x562fce[_0x4fe229(0x148)](_0xd6511f);}else{const _0x3d8351=await _0x3f37f4[_0x4fe229(0x14f)](global['dbColl_sessions'])['deleteMany']({'session.user_id':_0x55ff3d});_0x3d8351['acknowledged']&&_0x5b727d[_0x4fe229(0x180)](_0x3d8351[_0x4fe229(0x2cb)],0x0)?_0x2ccdb5+=_0x4fe229(0x1e1)+_0x3d8351[_0x4fe229(0x2cb)]+_0x4fe229(0x2fe):_0x2ccdb5+=_0x5b727d[_0x4fe229(0x161)];}}if(_0x41b91a[_0x4fe229(0x19b)](!0x1)&&_0x5b727d[_0x4fe229(0x355)](_0x2216d5['user_id'],_0x55ff3d)){if(_0x5b727d['fCfdZ'](_0x5b727d['PTpMQ'],_0x5b727d[_0x4fe229(0x1a0)])){_0x17e07b['session'][_0x4fe229(0x2f3)](_0x5706a4=>(_0x5706a4&&console[_0x4fe229(0x18f)]('Session\x20destroy\x20error:\x20',_0x5706a4),_0x51d383[_0x4fe229(0x148)]('/')));return;}else{_0x1d5e99=!0x1;return;}}else return _0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x27d)],{'class':_0x5b727d['kgYWv'],'text':_0x2ccdb5}),_0x51d383[_0x4fe229(0x148)](_0x1536f6);}else RmdAnz[_0x4fe229(0x18b)](_0xbe58d2,0x0);}else return _0x2183d7[_0x4fe229(0x33f)]&&(_0x5b727d[_0x4fe229(0x2be)](_0x2183d7['modifiedCount'],0x1)||_0x5b727d[_0x4fe229(0x1a6)](_0x2183d7[_0x4fe229(0x1ff)],0x1))?(_0x17e07b[_0x4fe229(0x235)](_0x5b727d['xpWYQ'],{'class':_0x5b727d[_0x4fe229(0x305)],'text':'\x22'+_0x5b4896+_0x4fe229(0x164)}),_0x51d383[_0x4fe229(0x148)](_0x1536f6)):(_0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x283)],_0x17e07b[_0x4fe229(0x353)]),_0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x27d)],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':new Error(_0x5b727d[_0x4fe229(0x178)])+'{{sep}}\x22'+_0x5b4896+'\x22'}),_0x51d383[_0x4fe229(0x148)](_0x1536f6));}}else{if(_0x5b727d[_0x4fe229(0x1b9)](_0x5b727d[_0x4fe229(0x1dd)],_0x5b727d[_0x4fe229(0x14c)])){if(await _0x38b1ef[_0x4fe229(0x1c9)]({'$or':[{'userEmail':{'$regex':new RegExp('^'+_0x19adf5+'$','i')}},{'username':{'$regex':new RegExp('^'+_0x4284f9+'$','i')}}]}))return _0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x283)],_0x17e07b[_0x4fe229(0x353)]),_0x17e07b[_0x4fe229(0x235)](_0x5b727d['xpWYQ'],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':_0x5b727d['QEwCJ']}),_0x51d383[_0x4fe229(0x148)](_0x1536f6);const _0xd08ec9=await _0x38b1ef['find']({},{'projection':{'userId':0x1}})[_0x4fe229(0x35a)]({'userId':-0x1})['limit'](0x1)['toArray'](),_0x278de9=_0x5b727d[_0x4fe229(0x1b1)](_0xd08ec9['length'],0x0)?_0x5b727d[_0x4fe229(0x15f)](_0xd08ec9[0x0]['userId'],0x1):0x3e8;_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x231)]=_0x278de9,_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x320)]=O['getDateTime'](0x5a0);const _0x1c29bc=H[_0x4fe229(0x342)]();_0x17e07b[_0x4fe229(0x353)][_0x4fe229(0x258)]=await _0x511901[_0x4fe229(0x369)](_0x1c29bc,global[_0x4fe229(0x14a)]);const _0x44ac6f=await _0x38b1ef[_0x4fe229(0x24f)](_0x17e07b['body']);if(_0x44ac6f[_0x4fe229(0x33f)]&&_0x44ac6f[_0x4fe229(0x159)]){if(_0x5b727d['osHOF'](_0x5b727d[_0x4fe229(0x142)],_0x5b727d['KwXsI']))_0x2f5fe0=_0x31c1de;else{const _0x515303=_0x44ac6f['insertedId']['toString'](),_0x1b2c43=b+_0x4fe229(0x1ef)+_0x1eb44f+_0x4fe229(0x1a7)+_0x2631aa+'&page='+_0x5c6355+_0x4fe229(0x163)+_0x515303,_0x5582af={..._0x17e07b[_0x4fe229(0x353)]};if(delete _0x5582af['userPassword'],_0x19adf5['includes']('@')&&_0x19adf5[_0x4fe229(0x19b)]('.')&&_0x5b727d['ZuMMf'](_0x19adf5[_0x4fe229(0x169)],0x5))re[_0x4fe229(0x158)](_0x5582af,_0x1c29bc)['then'](_0x385ae5=>(_0x17e07b[_0x4fe229(0x235)](_0x4fe229(0x26a),{'class':_0x4fe229(0x2b8),'text':_0x4fe229(0x35d)+_0x19adf5+'){{sep}}(CODE\x20:\x20'+_0x385ae5[_0x4fe229(0x31d)]+')'}),_0x51d383[_0x4fe229(0x148)](_0x1b2c43)))['catch'](_0x5cda40=>(_0x17e07b['flash'](_0x4fe229(0x17b),_0x17e07b[_0x4fe229(0x353)]),_0x17e07b['flash']('msg',{'class':'red','text':''+_0x5cda40['message']}),_0x51d383[_0x4fe229(0x148)](_0x1b2c43)));else return _0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x283)],_0x17e07b['body']),_0x17e07b[_0x4fe229(0x235)](_0x5b727d[_0x4fe229(0x27d)],{'class':_0x5b727d[_0x4fe229(0x36e)],'text':_0x4fe229(0x2b1)+_0x19adf5}),_0x51d383[_0x4fe229(0x148)](_0x1b2c43);}}else _0x17e07b['flash'](_0x5b727d[_0x4fe229(0x27d)],{'class':_0x5b727d[_0x4fe229(0x2c8)],'text':_0x5b727d[_0x4fe229(0x2dc)]}),_0x51d383[_0x4fe229(0x148)](_0x4a0cf6);}else _0x32b618[_0x4fe229(0x18f)](_0x340b66[_0x4fe229(0x1ce)],_0x2e227d['message']),_0x1846bd[_0x4fe229(0x1d5)](_0x5e2fcf[_0x4fe229(0x240)]({'isPrint':!0x1,'class':_0x340b66[_0x4fe229(0x21e)],'msg':_0x53e875['message']}));}}}catch(_0x1ca3be){if(_0x5b727d['osHOF'](_0x5b727d['bUECO'],_0x5b727d['LENjf']))console['log'](_0x5b727d[_0x4fe229(0x25a)],_0x1ca3be),_0x51d383['status'](0x194)[_0x4fe229(0x30e)](file404);else{_0x12c49e[_0x4fe229(0x197)]['destroy'](_0x420bc9=>(_0x420bc9&&_0x1d3431[_0x4fe229(0x18f)](_0x4fe229(0x1d8),_0x420bc9),_0x559f81[_0x4fe229(0x148)]('/')));return;}}finally{_0x5b727d[_0x4fe229(0x273)](_0x5b727d[_0x4fe229(0x370)],_0x5b727d['pKPji'])?_0x315c92[_0x4fe229(0x165)]():(_0x253008['log'](_0x5b727d[_0x4fe229(0x25a)],_0x2652ca),_0x4ad8e1[_0x4fe229(0x1d5)](_0x3796cf[_0x4fe229(0x240)]({'isPrint':!0x1,'class':_0x5b727d[_0x4fe229(0x2c8)],'msg':_0x38553d[_0x4fe229(0x1fa)]})));}}};_0x3b1eb4[_0x6c2f2d(0x174)]({'req':_0x39df4a,'res':_0x5078cb}),_0x28bd18||_0x5b727d[_0x6c2f2d(0x2eb)](_0x7c6ad1);}),x[_0x1cab3e(0x249)](X,_0x189327[_0x1cab3e(0x2fc)],async(_0x5af9ad,_0x2146f0)=>{const _0x1b12dd=_0x1cab3e,_0x4b9e56={'eKHBk':_0x1b12dd(0x17b),'hfxyr':function(_0x4b389c,_0x155fec){return _0x4b389c>_0x155fec;},'dewtt':'function\x20*\x5c(\x20*\x5c)','LnRTq':_0x1b12dd(0x154),'aOcii':function(_0x307729,_0x35fe33){return _0x307729(_0x35fe33);},'DbdJb':'init','sGzVy':function(_0x364286,_0x5d12a7){return _0x364286+_0x5d12a7;},'UGXxt':'chain','LvJol':'input','SyGeq':function(_0x1f037c,_0x318368){return _0x1f037c(_0x318368);},'WEkHg':function(_0x2d6078){return _0x2d6078();},'fVxAY':function(_0x1d2f31,_0x3d5a7a,_0x5dbc3b){return _0x1d2f31(_0x3d5a7a,_0x5dbc3b);},'skcwY':function(_0x1a7148,_0x2ea0ee){return _0x1a7148!==_0x2ea0ee;},'TvxTI':'uJMeW','pCuhz':_0x1b12dd(0x293),'cNoIc':function(_0x334adf,_0x11d7e4){return _0x334adf>_0x11d7e4;},'sGBmJ':function(_0x2459f5,_0x344deb){return _0x2459f5+_0x344deb;},'hVgPv':_0x1b12dd(0x225),'XUxub':'qwerty','BMrOG':'active','hcRKI':'เกิดข้อผิดพลาดขณะเพิ่มผู้ใช้ใหม่','eqQzb':function(_0x1bf3bd,_0x29f674){return _0x1bf3bd===_0x29f674;},'EEdPv':_0x1b12dd(0x15b),'pYmpw':'FDtWm','sevvd':_0x1b12dd(0x31a),'ikjvS':_0x1b12dd(0x230),'QOsDl':_0x1b12dd(0x391)},_0xd95aa8=new _0x1f38fd(dbUrl),_0x483296=''+b;try{if(_0x4b9e56[_0x1b12dd(0x38b)](_0x4b9e56[_0x1b12dd(0x172)],_0x4b9e56[_0x1b12dd(0x217)])){await _0xd95aa8[_0x1b12dd(0x270)]();const _0x5b5e02=_0xd95aa8['db'](dbName)['collection'](dbColl_users);var _0x261389=await _0x5b5e02[_0x1b12dd(0x301)]({})[_0x1b12dd(0x35a)]({'userId':-0x1})[_0x1b12dd(0x2dd)](0x1)[_0x1b12dd(0x16f)](),_0x5a66a3=0x0;if(_0x4b9e56[_0x1b12dd(0x312)](_0x261389[_0x1b12dd(0x169)],0x0))_0x5a66a3=_0x4b9e56[_0x1b12dd(0x23d)](_0x261389[0x0]['userId'],0x1);else return _0x2146f0[_0x1b12dd(0x1d5)]({'isCreate':!0x1,'msg':_0x4b9e56[_0x1b12dd(0x2a5)],'redirectUrl':_0x483296});const _0x4d09a4=process[_0x1b12dd(0x29a)][_0x1b12dd(0x221)]||_0x4b9e56[_0x1b12dd(0x382)],_0x2abaed={'userId':_0x5a66a3,'userEmail':_0x1b12dd(0x337)+_0x5a66a3+'@gmail.com','username':_0x1b12dd(0x337)+_0x5a66a3,'userPrefix':'','userFirstname':_0x1b12dd(0x337)+_0x5a66a3,'userLastname':'','userAuthority':'U','userIsActive':_0x4b9e56[_0x1b12dd(0x291)],'userPassword':await _0x511901['hash'](_0x4d09a4,global[_0x1b12dd(0x14a)]),'branchId':0x64,'dateTimeCanDelete':O[_0x1b12dd(0x208)](oe)},_0x2f0ef1=await _0x5b5e02[_0x1b12dd(0x24f)](_0x2abaed);return _0x2f0ef1[_0x1b12dd(0x33f)]&&_0x2f0ef1[_0x1b12dd(0x159)]?_0x2146f0[_0x1b12dd(0x1d5)]({'isCreate':!0x0,'msg':_0x1b12dd(0x1c1)+_0x2abaed[_0x1b12dd(0x2f0)]+_0x1b12dd(0x1a1)+_0x4d09a4+_0x1b12dd(0x2df),'redirectUrl':b+_0x1b12dd(0x334)+_0x2f0ef1[_0x1b12dd(0x159)][_0x1b12dd(0x2c6)]()}):_0x2146f0[_0x1b12dd(0x1d5)]({'isCreate':!0x1,'msg':_0x4b9e56[_0x1b12dd(0x244)],'redirectUrl':_0x483296});}else _0x2f1022[_0x1b12dd(0x2cf)](_0x8b4638[_0x1b12dd(0x2f0)])?_0x417ac8[_0x1b12dd(0x22e)](_0x1f09d6[_0x1b12dd(0x2f0)]):_0x53e535[_0x1b12dd(0x22e)](_0x3e880c[_0x1b12dd(0x2f0)]);}catch(_0x10e4b4){if(_0x4b9e56[_0x1b12dd(0x2a8)](_0x4b9e56[_0x1b12dd(0x1de)],_0x4b9e56['pYmpw'])){const _0x32662f=_0x147e1a[_0x1b12dd(0x235)](_0x4b9e56[_0x1b12dd(0x1e6)]);_0x32662f&&_0x4b9e56[_0x1b12dd(0x314)](_0x32662f['length'],0x0)&&(_0x1f77ef={..._0x32662f[0x0]});}else console[_0x1b12dd(0x18f)](_0x4b9e56[_0x1b12dd(0x1f2)],_0x10e4b4),_0x2146f0[_0x1b12dd(0x1bb)](0x194)[_0x1b12dd(0x30e)](_0x483296);}finally{_0x4b9e56[_0x1b12dd(0x38b)](_0x4b9e56[_0x1b12dd(0x2e9)],_0x4b9e56[_0x1b12dd(0x22d)])?_0xd95aa8['close']():aoDqlR['fVxAY'](_0x57186b,this,function(){const _0x3b05e2=_0x1b12dd,_0xd873a9=new _0x47dea7(aoDqlR[_0x3b05e2(0x38f)]),_0x4da56c=new _0x32e4b5(aoDqlR[_0x3b05e2(0x333)],'i'),_0x8efab5=aoDqlR[_0x3b05e2(0x1c2)](_0x132b04,aoDqlR[_0x3b05e2(0x1df)]);!_0xd873a9[_0x3b05e2(0x18c)](aoDqlR[_0x3b05e2(0x2f9)](_0x8efab5,aoDqlR[_0x3b05e2(0x275)]))||!_0x4da56c[_0x3b05e2(0x18c)](aoDqlR[_0x3b05e2(0x2f9)](_0x8efab5,aoDqlR[_0x3b05e2(0x1d1)]))?aoDqlR['SyGeq'](_0x8efab5,'0'):aoDqlR[_0x3b05e2(0x205)](_0x3b7010);})();}}),x[_0x1cab3e(0x249)](G,_0x189327['isOS'],async(_0x14de66,_0x56f051)=>{const _0x5f22fb=_0x1cab3e,_0x4006c8={'IQXKh':function(_0x4831e6,_0x164d95){return _0x4831e6(_0x164d95);},'JzPJS':function(_0x4be443,_0x554314){return _0x4be443(_0x554314);},'GwRWy':function(_0x5713dc,_0x59803d){return _0x5713dc+_0x59803d;},'mSglq':'return\x20(function()\x20','nRedB':_0x5f22fb(0x170),'NDGRK':function(_0x144d81){return _0x144d81();},'qBPHa':function(_0x1c9f73,_0x470df9){return _0x1c9f73(_0x470df9);},'TSPEQ':function(_0x498c4a,_0x49cc81){return _0x498c4a!=_0x49cc81;},'FEveJ':function(_0x1c6721,_0x335449){return _0x1c6721!==_0x335449;},'RSXeK':'FvARw','biDCF':'userId','sJYQT':function(_0x820b76,_0x579e5d){return _0x820b76===_0x579e5d;},'TQjtR':_0x5f22fb(0x16d),'GpChr':_0x5f22fb(0x26a),'ZdAUw':'red','TtwBi':function(_0x36986f,_0xe7ceca){return _0x36986f===_0xe7ceca;},'VryUU':_0x5f22fb(0x151),'rCnsG':'itEtg','rDHtD':function(_0x6307cc,_0x6c33a5){return _0x6307cc>_0x6c33a5;},'TiDrT':_0x5f22fb(0x2d8),'pxxAU':_0x5f22fb(0x2b8),'NuJVF':function(_0xd8646b,_0x54b23c){return _0xd8646b!==_0x54b23c;},'YcqpG':_0x5f22fb(0x20a),'EDjEN':'error\x20===>\x20','eYORa':function(_0x128ede,_0x57975d){return _0x128ede===_0x57975d;},'WopIJ':_0x5f22fb(0x2ef),'VorKb':_0x5f22fb(0x268)};let {_id_toDelete:_0x218565,load_id:_0x2bb73f,sip:_0x3e16bd,Id_toDelete:_0x4fff5e}=_0x14de66[_0x5f22fb(0x353)];const _0x3ad073=_0x4006c8['IQXKh'](Number,_0x14de66[_0x5f22fb(0x353)]['rpp'])||0x14,_0x420a4e=_0x4006c8[_0x5f22fb(0x1b7)](Number,_0x14de66[_0x5f22fb(0x353)][_0x5f22fb(0x1ba)])||0x1;_0x4fff5e=_0x4006c8['qBPHa'](Number,_0x4fff5e);const _0x4981a7=_0x218565&&_0x4006c8['TSPEQ'](_0x218565,_0x2bb73f)?_0x5f22fb(0x163)+_0x218565:'',_0x4136f9=b+_0x5f22fb(0x1ef)+_0x3e16bd+_0x5f22fb(0x1a7)+_0x3ad073+_0x5f22fb(0x338)+_0x420a4e+_0x4981a7,_0x2fca36=new _0x1f38fd(global['dbUrl']);try{if(_0x4006c8[_0x5f22fb(0x1ab)](_0x4006c8[_0x5f22fb(0x25d)],_0x4006c8[_0x5f22fb(0x25d)]))_0x16ff5e[_0x5f22fb(0x231)]=_0x4006c8[_0x5f22fb(0x1b7)](_0x5cf5ad,_0x14bb33[_0x5f22fb(0x231)]),_0x213a8f[_0x5f22fb(0x1cd)]=_0x4006c8[_0x5f22fb(0x1b7)](_0x4d19be,_0x4c1371[_0x5f22fb(0x1cd)]),_0x2f66ee['userIsActive']||(_0x1f03b7[_0x5f22fb(0x282)]=''),_0x5acd0c['userPhone']||(_0x120c9e['userPhone']=''),_0x4e3243[_0x5f22fb(0x2b9)]||(_0x904ba1['userPrefix']=''),_0x3a4465[_0x5f22fb(0x2c4)]||(_0x5453f7['userLastname']=''),delete _0x84474e[_0x5f22fb(0x182)],delete _0x5b97fd[_0x5f22fb(0x1ed)],delete _0x4247ba[_0x5f22fb(0x13c)],delete _0x42c46c[_0x5f22fb(0x182)];else{await _0x2fca36['connect']();const _0x522cb4=_0x2fca36['db'](global[_0x5f22fb(0x332)]),_0x2913e7=_0x522cb4[_0x5f22fb(0x14f)](global[_0x5f22fb(0x313)]),_0xeee82d=[{'coll':_0x522cb4['collection'](global[_0x5f22fb(0x1f4)]),'name':global['dbColl_warehouseIn'],'key':_0x4006c8['biDCF']},{'coll':_0x522cb4[_0x5f22fb(0x14f)](global[_0x5f22fb(0x1b0)]),'name':global['dbColl_warehouseOut'],'key':_0x4006c8[_0x5f22fb(0x242)]},{'coll':_0x522cb4[_0x5f22fb(0x14f)](global['dbColl_sales']),'name':global[_0x5f22fb(0x331)],'key':_0x4006c8[_0x5f22fb(0x242)]},{'coll':_0x522cb4[_0x5f22fb(0x14f)](global['dbColl_return']),'name':global[_0x5f22fb(0x1d9)],'key':_0x4006c8['biDCF']}];for(const {coll:_0x54b238,name:_0x38526c,key:_0xb4de0a}of _0xeee82d){if(_0x4006c8[_0x5f22fb(0x24e)](_0x4006c8[_0x5f22fb(0x1f6)],_0x4006c8[_0x5f22fb(0x1f6)])){const _0x1c05f1={};if(_0x1c05f1[_0xb4de0a]=_0x4fff5e,await _0x54b238[_0x5f22fb(0x1c9)](_0x1c05f1))return await _0x2913e7[_0x5f22fb(0x173)]({'userId':_0x4fff5e},{'$set':{'canDelete':!0x1}}),_0x14de66[_0x5f22fb(0x235)](_0x4006c8[_0x5f22fb(0x2ba)],{'class':_0x4006c8[_0x5f22fb(0x261)],'text':_0x5f22fb(0x325)+_0x4fff5e+_0x5f22fb(0x2d4)+_0x38526c+_0x5f22fb(0x37b)}),_0x56f051[_0x5f22fb(0x148)](_0x4136f9);}else return!![];}if(_0x4006c8[_0x5f22fb(0x24e)]((await _0x2913e7[_0x5f22fb(0x2d7)]({'_id':new _0x3d2ab2(_0x218565)}))[_0x5f22fb(0x2cb)],0x1)){if(_0x4006c8[_0x5f22fb(0x2e4)](_0x4006c8[_0x5f22fb(0x1c4)],_0x4006c8[_0x5f22fb(0x1fc)])){const _0x375a58=ZsPapf['JzPJS'](_0x143799,ZsPapf[_0x5f22fb(0x360)](ZsPapf[_0x5f22fb(0x360)](ZsPapf['mSglq'],ZsPapf[_0x5f22fb(0x309)]),');'));_0x2268dc=ZsPapf[_0x5f22fb(0x239)](_0x375a58);}else{const _0x361b48=await _0x522cb4[_0x5f22fb(0x14f)](global['dbColl_sessions'])[_0x5f22fb(0x176)]({'session.user_id':_0x218565});if(_0x361b48[_0x5f22fb(0x33f)]&&_0x4006c8[_0x5f22fb(0x306)](_0x361b48[_0x5f22fb(0x2cb)],0x0))var _0x31a90b=_0x5f22fb(0x1e1)+_0x361b48[_0x5f22fb(0x2cb)]+_0x5f22fb(0x2fe);else var _0x31a90b=_0x4006c8['TiDrT'];_0x14de66[_0x5f22fb(0x235)](_0x4006c8[_0x5f22fb(0x2ba)],{'class':_0x4006c8[_0x5f22fb(0x191)],'text':_0x5f22fb(0x278)+_0x4fff5e+_0x5f22fb(0x2fa)+_0x31a90b});}}else _0x14de66['flash'](_0x4006c8[_0x5f22fb(0x2ba)],{'class':_0x4006c8['ZdAUw'],'text':_0x5f22fb(0x341)+_0x4fff5e+_0x5f22fb(0x32e)});return _0x56f051[_0x5f22fb(0x148)](_0x4136f9);}}catch(_0x43c3ef){if(_0x4006c8[_0x5f22fb(0x1d6)](_0x4006c8[_0x5f22fb(0x32d)],_0x4006c8[_0x5f22fb(0x32d)]))_0x413165[_0x5f22fb(0x165)]();else return console[_0x5f22fb(0x18f)](_0x4006c8[_0x5f22fb(0x146)],_0x43c3ef),_0x14de66['flash'](_0x4006c8[_0x5f22fb(0x2ba)],{'class':_0x4006c8[_0x5f22fb(0x261)],'text':_0x43c3ef[_0x5f22fb(0x1fa)]}),_0x56f051[_0x5f22fb(0x148)](_0x4136f9);}finally{_0x4006c8[_0x5f22fb(0x286)](_0x4006c8[_0x5f22fb(0x211)],_0x4006c8[_0x5f22fb(0x2e8)])?_0x14aacc[_0x5f22fb(0x165)]():_0x2fca36[_0x5f22fb(0x165)]();}}),x[_0x1cab3e(0x249)](V,_0x189327[_0x1cab3e(0x2fc)],async(_0x2e164c,_0x5006c8)=>{const _0x584e0a=_0x1cab3e,_0x2641b2={'vbvep':function(_0x4772de,_0x238b31){return _0x4772de(_0x238b31);},'hKfAO':function(_0x4c1eb3,_0x364e34){return _0x4c1eb3+_0x364e34;},'yTIrP':function(_0x4077ae,_0x382d24){return _0x4077ae+_0x382d24;},'TfOCp':'return\x20(function()\x20','rjOva':_0x584e0a(0x170),'qyjjX':function(_0x1075e3){return _0x1075e3();},'IBCOw':_0x584e0a(0x18f),'wUarc':_0x584e0a(0x2a6),'CbEIB':_0x584e0a(0x2ab),'vHJXW':_0x584e0a(0x2b6),'sgEHh':_0x584e0a(0x21d),'zEXUU':_0x584e0a(0x2a3),'bXaxS':_0x584e0a(0x365),'eqiLp':function(_0x482a28,_0x18adac){return _0x482a28<_0x18adac;},'uogqp':_0x584e0a(0x276),'dXjKq':_0x584e0a(0x385),'ytsou':_0x584e0a(0x19c),'gvoJx':function(_0x598c7f,_0x98ba97){return _0x598c7f!==_0x98ba97;},'SOkak':_0x584e0a(0x328),'LyLfn':'VBKGj','lrSqd':'branchId','uSUFr':_0x584e0a(0x16e),'PMQYe':_0x584e0a(0x2c2),'AFROr':function(_0x2e2e3f,_0x5ee427){return _0x2e2e3f==_0x5ee427;},'EtyqD':_0x584e0a(0x37d),'moGTS':'ไม่มีข้อมูล','MzPrH':_0x584e0a(0x38a),'MyBUs':_0x584e0a(0x307),'MulKA':_0x584e0a(0x2b8),'TLlGX':function(_0x1a93fc,_0x3ba648){return _0x1a93fc===_0x3ba648;},'PiaPY':_0x584e0a(0x29c),'HDFDD':_0x584e0a(0x31a),'KHksu':function(_0x5ba5cb,_0x482bd1){return _0x5ba5cb!==_0x482bd1;},'WEyMO':_0x584e0a(0x373),'Gspiz':_0x584e0a(0x2ec)},{_idArr:_0x4d9421}=_0x2e164c[_0x584e0a(0x353)],_0x1e1813=new _0x1f38fd(dbUrl);try{if(_0x2641b2['gvoJx'](_0x2641b2[_0x584e0a(0x2f6)],_0x2641b2['LyLfn'])){await _0x1e1813['connect']();const _0x412b03=await _0x1e1813['db'](dbName)['collection'](dbColl_users)['aggregate']([{'$match':{'_id':{'$in':_0x4d9421['map'](_0x16e8a9=>new _0x3d2ab2(_0x16e8a9))}}},{'$lookup':{'from':global[_0x584e0a(0x23b)],'localField':_0x2641b2[_0x584e0a(0x298)],'foreignField':_0x2641b2[_0x584e0a(0x298)],'as':_0x2641b2[_0x584e0a(0x18d)]}},{'$addFields':{'branchName':{'$ifNull':[{'$arrayElemAt':[_0x2641b2[_0x584e0a(0x216)],0x0]},'']}}},{'$project':{'branchInfo':0x0}}])['toArray']();if(_0x2641b2[_0x584e0a(0x348)](_0x412b03[_0x584e0a(0x169)],0x0))return _0x5006c8[_0x584e0a(0x1d5)](JSON[_0x584e0a(0x240)]({'isPrint':!0x1,'class':_0x2641b2[_0x584e0a(0x357)],'msg':_0x2641b2[_0x584e0a(0x304)]}));const _0x5437f1=_0x2252af[_0x584e0a(0x1cb)](global[_0x584e0a(0x2d2)],_0x2641b2['MzPrH']),_0x5ca01a=_0xf2da5b[_0x584e0a(0x25c)](_0x5437f1,_0x2641b2[_0x584e0a(0x32a)]),_0x53a733=_0xab1018[_0x584e0a(0x36d)](_0x5ca01a,{'time':O['getDate'](),'title':_0x584e0a(0x2a7)+_0x412b03[_0x584e0a(0x169)]+')','dateTime':O[_0x584e0a(0x208)](),'usersFind':_0x412b03});_0x5006c8['send'](JSON[_0x584e0a(0x240)]({'isPrint':!0x0,'class':_0x2641b2[_0x584e0a(0x1ec)],'msg':'พิมพ์ข้อมูล\x20'+_0x412b03[_0x584e0a(0x169)]+_0x584e0a(0x281),'htmlPage':_0x53a733}));}else return _0x164ba6;}catch(_0xcf4b89){if(_0x2641b2['TLlGX'](_0x2641b2[_0x584e0a(0x375)],_0x2641b2[_0x584e0a(0x375)]))console[_0x584e0a(0x18f)](_0x2641b2['HDFDD'],_0xcf4b89[_0x584e0a(0x1fa)]),_0x5006c8[_0x584e0a(0x1d5)](JSON[_0x584e0a(0x240)]({'isPrint':!0x1,'class':_0x2641b2[_0x584e0a(0x357)],'msg':_0xcf4b89[_0x584e0a(0x1fa)]}));else{let _0x13f07d;try{const _0x344f46=ACiKfo[_0x584e0a(0x1a3)](_0xc2ff22,ACiKfo[_0x584e0a(0x390)](ACiKfo[_0x584e0a(0x160)](ACiKfo[_0x584e0a(0x2da)],ACiKfo['rjOva']),');'));_0x13f07d=ACiKfo[_0x584e0a(0x2cd)](_0x344f46);}catch(_0x4e0f30){_0x13f07d=_0x22b6ec;}const _0x672623=_0x13f07d[_0x584e0a(0x26f)]=_0x13f07d[_0x584e0a(0x26f)]||{},_0x5ba807=[ACiKfo['IBCOw'],ACiKfo[_0x584e0a(0x2ac)],ACiKfo[_0x584e0a(0x295)],ACiKfo[_0x584e0a(0x14b)],ACiKfo[_0x584e0a(0x310)],ACiKfo[_0x584e0a(0x359)],ACiKfo[_0x584e0a(0x284)]];for(let _0x3021a2=0x0;ACiKfo['eqiLp'](_0x3021a2,_0x5ba807[_0x584e0a(0x169)]);_0x3021a2++){const _0xd514e2=_0x4dd451['constructor'][_0x584e0a(0x186)][_0x584e0a(0x234)](_0x6adbe0),_0x57c866=_0x5ba807[_0x3021a2],_0x14ea8d=_0x672623[_0x57c866]||_0xd514e2;_0xd514e2['__proto__']=_0x2781bd[_0x584e0a(0x234)](_0x457cde),_0xd514e2[_0x584e0a(0x2c6)]=_0x14ea8d[_0x584e0a(0x2c6)][_0x584e0a(0x234)](_0x14ea8d),_0x672623[_0x57c866]=_0xd514e2;}}}finally{_0x2641b2[_0x584e0a(0x277)](_0x2641b2[_0x584e0a(0x350)],_0x2641b2[_0x584e0a(0x336)])?_0x1e1813[_0x584e0a(0x165)]():function(){return!![];}[_0x584e0a(0x243)](ACiKfo[_0x584e0a(0x160)](ACiKfo['uogqp'],ACiKfo['dXjKq']))['call'](ACiKfo[_0x584e0a(0x24a)]);}}),x[_0x1cab3e(0x249)](Y,_0x189327['isOS'],async(_0x3e8b96,_0x218ca6)=>{const _0x142a74=_0x1cab3e,_0x286757={'OBjzt':_0x142a74(0x31a),'pjiNf':_0x142a74(0x26a),'QBtef':_0x142a74(0x37d),'dEDWT':function(_0x1eba70,_0x541fdc){return _0x1eba70(_0x541fdc);},'WApYY':function(_0x3c8f0e,_0x5be2e8){return _0x3c8f0e!==_0x5be2e8;},'JGhaJ':_0x142a74(0x166),'edIzK':'YPXBr','hTzKM':function(_0x17ec8a,_0x2e41ed){return _0x17ec8a<_0x2e41ed;},'QXwZZ':_0x142a74(0x1da),'BYVJG':'ไม่พบประวัติการเปลี่ยนแปลง','kmJdJ':_0x142a74(0x25f),'xswNg':_0x142a74(0x2b8),'fkDGL':function(_0x593fb9,_0x10a19f){return _0x593fb9!==_0x10a19f;},'xbwFK':'nQFKv','rZcEW':'CmBYc','rTVAX':function(_0x578b59,_0x556f80){return _0x578b59!==_0x556f80;},'PpVRd':_0x142a74(0x36f),'NSLSt':_0x142a74(0x215)};let {userId:_0x2b522f}=_0x3e8b96[_0x142a74(0x353)];_0x2b522f=_0x286757[_0x142a74(0x315)](Number,_0x2b522f);const _0x43f7a8=new _0x1f38fd(global['dbUrl']);try{if(_0x286757[_0x142a74(0x297)](_0x286757[_0x142a74(0x16b)],_0x286757[_0x142a74(0x20f)])){await _0x43f7a8[_0x142a74(0x270)]();var _0x37f366=await _0x43f7a8['db'](global[_0x142a74(0x332)])[_0x142a74(0x14f)](global[_0x142a74(0x313)])[_0x142a74(0x1c9)]({'userId':_0x2b522f});if(!_0x37f366)return _0x218ca6[_0x142a74(0x1d5)](JSON[_0x142a74(0x240)]({'isPrint':!0x1,'class':_0x286757[_0x142a74(0x179)],'msg':_0x142a74(0x341)+_0x2b522f+'\x22'}));const _0x5bb0c6=_0x37f366['changesHistory']||[];if(_0x286757[_0x142a74(0x346)](_0x5bb0c6[_0x142a74(0x169)],0x1))return _0x218ca6[_0x142a74(0x1d5)](JSON[_0x142a74(0x240)]({'isPrint':!0x1,'class':_0x286757[_0x142a74(0x35b)],'msg':_0x286757[_0x142a74(0x168)]}));const _0x3b98ef=_0x2252af[_0x142a74(0x1cb)](folderForms,_0x286757[_0x142a74(0x343)]),_0x24618a=await H[_0x142a74(0x290)](_0x3b98ef,_0x218ca6,{'title':_0x142a74(0x245)+_0x37f366[_0x142a74(0x231)]+']\x20'+_0x37f366[_0x142a74(0x2b9)]+'\x20'+_0x37f366[_0x142a74(0x194)]+'\x20'+_0x37f366['userLastname'],'time':O['getDateTime'](),'changesHistory':_0x5bb0c6});_0x218ca6['send'](JSON[_0x142a74(0x240)]({'isPrint':!0x0,'class':_0x286757[_0x142a74(0x203)],'htmlPage':_0x24618a}));}else{if(_0x3fcc0e){const _0x2dba17=_0x4d0e55['apply'](_0x55774b,arguments);return _0x1a6578=null,_0x2dba17;}}}catch(_0x396432){_0x286757[_0x142a74(0x2c5)](_0x286757[_0x142a74(0x2f2)],_0x286757[_0x142a74(0x34f)])?(console[_0x142a74(0x18f)](_0x286757[_0x142a74(0x28e)],_0x396432),_0x218ca6['send'](JSON[_0x142a74(0x240)]({'isPrint':!0x1,'class':_0x286757[_0x142a74(0x179)],'msg':_0x396432[_0x142a74(0x1fa)]}))):(_0x246417[_0x142a74(0x18f)](_0x286757['OBjzt'],_0x4097f3),_0xae4914[_0x142a74(0x1bb)](0x194)[_0x142a74(0x30e)](_0x2f5e1c));}finally{if(_0x286757[_0x142a74(0x19e)](_0x286757[_0x142a74(0x2e7)],_0x286757[_0x142a74(0x18e)]))_0x43f7a8[_0x142a74(0x165)]();else return _0x2383de['log'](_0x286757['OBjzt'],_0xf607c1),_0x1eeee9[_0x142a74(0x235)](_0x286757['pjiNf'],{'class':_0x286757[_0x142a74(0x179)],'text':_0x2aebe0[_0x142a74(0x1fa)]}),_0xd1d43[_0x142a74(0x148)](_0x441001);}}),x['post'](K,_0x189327['isOS'],async(_0x46c232,_0x3cc782)=>{const _0x10b08d=_0x1cab3e,_0x2f438e={'jWZSj':_0x10b08d(0x30d),'vbrQX':_0x10b08d(0x154),'lPIIO':function(_0x2c5e41,_0x98fab2){return _0x2c5e41(_0x98fab2);},'IasWs':_0x10b08d(0x2b2),'pMGFB':function(_0x3e1908,_0x5900bf){return _0x3e1908+_0x5900bf;},'PZLaq':'chain','Bfmaj':function(_0x1b9903,_0x4da6cf){return _0x1b9903+_0x4da6cf;},'xWreT':'input','BLKof':function(_0x3369e8){return _0x3369e8();},'FqhzP':function(_0x2bcfee,_0x352bc2){return _0x2bcfee(_0x352bc2);},'cUPZu':function(_0xf6edfb,_0x5094a3){return _0xf6edfb!==_0x5094a3;},'vHVKd':_0x10b08d(0x15a),'EDwvc':_0x10b08d(0x192),'eHAlN':function(_0x1c0ed1,_0x4462d4){return _0x1c0ed1==_0x4462d4;},'lkONj':_0x10b08d(0x37d),'yXLLb':'ไม่มีข้อมูล','TDSdv':_0x10b08d(0x285),'RyPfn':_0x10b08d(0x2f1),'gEsIB':_0x10b08d(0x267),'OwLWr':_0x10b08d(0x2b8),'NfCid':_0x10b08d(0x155),'ZMYuk':'base64','UtXjk':function(_0x9f9c26,_0x44d3dc){return _0x9f9c26===_0x44d3dc;},'ZeZFH':_0x10b08d(0x17c)},_0x3ea121=new _0x1f38fd(dbUrl);try{if(_0x2f438e[_0x10b08d(0x153)](_0x2f438e['vHVKd'],_0x2f438e[_0x10b08d(0x1d2)])){const _0x45cd47=new _0x1b2bf1(OMVUIj[_0x10b08d(0x2e2)]),_0x3d89f5=new _0x4e9f01(OMVUIj[_0x10b08d(0x31e)],'i'),_0x3ac7bc=OMVUIj[_0x10b08d(0x220)](_0x5bf326,OMVUIj[_0x10b08d(0x238)]);!_0x45cd47[_0x10b08d(0x18c)](OMVUIj[_0x10b08d(0x15d)](_0x3ac7bc,OMVUIj[_0x10b08d(0x37a)]))||!_0x3d89f5[_0x10b08d(0x18c)](OMVUIj[_0x10b08d(0x34c)](_0x3ac7bc,OMVUIj[_0x10b08d(0x374)]))?OMVUIj[_0x10b08d(0x220)](_0x3ac7bc,'0'):OMVUIj[_0x10b08d(0x157)](_0x4b7a81);}else{await _0x3ea121[_0x10b08d(0x270)]();const _0xf8119b=await _0x3ea121['db'](dbName)[_0x10b08d(0x14f)](dbColl_users)[_0x10b08d(0x1bf)]([{'$project':{'_id':0x0,'userId':0x1,'username':0x1,'branchId':0x1,'userIsActive':0x1,'userAuthority':0x1,'userEmail':0x1,'userPhone':0x1,'userPrefix':0x1,'userFirstname':0x1,'userLastname':0x1,'dateTimeCanDelete':0x1,'userLastLogin':0x1,'userNormalLoginCount':0x1,'changesHistoryCount':{'$size':{'$ifNull':[_0x2f438e[_0x10b08d(0x33d)],[]]}}}},{'$sort':{'userId':0x1}}])['toArray']();if(_0x2f438e[_0x10b08d(0x2ea)](_0xf8119b[_0x10b08d(0x169)],0x0))return _0x3cc782[_0x10b08d(0x1d5)](JSON[_0x10b08d(0x240)]({'isDownload':!0x1,'class':_0x2f438e[_0x10b08d(0x32b)],'msg':_0x2f438e[_0x10b08d(0x1e3)]}));const _0x132fdd='users_'+O[_0x10b08d(0x208)]()[_0x10b08d(0x1b6)](/[: ]/g,'-')+_0x10b08d(0x17f),_0x42e604=_0x2b1b4e[_0x10b08d(0x1b8)]['json_to_sheet'](_0xf8119b),_0x5c68fd=_0x2b1b4e['utils'][_0x10b08d(0x2d6)]();_0x2b1b4e[_0x10b08d(0x1b8)]['book_append_sheet'](_0x5c68fd,_0x42e604,_0x2f438e['TDSdv']);const _0x4b3b14=_0x2b1b4e[_0x10b08d(0x251)](_0x5c68fd,{'type':_0x2f438e[_0x10b08d(0x13f)],'bookType':_0x2f438e[_0x10b08d(0x2f5)]});_0x3cc782[_0x10b08d(0x1d5)]({'isDownload':!0x0,'color':_0x2f438e[_0x10b08d(0x26b)],'msg':_0x2f438e[_0x10b08d(0x389)],'filename':_0x132fdd,'fileData':_0x4b3b14[_0x10b08d(0x2c6)](_0x2f438e[_0x10b08d(0x2ae)])});}}catch(_0xe07e02){if(_0x2f438e[_0x10b08d(0x279)](_0x2f438e[_0x10b08d(0x190)],_0x2f438e[_0x10b08d(0x190)]))return _0x3cc782[_0x10b08d(0x1d5)]({'isDownload':!0x1,'color':_0x2f438e[_0x10b08d(0x32b)],'msg':_0xe07e02['message']});else OMVUIj[_0x10b08d(0x351)](_0x5a4ae5,'0');}finally{_0x3ea121[_0x10b08d(0x165)]();}});const ae=_0x2190d0({'storage':_0x2190d0[_0x1cab3e(0x38d)]()});x[_0x1cab3e(0x249)](Z,_0x189327[_0x1cab3e(0x2fc)],ae[_0x1cab3e(0x2d9)]('uploadExcelFile'),async(_0x24bb37,_0x49360c)=>{const _0x30309a=_0x1cab3e,_0x13ed8d={'WXmpx':function(_0x60234b,_0x57c376){return _0x60234b(_0x57c376);},'NxDVn':function(_0x5a9ef9,_0x1eaa7e){return _0x5a9ef9(_0x1eaa7e);},'JTvNz':_0x30309a(0x37d),'VmYsG':_0x30309a(0x362),'cJFBG':'buffer','iiZgm':_0x30309a(0x285),'RSbES':function(_0x4de46f,_0x520767){return _0x4de46f>_0x520767;},'KlxIN':'userId','dpypr':'username','BmPpw':'branchId','ZIMuA':_0x30309a(0x282),'aBAAm':_0x30309a(0x2a1),'VQATP':_0x30309a(0x324),'tXlZX':_0x30309a(0x2e1),'PpUmb':_0x30309a(0x2b9),'vmoyC':_0x30309a(0x194),'MkAnD':'userLastname','kBLXr':_0x30309a(0x320),'TWiiu':function(_0x57cd26,_0xb0f7c6){return _0x57cd26>_0xb0f7c6;},'OfuoC':_0x30309a(0x2ff),'OeUqS':function(_0x1a25c9,_0xfeac9a){return _0x1a25c9+_0xfeac9a;},'CJiyN':function(_0x43a153,_0x373a5b){return _0x43a153===_0x373a5b;},'AGXOj':function(_0x203f10,_0x318067){return _0x203f10===_0x318067;},'cPNgW':function(_0x55c7ac,_0x4e7a94){return _0x55c7ac>_0x4e7a94;},'CWOKq':function(_0x546e71,_0x232841){return _0x546e71+_0x232841;},'TnejD':_0x30309a(0x379),'Vkspq':_0x30309a(0x2b8),'FlpCk':_0x30309a(0x31a)},_0x128d36=new _0x1f38fd(dbUrl);try{if(!_0x24bb37[_0x30309a(0x167)])return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x13ed8d['VmYsG']});const _0xe23f22=_0x2b1b4e[_0x30309a(0x28a)](_0x24bb37['file'][_0x30309a(0x2f1)],{'type':_0x13ed8d[_0x30309a(0x229)]}),_0x27576d=[_0x13ed8d[_0x30309a(0x1ae)]],_0x4553d0=_0xe23f22['SheetNames'],_0x5bd18a=_0x27576d[_0x30309a(0x28c)](_0x49fbdc=>!_0x4553d0[_0x30309a(0x19b)](_0x49fbdc));if(_0x13ed8d['RSbES'](_0x5bd18a[_0x30309a(0x169)],0x0))return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x30309a(0x2a2)+_0x5bd18a[_0x30309a(0x1cb)](',\x20')+'\x22'});const _0x216765=_0xe23f22['Sheets'][_0x30309a(0x285)],_0x5aa3e2=_0x2b1b4e[_0x30309a(0x1b8)][_0x30309a(0x1c3)](_0x216765),_0x23cd2f=[_0x13ed8d['KlxIN'],_0x13ed8d['dpypr'],_0x13ed8d[_0x30309a(0x2ce)],_0x13ed8d['ZIMuA'],_0x13ed8d[_0x30309a(0x335)],_0x13ed8d[_0x30309a(0x352)],_0x13ed8d[_0x30309a(0x37f)],_0x13ed8d[_0x30309a(0x25b)],_0x13ed8d[_0x30309a(0x316)],_0x13ed8d[_0x30309a(0x1ea)],_0x13ed8d[_0x30309a(0x30c)]][_0x30309a(0x28c)](_0x32b905=>!_0x5aa3e2['some'](_0x135509=>Object['prototype'][_0x30309a(0x381)][_0x30309a(0x36a)](_0x135509,_0x32b905)));if(_0x13ed8d[_0x30309a(0x274)](_0x23cd2f['length'],0x0))return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x30309a(0x317)+_0x23cd2f[_0x30309a(0x1cb)](',\x20')+'\x22'});const _0x5c4e7f=new Set(),_0x26ab55=new Set();if(_0x5aa3e2[_0x30309a(0x34b)](_0x5e4b86=>{const _0x472a49=_0x30309a;_0x5c4e7f[_0x472a49(0x2cf)](_0x5e4b86[_0x472a49(0x231)])?_0x26ab55[_0x472a49(0x22e)](_0x5e4b86[_0x472a49(0x231)]):_0x5c4e7f[_0x472a49(0x22e)](_0x5e4b86[_0x472a49(0x231)]);}),_0x13ed8d['TWiiu'](_0x26ab55[_0x30309a(0x2de)],0x0))return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x30309a(0x27b)+Array[_0x30309a(0x2a4)](_0x26ab55)[_0x30309a(0x1cb)](',\x20')+'\x22'});const _0x2f9693=new Set(),_0x3409dd=new Set();if(_0x5aa3e2['forEach'](_0xbcd05e=>{const _0x255fa9=_0x30309a;_0x2f9693[_0x255fa9(0x2cf)](_0xbcd05e[_0x255fa9(0x2f0)])?_0x3409dd[_0x255fa9(0x22e)](_0xbcd05e[_0x255fa9(0x2f0)]):_0x2f9693[_0x255fa9(0x22e)](_0xbcd05e[_0x255fa9(0x2f0)]);}),_0x13ed8d[_0x30309a(0x200)](_0x3409dd[_0x30309a(0x2de)],0x0))return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d['JTvNz'],'msg':_0x30309a(0x177)+Array['from'](_0x3409dd)['join'](',\x20')+'\x22'});const _0x246c13=new Set(),_0x3105e8=new Set();if(_0x5aa3e2[_0x30309a(0x34b)](_0x1213d1=>{const _0x3d2e52=_0x30309a;_0x246c13[_0x3d2e52(0x2cf)](_0x1213d1['userEmail'])?_0x3105e8[_0x3d2e52(0x22e)](_0x1213d1[_0x3d2e52(0x324)]):_0x246c13[_0x3d2e52(0x22e)](_0x1213d1[_0x3d2e52(0x324)]);}),_0x13ed8d[_0x30309a(0x200)](_0x3105e8[_0x30309a(0x2de)],0x0))return _0x49360c['send']({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x30309a(0x1db)+Array['from'](_0x3105e8)['join'](',\x20')+'\x22'});const _0x5c269f=[],_0x277ceb=/^\d{3,4}$/,_0x138253=new RegExp(global['USERNAME_PATTERN']),_0x2c66e3=/^\d{3}$/,_0xb45a12=[_0x13ed8d[_0x30309a(0x299)],''];for(const [_0xdb89ad,_0x4ea7d7]of _0x5aa3e2[_0x30309a(0x2f8)]()){const _0x922bc5=_0x13ed8d['OeUqS'](_0xdb89ad,0x2),_0x522a5a={'userId':_0x4ea7d7[_0x30309a(0x231)],'row':_0x922bc5};if(!_0x4ea7d7[_0x30309a(0x231)]||_0x13ed8d[_0x30309a(0x209)](_0x277ceb[_0x30309a(0x18c)](_0x4ea7d7['userId'][_0x30309a(0x2c6)]()),!0x1)){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x2f0)]||_0x13ed8d[_0x30309a(0x152)](_0x138253[_0x30309a(0x18c)](_0x4ea7d7[_0x30309a(0x2f0)]),!0x1)){_0x5c269f['push'](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x1cd)]||_0x13ed8d[_0x30309a(0x209)](_0x2c66e3[_0x30309a(0x18c)](_0x4ea7d7['branchId']['toString']()),!0x1)){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x282)]||_0x13ed8d[_0x30309a(0x209)](_0xb45a12[_0x30309a(0x19b)](_0x4ea7d7['userIsActive']),!0x1)){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x2a1)]||_0x13ed8d[_0x30309a(0x209)](global[_0x30309a(0x311)][_0x30309a(0x19b)](_0x4ea7d7[_0x30309a(0x2a1)]),!0x1)){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x324)]||_0x13ed8d['AGXOj'](_0x265a0b[_0x30309a(0x2e0)](_0x4ea7d7[_0x30309a(0x324)]),!0x1)){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7['userFirstname']||_0x13ed8d[_0x30309a(0x152)](_0x4ea7d7[_0x30309a(0x194)][_0x30309a(0x147)](),'')){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}if(!_0x4ea7d7[_0x30309a(0x320)]||!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/[_0x30309a(0x18c)](_0x4ea7d7[_0x30309a(0x320)])){_0x5c269f[_0x30309a(0x174)](_0x522a5a);continue;}}if(_0x13ed8d[_0x30309a(0x150)](_0x5c269f[_0x30309a(0x169)],0x0)){const _0x161c24=Array[_0x30309a(0x2a4)](new Set(_0x5c269f['map'](_0x4b96bf=>JSON['stringify'](_0x4b96bf))))['map'](_0x3ce428=>JSON[_0x30309a(0x204)](_0x3ce428));return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x1,'color':_0x13ed8d[_0x30309a(0x28b)],'msg':_0x30309a(0x33c)+_0x161c24[_0x30309a(0x187)](_0x1602ac=>_0x1602ac[_0x30309a(0x380)])[_0x30309a(0x1cb)](',\x20'),'errorRows':_0x161c24});}_0x5aa3e2[_0x30309a(0x34b)](_0x32f29b=>{const _0x3e5108=_0x30309a;_0x32f29b['userId']=_0x13ed8d[_0x3e5108(0x36b)](Number,_0x32f29b[_0x3e5108(0x231)]),_0x32f29b[_0x3e5108(0x1cd)]=_0x13ed8d['NxDVn'](Number,_0x32f29b[_0x3e5108(0x1cd)]),_0x32f29b[_0x3e5108(0x282)]||(_0x32f29b[_0x3e5108(0x282)]=''),_0x32f29b[_0x3e5108(0x2e1)]||(_0x32f29b['userPhone']=''),_0x32f29b[_0x3e5108(0x2b9)]||(_0x32f29b[_0x3e5108(0x2b9)]=''),_0x32f29b[_0x3e5108(0x2c4)]||(_0x32f29b[_0x3e5108(0x2c4)]=''),delete _0x32f29b['userLastLogin'],delete _0x32f29b[_0x3e5108(0x1ed)],delete _0x32f29b[_0x3e5108(0x13c)],delete _0x32f29b[_0x3e5108(0x182)];}),await _0x128d36[_0x30309a(0x270)]();const _0x43bf0d=_0x128d36['db'](dbName)[_0x30309a(0x14f)](dbColl_users),_0x3cce23=[];for(const _0x4ac331 of _0x5aa3e2){const _0x587a8f=await _0x43bf0d[_0x30309a(0x173)]({'userId':_0x4ac331[_0x30309a(0x231)]},{'$set':_0x4ac331},{'upsert':!0x0});_0x3cce23[_0x30309a(0x174)]({'userId':_0x4ac331[_0x30309a(0x231)],'matchedCount':_0x587a8f[_0x30309a(0x1c0)],'upsertedCount':_0x587a8f[_0x30309a(0x1ff)]});}const _0x3d4525=_0x13ed8d[_0x30309a(0x274)](_0x3cce23[_0x30309a(0x169)],0x0)?_0x13ed8d[_0x30309a(0x1af)]('อัปเดท\x20'+_0x3cce23[_0x30309a(0x28c)](_0x267a23=>_0x267a23['matchedCount']>0x0)[_0x30309a(0x169)]+_0x30309a(0x14d),(_0x30309a(0x35f)+_0x3cce23[_0x30309a(0x28c)](_0xf21f6e=>_0xf21f6e[_0x30309a(0x1ff)]>0x0)['length']+'\x20รายการ')[_0x30309a(0x147)]()):_0x13ed8d[_0x30309a(0x364)];return _0x49360c[_0x30309a(0x1d5)]({'isUpload':!0x0,'color':_0x13ed8d['Vkspq'],'msg':_0x3d4525});}catch(_0x1bfb74){return console[_0x30309a(0x18f)](_0x13ed8d['FlpCk'],_0x1bfb74),_0x49360c[_0x30309a(0x1d5)]({'isDownload':!0x1,'color':_0x13ed8d['JTvNz'],'msg':_0x1bfb74[_0x30309a(0x1fa)]});}finally{_0x128d36[_0x30309a(0x165)]();}});export default x;function _0x3b8731(_0x3eb7cd){const _0x130142=_0x1cab3e,_0x1fa9e9={'VvTmv':function(_0x307366,_0x28f908){return _0x307366===_0x28f908;},'vQnby':_0x130142(0x15c),'Mcvdv':_0x130142(0x18a),'fVFKW':'counter','XlAAj':function(_0x2c8b69,_0x1d67af){return _0x2c8b69!==_0x1d67af;},'nsTRE':function(_0x28792a,_0x227da5){return _0x28792a+_0x227da5;},'HjDZo':function(_0x257d97,_0x5ce6c9){return _0x257d97/_0x5ce6c9;},'cyEND':_0x130142(0x169),'FZQkJ':function(_0x46bbd9,_0x8cffa5){return _0x46bbd9===_0x8cffa5;},'wKNBJ':function(_0x5d420f,_0x33072d){return _0x5d420f%_0x33072d;},'IqerY':_0x130142(0x276),'xBQAs':_0x130142(0x385),'rRvLC':'action','KxBAF':function(_0x5b4e7d,_0x3df670){return _0x5b4e7d+_0x3df670;},'yFKzt':'stateObject','hJteZ':function(_0x370a26,_0x25ff7b){return _0x370a26(_0x25ff7b);},'zoyty':function(_0x53692d,_0x33ebfd){return _0x53692d(_0x33ebfd);}};function _0xd0b09(_0x2d3e2e){const _0x4d3a12=_0x130142;if(_0x1fa9e9['VvTmv'](typeof _0x2d3e2e,_0x1fa9e9[_0x4d3a12(0x1b2)]))return function(_0x124ba3){}['constructor'](_0x1fa9e9[_0x4d3a12(0x26d)])[_0x4d3a12(0x32c)](_0x1fa9e9[_0x4d3a12(0x199)]);else _0x1fa9e9[_0x4d3a12(0x23f)](_0x1fa9e9[_0x4d3a12(0x27e)]('',_0x1fa9e9[_0x4d3a12(0x2af)](_0x2d3e2e,_0x2d3e2e))[_0x1fa9e9['cyEND']],0x1)||_0x1fa9e9[_0x4d3a12(0x219)](_0x1fa9e9['wKNBJ'](_0x2d3e2e,0x14),0x0)?function(){return!![];}['constructor'](_0x1fa9e9['nsTRE'](_0x1fa9e9['IqerY'],_0x1fa9e9[_0x4d3a12(0x321)]))[_0x4d3a12(0x36a)](_0x1fa9e9['rRvLC']):function(){return![];}[_0x4d3a12(0x243)](_0x1fa9e9[_0x4d3a12(0x33e)](_0x1fa9e9[_0x4d3a12(0x2bd)],_0x1fa9e9['xBQAs']))['apply'](_0x1fa9e9[_0x4d3a12(0x30b)]);_0x1fa9e9['hJteZ'](_0xd0b09,++_0x2d3e2e);}try{if(_0x3eb7cd)return _0xd0b09;else _0x1fa9e9[_0x130142(0x15e)](_0xd0b09,0x0);}catch(_0x4e3f7f){}}