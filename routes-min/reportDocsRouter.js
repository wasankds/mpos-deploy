const _0x6bd67c=_0x13ad;(function(_0x13cd5b,_0x5c3f48){const _0x37b002=_0x13ad,_0x289826=_0x13cd5b();while(!![]){try{const _0x4d7444=parseInt(_0x37b002(0x1f7))/0x1*(parseInt(_0x37b002(0x1e3))/0x2)+parseInt(_0x37b002(0x115))/0x3+-parseInt(_0x37b002(0x1c5))/0x4*(-parseInt(_0x37b002(0x17e))/0x5)+-parseInt(_0x37b002(0x10d))/0x6+parseInt(_0x37b002(0x138))/0x7+parseInt(_0x37b002(0x15e))/0x8*(-parseInt(_0x37b002(0x9c))/0x9)+-parseInt(_0x37b002(0x120))/0xa;if(_0x4d7444===_0x5c3f48)break;else _0x289826['push'](_0x289826['shift']());}catch(_0x5e0849){_0x289826['push'](_0x289826['shift']());}}}(_0x18ca,0x222fd));const _0x49eb72=(function(){const _0x4ab2f6=_0x13ad,_0x4a7c78={'IzYxg':function(_0x37efdc,_0x4c9e01){return _0x37efdc+_0x4c9e01;},'DFFEu':_0x4ab2f6(0xad),'NWwhd':'gger','PChGD':_0x4ab2f6(0x1d9),'FqmPb':_0x4ab2f6(0x1a2),'FWWbt':_0x4ab2f6(0x1b5),'UEMLE':function(_0x1107a2,_0x13b04c){return _0x1107a2!==_0x13b04c;},'MyZly':_0x4ab2f6(0x1ae),'SthSO':function(_0x4acb5b,_0xb6e111){return _0x4acb5b===_0xb6e111;},'PyVgD':_0x4ab2f6(0x124),'KNouk':'UjuJO','APWKU':'WWaxj','tVTfh':'dAnIj'};let _0x143ff8=!![];return function(_0x789e7d,_0x54c53){const _0x30513e=_0x4ab2f6;if(_0x4a7c78[_0x30513e(0x19c)](_0x4a7c78[_0x30513e(0x148)],_0x4a7c78[_0x30513e(0x11f)])){const _0x1f71ea=_0x143ff8?function(){const _0x556c43=_0x30513e,_0x507654={'txGay':function(_0x5f4eef,_0x50f5a6){const _0x264dea=_0x13ad;return _0x4a7c78[_0x264dea(0xce)](_0x5f4eef,_0x50f5a6);},'tozEc':_0x4a7c78['DFFEu'],'EZZTF':_0x4a7c78[_0x556c43(0x111)],'MPXmR':_0x4a7c78[_0x556c43(0x1fb)],'UWAKl':_0x4a7c78[_0x556c43(0x18b)],'porpG':_0x4a7c78[_0x556c43(0x142)]};if(_0x4a7c78[_0x556c43(0x19c)](_0x4a7c78['MyZly'],_0x4a7c78['MyZly']))(function(){return!![];}[_0x556c43(0x193)](_0x507654[_0x556c43(0xbb)](_0x507654[_0x556c43(0xc7)],_0x507654[_0x556c43(0xc6)]))[_0x556c43(0x1d7)](_0x507654[_0x556c43(0x183)]));else{if(_0x54c53){if(_0x4a7c78[_0x556c43(0x1eb)](_0x4a7c78[_0x556c43(0x164)],_0x4a7c78[_0x556c43(0x1aa)]))return function(_0x3b9739){}[_0x556c43(0x193)](_0x507654[_0x556c43(0x197)])[_0x556c43(0x1d5)](_0x507654[_0x556c43(0x1ba)]);else{const _0x1711e2=_0x54c53[_0x556c43(0x1d5)](_0x789e7d,arguments);return _0x54c53=null,_0x1711e2;}}}}:function(){};return _0x143ff8=![],_0x1f71ea;}else return![];};}());(function(){const _0x3f0f69=_0x13ad,_0x44a2f9={'yWtuZ':function(_0x535d1d){return _0x535d1d();},'DxTSt':'function\x20*\x5c(\x20*\x5c)','qeyyy':_0x3f0f69(0x177),'aLJjP':function(_0x54986a,_0x4ceaff){return _0x54986a(_0x4ceaff);},'TnLOm':_0x3f0f69(0xb9),'iCPtW':function(_0x48e9e8,_0x475027){return _0x48e9e8+_0x475027;},'aFyjr':_0x3f0f69(0x1b0),'TBaDs':_0x3f0f69(0xc4),'xNLnH':function(_0x5dd439){return _0x5dd439();},'gTgMO':function(_0x18285b,_0x12f427,_0xbc8369){return _0x18285b(_0x12f427,_0xbc8369);},'qUrXV':function(_0x3dd743,_0x2f9ad1){return _0x3dd743===_0x2f9ad1;},'WajVx':_0x3f0f69(0x1bc),'nkOQs':_0x3f0f69(0x1d6),'pmWwp':function(_0x2049f3,_0x2cfa46){return _0x2049f3(_0x2cfa46);},'vURZj':function(_0x2be9f8,_0x3e55ae){return _0x2be9f8!==_0x3e55ae;},'ZGpGn':_0x3f0f69(0x13d),'DaKAX':_0x3f0f69(0xed),'OXHdz':function(_0x98b494,_0x3e8953){return _0x98b494===_0x3e8953;},'JqytY':_0x3f0f69(0x178),'xJPZZ':_0x3f0f69(0x181),'fjigU':function(_0x11eff1,_0x55dddd,_0x181490){return _0x11eff1(_0x55dddd,_0x181490);}};_0x44a2f9['fjigU'](_0x49eb72,this,function(){const _0x3f2694=_0x3f0f69,_0x19cfd8={'ZVORu':_0x44a2f9[_0x3f2694(0xd1)],'ycmvC':_0x44a2f9[_0x3f2694(0x1d0)],'qjMFl':function(_0x425ff1,_0x2207b3){return _0x44a2f9['aLJjP'](_0x425ff1,_0x2207b3);},'cHvIw':_0x44a2f9['TnLOm'],'QNUSb':function(_0x122e45,_0x29498d){const _0x16a8f8=_0x3f2694;return _0x44a2f9[_0x16a8f8(0x19b)](_0x122e45,_0x29498d);},'joYyi':_0x44a2f9[_0x3f2694(0x131)],'gcoYL':_0x44a2f9[_0x3f2694(0x125)],'Vxsix':function(_0x38243b){return _0x44a2f9['xNLnH'](_0x38243b);},'HBLOD':function(_0x4ab8db,_0x557bee,_0x4c9b69){const _0x2b3e1b=_0x3f2694;return _0x44a2f9[_0x2b3e1b(0x17d)](_0x4ab8db,_0x557bee,_0x4c9b69);}};if(_0x44a2f9[_0x3f2694(0x116)](_0x44a2f9[_0x3f2694(0x1c4)],_0x44a2f9[_0x3f2694(0xb4)]))_0x44a2f9[_0x3f2694(0xe9)](_0x2cf802);else{const _0x5b0a96=new RegExp(_0x44a2f9[_0x3f2694(0xd1)]),_0x482bf6=new RegExp(_0x44a2f9['qeyyy'],'i'),_0x25e933=_0x44a2f9[_0x3f2694(0xae)](_0x368ac6,_0x44a2f9[_0x3f2694(0xe3)]);if(!_0x5b0a96[_0x3f2694(0x126)](_0x44a2f9[_0x3f2694(0x19b)](_0x25e933,_0x44a2f9[_0x3f2694(0x131)]))||!_0x482bf6[_0x3f2694(0x126)](_0x44a2f9[_0x3f2694(0x19b)](_0x25e933,_0x44a2f9[_0x3f2694(0x125)])))_0x44a2f9['vURZj'](_0x44a2f9[_0x3f2694(0x14f)],_0x44a2f9[_0x3f2694(0x163)])?_0x44a2f9[_0x3f2694(0x1e5)](_0x25e933,'0'):_0x4699e5=_0xdd049;else{if(_0x44a2f9[_0x3f2694(0x118)](_0x44a2f9['JqytY'],_0x44a2f9[_0x3f2694(0xbf)])){const _0xa5c07a={'rUVhu':_0x19cfd8['ZVORu'],'tRBxZ':_0x19cfd8['ycmvC'],'evsfG':function(_0x39d2be,_0x40aa06){const _0x2008a3=_0x3f2694;return _0x19cfd8[_0x2008a3(0x192)](_0x39d2be,_0x40aa06);},'qXIxZ':_0x19cfd8[_0x3f2694(0xd6)],'rCvjF':function(_0x56f544,_0xed531b){return _0x19cfd8['QNUSb'](_0x56f544,_0xed531b);},'cIOMv':_0x19cfd8['joYyi'],'pXOHA':function(_0x3f82d2,_0x4ef49d){const _0x57aa30=_0x3f2694;return _0x19cfd8[_0x57aa30(0x108)](_0x3f82d2,_0x4ef49d);},'wYkTU':_0x19cfd8[_0x3f2694(0x1ef)],'Zuvad':function(_0x26144c,_0x40dd20){const _0x519bde=_0x3f2694;return _0x19cfd8[_0x519bde(0x192)](_0x26144c,_0x40dd20);},'Xhlbo':function(_0x34d135){const _0x3e8e84=_0x3f2694;return _0x19cfd8[_0x3e8e84(0xb0)](_0x34d135);}};_0x19cfd8['HBLOD'](_0x327797,this,function(){const _0x52914e=_0x3f2694,_0x185b2e=new _0x1dd5b0(_0xa5c07a['rUVhu']),_0x462ec9=new _0x5c56a9(_0xa5c07a[_0x52914e(0x144)],'i'),_0xeb857b=_0xa5c07a['evsfG'](_0x4fb8d4,_0xa5c07a[_0x52914e(0xa6)]);!_0x185b2e[_0x52914e(0x126)](_0xa5c07a[_0x52914e(0x10b)](_0xeb857b,_0xa5c07a[_0x52914e(0xd3)]))||!_0x462ec9[_0x52914e(0x126)](_0xa5c07a[_0x52914e(0x1db)](_0xeb857b,_0xa5c07a[_0x52914e(0x172)]))?_0xa5c07a[_0x52914e(0x1af)](_0xeb857b,'0'):_0xa5c07a['Xhlbo'](_0x2c05aa);})();}else _0x44a2f9[_0x3f2694(0x100)](_0x368ac6);}}})();}());const _0x3cee8b=(function(){const _0x3fb85e=_0x13ad,_0x318eb2={'IYCaP':function(_0x29b983,_0x2a5e0f){return _0x29b983(_0x2a5e0f);},'hiGXm':function(_0x1234da,_0x539804){return _0x1234da===_0x539804;},'gvwdZ':_0x3fb85e(0x196),'AIgrw':_0x3fb85e(0x9e),'TUfeK':function(_0x5f0dd5,_0x2d3723){return _0x5f0dd5===_0x2d3723;},'ReGxe':_0x3fb85e(0x1cb),'AjhmW':function(_0xca27c0,_0x3b0304){return _0xca27c0===_0x3b0304;},'QuSNh':'ixDOT','rqSbp':_0x3fb85e(0x9a)};let _0x356643=!![];return function(_0x511873,_0x319e61){const _0x2207d8=_0x3fb85e;if(_0x318eb2[_0x2207d8(0xee)](_0x318eb2[_0x2207d8(0x195)],_0x318eb2[_0x2207d8(0x1fd)])){const _0x2d352f=_0x3c82c8[_0x2207d8(0x1d5)](_0x113ac2,arguments);return _0x29d70a=null,_0x2d352f;}else{const _0x5ae3c2=_0x356643?function(){const _0x35d3a6=_0x2207d8,_0x809101={'hPzJm':function(_0x1102e4,_0x5681cf){const _0x56f521=_0x13ad;return _0x318eb2[_0x56f521(0x1da)](_0x1102e4,_0x5681cf);}};if(_0x318eb2['hiGXm'](_0x318eb2[_0x35d3a6(0x13c)],_0x318eb2[_0x35d3a6(0xaa)])){const _0x1ec630=_0x3d3c52?function(){const _0xd4e37=_0x35d3a6;if(_0x58043e){const _0x414e58=_0x3ebe59[_0xd4e37(0x1d5)](_0x5eaeb7,arguments);return _0xdd2add=null,_0x414e58;}}:function(){};return _0x585db3=![],_0x1ec630;}else{if(_0x319e61){if(_0x318eb2[_0x35d3a6(0x1f9)](_0x318eb2[_0x35d3a6(0x1c8)],_0x318eb2[_0x35d3a6(0x1c8)])){const _0x3b7f20=_0x319e61[_0x35d3a6(0x1d5)](_0x511873,arguments);return _0x319e61=null,_0x3b7f20;}else _0x809101['hPzJm'](_0x5767bd,0x0);}}}:function(){};return _0x356643=![],_0x5ae3c2;}};}()),_0x5141c5=_0x3cee8b(this,function(){const _0x37be5d=_0x13ad,_0x659bad={'uHxTB':function(_0x29526a,_0x3be54b){return _0x29526a+_0x3be54b;},'hJVky':_0x37be5d(0xad),'MmHtF':_0x37be5d(0xe8),'lsVPf':_0x37be5d(0x182),'wxotx':_0x37be5d(0xa9),'XMCzo':function(_0x22567c,_0x2c621e){return _0x22567c!==_0x2c621e;},'oVeuA':_0x37be5d(0x160),'rnTCy':'ALtCC','hSKbP':function(_0x55f476,_0x443cc0){return _0x55f476!==_0x443cc0;},'dbqcD':_0x37be5d(0x10a),'eUukz':function(_0x44de8d,_0x3d75b6){return _0x44de8d(_0x3d75b6);},'uiauH':'return\x20(function()\x20','dbtKX':'{}.constructor(\x22return\x20this\x22)(\x20)','sfLtO':function(_0x314f71,_0x303baf){return _0x314f71===_0x303baf;},'UwBxy':_0x37be5d(0x1e8),'nkrPk':function(_0x234960){return _0x234960();},'crubA':_0x37be5d(0xcc),'TWsif':_0x37be5d(0xaf),'YjIMw':_0x37be5d(0x12c),'PaqBz':_0x37be5d(0x1bd),'KvCYS':'exception','DjXWB':_0x37be5d(0x9d),'PYOWv':_0x37be5d(0x113),'VzZuR':function(_0x32ccc3,_0x5c9e6a){return _0x32ccc3<_0x5c9e6a;},'EEZqn':'yOHco','syeJE':_0x37be5d(0x174)},_0x2f47eb=function(){const _0x131151=_0x37be5d,_0x143049={'YfvxS':_0x659bad[_0x131151(0x13f)]};if(_0x659bad['XMCzo'](_0x659bad[_0x131151(0x1c7)],_0x659bad['rnTCy'])){let _0x23b2f7;try{_0x659bad[_0x131151(0xde)](_0x659bad[_0x131151(0x1f5)],_0x659bad[_0x131151(0x1f5)])?function(){return![];}[_0x131151(0x193)](_0x659bad[_0x131151(0x157)](_0x659bad[_0x131151(0x18f)],_0x659bad[_0x131151(0x1f2)]))[_0x131151(0x1d5)](_0x659bad['lsVPf']):_0x23b2f7=_0x659bad[_0x131151(0x109)](Function,_0x659bad[_0x131151(0x157)](_0x659bad[_0x131151(0x157)](_0x659bad['uiauH'],_0x659bad[_0x131151(0x1ca)]),');'))();}catch(_0x3a2772){_0x659bad['sfLtO'](_0x659bad[_0x131151(0x1de)],_0x659bad[_0x131151(0x1de)])?_0x23b2f7=window:_0x281dcc['close']();}return _0x23b2f7;}else _0x28b7bd[_0x131151(0xcc)](_0x4a741e),_0x29be98[_0x131151(0x152)](_0x664102['stringify']({'isLoad':!0x1,'class':_0x143049[_0x131151(0x1cd)],'title':_0x41fd7a,'selectMonth':_0x724cb9,'msg':_0x506b7a[_0x131151(0x1a3)]}));},_0x1e9221=_0x659bad[_0x37be5d(0x134)](_0x2f47eb),_0xed62b8=_0x1e9221[_0x37be5d(0x169)]=_0x1e9221[_0x37be5d(0x169)]||{},_0x29caae=[_0x659bad[_0x37be5d(0x1ee)],_0x659bad['TWsif'],_0x659bad[_0x37be5d(0x13e)],_0x659bad[_0x37be5d(0x1fc)],_0x659bad[_0x37be5d(0x167)],_0x659bad[_0x37be5d(0x1ad)],_0x659bad[_0x37be5d(0x123)]];for(let _0x3ce62e=0x0;_0x659bad[_0x37be5d(0x17f)](_0x3ce62e,_0x29caae[_0x37be5d(0x11c)]);_0x3ce62e++){if(_0x659bad['sfLtO'](_0x659bad[_0x37be5d(0x19a)],_0x659bad[_0x37be5d(0xfe)]))return _0x58c637;else{const _0x26c1b1=_0x3cee8b[_0x37be5d(0x193)]['prototype']['bind'](_0x3cee8b),_0x4a2a38=_0x29caae[_0x3ce62e],_0x287d55=_0xed62b8[_0x4a2a38]||_0x26c1b1;_0x26c1b1[_0x37be5d(0xb3)]=_0x3cee8b[_0x37be5d(0x1e7)](_0x3cee8b),_0x26c1b1['toString']=_0x287d55[_0x37be5d(0x9b)][_0x37be5d(0x1e7)](_0x287d55),_0xed62b8[_0x4a2a38]=_0x26c1b1;}}});_0x5141c5();import _0x1f39dd from'express';const _=_0x1f39dd['Router']();function _0x13ad(_0x31ad26,_0x237042){const _0x11209f=_0x18ca();return _0x13ad=function(_0x5141c5,_0x3cee8b){_0x5141c5=_0x5141c5-0x9a;let _0x4243ff=_0x11209f[_0x5141c5];return _0x4243ff;},_0x13ad(_0x31ad26,_0x237042);}import{MongoClient as _0x30e7c6}from'mongodb';import _0x47f058 from'ejs';import _0x2ec9ea from'path';import _0x348b80 from'fs';function _0x18ca(){const _0x5abba9=['NWwhd','kcNBQ','trace','JCUon','230688ofvbNx','qUrXV','getSessionData','OXHdz','getUsers_for_report','fqeQS','paymentMethod2Name','length','GFjur','qIWBF','tVTfh','513290BoEdww','bg-cornblue','bXnqq','PYOWv','RtefO','TBaDs','test','userAuthority','userFullname','bg-dodgerblue','/calendar','$paymentAmount1','info','CNWOv','zBIsb','fc-green','sRgtB','aFyjr','muNWR','QTrlw','nkrPk','renderView','febgf','nQFuM','1688526xSmhqr','HkDlj','forEach','rcntC','gvwdZ','qtatb','YjIMw','wxotx','dCkEe','dJiXY','FWWbt','MggGo','tRBxZ','FQNQQ','bg-green','cnGPi','APWKU','/conclude','reportDocs','EcEGr','slPtX','EETYm','lMOeV','ZGpGn','mDCjE','sendFile','send','AelYv','gbVxy','Lltym','payTypeThai','uHxTB','lGpoY','jsQre','status','IXKEA','getSettings','cTDNB','33488yjUmZN','stringify','iKLGb','Hdhsj','$totalAmount','DaKAX','PyVgD','toArray','ไม่พบชื่อคอเล็กชั่น','KvCYS','CHLGe','console','aggregate','reportByDocId.ejs','OzPLW','UjAMM','/myDocMain.js','Nfybv','HNQdY','AffaG','wYkTU','wQmsA','nZCYS','unshift','sales','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','qadgD','mEulk','UABYA','riSPL','PvXhW','gTgMO','73090iLlTdq','VzZuR','SbcjB','GnLxr','stateObject','MPXmR','WrUzO','zCUyt','FGRdx','string','mrqmL','SUGyh','post','FqmPb','sTZLa','/print','uNgzn','hJVky','paymentMethod1','body','qjMFl','constructor','conau','QuSNh','ngTFf','UWAKl','dbName','green','EEZqn','iCPtW','UEMLE','iHkNd','LiqnX','iCGjX','GIUFy','readFileSync','while\x20(true)\x20{}','message','$docDateTime','branchName','Qelmq','reportConcludeDocs.ejs','YOmiS','find','KNouk','egyZk','PATH_SALES','DjXWB','eYZKX','Zuvad','chain','PATH_WAREHOUSE_OUT','path','LUSOy','DPVJS','counter','sdtyL','ctCGu','CnREO','Elyta','porpG','VLMLt','VhMuY','error','getDate','{}.constructor(\x22return\x20this\x22)(\x20)','hfMDk','jpHJz','MONTH_NAMES','สร้าง','WajVx','4ZqaJqm','PATH_RETURN','oVeuA','ReGxe','BAjCa','dbtKX','gtELa','utf8','YfvxS','$paymentMethod2','PSLLB','qeyyy','close','flash','split','paymentMethod2','apply','zPmJr','call','mSuwH','action','IYCaP','pXOHA','branchId','fc-orange','UwBxy','gBYMF','NFFzZ','get_Info_ByPath','prototype','4796uYLGpB','connect','aLJjP','ไม่พบประเภทเอกสาร','bind','ErecX','IdnWH','ipBYk','SthSO','IInzK','KCIQW','crubA','gcoYL','wOUpU','warehouseOut','MmHtF','qrjJF','bbrGW','dbqcD','ACDGi','34rESKcv','WBEtD','TUfeK','dslpl','PChGD','PaqBz','rqSbp','iqvgq','toString','99gfTPTz','table','cyMFC','totalAmount','AWOof','lpBEv','/myData.js','/load','qyGrt','$paymentAmount2','qXIxZ','TjHsX','FKSFr','red','AIgrw',',\x20[','Ratck','debu','pmWwp','warn','Vxsix','getSuppliers_for_report','../','__proto__','nkOQs','jZzfy','XhQXZ','AWsht','getUserBranches','init','UXNEv','txGay','fc-dodgerblue','paymentMethod1Name','fXmjC','xJPZZ','dbUrl','olhoD','MdWyd','ttLic','input','Unknown','EZZTF','tozEc','render','YRhNK','iSMDl','iBoZQ','log','return','IzYxg','$docStatusNumber','OUYRs','DxTSt','warehouseIn','cIOMv','gepZV','tfCcP','cHvIw','FuQbm','iiJLF','QxvwK','DMYVg','bg-deepskyblue','join','JwQJU','hSKbP','get','$paymentMethod','RBmRg','jpnUL','TnLOm','/myModule.js','lcSEG','BJxBx','Ynnla','gger','yWtuZ','WJbnB','paytype','mSEWG','QAeMI','AjhmW','wkvSA','ydZLX','PAY_TYPE','isAuth','/report','userId','fc-red','pPDNQ','Obycv','collection','Uppem','HqbJg','fDYKh','bg-red','YhaUu','syeJE','msg','xNLnH','vTjXo','zITqB','juMTG','kBhbW','return\x20(function()\x20','ubQFw','MJhQu','QNUSb','eUukz','bclZT','rCvjF','AmhJM','1061160PRbwHo','PATH_WAREHOUSE_IN','wdRTP','oaJZp'];_0x18ca=function(){return _0x5abba9;};return _0x18ca();}import _0x434579 from'../middleware/mainAuth.js';const F=await import(_0x6bd67c(0xb2)+mymoduleFolder+_0x6bd67c(0xe4)),K=await import('../'+mymoduleFolder+'/myDateTime.js'),S=await import(_0x6bd67c(0xb2)+mymoduleFolder+'/myUsers.js'),A=await import(_0x6bd67c(0xb2)+mymoduleFolder+_0x6bd67c(0xa2)),D=await import(_0x6bd67c(0xb2)+mymoduleFolder+_0x6bd67c(0x16e)),M=_0x6bd67c(0xf3)+global[_0x6bd67c(0x10e)],P=_0x6bd67c(0xf3)+global[_0x6bd67c(0x1b1)],w='/report'+global['PATH_SALES'],O=_0x6bd67c(0xf3)+global[_0x6bd67c(0x1c6)],j=[global[_0x6bd67c(0x10e)],global[_0x6bd67c(0x1b1)],global[_0x6bd67c(0x1ac)],global['PATH_RETURN']],B=[M,P,w,O],W=[M+_0x6bd67c(0x149),P+_0x6bd67c(0x149),w+_0x6bd67c(0x149),O+_0x6bd67c(0x149)],Y=[M+_0x6bd67c(0x12a),P+_0x6bd67c(0x12a),w+_0x6bd67c(0x12a),O+_0x6bd67c(0x12a)],x=[M+_0x6bd67c(0xa3),P+'/load',w+'/load',O+_0x6bd67c(0xa3)],Q=[global[_0x6bd67c(0x10e)]+_0x6bd67c(0x18d),global[_0x6bd67c(0x1b1)]+_0x6bd67c(0x18d),global[_0x6bd67c(0x1ac)]+_0x6bd67c(0x18d),global[_0x6bd67c(0x1c6)]+_0x6bd67c(0x18d)],H={'docStatus':{'$switch':{'branches':[{'case':{'$eq':['$docStatusNumber',0x1]},'then':_0x6bd67c(0x1c3)},{'case':{'$eq':[_0x6bd67c(0xcf),0x2]},'then':'จบ'},{'case':{'$eq':['$docStatusNumber',0xa]},'then':'ยกเลิก'}],'default':_0x6bd67c(0xc5)}},'docStatusColor':{'$switch':{'branches':[{'case':{'$eq':['$docStatusNumber',0x1]},'then':_0x6bd67c(0xbc)},{'case':{'$eq':[_0x6bd67c(0xcf),0x2]},'then':_0x6bd67c(0x12f)},{'case':{'$eq':['$docStatusNumber',0xa]},'then':_0x6bd67c(0x1dd)}],'default':_0x6bd67c(0xf5)}},'docStatusBgColor':{'$switch':{'branches':[{'case':{'$eq':[_0x6bd67c(0xcf),0x1]},'then':_0x6bd67c(0x129)},{'case':{'$eq':[_0x6bd67c(0xcf),0x2]},'then':_0x6bd67c(0x146)},{'case':{'$eq':[_0x6bd67c(0xcf),0xa]},'then':'bg-orange'}],'default':_0x6bd67c(0xfc)}}};_[_0x6bd67c(0xdf)](B,_0x434579[_0x6bd67c(0xf2)],async(_0x11b731,_0x5e6caa)=>{const _0x577e86=_0x6bd67c,_0xdb42fb={'AmhJM':_0x577e86(0xa9),'RBmRg':function(_0x14edfd,_0x376344){return _0x14edfd===_0x376344;},'QFPaf':_0x577e86(0xd2),'ctCGu':_0x577e86(0x1f1),'FKSFr':_0x577e86(0x176),'JwQJU':_0x577e86(0xcd),'otPDn':function(_0x5954b2,_0x4782cc){return _0x5954b2!==_0x4782cc;},'yCXzd':_0x577e86(0x1ea),'olhoD':_0x577e86(0xfd),'fDYKh':function(_0x1bf375,_0x33ffe2){return _0x1bf375==_0x33ffe2;},'YOmiS':function(_0x547528,_0x489fa4){return _0x547528===_0x489fa4;},'UABYA':_0x577e86(0x14a),'wQmsA':_0x577e86(0xff),'GFjur':_0x577e86(0x140)},_0x5a27fa=await S[_0x577e86(0x117)](_0x11b731),{docTitle:_0x3f5d5d,collectionName:_0x2ecbd8,docType:_0x1ee0ea}=D['get_Info_ByPath'](_0x11b731[_0x577e86(0x1b2)]),_0x1bbb95=_0xdb42fb[_0x577e86(0xe1)](_0x1ee0ea,_0xdb42fb['QFPaf'])?0x0:_0xdb42fb[_0x577e86(0xe1)](_0x1ee0ea,_0xdb42fb[_0x577e86(0x1b7)])?0x1:_0xdb42fb[_0x577e86(0xe1)](_0x1ee0ea,_0xdb42fb[_0x577e86(0xa8)])?0x2:_0xdb42fb[_0x577e86(0xe1)](_0x1ee0ea,_0xdb42fb[_0x577e86(0xdd)])?0x3:-0x1;if(_0xdb42fb[_0x577e86(0xe1)](_0x1bbb95,-0x1))return _0x5e6caa[_0x577e86(0x15a)](0x194)[_0x577e86(0x151)](file404);try{if(_0xdb42fb['otPDn'](_0xdb42fb['yCXzd'],_0xdb42fb[_0x577e86(0xc1)])){if(_0xdb42fb[_0x577e86(0xfb)](_0x5a27fa['userAuthority'],'A'))var _0xf4c666=await A[_0x577e86(0x119)]({'branchId':_0x5a27fa['branchId']}),_0x51eafc=await A['getUserBranches']({'branchId':_0x5a27fa[_0x577e86(0x1dc)]});else{if(_0xdb42fb['fDYKh'](_0x5a27fa[_0x577e86(0x127)],'U'))var _0xf4c666=[],_0x51eafc=[];else var _0xf4c666=await A[_0x577e86(0x119)]({}),_0x51eafc=await A[_0x577e86(0xb8)]({});}if(_0xdb42fb[_0x577e86(0x1a8)](_0x1ee0ea,_0xdb42fb['QFPaf']))var _0x332aa5=await A[_0x577e86(0xb1)]({});else var _0x332aa5=[];const _0x431c96=await A['getDocs_MonthUnique'](_0x2ecbd8),_0x2b123b=await F[_0x577e86(0x135)](_0xdb42fb[_0x577e86(0x17a)],_0x5e6caa,{'title':_0x3f5d5d,'time':K[_0x577e86(0x1be)](),'msg':_0x11b731[_0x577e86(0x1d2)](_0xdb42fb[_0x577e86(0x173)]),'user':_0x5a27fa,'settings':await F[_0x577e86(0x15c)](),'PATH_MAIN':B[_0x1bbb95],'PATH_DOC':j[_0x1bbb95],'PATH_CALENDAR':Y[_0x1bbb95],'PATH_CONCLUDE':W[_0x1bbb95],'PATH_PRINT_DOC':Q[_0x1bbb95],'PATH_LOAD':x[_0x1bbb95],'docType':_0x1ee0ea,'dataUsersJson':JSON[_0x577e86(0x15f)](_0xf4c666),'dataBranchesJson':JSON[_0x577e86(0x15f)](_0x51eafc),'dataSuppliersJson':JSON['stringify'](_0x332aa5),'monthDocs':_0x431c96,'dataDocConclude':JSON[_0x577e86(0x15f)]([])});_0x5e6caa[_0x577e86(0x152)](_0x2b123b);}else _0x59518a[_0x577e86(0x1d1)]();}catch(_0x1543db){_0xdb42fb['YOmiS'](_0xdb42fb[_0x577e86(0x11d)],_0xdb42fb[_0x577e86(0x11d)])?(console[_0x577e86(0xcc)](_0x1543db),_0x5e6caa[_0x577e86(0x15a)](0x194)[_0x577e86(0x151)](file404)):(_0x3acc06[_0x577e86(0xcc)](_0x277100),_0x1f0f81[_0x577e86(0x152)](_0x39a6ee[_0x577e86(0x15f)]({'isLoad':!0x1,'class':_0xdb42fb[_0x577e86(0x10c)],'msg':_0x11b24a[_0x577e86(0x1a3)]})));}}),_[_0x6bd67c(0x18a)](Y,_0x434579[_0x6bd67c(0xf2)],async(_0x183510,_0x3b5cf4)=>{const _0x4642b8=_0x6bd67c,_0x13aefc={'sTZLa':_0x4642b8(0xa9),'juMTG':function(_0x16575c,_0x333a0c){return _0x16575c(_0x333a0c);},'Nfybv':function(_0x26ed74,_0x49ab6a){return _0x26ed74==_0x49ab6a;},'mQVeh':function(_0x15c466,_0x16261b){return _0x15c466==_0x16261b;},'lMOeV':function(_0x37c4f0,_0x26a6f4){return _0x37c4f0-_0x26a6f4;},'Ynnla':_0x4642b8(0x166),'drsDS':function(_0xf21262,_0x4024ff){return _0xf21262===_0x4024ff;},'gepZV':'UgJPG','FuQbm':'AqHNV','lMcgG':_0x4642b8(0x1a4),'Hdhsj':_0x4642b8(0x162),'qrjJF':_0x4642b8(0x12b),'CNWOv':'$paymentAmount2','iiJLF':_0x4642b8(0xe0),'mDCjE':_0x4642b8(0x1ce),'TubJA':_0x4642b8(0x199),'UXNEv':'โหลดข้อมูลเรียบร้อยแล้ว','jZzfy':function(_0x1935f5,_0x53a992){return _0x1935f5!==_0x53a992;},'fXmjC':'neWdn','EcEGr':_0x4642b8(0x14d),'ydZLX':function(_0x483f60,_0xaff021){return _0x483f60===_0xaff021;},'qIWBF':_0x4642b8(0xc2)};let {selectMonth:_0x1bac50,userId:_0x449475,searchUser:_0x29733c,branchId:_0x423ac1,searchBranch:_0x7453fe,supplierId:_0x4daa78,searchSupplier:_0x7834d6}=_0x183510[_0x4642b8(0x191)];_0x449475=_0x449475&&_0x13aefc[_0x4642b8(0x103)](Number,_0x449475),_0x423ac1=_0x423ac1&&_0x13aefc['juMTG'](Number,_0x423ac1);const _0x5c88dd=await S[_0x4642b8(0x117)](_0x183510);_0x13aefc[_0x4642b8(0x16f)](_0x5c88dd[_0x4642b8(0x127)],'A')?(_0x423ac1=_0x5c88dd[_0x4642b8(0x1dc)],_0x7453fe=_0x7453fe||_0x5c88dd[_0x4642b8(0x1a5)]):_0x13aefc['mQVeh'](_0x5c88dd[_0x4642b8(0x127)],'U')&&(_0x449475=_0x5c88dd[_0x4642b8(0xf4)],_0x29733c=_0x29733c||_0x5c88dd[_0x4642b8(0x128)],_0x423ac1=_0x423ac1||_0x5c88dd[_0x4642b8(0x1dc)],_0x7453fe=_0x7453fe||_0x5c88dd[_0x4642b8(0x1a5)]);const [_0x5aeaec,_0x16b675]=_0x1bac50[_0x4642b8(0x1d3)]('-'),_0x3b94c3=global[_0x4642b8(0x1c2)][_0x13aefc[_0x4642b8(0x14e)](_0x13aefc[_0x4642b8(0x103)](parseInt,_0x16b675),0x1)]+'\x20'+_0x5aeaec,{collectionName:_0x5d8d82}=D[_0x4642b8(0x1e1)](_0x183510[_0x4642b8(0x1b2)]);if(!_0x5d8d82)return _0x3b5cf4[_0x4642b8(0x152)](JSON['stringify']({'isLoad':!0x1,'class':_0x13aefc['sTZLa'],'msg':_0x13aefc[_0x4642b8(0xe7)]}));let _0x3d2516=''+_0x3b94c3;_0x449475&&(_0x3d2516+=',\x20['+_0x449475+']\x20'+_0x29733c),_0x423ac1&&(_0x3d2516+=_0x4642b8(0xab)+_0x423ac1+']\x20'+_0x7453fe),_0x4daa78&&(_0x3d2516+=_0x4642b8(0xab)+_0x4daa78+']\x20'+_0x7834d6);const _0x283286=new _0x30e7c6(global[_0x4642b8(0xc0)]);try{if(_0x13aefc['drsDS'](_0x13aefc[_0x4642b8(0xd4)],_0x13aefc[_0x4642b8(0xd7)])){if(_0x57b237){const _0x47e8ad=_0x3da4fe[_0x4642b8(0x1d5)](_0x10d762,arguments);return _0x29ab1c=null,_0x47e8ad;}}else{await _0x283286[_0x4642b8(0x1e4)]();const _0x5e76ae=_0x283286['db'](global[_0x4642b8(0x198)])['collection'](_0x5d8d82),_0x125275=[{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':{'$substr':[_0x13aefc['lMcgG'],0x0,0xa]},'docDateTime':0x1,'totalAmount':{'$ifNull':[_0x13aefc[_0x4642b8(0x161)],0x0]},'paymentAmount1':{'$ifNull':[_0x13aefc[_0x4642b8(0x1f3)],'']},'paymentAmount2':{'$ifNull':[_0x13aefc[_0x4642b8(0x12d)],'']},'paymentMethod':{'$ifNull':[_0x13aefc[_0x4642b8(0xd8)],'']},'paymentMethod2':{'$ifNull':[_0x13aefc[_0x4642b8(0x150)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,...H}}];_0x449475&&_0x125275[_0x4642b8(0x175)]({'$match':{'userId':_0x449475}}),_0x423ac1&&_0x125275[_0x4642b8(0x175)]({'$match':{'branchId':_0x423ac1}}),_0x4daa78&&_0x125275[_0x4642b8(0x175)]({'$match':{'supplierId':_0x4daa78}});const _0x19c4ad=await _0x5e76ae[_0x4642b8(0x16a)](_0x125275)[_0x4642b8(0x165)]();_0x3d2516+='\x20['+_0x19c4ad['length']+']',_0x3b5cf4[_0x4642b8(0x152)](JSON['stringify']({'isLoad':!0x0,'class':_0x13aefc['TubJA'],'title':_0x3d2516,'dataDocs':_0x19c4ad,'selectMonth':_0x1bac50,'msg':_0x13aefc[_0x4642b8(0xba)]}));}}catch(_0x59ccd2){if(_0x13aefc[_0x4642b8(0xb5)](_0x13aefc[_0x4642b8(0xbe)],_0x13aefc[_0x4642b8(0x14b)]))console[_0x4642b8(0xcc)](_0x59ccd2),_0x3b5cf4[_0x4642b8(0x152)](JSON[_0x4642b8(0x15f)]({'isLoad':!0x1,'class':_0x13aefc[_0x4642b8(0x18c)],'title':_0x3d2516,'selectMonth':_0x1bac50,'msg':_0x59ccd2[_0x4642b8(0x1a3)]}));else return _0x58f8d6[_0x4642b8(0xcc)](_0x1fc8eb),_0x464f27[_0x4642b8(0x152)](_0x1c2974[_0x4642b8(0x15f)]({'isLoad':!0x1,'class':_0x13aefc[_0x4642b8(0x18c)],'msg':_0x5295f6[_0x4642b8(0x1a3)]}));}finally{_0x13aefc[_0x4642b8(0xf0)](_0x13aefc[_0x4642b8(0x11e)],_0x13aefc[_0x4642b8(0x11e)])?_0x283286[_0x4642b8(0x1d1)]():_0x2c9166[_0x4642b8(0x1d1)]();}}),_['post'](W,_0x434579[_0x6bd67c(0xf2)],async(_0x367cf7,_0x51ef0d)=>{const _0x53335d=_0x6bd67c,_0x10a3b8={'HkDlj':function(_0x33f822,_0x53d91f){return _0x33f822(_0x53d91f);},'gBYMF':function(_0x3cf7e5,_0x2a8bf5){return _0x3cf7e5===_0x2a8bf5;},'riSPL':_0x53335d(0x154),'mEulk':_0x53335d(0xc3),'JCUon':'function\x20*\x5c(\x20*\x5c)','aaELx':_0x53335d(0x177),'fqeQS':_0x53335d(0xb9),'PSLLB':function(_0x14feba,_0x524e19){return _0x14feba+_0x524e19;},'DMYVg':_0x53335d(0x1b0),'LiqnX':_0x53335d(0xc4),'sdtyL':function(_0x1f20ed){return _0x1f20ed();},'WrUzO':function(_0x37ab41,_0x17185c){return _0x37ab41==_0x17185c;},'rcntC':'red','conau':_0x53335d(0x166),'OzPLW':function(_0x2e57a1,_0x1fbaf5){return _0x2e57a1&&_0x1fbaf5;},'wdRTP':'สรุปเอกสารเดือน','egyZk':_0x53335d(0x121),'zEsTj':'สรุปเอกสารวันที่','GIUFy':_0x53335d(0xdb),'BAjCa':function(_0x4d50c1,_0x4793e1){return _0x4d50c1!==_0x4793e1;},'SbcjB':'BxHtd','cTDNB':_0x53335d(0x12b),'kkdQx':_0x53335d(0xa5),'HNQdY':'$paymentMethod1','SUGyh':_0x53335d(0x1ce),'qdLZa':'$payDebtRows','tfCcP':'$payDebtRows.amount','febgf':_0x53335d(0x1a7),'yFTri':_0x53335d(0x1cc),'QUPdV':'green','iSMDl':_0x53335d(0x1f8),'iloiK':_0x53335d(0xf7),'AVwYp':_0x53335d(0xcb)};let {selectMonth:_0x3e3054,selectMonthTh:_0x981ba,selectDateTh:_0x49c78e,selectDate:_0x46e488,userId:_0x5c5c6e,searchUser:_0x2f6d6e,branchId:_0x31e16f,searchBranch:_0x2546d8,supplierId:_0x1c2506,searchSupplier:_0x1b780e}=_0x367cf7[_0x53335d(0x191)];_0x5c5c6e=_0x5c5c6e&&_0x10a3b8['HkDlj'](Number,_0x5c5c6e),_0x31e16f=_0x31e16f&&_0x10a3b8[_0x53335d(0x139)](Number,_0x31e16f);const _0x3fcbab=await S[_0x53335d(0x117)](_0x367cf7);_0x10a3b8[_0x53335d(0x184)](_0x3fcbab[_0x53335d(0x127)],'A')?(_0x31e16f=_0x3fcbab[_0x53335d(0x1dc)],_0x2546d8=_0x2546d8||_0x3fcbab[_0x53335d(0x1a5)]):_0x10a3b8[_0x53335d(0x184)](_0x3fcbab['userAuthority'],'U')&&(_0x5c5c6e=_0x3fcbab[_0x53335d(0xf4)],_0x2f6d6e=_0x2f6d6e||_0x3fcbab['userFullname'],_0x31e16f=_0x31e16f||_0x3fcbab[_0x53335d(0x1dc)],_0x2546d8=_0x2546d8||_0x3fcbab['branchName']);const {docType:_0x4ad72a,collectionName:_0x407242}=D['get_Info_ByPath'](_0x367cf7[_0x53335d(0x1b2)]);if(!_0x407242)return _0x51ef0d[_0x53335d(0x152)](JSON[_0x53335d(0x15f)]({'isLoad':!0x1,'class':_0x10a3b8['rcntC'],'msg':_0x10a3b8[_0x53335d(0x194)]}));if(_0x10a3b8[_0x53335d(0x16c)](_0x3e3054,_0x981ba))var _0x23b3c5=_0x10a3b8[_0x53335d(0x10f)],_0x852d97=''+_0x981ba,_0x247cfc=_0x10a3b8[_0x53335d(0x1ab)],_0x503f19={'$regex':'^'+_0x3e3054};else{if(_0x10a3b8[_0x53335d(0x16c)](_0x46e488,_0x49c78e))var _0x23b3c5=_0x10a3b8['zEsTj'],_0x852d97=''+_0x49c78e,_0x247cfc=_0x10a3b8[_0x53335d(0x1a0)],_0x503f19={'$regex':'^'+_0x46e488};}_0x5c5c6e&&(_0x852d97+=_0x53335d(0xab)+_0x5c5c6e+']\x20'+_0x2f6d6e),_0x31e16f&&(_0x852d97+=_0x53335d(0xab)+_0x31e16f+']\x20'+_0x2546d8),_0x1c2506&&(_0x852d97+=_0x53335d(0xab)+_0x1c2506+']\x20'+_0x1b780e);const _0x3aefa7=new _0x30e7c6(global[_0x53335d(0xc0)]);try{if(_0x10a3b8[_0x53335d(0x1c9)](_0x10a3b8[_0x53335d(0x180)],_0x10a3b8['SbcjB'])){if(_0x29828c)return _0xad292e;else yOMLxM[_0x53335d(0x139)](_0x42b066,0x0);}else{await _0x3aefa7[_0x53335d(0x1e4)]();const _0x42fd8c=_0x3aefa7['db'](global[_0x53335d(0x198)])[_0x53335d(0xf8)](_0x407242),_0x3ccf78=[{'$match':{'docDateTime':_0x503f19}},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':0x1,'paymentAmount1':{'$ifNull':[_0x10a3b8[_0x53335d(0x15d)],'']},'paymentAmount2':{'$ifNull':[_0x10a3b8['kkdQx'],'']},'paymentMethod1':{'$ifNull':[_0x10a3b8[_0x53335d(0x170)],'']},'paymentMethod2':{'$ifNull':[_0x10a3b8[_0x53335d(0x189)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,'payDebtTotal':{'$cond':{'if':{'$isArray':_0x10a3b8['qdLZa']},'then':{'$sum':_0x10a3b8[_0x53335d(0xd5)]},'else':0x0}},...H}}];_0x5c5c6e&&_0x3ccf78[_0x53335d(0x175)]({'$match':{'userId':_0x5c5c6e}}),_0x31e16f&&_0x3ccf78[_0x53335d(0x175)]({'$match':{'branchId':_0x31e16f}}),_0x1c2506&&_0x3ccf78['unshift']({'$match':{'supplierId':_0x1c2506}});const _0x242590=await _0x42fd8c['aggregate'](_0x3ccf78)[_0x53335d(0x165)]();_0x242590[_0x53335d(0x13a)](_0x1c126f=>{const _0x26ba4d=_0x53335d;if(_0x10a3b8[_0x26ba4d(0x1df)](_0x10a3b8[_0x26ba4d(0x17b)],_0x10a3b8[_0x26ba4d(0x179)])){if(_0x1e9fdf){const _0x395dbe=_0x58eee8[_0x26ba4d(0x1d5)](_0x2bcf31,arguments);return _0x29cb20=null,_0x395dbe;}}else delete _0x1c126f['payDebtRows'],_0x1c126f[_0x26ba4d(0x190)]&&(_0x1c126f[_0x26ba4d(0xbd)]=global[_0x26ba4d(0xf1)][_0x26ba4d(0x1a9)](_0x17aede=>_0x17aede[_0x26ba4d(0xeb)]==_0x1c126f[_0x26ba4d(0x190)])?.[_0x26ba4d(0x156)]||_0x1c126f[_0x26ba4d(0x190)]),_0x1c126f[_0x26ba4d(0x1d4)]&&(_0x1c126f['paymentMethod2Name']=global[_0x26ba4d(0xf1)][_0x26ba4d(0x1a9)](_0x48cd54=>_0x48cd54[_0x26ba4d(0xeb)]==_0x1c126f[_0x26ba4d(0x1d4)])?.[_0x26ba4d(0x156)]||_0x1c126f[_0x26ba4d(0x1d4)]);});const _0x1f1f5e=_0x2ec9ea[_0x53335d(0xdc)](folderForms,_0x10a3b8[_0x53335d(0x136)]),_0x242dfc=_0x348b80[_0x53335d(0x1a1)](_0x1f1f5e,_0x10a3b8['yFTri']);var _0x5e4556=_0x47f058[_0x53335d(0xc8)](_0x242dfc,{'titleConclude':_0x23b3c5,'title':_0x852d97,'titleClassColor':_0x247cfc,'docType':_0x4ad72a,'data':_0x242590});return _0x51ef0d[_0x53335d(0x152)](JSON[_0x53335d(0x15f)]({'isLoad':!0x0,'class':_0x10a3b8['QUPdV'],'htmlDiv':_0x5e4556}));}}catch(_0x36a32a){if(_0x10a3b8[_0x53335d(0x1c9)](_0x10a3b8[_0x53335d(0xca)],_0x10a3b8[_0x53335d(0xca)])){const _0x55e040=new _0x4cee9c(yOMLxM[_0x53335d(0x114)]),_0x306809=new _0x4c01be(yOMLxM['aaELx'],'i'),_0x3fa384=yOMLxM[_0x53335d(0x139)](_0x11c72f,yOMLxM[_0x53335d(0x11a)]);!_0x55e040[_0x53335d(0x126)](yOMLxM[_0x53335d(0x1cf)](_0x3fa384,yOMLxM[_0x53335d(0xda)]))||!_0x306809['test'](yOMLxM['PSLLB'](_0x3fa384,yOMLxM[_0x53335d(0x19e)]))?yOMLxM[_0x53335d(0x139)](_0x3fa384,'0'):yOMLxM[_0x53335d(0x1b6)](_0x4eca4f);}else console[_0x53335d(0xcc)](_0x36a32a),_0x51ef0d[_0x53335d(0x152)](JSON['stringify']({'isLoad':!0x1,'class':_0x10a3b8[_0x53335d(0x13b)],'msg':_0x36a32a[_0x53335d(0x1a3)]}));}finally{if(_0x10a3b8[_0x53335d(0x1df)](_0x10a3b8['iloiK'],_0x10a3b8['AVwYp'])){const _0x591c6e=_0xbd69fd?function(){const _0x202986=_0x53335d;if(_0x5c9eca){const _0x3dbcbd=_0x5e5c55[_0x202986(0x1d5)](_0x35fa65,arguments);return _0x465a3e=null,_0x3dbcbd;}}:function(){};return _0x1331f1=![],_0x591c6e;}else _0x3aefa7[_0x53335d(0x1d1)]();}}),_[_0x6bd67c(0x18a)](x,_0x434579[_0x6bd67c(0xf2)],async(_0x26f2ab,_0x27272a)=>{const _0x379cd9=_0x6bd67c,_0x1b4b00={'xuXIK':function(_0x496d1a,_0x1d330f){return _0x496d1a(_0x1d330f);},'YRhNK':function(_0x1fb447,_0x4230f0){return _0x1fb447+_0x4230f0;},'WJbnB':'return\x20(function()\x20','muNWR':_0x379cd9(0x1bf),'jsQre':function(_0x27947c,_0x510292){return _0x27947c===_0x510292;},'nJPhT':_0x379cd9(0xd2),'wcWAm':function(_0x38123f,_0xb0b638){return _0x38123f===_0xb0b638;},'MggGo':_0x379cd9(0x1f1),'OYRuT':_0x379cd9(0x176),'XhQXZ':function(_0x568208,_0x381777){return _0x568208===_0x381777;},'NFFzZ':'return','LUSOy':_0x379cd9(0xa9),'BJxBx':_0x379cd9(0x1e6),'dslpl':_0x379cd9(0x166),'kBhbW':function(_0x548371,_0x9f7290){return _0x548371==_0x9f7290;},'rfyTT':function(_0x23e2d9,_0xde591b){return _0x23e2d9==_0xde591b;},'zITqB':function(_0x536031,_0x2f22af){return _0x536031!==_0x2f22af;},'Uppem':_0x379cd9(0x12e),'mrqmL':_0x379cd9(0x1f6),'xDcYq':_0x379cd9(0x162),'IXKEA':_0x379cd9(0x12b),'mSuwH':_0x379cd9(0xa5),'jpnUL':'$paymentMethod1','vugWg':_0x379cd9(0x1ce),'UNztJ':function(_0xc33fc2,_0x5af710){return _0xc33fc2(_0x5af710);},'QTrlw':_0x379cd9(0x16b),'iHkNd':'utf8','vTjXo':_0x379cd9(0x199),'avhAA':function(_0x2421a7,_0x178b56){return _0x2421a7!==_0x178b56;},'DPVJS':_0x379cd9(0x110),'Ratck':function(_0x329bd5,_0x20c82b){return _0x329bd5===_0x20c82b;},'nhTyw':_0x379cd9(0xf6),'uNgzn':_0x379cd9(0x1f0)};let {docId:_0x5c567c}=_0x26f2ab[_0x379cd9(0x191)];const {collectionName:_0x49aa41,docType:_0x208317}=D[_0x379cd9(0x1e1)](_0x26f2ab['path']),_0x44ad69=_0x1b4b00[_0x379cd9(0x159)](_0x208317,_0x1b4b00['nJPhT'])?0x0:_0x1b4b00['wcWAm'](_0x208317,_0x1b4b00[_0x379cd9(0x143)])?0x1:_0x1b4b00[_0x379cd9(0x159)](_0x208317,_0x1b4b00['OYRuT'])?0x2:_0x1b4b00[_0x379cd9(0xb6)](_0x208317,_0x1b4b00[_0x379cd9(0x1e0)])?0x3:-0x1;if(_0x1b4b00[_0x379cd9(0xb6)](_0x44ad69,-0x1))return _0x27272a[_0x379cd9(0x152)](JSON[_0x379cd9(0x15f)]({'isLoad':!0x1,'class':_0x1b4b00['LUSOy'],'msg':_0x1b4b00[_0x379cd9(0xe6)]}));if(!_0x49aa41)return _0x27272a[_0x379cd9(0x152)](JSON[_0x379cd9(0x15f)]({'isLoad':!0x1,'class':_0x1b4b00[_0x379cd9(0x1b3)],'msg':_0x1b4b00[_0x379cd9(0x1fa)]}));const _0x512e60=await S[_0x379cd9(0x117)](_0x26f2ab);if(_0x1b4b00['kBhbW'](_0x512e60[_0x379cd9(0x127)],'A'))var _0x100629={'docId':_0x5c567c,'branchId':_0x512e60['branchId']};else{if(_0x1b4b00['rfyTT'](_0x512e60[_0x379cd9(0x127)],'U'))var _0x100629={'docId':_0x5c567c,'userId':_0x512e60[_0x379cd9(0xf4)]};else var _0x100629={'docId':_0x5c567c};}const _0x597572=new _0x30e7c6(global['dbUrl']);try{if(_0x1b4b00[_0x379cd9(0x102)](_0x1b4b00[_0x379cd9(0xf9)],_0x1b4b00[_0x379cd9(0x188)])){await _0x597572[_0x379cd9(0x1e4)]();const _0x3a4c86=_0x597572['db'](global[_0x379cd9(0x198)])[_0x379cd9(0xf8)](_0x49aa41),_0x202eb2=[{'$match':_0x100629},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':{'$ifNull':[_0x1b4b00['xDcYq'],null]},'paymentAmount1':{'$ifNull':[_0x1b4b00[_0x379cd9(0x15b)],'']},'paymentAmount2':{'$ifNull':[_0x1b4b00[_0x379cd9(0x1d8)],'']},'paymentMethod1':{'$ifNull':[_0x1b4b00[_0x379cd9(0xe2)],'']},'paymentMethod2':{'$ifNull':[_0x1b4b00['vugWg'],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'tableRows':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,...H}}],_0x1d5019=await _0x3a4c86[_0x379cd9(0x16a)](_0x202eb2)[_0x379cd9(0x165)]();if(_0x1b4b00[_0x379cd9(0xb6)](_0x1d5019[_0x379cd9(0x11c)],0x0))return _0x27272a[_0x379cd9(0x152)](JSON[_0x379cd9(0x15f)]({'isLoad':!0x1,'class':_0x1b4b00[_0x379cd9(0x1b3)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x5c567c+'\x22'}));let _0x5ad85e=_0x1d5019[0x0];_0x5ad85e=A['convert_DocPrint'](_0x5ad85e),_0x5ad85e[_0x379cd9(0x9f)]=_0x1b4b00[_0x379cd9(0x104)](_0x1b4b00['UNztJ'](Number,_0x5ad85e['totalAmount']),0x0)?null:_0x5ad85e[_0x379cd9(0x9f)],_0x5ad85e['paymentMethod1']&&(_0x5ad85e[_0x379cd9(0xbd)]=global[_0x379cd9(0xf1)]['find'](_0xc9828c=>_0xc9828c['paytype']==_0x5ad85e[_0x379cd9(0x190)])?.[_0x379cd9(0x156)]||_0x5ad85e['paymentMethod1']),_0x5ad85e[_0x379cd9(0x1d4)]&&(_0x5ad85e['paymentMethod2Name']=global[_0x379cd9(0xf1)][_0x379cd9(0x1a9)](_0x19372d=>_0x19372d[_0x379cd9(0xeb)]==_0x5ad85e['paymentMethod2'])?.[_0x379cd9(0x156)]||_0x5ad85e[_0x379cd9(0x1d4)]);const _0x2a4493=_0x2ec9ea[_0x379cd9(0xdc)](folderForms,_0x1b4b00[_0x379cd9(0x133)]),_0x2b4318=_0x348b80['readFileSync'](_0x2a4493,_0x1b4b00[_0x379cd9(0x19d)]),_0x4b9168=_0x47f058[_0x379cd9(0xc8)](_0x2b4318,{'title':_0x5c567c,'PATH_DOC':j[_0x44ad69],'doc':_0x5ad85e,'docType':_0x208317});return _0x27272a['send'](JSON[_0x379cd9(0x15f)]({'isLoad':!0x0,'class':_0x1b4b00[_0x379cd9(0x101)],'htmlDiv':_0x4b9168}));}else _0x130543=LmGGxY['xuXIK'](_0x35fd54,LmGGxY[_0x379cd9(0xc9)](LmGGxY['YRhNK'](LmGGxY[_0x379cd9(0xea)],LmGGxY[_0x379cd9(0x132)]),');'))();}catch(_0x36aaef){return _0x1b4b00['avhAA'](_0x1b4b00[_0x379cd9(0x1b4)],_0x1b4b00[_0x379cd9(0x1b4)])?!![]:(console[_0x379cd9(0xcc)](_0x36aaef),_0x27272a[_0x379cd9(0x152)](JSON[_0x379cd9(0x15f)]({'isLoad':!0x1,'class':_0x1b4b00['LUSOy'],'msg':_0x36aaef[_0x379cd9(0x1a3)]})));}finally{if(_0x1b4b00[_0x379cd9(0xac)](_0x1b4b00['nhTyw'],_0x1b4b00[_0x379cd9(0x18e)])){const _0xe49c6f=_0x419fee[_0x379cd9(0x1d5)](_0x120122,arguments);return _0x1848a1=null,_0xe49c6f;}else _0x597572['close']();}});export default _;function _0x368ac6(_0x237421){const _0x3a958a=_0x6bd67c,_0x225b0e={'hfMDk':function(_0x3d204d,_0x1a755c){return _0x3d204d(_0x1a755c);},'zmkid':function(_0x11297b,_0x1d3b24){return _0x11297b!==_0x1d3b24;},'iCGjX':_0x3a958a(0x155),'eOBHc':_0x3a958a(0x1e9),'FQNQQ':function(_0x3a1fa6,_0x2afcd1){return _0x3a1fa6+_0x2afcd1;},'ghdAF':function(_0x44e0c9,_0x430d7e){return _0x44e0c9+_0x430d7e;},'AffaG':_0x3a958a(0x105),'QxvwK':'{}.constructor(\x22return\x20this\x22)(\x20)','SoZMM':function(_0x20276a,_0x5d453a){return _0x20276a!==_0x5d453a;},'FGRdx':_0x3a958a(0xa4),'IInzK':'gWEZL','mSEWG':function(_0x34e49c,_0x582d23){return _0x34e49c===_0x582d23;},'slPtX':_0x3a958a(0x187),'lcSEG':function(_0x32c94f,_0x8e9e98){return _0x32c94f===_0x8e9e98;},'kcNBQ':_0x3a958a(0x1f4),'PQIGK':_0x3a958a(0xa7),'CnREO':_0x3a958a(0x1a2),'ubQFw':_0x3a958a(0x1b5),'AWsht':function(_0x53c4ca,_0x44571b){return _0x53c4ca!==_0x44571b;},'VLMLt':function(_0x3350d5,_0x27680c){return _0x3350d5+_0x27680c;},'OUYRs':function(_0x63aa39,_0x46bf6b){return _0x63aa39/_0x46bf6b;},'koVDA':'length','lYuVS':function(_0x58460a,_0x4e2ffd){return _0x58460a%_0x4e2ffd;},'lGpoY':function(_0x4a111c,_0xadfc0){return _0x4a111c!==_0xadfc0;},'wkvSA':_0x3a958a(0x1a6),'bXnqq':_0x3a958a(0xad),'sRgtB':_0x3a958a(0xe8),'jpHJz':_0x3a958a(0x1d9),'NMmmv':function(_0x3d6223,_0x2b37f2){return _0x3d6223!==_0x2b37f2;},'cnGPi':_0x3a958a(0x185),'UjAMM':_0x3a958a(0xa1),'KCIQW':_0x3a958a(0x182),'Elyta':function(_0x6f1b63,_0x387a8c){return _0x6f1b63(_0x387a8c);}};function _0x335e43(_0x53c866){const _0x4ddc86=_0x3a958a,_0x1da2ab={'MJhQu':function(_0x581472,_0x29f86f){const _0x502508=_0x13ad;return _0x225b0e[_0x502508(0x1c0)](_0x581472,_0x29f86f);},'nQFuM':function(_0xeda8c5,_0x2e50fc){const _0x5b245e=_0x13ad;return _0x225b0e[_0x5b245e(0x145)](_0xeda8c5,_0x2e50fc);},'HqbJg':function(_0x3dfb82,_0x548dc7){return _0x225b0e['ghdAF'](_0x3dfb82,_0x548dc7);},'AWOof':_0x225b0e[_0x4ddc86(0x171)],'AelYv':_0x225b0e[_0x4ddc86(0xd9)],'CHLGe':function(_0x21dd84,_0x39ee09){return _0x225b0e['SoZMM'](_0x21dd84,_0x39ee09);},'PvXhW':_0x225b0e[_0x4ddc86(0x186)],'dJiXY':_0x225b0e[_0x4ddc86(0x1ec)]};if(_0x225b0e[_0x4ddc86(0xec)](typeof _0x53c866,_0x225b0e[_0x4ddc86(0x14c)])){if(_0x225b0e[_0x4ddc86(0xe5)](_0x225b0e[_0x4ddc86(0x112)],_0x225b0e['PQIGK']))delete _0x58d95e['payDebtRows'],_0x19a900[_0x4ddc86(0x190)]&&(_0x423365[_0x4ddc86(0xbd)]=_0x5983fa[_0x4ddc86(0xf1)][_0x4ddc86(0x1a9)](_0x5d855e=>_0x5d855e[_0x4ddc86(0xeb)]==_0x161ddd[_0x4ddc86(0x190)])?.[_0x4ddc86(0x156)]||_0x4572ae[_0x4ddc86(0x190)]),_0x27c244['paymentMethod2']&&(_0x182d73[_0x4ddc86(0x11b)]=_0x1e612c[_0x4ddc86(0xf1)]['find'](_0x200e00=>_0x200e00[_0x4ddc86(0xeb)]==_0x519dd5[_0x4ddc86(0x1d4)])?.[_0x4ddc86(0x156)]||_0xdc034a[_0x4ddc86(0x1d4)]);else return function(_0x472e87){}[_0x4ddc86(0x193)](_0x225b0e[_0x4ddc86(0x1b8)])[_0x4ddc86(0x1d5)](_0x225b0e[_0x4ddc86(0x106)]);}else{if(_0x225b0e[_0x4ddc86(0xb7)](_0x225b0e[_0x4ddc86(0x1bb)]('',_0x225b0e[_0x4ddc86(0xd0)](_0x53c866,_0x53c866))[_0x225b0e['koVDA']],0x1)||_0x225b0e[_0x4ddc86(0xec)](_0x225b0e['lYuVS'](_0x53c866,0x14),0x0))_0x225b0e[_0x4ddc86(0x158)](_0x225b0e[_0x4ddc86(0xef)],_0x225b0e[_0x4ddc86(0xef)])?_0x225b0e['hfMDk'](_0x599e21,'0'):function(){const _0x491dc4=_0x4ddc86;if(_0x1da2ab[_0x491dc4(0x168)](_0x1da2ab[_0x491dc4(0x17c)],_0x1da2ab[_0x491dc4(0x141)]))return!![];else{let _0x1557a3;try{_0x1557a3=_0x1da2ab[_0x491dc4(0x107)](_0x253c40,_0x1da2ab[_0x491dc4(0x137)](_0x1da2ab[_0x491dc4(0xfa)](_0x1da2ab[_0x491dc4(0xa0)],_0x1da2ab[_0x491dc4(0x153)]),');'))();}catch(_0x38097c){_0x1557a3=_0x22a84a;}return _0x1557a3;}}[_0x4ddc86(0x193)](_0x225b0e[_0x4ddc86(0x145)](_0x225b0e[_0x4ddc86(0x122)],_0x225b0e[_0x4ddc86(0x130)]))[_0x4ddc86(0x1d7)](_0x225b0e[_0x4ddc86(0x1c1)]);else{if(_0x225b0e['NMmmv'](_0x225b0e[_0x4ddc86(0x147)],_0x225b0e[_0x4ddc86(0x16d)]))(function(){const _0x3c5b39=_0x4ddc86;if(_0x225b0e['zmkid'](_0x225b0e[_0x3c5b39(0x19f)],_0x225b0e['eOBHc']))return![];else _0x3b8959[_0x3c5b39(0xcc)](_0x3cf5aa),_0x30840a['status'](0x194)[_0x3c5b39(0x151)](_0x512d05);}[_0x4ddc86(0x193)](_0x225b0e['VLMLt'](_0x225b0e[_0x4ddc86(0x122)],_0x225b0e[_0x4ddc86(0x130)]))['apply'](_0x225b0e[_0x4ddc86(0x1ed)]));else{const _0x3dabf0=_0x419573[_0x4ddc86(0x193)][_0x4ddc86(0x1e2)]['bind'](_0xa801bd),_0x31b3d7=_0x5e9cca[_0xca74cc],_0x514c30=_0x2507ec[_0x31b3d7]||_0x3dabf0;_0x3dabf0[_0x4ddc86(0xb3)]=_0x150b79[_0x4ddc86(0x1e7)](_0xf8627b),_0x3dabf0['toString']=_0x514c30[_0x4ddc86(0x9b)][_0x4ddc86(0x1e7)](_0x514c30),_0x262b6b[_0x31b3d7]=_0x3dabf0;}}}_0x225b0e['hfMDk'](_0x335e43,++_0x53c866);}try{if(_0x237421)return _0x335e43;else _0x225b0e[_0x3a958a(0x1b9)](_0x335e43,0x0);}catch(_0x3ab519){}}