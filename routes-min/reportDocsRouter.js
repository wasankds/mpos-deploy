function _0x4e45(){const _0x3a338d=['QUIuR','UteOc','XLLiT','getDocs_MonthUnique','HJska','ZuiKd','taQca','PATH_WAREHOUSE_IN','MONTH_NAMES','action','$paymentAmount2','console','sBizN','eyTig','kdJGV','nBfuO','close','MCxfn','log','bg-cornblue','wTIqA','oKlzZ','iLeFO','KKZoB','UjGVV','KkXlN','wJDSj','sisPz','สรุปเอกสารวันที่','apply','gger','pmBRA','kGZnf','ggzfV','PATH_WAREHOUSE_OUT','JWJnV','qoAIS','PATH_SALES','kNMOF','qHmlq','NILed','$payDebtRows.amount','IpLvc','stateObject','fawHq','WHlis','uwedK','tyQlh','PbkTL','niepB','PDJCt','red','HYKmi','9VWjvGM','cmnMJ','return','isAuth','qCRdp','getUsers_for_report','PABHS','NXoNT','IbyZq','cEYNG','LOdxy','uyNAI','fxGrs','jRERl','4bKxspL','oLzfO','brvcE','warehouseIn','vTAOw','ctQzX','IskoH','xZuXy','ESeOU','NKoLi','docType','toString','/report','while\x20(true)\x20{}','userAuthority','/calendar','jRYxY','XCuYN','branchName','unshift','SmxNC','mWojT','MLYZs','wOlCo','sKWpi','send','ilqLA','ZCQwx','zXXVW','JTQaB','green','CHWRd','tArsT','fc-red','aSnAI','message','bRzJH','WaQnR','get','toArray','iOYqe','function\x20*\x5c(\x20*\x5c)','GoGff','VmrFW','paymentMethod2Name','bTTTX','nQIpQ','path','utf8','PAY_TYPE','PVHXz','aLTgM','yQPFx','error','ACdFQ','qtjIq','bg-deepskyblue','collectionName','body','HKNkY','$paymentMethod','XKVsN','renderView','XSNWJ','cuXMz','wXpiS','zoPIN','stringify','VVPQm','AAYou','IWHsn','ALsfC','userFullname','IrFPn','lcGXK','FCbBm','UTifJ','XYcSl','FsBvW','5474510lkMBFD','init','$totalAmount','$payDebtRows','DKbCl','getSuppliers_for_report','/print','XfEbk','AawaA','BqPwv','pxEtm','2045568AhCLQV','bgClassColor','7215XBOWEP','ctTCV','BGEas','VTmrO','chain','ehELL','rZlIU','kGmyZ','gDUxf','PHRpG','totalAmount','222DiKszt','$paymentMethod1','FPmPV','find','getSessionData','RohBS','UPuai','pXFEi','Ufrep','table','Qjtaj','fEPZw','XJaDY','สร้าง','WNOrQ','call','status','NKvQZ','anutB','wtPQE','dbName','fEmGV','qWlig','vJlmt','sTPXZ','msg','$paymentAmount1','ycDWl','YtwNs','EKxJw','ZHnbp','getUserBranches','NQURx','aHFms','gKrZt','Router','warehouseOut','constructor','zHzJl','QKDZf','HGUzn','bmuja','collection','/myUsers.js','MtPyT','exception','eReYS','bind','RzQPS','สรุปเอกสารเดือน',',\x20[','../','test','Kluel','pnjnK','rbiGC','tMGtW','bg-dodgerblue','pIlhn','yJFEe','262099CmHMtU','length','sseEa','/conclude','koNBA','OYIKQ','ODiUo','reportDocs','PATH_RETURN','MCHOo','GhQoO','branchId','Qicyx','762678vocMho','SbDfx','rSlta','KaBrc','LDWbF','lIWCv','YdrOl','BOMiO','forEach','idmog','/myDateTime.js','qYmSt','ejMqP','VekRw','SBDAw','GMrlY','dOtiH','sGjfs','SNGSC','getSettings','flash','HfEwL','VgHPE','clzfB','connect','__proto__','trace','VnFSV','uMsSP','lpkdW','aOKOe','VHDyV','LrXpj','TYgNo','$docStatusNumber','fvXrZ','tUyvL','readFileSync','return\x20(function()\x20','ttuYB','ยกเลิก','sales','fc-orange','debu','gRJgD','OJJfk','OYPUQ','oZTuF','{}.constructor(\x22return\x20this\x22)(\x20)','MZLuz','KrlNR','nsQqW','ไม่พบเอกสารเลขที่\x20\x22','/myModule.js','jugcX','Tjvyv','EWFCj','getDate','paymentMethod1Name','nRpBG','bPUOs','UDZdK','wLGjY','InKlC','2042072tZjxYX','payDebtRows','waKBx','Unknown','GxNST','aNNhM','xsezs','kYTpD','bg-orange','pPYRI','prototype','aggregate','join','userId','dbUrl','warn','paymentMethod1','dsDlG','FrGKC','BWmef','aAwuZ','MSnZe','SiLIc','BKmms','KCmYS','payTypeThai','FFWoD','paytype','zimRX','convert_DocPrint','WCNkU','GSEws','LKEdG','/load','rbCkZ','1474405jUjLHj','ZINXu','QTgaZ','AurZH','paymentMethod2','xyaug','OrBBm','โหลดข้อมูลเรียบร้อยแล้ว','EWLPQ','counter','get_Info_ByPath','$paymentMethod2','mJaIC','fRcPS','UCdxY','tBakC','mzbBh','pOjNl','eXBHK','render','info','omXgC','LRvVy'];_0x4e45=function(){return _0x3a338d;};return _0x4e45();}const _0x2c2e16=_0xad4c;(function(_0x13923a,_0x4bc5e9){const _0x323a6b=_0xad4c,_0x154db9=_0x13923a();while(!![]){try{const _0x1cf222=-parseInt(_0x323a6b(0x2f5))/0x1+parseInt(_0x323a6b(0x2b9))/0x2*(-parseInt(_0x323a6b(0x2ae))/0x3)+-parseInt(_0x323a6b(0x252))/0x4*(-parseInt(_0x323a6b(0x1f8))/0x5)+-parseInt(_0x323a6b(0x302))/0x6+-parseInt(_0x323a6b(0x2ac))/0x7+-parseInt(_0x323a6b(0x342))/0x8*(-parseInt(_0x323a6b(0x244))/0x9)+parseInt(_0x323a6b(0x2a1))/0xa;if(_0x1cf222===_0x4bc5e9)break;else _0x154db9['push'](_0x154db9['shift']());}catch(_0x21bcc4){_0x154db9['push'](_0x154db9['shift']());}}}(_0x4e45,0x246d0));const _0x32ccfc=(function(){const _0x20a04e=_0xad4c,_0x5e653d={'ZCQwx':function(_0x4a3b39,_0x5aa990){return _0x4a3b39===_0x5aa990;},'UDZdK':_0x20a04e(0x27a),'KkXlN':function(_0x570fbd,_0x34ade1){return _0x570fbd===_0x34ade1;},'tMGtW':'cDLQT','lcGXK':function(_0x5b328e,_0x123fba){return _0x5b328e(_0x123fba);},'yQPFx':function(_0x50e5ba,_0x578ead){return _0x50e5ba+_0x578ead;},'gDUxf':'return\x20(function()\x20','qtjIq':_0x20a04e(0x332),'WaQnR':function(_0x234e09){return _0x234e09();},'tArsT':'log','KCmYS':_0x20a04e(0x351),'sTPXZ':_0x20a04e(0x20c),'AawaA':_0x20a04e(0x287),'zHzJl':_0x20a04e(0x2e6),'ZINXu':_0x20a04e(0x2c2),'QKDZf':_0x20a04e(0x31c),'yakGN':function(_0x525af7,_0x46a917){return _0x525af7<_0x46a917;},'jRERl':_0x20a04e(0x215)};let _0x75c5b2=!![];return function(_0x351ebb,_0x329601){const _0x37062b=_0x20a04e,_0x4f6b30={'anutB':function(_0x28d5db,_0x79f19f){const _0x5a6014=_0xad4c;return _0x5e653d[_0x5a6014(0x29c)](_0x28d5db,_0x79f19f);},'Qicyx':function(_0x43bbb6,_0x5ac1f0){const _0x1132c4=_0xad4c;return _0x5e653d[_0x1132c4(0x286)](_0x43bbb6,_0x5ac1f0);},'KCaHr':function(_0x17606c,_0x3f15e6){const _0x58db45=_0xad4c;return _0x5e653d[_0x58db45(0x286)](_0x17606c,_0x3f15e6);},'vJlmt':_0x5e653d[_0x37062b(0x2b6)],'rbCkZ':_0x5e653d[_0x37062b(0x289)],'AurZH':function(_0x15a498){const _0x528d72=_0x37062b;return _0x5e653d[_0x528d72(0x277)](_0x15a498);},'IrFPn':_0x5e653d[_0x37062b(0x272)],'VnFSV':_0x5e653d[_0x37062b(0x1ed)],'kGmyZ':_0x5e653d[_0x37062b(0x2d1)],'PVHXz':_0x5e653d[_0x37062b(0x2a9)],'UPuai':_0x5e653d[_0x37062b(0x2df)],'fxGrs':_0x5e653d[_0x37062b(0x1f9)],'BGEas':_0x5e653d[_0x37062b(0x2e0)],'YdrOl':function(_0x33576b,_0x34e80c){return _0x5e653d['yakGN'](_0x33576b,_0x34e80c);}};if(_0x5e653d[_0x37062b(0x26d)](_0x5e653d[_0x37062b(0x251)],_0x5e653d[_0x37062b(0x251)])){const _0x20bce6=_0x75c5b2?function(){const _0x22b633=_0x37062b;if(_0x5e653d[_0x22b633(0x26d)](_0x5e653d[_0x22b633(0x33f)],_0x5e653d[_0x22b633(0x33f)])){if(_0x329601){if(_0x5e653d[_0x22b633(0x228)](_0x5e653d['tMGtW'],_0x5e653d[_0x22b633(0x2f1)])){const _0x45ca7e=_0x329601['apply'](_0x351ebb,arguments);return _0x329601=null,_0x45ca7e;}else{let _0x579109;try{const _0x547d1b=_0x4f6b30[_0x22b633(0x2cb)](_0x20c953,_0x4f6b30[_0x22b633(0x301)](_0x4f6b30['KCaHr'](_0x4f6b30[_0x22b633(0x2d0)],_0x4f6b30[_0x22b633(0x1f7)]),');'));_0x579109=_0x4f6b30[_0x22b633(0x1fb)](_0x547d1b);}catch(_0x567f54){_0x579109=_0x4ff06c;}const _0x154ade=_0x579109[_0x22b633(0x21a)]=_0x579109[_0x22b633(0x21a)]||{},_0x119a05=[_0x4f6b30[_0x22b633(0x29b)],_0x4f6b30[_0x22b633(0x31d)],_0x4f6b30[_0x22b633(0x2b5)],_0x4f6b30[_0x22b633(0x284)],_0x4f6b30[_0x22b633(0x2bf)],_0x4f6b30[_0x22b633(0x250)],_0x4f6b30[_0x22b633(0x2b0)]];for(let _0x1a979a=0x0;_0x4f6b30[_0x22b633(0x308)](_0x1a979a,_0x119a05[_0x22b633(0x2f6)]);_0x1a979a++){const _0x59fb7a=_0x2dc0cd[_0x22b633(0x2de)][_0x22b633(0x34c)][_0x22b633(0x2e8)](_0x5b354d),_0x3fdc5b=_0x119a05[_0x1a979a],_0x4bc89b=_0x154ade[_0x3fdc5b]||_0x59fb7a;_0x59fb7a[_0x22b633(0x31b)]=_0x5bbc63['bind'](_0xf19667),_0x59fb7a['toString']=_0x4bc89b[_0x22b633(0x25d)]['bind'](_0x4bc89b),_0x154ade[_0x3fdc5b]=_0x59fb7a;}}}}else _0x5f4bc6=_0x49965e;}:function(){};return _0x75c5b2=![],_0x20bce6;}else _0x4f6b30[_0x37062b(0x1fb)](_0x2d6064);};}());(function(){const _0x1e8448=_0xad4c,_0x4f50e0={'FrGKC':_0x1e8448(0x27b),'nQIpQ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ttuYB':function(_0x8006de,_0x551cde){return _0x8006de(_0x551cde);},'xZuXy':'init','iLeFO':function(_0x46dad0,_0x406831){return _0x46dad0+_0x406831;},'xsezs':_0x1e8448(0x2b2),'Tjvyv':'input','FCbBm':function(_0x45ed35){return _0x45ed35();},'cEYNG':function(_0x58eca7,_0x3c9776){return _0x58eca7!==_0x3c9776;},'wOlCo':_0x1e8448(0x241),'NMXaW':function(_0x450e6c,_0x6e1b39){return _0x450e6c(_0x6e1b39);},'vTAOw':function(_0x4f08d8,_0x210020){return _0x4f08d8+_0x210020;},'MCHOo':function(_0xf7dff9,_0x227f91){return _0xf7dff9+_0x227f91;},'rbiGC':_0x1e8448(0x288),'nsQqW':function(_0x59d871,_0x44cb74){return _0x59d871(_0x44cb74);},'PbkTL':function(_0x4ec284,_0x13caf2){return _0x4ec284===_0x13caf2;},'LRvVy':_0x1e8448(0x340),'HtFVY':function(_0xece7a6){return _0xece7a6();},'bmuja':function(_0x4fd2a2,_0x23928b,_0xbdf73b){return _0x4fd2a2(_0x23928b,_0xbdf73b);}};_0x4f50e0[_0x1e8448(0x2e2)](_0x32ccfc,this,function(){const _0x22b4e=_0x1e8448;if(_0x4f50e0[_0x22b4e(0x24d)](_0x4f50e0[_0x22b4e(0x269)],_0x4f50e0[_0x22b4e(0x269)])){const _0x24c671=new _0x5bb55e(_0x4f50e0[_0x22b4e(0x354)]),_0x4e20f8=new _0x5c0d86(_0x4f50e0[_0x22b4e(0x280)],'i'),_0xb9512c=_0x4f50e0[_0x22b4e(0x329)](_0x4edde3,_0x4f50e0[_0x22b4e(0x259)]);!_0x24c671[_0x22b4e(0x2ed)](_0x4f50e0[_0x22b4e(0x225)](_0xb9512c,_0x4f50e0[_0x22b4e(0x348)]))||!_0x4e20f8[_0x22b4e(0x2ed)](_0x4f50e0[_0x22b4e(0x225)](_0xb9512c,_0x4f50e0[_0x22b4e(0x339)]))?_0x4f50e0[_0x22b4e(0x329)](_0xb9512c,'0'):_0x4f50e0[_0x22b4e(0x29d)](_0x577951);}else{const _0x34fdc7=new RegExp(_0x4f50e0[_0x22b4e(0x354)]),_0x2a2bfd=new RegExp(_0x4f50e0[_0x22b4e(0x280)],'i'),_0x4496e1=_0x4f50e0['NMXaW'](_0x23d035,_0x4f50e0[_0x22b4e(0x259)]);if(!_0x34fdc7[_0x22b4e(0x2ed)](_0x4f50e0[_0x22b4e(0x256)](_0x4496e1,_0x4f50e0[_0x22b4e(0x348)]))||!_0x2a2bfd[_0x22b4e(0x2ed)](_0x4f50e0[_0x22b4e(0x2fe)](_0x4496e1,_0x4f50e0[_0x22b4e(0x339)]))){if(_0x4f50e0[_0x22b4e(0x24d)](_0x4f50e0[_0x22b4e(0x2f0)],_0x4f50e0[_0x22b4e(0x2f0)])){const _0x18ef12=_0x611493['apply'](_0x48a0b7,arguments);return _0x36acdb=null,_0x18ef12;}else _0x4f50e0[_0x22b4e(0x335)](_0x4496e1,'0');}else{if(_0x4f50e0[_0x22b4e(0x23f)](_0x4f50e0[_0x22b4e(0x20e)],_0x4f50e0[_0x22b4e(0x20e)]))_0x4f50e0['HtFVY'](_0x23d035);else{const _0x124c3b=_0x4cd6d3[_0x22b4e(0x2de)]['prototype']['bind'](_0xc7db15),_0x236d7e=_0x504de5[_0x22cfa3],_0xdbc7c=_0x2fb710[_0x236d7e]||_0x124c3b;_0x124c3b[_0x22b4e(0x31b)]=_0x32646d[_0x22b4e(0x2e8)](_0x3c7615),_0x124c3b[_0x22b4e(0x25d)]=_0xdbc7c['toString'][_0x22b4e(0x2e8)](_0xdbc7c),_0x4a14f1[_0x236d7e]=_0x124c3b;}}}})();}());const _0x2895fc=(function(){const _0x249c37=_0xad4c,_0x12c03d={'sBizN':_0x249c37(0x242),'SNGSC':function(_0x26e357,_0x280ae1){return _0x26e357(_0x280ae1);},'WAOKa':function(_0x283182,_0x2bbebd){return _0x283182!==_0x2bbebd;},'pPYRI':_0x249c37(0x1f4),'nRpBG':_0x249c37(0x30b),'XYcSl':_0x249c37(0x2b4),'QMoXE':_0x249c37(0x1f5),'PHRpG':_0x249c37(0x358)};let _0x49eff2=!![];return function(_0x545792,_0x291f58){const _0x538b86=_0x249c37,_0x195a86={'FPmPV':function(_0x16d977,_0x51343d){const _0x4f2fd1=_0xad4c;return _0x12c03d[_0x4f2fd1(0x314)](_0x16d977,_0x51343d);},'NILed':function(_0x3503bf,_0x42bca6){return _0x12c03d['WAOKa'](_0x3503bf,_0x42bca6);},'aHFms':_0x12c03d[_0x538b86(0x34b)],'XKVsN':_0x12c03d[_0x538b86(0x33d)],'wRvXa':function(_0x2bf9,_0x499254){return _0x12c03d['WAOKa'](_0x2bf9,_0x499254);},'qlVgJ':_0x12c03d[_0x538b86(0x29f)],'BWmef':_0x12c03d['QMoXE']};if(_0x12c03d['WAOKa'](_0x12c03d[_0x538b86(0x2b7)],_0x12c03d[_0x538b86(0x2b7)]))_0x344da2['log'](_0x2fcc1d),_0x3205fe[_0x538b86(0x26b)](_0x3e0d67[_0x538b86(0x295)]({'isLoad':!0x1,'class':_0x12c03d[_0x538b86(0x21b)],'msg':_0x5d622c[_0x538b86(0x275)]}));else{const _0x388a78=_0x49eff2?function(){const _0x41c302=_0x538b86;if(_0x195a86[_0x41c302(0x237)](_0x195a86[_0x41c302(0x2da)],_0x195a86[_0x41c302(0x28f)])){if(_0x291f58){if(_0x195a86['wRvXa'](_0x195a86['qlVgJ'],_0x195a86[_0x41c302(0x355)])){const _0x37caf5=_0x291f58[_0x41c302(0x22c)](_0x545792,arguments);return _0x291f58=null,_0x37caf5;}else{if(_0x2f353f)return _0x185fbc;else _0x195a86[_0x41c302(0x2bb)](_0x33f41f,0x0);}}}else delete _0x4888d0[_0x41c302(0x343)],_0xa2d041[_0x41c302(0x352)]&&(_0x39a4ca['paymentMethod1Name']=_0x2777ba[_0x41c302(0x283)][_0x41c302(0x2bc)](_0x17a4fd=>_0x17a4fd[_0x41c302(0x1f0)]==_0x474a5e[_0x41c302(0x352)])?.[_0x41c302(0x1ee)]||_0x1ab1d6['paymentMethod1']),_0x443ac0[_0x41c302(0x1fc)]&&(_0x332826['paymentMethod2Name']=_0x272882[_0x41c302(0x283)][_0x41c302(0x2bc)](_0x444bcc=>_0x444bcc[_0x41c302(0x1f0)]==_0x3135c0[_0x41c302(0x1fc)])?.[_0x41c302(0x1ee)]||_0x45dd6e[_0x41c302(0x1fc)]);}:function(){};return _0x49eff2=![],_0x388a78;}};}()),_0x31d160=_0x2895fc(this,function(){const _0x54bd3f=_0xad4c,_0x250ae2={'VgHPE':function(_0x1df0da,_0x1a6be1){return _0x1df0da(_0x1a6be1);},'OrBBm':function(_0x19dd2b,_0x580b21){return _0x19dd2b===_0x580b21;},'wXpiS':_0x54bd3f(0x208),'SmxNC':function(_0x43636b,_0x112fac){return _0x43636b+_0x112fac;},'GoGff':function(_0x2924f8,_0x157abc){return _0x2924f8+_0x157abc;},'tKQXc':'return\x20(function()\x20','cuXMz':_0x54bd3f(0x332),'oKlzZ':function(_0x1c6df3){return _0x1c6df3();},'FsBvW':function(_0x14fca1,_0x1af723){return _0x14fca1===_0x1af723;},'KrlNR':_0x54bd3f(0x298),'zoPIN':'dVwsU','qWlig':_0x54bd3f(0x221),'zimRX':_0x54bd3f(0x351),'XfEbk':'info','CWktx':'error','zoMYg':'exception','waKBx':_0x54bd3f(0x2c2),'xyaug':_0x54bd3f(0x31c),'BOMiO':function(_0x2ebf2a,_0x333236){return _0x2ebf2a<_0x333236;},'zSymz':function(_0xbb092a,_0x179f0c){return _0xbb092a===_0x179f0c;},'Ufrep':_0x54bd3f(0x356)};let _0x384fa8;try{if(_0x250ae2[_0x54bd3f(0x1fe)](_0x250ae2[_0x54bd3f(0x293)],_0x250ae2[_0x54bd3f(0x293)])){const _0x2c46b5=_0x250ae2[_0x54bd3f(0x318)](Function,_0x250ae2[_0x54bd3f(0x266)](_0x250ae2[_0x54bd3f(0x27c)](_0x250ae2['tKQXc'],_0x250ae2[_0x54bd3f(0x292)]),');'));_0x384fa8=_0x250ae2[_0x54bd3f(0x224)](_0x2c46b5);}else{const _0x4d09f9=_0x2ae46f?function(){const _0x1f1835=_0x54bd3f;if(_0x1ec3d0){const _0x3b1a98=_0xf14192[_0x1f1835(0x22c)](_0x2735e4,arguments);return _0x4c0294=null,_0x3b1a98;}}:function(){};return _0x523961=![],_0x4d09f9;}}catch(_0x90e4d8){_0x250ae2[_0x54bd3f(0x2a0)](_0x250ae2[_0x54bd3f(0x334)],_0x250ae2[_0x54bd3f(0x294)])?_0x250ae2[_0x54bd3f(0x318)](_0x5bec80,'0'):_0x384fa8=window;}const _0x2b8fec=_0x384fa8[_0x54bd3f(0x21a)]=_0x384fa8[_0x54bd3f(0x21a)]||{},_0xb6853c=[_0x250ae2[_0x54bd3f(0x2cf)],_0x250ae2[_0x54bd3f(0x1f1)],_0x250ae2[_0x54bd3f(0x2a8)],_0x250ae2['CWktx'],_0x250ae2['zoMYg'],_0x250ae2[_0x54bd3f(0x344)],_0x250ae2[_0x54bd3f(0x1fd)]];for(let _0x3ffaee=0x0;_0x250ae2[_0x54bd3f(0x309)](_0x3ffaee,_0xb6853c[_0x54bd3f(0x2f6)]);_0x3ffaee++){if(_0x250ae2['zSymz'](_0x250ae2[_0x54bd3f(0x2c1)],_0x250ae2['Ufrep'])){const _0x5b47d8=_0x2895fc['constructor'][_0x54bd3f(0x34c)][_0x54bd3f(0x2e8)](_0x2895fc),_0x2de3fe=_0xb6853c[_0x3ffaee],_0x40f577=_0x2b8fec[_0x2de3fe]||_0x5b47d8;_0x5b47d8[_0x54bd3f(0x31b)]=_0x2895fc[_0x54bd3f(0x2e8)](_0x2895fc),_0x5b47d8[_0x54bd3f(0x25d)]=_0x40f577['toString']['bind'](_0x40f577),_0x2b8fec[_0x2de3fe]=_0x5b47d8;}else{if(_0x425eda){const _0x5e56db=_0x185fa3['apply'](_0x14ee7b,arguments);return _0x393d69=null,_0x5e56db;}}}});_0x31d160();import _0x2f914b from'express';const T=_0x2f914b[_0x2c2e16(0x2dc)]();import{MongoClient as _0x2ffe1c}from'mongodb';import _0x154656 from'ejs';import _0x31d19a from'path';function _0xad4c(_0x5b06cd,_0x52dd0a){const _0x170990=_0x4e45();return _0xad4c=function(_0x31d160,_0x2895fc){_0x31d160=_0x31d160-0x1ed;let _0x10a847=_0x170990[_0x31d160];return _0x10a847;},_0xad4c(_0x5b06cd,_0x52dd0a);}import _0x1116ad from'fs';import _0x4da0a9 from'../middleware/mainAuth.js';const F=await import(_0x2c2e16(0x2ec)+mymoduleFolder+_0x2c2e16(0x337)),K=await import(_0x2c2e16(0x2ec)+mymoduleFolder+_0x2c2e16(0x30c)),S=await import('../'+mymoduleFolder+_0x2c2e16(0x2e4)),b=await import(_0x2c2e16(0x2ec)+mymoduleFolder+'/myData.js'),D=await import(_0x2c2e16(0x2ec)+mymoduleFolder+'/myDocMain.js'),w=_0x2c2e16(0x25e)+global[_0x2c2e16(0x216)],M='/report'+global[_0x2c2e16(0x231)],P=_0x2c2e16(0x25e)+global[_0x2c2e16(0x234)],O=_0x2c2e16(0x25e)+global[_0x2c2e16(0x2fd)],j=[global[_0x2c2e16(0x216)],global['PATH_WAREHOUSE_OUT'],global[_0x2c2e16(0x234)],global['PATH_RETURN']],B=[w,M,P,O],W=[w+'/conclude',M+_0x2c2e16(0x2f8),P+_0x2c2e16(0x2f8),O+_0x2c2e16(0x2f8)],Y=[w+'/calendar',M+_0x2c2e16(0x261),P+'/calendar',O+_0x2c2e16(0x261)],x=[w+'/load',M+_0x2c2e16(0x1f6),P+'/load',O+_0x2c2e16(0x1f6)],Q=[global[_0x2c2e16(0x216)]+'/print',global[_0x2c2e16(0x231)]+_0x2c2e16(0x2a7),global[_0x2c2e16(0x234)]+_0x2c2e16(0x2a7),global['PATH_RETURN']+_0x2c2e16(0x2a7)],H={'docStatus':{'$switch':{'branches':[{'case':{'$eq':['$docStatusNumber',0x1]},'then':_0x2c2e16(0x2c6)},{'case':{'$eq':[_0x2c2e16(0x324),0x2]},'then':'จบ'},{'case':{'$eq':[_0x2c2e16(0x324),0xa]},'then':_0x2c2e16(0x32a)}],'default':_0x2c2e16(0x345)}},'docStatusColor':{'$switch':{'branches':[{'case':{'$eq':[_0x2c2e16(0x324),0x1]},'then':'fc-dodgerblue'},{'case':{'$eq':[_0x2c2e16(0x324),0x2]},'then':'fc-green'},{'case':{'$eq':[_0x2c2e16(0x324),0xa]},'then':_0x2c2e16(0x32c)}],'default':_0x2c2e16(0x273)}},'docStatusBgColor':{'$switch':{'branches':[{'case':{'$eq':[_0x2c2e16(0x324),0x1]},'then':_0x2c2e16(0x2f2)},{'case':{'$eq':[_0x2c2e16(0x324),0x2]},'then':'bg-green'},{'case':{'$eq':[_0x2c2e16(0x324),0xa]},'then':_0x2c2e16(0x34a)}],'default':'bg-red'}}};T[_0x2c2e16(0x278)](B,_0x4da0a9['isAuth'],async(_0x5ce67d,_0x31761f)=>{const _0x568958=_0x2c2e16,_0x3e8896={'lpkdW':function(_0x545952,_0x5bc8d6){return _0x545952(_0x5bc8d6);},'pIlhn':function(_0x1a89fb,_0x102525){return _0x1a89fb+_0x102525;},'pnjnK':_0x568958(0x328),'gRJgD':_0x568958(0x332),'YtwNs':function(_0x3ecdc4){return _0x3ecdc4();},'EWLPQ':function(_0x5c9dff,_0x4e5f2e){return _0x5c9dff===_0x4e5f2e;},'MLYZs':_0x568958(0x255),'HKNkY':'warehouseOut','WNOrQ':function(_0x1db032,_0x3239f0){return _0x1db032===_0x3239f0;},'XLLiT':_0x568958(0x32b),'ctQzX':_0x568958(0x246),'tUyvL':function(_0x442c42,_0x202c74){return _0x442c42===_0x202c74;},'yJFEe':_0x568958(0x317),'UTifJ':function(_0x2231ee,_0x3c4b3e){return _0x2231ee==_0x3c4b3e;},'qYmSt':function(_0x5c99cf,_0x11dd83){return _0x5c99cf==_0x11dd83;},'ycDWl':function(_0x1b7910,_0x31960f){return _0x1b7910===_0x31960f;},'zXXVW':_0x568958(0x2fc),'Wfqvo':_0x568958(0x2d2),'dFdeD':_0x568958(0x222),'EWFCj':function(_0x41fae0,_0x186145){return _0x41fae0===_0x186145;},'zqcec':_0x568958(0x25b),'cMhTF':_0x568958(0x312)},_0x31f798=await S['getSessionData'](_0x5ce67d),_0x54f4e8=D[_0x568958(0x202)](_0x5ce67d[_0x568958(0x281)]),_0x4d0c73=_0x3e8896[_0x568958(0x200)](_0x54f4e8[_0x568958(0x25c)],_0x3e8896[_0x568958(0x268)])?0x0:_0x3e8896[_0x568958(0x200)](_0x54f4e8[_0x568958(0x25c)],_0x3e8896[_0x568958(0x28d)])?0x1:_0x3e8896[_0x568958(0x2c7)](_0x54f4e8[_0x568958(0x25c)],_0x3e8896[_0x568958(0x211)])?0x2:_0x3e8896['WNOrQ'](_0x54f4e8['docType'],_0x3e8896[_0x568958(0x257)])?0x3:-0x1;if(_0x3e8896['WNOrQ'](_0x4d0c73,-0x1))return _0x31761f[_0x568958(0x2c9)](0x194)['sendFile'](file404);try{if(_0x3e8896[_0x568958(0x326)](_0x3e8896[_0x568958(0x2f4)],_0x3e8896['yJFEe'])){if(_0x3e8896[_0x568958(0x29e)](_0x31f798[_0x568958(0x260)],'A'))var _0x219dfe=await b['getUsers_for_report']({'branchId':_0x31f798['branchId']}),_0x246c31=await b['getUserBranches']({'branchId':_0x31f798[_0x568958(0x300)]});else{if(_0x3e8896[_0x568958(0x30d)](_0x31f798[_0x568958(0x260)],'U'))var _0x219dfe=[],_0x246c31=[];else var _0x219dfe=await b[_0x568958(0x249)]({}),_0x246c31=await b[_0x568958(0x2d8)]({});}if(_0x3e8896[_0x568958(0x2d4)](_0x54f4e8[_0x568958(0x25c)],_0x3e8896[_0x568958(0x268)]))var _0x55d994=await b[_0x568958(0x2a6)]({});else var _0x55d994=[];const _0x111482=await b[_0x568958(0x212)](_0x54f4e8[_0x568958(0x28b)]),_0xe611d0=await F[_0x568958(0x290)](_0x3e8896[_0x568958(0x26e)],_0x31761f,{'title':_0x54f4e8['docTitle'],'time':K[_0x568958(0x33b)](),'msg':_0x5ce67d[_0x568958(0x316)](_0x3e8896['Wfqvo']),'user':_0x31f798,'settings':await F[_0x568958(0x315)](),'PATH_MAIN':B[_0x4d0c73],'PATH_DOC':j[_0x4d0c73],'PATH_CALENDAR':Y[_0x4d0c73],'PATH_CONCLUDE':W[_0x4d0c73],'PATH_PRINT_DOC':Q[_0x4d0c73],'PATH_LOAD':x[_0x4d0c73],'docType':_0x54f4e8[_0x568958(0x25c)],'bgClassColor':_0x54f4e8[_0x568958(0x2ad)]||_0x3e8896['dFdeD'],'dataUsersJson':JSON['stringify'](_0x219dfe),'dataBranchesJson':JSON[_0x568958(0x295)](_0x246c31),'dataSuppliersJson':JSON[_0x568958(0x295)](_0x55d994),'monthDocs':_0x111482,'dataDocConclude':JSON[_0x568958(0x295)]([])});_0x31761f[_0x568958(0x26b)](_0xe611d0);}else _0x547e58['log'](_0x5f501e),_0x577c73[_0x568958(0x2c9)](0x194)['sendFile'](_0x38adea);}catch(_0x19b78d){if(_0x3e8896[_0x568958(0x33a)](_0x3e8896['zqcec'],_0x3e8896['cMhTF'])){const _0x4fff3f=aKIrMV[_0x568958(0x31f)](_0x185c1c,aKIrMV['pIlhn'](aKIrMV[_0x568958(0x2f3)](aKIrMV[_0x568958(0x2ef)],aKIrMV[_0x568958(0x32e)]),');'));_0x2ab236=aKIrMV[_0x568958(0x2d5)](_0x4fff3f);}else console[_0x568958(0x221)](_0x19b78d),_0x31761f['status'](0x194)['sendFile'](file404);}}),T['post'](Y,_0x4da0a9[_0x2c2e16(0x247)],async(_0x536fd4,_0x3c59fd)=>{const _0xc42bd4=_0x2c2e16,_0x4cd0b0={'fxELd':_0xc42bd4(0x27b),'OmyKK':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','GhQoO':function(_0x56b1f5,_0x409428){return _0x56b1f5(_0x409428);},'OYIKQ':_0xc42bd4(0x2a2),'brvcE':function(_0x252431,_0x2db0e7){return _0x252431+_0x2db0e7;},'rzSOL':_0xc42bd4(0x2b2),'ejMqP':'input','GxNST':function(_0x16cf00){return _0x16cf00();},'nnDOs':function(_0x19e760,_0x586d3e,_0x4861e9){return _0x19e760(_0x586d3e,_0x4861e9);},'fvXrZ':function(_0x3fbe64,_0xa1c67a){return _0x3fbe64==_0xa1c67a;},'NXoNT':function(_0x20b017,_0xf9b1d7){return _0x20b017==_0xf9b1d7;},'kGZnf':function(_0x5210ac,_0x11fab4){return _0x5210ac-_0x11fab4;},'tyQlh':function(_0x5842bd,_0x4d211f){return _0x5842bd(_0x4d211f);},'sGjfs':'red','FFWoD':'ไม่พบชื่อคอเล็กชั่น','ZHnbp':function(_0xd19f81,_0x39215e){return _0xd19f81!==_0x39215e;},'qHmlq':'uktDi','ctTCV':'$docDateTime','eyTig':'$totalAmount','bcpLA':'$paymentAmount1','qoAIS':'$paymentAmount2','fEmGV':_0xc42bd4(0x28e),'MSnZe':_0xc42bd4(0x203),'AAYou':'green','fEPZw':_0xc42bd4(0x1ff),'ceXdP':function(_0x44e26f,_0x39673b){return _0x44e26f!==_0x39673b;},'InKlC':_0xc42bd4(0x2e9),'BqPwv':function(_0x47bb00,_0x540f00){return _0x47bb00===_0x540f00;},'WCNkU':_0xc42bd4(0x2be)};let {selectMonth:_0x1f56e6,userId:_0xb5c2bf,searchUser:_0x595639,branchId:_0x2f0f21,searchBranch:_0x8b5e30,supplierId:_0x3f5ce2,searchSupplier:_0x5cc182}=_0x536fd4[_0xc42bd4(0x28c)];_0xb5c2bf=_0xb5c2bf&&_0x4cd0b0['GhQoO'](Number,_0xb5c2bf),_0x2f0f21=_0x2f0f21&&_0x4cd0b0[_0xc42bd4(0x2ff)](Number,_0x2f0f21);const _0x2d8d3e=await S[_0xc42bd4(0x2bd)](_0x536fd4);_0x4cd0b0[_0xc42bd4(0x325)](_0x2d8d3e['userAuthority'],'A')?(_0x2f0f21=_0x2d8d3e[_0xc42bd4(0x300)],_0x8b5e30=_0x8b5e30||_0x2d8d3e[_0xc42bd4(0x264)]):_0x4cd0b0[_0xc42bd4(0x24b)](_0x2d8d3e[_0xc42bd4(0x260)],'U')&&(_0xb5c2bf=_0x2d8d3e['userId'],_0x595639=_0x595639||_0x2d8d3e[_0xc42bd4(0x29a)],_0x2f0f21=_0x2f0f21||_0x2d8d3e[_0xc42bd4(0x300)],_0x8b5e30=_0x8b5e30||_0x2d8d3e[_0xc42bd4(0x264)]);const [_0x34c793,_0x28337e]=_0x1f56e6['split']('-'),_0x1a4fe7=global[_0xc42bd4(0x217)][_0x4cd0b0[_0xc42bd4(0x22f)](_0x4cd0b0[_0xc42bd4(0x23e)](parseInt,_0x28337e),0x1)]+'\x20'+_0x34c793,{collectionName:_0x1ef3e7}=D['get_Info_ByPath'](_0x536fd4[_0xc42bd4(0x281)]);if(!_0x1ef3e7)return _0x3c59fd['send'](JSON[_0xc42bd4(0x295)]({'isLoad':!0x1,'class':_0x4cd0b0[_0xc42bd4(0x313)],'msg':_0x4cd0b0[_0xc42bd4(0x1ef)]}));let _0x15e904=''+_0x1a4fe7;_0xb5c2bf&&(_0x15e904+=_0xc42bd4(0x2eb)+_0xb5c2bf+']\x20'+_0x595639),_0x2f0f21&&(_0x15e904+=_0xc42bd4(0x2eb)+_0x2f0f21+']\x20'+_0x8b5e30),_0x3f5ce2&&(_0x15e904+=_0xc42bd4(0x2eb)+_0x3f5ce2+']\x20'+_0x5cc182);const _0x371013=new _0x2ffe1c(global['dbUrl']);try{if(_0x4cd0b0[_0xc42bd4(0x2d7)](_0x4cd0b0[_0xc42bd4(0x236)],_0x4cd0b0[_0xc42bd4(0x236)]))_0x4db66a['close']();else{await _0x371013['connect']();const _0x146ba7=_0x371013['db'](global[_0xc42bd4(0x2cd)])['collection'](_0x1ef3e7),_0x5798de=[{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':{'$substr':[_0x4cd0b0[_0xc42bd4(0x2af)],0x0,0xa]},'docDateTime':0x1,'totalAmount':{'$ifNull':[_0x4cd0b0[_0xc42bd4(0x21c)],0x0]},'paymentAmount1':{'$ifNull':[_0x4cd0b0['bcpLA'],'']},'paymentAmount2':{'$ifNull':[_0x4cd0b0[_0xc42bd4(0x233)],'']},'paymentMethod':{'$ifNull':[_0x4cd0b0[_0xc42bd4(0x2ce)],'']},'paymentMethod2':{'$ifNull':[_0x4cd0b0[_0xc42bd4(0x357)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,...H}}];_0xb5c2bf&&_0x5798de[_0xc42bd4(0x265)]({'$match':{'userId':_0xb5c2bf}}),_0x2f0f21&&_0x5798de[_0xc42bd4(0x265)]({'$match':{'branchId':_0x2f0f21}}),_0x3f5ce2&&_0x5798de['unshift']({'$match':{'supplierId':_0x3f5ce2}});const _0x34ec56=await _0x146ba7[_0xc42bd4(0x34d)](_0x5798de)[_0xc42bd4(0x279)]();_0x15e904+='\x20['+_0x34ec56['length']+']',_0x3c59fd[_0xc42bd4(0x26b)](JSON[_0xc42bd4(0x295)]({'isLoad':!0x0,'class':_0x4cd0b0[_0xc42bd4(0x297)],'title':_0x15e904,'dataDocs':_0x34ec56,'selectMonth':_0x1f56e6,'msg':_0x4cd0b0[_0xc42bd4(0x2c4)]}));}}catch(_0x3f5d3e){_0x4cd0b0['ceXdP'](_0x4cd0b0[_0xc42bd4(0x341)],_0x4cd0b0[_0xc42bd4(0x341)])?ppbrSb['nnDOs'](_0x17851e,this,function(){const _0x3e0f22=_0xc42bd4,_0x4dcd69=new _0x3ae39d(ppbrSb['fxELd']),_0x6fa79a=new _0x175600(ppbrSb['OmyKK'],'i'),_0x5919e4=ppbrSb[_0x3e0f22(0x2ff)](_0x4a6a6e,ppbrSb[_0x3e0f22(0x2fa)]);!_0x4dcd69[_0x3e0f22(0x2ed)](ppbrSb[_0x3e0f22(0x254)](_0x5919e4,ppbrSb['rzSOL']))||!_0x6fa79a[_0x3e0f22(0x2ed)](ppbrSb[_0x3e0f22(0x254)](_0x5919e4,ppbrSb[_0x3e0f22(0x30e)]))?ppbrSb[_0x3e0f22(0x2ff)](_0x5919e4,'0'):ppbrSb[_0x3e0f22(0x346)](_0x42a54c);})():(console[_0xc42bd4(0x221)](_0x3f5d3e),_0x3c59fd[_0xc42bd4(0x26b)](JSON['stringify']({'isLoad':!0x1,'class':_0x4cd0b0['sGjfs'],'title':_0x15e904,'selectMonth':_0x1f56e6,'msg':_0x3f5d3e[_0xc42bd4(0x275)]})));}finally{_0x4cd0b0[_0xc42bd4(0x2aa)](_0x4cd0b0[_0xc42bd4(0x1f3)],_0x4cd0b0['WCNkU'])?_0x371013[_0xc42bd4(0x21f)]():_0x95edb6[_0xc42bd4(0x21f)]();}}),T['post'](W,_0x4da0a9[_0x2c2e16(0x247)],async(_0x450bfa,_0x47e039)=>{const _0xc117b8=_0x2c2e16,_0x7fb45e={'ALsfC':function(_0x20cc40,_0x36e170){return _0x20cc40===_0x36e170;},'CXSQv':_0xc117b8(0x2c5),'XSNWJ':_0xc117b8(0x349),'OYPUQ':function(_0x4a1878,_0x12de56){return _0x4a1878+_0x12de56;},'aLTgM':'debu','bPUOs':_0xc117b8(0x22d),'KKZoB':_0xc117b8(0x218),'NQURx':function(_0x2752b8,_0x2923d9){return _0x2752b8(_0x2923d9);},'SBDAw':function(_0x548a3c,_0x1cff51){return _0x548a3c(_0x1cff51);},'pmBRA':function(_0x2a3cb7,_0x3c6b69){return _0x2a3cb7==_0x3c6b69;},'mtiub':function(_0x1f8df6,_0x5ad201){return _0x1f8df6==_0x5ad201;},'jugcX':'red','LrXpj':'ไม่พบชื่อคอเล็กชั่น','BKmms':function(_0x46408b,_0x2a7470){return _0x46408b&&_0x2a7470;},'IskoH':_0xc117b8(0x2ea),'ZjcNM':_0xc117b8(0x222),'dsDlG':function(_0x15e71b,_0x3b3fd3){return _0x15e71b&&_0x3b3fd3;},'hBvJa':_0xc117b8(0x22b),'tBakC':_0xc117b8(0x28a),'UteOc':function(_0x1ab6f4,_0x481905){return _0x1ab6f4!==_0x481905;},'lkDcl':_0xc117b8(0x24c),'GMrlY':_0xc117b8(0x232),'pXFEi':_0xc117b8(0x2d3),'ilqLA':'$paymentAmount2','pxEtm':_0xc117b8(0x2ba),'uyNAI':'$paymentMethod2','Llquw':_0xc117b8(0x2a4),'QYUSt':_0xc117b8(0x238),'ggzfV':'windowConcludeDocs.ejs','KaBrc':'utf8','MtPyT':_0xc117b8(0x270),'omXgC':_0xc117b8(0x214),'VdcbJ':function(_0x19d7fc,_0x319877){return _0x19d7fc===_0x319877;},'ODiUo':_0xc117b8(0x319),'oLzfO':_0xc117b8(0x26f)};let {selectMonth:_0x16b99d,selectMonthTh:_0x1d05e9,selectDateTh:_0x4b49a2,selectDate:_0x2a6cac,userId:_0x3648eb,searchUser:_0x14b739,branchId:_0x4e558f,searchBranch:_0xe55eed,supplierId:_0x56c486,searchSupplier:_0x3fd81b}=_0x450bfa[_0xc117b8(0x28c)];_0x3648eb=_0x3648eb&&_0x7fb45e[_0xc117b8(0x2d9)](Number,_0x3648eb),_0x4e558f=_0x4e558f&&_0x7fb45e[_0xc117b8(0x310)](Number,_0x4e558f);const _0x3f34c3=await S[_0xc117b8(0x2bd)](_0x450bfa);_0x7fb45e[_0xc117b8(0x22e)](_0x3f34c3[_0xc117b8(0x260)],'A')?(_0x4e558f=_0x3f34c3[_0xc117b8(0x300)],_0xe55eed=_0xe55eed||_0x3f34c3[_0xc117b8(0x264)]):_0x7fb45e['mtiub'](_0x3f34c3[_0xc117b8(0x260)],'U')&&(_0x3648eb=_0x3f34c3[_0xc117b8(0x34f)],_0x14b739=_0x14b739||_0x3f34c3['userFullname'],_0x4e558f=_0x4e558f||_0x3f34c3[_0xc117b8(0x300)],_0xe55eed=_0xe55eed||_0x3f34c3[_0xc117b8(0x264)]);const {docType:_0x525ff3,collectionName:_0x3dd98c}=D['get_Info_ByPath'](_0x450bfa[_0xc117b8(0x281)]);if(!_0x3dd98c)return _0x47e039[_0xc117b8(0x26b)](JSON[_0xc117b8(0x295)]({'isLoad':!0x1,'class':_0x7fb45e[_0xc117b8(0x338)],'msg':_0x7fb45e[_0xc117b8(0x322)]}));if(_0x7fb45e[_0xc117b8(0x359)](_0x16b99d,_0x1d05e9))var _0x231702=_0x7fb45e[_0xc117b8(0x258)],_0x19145c=''+_0x1d05e9,_0x2be869=_0x7fb45e['ZjcNM'],_0x308cda={'$regex':'^'+_0x16b99d};else{if(_0x7fb45e[_0xc117b8(0x353)](_0x2a6cac,_0x4b49a2))var _0x231702=_0x7fb45e['hBvJa'],_0x19145c=''+_0x4b49a2,_0x2be869=_0x7fb45e[_0xc117b8(0x207)],_0x308cda={'$regex':'^'+_0x2a6cac};}_0x3648eb&&(_0x19145c+=_0xc117b8(0x2eb)+_0x3648eb+']\x20'+_0x14b739),_0x4e558f&&(_0x19145c+=_0xc117b8(0x2eb)+_0x4e558f+']\x20'+_0xe55eed),_0x56c486&&(_0x19145c+=',\x20['+_0x56c486+']\x20'+_0x3fd81b);const _0x378f3a=new _0x2ffe1c(global[_0xc117b8(0x350)]);try{if(_0x7fb45e[_0xc117b8(0x210)](_0x7fb45e['lkDcl'],_0x7fb45e[_0xc117b8(0x311)])){await _0x378f3a['connect']();const _0x5304fb=_0x378f3a['db'](global['dbName'])[_0xc117b8(0x2e3)](_0x3dd98c),_0x137b0f=[{'$match':{'docDateTime':_0x308cda}},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':0x1,'paymentAmount1':{'$ifNull':[_0x7fb45e[_0xc117b8(0x2c0)],'']},'paymentAmount2':{'$ifNull':[_0x7fb45e[_0xc117b8(0x26c)],'']},'paymentMethod1':{'$ifNull':[_0x7fb45e[_0xc117b8(0x2ab)],'']},'paymentMethod2':{'$ifNull':[_0x7fb45e[_0xc117b8(0x24f)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,'payDebtTotal':{'$cond':{'if':{'$isArray':_0x7fb45e['Llquw']},'then':{'$sum':_0x7fb45e['QYUSt']},'else':0x0}},...H}}];_0x3648eb&&_0x137b0f[_0xc117b8(0x265)]({'$match':{'userId':_0x3648eb}}),_0x4e558f&&_0x137b0f['unshift']({'$match':{'branchId':_0x4e558f}}),_0x56c486&&_0x137b0f[_0xc117b8(0x265)]({'$match':{'supplierId':_0x56c486}});const _0x20ec90=await _0x5304fb[_0xc117b8(0x34d)](_0x137b0f)[_0xc117b8(0x279)]();_0x20ec90[_0xc117b8(0x30a)](_0x33d4b2=>{const _0xbcff82=_0xc117b8;if(_0x7fb45e[_0xbcff82(0x299)](_0x7fb45e['CXSQv'],_0x7fb45e[_0xbcff82(0x291)])){const _0x26fe38=_0x8ea9ee?function(){const _0x2e6e29=_0xbcff82;if(_0x5eacf3){const _0x45b0e7=_0x4293db[_0x2e6e29(0x22c)](_0x4d773a,arguments);return _0x250017=null,_0x45b0e7;}}:function(){};return _0x4bb310=![],_0x26fe38;}else delete _0x33d4b2['payDebtRows'],_0x33d4b2[_0xbcff82(0x352)]&&(_0x33d4b2[_0xbcff82(0x33c)]=global[_0xbcff82(0x283)][_0xbcff82(0x2bc)](_0x3b79a8=>_0x3b79a8[_0xbcff82(0x1f0)]==_0x33d4b2[_0xbcff82(0x352)])?.[_0xbcff82(0x1ee)]||_0x33d4b2[_0xbcff82(0x352)]),_0x33d4b2[_0xbcff82(0x1fc)]&&(_0x33d4b2[_0xbcff82(0x27e)]=global[_0xbcff82(0x283)][_0xbcff82(0x2bc)](_0x3722e2=>_0x3722e2[_0xbcff82(0x1f0)]==_0x33d4b2['paymentMethod2'])?.[_0xbcff82(0x1ee)]||_0x33d4b2['paymentMethod2']);});const _0x1be690=_0x31d19a[_0xc117b8(0x34e)](folderForms,_0x7fb45e[_0xc117b8(0x230)]),_0x1cbff3=_0x1116ad['readFileSync'](_0x1be690,_0x7fb45e[_0xc117b8(0x305)]);var _0x569705=_0x154656[_0xc117b8(0x20b)](_0x1cbff3,{'titleConclude':_0x231702,'title':_0x19145c,'titleClassColor':_0x2be869,'docType':_0x525ff3,'data':_0x20ec90});return _0x47e039[_0xc117b8(0x26b)](JSON[_0xc117b8(0x295)]({'isLoad':!0x0,'class':_0x7fb45e[_0xc117b8(0x2e5)],'htmlDiv':_0x569705}));}else _0x267aa9['close']();}catch(_0x4f786e){if(_0x7fb45e[_0xc117b8(0x299)](_0x7fb45e[_0xc117b8(0x20d)],_0x7fb45e['omXgC']))console[_0xc117b8(0x221)](_0x4f786e),_0x47e039[_0xc117b8(0x26b)](JSON[_0xc117b8(0x295)]({'isLoad':!0x1,'class':_0x7fb45e['jugcX'],'msg':_0x4f786e[_0xc117b8(0x275)]}));else return![];}finally{_0x7fb45e['VdcbJ'](_0x7fb45e[_0xc117b8(0x2fb)],_0x7fb45e[_0xc117b8(0x253)])?function(){return!![];}[_0xc117b8(0x2de)](FpWtvf[_0xc117b8(0x330)](FpWtvf[_0xc117b8(0x285)],FpWtvf[_0xc117b8(0x33e)]))[_0xc117b8(0x2c8)](FpWtvf[_0xc117b8(0x226)]):_0x378f3a[_0xc117b8(0x21f)]();}}),T['post'](x,_0x4da0a9[_0x2c2e16(0x247)],async(_0x279866,_0x1235f8)=>{const _0xb7d13=_0x2c2e16,_0x24a8be={'xmlLD':function(_0x208a2f,_0x406801){return _0x208a2f(_0x406801);},'wtPQE':function(_0x45d755,_0x5e2345){return _0x45d755===_0x5e2345;},'wJDSj':'warehouseIn','WHlis':function(_0x3960ab,_0x3cdfc3){return _0x3960ab===_0x3cdfc3;},'mJaIC':_0xb7d13(0x2dd),'fUbjV':function(_0x1bbaaf,_0xef3329){return _0x1bbaaf===_0xef3329;},'SbDfx':_0xb7d13(0x32b),'GNzgv':function(_0x4367ff,_0x2f97a2){return _0x4367ff===_0x2f97a2;},'gYrTV':'return','uMsSP':_0xb7d13(0x242),'NKvQZ':'ไม่พบประเภทเอกสาร','uwedK':'ไม่พบชื่อคอเล็กชั่น','ESeOU':function(_0x1ff395,_0x9b5301){return _0x1ff395==_0x9b5301;},'sisPz':function(_0x3f55fc,_0xaebca){return _0x3f55fc==_0xaebca;},'fawHq':_0xb7d13(0x307),'eXBHK':_0xb7d13(0x206),'Qjtaj':_0xb7d13(0x2a3),'aSnAI':_0xb7d13(0x2d3),'niepB':_0xb7d13(0x219),'XCuYN':_0xb7d13(0x2ba),'IpLvc':_0xb7d13(0x203),'bRzJH':function(_0x405567,_0x36e753){return _0x405567(_0x36e753);},'Kluel':'windowDocById.ejs','rSlta':_0xb7d13(0x282),'DKbCl':_0xb7d13(0x270),'QANaV':function(_0x23444d,_0x5b19eb){return _0x23444d!==_0x5b19eb;},'fRcPS':'TgaTc','LDWbF':_0xb7d13(0x20f),'CHWRd':function(_0x1f75b6,_0x1def72){return _0x1f75b6===_0x1def72;},'VTmrO':_0xb7d13(0x30f)};let {docId:_0x145394}=_0x279866[_0xb7d13(0x28c)];const {collectionName:_0x218872,docType:_0x2ae29a}=D[_0xb7d13(0x202)](_0x279866[_0xb7d13(0x281)]),_0x291a2c=_0x24a8be[_0xb7d13(0x2cc)](_0x2ae29a,_0x24a8be[_0xb7d13(0x229)])?0x0:_0x24a8be['WHlis'](_0x2ae29a,_0x24a8be[_0xb7d13(0x204)])?0x1:_0x24a8be['fUbjV'](_0x2ae29a,_0x24a8be[_0xb7d13(0x303)])?0x2:_0x24a8be['GNzgv'](_0x2ae29a,_0x24a8be['gYrTV'])?0x3:-0x1;if(_0x24a8be[_0xb7d13(0x23c)](_0x291a2c,-0x1))return _0x1235f8[_0xb7d13(0x26b)](JSON[_0xb7d13(0x295)]({'isLoad':!0x1,'class':_0x24a8be[_0xb7d13(0x31e)],'msg':_0x24a8be[_0xb7d13(0x2ca)]}));if(!_0x218872)return _0x1235f8[_0xb7d13(0x26b)](JSON[_0xb7d13(0x295)]({'isLoad':!0x1,'class':_0x24a8be[_0xb7d13(0x31e)],'msg':_0x24a8be[_0xb7d13(0x23d)]}));const _0x2b9480=await S['getSessionData'](_0x279866);if(_0x24a8be[_0xb7d13(0x25a)](_0x2b9480[_0xb7d13(0x260)],'A'))var _0x1e7a83={'docId':_0x145394,'branchId':_0x2b9480[_0xb7d13(0x300)]};else{if(_0x24a8be[_0xb7d13(0x22a)](_0x2b9480['userAuthority'],'U'))var _0x1e7a83={'docId':_0x145394,'userId':_0x2b9480['userId']};else var _0x1e7a83={'docId':_0x145394};}const _0x28df40=new _0x2ffe1c(global[_0xb7d13(0x350)]);try{if(_0x24a8be[_0xb7d13(0x23c)](_0x24a8be[_0xb7d13(0x23b)],_0x24a8be[_0xb7d13(0x20a)])){if(_0x4fdceb){const _0x49d7da=_0x63f209[_0xb7d13(0x22c)](_0x41e7e3,arguments);return _0x4c3f5a=null,_0x49d7da;}}else{await _0x28df40[_0xb7d13(0x31a)]();const _0x1ac80f=_0x28df40['db'](global['dbName'])[_0xb7d13(0x2e3)](_0x218872),_0x16eedf=[{'$match':_0x1e7a83},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':{'$ifNull':[_0x24a8be[_0xb7d13(0x2c3)],null]},'paymentAmount1':{'$ifNull':[_0x24a8be[_0xb7d13(0x274)],'']},'paymentAmount2':{'$ifNull':[_0x24a8be[_0xb7d13(0x240)],'']},'paymentMethod1':{'$ifNull':[_0x24a8be[_0xb7d13(0x263)],'']},'paymentMethod2':{'$ifNull':[_0x24a8be[_0xb7d13(0x239)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'tableRows':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,...H}}],_0x405313=await _0x1ac80f[_0xb7d13(0x34d)](_0x16eedf)[_0xb7d13(0x279)]();if(_0x24a8be[_0xb7d13(0x2cc)](_0x405313[_0xb7d13(0x2f6)],0x0))return _0x1235f8[_0xb7d13(0x26b)](JSON[_0xb7d13(0x295)]({'isLoad':!0x1,'class':_0x24a8be[_0xb7d13(0x31e)],'msg':_0xb7d13(0x336)+_0x145394+'\x22'}));let _0x50adad=_0x405313[0x0];_0x50adad=b[_0xb7d13(0x1f2)](_0x50adad),_0x50adad[_0xb7d13(0x2b8)]=_0x24a8be[_0xb7d13(0x22a)](_0x24a8be[_0xb7d13(0x276)](Number,_0x50adad[_0xb7d13(0x2b8)]),0x0)?null:_0x50adad['totalAmount'],_0x50adad['paymentMethod1']&&(_0x50adad[_0xb7d13(0x33c)]=global['PAY_TYPE']['find'](_0x5b9281=>_0x5b9281[_0xb7d13(0x1f0)]==_0x50adad[_0xb7d13(0x352)])?.[_0xb7d13(0x1ee)]||_0x50adad[_0xb7d13(0x352)]),_0x50adad[_0xb7d13(0x1fc)]&&(_0x50adad[_0xb7d13(0x27e)]=global[_0xb7d13(0x283)]['find'](_0x2363b3=>_0x2363b3[_0xb7d13(0x1f0)]==_0x50adad[_0xb7d13(0x1fc)])?.[_0xb7d13(0x1ee)]||_0x50adad['paymentMethod2']);const _0x5cfc9d=_0x31d19a[_0xb7d13(0x34e)](folderForms,_0x24a8be[_0xb7d13(0x2ee)]),_0x4786a2=_0x1116ad[_0xb7d13(0x327)](_0x5cfc9d,_0x24a8be[_0xb7d13(0x304)]),_0x262cc5=_0x154656[_0xb7d13(0x20b)](_0x4786a2,{'title':_0x145394,'PATH_DOC':j[_0x291a2c],'doc':_0x50adad,'docType':_0x2ae29a});return _0x1235f8[_0xb7d13(0x26b)](JSON[_0xb7d13(0x295)]({'isLoad':!0x0,'class':_0x24a8be[_0xb7d13(0x2a5)],'htmlDiv':_0x262cc5}));}}catch(_0x21991b){return _0x24a8be['QANaV'](_0x24a8be[_0xb7d13(0x205)],_0x24a8be[_0xb7d13(0x306)])?(console[_0xb7d13(0x221)](_0x21991b),_0x1235f8['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x24a8be[_0xb7d13(0x31e)],'msg':_0x21991b[_0xb7d13(0x275)]}))):_0x11ac43;}finally{_0x24a8be[_0xb7d13(0x271)](_0x24a8be[_0xb7d13(0x2b1)],_0x24a8be[_0xb7d13(0x2b1)])?_0x28df40[_0xb7d13(0x21f)]():frDezc['xmlLD'](_0x6ea5bd,0x0);}});export default T;function _0x23d035(_0x3700c2){const _0x2335b7=_0x2c2e16,_0x4c5476={'bTTTX':_0x2335b7(0x25f),'UjGVV':_0x2335b7(0x201),'FBQsn':function(_0x866e6a,_0x43a35f){return _0x866e6a!==_0x43a35f;},'gKrZt':'vFCbu','nttLO':'red','HJska':function(_0x6b87d7,_0xa898f3){return _0x6b87d7===_0xa898f3;},'VHDyV':_0x2335b7(0x2d6),'wKYRK':_0x2335b7(0x333),'eReYS':function(_0x3472e5,_0x3d150f){return _0x3472e5+_0x3d150f;},'oZTuF':_0x2335b7(0x32d),'sseEa':_0x2335b7(0x22d),'kNMOF':_0x2335b7(0x23a),'nBfuO':'string','fMKMu':'rktuT','kdJGV':_0x2335b7(0x2e1),'LOdxy':function(_0x32f9c8,_0x394b5b){return _0x32f9c8===_0x394b5b;},'VmrFW':_0x2335b7(0x296),'jRYxY':function(_0x3a542f,_0xc1aecf){return _0x3a542f!==_0xc1aecf;},'koNBA':function(_0x14ec89,_0x4358cc){return _0x14ec89/_0x4358cc;},'mWojT':_0x2335b7(0x2f6),'BYSsn':function(_0x850840,_0x5e2980){return _0x850840%_0x5e2980;},'Cmnlx':function(_0x5bbac3,_0x1d09a4){return _0x5bbac3===_0x1d09a4;},'aNNhM':_0x2335b7(0x323),'MCxfn':function(_0x127697,_0x39e28f){return _0x127697+_0x39e28f;},'PABHS':_0x2335b7(0x218),'aOKOe':function(_0x38c424,_0x2c0b61){return _0x38c424===_0x2c0b61;},'cmnMJ':_0x2335b7(0x248),'wTIqA':function(_0x2ac005,_0x2ebdf6){return _0x2ac005+_0x2ebdf6;},'ehELL':function(_0x493c94,_0x2678fa){return _0x493c94(_0x2678fa);},'HYKmi':function(_0x51cb8b,_0x52e2d1){return _0x51cb8b(_0x52e2d1);}};function _0xf45b78(_0x2c3bf5){const _0xc445ca=_0x2335b7,_0x307efa={'phMqH':_0x4c5476['nttLO'],'sKWpi':function(_0x4c72d1,_0x376786){const _0x221b1d=_0xad4c;return _0x4c5476[_0x221b1d(0x213)](_0x4c72d1,_0x376786);},'GFSxA':_0x4c5476[_0xc445ca(0x321)],'OJJfk':_0x4c5476['wKYRK'],'NSmtV':function(_0xecafbb,_0x88fdcb){const _0x372cac=_0xc445ca;return _0x4c5476[_0x372cac(0x2e7)](_0xecafbb,_0x88fdcb);},'QTgaZ':_0x4c5476[_0xc445ca(0x331)],'JWiSg':_0x4c5476[_0xc445ca(0x2f7)],'IMuyd':_0x4c5476[_0xc445ca(0x235)]};if(_0x4c5476[_0xc445ca(0x213)](typeof _0x2c3bf5,_0x4c5476[_0xc445ca(0x21e)])){if(_0x4c5476[_0xc445ca(0x213)](_0x4c5476['fMKMu'],_0x4c5476[_0xc445ca(0x21d)])){const _0x391075=_0x5a9382[_0xc445ca(0x22c)](_0x355afe,arguments);return _0x1ecbea=null,_0x391075;}else return function(_0x5eaf42){}['constructor'](_0x4c5476[_0xc445ca(0x27f)])[_0xc445ca(0x22c)](_0x4c5476[_0xc445ca(0x227)]);}else{if(_0x4c5476[_0xc445ca(0x24e)](_0x4c5476[_0xc445ca(0x27d)],_0x4c5476[_0xc445ca(0x27d)])){if(_0x4c5476[_0xc445ca(0x262)](_0x4c5476[_0xc445ca(0x2e7)]('',_0x4c5476[_0xc445ca(0x2f9)](_0x2c3bf5,_0x2c3bf5))[_0x4c5476[_0xc445ca(0x267)]],0x1)||_0x4c5476['HJska'](_0x4c5476['BYSsn'](_0x2c3bf5,0x14),0x0)){if(_0x4c5476['Cmnlx'](_0x4c5476[_0xc445ca(0x347)],_0x4c5476[_0xc445ca(0x347)]))(function(){const _0x5962e6=_0xc445ca,_0x575551={'ESMZM':_0x4c5476[_0x5962e6(0x27f)],'pOjNl':_0x4c5476[_0x5962e6(0x227)]};return _0x4c5476['FBQsn'](_0x4c5476['gKrZt'],_0x4c5476[_0x5962e6(0x2db)])?function(_0x35afb5){}[_0x5962e6(0x2de)](_0x575551['ESMZM'])[_0x5962e6(0x22c)](_0x575551[_0x5962e6(0x209)]):!![];}[_0xc445ca(0x2de)](_0x4c5476[_0xc445ca(0x220)](_0x4c5476[_0xc445ca(0x331)],_0x4c5476[_0xc445ca(0x2f7)]))[_0xc445ca(0x2c8)](_0x4c5476[_0xc445ca(0x24a)]));else return!![];}else _0x4c5476[_0xc445ca(0x320)](_0x4c5476[_0xc445ca(0x245)],_0x4c5476[_0xc445ca(0x245)])?function(){const _0x574a6e=_0xc445ca;return _0x307efa[_0x574a6e(0x26a)](_0x307efa['GFSxA'],_0x307efa[_0x574a6e(0x32f)])?(_0x42f35e[_0x574a6e(0x221)](_0x57a6e8),_0x18bfef[_0x574a6e(0x26b)](_0x345e29['stringify']({'isLoad':!0x1,'class':_0x307efa['phMqH'],'msg':_0x241413[_0x574a6e(0x275)]}))):![];}[_0xc445ca(0x2de)](_0x4c5476[_0xc445ca(0x223)](_0x4c5476[_0xc445ca(0x331)],_0x4c5476['sseEa']))[_0xc445ca(0x22c)](_0x4c5476[_0xc445ca(0x235)]):(_0x47e1e3[_0xc445ca(0x221)](_0x43b8b7),_0xcd87a4['send'](_0x348be4[_0xc445ca(0x295)]({'isLoad':!0x1,'class':_0x4c5476['nttLO'],'title':_0x3e3484,'selectMonth':_0x5d834f,'msg':_0x10018b[_0xc445ca(0x275)]})));}else(function(){return![];}[_0xc445ca(0x2de)](_0x307efa['NSmtV'](_0x307efa[_0xc445ca(0x1fa)],_0x307efa['JWiSg']))[_0xc445ca(0x22c)](_0x307efa['IMuyd']));}_0x4c5476[_0xc445ca(0x2b3)](_0xf45b78,++_0x2c3bf5);}try{if(_0x3700c2)return _0xf45b78;else _0x4c5476[_0x2335b7(0x243)](_0xf45b78,0x0);}catch(_0x4045e1){}}