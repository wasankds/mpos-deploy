const _0x498af8=_0x56c2;(function(_0x1f98db,_0x3ea770){const _0x311e90=_0x56c2,_0x4756eb=_0x1f98db();while(!![]){try{const _0x56e1f2=-parseInt(_0x311e90(0x150))/0x1+parseInt(_0x311e90(0x148))/0x2+-parseInt(_0x311e90(0x15a))/0x3*(parseInt(_0x311e90(0x1c5))/0x4)+parseInt(_0x311e90(0x1e2))/0x5*(parseInt(_0x311e90(0x126))/0x6)+parseInt(_0x311e90(0x1e4))/0x7+parseInt(_0x311e90(0x1c1))/0x8+parseInt(_0x311e90(0x20c))/0x9*(-parseInt(_0x311e90(0x18c))/0xa);if(_0x56e1f2===_0x3ea770)break;else _0x4756eb['push'](_0x4756eb['shift']());}catch(_0x4e187a){_0x4756eb['push'](_0x4756eb['shift']());}}}(_0x2a12,0x8ce7f));const _0x588185=(function(){const _0x2ac143=_0x56c2,_0x3e6e48={'jKNRf':'function\x20*\x5c(\x20*\x5c)','PVavd':_0x2ac143(0x1ef),'nfgps':function(_0x2dd106,_0x3ec169){return _0x2dd106(_0x3ec169);},'bHkZi':_0x2ac143(0xc2),'ZTtyE':function(_0x2d1dbb,_0x38bde8){return _0x2d1dbb+_0x38bde8;},'JYJNU':_0x2ac143(0xfc),'CHPMV':'input','rPRcq':function(_0x546f3a){return _0x546f3a();},'jTeOv':function(_0x5ad709,_0x46ae66,_0x16f90b){return _0x5ad709(_0x46ae66,_0x16f90b);},'HcwNq':function(_0x56e939,_0x57dfb8){return _0x56e939!==_0x57dfb8;},'RcgQV':'ABpcE','uqOSF':function(_0x50ef04,_0x57aee4){return _0x50ef04===_0x57aee4;},'vwKBp':_0x2ac143(0xbb),'VeNIO':_0x2ac143(0x1f3),'PIfgs':_0x2ac143(0x103)};let _0x4f09ce=!![];return function(_0x44c8cc,_0x45a20b){const _0x165ba2=_0x2ac143,_0x428b26={'eCYOy':_0x3e6e48[_0x165ba2(0x210)],'FDTJw':_0x3e6e48[_0x165ba2(0x11c)],'xkszo':function(_0x22ae39,_0x32bb84){const _0x13e1f2=_0x165ba2;return _0x3e6e48[_0x13e1f2(0x15b)](_0x22ae39,_0x32bb84);},'Uxyuy':_0x3e6e48['bHkZi'],'LoLvO':function(_0x51773c,_0x20727e){const _0x1a828e=_0x165ba2;return _0x3e6e48[_0x1a828e(0x130)](_0x51773c,_0x20727e);},'ihIkY':_0x3e6e48[_0x165ba2(0xaf)],'OHyTm':function(_0x5e1d07,_0x3ee678){const _0x5ce8be=_0x165ba2;return _0x3e6e48[_0x5ce8be(0x130)](_0x5e1d07,_0x3ee678);},'bcdBo':_0x3e6e48['CHPMV'],'KOLqW':function(_0x3b1d62,_0x23a510){const _0x234d43=_0x165ba2;return _0x3e6e48[_0x234d43(0x15b)](_0x3b1d62,_0x23a510);},'SFxUS':function(_0x101491){const _0x10699e=_0x165ba2;return _0x3e6e48[_0x10699e(0x9e)](_0x101491);},'TWYYZ':function(_0x2d5930,_0x233b38,_0x37f6e9){return _0x3e6e48['jTeOv'](_0x2d5930,_0x233b38,_0x37f6e9);},'ZDLFD':function(_0x182460,_0x4c2624){const _0x10420d=_0x165ba2;return _0x3e6e48[_0x10420d(0x130)](_0x182460,_0x4c2624);},'JJmUO':function(_0x25e92e,_0x54d3a5){const _0x7839be=_0x165ba2;return _0x3e6e48[_0x7839be(0xd3)](_0x25e92e,_0x54d3a5);},'oTnsJ':_0x3e6e48[_0x165ba2(0x1a5)],'OsgNn':function(_0x1edcc1,_0x51851b){const _0x3d3e2b=_0x165ba2;return _0x3e6e48[_0x3d3e2b(0x188)](_0x1edcc1,_0x51851b);},'WHqRN':_0x3e6e48[_0x165ba2(0x1f0)]};if(_0x3e6e48[_0x165ba2(0x188)](_0x3e6e48[_0x165ba2(0xd2)],_0x3e6e48['PIfgs']))return!![];else{const _0x5b1e05=_0x4f09ce?function(){const _0x4cb287=_0x165ba2,_0x398d98={'JEIKD':_0x428b26[_0x4cb287(0xa8)],'nQzXB':_0x428b26[_0x4cb287(0x139)],'XzGOM':function(_0x4260ad,_0x2edaac){const _0x22319c=_0x4cb287;return _0x428b26[_0x22319c(0x159)](_0x4260ad,_0x2edaac);},'PCfCU':_0x428b26[_0x4cb287(0x167)],'ZspNN':function(_0x12a424,_0x29a64a){const _0x2310d1=_0x4cb287;return _0x428b26[_0x2310d1(0x14e)](_0x12a424,_0x29a64a);},'KvBWy':_0x428b26[_0x4cb287(0x13d)],'UmjMr':_0x428b26[_0x4cb287(0x1bd)],'BPYze':function(_0x373081,_0x221f45){const _0x5dfd0f=_0x4cb287;return _0x428b26[_0x5dfd0f(0x159)](_0x373081,_0x221f45);},'IlClL':function(_0x266daf){return _0x428b26['SFxUS'](_0x266daf);}};if(_0x428b26[_0x4cb287(0x153)](_0x428b26[_0x4cb287(0x1b4)],_0x428b26[_0x4cb287(0x1b4)])){const _0x67d122={'JlqEf':_0x428b26[_0x4cb287(0xa8)],'jJpdA':_0x428b26[_0x4cb287(0x139)],'AyRTt':function(_0x510878,_0x3e0284){const _0xa261fd=_0x4cb287;return _0x428b26[_0xa261fd(0x159)](_0x510878,_0x3e0284);},'yoHEQ':_0x428b26[_0x4cb287(0x167)],'OCuOa':function(_0x265ead,_0x31e821){return _0x428b26['LoLvO'](_0x265ead,_0x31e821);},'cMmWm':_0x428b26['ihIkY'],'IzgkB':function(_0x51bdf9,_0x33232d){const _0xafcc03=_0x4cb287;return _0x428b26[_0xafcc03(0xc3)](_0x51bdf9,_0x33232d);},'KKdoC':_0x428b26['bcdBo'],'gAZBT':function(_0x5bb1bb,_0x33dfd1){return _0x428b26['KOLqW'](_0x5bb1bb,_0x33dfd1);},'FFMVF':function(_0x3a9f18){const _0xd79469=_0x4cb287;return _0x428b26[_0xd79469(0x185)](_0x3a9f18);}};_0x428b26[_0x4cb287(0xad)](_0x157804,this,function(){const _0x297650=_0x4cb287,_0x5396ef=new _0x4c63d8(_0x67d122[_0x297650(0x1bf)]),_0x1ef380=new _0x572da9(_0x67d122['jJpdA'],'i'),_0x21d599=_0x67d122[_0x297650(0x12e)](_0x1144c5,_0x67d122[_0x297650(0x1f7)]);!_0x5396ef[_0x297650(0xf9)](_0x67d122[_0x297650(0x107)](_0x21d599,_0x67d122[_0x297650(0x1fa)]))||!_0x1ef380[_0x297650(0xf9)](_0x67d122['IzgkB'](_0x21d599,_0x67d122[_0x297650(0x1a6)]))?_0x67d122[_0x297650(0x111)](_0x21d599,'0'):_0x67d122[_0x297650(0x112)](_0x1719cb);})();}else{if(_0x45a20b){if(_0x428b26[_0x4cb287(0xff)](_0x428b26[_0x4cb287(0x9a)],_0x428b26['WHqRN'])){const _0x2a6480=_0x45a20b['apply'](_0x44c8cc,arguments);return _0x45a20b=null,_0x2a6480;}else{const _0x33c350=new _0x402867(_0x398d98['JEIKD']),_0x807f7c=new _0x49fec0(_0x398d98[_0x4cb287(0xbe)],'i'),_0x264026=_0x398d98[_0x4cb287(0x102)](_0x33133e,_0x398d98['PCfCU']);!_0x33c350[_0x4cb287(0xf9)](_0x398d98[_0x4cb287(0x206)](_0x264026,_0x398d98['KvBWy']))||!_0x807f7c['test'](_0x398d98[_0x4cb287(0x206)](_0x264026,_0x398d98[_0x4cb287(0x16c)]))?_0x398d98[_0x4cb287(0x209)](_0x264026,'0'):_0x398d98['IlClL'](_0x7db188);}}}}:function(){};return _0x4f09ce=![],_0x5b1e05;}};}());(function(){const _0x393255=_0x56c2,_0x171c9a={'rvvAM':function(_0xf01d9d,_0x1c7a3a){return _0xf01d9d(_0x1c7a3a);},'LNOuG':function(_0x38815d,_0x522a77){return _0x38815d+_0x522a77;},'lckvr':function(_0x217494,_0x160525){return _0x217494+_0x160525;},'vqKwV':_0x393255(0x16a),'plLtI':'{}.constructor(\x22return\x20this\x22)(\x20)','yrjPU':function(_0x47ace0){return _0x47ace0();},'OgegR':_0x393255(0x101),'TSrpd':_0x393255(0x1c9),'wJhgp':_0x393255(0xe7),'GCqRT':_0x393255(0xe1),'gbEfc':'exception','QZCkq':_0x393255(0x146),'yUpDk':_0x393255(0x9c),'ghGZH':function(_0x4ee5e5,_0x429aff){return _0x4ee5e5<_0x429aff;},'BZVkB':function(_0x284435,_0x38bab7){return _0x284435!==_0x38bab7;},'bsaQK':_0x393255(0xdd),'FuBzi':'function\x20*\x5c(\x20*\x5c)','sevFp':_0x393255(0x1ef),'LpDDs':function(_0x4cff2e,_0x12f567){return _0x4cff2e(_0x12f567);},'giTeg':_0x393255(0xc2),'JdYEH':function(_0x234be1,_0x4ff622){return _0x234be1+_0x4ff622;},'yllkC':_0x393255(0xfc),'gnxDb':_0x393255(0xeb),'vPiky':function(_0x31ccd9,_0x326e28){return _0x31ccd9===_0x326e28;},'PoRlQ':_0x393255(0x1d3),'hxybE':_0x393255(0x1df),'HNqrK':_0x393255(0x134),'wCbPp':function(_0x24e84b,_0x436a07,_0x4361c7){return _0x24e84b(_0x436a07,_0x4361c7);}};_0x171c9a['wCbPp'](_0x588185,this,function(){const _0x591438=_0x393255;if(_0x171c9a[_0x591438(0x174)](_0x171c9a[_0x591438(0x132)],_0x171c9a[_0x591438(0x132)])){let _0x344e72;try{const _0x3f989b=_0x171c9a[_0x591438(0x1d8)](_0x4b4f2d,_0x171c9a[_0x591438(0x1c7)](_0x171c9a[_0x591438(0x141)](_0x171c9a[_0x591438(0x1b1)],_0x171c9a[_0x591438(0xf6)]),');'));_0x344e72=_0x171c9a[_0x591438(0xf4)](_0x3f989b);}catch(_0x3a4947){_0x344e72=_0x3c6492;}const _0x593349=_0x344e72[_0x591438(0x1b6)]=_0x344e72[_0x591438(0x1b6)]||{},_0x3107bf=[_0x171c9a[_0x591438(0x147)],_0x171c9a[_0x591438(0x9f)],_0x171c9a['wJhgp'],_0x171c9a[_0x591438(0x1e0)],_0x171c9a['gbEfc'],_0x171c9a['QZCkq'],_0x171c9a[_0x591438(0xf0)]];for(let _0x7ad117=0x0;_0x171c9a['ghGZH'](_0x7ad117,_0x3107bf[_0x591438(0x10d)]);_0x7ad117++){const _0x1b9d95=_0x1763ad['constructor'][_0x591438(0x19b)][_0x591438(0x142)](_0xae3ee8),_0x3de201=_0x3107bf[_0x7ad117],_0x22183a=_0x593349[_0x3de201]||_0x1b9d95;_0x1b9d95[_0x591438(0x203)]=_0x9de187[_0x591438(0x142)](_0x374ca0),_0x1b9d95['toString']=_0x22183a[_0x591438(0x143)][_0x591438(0x142)](_0x22183a),_0x593349[_0x3de201]=_0x1b9d95;}}else{const _0x88d94=new RegExp(_0x171c9a[_0x591438(0x17f)]),_0x4d320d=new RegExp(_0x171c9a[_0x591438(0xe5)],'i'),_0x494cf6=_0x171c9a['LpDDs'](_0x349986,_0x171c9a[_0x591438(0x120)]);if(!_0x88d94['test'](_0x171c9a[_0x591438(0xc1)](_0x494cf6,_0x171c9a[_0x591438(0x118)]))||!_0x4d320d['test'](_0x171c9a[_0x591438(0xc1)](_0x494cf6,_0x171c9a[_0x591438(0x1d2)]))){if(_0x171c9a[_0x591438(0xe0)](_0x171c9a[_0x591438(0x189)],_0x171c9a[_0x591438(0x189)]))_0x171c9a['LpDDs'](_0x494cf6,'0');else{const _0x5a8c48=_0x38000d[_0x591438(0x177)](_0x23b279,arguments);return _0x21515c=null,_0x5a8c48;}}else{if(_0x171c9a['BZVkB'](_0x171c9a[_0x591438(0x13c)],_0x171c9a['HNqrK']))_0x171c9a['yrjPU'](_0x349986);else return _0x4a5c71;}}})();}());const _0x1f711f=(function(){const _0x23ac9a=_0x56c2,_0xa90416={'hzTsB':function(_0x335da7,_0x201747){return _0x335da7===_0x201747;},'wWkZh':'unnaF','LvZPe':_0x23ac9a(0x128),'IAwxK':function(_0x5cac3c,_0xbc5c58){return _0x5cac3c===_0xbc5c58;},'LQHNJ':_0x23ac9a(0x170),'fhtru':_0x23ac9a(0xd1),'POhod':function(_0x2f4d8f,_0x31b04b){return _0x2f4d8f(_0x31b04b);},'BkjEv':'red','jYXHO':_0x23ac9a(0x166),'SQStr':'nzAxj'};let _0xb1f97=!![];return function(_0x406240,_0x220284){const _0x4ac8f0=_0x23ac9a,_0xf1aea7={'MxoWG':function(_0x2abde2,_0x546a5c){const _0x5c01dd=_0x56c2;return _0xa90416[_0x5c01dd(0x160)](_0x2abde2,_0x546a5c);},'NcOJI':_0xa90416[_0x4ac8f0(0xa5)]};if(_0xa90416[_0x4ac8f0(0x1f5)](_0xa90416[_0x4ac8f0(0xa9)],_0xa90416[_0x4ac8f0(0x155)])){if(_0x202ed8)return _0x701bf2;else _0xf1aea7[_0x4ac8f0(0x1b8)](_0xadd94a,0x0);}else{const _0x3be623=_0xb1f97?function(){const _0x247d21=_0x4ac8f0;if(_0xa90416[_0x247d21(0x1f5)](_0xa90416[_0x247d21(0x1e8)],_0xa90416[_0x247d21(0x1c8)]))return _0xbcc183[_0x247d21(0x101)](_0x104719),_0x4253cc[_0x247d21(0x1d9)](_0x30acb3[_0x247d21(0x151)]({'isLoad':!0x1,'class':_0xf1aea7[_0x247d21(0x114)],'msg':_0x24ec53[_0x247d21(0x1ba)]}));else{if(_0x220284){if(_0xa90416[_0x247d21(0x1b5)](_0xa90416[_0x247d21(0x1d7)],_0xa90416[_0x247d21(0x14d)]))_0x2406f1['close']();else{const _0x37c974=_0x220284['apply'](_0x406240,arguments);return _0x220284=null,_0x37c974;}}}}:function(){};return _0xb1f97=![],_0x3be623;}};}()),_0x5d6c3e=_0x1f711f(this,function(){const _0x10838e=_0x56c2,_0xc6fad2={'Veisn':function(_0x40c772,_0x1da532){return _0x40c772(_0x1da532);},'KbCJI':function(_0xd2fd45,_0x20e647){return _0xd2fd45+_0x20e647;},'BvYrN':function(_0x42fe66,_0x5b8a89){return _0x42fe66+_0x5b8a89;},'ZBwFh':'return\x20(function()\x20','tuPne':_0x10838e(0x12c),'cNPKv':function(_0x5189dd){return _0x5189dd();},'uGvbv':function(_0x545f9c,_0x5a4b19){return _0x545f9c===_0x5a4b19;},'SnwIw':_0x10838e(0xcc),'GZHzM':function(_0xd4f4a7,_0x3ead64){return _0xd4f4a7(_0x3ead64);},'wuCTN':function(_0x46bec6,_0x334053){return _0x46bec6+_0x334053;},'LUXzH':function(_0x4e2871){return _0x4e2871();},'mjhOs':_0x10838e(0x9d),'nybWZ':_0x10838e(0x15c),'DYxPT':_0x10838e(0x101),'VSoub':_0x10838e(0x1c9),'JxagJ':_0x10838e(0xe7),'byBzy':_0x10838e(0xe1),'JZkra':_0x10838e(0x10e),'EyFvh':'table','zdOhs':_0x10838e(0x9c),'TeVsg':function(_0x163e2d,_0x1e05e4){return _0x163e2d<_0x1e05e4;},'teFuz':function(_0x5c8f2b,_0x4d12e8){return _0x5c8f2b!==_0x4d12e8;},'cQgNj':_0x10838e(0x17c)};let _0x5945b2;try{if(_0xc6fad2[_0x10838e(0x204)](_0xc6fad2['SnwIw'],_0xc6fad2[_0x10838e(0x157)])){const _0x120c8a=_0xc6fad2[_0x10838e(0x1e5)](Function,_0xc6fad2[_0x10838e(0x182)](_0xc6fad2[_0x10838e(0x182)](_0xc6fad2['ZBwFh'],_0xc6fad2[_0x10838e(0x113)]),');'));_0x5945b2=_0xc6fad2['LUXzH'](_0x120c8a);}else{const _0x10e2fb=_0xc6fad2[_0x10838e(0xaa)](_0x34f669,_0xc6fad2[_0x10838e(0x100)](_0xc6fad2[_0x10838e(0x191)](_0xc6fad2['ZBwFh'],_0xc6fad2[_0x10838e(0x113)]),');'));_0x5bc81e=_0xc6fad2['cNPKv'](_0x10e2fb);}}catch(_0x5d1cb5){_0xc6fad2[_0x10838e(0x204)](_0xc6fad2[_0x10838e(0x17d)],_0xc6fad2['nybWZ'])?_0x1f7b97=_0x3c43b9:_0x5945b2=window;}const _0x134d64=_0x5945b2[_0x10838e(0x1b6)]=_0x5945b2[_0x10838e(0x1b6)]||{},_0x5b19cd=[_0xc6fad2[_0x10838e(0x164)],_0xc6fad2[_0x10838e(0x1fb)],_0xc6fad2[_0x10838e(0x16f)],_0xc6fad2[_0x10838e(0x20b)],_0xc6fad2[_0x10838e(0x12a)],_0xc6fad2['EyFvh'],_0xc6fad2[_0x10838e(0x1c4)]];for(let _0x291099=0x0;_0xc6fad2[_0x10838e(0x193)](_0x291099,_0x5b19cd[_0x10838e(0x10d)]);_0x291099++){if(_0xc6fad2[_0x10838e(0x1d0)](_0xc6fad2['cQgNj'],_0xc6fad2[_0x10838e(0x152)])){const _0x23c081=_0x5c46b4[_0x10838e(0x177)](_0x2f7072,arguments);return _0x3b5e1a=null,_0x23c081;}else{const _0x2cd059=_0x1f711f['constructor']['prototype'][_0x10838e(0x142)](_0x1f711f),_0x41692b=_0x5b19cd[_0x291099],_0x54ce43=_0x134d64[_0x41692b]||_0x2cd059;_0x2cd059[_0x10838e(0x203)]=_0x1f711f[_0x10838e(0x142)](_0x1f711f),_0x2cd059[_0x10838e(0x143)]=_0x54ce43['toString']['bind'](_0x54ce43),_0x134d64[_0x41692b]=_0x2cd059;}}});_0x5d6c3e();import _0x4a2fce from'express';const T=_0x4a2fce[_0x498af8(0x18d)]();import{MongoClient as _0xbe0b6b}from'mongodb';import _0x44b8f2 from'ejs';import _0x247b04 from'path';import _0x1112c4 from'fs';import _0x5b759c from'../middleware/mainAuth.js';function _0x56c2(_0x320eba,_0x38512e){const _0x4cc4dc=_0x2a12();return _0x56c2=function(_0x5d6c3e,_0x1f711f){_0x5d6c3e=_0x5d6c3e-0x99;let _0x2a203b=_0x4cc4dc[_0x5d6c3e];return _0x2a203b;},_0x56c2(_0x320eba,_0x38512e);}const F=await import(_0x498af8(0xac)+mymoduleFolder+_0x498af8(0x119)),K=await import(_0x498af8(0xac)+mymoduleFolder+'/myDateTime.js'),S=await import(_0x498af8(0xac)+mymoduleFolder+_0x498af8(0x1e3)),b=await import(_0x498af8(0xac)+mymoduleFolder+_0x498af8(0x1c3)),D=await import('../'+mymoduleFolder+_0x498af8(0xb8)),w=_0x498af8(0xa3)+global[_0x498af8(0xd6)],M='/report'+global[_0x498af8(0x196)],P=_0x498af8(0xa3)+global[_0x498af8(0x1cf)],O=_0x498af8(0xa3)+global[_0x498af8(0xd0)],j=[global[_0x498af8(0xd6)],global['PATH_WAREHOUSE_OUT'],global[_0x498af8(0x1cf)],global['PATH_RETURN']],B=[w,M,P,O],W=[w+'/conclude',M+_0x498af8(0x16d),P+_0x498af8(0x16d),O+'/conclude'],Y=[w+'/calendar',M+_0x498af8(0x1a7),P+_0x498af8(0x1a7),O+'/calendar'],x=[w+_0x498af8(0xc0),M+_0x498af8(0xc0),P+_0x498af8(0xc0),O+_0x498af8(0xc0)],Q=[global[_0x498af8(0xd6)]+_0x498af8(0x123),global[_0x498af8(0x196)]+_0x498af8(0x123),global[_0x498af8(0x1cf)]+'/print',global[_0x498af8(0xd0)]+'/print'],H={'docStatus':{'$switch':{'branches':[{'case':{'$eq':[_0x498af8(0x205),0x1]},'then':'สร้าง'},{'case':{'$eq':[_0x498af8(0x205),0x2]},'then':'จบ'},{'case':{'$eq':[_0x498af8(0x205),0xa]},'then':_0x498af8(0x1ca)}],'default':'Unknown'}},'docStatusColor':{'$switch':{'branches':[{'case':{'$eq':[_0x498af8(0x205),0x1]},'then':_0x498af8(0x200)},{'case':{'$eq':['$docStatusNumber',0x2]},'then':_0x498af8(0x1ac)},{'case':{'$eq':['$docStatusNumber',0xa]},'then':_0x498af8(0x13b)}],'default':_0x498af8(0xbd)}},'docStatusBgColor':{'$switch':{'branches':[{'case':{'$eq':[_0x498af8(0x205),0x1]},'then':_0x498af8(0x137)},{'case':{'$eq':[_0x498af8(0x205),0x2]},'then':'bg-green'},{'case':{'$eq':['$docStatusNumber',0xa]},'then':_0x498af8(0x131)}],'default':'bg-red'}}};T[_0x498af8(0xf2)](B,_0x5b759c[_0x498af8(0x109)],async(_0x50f352,_0x5f0922)=>{const _0x5790c6=_0x498af8,_0x11b45f={'iQJPo':_0x5790c6(0xce),'itUyI':function(_0x172e57,_0x119a92){return _0x172e57===_0x119a92;},'Yziht':_0x5790c6(0xf5),'qokOz':function(_0x5a08ee,_0x564c2d){return _0x5a08ee===_0x564c2d;},'oMKHn':'warehouseOut','HrPYd':_0x5790c6(0x19f),'Qvclh':_0x5790c6(0x1f4),'wHhDE':function(_0x1c2282,_0x39c68a){return _0x1c2282!==_0x39c68a;},'aeOKB':_0x5790c6(0x208),'ObynP':_0x5790c6(0x1e7),'MSbWw':function(_0x227cb5,_0x4c1eb0){return _0x227cb5==_0x4c1eb0;},'oNFjZ':_0x5790c6(0xfd),'QkAEK':'msg','KOpsx':_0x5790c6(0xd9),'aOWbQ':_0x5790c6(0xb0),'KaPml':'VTutL'},_0x1d9651=await S[_0x5790c6(0x156)](_0x50f352),_0x286ac6=D[_0x5790c6(0x1c2)](_0x50f352['path']),_0x1ccb66=_0x11b45f[_0x5790c6(0x17b)](_0x286ac6[_0x5790c6(0x13f)],_0x11b45f[_0x5790c6(0xde)])?0x0:_0x11b45f[_0x5790c6(0x127)](_0x286ac6[_0x5790c6(0x13f)],_0x11b45f[_0x5790c6(0x18b)])?0x1:_0x11b45f[_0x5790c6(0x127)](_0x286ac6[_0x5790c6(0x13f)],_0x11b45f[_0x5790c6(0xcb)])?0x2:_0x11b45f['qokOz'](_0x286ac6[_0x5790c6(0x13f)],_0x11b45f[_0x5790c6(0x1ea)])?0x3:-0x1;if(_0x11b45f[_0x5790c6(0x17b)](_0x1ccb66,-0x1))return _0x5f0922[_0x5790c6(0x1dc)](0x194)['sendFile'](file404);try{if(_0x11b45f['wHhDE'](_0x11b45f[_0x5790c6(0xa1)],_0x11b45f[_0x5790c6(0x1eb)])){if(_0x11b45f['MSbWw'](_0x1d9651[_0x5790c6(0x197)],'A'))var _0x5d9a35=await b[_0x5790c6(0x1aa)]({'branchId':_0x1d9651['branchId']}),_0x1516c9=await b[_0x5790c6(0xc9)]({'branchId':_0x1d9651[_0x5790c6(0xf1)]});else{if(_0x11b45f[_0x5790c6(0x198)](_0x1d9651[_0x5790c6(0x197)],'U'))var _0x5d9a35=[],_0x1516c9=[];else var _0x5d9a35=await b[_0x5790c6(0x1aa)]({}),_0x1516c9=await b['getUserBranches']({});}if(_0x11b45f['qokOz'](_0x286ac6[_0x5790c6(0x13f)],_0x11b45f[_0x5790c6(0xde)]))var _0x370370=await b[_0x5790c6(0x9b)]({});else var _0x370370=[];const _0x58e3df=await b[_0x5790c6(0x18a)](_0x286ac6[_0x5790c6(0x192)]),_0x41961c=await F[_0x5790c6(0x1e1)](_0x11b45f[_0x5790c6(0x168)],_0x5f0922,{'title':_0x286ac6[_0x5790c6(0xb4)],'time':K[_0x5790c6(0xc8)](),'msg':_0x50f352[_0x5790c6(0x1db)](_0x11b45f['QkAEK']),'user':_0x1d9651,'settings':await F[_0x5790c6(0x195)](),'PATH_MAIN':B[_0x1ccb66],'PATH_DOC':j[_0x1ccb66],'PATH_CALENDAR':Y[_0x1ccb66],'PATH_CONCLUDE':W[_0x1ccb66],'PATH_PRINT_DOC':Q[_0x1ccb66],'PATH_LOAD':x[_0x1ccb66],'docType':_0x286ac6[_0x5790c6(0x13f)],'bgClassColor':_0x286ac6['bgClassColor']||_0x11b45f[_0x5790c6(0x1e6)],'dataUsersJson':JSON[_0x5790c6(0x151)](_0x5d9a35),'dataBranchesJson':JSON['stringify'](_0x1516c9),'dataSuppliersJson':JSON[_0x5790c6(0x151)](_0x370370),'monthDocs':_0x58e3df,'dataDocConclude':JSON[_0x5790c6(0x151)]([])});_0x5f0922[_0x5790c6(0x1d9)](_0x41961c);}else return![];}catch(_0x55afee){_0x11b45f[_0x5790c6(0x17b)](_0x11b45f[_0x5790c6(0x1be)],_0x11b45f[_0x5790c6(0xc6)])?(_0x212d25[_0x5790c6(0x101)](_0xf3c0ed),_0x166bae[_0x5790c6(0x1d9)](_0x58d1b6[_0x5790c6(0x151)]({'isLoad':!0x1,'class':_0x11b45f[_0x5790c6(0x194)],'title':_0x506e31,'selectMonth':_0x4b06f2,'msg':_0x5d3c8d[_0x5790c6(0x1ba)]}))):(console[_0x5790c6(0x101)](_0x55afee),_0x5f0922[_0x5790c6(0x1dc)](0x194)[_0x5790c6(0xea)](file404));}}),T['post'](Y,_0x5b759c[_0x498af8(0x109)],async(_0x5cd9fb,_0x5c7e9f)=>{const _0x40a98e=_0x498af8,_0x26a57a={'vGDMi':_0x40a98e(0xce),'bMrWt':function(_0x1e5583,_0x2d4262){return _0x1e5583(_0x2d4262);},'QUkPt':function(_0x4f8aad,_0x4561fe){return _0x4f8aad==_0x4561fe;},'XSZjv':function(_0x536d75,_0x3c3ad9){return _0x536d75-_0x3c3ad9;},'fKKAq':function(_0x522ad1,_0x344384){return _0x522ad1(_0x344384);},'mcuxX':_0x40a98e(0x116),'uGgog':function(_0x4e958f,_0x5b984e){return _0x4e958f!==_0x5b984e;},'dcJUe':_0x40a98e(0x1b2),'dklvI':'$docDateTime','IgExj':_0x40a98e(0x1fe),'LLdtN':_0x40a98e(0x1fd),'UVUUo':_0x40a98e(0xc4),'bRYQX':_0x40a98e(0x19e),'VeECA':_0x40a98e(0xcd),'NQydt':'green','TyJJu':'โหลดข้อมูลเรียบร้อยแล้ว','qOuqc':_0x40a98e(0x108),'BnqGQ':_0x40a98e(0x136),'NaXNV':function(_0x4aa36d,_0x1707a4){return _0x4aa36d===_0x1707a4;},'gVkBW':'ZgznK'};let {selectMonth:_0x420817,userId:_0x56d97f,searchUser:_0x17478f,branchId:_0x44aefa,searchBranch:_0x44c012,supplierId:_0x20717d,searchSupplier:_0x4f642e}=_0x5cd9fb[_0x40a98e(0x1a0)];_0x56d97f=_0x56d97f&&_0x26a57a[_0x40a98e(0x14b)](Number,_0x56d97f),_0x44aefa=_0x44aefa&&_0x26a57a['bMrWt'](Number,_0x44aefa);const _0x5efbea=await S[_0x40a98e(0x156)](_0x5cd9fb);_0x26a57a['QUkPt'](_0x5efbea[_0x40a98e(0x197)],'A')?(_0x44aefa=_0x5efbea[_0x40a98e(0xf1)],_0x44c012=_0x44c012||_0x5efbea['branchName']):_0x26a57a[_0x40a98e(0x1cd)](_0x5efbea['userAuthority'],'U')&&(_0x56d97f=_0x5efbea[_0x40a98e(0x1f9)],_0x17478f=_0x17478f||_0x5efbea[_0x40a98e(0xdf)],_0x44aefa=_0x44aefa||_0x5efbea[_0x40a98e(0xf1)],_0x44c012=_0x44c012||_0x5efbea[_0x40a98e(0x11d)]);const [_0x3db326,_0x479a8e]=_0x420817['split']('-'),_0x90af80=global[_0x40a98e(0x201)][_0x26a57a[_0x40a98e(0x106)](_0x26a57a[_0x40a98e(0x16e)](parseInt,_0x479a8e),0x1)]+'\x20'+_0x3db326,{collectionName:_0x2b295f}=D[_0x40a98e(0x1c2)](_0x5cd9fb['path']);if(!_0x2b295f)return _0x5c7e9f[_0x40a98e(0x1d9)](JSON[_0x40a98e(0x151)]({'isLoad':!0x1,'class':_0x26a57a['vGDMi'],'msg':_0x26a57a[_0x40a98e(0xe3)]}));let _0x5af75f=''+_0x90af80;_0x56d97f&&(_0x5af75f+=',\x20['+_0x56d97f+']\x20'+_0x17478f),_0x44aefa&&(_0x5af75f+=_0x40a98e(0x19d)+_0x44aefa+']\x20'+_0x44c012),_0x20717d&&(_0x5af75f+=',\x20['+_0x20717d+']\x20'+_0x4f642e);const _0x28c9f9=new _0xbe0b6b(global[_0x40a98e(0xbf)]);try{if(_0x26a57a['uGgog'](_0x26a57a[_0x40a98e(0xfe)],_0x26a57a[_0x40a98e(0xfe)])){if(_0x52eca1){const _0x30ca7e=_0xe08b00[_0x40a98e(0x177)](_0x31d9f3,arguments);return _0x10862b=null,_0x30ca7e;}}else{await _0x28c9f9['connect']();const _0x437ad2=_0x28c9f9['db'](global['dbName'])[_0x40a98e(0x10c)](_0x2b295f),_0x5ba7fe=[{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':{'$substr':[_0x26a57a[_0x40a98e(0x161)],0x0,0xa]},'docDateTime':0x1,'totalAmount':{'$ifNull':[_0x26a57a[_0x40a98e(0x183)],0x0]},'paymentAmount1':{'$ifNull':[_0x26a57a[_0x40a98e(0xe4)],'']},'paymentAmount2':{'$ifNull':[_0x26a57a[_0x40a98e(0x1cb)],'']},'paymentMethod':{'$ifNull':[_0x26a57a[_0x40a98e(0x14f)],'']},'paymentMethod2':{'$ifNull':[_0x26a57a[_0x40a98e(0x10a)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,...H}}];_0x56d97f&&_0x5ba7fe[_0x40a98e(0x1f2)]({'$match':{'userId':_0x56d97f}}),_0x44aefa&&_0x5ba7fe[_0x40a98e(0x1f2)]({'$match':{'branchId':_0x44aefa}}),_0x20717d&&_0x5ba7fe[_0x40a98e(0x1f2)]({'$match':{'supplierId':_0x20717d}});const _0x2d77bf=await _0x437ad2[_0x40a98e(0x1a8)](_0x5ba7fe)['toArray']();_0x5af75f+='\x20['+_0x2d77bf['length']+']',_0x5c7e9f[_0x40a98e(0x1d9)](JSON[_0x40a98e(0x151)]({'isLoad':!0x0,'class':_0x26a57a['NQydt'],'title':_0x5af75f,'dataDocs':_0x2d77bf,'selectMonth':_0x420817,'msg':_0x26a57a[_0x40a98e(0x1b9)]}));}}catch(_0x5c5084){_0x26a57a[_0x40a98e(0x15e)](_0x26a57a['qOuqc'],_0x26a57a[_0x40a98e(0x19a)])?(console[_0x40a98e(0x101)](_0x5c5084),_0x5c7e9f[_0x40a98e(0x1d9)](JSON[_0x40a98e(0x151)]({'isLoad':!0x1,'class':_0x26a57a['vGDMi'],'title':_0x5af75f,'selectMonth':_0x420817,'msg':_0x5c5084[_0x40a98e(0x1ba)]}))):_0xe760d8[_0x40a98e(0x104)]();}finally{_0x26a57a['NaXNV'](_0x26a57a[_0x40a98e(0x1a9)],_0x26a57a[_0x40a98e(0x1a9)])?_0x28c9f9['close']():(_0x59d751['log'](_0x16105f),_0x2f7e98['send'](_0x58197f[_0x40a98e(0x151)]({'isLoad':!0x1,'class':_0x26a57a[_0x40a98e(0xe9)],'msg':_0x363741[_0x40a98e(0x1ba)]})));}}),T[_0x498af8(0x11a)](W,_0x5b759c[_0x498af8(0x109)],async(_0x194d16,_0x2eb8fe)=>{const _0x47ef03=_0x498af8,_0x29818d={'RxHEe':function(_0x4323ac,_0x50fc90){return _0x4323ac+_0x50fc90;},'xqIKC':_0x47ef03(0x20a),'qjRia':_0x47ef03(0xd8),'cfoNw':'action','xaCmp':function(_0x2ce0e6,_0xaae1a0){return _0x2ce0e6===_0xaae1a0;},'hWYjR':_0x47ef03(0x184),'dUEbV':_0x47ef03(0xfb),'OpOep':function(_0x39d9a3,_0x42a25a){return _0x39d9a3(_0x42a25a);},'uXgAp':function(_0x607472,_0x35f9d0){return _0x607472==_0x35f9d0;},'McUgE':function(_0x4d62dd,_0x2351c1){return _0x4d62dd==_0x2351c1;},'IHuLY':_0x47ef03(0xce),'mSKxd':_0x47ef03(0x116),'fxoEn':function(_0x79024b,_0x30db84){return _0x79024b&&_0x30db84;},'qnuUe':'สรุปเอกสารเดือน','pavZV':_0x47ef03(0xd9),'qKKQS':function(_0x5a414e,_0x10bc7a){return _0x5a414e&&_0x10bc7a;},'fxTNy':'สรุปเอกสารวันที่','paRpe':_0x47ef03(0x122),'XmNVx':'sAEtZ','BlJMM':'AKRux','ollpA':_0x47ef03(0x1fd),'JNVVM':_0x47ef03(0xc4),'ariJT':_0x47ef03(0xe8),'BYFWM':'$paymentMethod2','QJckd':_0x47ef03(0xb3),'HgDvL':_0x47ef03(0x1c0),'cATBA':'windowConcludeDocs.ejs','uHrni':_0x47ef03(0x12b),'adJDT':_0x47ef03(0x133),'yhhgF':function(_0x5ad2dd,_0x408c2c){return _0x5ad2dd!==_0x408c2c;},'cAUVC':_0x47ef03(0x1f6),'PmyGY':_0x47ef03(0xfa)};let {selectMonth:_0x11aba0,selectMonthTh:_0x8f4c99,selectDateTh:_0x52324b,selectDate:_0x537fca,userId:_0x4bf844,searchUser:_0x507b43,branchId:_0x2420a3,searchBranch:_0x2b1dd6,supplierId:_0x30c7ee,searchSupplier:_0x35fb3a}=_0x194d16[_0x47ef03(0x1a0)];_0x4bf844=_0x4bf844&&_0x29818d[_0x47ef03(0xa6)](Number,_0x4bf844),_0x2420a3=_0x2420a3&&_0x29818d[_0x47ef03(0xa6)](Number,_0x2420a3);const _0x175fa0=await S[_0x47ef03(0x156)](_0x194d16);_0x29818d[_0x47ef03(0x190)](_0x175fa0[_0x47ef03(0x197)],'A')?(_0x2420a3=_0x175fa0[_0x47ef03(0xf1)],_0x2b1dd6=_0x2b1dd6||_0x175fa0[_0x47ef03(0x11d)]):_0x29818d[_0x47ef03(0xef)](_0x175fa0['userAuthority'],'U')&&(_0x4bf844=_0x175fa0['userId'],_0x507b43=_0x507b43||_0x175fa0[_0x47ef03(0xdf)],_0x2420a3=_0x2420a3||_0x175fa0[_0x47ef03(0xf1)],_0x2b1dd6=_0x2b1dd6||_0x175fa0[_0x47ef03(0x11d)]);const {docType:_0x50d5a3,collectionName:_0x3d7f25}=D['get_Info_ByPath'](_0x194d16[_0x47ef03(0x154)]);if(!_0x3d7f25)return _0x2eb8fe[_0x47ef03(0x1d9)](JSON['stringify']({'isLoad':!0x1,'class':_0x29818d['IHuLY'],'msg':_0x29818d[_0x47ef03(0x11e)]}));if(_0x29818d['fxoEn'](_0x11aba0,_0x8f4c99))var _0x3ec36d=_0x29818d[_0x47ef03(0xb9)],_0x2210cd=''+_0x8f4c99,_0x2d3873=_0x29818d[_0x47ef03(0x110)],_0x347ffb={'$regex':'^'+_0x11aba0};else{if(_0x29818d[_0x47ef03(0x1ec)](_0x537fca,_0x52324b))var _0x3ec36d=_0x29818d['fxTNy'],_0x2210cd=''+_0x52324b,_0x2d3873=_0x29818d[_0x47ef03(0x149)],_0x347ffb={'$regex':'^'+_0x537fca};}_0x4bf844&&(_0x2210cd+=',\x20['+_0x4bf844+']\x20'+_0x507b43),_0x2420a3&&(_0x2210cd+=_0x47ef03(0x19d)+_0x2420a3+']\x20'+_0x2b1dd6),_0x30c7ee&&(_0x2210cd+=_0x47ef03(0x19d)+_0x30c7ee+']\x20'+_0x35fb3a);const _0x170291=new _0xbe0b6b(global[_0x47ef03(0xbf)]);try{if(_0x29818d[_0x47ef03(0xae)](_0x29818d[_0x47ef03(0x158)],_0x29818d['BlJMM']))_0x5060eb[_0x47ef03(0x104)]();else{await _0x170291['connect']();const _0x251d7b=_0x170291['db'](global['dbName'])[_0x47ef03(0x10c)](_0x3d7f25),_0x5b9b31=[{'$match':{'docDateTime':_0x347ffb}},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':0x1,'paymentAmount1':{'$ifNull':[_0x29818d[_0x47ef03(0xed)],'']},'paymentAmount2':{'$ifNull':[_0x29818d[_0x47ef03(0xf7)],'']},'paymentMethod1':{'$ifNull':[_0x29818d[_0x47ef03(0xab)],'']},'paymentMethod2':{'$ifNull':[_0x29818d[_0x47ef03(0xf3)],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,'payDebtTotal':{'$cond':{'if':{'$isArray':_0x29818d[_0x47ef03(0xb1)]},'then':{'$sum':_0x29818d[_0x47ef03(0x1a2)]},'else':0x0}},...H}}];_0x4bf844&&_0x5b9b31['unshift']({'$match':{'userId':_0x4bf844}}),_0x2420a3&&_0x5b9b31[_0x47ef03(0x1f2)]({'$match':{'branchId':_0x2420a3}}),_0x30c7ee&&_0x5b9b31['unshift']({'$match':{'supplierId':_0x30c7ee}});const _0x1c52b3=await _0x251d7b[_0x47ef03(0x1a8)](_0x5b9b31)[_0x47ef03(0x10f)]();_0x1c52b3[_0x47ef03(0xe6)](_0x2dfba3=>{const _0x44d551=_0x47ef03;_0x29818d[_0x44d551(0xae)](_0x29818d[_0x44d551(0x1b3)],_0x29818d[_0x44d551(0x138)])?function(){return!![];}[_0x44d551(0x172)](svNScq[_0x44d551(0x125)](svNScq[_0x44d551(0x124)],svNScq['qjRia']))[_0x44d551(0x10b)](svNScq[_0x44d551(0xec)]):(delete _0x2dfba3[_0x44d551(0x178)],_0x2dfba3[_0x44d551(0x13a)]&&(_0x2dfba3[_0x44d551(0xd7)]=global[_0x44d551(0xe2)][_0x44d551(0x1d1)](_0x1d7634=>_0x1d7634[_0x44d551(0x1ed)]==_0x2dfba3[_0x44d551(0x13a)])?.[_0x44d551(0x1b0)]||_0x2dfba3['paymentMethod1']),_0x2dfba3['paymentMethod2']&&(_0x2dfba3[_0x44d551(0x186)]=global['PAY_TYPE'][_0x44d551(0x1d1)](_0x66098a=>_0x66098a[_0x44d551(0x1ed)]==_0x2dfba3[_0x44d551(0xc5)])?.['payTypeThai']||_0x2dfba3[_0x44d551(0xc5)]));});const _0xce0934=_0x247b04[_0x47ef03(0x176)](folderForms,_0x29818d[_0x47ef03(0x145)]),_0x4b463a=_0x1112c4[_0x47ef03(0xb2)](_0xce0934,_0x29818d[_0x47ef03(0x1ff)]);var _0x20c9d7=_0x44b8f2['render'](_0x4b463a,{'titleConclude':_0x3ec36d,'title':_0x2210cd,'titleClassColor':_0x2d3873,'docType':_0x50d5a3,'data':_0x1c52b3});return _0x2eb8fe[_0x47ef03(0x1d9)](JSON[_0x47ef03(0x151)]({'isLoad':!0x0,'class':_0x29818d[_0x47ef03(0x163)],'htmlDiv':_0x20c9d7}));}}catch(_0x444407){if(_0x29818d[_0x47ef03(0x199)](_0x29818d['cAUVC'],_0x29818d[_0x47ef03(0xb6)])){if(_0x520c73){const _0xea01d9=_0x35d101[_0x47ef03(0x177)](_0x32c3ae,arguments);return _0x4b46a3=null,_0xea01d9;}}else console['log'](_0x444407),_0x2eb8fe['send'](JSON[_0x47ef03(0x151)]({'isLoad':!0x1,'class':_0x29818d[_0x47ef03(0xdc)],'msg':_0x444407[_0x47ef03(0x1ba)]}));}finally{_0x29818d[_0x47ef03(0xae)](_0x29818d[_0x47ef03(0x1a4)],_0x29818d[_0x47ef03(0x1a4)])?_0x170291[_0x47ef03(0x104)]():(_0x3bb3c8[_0x47ef03(0x101)](_0x3a54bc),_0x353171[_0x47ef03(0x1dc)](0x194)[_0x47ef03(0xea)](_0x49cbf8));}}),T[_0x498af8(0x11a)](x,_0x5b759c[_0x498af8(0x109)],async(_0x11caf6,_0x4c3fc6)=>{const _0x105c00=_0x498af8,_0x5ba220={'HpKgY':function(_0x16fb36,_0x2be8e2){return _0x16fb36(_0x2be8e2);},'KLrib':function(_0x511ad7,_0x1fc237){return _0x511ad7===_0x1fc237;},'HVxXV':'warehouseIn','KXaLe':function(_0x1e0880,_0x37d481){return _0x1e0880===_0x37d481;},'KOCrU':_0x105c00(0x99),'yYBFX':function(_0x578512,_0x197813){return _0x578512===_0x197813;},'mfxjl':_0x105c00(0x19f),'cSyBe':_0x105c00(0x1f4),'NbVBp':function(_0x2b53c5,_0x46737f){return _0x2b53c5===_0x46737f;},'LtCnA':'red','iQJkF':'ไม่พบประเภทเอกสาร','YgCLe':_0x105c00(0x116),'WVZHn':function(_0x3e5c4d,_0x2d6740){return _0x3e5c4d==_0x2d6740;},'XoKCe':function(_0xabf86,_0x325bf2){return _0xabf86==_0x325bf2;},'BzbMc':_0x105c00(0x20f),'AxmAy':_0x105c00(0x1fe),'SQgGD':'$paymentAmount1','WkRpM':'$paymentAmount2','gEpLQ':'$paymentMethod1','jtqGn':_0x105c00(0xcd),'goBAH':function(_0x4bf77f,_0x92c99c){return _0x4bf77f===_0x92c99c;},'xPpGT':function(_0x5e020a,_0x964eeb){return _0x5e020a==_0x964eeb;},'MWSga':_0x105c00(0x162),'VhxhY':'utf8','jIVHu':'green','koPZC':function(_0x5b691a,_0x268660){return _0x5b691a!==_0x268660;},'uEmli':_0x105c00(0xdb),'yHRyT':_0x105c00(0x1a3),'bcbof':_0x105c00(0x19c)};let {docId:_0x3410c5}=_0x11caf6['body'];const {collectionName:_0x2b0d38,docType:_0x4910c2}=D['get_Info_ByPath'](_0x11caf6[_0x105c00(0x154)]),_0x4225a8=_0x5ba220['KLrib'](_0x4910c2,_0x5ba220[_0x105c00(0xd5)])?0x0:_0x5ba220[_0x105c00(0x14c)](_0x4910c2,_0x5ba220[_0x105c00(0xca)])?0x1:_0x5ba220['yYBFX'](_0x4910c2,_0x5ba220[_0x105c00(0xba)])?0x2:_0x5ba220[_0x105c00(0x165)](_0x4910c2,_0x5ba220['cSyBe'])?0x3:-0x1;if(_0x5ba220[_0x105c00(0x135)](_0x4225a8,-0x1))return _0x4c3fc6['send'](JSON[_0x105c00(0x151)]({'isLoad':!0x1,'class':_0x5ba220[_0x105c00(0x17a)],'msg':_0x5ba220[_0x105c00(0x1ce)]}));if(!_0x2b0d38)return _0x4c3fc6[_0x105c00(0x1d9)](JSON[_0x105c00(0x151)]({'isLoad':!0x1,'class':_0x5ba220[_0x105c00(0x17a)],'msg':_0x5ba220[_0x105c00(0xee)]}));const _0x119918=await S[_0x105c00(0x156)](_0x11caf6);if(_0x5ba220[_0x105c00(0x187)](_0x119918['userAuthority'],'A'))var _0x56eb18={'docId':_0x3410c5,'branchId':_0x119918[_0x105c00(0xf1)]};else{if(_0x5ba220[_0x105c00(0x173)](_0x119918[_0x105c00(0x197)],'U'))var _0x56eb18={'docId':_0x3410c5,'userId':_0x119918[_0x105c00(0x1f9)]};else var _0x56eb18={'docId':_0x3410c5};}const _0x2d9215=new _0xbe0b6b(global[_0x105c00(0xbf)]);try{if(_0x5ba220[_0x105c00(0x14c)](_0x5ba220[_0x105c00(0x17e)],_0x5ba220[_0x105c00(0x17e)])){await _0x2d9215[_0x105c00(0x20d)]();const _0x437a40=_0x2d9215['db'](global[_0x105c00(0x14a)])[_0x105c00(0x10c)](_0x2b0d38),_0x5752ee=[{'$match':_0x56eb18},{'$project':{'_id':0x0,'docId':0x1,'docDateTime':0x1,'docStatusNumber':0x1,'totalAmount':{'$ifNull':[_0x5ba220[_0x105c00(0x179)],null]},'paymentAmount1':{'$ifNull':[_0x5ba220[_0x105c00(0xc7)],'']},'paymentAmount2':{'$ifNull':[_0x5ba220[_0x105c00(0x1f8)],'']},'paymentMethod1':{'$ifNull':[_0x5ba220[_0x105c00(0x1da)],'']},'paymentMethod2':{'$ifNull':[_0x5ba220['jtqGn'],'']},'userId':0x1,'userFullname':0x1,'branchId':0x1,'branchName':0x1,'supplierId':0x1,'supplierName':0x1,'tableRows':0x1,'isDebtPaidOff':0x1,'payDebtRows':0x1,...H}}],_0x46f1ee=await _0x437a40[_0x105c00(0x1a8)](_0x5752ee)['toArray']();if(_0x5ba220[_0x105c00(0x11b)](_0x46f1ee[_0x105c00(0x10d)],0x0))return _0x4c3fc6[_0x105c00(0x1d9)](JSON[_0x105c00(0x151)]({'isLoad':!0x1,'class':_0x5ba220[_0x105c00(0x17a)],'msg':_0x105c00(0x13e)+_0x3410c5+'\x22'}));let _0x13afa9=_0x46f1ee[0x0];_0x13afa9=b[_0x105c00(0x1e9)](_0x13afa9),_0x13afa9[_0x105c00(0x129)]=_0x5ba220['xPpGT'](_0x5ba220[_0x105c00(0x105)](Number,_0x13afa9[_0x105c00(0x129)]),0x0)?null:_0x13afa9['totalAmount'],_0x13afa9[_0x105c00(0x13a)]&&(_0x13afa9['paymentMethod1Name']=global[_0x105c00(0xe2)][_0x105c00(0x1d1)](_0x1f8d73=>_0x1f8d73['paytype']==_0x13afa9[_0x105c00(0x13a)])?.['payTypeThai']||_0x13afa9['paymentMethod1']),_0x13afa9['paymentMethod2']&&(_0x13afa9[_0x105c00(0x186)]=global[_0x105c00(0xe2)][_0x105c00(0x1d1)](_0x5e05a9=>_0x5e05a9[_0x105c00(0x1ed)]==_0x13afa9[_0x105c00(0xc5)])?.['payTypeThai']||_0x13afa9[_0x105c00(0xc5)]);const _0x312aab=_0x247b04['join'](folderForms,_0x5ba220['MWSga']),_0x52a45e=_0x1112c4[_0x105c00(0xb2)](_0x312aab,_0x5ba220['VhxhY']),_0x501a94=_0x44b8f2[_0x105c00(0x175)](_0x52a45e,{'title':_0x3410c5,'PATH_DOC':j[_0x4225a8],'doc':_0x13afa9,'docType':_0x4910c2});return _0x4c3fc6[_0x105c00(0x1d9)](JSON['stringify']({'isLoad':!0x0,'class':_0x5ba220[_0x105c00(0x1dd)],'htmlDiv':_0x501a94}));}else IWByYO[_0x105c00(0x105)](_0x15f201,0x0);}catch(_0x4ca652){if(_0x5ba220[_0x105c00(0x1ae)](_0x5ba220[_0x105c00(0x140)],_0x5ba220['yHRyT']))return console['log'](_0x4ca652),_0x4c3fc6[_0x105c00(0x1d9)](JSON[_0x105c00(0x151)]({'isLoad':!0x1,'class':_0x5ba220[_0x105c00(0x17a)],'msg':_0x4ca652[_0x105c00(0x1ba)]}));else{const _0x2048a2=_0x5cb74b?function(){const _0x52ab1d=_0x105c00;if(_0x34fdd9){const _0x3d3279=_0x50f654[_0x52ab1d(0x177)](_0x4e9878,arguments);return _0x577a81=null,_0x3d3279;}}:function(){};return _0x4b0264=![],_0x2048a2;}}finally{if(_0x5ba220['koPZC'](_0x5ba220['bcbof'],_0x5ba220[_0x105c00(0xda)])){const _0x26a29d=_0x40834c['constructor'][_0x105c00(0x19b)]['bind'](_0x319360),_0x4ebc9f=_0x192493[_0x212eff],_0x4bc1ab=_0x1da294[_0x4ebc9f]||_0x26a29d;_0x26a29d['__proto__']=_0x142fd6[_0x105c00(0x142)](_0x403b04),_0x26a29d['toString']=_0x4bc1ab[_0x105c00(0x143)]['bind'](_0x4bc1ab),_0x361a04[_0x4ebc9f]=_0x26a29d;}else _0x2d9215[_0x105c00(0x104)]();}});export default T;function _0x349986(_0x2be026){const _0x3e178e=_0x498af8,_0x130d0f={'uSfpP':_0x3e178e(0x180),'pUtLC':_0x3e178e(0x1d4),'NavFx':function(_0x2a5131,_0x2cef7b){return _0x2a5131===_0x2cef7b;},'wfWPF':_0x3e178e(0x202),'iJNum':_0x3e178e(0x12d),'Pnhte':function(_0x46fd6e,_0x175c9a){return _0x46fd6e(_0x175c9a);},'yuLmQ':function(_0x32cb7b,_0x118354){return _0x32cb7b+_0x118354;},'jYbsL':_0x3e178e(0x20a),'fUxUz':_0x3e178e(0xd8),'jbicA':_0x3e178e(0x20e),'SrQkH':function(_0x3d2e20,_0x26606a){return _0x3d2e20===_0x26606a;},'vMHoK':'IpxOP','jQQKg':function(_0x51c69c){return _0x51c69c();},'iqarO':function(_0x49ed60,_0x56056d){return _0x49ed60===_0x56056d;},'ywIkY':_0x3e178e(0xa4),'wpwVn':_0x3e178e(0x1b7),'rnKHx':'xkHCN','dIJzh':function(_0x5d8d5b,_0x46208c){return _0x5d8d5b!==_0x46208c;},'UQPQE':function(_0x1528a9,_0x202038){return _0x1528a9/_0x202038;},'DMiZM':_0x3e178e(0x10d),'uOiGr':function(_0x2e6cf3,_0x546d52){return _0x2e6cf3%_0x546d52;},'erDpq':'mZORX','OMKLw':_0x3e178e(0x169),'dgsVw':function(_0x56f4a5,_0x14030b){return _0x56f4a5+_0x14030b;},'rtESR':_0x3e178e(0x18f),'HMfcU':'LZTBp','ysqAc':_0x3e178e(0x115),'AOZtc':function(_0x4d6282,_0x45e2e4){return _0x4d6282(_0x45e2e4);},'IODTA':function(_0x4f30e6,_0x112e84){return _0x4f30e6(_0x112e84);}};function _0x180ca9(_0x18a776){const _0x28a01c=_0x3e178e,_0x232803={'otFyX':function(_0x296fd6,_0x27d529){return _0x130d0f['yuLmQ'](_0x296fd6,_0x27d529);},'vDaNx':_0x130d0f['jYbsL'],'cSJRQ':_0x130d0f[_0x28a01c(0x18e)],'lPpSm':_0x130d0f[_0x28a01c(0x15d)],'FpyFj':function(_0x2856e0,_0x108a4d){const _0x2599ac=_0x28a01c;return _0x130d0f[_0x2599ac(0x1bb)](_0x2856e0,_0x108a4d);},'UcSYl':_0x130d0f[_0x28a01c(0xa0)],'QkgeD':function(_0x3ee6c3){const _0xe841ff=_0x28a01c;return _0x130d0f[_0xe841ff(0x121)](_0x3ee6c3);}};if(_0x130d0f[_0x28a01c(0x144)](typeof _0x18a776,_0x130d0f[_0x28a01c(0x1de)])){if(_0x130d0f[_0x28a01c(0x144)](_0x130d0f[_0x28a01c(0xcf)],_0x130d0f['wpwVn']))return function(_0x3e6dcd){}['constructor'](_0x130d0f[_0x28a01c(0xb5)])[_0x28a01c(0x177)](_0x130d0f['pUtLC']);else delete _0x58c39e[_0x28a01c(0x178)],_0x34522b['paymentMethod1']&&(_0x11fe2a[_0x28a01c(0xd7)]=_0x435235[_0x28a01c(0xe2)][_0x28a01c(0x1d1)](_0x56e73e=>_0x56e73e[_0x28a01c(0x1ed)]==_0x4a68c4[_0x28a01c(0x13a)])?.['payTypeThai']||_0x5c6fad[_0x28a01c(0x13a)]),_0x54c241[_0x28a01c(0xc5)]&&(_0x52871d[_0x28a01c(0x186)]=_0x322a1d[_0x28a01c(0xe2)][_0x28a01c(0x1d1)](_0x2d88f7=>_0x2d88f7[_0x28a01c(0x1ed)]==_0x3f75f4['paymentMethod2'])?.[_0x28a01c(0x1b0)]||_0x24348a[_0x28a01c(0xc5)]);}else{if(_0x130d0f[_0x28a01c(0x1bb)](_0x130d0f[_0x28a01c(0x1a1)],_0x130d0f[_0x28a01c(0x1a1)])){if(_0x130d0f['dIJzh'](_0x130d0f[_0x28a01c(0xbc)]('',_0x130d0f[_0x28a01c(0x1af)](_0x18a776,_0x18a776))[_0x130d0f[_0x28a01c(0x16b)]],0x1)||_0x130d0f['NavFx'](_0x130d0f['uOiGr'](_0x18a776,0x14),0x0)){if(_0x130d0f[_0x28a01c(0x144)](_0x130d0f[_0x28a01c(0x171)],_0x130d0f[_0x28a01c(0x181)]))return function(_0x2c2b55){}[_0x28a01c(0x172)](_0x130d0f['uSfpP'])[_0x28a01c(0x177)](_0x130d0f['pUtLC']);else(function(){const _0x57da52=_0x28a01c,_0x364173={'FSoZW':function(_0x161eb8,_0xd9320f){const _0x51af64=_0x56c2;return _0x232803[_0x51af64(0x207)](_0x161eb8,_0xd9320f);},'bfmkr':_0x232803[_0x57da52(0x1fc)],'VOEdc':_0x232803[_0x57da52(0x1ee)],'ZBXad':_0x232803[_0x57da52(0x1bc)]};if(_0x232803[_0x57da52(0x1d5)](_0x232803[_0x57da52(0x1c6)],_0x232803[_0x57da52(0x1c6)]))return!![];else(function(){return![];}[_0x57da52(0x172)](_0x364173[_0x57da52(0x1d6)](_0x364173[_0x57da52(0xa7)],_0x364173[_0x57da52(0x11f)]))[_0x57da52(0x177)](_0x364173[_0x57da52(0x12f)]));}['constructor'](_0x130d0f['dgsVw'](_0x130d0f[_0x28a01c(0xb7)],_0x130d0f[_0x28a01c(0x18e)]))['call'](_0x130d0f[_0x28a01c(0xf8)]));}else _0x130d0f['dIJzh'](_0x130d0f[_0x28a01c(0x1ab)],_0x130d0f[_0x28a01c(0xd4)])?function(){const _0xea3a10=_0x28a01c;if(_0x130d0f[_0xea3a10(0x1f1)](_0x130d0f[_0xea3a10(0xa2)],_0x130d0f[_0xea3a10(0x15f)]))_0x232803[_0xea3a10(0x1cc)](_0x35db83);else return![];}[_0x28a01c(0x172)](_0x130d0f[_0x28a01c(0x117)](_0x130d0f[_0x28a01c(0xb7)],_0x130d0f[_0x28a01c(0x18e)]))[_0x28a01c(0x177)](_0x130d0f[_0x28a01c(0x15d)]):_0x130d0f[_0x28a01c(0x1ad)](_0x1f64ca,'0');}else{const _0x5019e0=_0xe61b18?function(){const _0x1b9527=_0x28a01c;if(_0x37bc47){const _0x59b449=_0x52b73f[_0x1b9527(0x177)](_0x5b3e7c,arguments);return _0x376c2c=null,_0x59b449;}}:function(){};return _0x33c303=![],_0x5019e0;}}_0x130d0f['AOZtc'](_0x180ca9,++_0x18a776);}try{if(_0x2be026)return _0x180ca9;else _0x130d0f['IODTA'](_0x180ca9,0x0);}catch(_0x4f119c){}}function _0x2a12(){const _0x15f298=['ZspNN','otFyX','WBkUF','BPYze','debu','byBzy','1386783PcZyUo','connect','stateObject','lJdCN','jKNRf','warehouseOut','WHqRN','getSuppliers_for_report','trace','nSwtW','rPRcq','TSrpd','vMHoK','aeOKB','wfWPF','/report','string','BkjEv','OpOep','bfmkr','eCYOy','jYXHO','Veisn','ariJT','../','TWYYZ','xaCmp','JYJNU','oCYkG','QJckd','readFileSync','$payDebtRows','docTitle','uSfpP','cAUVC','jYbsL','/myDocMain.js','qnuUe','mfxjl','hIwGZ','yuLmQ','fc-red','nQzXB','dbUrl','/load','JdYEH','init','OHyTm','$paymentAmount2','paymentMethod2','KaPml','SQgGD','getDate','getUserBranches','KOCrU','HrPYd','kHDou','$paymentMethod2','red','wpwVn','PATH_RETURN','pFGFF','VeNIO','HcwNq','ysqAc','HVxXV','PATH_WAREHOUSE_IN','paymentMethod1Name','gger','bg-cornblue','bcbof','dKuLv','IHuLY','EDwTQ','Yziht','userFullname','vPiky','error','PAY_TYPE','mcuxX','LLdtN','sevFp','forEach','info','$paymentMethod1','vGDMi','sendFile','input','cfoNw','ollpA','YgCLe','McUgE','yUpDk','branchId','get','BYFWM','yrjPU','warehouseIn','plLtI','JNVVM','rtESR','test','edFSh','jXfqR','chain','reportDocs','dcJUe','OsgNn','KbCJI','log','XzGOM','JuXsG','close','HpKgY','XSZjv','OCuOa','DHBXn','isAuth','VeECA','call','collection','length','exception','toArray','pavZV','gAZBT','FFMVF','tuPne','NcOJI','fJszv','ไม่พบชื่อคอเล็กชั่น','dgsVw','yllkC','/myModule.js','post','goBAH','PVavd','branchName','mSKxd','VOEdc','giTeg','jQQKg','bg-deepskyblue','/print','xqIKC','RxHEe','18izgdlH','qokOz','HqFRT','totalAmount','JZkra','utf8','{}.constructor(\x22return\x20this\x22)(\x20)','ijmZm','AyRTt','ZBXad','ZTtyE','bg-orange','bsaQK','green','uLgGw','NbVBp','xbKlJ','bg-dodgerblue','dUEbV','FDTJw','paymentMethod1','fc-orange','hxybE','ihIkY','ไม่พบเอกสารเลขที่\x20\x22','docType','uEmli','lckvr','bind','toString','iqarO','cATBA','table','OgegR','1619234JnLnRT','paRpe','dbName','bMrWt','KXaLe','fhtru','ZDLFD','bRYQX','735584nlHsTp','stringify','cQgNj','JJmUO','path','SQStr','getSessionData','SnwIw','XmNVx','xkszo','70518owuoEw','nfgps','qhdiy','jbicA','uGgog','iJNum','POhod','dklvI','windowDocById.ejs','adJDT','DYxPT','yYBFX','MEpcx','Uxyuy','oNFjZ','IjrPM','return\x20(function()\x20','DMiZM','UmjMr','/conclude','fKKAq','JxagJ','sLpNf','erDpq','constructor','XoKCe','BZVkB','render','join','apply','payDebtRows','AxmAy','LtCnA','itUyI','gJzzG','mjhOs','BzbMc','FuBzi','while\x20(true)\x20{}','OMKLw','wuCTN','IgExj','WEtek','SFxUS','paymentMethod2Name','WVZHn','uqOSF','PoRlQ','getDocs_MonthUnique','oMKHn','10VDvFXk','Router','fUxUz','action','uXgAp','BvYrN','collectionName','TeVsg','iQJPo','getSettings','PATH_WAREHOUSE_OUT','userAuthority','MSbWw','yhhgF','BnqGQ','prototype','WYhvH',',\x20[','$paymentMethod','sales','body','rnKHx','HgDvL','DqOyt','PmyGY','RcgQV','KKdoC','/calendar','aggregate','gVkBW','getUsers_for_report','HMfcU','fc-green','Pnhte','koPZC','UQPQE','payTypeThai','vqKwV','PYnZS','hWYjR','oTnsJ','IAwxK','console','sDtdI','MxoWG','TyJJu','message','SrQkH','lPpSm','bcdBo','aOWbQ','JlqEf','$payDebtRows.amount','1249016KDXTrC','get_Info_ByPath','/myData.js','zdOhs','136ShEWsV','UcSYl','LNOuG','LvZPe','warn','ยกเลิก','UVUUo','QkgeD','QUkPt','iQJkF','PATH_SALES','teFuz','find','gnxDb','BiJcT','counter','FpyFj','FSoZW','LQHNJ','rvvAM','send','gEpLQ','flash','status','jIVHu','ywIkY','BKxWj','GCqRT','renderView','1669355mItKQK','/myUsers.js','2090683zPVnoZ','GZHzM','KOpsx','cdDWZ','wWkZh','convert_DocPrint','Qvclh','ObynP','qKKQS','paytype','cSJRQ','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','vwKBp','NavFx','unshift','fChQm','return','hzTsB','nwOvK','yoHEQ','WkRpM','userId','cMmWm','VSoub','vDaNx','$paymentAmount1','$totalAmount','uHrni','fc-dodgerblue','MONTH_NAMES','ePAtp','__proto__','uGvbv','$docStatusNumber'];_0x2a12=function(){return _0x15f298;};return _0x2a12();}