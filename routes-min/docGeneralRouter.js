const _0x27a8a8=_0x3c23;(function(_0x197e8a,_0x4b35c9){const _0x41e561=_0x3c23,_0x24e74f=_0x197e8a();while(!![]){try{const _0x5814f8=-parseInt(_0x41e561(0x170))/0x1*(parseInt(_0x41e561(0x10c))/0x2)+parseInt(_0x41e561(0xd1))/0x3*(parseInt(_0x41e561(0x1b0))/0x4)+-parseInt(_0x41e561(0x11a))/0x5*(parseInt(_0x41e561(0x23f))/0x6)+parseInt(_0x41e561(0x254))/0x7*(-parseInt(_0x41e561(0x163))/0x8)+-parseInt(_0x41e561(0x127))/0x9*(-parseInt(_0x41e561(0x187))/0xa)+parseInt(_0x41e561(0x133))/0xb*(parseInt(_0x41e561(0xc8))/0xc)+-parseInt(_0x41e561(0x118))/0xd;if(_0x5814f8===_0x4b35c9)break;else _0x24e74f['push'](_0x24e74f['shift']());}catch(_0x4026aa){_0x24e74f['push'](_0x24e74f['shift']());}}}(_0x35ab,0x8b4b2));const _0x5e0c2c=(function(){const _0x4f993a=_0x3c23,_0x4d0cca={'cNGfp':function(_0x4e4d45,_0x3df296){return _0x4e4d45(_0x3df296);},'iSkCH':function(_0x4ce3a6,_0x24e0b8){return _0x4ce3a6!==_0x24e0b8;},'xWSaC':'ymVUZ','pZvUO':_0x4f993a(0x12e),'XbkDV':_0x4f993a(0x1d2),'PpwuA':function(_0x1580ce,_0x47ffa2){return _0x1580ce===_0x47ffa2;},'ffySh':'FAQMG','cjfgZ':_0x4f993a(0x216)};let _0x411529=!![];return function(_0x1fc0bf,_0x19de75){const _0x91b5c7=_0x4f993a,_0x3e6a9e={'QIgks':function(_0xbaf243,_0x420cfa){return _0x4d0cca['cNGfp'](_0xbaf243,_0x420cfa);},'Ddjoh':function(_0x53eb48,_0x1655eb){const _0xdbd372=_0x3c23;return _0x4d0cca[_0xdbd372(0xef)](_0x53eb48,_0x1655eb);},'xZKUH':_0x4d0cca[_0x91b5c7(0x11f)],'aujMd':_0x4d0cca['pZvUO'],'PypOH':function(_0x3c0988,_0x558fe1){return _0x4d0cca['iSkCH'](_0x3c0988,_0x558fe1);},'GbqNN':_0x4d0cca[_0x91b5c7(0x1e3)]};if(_0x4d0cca[_0x91b5c7(0x213)](_0x4d0cca[_0x91b5c7(0x1fb)],_0x4d0cca['cjfgZ'])){if(_0x2e984b)return _0x27d704;else _0x3e6a9e[_0x91b5c7(0x1a9)](_0x5f1518,0x0);}else{const _0x20f4ed=_0x411529?function(){const _0x4cfef8=_0x91b5c7;if(_0x3e6a9e[_0x4cfef8(0x1a6)](_0x3e6a9e[_0x4cfef8(0x16b)],_0x3e6a9e[_0x4cfef8(0xfd)])){if(_0x19de75){if(_0x3e6a9e['PypOH'](_0x3e6a9e[_0x4cfef8(0x23b)],_0x3e6a9e[_0x4cfef8(0x23b)])){const _0x429a49=_0x52e69d[_0x4cfef8(0x142)](_0x2585fe,arguments);return _0x1594e1=null,_0x429a49;}else{const _0x304292=_0x19de75[_0x4cfef8(0x142)](_0x1fc0bf,arguments);return _0x19de75=null,_0x304292;}}}else{const _0x55e4a6=_0x5e45b2[_0x4cfef8(0x19f)],_0x46d999=_0x3ea964['documentElement'];return _0x4ffa70['max'](_0x55e4a6[_0x4cfef8(0x129)],_0x55e4a6[_0x4cfef8(0x1b7)],_0x46d999['clientHeight'],_0x46d999[_0x4cfef8(0x129)],_0x46d999[_0x4cfef8(0x1b7)]);}}:function(){};return _0x411529=![],_0x20f4ed;}};}());(function(){const _0x4871b5=_0x3c23,_0x147d9a={'XsssX':_0x4871b5(0x21d),'EXiXw':function(_0x372e87,_0x23356c){return _0x372e87+_0x23356c;},'vLeBC':_0x4871b5(0x251),'oCglk':_0x4871b5(0x205),'HpAEF':_0x4871b5(0x19b),'vtCUC':function(_0x317bb4,_0x26cb88){return _0x317bb4!==_0x26cb88;},'adEWv':'uxDAN','RCvsg':'ixNre','dVuIp':_0x4871b5(0x184),'aedMP':_0x4871b5(0xea),'neuRe':function(_0xb415d0,_0x4f466e){return _0xb415d0(_0x4f466e);},'nupja':_0x4871b5(0x166),'RkqSV':_0x4871b5(0x1e4),'exJgj':function(_0x47d354,_0x4ce237){return _0x47d354+_0x4ce237;},'KAdkc':_0x4871b5(0x214),'DWlKU':function(_0x5e192f,_0x26c52c){return _0x5e192f===_0x26c52c;},'XLsgU':_0x4871b5(0x25b),'NFfya':_0x4871b5(0xf3),'gnTfD':function(_0x4218f8,_0xbed8ec){return _0x4218f8===_0xbed8ec;},'xLRBq':_0x4871b5(0x1d5),'JkHDU':_0x4871b5(0x1dd),'unBFB':function(_0x118327){return _0x118327();},'QLpEN':function(_0x1da1bc,_0x64bc69,_0xbb435c){return _0x1da1bc(_0x64bc69,_0xbb435c);}};_0x147d9a[_0x4871b5(0x186)](_0x5e0c2c,this,function(){const _0x18c10b=_0x4871b5,_0xb88219={'nzYHF':_0x147d9a[_0x18c10b(0x194)],'pvtAj':function(_0x4256f2,_0x48022f){const _0x518b8c=_0x18c10b;return _0x147d9a[_0x518b8c(0x1f9)](_0x4256f2,_0x48022f);},'rUmlv':_0x147d9a[_0x18c10b(0x111)],'zdxCl':_0x147d9a[_0x18c10b(0x122)],'mgEmK':_0x147d9a['HpAEF']};if(_0x147d9a[_0x18c10b(0x1e7)](_0x147d9a['adEWv'],_0x147d9a[_0x18c10b(0xf1)])){const _0x4a932d=new RegExp(_0x147d9a['dVuIp']),_0x307c99=new RegExp(_0x147d9a[_0x18c10b(0x246)],'i'),_0x738a7f=_0x147d9a[_0x18c10b(0xd5)](_0x293afc,_0x147d9a[_0x18c10b(0x1fa)]);if(!_0x4a932d[_0x18c10b(0x151)](_0x147d9a[_0x18c10b(0x1f9)](_0x738a7f,_0x147d9a[_0x18c10b(0x258)]))||!_0x307c99['test'](_0x147d9a[_0x18c10b(0x245)](_0x738a7f,_0x147d9a[_0x18c10b(0x1a3)]))){if(_0x147d9a['DWlKU'](_0x147d9a[_0x18c10b(0x224)],_0x147d9a[_0x18c10b(0x1d1)]))return _0x1b36d7[_0x18c10b(0x219)](_0x106477),_0x3e1f94[_0x18c10b(0x13f)](_0x2b787d[_0x18c10b(0x102)]({'isLoad':!0x1,'class':_0xb88219[_0x18c10b(0x168)],'msg':_0x4cd82d['message']}));else _0x147d9a[_0x18c10b(0xd5)](_0x738a7f,'0');}else{if(_0x147d9a['gnTfD'](_0x147d9a[_0x18c10b(0xe8)],_0x147d9a[_0x18c10b(0xe5)])){const _0x4c04ab=_0x3c9acf?function(){if(_0x479e6f){const _0x5cec55=_0xa37c58['apply'](_0x5f755c,arguments);return _0x415a30=null,_0x5cec55;}}:function(){};return _0x5c4421=![],_0x4c04ab;}else _0x147d9a[_0x18c10b(0x147)](_0x293afc);}}else(function(){return!![];}[_0x18c10b(0x15c)](_0xb88219[_0x18c10b(0xd7)](_0xb88219[_0x18c10b(0x1cb)],_0xb88219[_0x18c10b(0x207)]))[_0x18c10b(0x229)](_0xb88219[_0x18c10b(0xe2)]));})();}());function _0x3c23(_0x2e2808,_0x591524){const _0x3f102d=_0x35ab();return _0x3c23=function(_0x281322,_0x540239){_0x281322=_0x281322-0xc4;let _0x1c8900=_0x3f102d[_0x281322];return _0x1c8900;},_0x3c23(_0x2e2808,_0x591524);}const _0x540239=(function(){const _0x51559e=_0x3c23,_0x53315a={'JNvRk':function(_0x5b9bfa,_0x5d1de5){return _0x5b9bfa(_0x5d1de5);},'WnpBV':function(_0x36cd18,_0x4df9da){return _0x36cd18!==_0x4df9da;},'EkfYx':_0x51559e(0xf4),'ExqbP':function(_0x481e7f,_0x400fb8){return _0x481e7f===_0x400fb8;},'eIzPq':'rPZCv','pvbkE':_0x51559e(0x126),'lsAUm':function(_0x57fde4,_0x57960f){return _0x57fde4!==_0x57960f;},'prgGf':_0x51559e(0x1c4),'cPsvn':_0x51559e(0x17e)};let _0x592b82=!![];return function(_0x46d973,_0x793bbd){const _0x547555=_0x51559e,_0x402534={'CNqby':function(_0x581e43,_0x41db1e){return _0x53315a['JNvRk'](_0x581e43,_0x41db1e);},'TRYqw':function(_0x1f8d78,_0x7c40fd){const _0x2910a9=_0x3c23;return _0x53315a[_0x2910a9(0x1f0)](_0x1f8d78,_0x7c40fd);},'hLJkK':_0x53315a[_0x547555(0x193)],'OoDAg':function(_0x1b6145,_0x299a6a){return _0x53315a['ExqbP'](_0x1b6145,_0x299a6a);},'znBWo':_0x53315a[_0x547555(0xc9)],'MSNkq':_0x53315a[_0x547555(0x1ff)]};if(_0x53315a[_0x547555(0xd9)](_0x53315a[_0x547555(0x11c)],_0x53315a[_0x547555(0x12a)])){const _0x3601e1=_0x592b82?function(){const _0x2ab863=_0x547555,_0x27ebdf={'OBqXj':function(_0xb6314b,_0xbf43c5){const _0x164058=_0x3c23;return _0x402534[_0x164058(0xe3)](_0xb6314b,_0xbf43c5);}};if(_0x402534[_0x2ab863(0x14a)](_0x402534[_0x2ab863(0x21b)],_0x402534[_0x2ab863(0x21b)]))_0x27ebdf['OBqXj'](_0x4800ec,'0');else{if(_0x793bbd){if(_0x402534[_0x2ab863(0x17f)](_0x402534[_0x2ab863(0x230)],_0x402534[_0x2ab863(0x13c)]))return!![];else{const _0xd66ad2=_0x793bbd[_0x2ab863(0x142)](_0x46d973,arguments);return _0x793bbd=null,_0xd66ad2;}}}}:function(){};return _0x592b82=![],_0x3601e1;}else _0x362f6d[_0x547555(0x198)]();};}()),_0x281322=_0x540239(this,function(){const _0x905929=_0x3c23,_0x412b1e={'VtWoS':function(_0x49e0b5,_0x25a1b1){return _0x49e0b5(_0x25a1b1);},'ubFtp':function(_0x27e019,_0x3ba82a){return _0x27e019+_0x3ba82a;},'NadVp':function(_0x2f33f4,_0x574f65){return _0x2f33f4+_0x574f65;},'IDsme':_0x905929(0x176),'HVGvZ':_0x905929(0x10b),'UZbCE':function(_0x2f6e21){return _0x2f6e21();},'lJrUn':_0x905929(0x219),'OLuCt':'warn','qESib':_0x905929(0xff),'ACWDJ':_0x905929(0x1f2),'xRNoW':_0x905929(0x1d7),'MEzsK':_0x905929(0xc4),'nAgQj':_0x905929(0x1f6),'lvyNt':function(_0x213da4,_0x4ea466){return _0x213da4<_0x4ea466;},'bDbiD':'function\x20*\x5c(\x20*\x5c)','pqftT':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ULFff':_0x905929(0x166),'nYxpj':_0x905929(0x1e4),'FyXtr':_0x905929(0x214),'KhJsK':function(_0x17b350,_0x31264f,_0x3e054b){return _0x17b350(_0x31264f,_0x3e054b);},'gqoEF':function(_0x37e285,_0x5088dd){return _0x37e285!==_0x5088dd;},'FhcwY':_0x905929(0x107),'QKJbK':function(_0x2720eb,_0x52a289){return _0x2720eb+_0x52a289;},'YaXmQ':function(_0x3a48ab,_0x3a086f){return _0x3a48ab===_0x3a086f;},'uzqgo':'kXQPd','yVZhY':function(_0x5c2bfc,_0x31ddbe){return _0x5c2bfc!==_0x31ddbe;},'IZnaw':_0x905929(0x172)};let _0x2588aa;try{if(_0x412b1e[_0x905929(0x1cf)](_0x412b1e[_0x905929(0x1e8)],_0x412b1e[_0x905929(0x1e8)])){let _0x14fe98;try{const _0x1f8a8d=_0x412b1e[_0x905929(0x1e9)](_0x31ed4f,_0x412b1e[_0x905929(0xd2)](_0x412b1e[_0x905929(0x1f4)](_0x412b1e['IDsme'],_0x412b1e[_0x905929(0x13a)]),');'));_0x14fe98=_0x412b1e[_0x905929(0x20c)](_0x1f8a8d);}catch(_0x119487){_0x14fe98=_0x44c0f8;}const _0x3a2c90=_0x14fe98[_0x905929(0x24e)]=_0x14fe98['console']||{},_0x477772=[_0x412b1e[_0x905929(0x152)],_0x412b1e[_0x905929(0x195)],_0x412b1e[_0x905929(0x212)],_0x412b1e[_0x905929(0x24a)],_0x412b1e['xRNoW'],_0x412b1e[_0x905929(0x10f)],_0x412b1e[_0x905929(0x18d)]];for(let _0x3b99f8=0x0;_0x412b1e[_0x905929(0x137)](_0x3b99f8,_0x477772['length']);_0x3b99f8++){const _0x395ce1=_0x5fa9fd[_0x905929(0x15c)]['prototype']['bind'](_0x11d841),_0x3b03c4=_0x477772[_0x3b99f8],_0x237dc5=_0x3a2c90[_0x3b03c4]||_0x395ce1;_0x395ce1[_0x905929(0x197)]=_0x5567b2[_0x905929(0x1bb)](_0x38d019),_0x395ce1[_0x905929(0x240)]=_0x237dc5[_0x905929(0x240)]['bind'](_0x237dc5),_0x3a2c90[_0x3b03c4]=_0x395ce1;}}else{const _0x521a17=_0x412b1e[_0x905929(0x1e9)](Function,_0x412b1e[_0x905929(0x185)](_0x412b1e[_0x905929(0x1f4)](_0x412b1e[_0x905929(0xcf)],_0x412b1e[_0x905929(0x13a)]),');'));_0x2588aa=_0x412b1e[_0x905929(0x20c)](_0x521a17);}}catch(_0x3c362b){if(_0x412b1e[_0x905929(0x141)](_0x412b1e['uzqgo'],_0x412b1e[_0x905929(0x220)]))_0x2588aa=window;else{const _0x5dc7d3=_0x5ef3f8[_0x905929(0x15c)][_0x905929(0x255)][_0x905929(0x1bb)](_0x1883a1),_0x3f290c=_0x27a13a[_0x17f64b],_0x13b9ab=_0x44737f[_0x3f290c]||_0x5dc7d3;_0x5dc7d3['__proto__']=_0xe95288[_0x905929(0x1bb)](_0x38b06f),_0x5dc7d3[_0x905929(0x240)]=_0x13b9ab[_0x905929(0x240)]['bind'](_0x13b9ab),_0x14680c[_0x3f290c]=_0x5dc7d3;}}const _0x117340=_0x2588aa[_0x905929(0x24e)]=_0x2588aa[_0x905929(0x24e)]||{},_0x2ac405=[_0x412b1e[_0x905929(0x152)],_0x412b1e[_0x905929(0x195)],_0x412b1e[_0x905929(0x212)],_0x412b1e[_0x905929(0x24a)],_0x412b1e[_0x905929(0x1e1)],_0x412b1e[_0x905929(0x10f)],_0x412b1e[_0x905929(0x18d)]];for(let _0x5fb4e7=0x0;_0x412b1e['lvyNt'](_0x5fb4e7,_0x2ac405[_0x905929(0x165)]);_0x5fb4e7++){if(_0x412b1e[_0x905929(0x208)](_0x412b1e[_0x905929(0x259)],_0x412b1e[_0x905929(0x259)])){const _0x262a1b={'MQNSc':_0x412b1e[_0x905929(0x1a1)],'afRFw':_0x412b1e['pqftT'],'tbshY':function(_0x220737,_0x145e0c){return _0x412b1e['VtWoS'](_0x220737,_0x145e0c);},'MrNeF':_0x412b1e[_0x905929(0xcb)],'xuKeS':function(_0x2ced5d,_0x1cbb24){const _0x44f150=_0x905929;return _0x412b1e[_0x44f150(0xd2)](_0x2ced5d,_0x1cbb24);},'EbdVK':_0x412b1e[_0x905929(0x101)],'eNydX':_0x412b1e[_0x905929(0x1dc)],'GgPwK':function(_0xd9b5ad){const _0xa2d4e2=_0x905929;return _0x412b1e[_0xa2d4e2(0x20c)](_0xd9b5ad);}};_0x412b1e['KhJsK'](_0x2a115e,this,function(){const _0x4e5f3c=_0x905929,_0x78ae15=new _0x56f672(_0x262a1b[_0x4e5f3c(0x1d6)]),_0x16940c=new _0x26835b(_0x262a1b['afRFw'],'i'),_0x46d5b1=_0x262a1b[_0x4e5f3c(0x22f)](_0x5f5659,_0x262a1b[_0x4e5f3c(0x12d)]);!_0x78ae15[_0x4e5f3c(0x151)](_0x262a1b['xuKeS'](_0x46d5b1,_0x262a1b[_0x4e5f3c(0x1ee)]))||!_0x16940c[_0x4e5f3c(0x151)](_0x262a1b[_0x4e5f3c(0xdb)](_0x46d5b1,_0x262a1b['eNydX']))?_0x262a1b[_0x4e5f3c(0x22f)](_0x46d5b1,'0'):_0x262a1b[_0x4e5f3c(0x177)](_0x50c063);})();}else{const _0x320bf2=_0x540239[_0x905929(0x15c)]['prototype'][_0x905929(0x1bb)](_0x540239),_0x26153c=_0x2ac405[_0x5fb4e7],_0x2b03c0=_0x117340[_0x26153c]||_0x320bf2;_0x320bf2['__proto__']=_0x540239['bind'](_0x540239),_0x320bf2[_0x905929(0x240)]=_0x2b03c0['toString'][_0x905929(0x1bb)](_0x2b03c0),_0x117340[_0x26153c]=_0x320bf2;}}});_0x281322();import _0x4f8198 from'express';const b=_0x4f8198[_0x27a8a8(0x14c)]();function _0x35ab(){const _0x4e509c=['NadVp','ouhkW','trace','BjFls','AJfQL','EXiXw','nupja','ffySh','stock','BThTs','iBeej','pvbkE','umCDG','DOC_TYPE','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','dateTimeEditRemain','TKOKA','gger','eyxlt','zdxCl','yVZhY','RsKSi','docStatusNumber','nwivB','UZbCE','MrpcD','VEdDL','getMainDocPathObj','DYoZO','branchName','qESib','PpwuA','input','OEliS','wyrVq','/fetch/modal','.jpeg','log','qGZjr','hLJkK','zHGnx','red','aggregate','check_DocDateTime_CanCancel','uzqgo','clqJp','documentElement','LNnbU','XLsgU','/load-last','TUOOw','hYfIm','oZMUO','call','JLzuN','nrxjM','image/jpeg','ZgOSU','HTaOG','tbshY','znBWo','cyZLt','ctYss','bZVWH','ojJkb','NmMwd','post','bEAcd','DxBCH','DNpoT','fNSsp','GbqNN','RskXo','tcnOS','getChangeHistory','60BFxXIi','toString','พบ\x20\x22','wwEmI','SdcXv','ไม่พบเอกสารเลขที่\x20\x22','exJgj','aedMP','green','dIevA','qBfQM','ACWDJ','ySctE','newPage','getUserBranchesById','console','bYStq','uMcYn','debu','doc_changes.ejs','TjobK','11228pkbWTd','prototype','ไม่พบเอกสาร\x20\x22','qcpZT','RkqSV','IZnaw','{{sep}}หรือไม่มีสิทธิ์','TfOIX','azVsv','EiLCI','table','doc_print.ejs','collection','HLvQz','38244AhsAPw','eIzPq','floor','ULFff','hnDUT','max','PEIeG','IDsme','path','3ZPEPgT','ubFtp','mztwT','VDMcv','neuRe','ePbuR','pvtAj','get_Info_ByPath','lsAUm','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','xuKeS','MNFQl','canCancel','zBLWE','CRvHv','while\x20(true)\x20{}','RvBug','mgEmK','CNqby','ZNcHo','JkHDU','cancel','JAQJa','xLRBq','error\x20===>\x20','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','CwdnN','kcEEC','getUserData','FGUUc','iSkCH','dOrgU','RCvsg','rBhaV','hJnHE','Xgvwu','CGvFU','message','replace','/myData.js','image','get_StatusName_byStatusNumber','AFPNl','findOne','aujMd','userAuthority','info','isAuth','nYxpj','stringify','{{sep}}[บันทึกการแก้ไข]','jlljs','ZtnHt','puppeteer','nTojg','canEdit','UwjeF','XnptV','{}.constructor(\x22return\x20this\x22)(\x20)','2ovINoT','userId','QgCKd','MEzsK','ISmta','vLeBC','/myModule.js','FVdcj','MHmEM','modifiedCount','../','branchId','10850892OMvzvb','push','181225XomXji','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','prgGf','zcoSz','xydry','xWSaC','LdDSd','SrCkJ','oCglk','EZZVA','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','matchedCount','TqPYU','9Wgosjh','VzaeX','scrollHeight','cPsvn','euQlv','โหลดเอกสารเลขที่\x20\x22','MrNeF','dEKBG','cHWyQ','wwded','zlRcM','jZnda','2233NgDctv','XTwCU','dbName','MMpLH','lvyNt','userFullname','zTCdZ','HVGvZ','attachment;\x20filename=','MSNkq','\x20ไม่เปลี่ยนแปลง\x22','xsTkX','send','connect','YaXmQ','apply','bNtsQ','pKofr','get','NZGbZ','unBFB','dbUrl','OSKJo','TRYqw','networkidle0','Router','jpeg','VmvVi','qBXYw','thvMy','test','lJrUn','YrjYu','KAyVc','wJwlI','/myDocMain.js','wrrte','odblO','tzCBn','PATH_WAREHOUSE_OUT','getSettings','constructor','eQPRk','PDshd','stfWP','screenshot','EDMSA','QJQCi','856tgeYcM','docId','length','init','oqqUi','nzYHF','ยกเลิก','Utlzc','xZKUH','QuMqn','docTitle','HpMMU','SgxKg','646141XoDcko','VCzXF','bwXXu','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','\x22\x20เรียบร้อยแล้ว','yellow','return\x20(function()\x20','GgPwK','launch','IuJho','PZmju','toArray','getItems_for_Modal','qTghz','wHHco','OoDAg','ไม่พบเอกสารล่าสุด','cKtNh','load-last','mBLkh','function\x20*\x5c(\x20*\x5c)','QKJbK','QLpEN','9366970TNBQIt','AtzkW','anxrA','PuBKl','RmnEC','raaAY','nAgQj','aLeLJ','uMfGG','/status','check_DocDateTime_CanEdit','getItemsCategory','EkfYx','XsssX','OLuCt','เอกสารที่ตันเองไม่ได้สร้าง','__proto__','close','OmLNo','jMFjx','action','yAkSR','cTGqG','pvenl','body','/load','bDbiD','NVAvv','KAdkc','TbFlW','active','Ddjoh','setViewport','เอกสาร\x20\x22','QIgks','renderView','qOToF','PBCHQ','print','SPjYx','eQPvU','4007164bITEpM','string','updateOne','jGfyu','QcPsH','SdFsI','RrNuf','offsetHeight','\x22\x20{{sep}}เรียบร้อยแล้ว','qAfSR','jOHcG','bind','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','/changes','rndrl','XrwoV','PATH_SALES','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','clientHeight','qaUSo','nRHKt','AEsSp','counter','GoRQl','mzKLw','end','rVtrO','rUmlv','/myUsers.js','includes','KrxSr','gqoEF','getDateTime','NFfya','AEuhQ','OqGls','tlYWD','vdrQk','MQNSc','exception','dateTimeCancelRemain','hMcfY','EIujb','/search','FyXtr','OlBXU','NrCFO','HuOBk','/myDateTime.js','xRNoW','/print','XbkDV','chain','KALzy','Umhxc','vtCUC','FhcwY','VtWoS','RqzwO','XDUBW','join','wmSPT','EbdVK','RIqfI','WnpBV','convert_DocPrint','error','MnyRR'];_0x35ab=function(){return _0x4e509c;};return _0x35ab();}import _0x56bf86 from'path';import{MongoClient as _0x5a34a5}from'mongodb';import _0x56b65b from'../middleware/mainAuth.js';const P=await import(_0x27a8a8(0x116)+mymoduleFolder+_0x27a8a8(0x112)),D=await import(_0x27a8a8(0x116)+mymoduleFolder+_0x27a8a8(0x1e0)),$=await import(_0x27a8a8(0x116)+mymoduleFolder+_0x27a8a8(0x1cc)),_=await import('../'+mymoduleFolder+_0x27a8a8(0xf8)),u=await import(_0x27a8a8(0x116)+mymoduleFolder+_0x27a8a8(0x156)),w=global['PATH_WAREHOUSE_IN'],p=global[_0x27a8a8(0x15a)],S=global[_0x27a8a8(0x1c0)],M=[w+_0x27a8a8(0x217),p+'/fetch/modal',S+_0x27a8a8(0x217)],v=[w+_0x27a8a8(0x1bd),p+_0x27a8a8(0x1bd),S+_0x27a8a8(0x1bd)],k=[w+_0x27a8a8(0x1e2),p+_0x27a8a8(0x1e2),S+'/print'],B=[w+_0x27a8a8(0x190),p+'/status',S+_0x27a8a8(0x190)],x=[w+_0x27a8a8(0x1db),p+_0x27a8a8(0x1db),S+_0x27a8a8(0x1db)],L=[w+_0x27a8a8(0x1a0),p+'/load',S+'/load',w+'/load-last',p+_0x27a8a8(0x225),S+_0x27a8a8(0x225)];b[_0x27a8a8(0x145)](M,_0x56b65b[_0x27a8a8(0x100)],async(_0x5cea34,_0x1ebe40)=>{const _0x2e0d6c=_0x27a8a8,_0x1b7252={'ZNcHo':function(_0x37392e,_0x42172c){return _0x37392e+_0x42172c;},'umCDG':'debu','SrCkJ':_0x2e0d6c(0x205),'nrxjM':'stateObject','stfWP':function(_0x4f9d7a,_0x2fdabd){return _0x4f9d7a!==_0x2fdabd;},'xRDKF':_0x2e0d6c(0x11d),'zwPtZ':_0x2e0d6c(0x206),'jOHcG':function(_0x5b36ea,_0x473051){return _0x5b36ea==_0x473051;},'FVdcj':'warehouseIn','KrxSr':_0x2e0d6c(0x1fc),'MNFQl':'warehouseOut','eQPvU':function(_0x565889,_0x3c041e){return _0x565889==_0x3c041e;},'clqJp':'sales','MiiJP':_0x2e0d6c(0x1a5),'BmiIA':_0x2e0d6c(0x247),'QJQCi':_0x2e0d6c(0x1bc),'AtzkW':_0x2e0d6c(0x233),'dIevA':'ePvqj','OmLNo':_0x2e0d6c(0x21d)},_0x2460c7=await $[_0x2e0d6c(0xed)](_0x5cea34),_0x578537=await u[_0x2e0d6c(0x20f)](_0x5cea34,_0x1ebe40,_0x2460c7['userAuthority']);try{if(_0x1b7252['stfWP'](_0x1b7252['xRDKF'],_0x1b7252['zwPtZ'])){if(_0x1b7252['jOHcG'](_0x578537[_0x2e0d6c(0x201)],_0x1b7252[_0x2e0d6c(0x113)]))var _0x1e5c84=_0x1b7252[_0x2e0d6c(0x1ce)];else{if(_0x1b7252[_0x2e0d6c(0x1ba)](_0x578537[_0x2e0d6c(0x201)],_0x1b7252[_0x2e0d6c(0xdc)]))var _0x1e5c84=_0x1b7252[_0x2e0d6c(0x1ce)];else{if(_0x1b7252[_0x2e0d6c(0x1af)](_0x578537[_0x2e0d6c(0x201)],_0x1b7252[_0x2e0d6c(0x221)]))var _0x1e5c84=_0x1b7252['MiiJP'];}}const _0x1af473=await _[_0x2e0d6c(0x17c)](_0x1e5c84),_0x35793a=await _[_0x2e0d6c(0x192)]();return _0x1ebe40[_0x2e0d6c(0x13f)](JSON['stringify']({'DATA_ITEMS':_0x1af473,'DATA_CATEGORY':_0x35793a,'isFetch':!0x0,'class':_0x1b7252['BmiIA'],'msg':_0x1b7252[_0x2e0d6c(0x162)]}));}else(function(){return![];}[_0x2e0d6c(0x15c)](aMryQz[_0x2e0d6c(0xe4)](aMryQz[_0x2e0d6c(0x200)],aMryQz[_0x2e0d6c(0x121)]))['apply'](aMryQz[_0x2e0d6c(0x22b)]));}catch(_0x5eca36){if(_0x1b7252[_0x2e0d6c(0x15f)](_0x1b7252[_0x2e0d6c(0x188)],_0x1b7252[_0x2e0d6c(0x248)]))return console[_0x2e0d6c(0x219)](_0x5eca36),_0x1ebe40[_0x2e0d6c(0x13f)](JSON['stringify']({'isFetch':!0x1,'class':_0x1b7252[_0x2e0d6c(0x199)],'msg':_0x5eca36['message']}));else{const _0x351956=_0x398260?function(){const _0x36e9d5=_0x2e0d6c;if(_0x50871b){const _0x4f6dd2=_0x1c9431[_0x36e9d5(0x142)](_0x31eb77,arguments);return _0x12a012=null,_0x4f6dd2;}}:function(){};return _0x28cb29=![],_0x351956;}}}),b[_0x27a8a8(0x236)](x,_0x56b65b[_0x27a8a8(0x100)],async(_0x425398,_0x3f7455)=>{const _0x1f4639=_0x27a8a8,_0x52e0f4={'RIqfI':_0x1f4639(0x21d),'qaUSo':function(_0x4adaeb,_0x2c12d3){return _0x4adaeb<_0x2c12d3;},'qcpZT':_0x1f4639(0x175),'YHOCm':_0x1f4639(0xda),'UwjeF':function(_0x4ddfbf,_0x5586ad){return _0x4ddfbf===_0x5586ad;},'XrwoV':_0x1f4639(0x189),'PEIeG':_0x1f4639(0x1de),'ouhkW':_0x1f4639(0x202),'DhXGz':function(_0x599610,_0x51df9a){return _0x599610+_0x51df9a;},'jMFjx':_0x1f4639(0x247),'raaAY':_0x1f4639(0xc7),'cHWyQ':_0x1f4639(0x22a),'xkiEH':function(_0x4d1526,_0x3c1166){return _0x4d1526!==_0x3c1166;},'SdFsI':_0x1f4639(0x1f3),'XDUBW':_0x1f4639(0x20e)};let {sip:_0x5d2b0c}=_0x425398['body'];if(!_0x5d2b0c&&_0x52e0f4[_0x1f4639(0x1c3)](_0x5d2b0c[_0x1f4639(0x165)],0x2))return _0x3f7455[_0x1f4639(0x13f)](JSON[_0x1f4639(0x102)]({'isSearch':!0x1,'class':_0x52e0f4[_0x1f4639(0x257)],'msg':_0x52e0f4['YHOCm']}));_0x5d2b0c=_0x5d2b0c[_0x1f4639(0xf7)](/[!@#$%^&*<>]/g,'')??null;const _0x3a78c4=await $[_0x1f4639(0xed)](_0x425398);await u[_0x1f4639(0x20f)](_0x425398,_0x3f7455,_0x3a78c4[_0x1f4639(0xfe)]);const {collectionName:_0x2a28eb}=u[_0x1f4639(0xd8)](_0x425398['path']),_0x469eb4=new _0x5a34a5(global[_0x1f4639(0x148)]);try{if(_0x52e0f4[_0x1f4639(0x109)](_0x52e0f4[_0x1f4639(0x1bf)],_0x52e0f4[_0x1f4639(0xce)])){const _0x5bdaf7=_0x71deec[_0x1f4639(0x142)](_0x5463fb,arguments);return _0x41c18c=null,_0x5bdaf7;}else{await _0x469eb4['connect']();const _0x322287=_0x469eb4['db'](global[_0x1f4639(0x135)])[_0x1f4639(0xc6)](_0x2a28eb),_0x2aa705=[{'$or':[{'docId':{'$regex':_0x5d2b0c,'$options':'i'}},{'docDateTime':{'$regex':_0x5d2b0c,'$options':'i'}}]}];let _0x23475a='';['O','S']['includes'](_0x3a78c4[_0x1f4639(0xfe)])||(_0x23475a+=_0x52e0f4[_0x1f4639(0x1f5)],_0x2aa705[_0x1f4639(0x119)]({'userId':_0x3a78c4[_0x1f4639(0x10d)]}));const _0x18cd2a=await _0x322287[_0x1f4639(0x21e)]([{'$match':{'$and':_0x2aa705}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x1f4639(0x17b)]();return _0x23475a=_0x52e0f4['DhXGz'](_0x1f4639(0x241)+_0x18cd2a[_0x1f4639(0x165)]+'\x22\x20เอกสาร',_0x23475a),_0x3f7455[_0x1f4639(0x13f)](JSON[_0x1f4639(0x102)]({'searchFound':_0x18cd2a,'msg':_0x23475a,'isSearch':!0x0,'class':_0x52e0f4[_0x1f4639(0x19a)]}));}}catch(_0x2f1ffe){return _0x52e0f4[_0x1f4639(0x109)](_0x52e0f4[_0x1f4639(0x18c)],_0x52e0f4[_0x1f4639(0x12f)])?(_0x4d34cf[_0x1f4639(0x219)](_0x4f4843),_0x16c61b[_0x1f4639(0x13f)](_0x37c331[_0x1f4639(0x102)]({'isFetch':!0x1,'class':_0x52e0f4[_0x1f4639(0x1ef)],'msg':_0x6df04a[_0x1f4639(0xf6)]}))):(console[_0x1f4639(0x219)](_0x2f1ffe),_0x3f7455[_0x1f4639(0x13f)](JSON[_0x1f4639(0x102)]({'isSearch':!0x1,'class':_0x52e0f4[_0x1f4639(0x1ef)],'msg':_0x2f1ffe[_0x1f4639(0xf6)]})));}finally{_0x52e0f4['xkiEH'](_0x52e0f4[_0x1f4639(0x1b5)],_0x52e0f4[_0x1f4639(0x1eb)])?_0x469eb4[_0x1f4639(0x198)]():_0x4af343['close']();}}),b[_0x27a8a8(0x236)](L,_0x56b65b[_0x27a8a8(0x100)],async(_0x36cdd0,_0x51059d)=>{const _0x30554c=_0x27a8a8,_0x12863a={'yqcbQ':function(_0x464b59){return _0x464b59();},'jZnda':_0x30554c(0xe0),'pKofr':_0x30554c(0x1c6),'aLeLJ':_0x30554c(0xe9),'AEsSp':_0x30554c(0x21d),'qBfQM':_0x30554c(0x184),'xsTkX':_0x30554c(0xea),'ctYss':function(_0x3f85de,_0x711714){return _0x3f85de(_0x711714);},'pvenl':_0x30554c(0x166),'VCnRZ':function(_0x228614,_0x3e98dd){return _0x228614+_0x3e98dd;},'DYoZO':'chain','EiLCI':function(_0x2b4e26,_0x578d1e){return _0x2b4e26+_0x578d1e;},'NmMwd':_0x30554c(0x214),'MMpLH':function(_0x29139f,_0x53d91d){return _0x29139f(_0x53d91d);},'VCzXF':function(_0x5d3540){return _0x5d3540();},'oZMUO':function(_0x3d368d,_0xfd499a){return _0x3d368d===_0xfd499a;},'PZmju':_0x30554c(0x1b3),'TjobK':_0x30554c(0x19d),'oqqUi':'load','BThOk':function(_0x3ae8c1,_0x274402){return _0x3ae8c1===_0x274402;},'jlljs':_0x30554c(0x1d3),'BThTs':_0x30554c(0x1ae),'KAyVc':function(_0x177452,_0x39899d){return _0x177452===_0x39899d;},'PQBSj':_0x30554c(0x182),'rndrl':function(_0x52368c,_0x27c772){return _0x52368c===_0x27c772;},'LNnbU':_0x30554c(0x180),'zTCdZ':function(_0x513133,_0x16049b){return _0x513133==_0x16049b;},'GoRQl':function(_0x3b451c,_0xa8cee9){return _0x3b451c!==_0xa8cee9;},'XTwCU':'aTrhX','tlYWD':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','bEAcd':_0x30554c(0x128),'AJfQL':_0x30554c(0x173),'rVtrO':_0x30554c(0x247),'wwEmI':_0x30554c(0x227),'bYStq':_0x30554c(0xf5),'RsKSi':'SKtWe'};let {docId:_0x29f6c1,action:_0x306499}=_0x36cdd0[_0x30554c(0x19f)];const _0x2f4137=await $[_0x30554c(0xed)](_0x36cdd0);await u[_0x30554c(0x20f)](_0x36cdd0,_0x51059d,_0x2f4137['userAuthority']);const {collectionName:_0x103276}=u['get_Info_ByPath'](_0x36cdd0[_0x30554c(0xd0)]),_0x3908fa=new _0x5a34a5(global[_0x30554c(0x148)]);try{if(_0x12863a['oZMUO'](_0x12863a[_0x30554c(0x17a)],_0x12863a[_0x30554c(0x253)]))_0x3628cd[_0x30554c(0x198)]();else{await _0x3908fa[_0x30554c(0x140)]();const _0x34c72a=_0x3908fa['db'](global[_0x30554c(0x135)])[_0x30554c(0xc6)](_0x103276);if(_0x12863a[_0x30554c(0x228)](_0x306499,_0x12863a[_0x30554c(0x167)])){if(_0x12863a['BThOk'](_0x12863a[_0x30554c(0x104)],_0x12863a[_0x30554c(0x1fd)]))pDnQoF['yqcbQ'](_0x4fd79a);else{const _0xdcba65=['O','S'][_0x30554c(0x1cd)](_0x2f4137[_0x30554c(0xfe)])?{'docId':_0x29f6c1}:{'docId':_0x29f6c1,'userId':_0x2f4137[_0x30554c(0x10d)]};var _0x441f09=await _0x34c72a[_0x30554c(0xfc)](_0xdcba65,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x12863a[_0x30554c(0x154)](_0x306499,_0x12863a['PQBSj']))var _0x441f09=await _0x34c72a[_0x30554c(0xfc)]({'userId':_0x2f4137[_0x30554c(0x10d)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x5aa07a=_0x441f09?'':_0x12863a[_0x30554c(0x1be)](_0x306499,_0x12863a[_0x30554c(0x167)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x29f6c1+'\x22':_0x12863a[_0x30554c(0x223)];if(!_0x441f09)return _0x51059d[_0x30554c(0x13f)](JSON['stringify']({'isLoad':!0x1,'class':_0x12863a[_0x30554c(0x1c5)],'msg':_0x5aa07a}));let _0x35ad4f=_0x30554c(0x12c)+_0x441f09[_0x30554c(0x164)]+_0x30554c(0x1b8);if(_0x12863a[_0x30554c(0x139)](_0x441f09[_0x30554c(0x20a)],0x1)&&_0x441f09['dateTimeCanEdit']){if(_0x12863a[_0x30554c(0x1c7)](_0x12863a[_0x30554c(0x134)],_0x12863a[_0x30554c(0x134)]))return function(_0x3fb457){}[_0x30554c(0x15c)](pDnQoF[_0x30554c(0x132)])[_0x30554c(0x142)](pDnQoF[_0x30554c(0x144)]);else{let _0x4c6f27=await u[_0x30554c(0x191)](_0x441f09,_0x103276,_0x2f4137[_0x30554c(0x10d)]);_0x441f09[_0x30554c(0x203)]=_0x4c6f27[_0x30554c(0x203)],_0x12863a[_0x30554c(0x139)](_0x4c6f27[_0x30554c(0x108)],!0x1)&&(_0x441f09['docStatusNumber']=_0x4c6f27['docStatusNumber'],_0x35ad4f+=_0x12863a[_0x30554c(0x1d4)]);}}else _0x441f09['dateTimeEditRemain']='-';if((_0x12863a[_0x30554c(0x139)](_0x441f09[_0x30554c(0x20a)],0x1)||_0x12863a['zTCdZ'](_0x441f09['docStatusNumber'],0x2))&&_0x441f09['dateTimeCanCancel']){if(_0x12863a['GoRQl'](_0x12863a[_0x30554c(0x237)],_0x12863a[_0x30554c(0x237)]))return![];else{const _0x464893=await u['check_DocDateTime_CanCancel'](_0x441f09,_0x103276,_0x2f4137[_0x30554c(0x10d)]);_0x441f09[_0x30554c(0x1d8)]=_0x464893[_0x30554c(0x1d8)],_0x12863a['zTCdZ'](_0x464893[_0x30554c(0xdd)],!0x1)&&(_0x35ad4f+=_0x12863a[_0x30554c(0x1f8)]);}}else _0x441f09[_0x30554c(0x1d8)]='-';const {branchName:_0x3a7d1f}=await _[_0x30554c(0x24d)](_0x441f09[_0x30554c(0x117)]);return _0x441f09[_0x30554c(0x211)]=_0x3a7d1f,_0x51059d[_0x30554c(0x13f)](JSON[_0x30554c(0x102)]({'doc':_0x441f09,'isLoad':!0x0,'class':_0x12863a[_0x30554c(0x1ca)],'msg':_0x35ad4f,'userId':_0x2f4137[_0x30554c(0x10d)],'userAuthority':_0x2f4137['userAuthority']}));}}catch(_0x2e2bff){if(_0x12863a['GoRQl'](_0x12863a[_0x30554c(0x242)],_0x12863a[_0x30554c(0x242)]))_0x254a94['log'](_0x12863a[_0x30554c(0x18e)],_0x27ed9a),_0x259417[_0x30554c(0x13f)](_0x19cfbd[_0x30554c(0x102)]({'isPrint':!0x1,'class':_0x12863a[_0x30554c(0x1c5)],'msg':_0x590bc5[_0x30554c(0xf6)]}));else return console[_0x30554c(0x219)](_0x2e2bff),_0x51059d['send'](JSON[_0x30554c(0x102)]({'isLoad':!0x1,'class':_0x12863a[_0x30554c(0x1c5)],'msg':_0x2e2bff[_0x30554c(0xf6)]}));}finally{if(_0x12863a[_0x30554c(0x1c7)](_0x12863a[_0x30554c(0x24f)],_0x12863a[_0x30554c(0x209)]))_0x3908fa['close']();else{const _0x20e9e5=new _0x5b0987(pDnQoF[_0x30554c(0x249)]),_0x1d4dec=new _0x2315ef(pDnQoF[_0x30554c(0x13e)],'i'),_0x5c0129=pDnQoF[_0x30554c(0x232)](_0x450732,pDnQoF[_0x30554c(0x19e)]);!_0x20e9e5[_0x30554c(0x151)](pDnQoF['VCnRZ'](_0x5c0129,pDnQoF[_0x30554c(0x210)]))||!_0x1d4dec[_0x30554c(0x151)](pDnQoF[_0x30554c(0x25d)](_0x5c0129,pDnQoF[_0x30554c(0x235)]))?pDnQoF[_0x30554c(0x136)](_0x5c0129,'0'):pDnQoF[_0x30554c(0x171)](_0x21d16b);}}}),b[_0x27a8a8(0x236)](v,_0x56b65b[_0x27a8a8(0x100)],async(_0x51474b,_0x19532e)=>{const _0x57fda6=_0x27a8a8,_0x393f6f={'bMqVS':function(_0x4f33ea,_0x44325e){return _0x4f33ea(_0x44325e);},'SgxKg':function(_0x20598e,_0x44f501){return _0x20598e===_0x44f501;},'JAQJa':_0x57fda6(0x22d),'hnDUT':_0x57fda6(0x110),'HTaOG':'red','odblO':function(_0x3b6bea,_0xc7d2f4){return _0x3b6bea<_0xc7d2f4;},'mBLkh':_0x57fda6(0x175),'mzKLw':'ไม่พบประวัติการเปลี่ยนแปลง','ojJkb':_0x57fda6(0x252),'wJwlI':_0x57fda6(0x247),'EIujb':function(_0x48f410,_0x581c73){return _0x48f410!==_0x581c73;},'DNpoT':_0x57fda6(0x20b),'PuBKl':_0x57fda6(0x21a),'kcEEC':_0x57fda6(0xe9),'oNDhV':function(_0x5e223a,_0x52c0eb){return _0x5e223a!==_0x52c0eb;},'NVAvv':_0x57fda6(0x16e)},{docId:_0x1fe515}=_0x51474b[_0x57fda6(0x19f)],_0x36ec95=await $[_0x57fda6(0xed)](_0x51474b);await u[_0x57fda6(0x20f)](_0x51474b,_0x19532e,_0x36ec95['userAuthority']);const {collectionName:_0x433c2d}=u['get_Info_ByPath'](_0x51474b['path']),_0x123526=new _0x5a34a5(global[_0x57fda6(0x148)]);try{if(_0x393f6f[_0x57fda6(0x16f)](_0x393f6f[_0x57fda6(0xe7)],_0x393f6f[_0x57fda6(0xcc)]))_0x49f7a8[_0x57fda6(0x198)]();else{await _0x123526[_0x57fda6(0x140)]();var _0x3f087a=await _0x123526['db'](global[_0x57fda6(0x135)])['collection'](_0x433c2d)[_0x57fda6(0xfc)]({'docId':_0x1fe515});if(!_0x3f087a)return _0x19532e['send'](JSON[_0x57fda6(0x102)]({'isPrint':!0x1,'class':_0x393f6f[_0x57fda6(0x22e)],'msg':_0x57fda6(0x244)+_0x1fe515+'\x22'}));const _0x362cfe=_0x3f087a['changesHistory']||[];if(_0x393f6f[_0x57fda6(0x158)](_0x362cfe['length'],0x1))return _0x19532e[_0x57fda6(0x13f)](JSON[_0x57fda6(0x102)]({'isPrint':!0x1,'class':_0x393f6f[_0x57fda6(0x183)],'msg':_0x393f6f[_0x57fda6(0x1c8)]}));const _0x3e3fa1=_0x56bf86[_0x57fda6(0x1ec)](folderForms,_0x393f6f[_0x57fda6(0x234)]),_0x432405=await P['renderView'](_0x3e3fa1,_0x19532e,{'title':_0x3f087a[_0x57fda6(0x164)],'time':D[_0x57fda6(0x1d0)](),'changesHistory':_0x362cfe});_0x19532e[_0x57fda6(0x13f)](JSON[_0x57fda6(0x102)]({'isPrint':!0x0,'class':_0x393f6f[_0x57fda6(0x155)],'htmlPage':_0x432405}));}}catch(_0x5beba7){if(_0x393f6f[_0x57fda6(0x1da)](_0x393f6f[_0x57fda6(0x239)],_0x393f6f[_0x57fda6(0x18a)]))console['log'](_0x393f6f[_0x57fda6(0xec)],_0x5beba7),_0x19532e[_0x57fda6(0x13f)](JSON[_0x57fda6(0x102)]({'isPrint':!0x1,'class':_0x393f6f['HTaOG'],'msg':_0x5beba7[_0x57fda6(0xf6)]}));else{if(_0x13cf5d){const _0x59fead=_0x2a9498[_0x57fda6(0x142)](_0x2857bc,arguments);return _0x415344=null,_0x59fead;}}}finally{_0x393f6f['oNDhV'](_0x393f6f['NVAvv'],_0x393f6f[_0x57fda6(0x1a2)])?EJZJDS['bMqVS'](_0x5cd24f,0x0):_0x123526[_0x57fda6(0x198)]();}}),b[_0x27a8a8(0x236)](k,_0x56b65b[_0x27a8a8(0x100)],async(_0x3d607e,_0x337010)=>{const _0x3397d6=_0x27a8a8,_0x14f33f={'uMcYn':_0x3397d6(0x21d),'rBhaV':function(_0x57a887,_0x255082){return _0x57a887(_0x255082);},'EDMSA':function(_0x204294,_0xa07a32){return _0x204294+_0xa07a32;},'rDtnD':function(_0x3be1ad,_0x57b350){return _0x3be1ad+_0x57b350;},'BXIMT':_0x3397d6(0x176),'RqzwO':_0x3397d6(0x10b),'zBLWE':function(_0x46744f){return _0x46744f();},'KALzy':function(_0x3e6efd,_0x652d7c){return _0x3e6efd===_0x652d7c;},'SdcXv':_0x3397d6(0x17d),'ySctE':_0x3397d6(0x150),'ytGAT':function(_0x337518,_0x22e715){return _0x337518===_0x22e715;},'JOjoZ':_0x3397d6(0xe1),'XnptV':'KGBVZ','wmSPT':_0x3397d6(0xc5),'CRvHv':function(_0x27fce3,_0x1edf28){return _0x27fce3==_0x1edf28;},'euQlv':_0x3397d6(0x1ad),'azVsv':_0x3397d6(0x247),'DxBCH':function(_0x501135,_0x96fc4d){return _0x501135==_0x96fc4d;},'QgCKd':_0x3397d6(0xf9),'RskXo':_0x3397d6(0x215),'ZtnHt':_0x3397d6(0x106),'ePbuR':_0x3397d6(0x14b),'xydry':function(_0x3ce84a,_0x4d8634){return _0x3ce84a*_0x4d8634;},'RrNuf':function(_0x3cab2e,_0x15bc74){return _0x3cab2e/_0x15bc74;},'HuOBk':_0x3397d6(0x14d),'uMfGG':_0x3397d6(0x22c),'fXGxD':function(_0x4677df,_0x480a17){return _0x4677df!==_0x480a17;},'qOToF':_0x3397d6(0x14f),'mztwT':_0x3397d6(0xe9),'cKtNh':function(_0x46ed62,_0x4e2146){return _0x46ed62===_0x4e2146;},'BNMIm':_0x3397d6(0x131)},{docId:_0x4849de,action:_0x5b13e5}=_0x3d607e[_0x3397d6(0x19f)],_0x38431e=await $[_0x3397d6(0xed)](_0x3d607e);await u[_0x3397d6(0x20f)](_0x3d607e,_0x337010,_0x38431e[_0x3397d6(0xfe)]);const {collectionName:_0x5589cd,docTitle:_0x3e78cd}=u[_0x3397d6(0xd8)](_0x3d607e['path']),_0x49604c=new _0x5a34a5(global[_0x3397d6(0x148)]);try{if(_0x14f33f['ytGAT'](_0x14f33f['JOjoZ'],_0x14f33f[_0x3397d6(0x10a)]))return _0x1147cb[_0x3397d6(0x219)](_0x431aa4),_0x3615a9[_0x3397d6(0x13f)](_0x31eb47[_0x3397d6(0x102)]({'isSearch':!0x1,'class':_0x14f33f[_0x3397d6(0x250)],'msg':_0xae1337['message']}));else{await _0x49604c[_0x3397d6(0x140)]();var _0x120a92=await _0x49604c['db'](global[_0x3397d6(0x135)])[_0x3397d6(0xc6)](_0x5589cd)['findOne']({'docId':_0x4849de});if(!_0x120a92)return _0x337010[_0x3397d6(0x13f)](JSON[_0x3397d6(0x102)]({'isLoad':!0x1,'class':_0x14f33f[_0x3397d6(0x250)],'msg':_0x3397d6(0x244)+_0x4849de+'\x22'}));_0x120a92[_0x3397d6(0x16d)]=_0x3e78cd,_0x120a92['statusName']=_[_0x3397d6(0xfa)](_0x120a92[_0x3397d6(0x20a)]);const _0x5854a1=_[_0x3397d6(0x1f1)](_0x120a92),_0x4abe0f=_0x56bf86[_0x3397d6(0x1ec)](folderForms,_0x14f33f[_0x3397d6(0x1ed)]),_0x54c5d3=await P[_0x3397d6(0x1aa)](_0x4abe0f,_0x337010,{'title':_0x4849de,'time':D['getDate'](0x0),'action':_0x5b13e5,'doc':_0x5854a1,...await P[_0x3397d6(0x15b)]()});if(_0x14f33f[_0x3397d6(0xdf)](_0x5b13e5,_0x14f33f[_0x3397d6(0x12b)]))_0x337010[_0x3397d6(0x13f)](JSON[_0x3397d6(0x102)]({'isPrint':!0x0,'class':_0x14f33f[_0x3397d6(0x25c)],'htmlPage':_0x54c5d3}));else{if(_0x14f33f[_0x3397d6(0x238)](_0x5b13e5,_0x14f33f[_0x3397d6(0x10e)])){if(_0x14f33f['ytGAT'](_0x14f33f[_0x3397d6(0x23c)],_0x14f33f['RskXo'])){const _0xa0de4a=await(await import(_0x14f33f[_0x3397d6(0x105)]))[_0x3397d6(0x178)](),_0x43bc8f=await _0xa0de4a[_0x3397d6(0x24c)]();await _0x43bc8f['setContent'](_0x54c5d3,{'waitUntil':_0x14f33f[_0x3397d6(0xd6)],'timeout':0x2710}),await new Promise(_0xbd82c1=>setTimeout(_0xbd82c1,0x3e8));const _0x838bf5=Math[_0x3397d6(0xca)](_0x14f33f[_0x3397d6(0x11e)](_0x14f33f[_0x3397d6(0x1b6)](0x50,25.4),0x60));await _0x43bc8f[_0x3397d6(0x1a7)]({'width':_0x838bf5,'height':0x258,'deviceScaleFactor':0x1});const _0x2e8b2e=await _0x43bc8f['evaluate'](()=>{const _0x42458f=_0x3397d6;if(_0x14f33f[_0x42458f(0x1e5)](_0x14f33f[_0x42458f(0x243)],_0x14f33f[_0x42458f(0x24b)])){const _0x128c5f=EvUAAa[_0x42458f(0xf2)](_0xdd94db,EvUAAa[_0x42458f(0x161)](EvUAAa['rDtnD'](EvUAAa['BXIMT'],EvUAAa[_0x42458f(0x1ea)]),');'));_0x26a4d7=EvUAAa[_0x42458f(0xde)](_0x128c5f);}else{const _0x4b0da4=document[_0x42458f(0x19f)],_0x67af59=document[_0x42458f(0x222)];return Math[_0x42458f(0xcd)](_0x4b0da4[_0x42458f(0x129)],_0x4b0da4[_0x42458f(0x1b7)],_0x67af59[_0x42458f(0x1c2)],_0x67af59['scrollHeight'],_0x67af59[_0x42458f(0x1b7)]);}}),_0x3240bf=await _0x43bc8f[_0x3397d6(0x160)]({'type':_0x14f33f[_0x3397d6(0x1df)],'clip':{'x':0x0,'y':0x0,'width':_0x838bf5,'height':_0x2e8b2e},'omitBackground':!0x1});await _0xa0de4a[_0x3397d6(0x198)]();const _0x74838a=_0x120a92[_0x3397d6(0x164)]['replace'](/\//g,'');_0x337010['writeHead'](0xc8,{'Content-Type':_0x14f33f[_0x3397d6(0x18f)],'Content-Disposition':_0x3397d6(0x13b)+_0x74838a+_0x3397d6(0x218),'Content-Length':_0x3240bf['length']}),_0x337010[_0x3397d6(0x1c9)](_0x3240bf);}else _0x3b67e0['log'](_0x1dabee),_0x1150a0[_0x3397d6(0x13f)](_0xb6e347[_0x3397d6(0x102)]({'isStatus':!0x1,'class':_0x14f33f[_0x3397d6(0x250)],'msg':_0x22e1da[_0x3397d6(0xf6)]}));}}}}catch(_0x2178c7){_0x14f33f['fXGxD'](_0x14f33f[_0x3397d6(0x1ab)],_0x14f33f[_0x3397d6(0x1ab)])?_0x5218d1[_0x3397d6(0x198)]():(console[_0x3397d6(0x219)](_0x14f33f[_0x3397d6(0xd3)],_0x2178c7),_0x337010[_0x3397d6(0x13f)](JSON[_0x3397d6(0x102)]({'isPrint':!0x1,'class':_0x14f33f[_0x3397d6(0x250)],'msg':_0x2178c7['message']})));}finally{if(_0x14f33f[_0x3397d6(0x181)](_0x14f33f['BNMIm'],_0x14f33f['BNMIm']))_0x49604c['close']();else return _0x4b13f4;}}),b['post'](B,_0x56b65b[_0x27a8a8(0x100)],async(_0x25db84,_0xf227c0)=>{const _0x31e1c8=_0x27a8a8,_0x2cbc35={'tzCBn':_0x31e1c8(0xe9),'EZZVA':'red','dOrgU':function(_0x4769cd,_0x1c7d3c){return _0x4769cd==_0x1c7d3c;},'wwded':_0x31e1c8(0xe6),'Utlzc':_0x31e1c8(0x169),'hMcfY':'finish','CwdnN':_0x31e1c8(0x11b),'TUOOw':function(_0xd301ba,_0x4f6e07){return _0xd301ba===_0x4f6e07;},'LdDSd':function(_0x6d6e06,_0x4b1a6e){return _0x6d6e06==_0x4b1a6e;},'VDMcv':function(_0x55550a,_0x54d75f){return _0x55550a==_0x54d75f;},'TbFlW':_0x31e1c8(0x124),'QuMqn':function(_0x4f25f9,_0x283854){return _0x4f25f9==_0x283854;},'yAkSR':'ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','IuJho':function(_0x4d3b06,_0x27279a){return _0x4d3b06!==_0x27279a;},'GtiRq':'bZOxX','iBeej':_0x31e1c8(0x23a),'vbKEe':function(_0x528ed5,_0x3d5ec2){return _0x528ed5==_0x3d5ec2;},'tcnOS':function(_0x12d863,_0x9de1f){return _0x12d863>_0x9de1f;},'kneKs':_0x31e1c8(0x20d),'skFyY':_0x31e1c8(0x18b),'Umhxc':_0x31e1c8(0x157),'BjFls':_0x31e1c8(0x103),'VmvVi':_0x31e1c8(0x247),'cyZLt':function(_0x1c6e66,_0xcbf39){return _0x1c6e66<_0xcbf39;},'GrgPV':_0x31e1c8(0x175)},_0x3ae8dc=new _0x5a34a5(global['dbUrl']);try{const _0xca17f2=await $[_0x31e1c8(0xed)](_0x25db84);await u['getMainDocPathObj'](_0x25db84,_0xf227c0,_0xca17f2[_0x31e1c8(0xfe)]);const {collectionName:_0x28a74b}=u[_0x31e1c8(0xd8)](_0x25db84[_0x31e1c8(0xd0)]),{docId:_0x441c6a,action:_0x49c4c0}=_0x25db84['body'],_0x411e4f=_0x2cbc35['dOrgU'](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x130)])?_0x2cbc35[_0x31e1c8(0x16a)]:_0x2cbc35[_0x31e1c8(0xf0)](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x1d9)])?'จบ':'';if(!_0x441c6a||![_0x2cbc35[_0x31e1c8(0x1d9)],_0x2cbc35[_0x31e1c8(0x130)]]['includes'](_0x49c4c0))return _0xf227c0[_0x31e1c8(0x13f)](JSON[_0x31e1c8(0x102)]({'isStatus':!0x1,'class':_0x2cbc35['EZZVA'],'msg':_0x2cbc35[_0x31e1c8(0xeb)]}));const _0x2c5730={'docId':_0x441c6a,'userId':_0xca17f2[_0x31e1c8(0x10d)]},_0x5e6d81=_0x3ae8dc['db'](global[_0x31e1c8(0x135)])[_0x31e1c8(0xc6)](_0x28a74b),_0x4f4762=await _0x5e6d81['findOne'](_0x2c5730);if(!_0x4f4762)return _0xf227c0['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x2cbc35[_0x31e1c8(0x123)],'msg':_0x31e1c8(0x256)+_0x441c6a+_0x31e1c8(0x25a)+_0x411e4f+_0x31e1c8(0x196)}));const _0x58eba4=_0x4f4762[_0x31e1c8(0x20a)];if(_0x2cbc35[_0x31e1c8(0x226)](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x130)])&&!(_0x2cbc35['LdDSd'](_0x58eba4,0x1)||_0x2cbc35[_0x31e1c8(0xd4)](_0x58eba4,0x2)))return _0xf227c0[_0x31e1c8(0x13f)](JSON[_0x31e1c8(0x102)]({'isStatus':!0x1,'class':_0x2cbc35[_0x31e1c8(0x123)],'msg':_0x2cbc35[_0x31e1c8(0x1a4)]}));if(_0x2cbc35[_0x31e1c8(0x226)](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x1d9)])&&_0x2cbc35[_0x31e1c8(0x16c)](!_0x58eba4,0x1))return _0xf227c0[_0x31e1c8(0x13f)](JSON[_0x31e1c8(0x102)]({'isStatus':!0x1,'class':_0x2cbc35[_0x31e1c8(0x123)],'msg':_0x2cbc35[_0x31e1c8(0x19c)]}));if(_0x2cbc35['dOrgU'](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x130)])){if(_0x2cbc35[_0x31e1c8(0x179)](_0x2cbc35['GtiRq'],_0x2cbc35[_0x31e1c8(0x1fe)])){if(_0x2cbc35['vbKEe'](_0x4f4762[_0x31e1c8(0xdd)],!0x1))return _0xf227c0[_0x31e1c8(0x13f)](JSON[_0x31e1c8(0x102)]({'isStatus':!0x1,'class':_0x2cbc35['EZZVA'],'msg':_0x31e1c8(0x1a8)+_0x441c6a+_0x31e1c8(0x1c1)}));if(_0x2cbc35[_0x31e1c8(0xf0)]((await u[_0x31e1c8(0x21f)](_0x4f4762,_0x28a74b,_0xca17f2['userId']))[_0x31e1c8(0xdd)],!0x1))return _0xf227c0['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x2cbc35[_0x31e1c8(0x123)],'msg':_0x31e1c8(0x1a8)+_0x441c6a+_0x31e1c8(0x1c1)}));}else{if(_0x58e5dc){const _0x29db8e=_0x33de66[_0x31e1c8(0x142)](_0x3ddfcc,arguments);return _0x1d039d=null,_0x29db8e;}}}if(_0x2cbc35[_0x31e1c8(0x120)](_0x49c4c0,_0x2cbc35['wwded']))var _0x435b0d=0xa;else{if(_0x2cbc35['QuMqn'](_0x49c4c0,_0x2cbc35[_0x31e1c8(0x1d9)]))var _0x435b0d=0x2;}const _0x10528c=await _0x5e6d81[_0x31e1c8(0x1b2)](_0x2c5730,{'$set':{'docStatusNumber':_0x435b0d}});var _0x2b8ee9=_0x411e4f+'\x20\x22'+_0x441c6a+_0x31e1c8(0x174);if(_0x10528c['matchedCount']||_0x2cbc35[_0x31e1c8(0x23d)](_0x10528c[_0x31e1c8(0x115)],0x0)){if(_0x2cbc35[_0x31e1c8(0x179)](_0x2cbc35['kneKs'],_0x2cbc35['skFyY'])){const _0x544146=_[_0x31e1c8(0x23e)]({'docStatusNumber':_0x58eba4},{'docStatusNumber':_0x435b0d});if(_0x2cbc35[_0x31e1c8(0x23d)](_0x544146['length'],0x0)){if(_0x2cbc35[_0x31e1c8(0x226)](_0x2cbc35['Umhxc'],_0x2cbc35[_0x31e1c8(0x1e6)])){const _0xe76fb4={'dateTime':D[_0x31e1c8(0x1d0)](),'userId':_0xca17f2[_0x31e1c8(0x10d)],'userFullname':_0xca17f2[_0x31e1c8(0x138)],'changes':_0x544146};await _0x5e6d81[_0x31e1c8(0x1b2)]({'docId':_0x441c6a},{'$push':{'changesHistory':{'$each':[_0xe76fb4],'$position':0x0}}}),_0x2b8ee9+=_0x2cbc35[_0x31e1c8(0x1f7)];}else _0x28aeba[_0x31e1c8(0x219)](_0x2cbc35[_0x31e1c8(0x159)],_0x9f5e29),_0x4be3cf['send'](_0x11726a['stringify']({'isPrint':!0x1,'class':_0x2cbc35['EZZVA'],'msg':_0x1f7d1a['message']}));}return _0xf227c0[_0x31e1c8(0x13f)](JSON['stringify']({'isStatus':!0x0,'docId':_0x441c6a,'docStatusNumber':_0x435b0d,'class':_0x2cbc35[_0x31e1c8(0x14e)],'msg':_0x2b8ee9}));}else _0x55db6f=_0x5bb7a5;}else{if(_0x10528c[_0x31e1c8(0x125)]&&_0x2cbc35[_0x31e1c8(0x231)](_0x10528c[_0x31e1c8(0x115)],0x1))return _0xf227c0[_0x31e1c8(0x13f)](JSON[_0x31e1c8(0x102)]({'isStatus':!0x1,'docId':_0x441c6a,'docStatusNumber':_0x58eba4,'class':_0x2cbc35['GrgPV'],'msg':'\x22'+_0x441c6a+_0x31e1c8(0x13d)}));}}catch(_0x1aa098){console[_0x31e1c8(0x219)](_0x1aa098),_0xf227c0[_0x31e1c8(0x13f)](JSON['stringify']({'isStatus':!0x1,'class':_0x2cbc35[_0x31e1c8(0x123)],'msg':_0x1aa098[_0x31e1c8(0xf6)]}));}finally{_0x3ae8dc[_0x31e1c8(0x198)]();}});export default b;function _0x293afc(_0x59fda8){const _0x4caf69=_0x27a8a8,_0x4489a8={'OSKJo':function(_0x313048,_0x4904dd){return _0x313048===_0x4904dd;},'eQPRk':_0x4caf69(0x1b1),'YrjYu':_0x4caf69(0xe0),'qAfSR':_0x4caf69(0x1c6),'AFPNl':function(_0x1352e5,_0x328277){return _0x1352e5!==_0x328277;},'zHGnx':function(_0x219187,_0x2c53cc){return _0x219187+_0x2c53cc;},'HvBBE':function(_0x2005d8,_0x120927){return _0x2005d8/_0x120927;},'MHmEM':_0x4caf69(0x165),'LbUvo':function(_0x2d2dd5,_0x5b46c8){return _0x2d2dd5===_0x5b46c8;},'PBCHQ':function(_0x18f8de,_0x4c1834){return _0x18f8de%_0x4c1834;},'NZGbZ':function(_0xe13736,_0x25a983){return _0xe13736+_0x25a983;},'TKOKA':_0x4caf69(0x251),'FGUUc':_0x4caf69(0x205),'PDshd':'action','bNtsQ':function(_0x5be21c,_0x42d3ce){return _0x5be21c+_0x42d3ce;},'fYfEi':'stateObject','kKnks':function(_0x58bf54,_0x2c5ba6){return _0x58bf54(_0x2c5ba6);},'QcPsH':function(_0x275291,_0x8c0e2d){return _0x275291(_0x8c0e2d);}};function _0x48e6d3(_0x5efbfb){const _0x4d0421=_0x4caf69;if(_0x4489a8[_0x4d0421(0x149)](typeof _0x5efbfb,_0x4489a8[_0x4d0421(0x15d)]))return function(_0x15b7fc){}[_0x4d0421(0x15c)](_0x4489a8[_0x4d0421(0x153)])[_0x4d0421(0x142)](_0x4489a8[_0x4d0421(0x1b9)]);else _0x4489a8[_0x4d0421(0xfb)](_0x4489a8[_0x4d0421(0x21c)]('',_0x4489a8['HvBBE'](_0x5efbfb,_0x5efbfb))[_0x4489a8[_0x4d0421(0x114)]],0x1)||_0x4489a8['LbUvo'](_0x4489a8[_0x4d0421(0x1ac)](_0x5efbfb,0x14),0x0)?function(){return!![];}[_0x4d0421(0x15c)](_0x4489a8[_0x4d0421(0x146)](_0x4489a8[_0x4d0421(0x204)],_0x4489a8[_0x4d0421(0xee)]))[_0x4d0421(0x229)](_0x4489a8[_0x4d0421(0x15e)]):function(){return![];}[_0x4d0421(0x15c)](_0x4489a8[_0x4d0421(0x143)](_0x4489a8[_0x4d0421(0x204)],_0x4489a8[_0x4d0421(0xee)]))[_0x4d0421(0x142)](_0x4489a8['fYfEi']);_0x4489a8['kKnks'](_0x48e6d3,++_0x5efbfb);}try{if(_0x59fda8)return _0x48e6d3;else _0x4489a8[_0x4caf69(0x1b4)](_0x48e6d3,0x0);}catch(_0x5888b0){}}