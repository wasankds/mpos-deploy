const _0x14c3fc=_0x517c;(function(_0x24aec7,_0x13e180){const _0x171bb5=_0x517c,_0x5b5285=_0x24aec7();while(!![]){try{const _0x93e9ed=-parseInt(_0x171bb5(0x2c3))/0x1*(-parseInt(_0x171bb5(0x262))/0x2)+-parseInt(_0x171bb5(0x2a6))/0x3*(parseInt(_0x171bb5(0x223))/0x4)+parseInt(_0x171bb5(0x222))/0x5*(parseInt(_0x171bb5(0x283))/0x6)+parseInt(_0x171bb5(0x254))/0x7*(-parseInt(_0x171bb5(0x236))/0x8)+-parseInt(_0x171bb5(0x1bb))/0x9*(-parseInt(_0x171bb5(0x1db))/0xa)+parseInt(_0x171bb5(0x2ab))/0xb+parseInt(_0x171bb5(0x270))/0xc;if(_0x93e9ed===_0x13e180)break;else _0x5b5285['push'](_0x5b5285['shift']());}catch(_0x2be9ba){_0x5b5285['push'](_0x5b5285['shift']());}}}(_0x37b8,0xf3623));function _0x517c(_0x32b3b9,_0x4dd14f){const _0x3624c4=_0x37b8();return _0x517c=function(_0x68e90e,_0x4e8657){_0x68e90e=_0x68e90e-0x18d;let _0x32342c=_0x3624c4[_0x68e90e];return _0x32342c;},_0x517c(_0x32b3b9,_0x4dd14f);}const _0x4169a1=(function(){const _0x4faae0=_0x517c,_0x18a133={'abeds':'error\x20===>\x20','gpmnZ':_0x4faae0(0x26c),'nbNVp':function(_0x5dc460,_0x945ab7){return _0x5dc460!==_0x945ab7;},'Kaqid':_0x4faae0(0x225),'SUqSR':'JOZoq','fxazT':function(_0x9cd38c,_0xbcf37e){return _0x9cd38c===_0xbcf37e;},'qElKb':_0x4faae0(0x1e1),'tJruv':'QvOkt','hUsgb':_0x4faae0(0x2ce),'oJaGf':_0x4faae0(0x1bc)};let _0x577b2c=!![];return function(_0x235ecb,_0x37989d){const _0x28936e=_0x4faae0;if(_0x18a133['fxazT'](_0x18a133[_0x28936e(0x274)],_0x18a133[_0x28936e(0x303)]))_0x167e55['close']();else{const _0x279152=_0x577b2c?function(){const _0x2f1adf=_0x28936e,_0x5253a9={'VMhAd':_0x18a133[_0x2f1adf(0x285)],'CBpVH':_0x18a133['gpmnZ']};if(_0x18a133['nbNVp'](_0x18a133[_0x2f1adf(0x1ae)],_0x18a133['SUqSR'])){if(_0x37989d){if(_0x18a133[_0x2f1adf(0x29d)](_0x18a133[_0x2f1adf(0x1a6)],_0x18a133[_0x2f1adf(0x1ad)])){const _0x2d55fc=_0x77900b[_0x2f1adf(0x1da)],_0x212253=_0x1acbc3[_0x2f1adf(0x275)];return _0x541925['max'](_0x2d55fc['scrollHeight'],_0x2d55fc[_0x2f1adf(0x2d6)],_0x212253[_0x2f1adf(0x22b)],_0x212253[_0x2f1adf(0x21f)],_0x212253[_0x2f1adf(0x2d6)]);}else{const _0x54087d=_0x37989d[_0x2f1adf(0x1f9)](_0x235ecb,arguments);return _0x37989d=null,_0x54087d;}}}else _0x27c861[_0x2f1adf(0x1c2)](_0x5253a9['VMhAd'],_0x3b1d67),_0x41bcab[_0x2f1adf(0x191)](_0x3154e8[_0x2f1adf(0x19a)]({'isPrint':!0x1,'class':_0x5253a9['CBpVH'],'msg':_0x386897[_0x2f1adf(0x315)]}));}:function(){};return _0x577b2c=![],_0x279152;}};}());(function(){const _0x41d316=_0x517c,_0x4bb5e0={'CYMTp':_0x41d316(0x26c),'nUQor':function(_0x2fc243,_0x310f78){return _0x2fc243(_0x310f78);},'PPMZc':function(_0x213c7b,_0x1187b6){return _0x213c7b!==_0x1187b6;},'WmryG':_0x41d316(0x1d9),'QnOhi':_0x41d316(0x2a9),'iaNCE':_0x41d316(0x1d3),'Ilnbz':'init','GWRBH':function(_0x452907,_0x13c4a2){return _0x452907+_0x13c4a2;},'YkasV':_0x41d316(0x276),'JUCEL':function(_0x519481,_0x10b635){return _0x519481+_0x10b635;},'FIAtD':'input','Uyhhw':_0x41d316(0x1cf),'PxnDq':_0x41d316(0x1fa),'ZWFVi':function(_0x27ef0b,_0xc531d6){return _0x27ef0b(_0xc531d6);},'UKwtb':function(_0x1b2c0b,_0x5af468){return _0x1b2c0b===_0x5af468;},'GkSsl':_0x41d316(0x296),'bkUrP':function(_0x304aff){return _0x304aff();},'UAwoL':function(_0xadef93,_0x362c46,_0x44250e){return _0xadef93(_0x362c46,_0x44250e);}};_0x4bb5e0['UAwoL'](_0x4169a1,this,function(){const _0x62d08e=_0x41d316;if(_0x4bb5e0['PPMZc'](_0x4bb5e0[_0x62d08e(0x1c1)],_0x4bb5e0[_0x62d08e(0x1c1)]))return _0x4bc3d3['log'](_0x5c6642),_0x35a088[_0x62d08e(0x191)](_0x1af1e0['stringify']({'isFetch':!0x1,'class':_0x4bb5e0[_0x62d08e(0x2e6)],'msg':_0x4aca60[_0x62d08e(0x315)]}));else{const _0x10b3e3=new RegExp(_0x4bb5e0['QnOhi']),_0x3c6641=new RegExp(_0x4bb5e0['iaNCE'],'i'),_0x3f2a74=_0x4bb5e0['nUQor'](_0x109cec,_0x4bb5e0['Ilnbz']);if(!_0x10b3e3[_0x62d08e(0x1a5)](_0x4bb5e0[_0x62d08e(0x1ba)](_0x3f2a74,_0x4bb5e0[_0x62d08e(0x2dc)]))||!_0x3c6641[_0x62d08e(0x1a5)](_0x4bb5e0[_0x62d08e(0x198)](_0x3f2a74,_0x4bb5e0['FIAtD']))){if(_0x4bb5e0[_0x62d08e(0x2a5)](_0x4bb5e0[_0x62d08e(0x2d2)],_0x4bb5e0[_0x62d08e(0x294)]))_0x4bb5e0[_0x62d08e(0x27e)](_0x3f2a74,'0');else{if(_0x395c85)return _0x21ebde;else _0x4bb5e0[_0x62d08e(0x1b7)](_0xa16533,0x0);}}else{if(_0x4bb5e0[_0x62d08e(0x234)](_0x4bb5e0[_0x62d08e(0x260)],_0x4bb5e0[_0x62d08e(0x260)]))_0x4bb5e0[_0x62d08e(0x292)](_0x109cec);else return _0x4c1989[_0x62d08e(0x1c2)](_0x51d04b),_0x46deac[_0x62d08e(0x191)](_0x51348b[_0x62d08e(0x19a)]({'isSearch':!0x1,'class':_0x4bb5e0[_0x62d08e(0x2e6)],'msg':_0x5cd7db['message']}));}}})();}());const _0x4e8657=(function(){const _0x362abf=_0x517c,_0x22a6a0={'wYlYw':_0x362abf(0x26c),'syuIx':function(_0x2bd2c0,_0x2068eb){return _0x2bd2c0!==_0x2068eb;},'XQqwT':_0x362abf(0x2e2),'vMpBO':'QaoXB','MkToP':function(_0x18de4a,_0x4e7c0e){return _0x18de4a===_0x4e7c0e;},'PgLMi':_0x362abf(0x24c),'cdGUK':function(_0x48908b,_0x5dd3c8){return _0x48908b===_0x5dd3c8;},'ZlIAL':'zLVMJ'};let _0xecb973=!![];return function(_0x2faaaa,_0x5f36d7){const _0x46c0db=_0x362abf,_0x3c261e={'GrABB':_0x22a6a0[_0x46c0db(0x1e3)],'FqpQw':function(_0x29aae5,_0x4f3088){const _0x2f4d2c=_0x46c0db;return _0x22a6a0[_0x2f4d2c(0x25e)](_0x29aae5,_0x4f3088);},'NVygo':_0x22a6a0['XQqwT'],'UucJf':_0x22a6a0['vMpBO'],'UlUNW':function(_0x3dc902,_0x2479f7){const _0x409b51=_0x46c0db;return _0x22a6a0[_0x409b51(0x241)](_0x3dc902,_0x2479f7);},'DfTDX':_0x22a6a0[_0x46c0db(0x28a)]};if(_0x22a6a0[_0x46c0db(0x2df)](_0x22a6a0[_0x46c0db(0x2e4)],_0x22a6a0[_0x46c0db(0x2e4)])){const _0x307ff7=_0xecb973?function(){const _0x4c3dae=_0x46c0db;if(_0x3c261e[_0x4c3dae(0x1c4)](_0x3c261e[_0x4c3dae(0x290)],_0x3c261e[_0x4c3dae(0x249)])){if(_0x5f36d7){if(_0x3c261e['UlUNW'](_0x3c261e['DfTDX'],_0x3c261e[_0x4c3dae(0x2f8)])){const _0x4874d2=_0x5f36d7[_0x4c3dae(0x1f9)](_0x2faaaa,arguments);return _0x5f36d7=null,_0x4874d2;}else _0x37d3d3['close']();}}else return _0x46650a[_0x4c3dae(0x1c2)](_0x170b46),_0x113fee['send'](_0x312614[_0x4c3dae(0x19a)]({'isLoad':!0x1,'class':_0x3c261e[_0x4c3dae(0x20c)],'msg':_0x575149[_0x4c3dae(0x315)]}));}:function(){};return _0xecb973=![],_0x307ff7;}else{const _0x2b32d2=_0x390618?function(){const _0x668626=_0x46c0db;if(_0x2131c3){const _0x3a5585=_0x114b9a[_0x668626(0x1f9)](_0x2391a5,arguments);return _0x46d038=null,_0x3a5585;}}:function(){};return _0x598f60=![],_0x2b32d2;}};}()),_0x68e90e=_0x4e8657(this,function(){const _0x8233ed=_0x517c,_0x5dd010={'BzUTU':function(_0x447590){return _0x447590();},'XxFgb':_0x8233ed(0x256),'jdcXD':'counter','ThlzR':_0x8233ed(0x2a9),'wmVcO':_0x8233ed(0x1d3),'NJKiR':function(_0x5010ae,_0x55f1b1){return _0x5010ae(_0x55f1b1);},'VyByT':_0x8233ed(0x1e9),'iSonZ':function(_0x5e3b62,_0x13c68c){return _0x5e3b62+_0x13c68c;},'npUoM':'chain','HHxFY':_0x8233ed(0x267),'bvENt':function(_0x18ea65){return _0x18ea65();},'HXnnu':function(_0x39ffa4,_0x5842be,_0x1bb3c7){return _0x39ffa4(_0x5842be,_0x1bb3c7);},'boiWC':function(_0xab4e78,_0x56bd88){return _0xab4e78===_0x56bd88;},'ozNuK':_0x8233ed(0x1e7),'BSDhy':function(_0x1fb6df,_0x35bdca){return _0x1fb6df!==_0x35bdca;},'lWHTt':_0x8233ed(0x268),'IbsAX':function(_0x1c3401,_0x5cfce9){return _0x1c3401(_0x5cfce9);},'ljWZm':function(_0xe5b23a,_0x557783){return _0xe5b23a+_0x557783;},'PYGku':_0x8233ed(0x2b5),'zjEls':'{}.constructor(\x22return\x20this\x22)(\x20)','JauPI':function(_0x3bef08,_0x18473e){return _0x3bef08===_0x18473e;},'WKlFg':_0x8233ed(0x19b),'SRylh':'CyMyY','pqBpu':function(_0x553773,_0xf4c23b){return _0x553773(_0xf4c23b);},'iTtyj':function(_0x57d4be){return _0x57d4be();},'KqdLP':_0x8233ed(0x1c2),'iEpMh':_0x8233ed(0x1ce),'IZaBA':'info','TBLIc':_0x8233ed(0x2af),'YkBRX':'exception','XNkOO':_0x8233ed(0x226),'OgipY':_0x8233ed(0x2b9),'dxMfN':function(_0x2d079f,_0x38d910){return _0x2d079f<_0x38d910;},'oyGmn':function(_0xfff2bb,_0x200d50){return _0xfff2bb===_0x200d50;},'SgSmq':_0x8233ed(0x18d)},_0x4e7ac0=function(){const _0x2ecec5=_0x8233ed;if(_0x5dd010['boiWC'](_0x5dd010['ozNuK'],_0x5dd010[_0x2ecec5(0x2e5)])){let _0x5e5170;try{_0x5dd010['BSDhy'](_0x5dd010[_0x2ecec5(0x21e)],_0x5dd010[_0x2ecec5(0x21e)])?_0x5dd010[_0x2ecec5(0x308)](_0x5cb916):_0x5e5170=_0x5dd010['IbsAX'](Function,_0x5dd010[_0x2ecec5(0x280)](_0x5dd010[_0x2ecec5(0x242)](_0x5dd010['PYGku'],_0x5dd010[_0x2ecec5(0x248)]),');'))();}catch(_0x43b129){if(_0x5dd010[_0x2ecec5(0x1cc)](_0x5dd010[_0x2ecec5(0x21b)],_0x5dd010[_0x2ecec5(0x200)]))return function(_0x556b7b){}[_0x2ecec5(0x302)](_0x5dd010[_0x2ecec5(0x20a)])[_0x2ecec5(0x1f9)](_0x5dd010[_0x2ecec5(0x1d4)]);else _0x5e5170=window;}return _0x5e5170;}else{const _0x32cbcf={'nZAKb':_0x5dd010[_0x2ecec5(0x190)],'STwDI':_0x5dd010[_0x2ecec5(0x1e0)],'mstDA':function(_0x2f298e,_0x41272e){const _0x4c51ba=_0x2ecec5;return _0x5dd010[_0x4c51ba(0x2bf)](_0x2f298e,_0x41272e);},'qqNcR':_0x5dd010[_0x2ecec5(0x1bd)],'TjObY':function(_0x4aad57,_0x13a6b6){const _0x33c380=_0x2ecec5;return _0x5dd010[_0x33c380(0x280)](_0x4aad57,_0x13a6b6);},'glGMZ':_0x5dd010[_0x2ecec5(0x25b)],'AjNNB':function(_0x207892,_0x2e69b7){return _0x5dd010['iSonZ'](_0x207892,_0x2e69b7);},'ebzZb':_0x5dd010[_0x2ecec5(0x28c)],'LpLdJ':function(_0x2961b1){const _0x164122=_0x2ecec5;return _0x5dd010[_0x164122(0x1df)](_0x2961b1);}};_0x5dd010['HXnnu'](_0x2e390e,this,function(){const _0x1128ce=_0x2ecec5,_0x1d90a1=new _0x5ee9ec(_0x32cbcf[_0x1128ce(0x245)]),_0xce823c=new _0x3e193c(_0x32cbcf[_0x1128ce(0x229)],'i'),_0x4da2c5=_0x32cbcf[_0x1128ce(0x309)](_0x2742ff,_0x32cbcf['qqNcR']);!_0x1d90a1[_0x1128ce(0x1a5)](_0x32cbcf[_0x1128ce(0x22c)](_0x4da2c5,_0x32cbcf[_0x1128ce(0x2d5)]))||!_0xce823c['test'](_0x32cbcf[_0x1128ce(0x293)](_0x4da2c5,_0x32cbcf['ebzZb']))?_0x32cbcf[_0x1128ce(0x309)](_0x4da2c5,'0'):_0x32cbcf[_0x1128ce(0x218)](_0x48129a);})();}},_0x2b20d9=_0x5dd010[_0x8233ed(0x22e)](_0x4e7ac0),_0x4bcca7=_0x2b20d9['console']=_0x2b20d9[_0x8233ed(0x252)]||{},_0x456326=[_0x5dd010[_0x8233ed(0x1e2)],_0x5dd010[_0x8233ed(0x19c)],_0x5dd010[_0x8233ed(0x2fe)],_0x5dd010['TBLIc'],_0x5dd010[_0x8233ed(0x224)],_0x5dd010[_0x8233ed(0x2f4)],_0x5dd010[_0x8233ed(0x1b2)]];for(let _0x34d575=0x0;_0x5dd010[_0x8233ed(0x246)](_0x34d575,_0x456326['length']);_0x34d575++){if(_0x5dd010['oyGmn'](_0x5dd010[_0x8233ed(0x199)],_0x5dd010['SgSmq'])){const _0x5ab0c6=_0x4e8657['constructor'][_0x8233ed(0x2c5)]['bind'](_0x4e8657),_0x30d219=_0x456326[_0x34d575],_0x5a2968=_0x4bcca7[_0x30d219]||_0x5ab0c6;_0x5ab0c6[_0x8233ed(0x192)]=_0x4e8657[_0x8233ed(0x258)](_0x4e8657),_0x5ab0c6['toString']=_0x5a2968['toString'][_0x8233ed(0x258)](_0x5a2968),_0x4bcca7[_0x30d219]=_0x5ab0c6;}else{const _0x3f91ed=new _0x5aa869(_0x5dd010[_0x8233ed(0x190)]),_0x5e2679=new _0x5b2b71(_0x5dd010[_0x8233ed(0x1e0)],'i'),_0x257fac=_0x5dd010[_0x8233ed(0x2a8)](_0x5a8252,_0x5dd010[_0x8233ed(0x1bd)]);!_0x3f91ed[_0x8233ed(0x1a5)](_0x5dd010['ljWZm'](_0x257fac,_0x5dd010[_0x8233ed(0x25b)]))||!_0x5e2679[_0x8233ed(0x1a5)](_0x5dd010['ljWZm'](_0x257fac,_0x5dd010['HHxFY']))?_0x5dd010['pqBpu'](_0x257fac,'0'):_0x5dd010[_0x8233ed(0x308)](_0x505ef9);}}});_0x68e90e();import _0x49121b from'express';const b=_0x49121b[_0x14c3fc(0x196)]();import _0x1928ba from'path';import{MongoClient as _0x55ff0f}from'mongodb';import _0x4b7acf from'../middleware/mainAuth.js';const C=await import(_0x14c3fc(0x1dc)+mymoduleFolder+_0x14c3fc(0x27a)),E=await import(_0x14c3fc(0x1dc)+mymoduleFolder+_0x14c3fc(0x1fd)),T=await import('../'+mymoduleFolder+_0x14c3fc(0x2ad)),u=await import(_0x14c3fc(0x1dc)+mymoduleFolder+_0x14c3fc(0x1ea)),m=await import(_0x14c3fc(0x1dc)+mymoduleFolder+'/myDocMain.js'),p=global[_0x14c3fc(0x205)],S=global[_0x14c3fc(0x2ca)],w=global[_0x14c3fc(0x282)],_=global[_0x14c3fc(0x2f7)],v=[p+_0x14c3fc(0x2fa),S+'/fetch/modal',w+_0x14c3fc(0x2fa),_+_0x14c3fc(0x2fa)],k=[p+_0x14c3fc(0x250),S+_0x14c3fc(0x250),w+_0x14c3fc(0x250),_+_0x14c3fc(0x250)],L=[p+_0x14c3fc(0x2a4),S+_0x14c3fc(0x2a4),w+_0x14c3fc(0x2a4),_+_0x14c3fc(0x2a4)],B=[p+_0x14c3fc(0x2b2),S+_0x14c3fc(0x2b2),w+_0x14c3fc(0x2b2),_+_0x14c3fc(0x2b2)],Y=[p+_0x14c3fc(0x1d1),S+'/search',w+_0x14c3fc(0x1d1),_+_0x14c3fc(0x1d1)],x=[p+_0x14c3fc(0x22d),S+_0x14c3fc(0x22d),w+'/load',_+_0x14c3fc(0x22d),p+_0x14c3fc(0x30b),S+_0x14c3fc(0x30b),w+'/load-last',_+_0x14c3fc(0x30b)];function _0x37b8(){const _0x31eb5c=['iEpMh','KuVaf','\x22\x20เอกสาร','NaPMF','mPpve','uDfCT','ไม่พบเอกสารล่าสุด','stateObject','HAzDV','test','qElKb','doc_print.ejs','iIRHg','getItemsCategory','connect','BiDCU','dbName','tJruv','Kaqid','tcPmn','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','XUcAv','OgipY','uzrrU','wDfVa','launch','PAY_TYPE','nUQor','max','check_DocDateTime_CanCancel','GWRBH','4158495KTURMM','VaiYB','VyByT','nrGcu','green','userFullname','WmryG','log','toString','FqpQw','hXqtz','getMainDocPathObj','branchName','setContent','EEkvs','mSMCT','PHPbR','JauPI','TATDG','warn','mzOHB','DyGhw','/search','ueaqv','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','jdcXD','bzbWG','dateTimeCanCancel','YcrBH','getSuppliers_for_Modal','QBuYJ','body','10nupnJW','../','statusName','LPMjq','bvENt','wmVcO','ASMmd','KqdLP','wYlYw','hgjDk','HpGJG','XLgoT','tBOLd','wValr','init','/myData.js','MoUDe','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','UcEhD','bGpfz','dbUrl','ZigLu','userId','qPAbK','includes','yellow','twHPa','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','oGvnk','MfTSw','apply','pbBxA','qHscF','ysIVT','/myDateTime.js','userAuthority','TsDEx','SRylh','Gimct','WyoKk','sales','paymentMethod2','PATH_WAREHOUSE_IN','SeIpQ','lbpMJ','kFypV','warehouseOut','XxFgb','kiyGn','GrABB','GRQWe','docTitle','FQgRu','RlaKv','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','jULyS','ประวัติการแก้ไขเอกสาร\x20:\x20','jzhBX','wZjNx','mGJzn','asbHy','LpLdJ','Wxing','print','WKlFg','load','docStatusNumber','lWHTt','scrollHeight','TXbah','cancel','4040885iiGeEq','63368YIXvye','YkBRX','sOeSD','table','ysXvx','lXXLg','STwDI','gtfSH','clientHeight','TjObY','/load','iTtyj','ETOjH','ไม่พบเอกสารเลขที่\x20\x22','gOhfQ','paymentMethod2Name','DOC_TYPE','UKwtb','vNPpf','43104bsbRys','\x22\x20มีบันทึกชำระหนี้แล้ว{{sep}}ไม่สามารถยกเลิกได้','\x22\x20เรียบร้อยแล้ว','paytype','join','ehtvg','ยกเลิก','setViewport','QVYKq','path','eAmmT','MkToP','ljWZm','gger','PCKMg','nZAKb','dxMfN','zjmCE','zjEls','UucJf','DtkFN','QefVv','vDsYr','JnBMz','LuBgy','{}.constructor(\x22return\x20this\x22)(\x20)','/changes','XfkWs','console','FAhig','308xbzuzz','RiHrv','while\x20(true)\x20{}','get_Info_ByPath','bind','image','post','npUoM','canEdit','เอกสารที่ตันเองไม่ได้สร้าง','syuIx','aELQO','GkSsl','call','2yFtKba','jHRTl','XLNgZ','gcMhA','paymentMethod1','input','EtPrW','vkitY','load-last','qXOxe','red','dErNv','aYHIB','hgKGA','81744IzaECz','ukEAl','BPwNN','doc_changes.ejs','hUsgb','documentElement','chain','updateOne','ไม่พบประวัติการเปลี่ยนแปลง','return','/myModule.js','hpgUm','JZQoh','uWsQY','ZWFVi','matchedCount','iSonZ','CqQuH','PATH_SALES','6TzbUyS','PbBbO','abeds','OgHdn','daXTs','xhmkV','image/jpeg','PgLMi','getDateTime','HHxFY','XbSzJ','MFKSw','error\x20===>\x20','NVygo','close','bkUrP','AjNNB','PxnDq','dBruV','moGcd','get_StatusName_byStatusNumber','tpTZI','MGLQR','KdZvK','findOne','emwSV','fxazT','DnJLc','isAuth','Gxbaz','xQTqE','find','mpLLL','/print','PPMZc','255avjHDL','DNLuN','IbsAX','function\x20*\x5c(\x20*\x5c)','EdENR','9523558qrazVK','modifiedCount','/myUsers.js','canCancel','error','JWcFq','aDePw','/status','sZErl','Jylbd','return\x20(function()\x20','xXnGG','dateTimeEditRemain','cuODL','trace','branchId','dnEvv','wwpRU','finish','vCeUV','NJKiR','ELFVK','เอกสาร\x20\x22','XSQyP','437719HmyNhd','bnHRQ','prototype','payTypeThai','GtEdP','getItems_for_Modal','string','PATH_WAREHOUSE_OUT','paymentMethod1Name','XpRUl','counter','BtvEH','BPxur','length','collection','Uyhhw','WAMCC','PyBpw','glGMZ','offsetHeight','{{sep}}หรือไม่มีสิทธิ์','JTlLW','StgVV','xPYbp','writeHead','YkasV','odKGe','evaluate','cdGUK','getSessionData','tOKQY','sRijK','aggregate','ZlIAL','ozNuK','CYMTp','fJjPf','EeEyU','OFRSi','svWfm','MGZhX','getSettings','ไม่พบเอกสาร\x20\x22','พบ\x20\x22','getUserData','changesHistory','convert_DocPrint','Hssff','bqUOV','XNkOO','xQfqD','oWCXo','PATH_RETURN','DfTDX','action','/fetch/modal','vfOTI','waqhQ','FJlVS','IZaBA','docId','WrVsp','get','constructor','oJaGf','folderForms','GFiOS','APvNT','\x20ไม่เปลี่ยนแปลง\x22','BzUTU','mstDA','MdEJY','/load-last','sDZls','JntnQ','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','replace','gBudp','payDebtRows','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','YqKtl','end','message','rZAvk','ikrIm','VDOui','puppeteer','ThlzR','send','__proto__','attachment;\x20filename=','collectionName','dateTimeCancelRemain','Router','\x22\x20{{sep}}เรียบร้อยแล้ว','JUCEL','SgSmq','stringify','NkdnB'];_0x37b8=function(){return _0x31eb5c;};return _0x37b8();}b[_0x14c3fc(0x301)](v,_0x4b7acf[_0x14c3fc(0x29f)],async(_0x32cb45,_0x4c332f)=>{const _0x2c2f1f=_0x14c3fc,_0xb738a6={'xXnGG':function(_0x566c79,_0x2398bf){return _0x566c79(_0x2398bf);},'FQgRu':function(_0x2b0666,_0x5edc34){return _0x2b0666+_0x5edc34;},'YqKtl':function(_0x1c7d0e,_0x35c7cb){return _0x1c7d0e+_0x35c7cb;},'OFRSi':_0x2c2f1f(0x2b5),'NJVvS':_0x2c2f1f(0x24f),'jULyS':function(_0x1e4a3b,_0x5c10d0){return _0x1e4a3b!==_0x5c10d0;},'wZjNx':_0x2c2f1f(0x287),'gcMhA':_0x2c2f1f(0x235),'gBudp':function(_0x1cf3d1,_0xa75486){return _0x1cf3d1==_0xa75486;},'TsDEx':'warehouseIn','wwpRU':'stock','aYHIB':'active','dnEvv':function(_0x318f8f,_0x202342){return _0x318f8f==_0x202342;},'ETOjH':_0x2c2f1f(0x209),'wXbNG':function(_0x4da6c5,_0x44c1d0){return _0x4da6c5==_0x44c1d0;},'MfTSw':_0x2c2f1f(0x203),'FAhig':_0x2c2f1f(0x279),'UhLiP':'green','uCaSD':_0x2c2f1f(0x1b0),'LuBgy':function(_0x5e0ce4,_0xe624a9){return _0x5e0ce4===_0xe624a9;},'bnHRQ':_0x2c2f1f(0x2c2),'eAmmT':_0x2c2f1f(0x22a),'dErNv':_0x2c2f1f(0x26c)},_0x3c8c5a=await T[_0x2c2f1f(0x2e0)](_0x32cb45),_0x37fb70=await m['getMainDocPathObj'](_0x32cb45,_0x4c332f,_0x3c8c5a[_0x2c2f1f(0x1fe)]);try{if(_0xb738a6[_0x2c2f1f(0x212)](_0xb738a6[_0x2c2f1f(0x215)],_0xb738a6[_0x2c2f1f(0x265)])){if(_0xb738a6[_0x2c2f1f(0x310)](_0x37fb70[_0x2c2f1f(0x233)],_0xb738a6[_0x2c2f1f(0x1ff)]))var _0x5b6b22=await u[_0x2c2f1f(0x2c8)](_0xb738a6['wwpRU']),_0x517d5f=await u[_0x2c2f1f(0x1d8)](_0xb738a6['aYHIB']);else{if(_0xb738a6[_0x2c2f1f(0x2bb)](_0x37fb70['DOC_TYPE'],_0xb738a6[_0x2c2f1f(0x22f)]))var _0x5b6b22=await u[_0x2c2f1f(0x2c8)](_0xb738a6[_0x2c2f1f(0x2bc)]),_0x517d5f=[];else{if(_0xb738a6['wXbNG'](_0x37fb70[_0x2c2f1f(0x233)],_0xb738a6[_0x2c2f1f(0x1f8)]))var _0x5b6b22=await u['getItems_for_Modal'](_0xb738a6[_0x2c2f1f(0x26e)],_0x3c8c5a['branchId']),_0x517d5f=[];else{if(_0xb738a6['wXbNG'](_0x37fb70[_0x2c2f1f(0x233)],_0xb738a6[_0x2c2f1f(0x253)]))var _0x5b6b22=await u['getItems_for_Modal'](_0xb738a6['aYHIB'],_0x3c8c5a[_0x2c2f1f(0x2ba)]),_0x517d5f=[];}}}const _0x480300=await u[_0x2c2f1f(0x1a9)]();return _0x4c332f[_0x2c2f1f(0x191)](JSON[_0x2c2f1f(0x19a)]({'DATA_ITEMS':_0x5b6b22,'DATA_CATEGORY':_0x480300,'DATA_SUPPLIERS':_0x517d5f,'isFetch':!0x0,'class':_0xb738a6['UhLiP'],'msg':_0xb738a6['uCaSD']}));}else{let _0x28a6f3;try{_0x28a6f3=RGUtcK[_0x2c2f1f(0x2b6)](_0x586af1,RGUtcK[_0x2c2f1f(0x20f)](RGUtcK[_0x2c2f1f(0x313)](RGUtcK[_0x2c2f1f(0x2e9)],RGUtcK['NJVvS']),');'))();}catch(_0x302871){_0x28a6f3=_0x361845;}return _0x28a6f3;}}catch(_0x2bbf4a){if(_0xb738a6[_0x2c2f1f(0x24e)](_0xb738a6[_0x2c2f1f(0x2c4)],_0xb738a6[_0x2c2f1f(0x240)]))_0x176c0f=_0x372dcc;else return console[_0x2c2f1f(0x1c2)](_0x2bbf4a),_0x4c332f[_0x2c2f1f(0x191)](JSON['stringify']({'isFetch':!0x1,'class':_0xb738a6[_0x2c2f1f(0x26d)],'msg':_0x2bbf4a[_0x2c2f1f(0x315)]}));}}),b[_0x14c3fc(0x25a)](Y,_0x4b7acf[_0x14c3fc(0x29f)],async(_0x286ed7,_0x22943e)=>{const _0xe46bef=_0x14c3fc,_0x4e6145={'fJjPf':function(_0x6371c3,_0x2d9758){return _0x6371c3+_0x2d9758;},'HAzDV':'debu','dBruV':_0xe46bef(0x243),'BPwNN':_0xe46bef(0x1a3),'ZigLu':_0xe46bef(0x28f),'bGpfz':_0xe46bef(0x26c),'xQTqE':function(_0x9a03bb,_0xebf00a){return _0x9a03bb(_0xebf00a);},'PbBbO':function(_0x32c133,_0x4d1ab3){return _0x32c133<_0x4d1ab3;},'DyGhw':_0xe46bef(0x1f4),'Hssff':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','WyoKk':function(_0x588c3f,_0x2ccead){return _0x588c3f!==_0x2ccead;},'DtkFN':_0xe46bef(0x281),'tOKQY':'{{sep}}[\x20ค้นหาเฉพาะในสาขาตนเอง\x20]','Wxing':function(_0x3c1f72,_0x288305){return _0x3c1f72+_0x288305;},'iXkbs':'green','XfkWs':'ZrUke','EeEyU':function(_0x5c2a5f,_0x2a90ed){return _0x5c2a5f===_0x2a90ed;},'StgVV':_0xe46bef(0x2d8)};let {sip:_0xa37d72}=_0x286ed7['body'];if(!_0xa37d72&&_0x4e6145[_0xe46bef(0x284)](_0xa37d72[_0xe46bef(0x2d0)],0x2))return _0x22943e[_0xe46bef(0x191)](JSON[_0xe46bef(0x19a)]({'isSearch':!0x1,'class':_0x4e6145[_0xe46bef(0x1d0)],'msg':_0x4e6145[_0xe46bef(0x2f2)]}));_0xa37d72=_0xa37d72[_0xe46bef(0x30f)](/[!@#$%^&*<>]/g,'')??null;const _0x14b3d3=await T['getUserData'](_0x286ed7);await m[_0xe46bef(0x1c6)](_0x286ed7,_0x22943e,_0x14b3d3[_0xe46bef(0x1fe)]);const _0x5836c5=m[_0xe46bef(0x257)](_0x286ed7['path']),_0x19917d=new _0x55ff0f(global['dbUrl']);try{if(_0x4e6145[_0xe46bef(0x202)](_0x4e6145[_0xe46bef(0x24a)],_0x4e6145[_0xe46bef(0x24a)]))(function(){return![];}[_0xe46bef(0x302)](hpBoiO[_0xe46bef(0x2e7)](hpBoiO[_0xe46bef(0x1a4)],hpBoiO[_0xe46bef(0x295)]))[_0xe46bef(0x1f9)](hpBoiO[_0xe46bef(0x272)]));else{await _0x19917d[_0xe46bef(0x1aa)]();const _0x3be9fe=_0x19917d['db'](global['dbName'])[_0xe46bef(0x2d1)](_0x5836c5[_0xe46bef(0x194)]),_0x324368=[{'$or':[{'docId':{'$regex':_0xa37d72,'$options':'i'}},{'docDateTime':{'$regex':_0xa37d72,'$options':'i'}}]}];let _0x51376f='';['O','S'][_0xe46bef(0x1f3)](_0x14b3d3[_0xe46bef(0x1fe)])||(_0x51376f+=_0x4e6145[_0xe46bef(0x2e1)],_0x324368['push']({'branchId':_0x14b3d3[_0xe46bef(0x2ba)]}));const _0x191cd8=await _0x3be9fe[_0xe46bef(0x2e3)]([{'$match':{'$and':_0x324368}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])['toArray']();return _0x51376f=_0x4e6145[_0xe46bef(0x219)](_0xe46bef(0x2ee)+_0x191cd8[_0xe46bef(0x2d0)]+_0xe46bef(0x19e),_0x51376f),_0x22943e['send'](JSON['stringify']({'searchFound':_0x191cd8,'msg':_0x51376f,'isSearch':!0x0,'class':_0x4e6145['iXkbs']}));}}catch(_0x5f4570){if(_0x4e6145[_0xe46bef(0x202)](_0x4e6145[_0xe46bef(0x251)],_0x4e6145[_0xe46bef(0x251)]))_0x1e8c9c['log'](_0x4e6145[_0xe46bef(0x1f0)],_0x3d481e),_0x45d248[_0xe46bef(0x191)](_0x25f399[_0xe46bef(0x19a)]({'isPrint':!0x1,'class':_0x4e6145[_0xe46bef(0x1ee)],'msg':_0x447eab[_0xe46bef(0x315)]}));else return console['log'](_0x5f4570),_0x22943e[_0xe46bef(0x191)](JSON['stringify']({'isSearch':!0x1,'class':_0x4e6145[_0xe46bef(0x1ee)],'msg':_0x5f4570[_0xe46bef(0x315)]}));}finally{_0x4e6145[_0xe46bef(0x2e8)](_0x4e6145['StgVV'],_0x4e6145[_0xe46bef(0x2d9)])?_0x19917d[_0xe46bef(0x291)]():hpBoiO[_0xe46bef(0x2a1)](_0x49292d,'0');}}),b[_0x14c3fc(0x25a)](x,_0x4b7acf['isAuth'],async(_0xfab9f,_0x443ec0)=>{const _0x2a5306=_0x14c3fc,_0x26553b={'bzbWG':function(_0x37ea90,_0x1a4133){return _0x37ea90+_0x1a4133;},'VDOui':'debu','OgHdn':_0x2a5306(0x243),'QefVv':_0x2a5306(0x2f9),'PyBpw':function(_0x143be7,_0x5b289a){return _0x143be7===_0x5b289a;},'sDZls':_0x2a5306(0x2a7),'NJKaQ':_0x2a5306(0x23b),'uWsQY':function(_0x341b51,_0x4c76be){return _0x341b51===_0x4c76be;},'lbpMJ':_0x2a5306(0x21c),'asbHy':function(_0x467963,_0x56e264){return _0x467963!==_0x56e264;},'qHscF':'aMRoG','RLfUB':function(_0x502b43,_0x4272e1){return _0x502b43===_0x4272e1;},'Gxbaz':_0x2a5306(0x26a),'jHRTl':function(_0x4c5db3,_0x4b2509){return _0x4c5db3===_0x4b2509;},'qPAbK':_0x2a5306(0x1a2),'MdEJY':'red','QVYKq':function(_0x18f151,_0x3de001){return _0x18f151==_0x3de001;},'GtEdP':_0x2a5306(0x29a),'WqIew':_0x2a5306(0x211),'XbSzJ':_0x2a5306(0x2f3),'zDCUw':_0x2a5306(0x1bf),'PvoMJ':function(_0x28fc07,_0x487b8d){return _0x28fc07===_0x487b8d;},'JntnQ':_0x2a5306(0x1be),'YcrBH':function(_0x3c9bb4,_0x126af8){return _0x3c9bb4===_0x126af8;},'RlaKv':_0x2a5306(0x1fc)};let {docId:_0x2515c3,action:_0x2fa488}=_0xfab9f[_0x2a5306(0x1da)];const _0xa2ce76=await T[_0x2a5306(0x2ef)](_0xfab9f);await m[_0x2a5306(0x1c6)](_0xfab9f,_0x443ec0,_0xa2ce76[_0x2a5306(0x1fe)]);const _0x605d26=m['get_Info_ByPath'](_0xfab9f['path']),_0xb5cea5=new _0x55ff0f(global['dbUrl']);try{if(_0x26553b[_0x2a5306(0x2d4)](_0x26553b[_0x2a5306(0x30c)],_0x26553b['NJKaQ']))return!![];else{await _0xb5cea5[_0x2a5306(0x1aa)]();const _0x5b4775=_0xb5cea5['db'](global[_0x2a5306(0x1ac)])[_0x2a5306(0x2d1)](_0x605d26[_0x2a5306(0x194)]);if(_0x26553b[_0x2a5306(0x27d)](_0x2fa488,_0x26553b[_0x2a5306(0x207)])){if(_0x26553b[_0x2a5306(0x217)](_0x26553b[_0x2a5306(0x1fb)],_0x26553b[_0x2a5306(0x1fb)])){const _0x15fbbc=_0x2f179c[_0x2a5306(0x302)][_0x2a5306(0x2c5)][_0x2a5306(0x258)](_0x47610e),_0x186ed8=_0xe96d[_0x36e6fd],_0x14615e=_0x352adc[_0x186ed8]||_0x15fbbc;_0x15fbbc[_0x2a5306(0x192)]=_0x5416da[_0x2a5306(0x258)](_0x5bdedf),_0x15fbbc[_0x2a5306(0x1c3)]=_0x14615e[_0x2a5306(0x1c3)][_0x2a5306(0x258)](_0x14615e),_0x18c608[_0x186ed8]=_0x15fbbc;}else{const _0x237450=['O','S'][_0x2a5306(0x1f3)](_0xa2ce76[_0x2a5306(0x1fe)])?{'docId':_0x2515c3}:{'docId':_0x2515c3,'branchId':_0xa2ce76[_0x2a5306(0x2ba)]};var _0x3ece2a=await _0x5b4775['findOne'](_0x237450,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x26553b['RLfUB'](_0x2fa488,_0x26553b[_0x2a5306(0x2a0)]))var _0x3ece2a=await _0x5b4775[_0x2a5306(0x29b)]({'userId':_0xa2ce76[_0x2a5306(0x1f1)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x4b0968=_0x3ece2a?'':_0x26553b[_0x2a5306(0x263)](_0x2fa488,_0x26553b[_0x2a5306(0x207)])?_0x2a5306(0x230)+_0x2515c3+'\x22':_0x26553b[_0x2a5306(0x1f2)];if(!_0x3ece2a)return _0x443ec0[_0x2a5306(0x191)](JSON[_0x2a5306(0x19a)]({'isLoad':!0x1,'class':_0x26553b[_0x2a5306(0x30a)],'msg':_0x4b0968}));if(_0x26553b[_0x2a5306(0x23e)](_0x3ece2a[_0x2a5306(0x21d)],0x1)&&_0x3ece2a['dateTimeCanEdit']){if(_0x26553b[_0x2a5306(0x263)](_0x26553b[_0x2a5306(0x2c7)],_0x26553b['GtEdP'])){let _0x3f5408=await m['check_DocDateTime_CanEdit'](_0x3ece2a,_0x605d26[_0x2a5306(0x194)],_0xa2ce76[_0x2a5306(0x1f1)]);_0x3ece2a[_0x2a5306(0x2b7)]=_0x3f5408[_0x2a5306(0x2b7)],_0x26553b[_0x2a5306(0x23e)](_0x3f5408[_0x2a5306(0x25c)],!0x1)&&(_0x3ece2a[_0x2a5306(0x21d)]=_0x3f5408['docStatusNumber'],msg+=_0x26553b['WqIew']);}else _0x3051a9['close']();}if((_0x26553b['QVYKq'](_0x3ece2a['docStatusNumber'],0x1)||_0x26553b[_0x2a5306(0x23e)](_0x3ece2a[_0x2a5306(0x21d)],0x2))&&_0x3ece2a[_0x2a5306(0x1d6)]){if(_0x26553b[_0x2a5306(0x2d4)](_0x26553b[_0x2a5306(0x28d)],_0x26553b[_0x2a5306(0x28d)])){const _0xa9a7d9=await m[_0x2a5306(0x1b9)](_0x3ece2a,_0x605d26[_0x2a5306(0x194)],_0xa2ce76[_0x2a5306(0x1f1)]);_0x3ece2a[_0x2a5306(0x195)]=_0xa9a7d9['dateTimeCancelRemain'];}else(function(){return!![];}[_0x2a5306(0x302)](BvCuEt[_0x2a5306(0x1d5)](BvCuEt[_0x2a5306(0x18e)],BvCuEt[_0x2a5306(0x286)]))[_0x2a5306(0x261)](BvCuEt[_0x2a5306(0x24b)]));}const {branchName:_0x42ba0c}=await u['getUserBranchesById'](_0x3ece2a[_0x2a5306(0x2ba)]);return _0x3ece2a[_0x2a5306(0x1c7)]=_0x42ba0c,_0x443ec0[_0x2a5306(0x191)](JSON['stringify']({'doc':_0x3ece2a,'isLoad':!0x0,'class':_0x26553b['zDCUw'],'msg':'โหลดเอกสารเลขที่\x20\x22'+_0x3ece2a['docId']+_0x2a5306(0x197),'userId':_0xa2ce76[_0x2a5306(0x1f1)],'userAuthority':_0xa2ce76['userAuthority']}));}}catch(_0x17549e){if(_0x26553b['PvoMJ'](_0x26553b[_0x2a5306(0x30d)],_0x26553b[_0x2a5306(0x30d)]))return console[_0x2a5306(0x1c2)](_0x17549e),_0x443ec0[_0x2a5306(0x191)](JSON[_0x2a5306(0x19a)]({'isLoad':!0x1,'class':_0x26553b[_0x2a5306(0x30a)],'msg':_0x17549e['message']}));else _0x3f087f[_0x2a5306(0x291)]();}finally{if(_0x26553b[_0x2a5306(0x1d7)](_0x26553b[_0x2a5306(0x210)],_0x26553b[_0x2a5306(0x210)]))_0xb5cea5[_0x2a5306(0x291)]();else{const _0x35e039=_0x59e35a[_0x2a5306(0x1f9)](_0x5379d4,arguments);return _0x1d8261=null,_0x35e039;}}}),b[_0x14c3fc(0x25a)](k,_0x4b7acf[_0x14c3fc(0x29f)],async(_0x3425f5,_0x221496)=>{const _0x27c095=_0x14c3fc,_0x5e5ac4={'JnBMz':function(_0x414491,_0x469bc9){return _0x414491(_0x469bc9);},'gmRgw':function(_0x219dc9,_0x1b3ad2){return _0x219dc9+_0x1b3ad2;},'emwSV':function(_0x5f0d43,_0x15e3f6){return _0x5f0d43+_0x15e3f6;},'YCjmX':_0x27c095(0x2b5),'wBByx':_0x27c095(0x24f),'rZAvk':function(_0x50bed5,_0x48d733){return _0x50bed5!==_0x48d733;},'JWcFq':_0x27c095(0x2dd),'ELFVK':_0x27c095(0x26c),'oGvnk':function(_0x12edba,_0x39a2a5){return _0x12edba<_0x39a2a5;},'iIRHg':'yellow','IrZqh':_0x27c095(0x278),'EdENR':_0x27c095(0x273),'twHPa':'green','RiHrv':function(_0x510756,_0x4dc668){return _0x510756===_0x4dc668;},'Gimct':'YUSPJ','UcEhD':_0x27c095(0x28f),'rBMBf':function(_0x535d4c,_0x44519b){return _0x535d4c===_0x44519b;},'SeIpQ':_0x27c095(0x1cd)},{docId:_0x1f41a3}=_0x3425f5['body'],_0x529ae5=await T[_0x27c095(0x2e0)](_0x3425f5);await m[_0x27c095(0x1c6)](_0x3425f5,_0x221496,_0x529ae5[_0x27c095(0x1fe)]);const {collectionName:_0x4b3449}=m[_0x27c095(0x257)](_0x3425f5['path']),_0x1d8ee4=new _0x55ff0f(global['dbUrl']);try{if(_0x5e5ac4[_0x27c095(0x316)](_0x5e5ac4['JWcFq'],_0x5e5ac4[_0x27c095(0x2b0)]))xmKCLF[_0x27c095(0x24d)](_0x8fe8c1,0x0);else{await _0x1d8ee4[_0x27c095(0x1aa)]();var _0x4768e2=await _0x1d8ee4['db'](global[_0x27c095(0x1ac)])[_0x27c095(0x2d1)](_0x4b3449)[_0x27c095(0x29b)]({'docId':_0x1f41a3});if(!_0x4768e2)return _0x221496['send'](JSON[_0x27c095(0x19a)]({'isPrint':!0x1,'class':_0x5e5ac4[_0x27c095(0x2c0)],'msg':_0x27c095(0x230)+_0x1f41a3+'\x22'}));const _0x1f95a2=_0x4768e2[_0x27c095(0x2f0)]||[];if(_0x5e5ac4[_0x27c095(0x1f7)](_0x1f95a2['length'],0x1))return _0x221496[_0x27c095(0x191)](JSON[_0x27c095(0x19a)]({'isPrint':!0x1,'class':_0x5e5ac4[_0x27c095(0x1a8)],'msg':_0x5e5ac4['IrZqh']}));const _0x3c2506=_0x1928ba[_0x27c095(0x23a)](folderForms,_0x5e5ac4[_0x27c095(0x2aa)]),_0xb2bf3b=await C['renderView'](_0x3c2506,_0x221496,{'title':_0x27c095(0x213)+_0x4768e2[_0x27c095(0x2ff)],'time':E[_0x27c095(0x28b)](),'changesHistory':_0x1f95a2});_0x221496['send'](JSON[_0x27c095(0x19a)]({'isPrint':!0x0,'class':_0x5e5ac4[_0x27c095(0x1f5)],'htmlPage':_0xb2bf3b}));}}catch(_0x2049cd){_0x5e5ac4[_0x27c095(0x255)](_0x5e5ac4[_0x27c095(0x201)],_0x5e5ac4[_0x27c095(0x201)])?(console[_0x27c095(0x1c2)](_0x5e5ac4[_0x27c095(0x1ed)],_0x2049cd),_0x221496[_0x27c095(0x191)](JSON['stringify']({'isPrint':!0x1,'class':_0x5e5ac4[_0x27c095(0x2c0)],'msg':_0x2049cd[_0x27c095(0x315)]}))):_0x2b6123=xmKCLF[_0x27c095(0x24d)](_0x95c020,xmKCLF['gmRgw'](xmKCLF[_0x27c095(0x29c)](xmKCLF['YCjmX'],xmKCLF['wBByx']),');'))();}finally{if(_0x5e5ac4['rBMBf'](_0x5e5ac4[_0x27c095(0x206)],_0x5e5ac4[_0x27c095(0x206)]))_0x1d8ee4['close']();else{if(_0x3e6729){const _0x3b501e=_0x3f22c5[_0x27c095(0x1f9)](_0x356978,arguments);return _0x3b7b7a=null,_0x3b501e;}}}}),b[_0x14c3fc(0x25a)](L,_0x4b7acf['isAuth'],async(_0x174030,_0x4c0750)=>{const _0x5dbc66=_0x14c3fc,_0x5e84b={'MGLQR':'red','mPpve':function(_0x4c55a1,_0x4dad9a){return _0x4c55a1!==_0x4dad9a;},'TXbah':_0x5dbc66(0x216),'XpRUl':_0x5dbc66(0x2b1),'mSMCT':function(_0x4880b2,_0x11031a){return _0x4880b2===_0x11031a;},'waqhQ':'RLfTv','Jylbd':_0x5dbc66(0x1a7),'HpGJG':function(_0x1bdb4d,_0x295a98){return _0x1bdb4d==_0x295a98;},'jkCdz':_0x5dbc66(0x21a),'ehjqK':_0x5dbc66(0x1bf),'pfXRb':_0x5dbc66(0x259),'MoUDe':_0x5dbc66(0x1e6),'cuODL':_0x5dbc66(0x300),'PCKMg':_0x5dbc66(0x18f),'ueaqv':'networkidle0','xPYbp':function(_0x3a2cfb,_0x1fcc09){return _0x3a2cfb*_0x1fcc09;},'BiDCU':function(_0x132ff7,_0x3dbdbf){return _0x132ff7/_0x3dbdbf;},'EEkvs':'jpeg','uDfCT':_0x5dbc66(0x289),'jzhBX':function(_0x5090b0,_0x2e404d){return _0x5090b0!==_0x2e404d;},'uzrrU':_0x5dbc66(0x26b),'fMwFc':_0x5dbc66(0x28f),'gOhfQ':function(_0x5c2d09,_0x3facd5){return _0x5c2d09===_0x3facd5;},'oWCXo':'dTvHd','GRQWe':_0x5dbc66(0x2f5)},{docId:_0x263dd6,action:_0x43c9d7}=_0x174030[_0x5dbc66(0x1da)],_0x46b692=await T[_0x5dbc66(0x2e0)](_0x174030);await m[_0x5dbc66(0x1c6)](_0x174030,_0x4c0750,_0x46b692['userAuthority']);const {collectionName:_0x4273d6,docTitle:_0x51a2f4,docType:_0x3e3e1e}=m['get_Info_ByPath'](_0x174030[_0x5dbc66(0x23f)]),_0x3e050e=new _0x55ff0f(global[_0x5dbc66(0x1ef)]);try{if(_0x5e84b[_0x5dbc66(0x1ca)](_0x5e84b[_0x5dbc66(0x2fc)],_0x5e84b[_0x5dbc66(0x2fc)])){await _0x3e050e[_0x5dbc66(0x1aa)]();var _0x2a736e=await _0x3e050e['db'](global[_0x5dbc66(0x1ac)])['collection'](_0x4273d6)[_0x5dbc66(0x29b)]({'docId':_0x263dd6});if(!_0x2a736e)return _0x4c0750[_0x5dbc66(0x191)](JSON[_0x5dbc66(0x19a)]({'isLoad':!0x1,'class':_0x5e84b[_0x5dbc66(0x299)],'msg':_0x5dbc66(0x230)+_0x263dd6+'\x22'}));_0x2a736e[_0x5dbc66(0x20e)]=_0x51a2f4,_0x2a736e[_0x5dbc66(0x1dd)]=u[_0x5dbc66(0x297)](_0x2a736e[_0x5dbc66(0x21d)]);const _0x390eff=u[_0x5dbc66(0x2f1)](_0x2a736e);_0x390eff[_0x5dbc66(0x266)]&&(_0x390eff[_0x5dbc66(0x2cb)]=global[_0x5dbc66(0x1b6)]['find'](_0x3e533e=>_0x3e533e[_0x5dbc66(0x239)]==_0x390eff[_0x5dbc66(0x266)])?.[_0x5dbc66(0x2c6)]||''),_0x390eff[_0x5dbc66(0x204)]&&(_0x390eff[_0x5dbc66(0x232)]=global[_0x5dbc66(0x1b6)][_0x5dbc66(0x2a2)](_0x45e444=>_0x45e444[_0x5dbc66(0x239)]==_0x390eff['paymentMethod2'])?.[_0x5dbc66(0x2c6)]||'');const _0x307e95=_0x1928ba[_0x5dbc66(0x23a)](global[_0x5dbc66(0x304)],_0x5e84b[_0x5dbc66(0x2b4)]),_0x4c00c2=await C['renderView'](_0x307e95,_0x4c0750,{'title':_0x263dd6,'time':E['getDate'](0x0),'action':_0x43c9d7,'docType':_0x3e3e1e,'doc':_0x390eff,'settings':await C[_0x5dbc66(0x2ec)]()});if(_0x5e84b[_0x5dbc66(0x1e5)](_0x43c9d7,_0x5e84b['jkCdz']))_0x4c0750[_0x5dbc66(0x191)](JSON[_0x5dbc66(0x19a)]({'isPrint':!0x0,'class':_0x5e84b['ehjqK'],'htmlPage':_0x4c00c2}));else{if(_0x5e84b[_0x5dbc66(0x1e5)](_0x43c9d7,_0x5e84b['pfXRb'])){if(_0x5e84b[_0x5dbc66(0x1ca)](_0x5e84b[_0x5dbc66(0x1eb)],_0x5e84b[_0x5dbc66(0x2b8)]))return _0x39e6de;else{const _0x59a78b=await(await import(_0x5e84b[_0x5dbc66(0x244)]))[_0x5dbc66(0x1b5)](),_0x35ba56=await _0x59a78b['newPage']();await _0x35ba56[_0x5dbc66(0x1c8)](_0x4c00c2,{'waitUntil':_0x5e84b[_0x5dbc66(0x1d2)],'timeout':0x2710}),await new Promise(_0x2747a5=>setTimeout(_0x2747a5,0x3e8));const _0x253ff3=Math['floor'](_0x5e84b[_0x5dbc66(0x2da)](_0x5e84b[_0x5dbc66(0x1ab)](0x50,25.4),0x60));await _0x35ba56[_0x5dbc66(0x23d)]({'width':_0x253ff3,'height':0x258,'deviceScaleFactor':0x1});const _0x514f6f=await _0x35ba56[_0x5dbc66(0x2de)](()=>{const _0x471968=_0x5dbc66;if(_0x5e84b[_0x471968(0x1a0)](_0x5e84b[_0x471968(0x220)],_0x5e84b[_0x471968(0x2cc)])){const _0x5cddb0=document[_0x471968(0x1da)],_0x3ee271=document[_0x471968(0x275)];return Math[_0x471968(0x1b8)](_0x5cddb0[_0x471968(0x21f)],_0x5cddb0[_0x471968(0x2d6)],_0x3ee271['clientHeight'],_0x3ee271[_0x471968(0x21f)],_0x3ee271[_0x471968(0x2d6)]);}else _0x15f281['log'](_0x2d8c0a),_0x36a5a0[_0x471968(0x191)](_0x1f327f[_0x471968(0x19a)]({'isStatus':!0x1,'class':_0x5e84b[_0x471968(0x299)],'msg':_0x473e78[_0x471968(0x315)]}));}),_0x451fa2=await _0x35ba56['screenshot']({'type':_0x5e84b[_0x5dbc66(0x1c9)],'clip':{'x':0x0,'y':0x0,'width':_0x253ff3,'height':_0x514f6f},'omitBackground':!0x1});await _0x59a78b[_0x5dbc66(0x291)]();const _0x13e95a=_0x2a736e[_0x5dbc66(0x2ff)][_0x5dbc66(0x30f)](/\//g,'');_0x4c0750[_0x5dbc66(0x2db)](0xc8,{'Content-Type':_0x5e84b[_0x5dbc66(0x1a1)],'Content-Disposition':_0x5dbc66(0x193)+_0x13e95a+'.jpeg','Content-Length':_0x451fa2[_0x5dbc66(0x2d0)]}),_0x4c0750[_0x5dbc66(0x314)](_0x451fa2);}}}}else{const _0x14b92a=_0x4a3586?function(){const _0x221da9=_0x5dbc66;if(_0x571a55){const _0x3f08a2=_0x14d160[_0x221da9(0x1f9)](_0x45637c,arguments);return _0x2785fa=null,_0x3f08a2;}}:function(){};return _0x21a5ae=![],_0x14b92a;}}catch(_0x57f0e2){if(_0x5e84b[_0x5dbc66(0x214)](_0x5e84b[_0x5dbc66(0x1b3)],_0x5e84b['uzrrU']))return![];else console[_0x5dbc66(0x1c2)](_0x5e84b['fMwFc'],_0x57f0e2),_0x4c0750[_0x5dbc66(0x191)](JSON['stringify']({'isPrint':!0x1,'class':_0x5e84b['MGLQR'],'msg':_0x57f0e2[_0x5dbc66(0x315)]}));}finally{if(_0x5e84b[_0x5dbc66(0x231)](_0x5e84b[_0x5dbc66(0x2f6)],_0x5e84b[_0x5dbc66(0x20d)])){const _0xc595ba=_0x30bfca[_0x5dbc66(0x1f9)](_0x4e77f3,arguments);return _0x3e33a4=null,_0xc595ba;}else _0x3e050e[_0x5dbc66(0x291)]();}}),b[_0x14c3fc(0x25a)](B,_0x4b7acf['isAuth'],async(_0x4ed428,_0x508bf9)=>{const _0x1e352f=_0x14c3fc,_0x231048={'vkitY':function(_0xbee40d,_0x325e27){return _0xbee40d==_0x325e27;},'tcPmn':_0x1e352f(0x221),'WAMCC':_0x1e352f(0x23c),'JZQoh':function(_0x5e30f3,_0x5163ad){return _0x5e30f3==_0x5163ad;},'DnJLc':_0x1e352f(0x2bd),'vfOTI':_0x1e352f(0x26c),'NxbUy':_0x1e352f(0x312),'zjmCE':function(_0x3de1b1,_0x5db210){return _0x3de1b1===_0x5db210;},'BTygG':_0x1e352f(0x1ec),'KuVaf':function(_0x463a33,_0xef2ea1){return _0x463a33===_0xef2ea1;},'PHPbR':_0x1e352f(0x30e),'FJlVS':function(_0x31fc7,_0x1bbb05){return _0x31fc7==_0x1bbb05;},'XUcAv':function(_0x160bab,_0x240289){return _0x160bab!==_0x240289;},'BPxur':_0x1e352f(0x1de),'vCeUV':_0x1e352f(0x28e),'MGZhX':function(_0x198c15,_0x150fb0){return _0x198c15==_0x150fb0;},'EQQhA':function(_0x1ef47e,_0x41ab2d){return _0x1ef47e>_0x41ab2d;},'lXXLg':function(_0x94f890,_0x447c2b){return _0x94f890>_0x447c2b;},'ukEAl':function(_0x104ded,_0x3e431d){return _0x104ded>_0x3e431d;},'kiyGn':_0x1e352f(0x26f),'mpLLL':'bOIvr','wValr':'{{sep}}[บันทึกการแก้ไข]','sZErl':'green','RKmMw':function(_0x45a41e,_0x316ab3){return _0x45a41e<_0x316ab3;},'tpTZI':_0x1e352f(0x1f4)},_0x51a461=new _0x55ff0f(global[_0x1e352f(0x1ef)]);try{const _0x4d56f0=await T['getSessionData'](_0x4ed428);await m[_0x1e352f(0x1c6)](_0x4ed428,_0x508bf9,_0x4d56f0[_0x1e352f(0x1fe)]);const {collectionName:_0x3fc81a}=m['get_Info_ByPath'](_0x4ed428[_0x1e352f(0x23f)]),{docId:_0xbce088,action:_0x2575e3}=_0x4ed428[_0x1e352f(0x1da)],_0x379511=_0x231048[_0x1e352f(0x269)](_0x2575e3,_0x231048[_0x1e352f(0x1af)])?_0x231048[_0x1e352f(0x2d3)]:_0x231048['JZQoh'](_0x2575e3,_0x231048[_0x1e352f(0x29e)])?'จบ':'';if(!_0xbce088||![_0x231048[_0x1e352f(0x29e)],_0x231048['tcPmn']][_0x1e352f(0x1f3)](_0x2575e3))return _0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':_0x231048['NxbUy']}));const _0x5ce77c={'docId':_0xbce088,'userId':_0x4d56f0[_0x1e352f(0x1f1)]},_0x5abca6=_0x51a461['db'](global[_0x1e352f(0x1ac)])[_0x1e352f(0x2d1)](_0x3fc81a),_0x581014=await _0x5abca6['findOne'](_0x5ce77c);if(!_0x581014)return _0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x1,'class':_0x231048['vfOTI'],'msg':_0x1e352f(0x2ed)+_0xbce088+_0x1e352f(0x2d7)+_0x379511+_0x1e352f(0x25d)}));const _0x128d4c=_0x581014[_0x1e352f(0x21d)];if(_0x231048[_0x1e352f(0x247)](_0x2575e3,_0x231048['tcPmn'])&&!(_0x231048[_0x1e352f(0x27c)](_0x128d4c,0x1)||_0x231048[_0x1e352f(0x27c)](_0x128d4c,0x2)))return _0x508bf9[_0x1e352f(0x191)](JSON['stringify']({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':_0x231048['BTygG']}));if(_0x231048[_0x1e352f(0x19d)](_0x2575e3,_0x231048[_0x1e352f(0x29e)])&&_0x231048[_0x1e352f(0x269)](!_0x128d4c,0x1))return _0x508bf9[_0x1e352f(0x191)](JSON['stringify']({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':_0x231048[_0x1e352f(0x1cb)]}));if(_0x231048[_0x1e352f(0x2fd)](_0x2575e3,_0x231048[_0x1e352f(0x1af)])){if(_0x231048[_0x1e352f(0x1b1)](_0x231048[_0x1e352f(0x2cf)],_0x231048[_0x1e352f(0x2be)])){if(_0x231048['MGZhX'](_0x581014[_0x1e352f(0x2ae)],!0x1))return _0x508bf9['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x231048['vfOTI'],'msg':_0x1e352f(0x2c1)+_0xbce088+_0x1e352f(0x1f6)}));if(_0x231048['JZQoh']((await m[_0x1e352f(0x1b9)](_0x581014,_0x3fc81a,_0x4d56f0['userId']))['canCancel'],!0x1))return _0x508bf9[_0x1e352f(0x191)](JSON['stringify']({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':'เอกสาร\x20\x22'+_0xbce088+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}else{if(_0x5c6044){const _0x2c425d=_0x223ace['apply'](_0x595e3e,arguments);return _0x1e06ad=null,_0x2c425d;}}}if(_0x581014[_0x1e352f(0x311)]&&_0x231048['EQQhA'](_0x581014[_0x1e352f(0x311)][_0x1e352f(0x2d0)],0x0))return _0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':'เอกสาร\x20\x22'+_0xbce088+_0x1e352f(0x237)}));if(_0x231048[_0x1e352f(0x2eb)](_0x2575e3,_0x231048[_0x1e352f(0x1af)]))var _0x502f03=0xa;else{if(_0x231048[_0x1e352f(0x2eb)](_0x2575e3,_0x231048[_0x1e352f(0x29e)]))var _0x502f03=0x2;}const _0x3b3dc8=await _0x5abca6[_0x1e352f(0x277)](_0x5ce77c,{'$set':{'docStatusNumber':_0x502f03}});var _0x4dac67=_0x379511+'\x20\x22'+_0xbce088+_0x1e352f(0x238);if(_0x3b3dc8[_0x1e352f(0x27f)]||_0x231048[_0x1e352f(0x228)](_0x3b3dc8[_0x1e352f(0x2ac)],0x0)){const _0x446722=u['getChangeHistory']({'docStatusNumber':_0x128d4c},{'docStatusNumber':_0x502f03});if(_0x231048[_0x1e352f(0x271)](_0x446722[_0x1e352f(0x2d0)],0x0)){if(_0x231048[_0x1e352f(0x19d)](_0x231048[_0x1e352f(0x20b)],_0x231048[_0x1e352f(0x2a3)]))_0x1a49c8['close']();else{const _0xf82d03={'dateTime':E[_0x1e352f(0x28b)](),'userId':_0x4d56f0[_0x1e352f(0x1f1)],'userFullname':_0x4d56f0[_0x1e352f(0x1c0)],'changes':_0x446722};await _0x5abca6[_0x1e352f(0x277)]({'docId':_0xbce088},{'$push':{'changesHistory':{'$each':[_0xf82d03],'$position':0x0}}}),_0x4dac67+=_0x231048[_0x1e352f(0x1e8)];}}return _0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x0,'docId':_0xbce088,'docStatusNumber':_0x502f03,'class':_0x231048[_0x1e352f(0x2b3)],'msg':_0x4dac67}));}else{if(_0x3b3dc8[_0x1e352f(0x27f)]&&_0x231048['RKmMw'](_0x3b3dc8[_0x1e352f(0x2ac)],0x1))return _0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x1,'docId':_0xbce088,'docStatusNumber':_0x128d4c,'class':_0x231048[_0x1e352f(0x298)],'msg':'\x22'+_0xbce088+_0x1e352f(0x307)}));}}catch(_0xe929eb){console[_0x1e352f(0x1c2)](_0xe929eb),_0x508bf9[_0x1e352f(0x191)](JSON[_0x1e352f(0x19a)]({'isStatus':!0x1,'class':_0x231048[_0x1e352f(0x2fb)],'msg':_0xe929eb[_0x1e352f(0x315)]}));}finally{_0x51a461[_0x1e352f(0x291)]();}});export default b;function _0x109cec(_0x303416){const _0x730322=_0x14c3fc,_0x4dab22={'APvNT':function(_0x2780af,_0x260297){return _0x2780af===_0x260297;},'Whzls':_0x730322(0x2c9),'xhmkV':_0x730322(0x256),'svWfm':_0x730322(0x2cd),'NaPMF':function(_0x362c45,_0x3b475d){return _0x362c45!==_0x3b475d;},'lhUmY':function(_0x20888f,_0x468509){return _0x20888f+_0x468509;},'WwQIi':function(_0x28c50d,_0x581df0){return _0x28c50d/_0x581df0;},'hpgUm':'length','kFypV':function(_0x3cda62,_0x5a05e5){return _0x3cda62===_0x5a05e5;},'ysXvx':function(_0x390763,_0x45f889){return _0x390763%_0x45f889;},'wDfVa':function(_0x14227e,_0x104dd7){return _0x14227e+_0x104dd7;},'GFiOS':'debu','aELQO':_0x730322(0x243),'EQjsq':'action','XLNgZ':function(_0x5e0106,_0x2503c8){return _0x5e0106+_0x2503c8;},'SQPRN':_0x730322(0x1a3),'hXqtz':function(_0x7fd95,_0x1d6a80){return _0x7fd95(_0x1d6a80);},'hgjDk':function(_0x393a71,_0x480232){return _0x393a71(_0x480232);}};function _0x2d7937(_0x5b53a8){const _0x509277=_0x730322;if(_0x4dab22[_0x509277(0x306)](typeof _0x5b53a8,_0x4dab22['Whzls']))return function(_0x42683f){}['constructor'](_0x4dab22[_0x509277(0x288)])['apply'](_0x4dab22[_0x509277(0x2ea)]);else _0x4dab22[_0x509277(0x19f)](_0x4dab22['lhUmY']('',_0x4dab22['WwQIi'](_0x5b53a8,_0x5b53a8))[_0x4dab22[_0x509277(0x27b)]],0x1)||_0x4dab22[_0x509277(0x208)](_0x4dab22[_0x509277(0x227)](_0x5b53a8,0x14),0x0)?function(){return!![];}[_0x509277(0x302)](_0x4dab22[_0x509277(0x1b4)](_0x4dab22['GFiOS'],_0x4dab22[_0x509277(0x25f)]))['call'](_0x4dab22['EQjsq']):function(){return![];}[_0x509277(0x302)](_0x4dab22[_0x509277(0x264)](_0x4dab22[_0x509277(0x305)],_0x4dab22[_0x509277(0x25f)]))[_0x509277(0x1f9)](_0x4dab22['SQPRN']);_0x4dab22[_0x509277(0x1c5)](_0x2d7937,++_0x5b53a8);}try{if(_0x303416)return _0x2d7937;else _0x4dab22[_0x730322(0x1e4)](_0x2d7937,0x0);}catch(_0x3415){}}