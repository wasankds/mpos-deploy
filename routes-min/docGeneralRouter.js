const _0x46ae02=_0x5e47;(function(_0x340a3e,_0x4d876f){const _0x387f1b=_0x5e47,_0x29fc6a=_0x340a3e();while(!![]){try{const _0x1b6b9d=-parseInt(_0x387f1b(0x296))/0x1+-parseInt(_0x387f1b(0x1dc))/0x2*(-parseInt(_0x387f1b(0x1d0))/0x3)+parseInt(_0x387f1b(0x2aa))/0x4+-parseInt(_0x387f1b(0x1c5))/0x5*(-parseInt(_0x387f1b(0x1a9))/0x6)+parseInt(_0x387f1b(0x14b))/0x7*(parseInt(_0x387f1b(0x2ad))/0x8)+parseInt(_0x387f1b(0x1b2))/0x9+parseInt(_0x387f1b(0x1de))/0xa*(-parseInt(_0x387f1b(0x178))/0xb);if(_0x1b6b9d===_0x4d876f)break;else _0x29fc6a['push'](_0x29fc6a['shift']());}catch(_0x559b01){_0x29fc6a['push'](_0x29fc6a['shift']());}}}(_0x3072,0x59d1e));function _0x3072(){const _0x5dcff7=['KoqAQ','zFatw','xsjQf','zOhyn','Ompda','docStatusNumber','GCVAS','apply','FJVYv','JcUHg','get','qgvql','TWQEK','yILKE','FMgAC','getChangeHistory','table','exception','dbName','QeFIo','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','tvrlC','/myData.js','sdboR','Tlsim','wxKve','error','VrYZN','ZwJxP','KKRWx','FIUzp','KwVFo','AkGkO','networkidle0','path','docId','GPTnD','join','jpeg','Ipzos','sVvCE','find','ArfkS','{}.constructor(\x22return\x20this\x22)(\x20)','uHWHH','warn','upopj','convert_DocPrint','body','sQZyX','zLeOU','kpKbg','function\x20*\x5c(\x20*\x5c)','Wyfih','yellow','xJgFx','quolL','nVdls','collectionName','oRkHv','WkkGE','DOC_TYPE','zCdyA','SwQcc','zapVN','XlJbT','TTAfu','hMBpx','RbNNJ','JxMvA','ประวัติการแก้ไขเอกสาร\x20:\x20','dbUrl','AgvhU','โหลดเอกสารเลขที่\x20\x22','cUssU','end','findOne','stringify','push','uAnBm','dateTimeCanCancel','IkACn','udzaw','branchId','isAuth','folderForms','MOlQA','return\x20(function()\x20','dAhWD','call','kiCNM','SRYJE','message','launch','vqJjp','fxtsa','tsyqB','kOjIb','getSettings','qJSHQ','print','TBoAW','toString','clientHeight','onmRy','oRsjp','stock','PafbM','SZduM','AnKvc','BrJBR','RLFNh','renderView','ZtBrA','doc_print.ejs','newPage','length','debu','warehouseIn','getMainDocPathObj','info','xQOGx','paytype','warehouseOut','SpSqS','LqIHz','ySWVH','/search','HdJAL','/load-last','dateTimeCancelRemain','PfljG','getDateTime','zyNTN','check_DocDateTime_CanCancel','YEXWs','SxxDE','EGmmV','tzBLC','Hjeee','getItemsCategory','tUotv','UkMiy','documentElement','469136lCxarr','load-last','PATH_WAREHOUSE_IN','VxAIE','post','kogSD','getDate','BYntz','yfQjR','setContent','PAY_TYPE','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','getUserData','offsetHeight','collection','hyrFB','\x22\x20มีบันทึกชำระหนี้แล้ว{{sep}}ไม่สามารถยกเลิกได้','SSzJq','MiklN','PATH_WAREHOUSE_OUT','474144Aukwhf','FNJCF','modifiedCount','1336OzzOBD','oRclI','UQUUB','pPnPx','/fetch/modal','mQJee','chain','GdGwX','stateObject','cypOz','hogRJ','getSessionData','red','rIqqy','yafVl','../','dguni','EpXpd','ExCWF','essJA','NVsvF','zYdSr','{{sep}}[\x20ค้นหาเฉพาะในสาขาตนเอง\x20]','constructor','/print','ไม่พบเอกสารล่าสุด','nRBkG','UVzwZ','syCSs','yjMBB','while\x20(true)\x20{}','YLCgw','pGUSW','GUswG','init','hOcCr','JWhMj','cancel','oWkcc','uDFyu','userFullname','WFPgf','/load','ntCre','qrdff','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','OIpHN','22337xQHpxO','test','nQRoB','image/jpeg','qQgAt','yvhcA','ryoXN','green','replace','docTitle','ยกเลิก','PmuPz','BUkpI','payTypeThai','input','hjHDL','VeJEr','DWSuk','active','XMsiq','zxGlO','prototype','KeJLF','TVIzV','includes','ICGBp','canEdit','wOFYu','mWsDL','sales','matchedCount','counter','cCXTy','eargW','get_Info_ByPath','FrKIP','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','aCkfN','Bbtcx','oeFgH','log','toArray','leqbZ','AdCZC','11AnMsgW','sYsPp','WfdgP','{{sep}}[บันทึกการแก้ไข]','Ophem','connect','trace','พบ\x20\x22','ไม่พบเอกสารเลขที่\x20\x22','statusName','emwrt','JGfcS','ZPMsr','eIAvE','fhUvU','payDebtRows','wXeCF','mFQlA','mhafG','max','ZtYrx','qFxwE','MpPMN','VTLaq','paymentMethod2','OcdxG','dateTimeCanEdit','boTNR','zZpBG','tlbyX','LRHLN','FDcem','DSigM','SGgPa','__proto__','JdVRy','load','getSuppliers_for_Modal','scrollHeight','kBPyy','AFyZB','get_StatusName_byStatusNumber','gRSzE','/myUsers.js','BkzpX','ElkUn','PvCfq','isCqr','getItems_for_Modal','284934BBqDao','QrNnu','pgQyt','vRKTU','action','close','TuZDA','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','4372902MZfxFm','/changes','MSWOk','send','/status','QyEUq','CxQuG','qIrOL','HOBOi','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','PAIBL','userAuthority','MyGTD','hVGzl','fzjWs','paymentMethod2Name','gger','aQsrT','MePJU','40qSCJRE','PTJjS','finish','GkYCe','VlWQM','error\x20===>\x20','RLmOE','HJwkD','attachment;\x20filename=','PATH_SALES','xAWWp','2667UiTOur','ynhtB','return','ไม่พบประวัติการเปลี่ยนแปลง','bpuiW','cePwm','IzBZV','LomSg','PATH_RETURN','branchName','rkIRa','lZmMh','346dicMbK','dateTimeEditRemain','8339820shLZJU','hgZXu','\x22\x20เอกสาร','.jpeg','meFnc','uQIvi','jxxXr','/myModule.js','เอกสาร\x20\x22','pivEb','SrUsv','NIOvF','paymentMethod1','viaxu','ickWo','BfCco','AxIBd','alERA','yHqyM','iTVLT','bejmJ','JOcli','XhVJT','userId','VsoyW','aotoh','aRqot','updateOne','dHtgi','Router','ZHufF','เอกสารที่ตันเองไม่ได้สร้าง','EkYem','bind','tbojR','trUBt','zHvPw','RcSBo','hmPhw','console'];_0x3072=function(){return _0x5dcff7;};return _0x3072();}const _0x23ee8b=(function(){const _0x319efa=_0x5e47,_0x59d95c={'pIBHk':function(_0x50ebb5,_0x44ad06){return _0x50ebb5+_0x44ad06;},'ickWo':_0x319efa(0x27b),'TWQEK':_0x319efa(0x1c2),'zYdSr':_0x319efa(0x1ad),'FNacH':function(_0x52d93b,_0x451319){return _0x52d93b(_0x451319);},'oWkcc':'error\x20===>\x20','uwtcm':_0x319efa(0x2b9),'JWhMj':function(_0x361209,_0x4f608f){return _0x361209!==_0x4f608f;},'TTAfu':_0x319efa(0x24e),'UkMiy':_0x319efa(0x15f),'wPUuI':_0x319efa(0x237),'cypOz':_0x319efa(0x1a6)};let _0x18a240=!![];return function(_0x34f865,_0x2ab64a){const _0x393bbb=_0x319efa,_0x4a308e={'quolL':function(_0x3936ad,_0x1af8d8){return _0x59d95c['pIBHk'](_0x3936ad,_0x1af8d8);},'WkkGE':_0x59d95c[_0x393bbb(0x1ec)],'JdVRy':_0x59d95c[_0x393bbb(0x212)],'hmfsS':_0x59d95c[_0x393bbb(0x2c2)],'aeJkl':function(_0x1ebca4,_0x28dab1){return _0x59d95c['FNacH'](_0x1ebca4,_0x28dab1);},'Bbtcx':_0x59d95c[_0x393bbb(0x142)],'NVsvF':_0x59d95c['uwtcm'],'TBoAW':function(_0x1a62c9,_0x234386){const _0x5f0fc4=_0x393bbb;return _0x59d95c[_0x5f0fc4(0x2d1)](_0x1a62c9,_0x234386);},'UQUUB':_0x59d95c[_0x393bbb(0x248)],'irihv':_0x59d95c[_0x393bbb(0x294)],'alERA':_0x59d95c['wPUuI']};if(_0x59d95c[_0x393bbb(0x2d1)](_0x59d95c[_0x393bbb(0x2b6)],_0x59d95c[_0x393bbb(0x2b6)]))(function(){return!![];}['constructor'](_0x4a308e[_0x393bbb(0x23e)](_0x4a308e[_0x393bbb(0x242)],_0x4a308e[_0x393bbb(0x19b)]))['call'](_0x4a308e['hmfsS']));else{const _0x3b3057=_0x18a240?function(){const _0x4865ee=_0x393bbb;if(_0x4a308e[_0x4865ee(0x26b)](_0x4a308e[_0x4865ee(0x2af)],_0x4a308e[_0x4865ee(0x2af)]))_0x4a308e['aeJkl'](_0x2a61e9,'0');else{if(_0x2ab64a){if(_0x4a308e[_0x4865ee(0x26b)](_0x4a308e['irihv'],_0x4a308e[_0x4865ee(0x1ef)])){const _0x4a9e8d=_0x2ab64a[_0x4865ee(0x20d)](_0x34f865,arguments);return _0x2ab64a=null,_0x4a9e8d;}else _0x4674ea[_0x4865ee(0x174)](_0x4a308e[_0x4865ee(0x172)],_0x279627),_0x3d563b[_0x4865ee(0x1b5)](_0x3ec021[_0x4865ee(0x253)]({'isPrint':!0x1,'class':_0x4a308e[_0x4865ee(0x2c1)],'msg':_0x4a4f94[_0x4865ee(0x262)]}));}}}:function(){};return _0x18a240=![],_0x3b3057;}};}());(function(){const _0x5213e5=_0x5e47,_0x13f513={'YLCgw':_0x5213e5(0x23a),'ZtBrA':_0x5213e5(0x16f),'zHvPw':function(_0x35abc1,_0x2380a5){return _0x35abc1(_0x2380a5);},'ntCre':_0x5213e5(0x2cf),'cCXTy':function(_0x5c60a5,_0x620219){return _0x5c60a5+_0x620219;},'xsjQf':_0x5213e5(0x2b3),'uHWHH':_0x5213e5(0x159),'FrPkq':function(_0x542db4,_0x483c98){return _0x542db4(_0x483c98);},'oRkHv':function(_0x406c9d){return _0x406c9d();},'mQJee':function(_0x419ad1){return _0x419ad1();},'ryoXN':function(_0x214cdd,_0x2c5f93){return _0x214cdd===_0x2c5f93;},'IkACn':_0x5213e5(0x15c),'zZpBG':function(_0x27484d,_0x594dc7){return _0x27484d(_0x594dc7);},'BrJBR':function(_0x564969,_0x4ebbec){return _0x564969+_0x4ebbec;},'GkYCe':function(_0x189cd3,_0x2e5eca){return _0x189cd3===_0x2e5eca;},'XMsiq':_0x5213e5(0x221),'GCVAS':function(_0x596d35,_0x495d68){return _0x596d35(_0x495d68);},'EGmmV':function(_0x184776,_0x179309){return _0x184776!==_0x179309;},'IzBZV':_0x5213e5(0x289),'PAIBL':_0x5213e5(0x265),'FNJCF':function(_0x3b81f6,_0x184454,_0x368665){return _0x3b81f6(_0x184454,_0x368665);}};_0x13f513[_0x5213e5(0x2ab)](_0x23ee8b,this,function(){const _0x331bcc=_0x5213e5,_0x5831ac={'Tlsim':function(_0x595243){const _0xb2d15a=_0x5e47;return _0x13f513[_0xb2d15a(0x2b2)](_0x595243);}};if(_0x13f513[_0x331bcc(0x151)](_0x13f513['IkACn'],_0x13f513[_0x331bcc(0x257)])){const _0x3c52e4=new RegExp(_0x13f513[_0x331bcc(0x2cc)]),_0x179c2d=new RegExp(_0x13f513['ZtBrA'],'i'),_0x50d346=_0x13f513[_0x331bcc(0x194)](_0x3d8350,_0x13f513['ntCre']);if(!_0x3c52e4[_0x331bcc(0x14c)](_0x13f513['cCXTy'](_0x50d346,_0x13f513['xsjQf']))||!_0x179c2d[_0x331bcc(0x14c)](_0x13f513[_0x331bcc(0x274)](_0x50d346,_0x13f513['uHWHH'])))_0x13f513[_0x331bcc(0x1c8)](_0x13f513[_0x331bcc(0x15e)],_0x13f513[_0x331bcc(0x15e)])?_0x13f513[_0x331bcc(0x20c)](_0x50d346,'0'):_0x5831ac[_0x331bcc(0x21e)](_0xb1e0d1);else{if(_0x13f513[_0x331bcc(0x28f)](_0x13f513[_0x331bcc(0x1d6)],_0x13f513[_0x331bcc(0x1bc)]))_0x13f513[_0x331bcc(0x241)](_0x3d8350);else{const _0x527aa6=new _0x17ef24(_0x13f513['YLCgw']),_0x1e2bc0=new _0x542fca(_0x13f513[_0x331bcc(0x277)],'i'),_0x14d0c0=_0x13f513[_0x331bcc(0x202)](_0x29a99a,_0x13f513[_0x331bcc(0x147)]);!_0x527aa6['test'](_0x13f513['cCXTy'](_0x14d0c0,_0x13f513[_0x331bcc(0x208)]))||!_0x1e2bc0[_0x331bcc(0x14c)](_0x13f513[_0x331bcc(0x16b)](_0x14d0c0,_0x13f513[_0x331bcc(0x232)]))?_0x13f513['FrPkq'](_0x14d0c0,'0'):_0x13f513['oRkHv'](_0x23d823);}}}else{const _0x49a6bb=_0x352612[_0x331bcc(0x20d)](_0x122f34,arguments);return _0x431f25=null,_0x49a6bb;}})();}());const _0x26ae5a=(function(){const _0x506cfa=_0x5e47,_0x9f979a={'wOFYu':function(_0x391603,_0x2296bc){return _0x391603===_0x2296bc;},'tlbyX':_0x506cfa(0x1a4),'WNMUL':function(_0x31f7c9,_0x1eb33e){return _0x31f7c9!==_0x1eb33e;},'GdGwX':_0x506cfa(0x225),'qIrOL':function(_0x34513e,_0xf1c16e){return _0x34513e!==_0xf1c16e;},'uDFyu':'rjBFE'};let _0x3d2c12=!![];return function(_0x20c35b,_0x5e77c8){const _0x356337=_0x506cfa;if(_0x9f979a[_0x356337(0x1b9)](_0x9f979a[_0x356337(0x143)],_0x9f979a[_0x356337(0x143)]))return _0x133f87;else{const _0x469b90=_0x3d2c12?function(){const _0x521b26=_0x356337;if(_0x9f979a[_0x521b26(0x166)](_0x9f979a[_0x521b26(0x195)],_0x9f979a[_0x521b26(0x195)])){if(_0x5e77c8){if(_0x9f979a['WNMUL'](_0x9f979a['GdGwX'],_0x9f979a[_0x521b26(0x2b4)]))_0x5fa11b=_0x43c194;else{const _0x175f70=_0x5e77c8['apply'](_0x20c35b,arguments);return _0x5e77c8=null,_0x175f70;}}}else _0x2ab941['close']();}:function(){};return _0x3d2c12=![],_0x469b90;}};}()),_0xa13ec=_0x26ae5a(this,function(){const _0xc120ab=_0x5e47,_0x219fc2={'ySWVH':_0xc120ab(0x2cb),'JOcli':_0xc120ab(0x16a),'kuFdI':function(_0x553635,_0x86c6c5){return _0x553635(_0x86c6c5);},'mWsDL':function(_0x5a3edb,_0x294568){return _0x5a3edb===_0x294568;},'SxxDE':_0xc120ab(0x207),'UOZuV':'eFyAy','qFxwE':function(_0x2a1d4e,_0x565aea){return _0x2a1d4e(_0x565aea);},'AFyZB':function(_0x20da86,_0x3715c3){return _0x20da86+_0x3715c3;},'Ipzos':_0xc120ab(0x25d),'sVvCE':_0xc120ab(0x231),'VsoyW':function(_0x25f1d7){return _0x25f1d7();},'Ypvup':function(_0x1d3517,_0x11a022){return _0x1d3517!==_0x11a022;},'uQIvi':_0xc120ab(0x176),'OcdxG':_0xc120ab(0x174),'LRHLN':_0xc120ab(0x233),'bejmJ':'info','emwrt':'error','trUBt':_0xc120ab(0x217),'AkGkO':_0xc120ab(0x216),'Ikxxc':_0xc120ab(0x17e),'kHFCv':function(_0x5aa1db,_0x2a6b87){return _0x5aa1db<_0x2a6b87;},'fzjWs':function(_0xcfbfe3,_0x25c621){return _0xcfbfe3!==_0x25c621;},'jxxXr':'tjxjf','docpG':_0xc120ab(0x1e2)};let _0x2f3204;try{if(_0x219fc2[_0xc120ab(0x167)](_0x219fc2[_0xc120ab(0x28e)],_0x219fc2['UOZuV']))return function(_0x5b3afe){}['constructor'](_0x219fc2[_0xc120ab(0x284)])[_0xc120ab(0x20d)](_0x219fc2[_0xc120ab(0x1f3)]);else{const _0x578c7f=_0x219fc2[_0xc120ab(0x18d)](Function,_0x219fc2[_0xc120ab(0x1a0)](_0x219fc2[_0xc120ab(0x1a0)](_0x219fc2[_0xc120ab(0x22d)],_0x219fc2[_0xc120ab(0x22e)]),');'));_0x2f3204=_0x219fc2[_0xc120ab(0x1f6)](_0x578c7f);}}catch(_0x364133){if(_0x219fc2['Ypvup'](_0x219fc2[_0xc120ab(0x1e3)],_0x219fc2[_0xc120ab(0x1e3)])){if(_0x485b05)return _0x1cbb3a;else _0x219fc2['kuFdI'](_0x3ca41d,0x0);}else _0x2f3204=window;}const _0x1fc6f4=_0x2f3204['console']=_0x2f3204[_0xc120ab(0x205)]||{},_0x18dc59=[_0x219fc2[_0xc120ab(0x191)],_0x219fc2[_0xc120ab(0x196)],_0x219fc2[_0xc120ab(0x1f2)],_0x219fc2[_0xc120ab(0x182)],_0x219fc2[_0xc120ab(0x201)],_0x219fc2[_0xc120ab(0x226)],_0x219fc2['Ikxxc']];for(let _0x225382=0x0;_0x219fc2['kHFCv'](_0x225382,_0x18dc59[_0xc120ab(0x27a)]);_0x225382++){if(_0x219fc2[_0xc120ab(0x1c0)](_0x219fc2[_0xc120ab(0x1e4)],_0x219fc2['docpG'])){const _0x32ce27=_0x26ae5a[_0xc120ab(0x2c4)][_0xc120ab(0x160)][_0xc120ab(0x1ff)](_0x26ae5a),_0x21cf88=_0x18dc59[_0x225382],_0x563859=_0x1fc6f4[_0x21cf88]||_0x32ce27;_0x32ce27['__proto__']=_0x26ae5a['bind'](_0x26ae5a),_0x32ce27[_0xc120ab(0x26c)]=_0x563859[_0xc120ab(0x26c)]['bind'](_0x563859),_0x1fc6f4[_0x21cf88]=_0x32ce27;}else{const _0x3cad9b=_0x3d3432[_0xc120ab(0x2c4)][_0xc120ab(0x160)]['bind'](_0x148ddd),_0x3bc33e=_0x2c3898[_0x34f7c1],_0x4b6d55=_0x193d9d[_0x3bc33e]||_0x3cad9b;_0x3cad9b[_0xc120ab(0x19a)]=_0x507d44[_0xc120ab(0x1ff)](_0x464a4f),_0x3cad9b[_0xc120ab(0x26c)]=_0x4b6d55[_0xc120ab(0x26c)][_0xc120ab(0x1ff)](_0x4b6d55),_0x3e542c[_0x3bc33e]=_0x3cad9b;}}});_0xa13ec();import _0x5be197 from'express';function _0x5e47(_0x231b2e,_0x3b0b2d){const _0x21abd2=_0x3072();return _0x5e47=function(_0xa13ec,_0x26ae5a){_0xa13ec=_0xa13ec-0x141;let _0x229d9f=_0x21abd2[_0xa13ec];return _0x229d9f;},_0x5e47(_0x231b2e,_0x3b0b2d);}const b=_0x5be197[_0x46ae02(0x1fb)]();import _0x4eb561 from'path';import{MongoClient as _0x160bee}from'mongodb';import _0x1a7b19 from'../middleware/mainAuth.js';const C=await import('../'+mymoduleFolder+_0x46ae02(0x1e5)),E=await import(_0x46ae02(0x2bc)+mymoduleFolder+'/myDateTime.js'),T=await import('../'+mymoduleFolder+_0x46ae02(0x1a3)),u=await import('../'+mymoduleFolder+_0x46ae02(0x21c)),m=await import(_0x46ae02(0x2bc)+mymoduleFolder+'/myDocMain.js'),p=global[_0x46ae02(0x298)],S=global[_0x46ae02(0x2a9)],w=global[_0x46ae02(0x1ce)],_=global[_0x46ae02(0x1d8)],v=[p+'/fetch/modal',S+_0x46ae02(0x2b1),w+_0x46ae02(0x2b1),_+'/fetch/modal'],k=[p+'/changes',S+'/changes',w+_0x46ae02(0x1b3),_+_0x46ae02(0x1b3)],L=[p+_0x46ae02(0x2c5),S+_0x46ae02(0x2c5),w+_0x46ae02(0x2c5),_+'/print'],B=[p+_0x46ae02(0x1b6),S+_0x46ae02(0x1b6),w+_0x46ae02(0x1b6),_+_0x46ae02(0x1b6)],Y=[p+'/search',S+_0x46ae02(0x285),w+_0x46ae02(0x285),_+_0x46ae02(0x285)],x=[p+'/load',S+_0x46ae02(0x146),w+_0x46ae02(0x146),_+_0x46ae02(0x146),p+_0x46ae02(0x287),S+_0x46ae02(0x287),w+_0x46ae02(0x287),_+'/load-last'];b[_0x46ae02(0x210)](v,_0x1a7b19[_0x46ae02(0x25a)],async(_0x5840a7,_0x5a2535)=>{const _0x28b9a5=_0x46ae02,_0x54d502={'nQRoB':_0x28b9a5(0x23a),'yvhcA':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','YQzzi':function(_0x3db4eb,_0x1cb7ad){return _0x3db4eb(_0x1cb7ad);},'CxQuG':_0x28b9a5(0x2cf),'tbojR':function(_0x1e9122,_0x550408){return _0x1e9122+_0x550408;},'zyNTN':'chain','VlWQM':'input','VTLaq':function(_0x5a5579,_0xb51872){return _0x5a5579(_0xb51872);},'RLFNh':function(_0x57ee89){return _0x57ee89();},'essJA':function(_0x49993b,_0x335dc9,_0x3fc417){return _0x49993b(_0x335dc9,_0x3fc417);},'cUssU':function(_0x1ddd99,_0x39bc3e){return _0x1ddd99===_0x39bc3e;},'pGUSW':_0x28b9a5(0x26f),'yILKE':function(_0x3b9399,_0x146601){return _0x3b9399==_0x146601;},'qJSHQ':_0x28b9a5(0x27c),'qrdff':_0x28b9a5(0x270),'yfQjR':_0x28b9a5(0x15d),'ekFoZ':_0x28b9a5(0x281),'GKsWm':function(_0x383b12,_0x1e29f6){return _0x383b12==_0x1e29f6;},'PafbM':_0x28b9a5(0x168),'MOlQA':function(_0x21ab0e,_0x5b3f7d){return _0x21ab0e==_0x5b3f7d;},'rZiyd':_0x28b9a5(0x1d2),'SGgPa':_0x28b9a5(0x152),'yHqyM':_0x28b9a5(0x21a),'zCdyA':function(_0x4e85e6,_0x203f6e){return _0x4e85e6===_0x203f6e;},'EkYem':_0x28b9a5(0x264),'UVzwZ':_0x28b9a5(0x2b9)},_0x1c585b=await T[_0x28b9a5(0x2b8)](_0x5840a7),_0x30cad6=await m[_0x28b9a5(0x27d)](_0x5840a7,_0x5a2535,_0x1c585b[_0x28b9a5(0x1bd)]);try{if(_0x54d502[_0x28b9a5(0x250)](_0x54d502[_0x28b9a5(0x2cd)],_0x54d502[_0x28b9a5(0x2cd)])){if(_0x54d502[_0x28b9a5(0x213)](_0x30cad6['DOC_TYPE'],_0x54d502[_0x28b9a5(0x269)]))var _0xd40627=await u[_0x28b9a5(0x1a8)](_0x54d502[_0x28b9a5(0x148)]),_0x17ab2e=await u[_0x28b9a5(0x19d)](_0x54d502[_0x28b9a5(0x29e)]);else{if(_0x54d502[_0x28b9a5(0x213)](_0x30cad6[_0x28b9a5(0x243)],_0x54d502['ekFoZ']))var _0xd40627=await u[_0x28b9a5(0x1a8)](_0x54d502['qrdff']),_0x17ab2e=[];else{if(_0x54d502['GKsWm'](_0x30cad6['DOC_TYPE'],_0x54d502[_0x28b9a5(0x271)]))var _0xd40627=await u['getItems_for_Modal'](_0x54d502[_0x28b9a5(0x29e)],_0x1c585b['branchId']),_0x17ab2e=[];else{if(_0x54d502[_0x28b9a5(0x25c)](_0x30cad6[_0x28b9a5(0x243)],_0x54d502['rZiyd']))var _0xd40627=await u[_0x28b9a5(0x1a8)](_0x54d502['yfQjR'],_0x1c585b[_0x28b9a5(0x259)]),_0x17ab2e=[];}}}const _0x1f5a42=await u[_0x28b9a5(0x292)]();return _0x5a2535[_0x28b9a5(0x1b5)](JSON['stringify']({'DATA_ITEMS':_0xd40627,'DATA_CATEGORY':_0x1f5a42,'DATA_SUPPLIERS':_0x17ab2e,'isFetch':!0x0,'class':_0x54d502[_0x28b9a5(0x199)],'msg':_0x54d502[_0x28b9a5(0x1f0)]}));}else{const _0x847ee6=_0xe19a78['body'],_0x5748c1=_0x5bef63[_0x28b9a5(0x295)];return _0x504a32[_0x28b9a5(0x18b)](_0x847ee6[_0x28b9a5(0x19e)],_0x847ee6[_0x28b9a5(0x2a3)],_0x5748c1[_0x28b9a5(0x26d)],_0x5748c1[_0x28b9a5(0x19e)],_0x5748c1[_0x28b9a5(0x2a3)]);}}catch(_0x21f22f){if(_0x54d502[_0x28b9a5(0x244)](_0x54d502[_0x28b9a5(0x1fe)],_0x54d502[_0x28b9a5(0x1fe)]))return console[_0x28b9a5(0x174)](_0x21f22f),_0x5a2535['send'](JSON[_0x28b9a5(0x253)]({'isFetch':!0x1,'class':_0x54d502[_0x28b9a5(0x2c8)],'msg':_0x21f22f['message']}));else tWZiuS[_0x28b9a5(0x2c0)](_0x535605,this,function(){const _0x3e7337=_0x28b9a5,_0x11857c=new _0x1a60fe(tWZiuS[_0x3e7337(0x14d)]),_0x145ed0=new _0x1d3bbb(tWZiuS[_0x3e7337(0x150)],'i'),_0xae2c8c=tWZiuS['YQzzi'](_0x16c3b1,tWZiuS[_0x3e7337(0x1b8)]);!_0x11857c[_0x3e7337(0x14c)](tWZiuS['tbojR'](_0xae2c8c,tWZiuS[_0x3e7337(0x28b)]))||!_0x145ed0[_0x3e7337(0x14c)](tWZiuS[_0x3e7337(0x200)](_0xae2c8c,tWZiuS[_0x3e7337(0x1c9)]))?tWZiuS[_0x3e7337(0x18f)](_0xae2c8c,'0'):tWZiuS[_0x3e7337(0x275)](_0x3e9c2b);})();}}),b['post'](Y,_0x1a7b19[_0x46ae02(0x25a)],async(_0x168d8c,_0x33e132)=>{const _0x4fa9e8=_0x46ae02,_0x1f8916={'HOBOi':_0x4fa9e8(0x2b9),'EpXpd':function(_0x5c4c91,_0x42d0f8){return _0x5c4c91<_0x42d0f8;},'dAhWD':_0x4fa9e8(0x23c),'onmRy':_0x4fa9e8(0x149),'wXeCF':function(_0x4ca0a2,_0x1334f6){return _0x4ca0a2===_0x1334f6;},'RcSBo':_0x4fa9e8(0x1af),'eIAvE':_0x4fa9e8(0x2c3),'aotoh':function(_0x2dc53b,_0x4274ea){return _0x2dc53b+_0x4274ea;},'YNCKy':_0x4fa9e8(0x152),'qQgAt':function(_0x54113d,_0x452f65){return _0x54113d===_0x452f65;},'GUswG':_0x4fa9e8(0x18c),'vRKTU':function(_0x557ffc,_0x2fd75f){return _0x557ffc!==_0x2fd75f;},'qgvql':_0x4fa9e8(0x260)};let {sip:_0x49113b}=_0x168d8c[_0x4fa9e8(0x236)];if(!_0x49113b&&_0x1f8916[_0x4fa9e8(0x2be)](_0x49113b[_0x4fa9e8(0x27a)],0x2))return _0x33e132['send'](JSON[_0x4fa9e8(0x253)]({'isSearch':!0x1,'class':_0x1f8916[_0x4fa9e8(0x25e)],'msg':_0x1f8916[_0x4fa9e8(0x26e)]}));_0x49113b=_0x49113b[_0x4fa9e8(0x153)](/[!@#$%^&*<>]/g,'')??null;const _0x2d8269=await T['getUserData'](_0x168d8c);await m['getMainDocPathObj'](_0x168d8c,_0x33e132,_0x2d8269['userAuthority']);const _0x53290e=m[_0x4fa9e8(0x16d)](_0x168d8c[_0x4fa9e8(0x228)]),_0x36ed87=new _0x160bee(global[_0x4fa9e8(0x24d)]);try{if(_0x1f8916[_0x4fa9e8(0x188)](_0x1f8916[_0x4fa9e8(0x203)],_0x1f8916[_0x4fa9e8(0x203)])){await _0x36ed87[_0x4fa9e8(0x17d)]();const _0x2ff0a8=_0x36ed87['db'](global[_0x4fa9e8(0x218)])[_0x4fa9e8(0x2a4)](_0x53290e[_0x4fa9e8(0x240)]),_0x136ba3=[{'$or':[{'docId':{'$regex':_0x49113b,'$options':'i'}},{'docDateTime':{'$regex':_0x49113b,'$options':'i'}}]}];let _0x4e3ced='';['O','S'][_0x4fa9e8(0x163)](_0x2d8269[_0x4fa9e8(0x1bd)])||(_0x4e3ced+=_0x1f8916[_0x4fa9e8(0x185)],_0x136ba3[_0x4fa9e8(0x254)]({'branchId':_0x2d8269['branchId']}));const _0x20fc3e=await _0x2ff0a8['aggregate']([{'$match':{'$and':_0x136ba3}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x4fa9e8(0x175)]();return _0x4e3ced=_0x1f8916[_0x4fa9e8(0x1f7)](_0x4fa9e8(0x17f)+_0x20fc3e[_0x4fa9e8(0x27a)]+_0x4fa9e8(0x1e0),_0x4e3ced),_0x33e132['send'](JSON[_0x4fa9e8(0x253)]({'searchFound':_0x20fc3e,'msg':_0x4e3ced,'isSearch':!0x0,'class':_0x1f8916['YNCKy']}));}else return _0x5a4071[_0x4fa9e8(0x174)](_0x316667),_0x5f26c8['send'](_0x107462['stringify']({'isLoad':!0x1,'class':_0x1f8916[_0x4fa9e8(0x1ba)],'msg':_0x4ba938['message']}));}catch(_0x4b26e8){if(_0x1f8916[_0x4fa9e8(0x14f)](_0x1f8916[_0x4fa9e8(0x2ce)],_0x1f8916['GUswG']))return console[_0x4fa9e8(0x174)](_0x4b26e8),_0x33e132[_0x4fa9e8(0x1b5)](JSON['stringify']({'isSearch':!0x1,'class':_0x1f8916[_0x4fa9e8(0x1ba)],'msg':_0x4b26e8[_0x4fa9e8(0x262)]}));else _0xe2cca4[_0x4fa9e8(0x1ae)]();}finally{if(_0x1f8916[_0x4fa9e8(0x1ac)](_0x1f8916[_0x4fa9e8(0x211)],_0x1f8916[_0x4fa9e8(0x211)])){if(_0x55b8d5){const _0x59bfcc=_0x5aeabc['apply'](_0x4b8c48,arguments);return _0x493f4e=null,_0x59bfcc;}}else _0x36ed87[_0x4fa9e8(0x1ae)]();}}),b[_0x46ae02(0x29a)](x,_0x1a7b19[_0x46ae02(0x25a)],async(_0x135d16,_0x212f4d)=>{const _0x33df01=_0x46ae02,_0x26bbd1={'aQsrT':_0x33df01(0x1ca),'BYntz':_0x33df01(0x2b9),'MiklN':function(_0x50e7a7,_0x594265){return _0x50e7a7(_0x594265);},'cePwm':function(_0x2a03dc,_0x3316d5){return _0x2a03dc!==_0x3316d5;},'yafVl':_0x33df01(0x1b4),'XhVJT':function(_0x46910b,_0x4cb477){return _0x46910b===_0x4cb477;},'JcUHg':_0x33df01(0x19c),'ElkUn':function(_0x253d41,_0x320ff5){return _0x253d41===_0x320ff5;},'zLeOU':'RdTgW','bBLYn':_0x33df01(0x297),'xJgFx':function(_0x5009b8,_0x587c79){return _0x5009b8===_0x587c79;},'ZPMsr':_0x33df01(0x2c6),'zOhyn':function(_0x43a983,_0x4e96d2){return _0x43a983==_0x4e96d2;},'WFPgf':_0x33df01(0x173),'kOjIb':_0x33df01(0x1b0),'wNNDk':function(_0x5436a9,_0x47e80e){return _0x5436a9==_0x47e80e;},'QRvFD':_0x33df01(0x198),'Hjeee':'qFpFr','hmPhw':_0x33df01(0x152),'FMgAC':function(_0x15381a,_0x1f9d7c){return _0x15381a===_0x1f9d7c;},'mFQlA':_0x33df01(0x24b),'aRqot':_0x33df01(0x23b)};let {docId:_0x17f5cf,action:_0x3c61cf}=_0x135d16[_0x33df01(0x236)];const _0xbbfdf1=await T[_0x33df01(0x2a2)](_0x135d16);await m['getMainDocPathObj'](_0x135d16,_0x212f4d,_0xbbfdf1[_0x33df01(0x1bd)]);const _0x2e0386=m[_0x33df01(0x16d)](_0x135d16['path']),_0x4f6480=new _0x160bee(global[_0x33df01(0x24d)]);try{if(_0x26bbd1[_0x33df01(0x1d5)](_0x26bbd1[_0x33df01(0x2bb)],_0x26bbd1['yafVl']))_0x3a3a4f[_0x33df01(0x1ae)]();else{await _0x4f6480['connect']();const _0xd8aaef=_0x4f6480['db'](global[_0x33df01(0x218)])[_0x33df01(0x2a4)](_0x2e0386[_0x33df01(0x240)]);if(_0x26bbd1['XhVJT'](_0x3c61cf,_0x26bbd1['JcUHg'])){if(_0x26bbd1[_0x33df01(0x1a5)](_0x26bbd1[_0x33df01(0x238)],_0x26bbd1[_0x33df01(0x238)])){const _0x55a045=['O','S'][_0x33df01(0x163)](_0xbbfdf1[_0x33df01(0x1bd)])?{'docId':_0x17f5cf}:{'docId':_0x17f5cf,'branchId':_0xbbfdf1['branchId']};var _0x302815=await _0xd8aaef[_0x33df01(0x252)](_0x55a045,{'projection':{'_id':0x0,'changesHistory':0x0}});}else _0x21909a['log'](_0x26bbd1[_0x33df01(0x1c3)],_0x283b0c),_0x364274[_0x33df01(0x1b5)](_0x2fbce1[_0x33df01(0x253)]({'isPrint':!0x1,'class':_0x26bbd1['BYntz'],'msg':_0x580afe[_0x33df01(0x262)]}));}else{if(_0x26bbd1[_0x33df01(0x1f4)](_0x3c61cf,_0x26bbd1['bBLYn']))var _0x302815=await _0xd8aaef[_0x33df01(0x252)]({'userId':_0xbbfdf1[_0x33df01(0x1f5)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x1e615=_0x302815?'':_0x26bbd1[_0x33df01(0x23d)](_0x3c61cf,_0x26bbd1[_0x33df01(0x20f)])?_0x33df01(0x180)+_0x17f5cf+'\x22':_0x26bbd1[_0x33df01(0x184)];if(!_0x302815)return _0x212f4d[_0x33df01(0x1b5)](JSON['stringify']({'isLoad':!0x1,'class':_0x26bbd1[_0x33df01(0x29d)],'msg':_0x1e615}));if(_0x26bbd1[_0x33df01(0x209)](_0x302815[_0x33df01(0x20b)],0x1)&&_0x302815[_0x33df01(0x192)]){if(_0x26bbd1['xJgFx'](_0x26bbd1[_0x33df01(0x145)],_0x26bbd1[_0x33df01(0x145)])){let _0x12ba26=await m['check_DocDateTime_CanEdit'](_0x302815,_0x2e0386[_0x33df01(0x240)],_0xbbfdf1[_0x33df01(0x1f5)]);_0x302815[_0x33df01(0x1dd)]=_0x12ba26[_0x33df01(0x1dd)],_0x26bbd1[_0x33df01(0x209)](_0x12ba26[_0x33df01(0x165)],!0x1)&&(_0x302815['docStatusNumber']=_0x12ba26[_0x33df01(0x20b)],msg+=_0x26bbd1[_0x33df01(0x267)]);}else _0x4b6c41[_0x33df01(0x1ae)]();}if((_0x26bbd1['zOhyn'](_0x302815[_0x33df01(0x20b)],0x1)||_0x26bbd1['wNNDk'](_0x302815[_0x33df01(0x20b)],0x2))&&_0x302815[_0x33df01(0x256)]){if(_0x26bbd1[_0x33df01(0x1f4)](_0x26bbd1['QRvFD'],_0x26bbd1[_0x33df01(0x291)])){const _0x258710=_0x2c03b8?function(){const _0x361795=_0x33df01;if(_0x458684){const _0x164b13=_0x216110[_0x361795(0x20d)](_0x5ae702,arguments);return _0x557e8a=null,_0x164b13;}}:function(){};return _0x2b122f=![],_0x258710;}else{const _0x3f5d20=await m[_0x33df01(0x28c)](_0x302815,_0x2e0386[_0x33df01(0x240)],_0xbbfdf1[_0x33df01(0x1f5)]);_0x302815[_0x33df01(0x288)]=_0x3f5d20[_0x33df01(0x288)];}}const {branchName:_0x4ac855}=await u['getUserBranchesById'](_0x302815[_0x33df01(0x259)]);return _0x302815[_0x33df01(0x1d9)]=_0x4ac855,_0x212f4d[_0x33df01(0x1b5)](JSON[_0x33df01(0x253)]({'doc':_0x302815,'isLoad':!0x0,'class':_0x26bbd1[_0x33df01(0x204)],'msg':_0x33df01(0x24f)+_0x302815[_0x33df01(0x229)]+'\x22\x20{{sep}}เรียบร้อยแล้ว','userId':_0xbbfdf1[_0x33df01(0x1f5)],'userAuthority':_0xbbfdf1[_0x33df01(0x1bd)]}));}}catch(_0x4b75ec){if(_0x26bbd1[_0x33df01(0x214)](_0x26bbd1[_0x33df01(0x189)],_0x26bbd1[_0x33df01(0x189)]))return console['log'](_0x4b75ec),_0x212f4d[_0x33df01(0x1b5)](JSON[_0x33df01(0x253)]({'isLoad':!0x1,'class':_0x26bbd1['BYntz'],'msg':_0x4b75ec['message']}));else qKIaAG[_0x33df01(0x2a8)](_0x199e30,0x0);}finally{_0x26bbd1[_0x33df01(0x1d5)](_0x26bbd1[_0x33df01(0x1f8)],_0x26bbd1[_0x33df01(0x1f8)])?_0x1a3b4d[_0x33df01(0x1ae)]():_0x4f6480[_0x33df01(0x1ae)]();}}),b[_0x46ae02(0x29a)](k,_0x1a7b19['isAuth'],async(_0x39a748,_0x2a3a79)=>{const _0x25adfd=_0x46ae02,_0x515ffb={'Ompda':_0x25adfd(0x2b9),'FJVYv':function(_0x4f1a2b,_0x552442){return _0x4f1a2b===_0x552442;},'ZwJxP':_0x25adfd(0x21f),'SrUsv':_0x25adfd(0x282),'aCkfN':function(_0x11cd90,_0x8d600f){return _0x11cd90<_0x8d600f;},'bpuiW':_0x25adfd(0x23c),'YEXWs':_0x25adfd(0x1d3),'hyrFB':'doc_changes.ejs','HdJAL':_0x25adfd(0x152),'syCSs':function(_0x5129e5,_0x58c90f){return _0x5129e5===_0x58c90f;},'kogSD':'EQvDs','TVIzV':_0x25adfd(0x1ca),'SSzJq':function(_0x43e345,_0x5e8356){return _0x43e345===_0x5e8356;},'RVUZu':_0x25adfd(0x1db),'AdCZC':_0x25adfd(0x156)},{docId:_0x32ea1a}=_0x39a748[_0x25adfd(0x236)],_0x48a88a=await T['getSessionData'](_0x39a748);await m[_0x25adfd(0x27d)](_0x39a748,_0x2a3a79,_0x48a88a[_0x25adfd(0x1bd)]);const {collectionName:_0x49387e}=m[_0x25adfd(0x16d)](_0x39a748[_0x25adfd(0x228)]),_0x53c3bd=new _0x160bee(global[_0x25adfd(0x24d)]);try{if(_0x515ffb[_0x25adfd(0x20e)](_0x515ffb[_0x25adfd(0x222)],_0x515ffb[_0x25adfd(0x1e8)]))return![];else{await _0x53c3bd[_0x25adfd(0x17d)]();var _0xa57578=await _0x53c3bd['db'](global[_0x25adfd(0x218)])['collection'](_0x49387e)[_0x25adfd(0x252)]({'docId':_0x32ea1a});if(!_0xa57578)return _0x2a3a79[_0x25adfd(0x1b5)](JSON[_0x25adfd(0x253)]({'isPrint':!0x1,'class':_0x515ffb[_0x25adfd(0x20a)],'msg':_0x25adfd(0x180)+_0x32ea1a+'\x22'}));const _0xa7962e=_0xa57578['changesHistory']||[];if(_0x515ffb[_0x25adfd(0x171)](_0xa7962e[_0x25adfd(0x27a)],0x1))return _0x2a3a79[_0x25adfd(0x1b5)](JSON['stringify']({'isPrint':!0x1,'class':_0x515ffb[_0x25adfd(0x1d4)],'msg':_0x515ffb[_0x25adfd(0x28d)]}));const _0x2ba938=_0x4eb561['join'](folderForms,_0x515ffb[_0x25adfd(0x2a5)]),_0xd36b1c=await C[_0x25adfd(0x276)](_0x2ba938,_0x2a3a79,{'title':_0x25adfd(0x24c)+_0xa57578[_0x25adfd(0x229)],'time':E[_0x25adfd(0x28a)](),'changesHistory':_0xa7962e});_0x2a3a79[_0x25adfd(0x1b5)](JSON[_0x25adfd(0x253)]({'isPrint':!0x0,'class':_0x515ffb[_0x25adfd(0x286)],'htmlPage':_0xd36b1c}));}}catch(_0x32eb18){if(_0x515ffb[_0x25adfd(0x2c9)](_0x515ffb[_0x25adfd(0x29b)],_0x515ffb[_0x25adfd(0x29b)]))console[_0x25adfd(0x174)](_0x515ffb[_0x25adfd(0x162)],_0x32eb18),_0x2a3a79[_0x25adfd(0x1b5)](JSON['stringify']({'isPrint':!0x1,'class':_0x515ffb[_0x25adfd(0x20a)],'msg':_0x32eb18['message']}));else return _0x545f4c[_0x25adfd(0x174)](_0x578894),_0x1ea311['send'](_0x1ef10a[_0x25adfd(0x253)]({'isSearch':!0x1,'class':_0x515ffb[_0x25adfd(0x20a)],'msg':_0x3a9a29[_0x25adfd(0x262)]}));}finally{_0x515ffb[_0x25adfd(0x2a7)](_0x515ffb['RVUZu'],_0x515ffb[_0x25adfd(0x177)])?(_0x856955[_0x25adfd(0x174)](_0x2b64a0),_0x482296[_0x25adfd(0x1b5)](_0xe8227[_0x25adfd(0x253)]({'isStatus':!0x1,'class':_0x515ffb[_0x25adfd(0x20a)],'msg':_0x34896c[_0x25adfd(0x262)]}))):_0x53c3bd[_0x25adfd(0x1ae)]();}}),b[_0x46ae02(0x29a)](L,_0x1a7b19['isAuth'],async(_0x5cb25d,_0xdf11f6)=>{const _0x336775=_0x46ae02,_0x55f9ea={'rkIRa':function(_0x5a8168,_0x2c1662){return _0x5a8168(_0x2c1662);},'hjHDL':function(_0xcf954a,_0x136335){return _0xcf954a+_0x136335;},'ArfkS':function(_0xf141be,_0x9ec907){return _0xf141be+_0x9ec907;},'PskPF':'return\x20(function()\x20','RbNNJ':_0x336775(0x231),'kSOfE':function(_0x3c0fd3){return _0x3c0fd3();},'LqIHz':_0x336775(0x174),'SRYJE':_0x336775(0x233),'hMBpx':_0x336775(0x27e),'QeiEW':_0x336775(0x220),'hgZXu':'exception','zvnlo':_0x336775(0x216),'oRclI':_0x336775(0x17e),'PTJjS':function(_0x5f22e8,_0x46ce17){return _0x5f22e8<_0x46ce17;},'MpPMN':function(_0x5beefb,_0x364042){return _0x5beefb!==_0x364042;},'ZHufF':'znUCT','jNFqd':_0x336775(0x247),'gRSzE':function(_0x274695,_0x3838e2){return _0x274695!==_0x3838e2;},'eargW':_0x336775(0x21d),'tzBLC':'red','QrNnu':_0x336775(0x278),'tsyqB':function(_0x3172eb,_0x3d753d){return _0x3172eb==_0x3d753d;},'JLMef':_0x336775(0x26a),'yjMBB':'green','QyEUq':function(_0x33d6e3,_0x2b5173){return _0x33d6e3==_0x2b5173;},'wWokA':'image','UBwmM':function(_0x4ad698,_0x2a25b1){return _0x4ad698===_0x2a25b1;},'BUkpI':'OFVQt','boTNR':_0x336775(0x1e7),'FIUzp':'puppeteer','MyGTD':_0x336775(0x227),'hOcCr':function(_0x160b10,_0x5b59d9){return _0x160b10*_0x5b59d9;},'AnKvc':function(_0x42d8c9,_0x5771ea){return _0x42d8c9/_0x5771ea;},'tUotv':_0x336775(0x22c),'FrKIP':_0x336775(0x14e),'VxAIE':_0x336775(0x1d1),'OTypf':_0x336775(0x239),'FBDFK':_0x336775(0x1ca),'dHtgi':function(_0x22aad0,_0x26d2a0){return _0x22aad0===_0x26d2a0;},'dguni':_0x336775(0x186),'SZduM':'EWfkK'},{docId:_0x56db39,action:_0x3f6d84}=_0x5cb25d[_0x336775(0x236)],_0x486815=await T['getSessionData'](_0x5cb25d);await m[_0x336775(0x27d)](_0x5cb25d,_0xdf11f6,_0x486815[_0x336775(0x1bd)]);const {collectionName:_0x492010,docTitle:_0x156786,docType:_0x5728ee}=m[_0x336775(0x16d)](_0x5cb25d['path']),_0x1bfa78=new _0x160bee(global[_0x336775(0x24d)]);try{if(_0x55f9ea[_0x336775(0x1a2)](_0x55f9ea[_0x336775(0x16c)],_0x55f9ea[_0x336775(0x16c)])){const _0x23a9ca=_0x434258['apply'](_0xc7932a,arguments);return _0xfe5b3=null,_0x23a9ca;}else{await _0x1bfa78[_0x336775(0x17d)]();var _0x315584=await _0x1bfa78['db'](global['dbName'])[_0x336775(0x2a4)](_0x492010)[_0x336775(0x252)]({'docId':_0x56db39});if(!_0x315584)return _0xdf11f6['send'](JSON[_0x336775(0x253)]({'isLoad':!0x1,'class':_0x55f9ea[_0x336775(0x290)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x56db39+'\x22'}));_0x315584[_0x336775(0x154)]=_0x156786,_0x315584[_0x336775(0x181)]=u[_0x336775(0x1a1)](_0x315584[_0x336775(0x20b)]);const _0x420dfb=u[_0x336775(0x235)](_0x315584);_0x420dfb[_0x336775(0x1ea)]&&(_0x420dfb['paymentMethod1Name']=global[_0x336775(0x2a0)][_0x336775(0x22f)](_0x570e5a=>_0x570e5a[_0x336775(0x280)]==_0x420dfb['paymentMethod1'])?.[_0x336775(0x158)]||''),_0x420dfb['paymentMethod2']&&(_0x420dfb[_0x336775(0x1c1)]=global[_0x336775(0x2a0)][_0x336775(0x22f)](_0x34e065=>_0x34e065[_0x336775(0x280)]==_0x420dfb[_0x336775(0x190)])?.[_0x336775(0x158)]||'');const _0x75a6ce=_0x4eb561[_0x336775(0x22b)](global[_0x336775(0x25b)],_0x55f9ea[_0x336775(0x1aa)]),_0x170608=await C[_0x336775(0x276)](_0x75a6ce,_0xdf11f6,{'title':_0x56db39,'time':E[_0x336775(0x29c)](0x0),'action':_0x3f6d84,'docType':_0x5728ee,'doc':_0x420dfb,'settings':await C[_0x336775(0x268)]()});if(_0x55f9ea[_0x336775(0x266)](_0x3f6d84,_0x55f9ea['JLMef']))_0xdf11f6[_0x336775(0x1b5)](JSON[_0x336775(0x253)]({'isPrint':!0x0,'class':_0x55f9ea[_0x336775(0x2ca)],'htmlPage':_0x170608}));else{if(_0x55f9ea[_0x336775(0x1b7)](_0x3f6d84,_0x55f9ea['wWokA'])){if(_0x55f9ea['UBwmM'](_0x55f9ea[_0x336775(0x157)],_0x55f9ea[_0x336775(0x193)]))return!![];else{const _0x191e5d=await(await import(_0x55f9ea[_0x336775(0x224)]))[_0x336775(0x263)](),_0x8671a6=await _0x191e5d[_0x336775(0x279)]();await _0x8671a6[_0x336775(0x29f)](_0x170608,{'waitUntil':_0x55f9ea[_0x336775(0x1be)],'timeout':0x2710}),await new Promise(_0x4ecda4=>setTimeout(_0x4ecda4,0x3e8));const _0x4e84a3=Math['floor'](_0x55f9ea[_0x336775(0x2d0)](_0x55f9ea[_0x336775(0x273)](0x50,25.4),0x60));await _0x8671a6['setViewport']({'width':_0x4e84a3,'height':0x258,'deviceScaleFactor':0x1});const _0x3947f8=await _0x8671a6['evaluate'](()=>{const _0x2e4b67=_0x336775;if(_0x55f9ea[_0x2e4b67(0x18e)](_0x55f9ea[_0x2e4b67(0x1fc)],_0x55f9ea['jNFqd'])){const _0x5047b8=document[_0x2e4b67(0x236)],_0x5c3f6e=document[_0x2e4b67(0x295)];return Math['max'](_0x5047b8[_0x2e4b67(0x19e)],_0x5047b8['offsetHeight'],_0x5c3f6e[_0x2e4b67(0x26d)],_0x5c3f6e[_0x2e4b67(0x19e)],_0x5c3f6e[_0x2e4b67(0x2a3)]);}else{let _0x459ec9;try{const _0x4ee7eb=ilzEYN[_0x2e4b67(0x1da)](_0x4cb2b5,ilzEYN[_0x2e4b67(0x15a)](ilzEYN[_0x2e4b67(0x230)](ilzEYN['PskPF'],ilzEYN[_0x2e4b67(0x24a)]),');'));_0x459ec9=ilzEYN['kSOfE'](_0x4ee7eb);}catch(_0x405322){_0x459ec9=_0x4ab062;}const _0x23498d=_0x459ec9[_0x2e4b67(0x205)]=_0x459ec9['console']||{},_0x114134=[ilzEYN[_0x2e4b67(0x283)],ilzEYN[_0x2e4b67(0x261)],ilzEYN[_0x2e4b67(0x249)],ilzEYN['QeiEW'],ilzEYN[_0x2e4b67(0x1df)],ilzEYN['zvnlo'],ilzEYN[_0x2e4b67(0x2ae)]];for(let _0x64b551=0x0;ilzEYN[_0x2e4b67(0x1c6)](_0x64b551,_0x114134['length']);_0x64b551++){const _0x5c9ed7=_0x212251[_0x2e4b67(0x2c4)][_0x2e4b67(0x160)][_0x2e4b67(0x1ff)](_0x55e24c),_0x1c5cc4=_0x114134[_0x64b551],_0x2b5fb3=_0x23498d[_0x1c5cc4]||_0x5c9ed7;_0x5c9ed7[_0x2e4b67(0x19a)]=_0x56d14b['bind'](_0x41e4fe),_0x5c9ed7['toString']=_0x2b5fb3[_0x2e4b67(0x26c)][_0x2e4b67(0x1ff)](_0x2b5fb3),_0x23498d[_0x1c5cc4]=_0x5c9ed7;}}}),_0x309b24=await _0x8671a6['screenshot']({'type':_0x55f9ea[_0x336775(0x293)],'clip':{'x':0x0,'y':0x0,'width':_0x4e84a3,'height':_0x3947f8},'omitBackground':!0x1});await _0x191e5d['close']();const _0x35de60=_0x315584[_0x336775(0x229)]['replace'](/\//g,'');_0xdf11f6['writeHead'](0xc8,{'Content-Type':_0x55f9ea[_0x336775(0x16e)],'Content-Disposition':_0x336775(0x1cd)+_0x35de60+_0x336775(0x1e1),'Content-Length':_0x309b24[_0x336775(0x27a)]}),_0xdf11f6[_0x336775(0x251)](_0x309b24);}}}}}catch(_0x6e65b0){if(_0x55f9ea[_0x336775(0x1a2)](_0x55f9ea[_0x336775(0x299)],_0x55f9ea['OTypf']))console['log'](_0x55f9ea['FBDFK'],_0x6e65b0),_0xdf11f6[_0x336775(0x1b5)](JSON[_0x336775(0x253)]({'isPrint':!0x1,'class':_0x55f9ea[_0x336775(0x290)],'msg':_0x6e65b0['message']}));else{if(_0x562373){const _0x11b58a=_0x2b7229['apply'](_0x37056d,arguments);return _0x129f69=null,_0x11b58a;}}}finally{if(_0x55f9ea[_0x336775(0x1fa)](_0x55f9ea[_0x336775(0x2bd)],_0x55f9ea[_0x336775(0x272)])){const _0x4eec1f=_0x31f40a?function(){const _0x26b95d=_0x336775;if(_0x4e7dc7){const _0xf76b8f=_0x5dd9c0[_0x26b95d(0x20d)](_0x4a8ec,arguments);return _0x21e0b3=null,_0xf76b8f;}}:function(){};return _0x2f355d=![],_0x4eec1f;}else _0x1bfa78[_0x336775(0x1ae)]();}}),b['post'](B,_0x1a7b19[_0x46ae02(0x25a)],async(_0xc478b6,_0x1c7c18)=>{const _0x9157c4=_0x46ae02,_0x4ee1f1={'pgQyt':_0x9157c4(0x2b9),'uAnBm':function(_0x22ef9a,_0x112e9c){return _0x22ef9a(_0x112e9c);},'zapVN':function(_0x474f25,_0x41e3a2){return _0x474f25+_0x41e3a2;},'RLmOE':_0x9157c4(0x25d),'tUIUv':_0x9157c4(0x231),'hogRJ':function(_0x58ecd9){return _0x58ecd9();},'HPJBw':function(_0xf7a6dc,_0x5104ca){return _0xf7a6dc+_0x5104ca;},'rIqqy':'debu','PfSnX':_0x9157c4(0x1c2),'HJwkD':'stateObject','kBPyy':function(_0x50efd9,_0x3f0a21){return _0x50efd9==_0x3f0a21;},'FDcem':_0x9157c4(0x141),'WfdgP':_0x9157c4(0x155),'sYsPp':_0x9157c4(0x1c7),'SwQcc':_0x9157c4(0x2a1),'nVdls':function(_0xafd0fe,_0x54f8d2){return _0xafd0fe===_0x54f8d2;},'QeFIo':_0x9157c4(0x1b1),'isCqr':function(_0x5743f5,_0x2b21d3){return _0x5743f5===_0x2b21d3;},'Iwwwd':function(_0x5d248a,_0x1b48e3){return _0x5d248a==_0x1b48e3;},'iTVLT':_0x9157c4(0x1bb),'JGfcS':function(_0x4d74b2,_0x1ae8b4){return _0x4d74b2==_0x1ae8b4;},'GPTnD':function(_0x3a65e7,_0x1b9b9f){return _0x3a65e7!==_0x1b9b9f;},'ExCWF':'BzlOL','viaxu':function(_0x16d86b,_0x1f7b78){return _0x16d86b==_0x1f7b78;},'hVGzl':function(_0xee1f39,_0x4b3efa){return _0xee1f39>_0x4b3efa;},'BfCco':function(_0x101fbc,_0x4ca800){return _0x101fbc==_0x4ca800;},'RendG':function(_0x148909,_0x483758){return _0x148909==_0x483758;},'udzaw':'UDmzc','SyAdw':'AoKEn','mhafG':function(_0x21fca9,_0x485de9){return _0x21fca9===_0x485de9;},'OIpHN':_0x9157c4(0x1c4),'SIssO':_0x9157c4(0x161),'OIEQQ':_0x9157c4(0x17b),'xAWWp':_0x9157c4(0x152),'KoqAQ':function(_0x8fb59c,_0x57c7d3){return _0x8fb59c<_0x57c7d3;},'WwZBw':_0x9157c4(0x23c)},_0x243ca3=new _0x160bee(global[_0x9157c4(0x24d)]);try{const _0x3acf0b=await T[_0x9157c4(0x2b8)](_0xc478b6);await m[_0x9157c4(0x27d)](_0xc478b6,_0x1c7c18,_0x3acf0b[_0x9157c4(0x1bd)]);const {collectionName:_0x4042da}=m[_0x9157c4(0x16d)](_0xc478b6[_0x9157c4(0x228)]),{docId:_0x45f655,action:_0x187d26}=_0xc478b6[_0x9157c4(0x236)],_0x23c80d=_0x4ee1f1['kBPyy'](_0x187d26,_0x4ee1f1['FDcem'])?_0x4ee1f1[_0x9157c4(0x17a)]:_0x4ee1f1['kBPyy'](_0x187d26,_0x4ee1f1['sYsPp'])?'จบ':'';if(!_0x45f655||![_0x4ee1f1['sYsPp'],_0x4ee1f1[_0x9157c4(0x197)]][_0x9157c4(0x163)](_0x187d26))return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':_0x4ee1f1[_0x9157c4(0x245)]}));const _0x14ffab={'docId':_0x45f655,'userId':_0x3acf0b['userId']},_0xc748b2=_0x243ca3['db'](global[_0x9157c4(0x218)])[_0x9157c4(0x2a4)](_0x4042da),_0x569f77=await _0xc748b2[_0x9157c4(0x252)](_0x14ffab);if(!_0x569f77)return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x45f655+'{{sep}}หรือไม่มีสิทธิ์'+_0x23c80d+_0x9157c4(0x1fd)}));const _0x203d01=_0x569f77[_0x9157c4(0x20b)];if(_0x4ee1f1[_0x9157c4(0x23f)](_0x187d26,_0x4ee1f1['FDcem'])&&!(_0x4ee1f1['kBPyy'](_0x203d01,0x1)||_0x4ee1f1[_0x9157c4(0x19f)](_0x203d01,0x2)))return _0x1c7c18['send'](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1['pgQyt'],'msg':_0x4ee1f1[_0x9157c4(0x219)]}));if(_0x4ee1f1[_0x9157c4(0x1a7)](_0x187d26,_0x4ee1f1[_0x9157c4(0x179)])&&_0x4ee1f1['Iwwwd'](!_0x203d01,0x1))return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':_0x4ee1f1[_0x9157c4(0x1f1)]}));if(_0x4ee1f1[_0x9157c4(0x183)](_0x187d26,_0x4ee1f1[_0x9157c4(0x197)])){if(_0x4ee1f1[_0x9157c4(0x22a)](_0x4ee1f1[_0x9157c4(0x2bf)],_0x4ee1f1[_0x9157c4(0x2bf)]))return _0x3fcbac['log'](_0xd967dc),_0x12c829[_0x9157c4(0x1b5)](_0x4211c8['stringify']({'isFetch':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':_0x38b056[_0x9157c4(0x262)]}));else{if(_0x4ee1f1['Iwwwd'](_0x569f77['canCancel'],!0x1))return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':_0x9157c4(0x1e6)+_0x45f655+_0x9157c4(0x170)}));if(_0x4ee1f1[_0x9157c4(0x1eb)]((await m['check_DocDateTime_CanCancel'](_0x569f77,_0x4042da,_0x3acf0b[_0x9157c4(0x1f5)]))['canCancel'],!0x1))return _0x1c7c18[_0x9157c4(0x1b5)](JSON['stringify']({'isStatus':!0x1,'class':_0x4ee1f1['pgQyt'],'msg':'เอกสาร\x20\x22'+_0x45f655+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}}if(_0x569f77[_0x9157c4(0x187)]&&_0x4ee1f1[_0x9157c4(0x1bf)](_0x569f77[_0x9157c4(0x187)][_0x9157c4(0x27a)],0x0))return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1[_0x9157c4(0x1ab)],'msg':_0x9157c4(0x1e6)+_0x45f655+_0x9157c4(0x2a6)}));if(_0x4ee1f1[_0x9157c4(0x1ed)](_0x187d26,_0x4ee1f1[_0x9157c4(0x197)]))var _0x4d8b05=0xa;else{if(_0x4ee1f1['RendG'](_0x187d26,_0x4ee1f1[_0x9157c4(0x179)]))var _0x4d8b05=0x2;}const _0xaab621=await _0xc748b2[_0x9157c4(0x1f9)](_0x14ffab,{'$set':{'docStatusNumber':_0x4d8b05}});var _0x5e47f4=_0x23c80d+'\x20\x22'+_0x45f655+'\x22\x20เรียบร้อยแล้ว';if(_0xaab621[_0x9157c4(0x169)]||_0x4ee1f1[_0x9157c4(0x1bf)](_0xaab621[_0x9157c4(0x2ac)],0x0)){if(_0x4ee1f1[_0x9157c4(0x22a)](_0x4ee1f1[_0x9157c4(0x258)],_0x4ee1f1['SyAdw'])){const _0x5a8700=u[_0x9157c4(0x215)]({'docStatusNumber':_0x203d01},{'docStatusNumber':_0x4d8b05});if(_0x4ee1f1[_0x9157c4(0x1bf)](_0x5a8700[_0x9157c4(0x27a)],0x0)){if(_0x4ee1f1[_0x9157c4(0x18a)](_0x4ee1f1[_0x9157c4(0x14a)],_0x4ee1f1['SIssO'])){const _0x2ca927=RSMpjx[_0x9157c4(0x255)](_0x31344b,RSMpjx[_0x9157c4(0x246)](RSMpjx['zapVN'](RSMpjx[_0x9157c4(0x1cb)],RSMpjx['tUIUv']),');'));_0x224a2c=RSMpjx[_0x9157c4(0x2b7)](_0x2ca927);}else{const _0x12391a={'dateTime':E[_0x9157c4(0x28a)](),'userId':_0x3acf0b['userId'],'userFullname':_0x3acf0b[_0x9157c4(0x144)],'changes':_0x5a8700};await _0xc748b2['updateOne']({'docId':_0x45f655},{'$push':{'changesHistory':{'$each':[_0x12391a],'$position':0x0}}}),_0x5e47f4+=_0x4ee1f1['OIEQQ'];}}return _0x1c7c18[_0x9157c4(0x1b5)](JSON['stringify']({'isStatus':!0x0,'docId':_0x45f655,'docStatusNumber':_0x4d8b05,'class':_0x4ee1f1[_0x9157c4(0x1cf)],'msg':_0x5e47f4}));}else(function(){return![];}['constructor'](RSMpjx['HPJBw'](RSMpjx[_0x9157c4(0x2ba)],RSMpjx['PfSnX']))[_0x9157c4(0x20d)](RSMpjx[_0x9157c4(0x1cc)]));}else{if(_0xaab621[_0x9157c4(0x169)]&&_0x4ee1f1[_0x9157c4(0x206)](_0xaab621[_0x9157c4(0x2ac)],0x1))return _0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'docId':_0x45f655,'docStatusNumber':_0x203d01,'class':_0x4ee1f1['WwZBw'],'msg':'\x22'+_0x45f655+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x1975a4){console[_0x9157c4(0x174)](_0x1975a4),_0x1c7c18[_0x9157c4(0x1b5)](JSON[_0x9157c4(0x253)]({'isStatus':!0x1,'class':_0x4ee1f1['pgQyt'],'msg':_0x1975a4[_0x9157c4(0x262)]}));}finally{_0x243ca3['close']();}});export default b;function _0x3d8350(_0x53a3b7){const _0x4f8d20=_0x46ae02,_0x53e0c3={'daPbA':function(_0x1f3375,_0x318e77){return _0x1f3375===_0x318e77;},'Ophem':'string','pPnPx':'while\x20(true)\x20{}','XrYVF':_0x4f8d20(0x16a),'xQOGx':function(_0x4218d3,_0x395485){return _0x4218d3!==_0x395485;},'nRBkG':function(_0x294f47,_0x14e12d){return _0x294f47+_0x14e12d;},'ICGBp':function(_0x45aa0a,_0x15e3d9){return _0x45aa0a/_0x15e3d9;},'fwbmu':_0x4f8d20(0x27a),'JyeOE':function(_0x5368fe,_0x533726){return _0x5368fe===_0x533726;},'tvrlC':function(_0x5270a3,_0x59f5bf){return _0x5270a3%_0x59f5bf;},'KKRWx':'debu','NIOvF':_0x4f8d20(0x1c2),'NDjzy':_0x4f8d20(0x1ad),'LomSg':function(_0x3610d2,_0x490b8e){return _0x3610d2+_0x490b8e;},'upopj':_0x4f8d20(0x2b5),'AxIBd':function(_0x2f197b,_0x4c554d){return _0x2f197b(_0x4c554d);},'VeJEr':function(_0x212eaa,_0x52c98d){return _0x212eaa(_0x52c98d);}};function _0x1bbcf6(_0x4c16d8){const _0x48841e=_0x4f8d20;if(_0x53e0c3['daPbA'](typeof _0x4c16d8,_0x53e0c3[_0x48841e(0x17c)]))return function(_0x2ae35b){}['constructor'](_0x53e0c3[_0x48841e(0x2b0)])[_0x48841e(0x20d)](_0x53e0c3['XrYVF']);else _0x53e0c3[_0x48841e(0x27f)](_0x53e0c3[_0x48841e(0x2c7)]('',_0x53e0c3[_0x48841e(0x164)](_0x4c16d8,_0x4c16d8))[_0x53e0c3['fwbmu']],0x1)||_0x53e0c3['JyeOE'](_0x53e0c3[_0x48841e(0x21b)](_0x4c16d8,0x14),0x0)?function(){return!![];}[_0x48841e(0x2c4)](_0x53e0c3['nRBkG'](_0x53e0c3[_0x48841e(0x223)],_0x53e0c3[_0x48841e(0x1e9)]))[_0x48841e(0x25f)](_0x53e0c3['NDjzy']):function(){return![];}['constructor'](_0x53e0c3[_0x48841e(0x1d7)](_0x53e0c3['KKRWx'],_0x53e0c3[_0x48841e(0x1e9)]))['apply'](_0x53e0c3[_0x48841e(0x234)]);_0x53e0c3[_0x48841e(0x1ee)](_0x1bbcf6,++_0x4c16d8);}try{if(_0x53a3b7)return _0x1bbcf6;else _0x53e0c3[_0x4f8d20(0x15b)](_0x1bbcf6,0x0);}catch(_0x32d1ca){}}