const _0xf5a145=_0x382a;(function(_0x1fc1c6,_0x54a69d){const _0x5d3f53=_0x382a,_0x130fc8=_0x1fc1c6();while(!![]){try{const _0x959640=-parseInt(_0x5d3f53(0xca))/0x1+-parseInt(_0x5d3f53(0xf0))/0x2+-parseInt(_0x5d3f53(0x127))/0x3+parseInt(_0x5d3f53(0x1d6))/0x4+parseInt(_0x5d3f53(0x124))/0x5+-parseInt(_0x5d3f53(0x15d))/0x6*(parseInt(_0x5d3f53(0x11e))/0x7)+parseInt(_0x5d3f53(0x160))/0x8;if(_0x959640===_0x54a69d)break;else _0x130fc8['push'](_0x130fc8['shift']());}catch(_0x5921c3){_0x130fc8['push'](_0x130fc8['shift']());}}}(_0x2606,0x45234));const _0x50a74f=(function(){const _0x158db0=_0x382a,_0x14b52f={'HkWKa':function(_0x441c48,_0xce71d3){return _0x441c48(_0xce71d3);},'sEonr':function(_0x1b18ac,_0xa77b62){return _0x1b18ac===_0xa77b62;},'xJkQX':_0x158db0(0x1ac),'LoMxn':function(_0x371e57,_0x4d85da){return _0x371e57!==_0x4d85da;},'OHsTM':_0x158db0(0x22a),'FKnVp':_0x158db0(0x122),'raSgT':'TgUii','Bcvza':_0x158db0(0xfb)};let _0x2c9d27=!![];return function(_0x207265,_0x29a83c){const _0x31fe3c=_0x158db0,_0x44af45={'xlIOr':function(_0x2c9704,_0x528c29){const _0x132b89=_0x382a;return _0x14b52f[_0x132b89(0x1d7)](_0x2c9704,_0x528c29);}};if(_0x14b52f[_0x31fe3c(0x1de)](_0x14b52f['raSgT'],_0x14b52f['Bcvza'])){const _0x7fe147=_0x2c9d27?function(){const _0x28b8e9=_0x31fe3c,_0x4d7e0b={'vjoSa':function(_0x115d47,_0x1d3910){const _0xfd1b35=_0x382a;return _0x14b52f[_0xfd1b35(0x1d7)](_0x115d47,_0x1d3910);},'yvebd':function(_0x27ce33,_0x1a3a43){const _0x4f16e6=_0x382a;return _0x14b52f[_0x4f16e6(0x1d7)](_0x27ce33,_0x1a3a43);}};if(_0x14b52f['sEonr'](_0x14b52f[_0x28b8e9(0x208)],_0x14b52f[_0x28b8e9(0x208)])){if(_0x29a83c){if(_0x14b52f[_0x28b8e9(0x1de)](_0x14b52f[_0x28b8e9(0x1b7)],_0x14b52f['FKnVp'])){const _0x462c38=_0x29a83c['apply'](_0x207265,arguments);return _0x29a83c=null,_0x462c38;}else _0x4d7e0b[_0x28b8e9(0xeb)](_0x2d8161,0x0);}}else _0x4d7e0b['yvebd'](_0x400f1f,'0');}:function(){};return _0x2c9d27=![],_0x7fe147;}else{if(_0x58894a)return _0x23b85a;else _0x44af45[_0x31fe3c(0x1ed)](_0x3d692c,0x0);}};}());(function(){const _0x595d75=_0x382a,_0x337308={'UXNDU':_0x595d75(0x17d),'bPLtu':_0x595d75(0x225),'XYqZB':function(_0x5b04e5,_0x2ac1e6){return _0x5b04e5(_0x2ac1e6);},'FGXbg':_0x595d75(0x159),'zxlUo':function(_0x3118d1,_0x3f1843){return _0x3118d1+_0x3f1843;},'fxYqu':_0x595d75(0x10e),'psgeX':function(_0x5d8419,_0x5a8897){return _0x5d8419+_0x5a8897;},'MwnUJ':_0x595d75(0x17b),'YCOtT':function(_0x1d4022,_0x3de555){return _0x1d4022(_0x3de555);},'JszZg':function(_0x14c1e6){return _0x14c1e6();},'bPMir':function(_0x21dc94){return _0x21dc94();},'eYVBu':_0x595d75(0x1e6),'fvJdc':_0x595d75(0x108),'HxfsJ':function(_0x43a55a,_0x43c814){return _0x43a55a!==_0x43c814;},'vJdwK':_0x595d75(0x1be),'TVKYQ':function(_0x39ae33,_0x809f78){return _0x39ae33(_0x809f78);},'YZYWn':function(_0x5890d0,_0x530782){return _0x5890d0+_0x530782;},'YJLLx':function(_0x5f24b9,_0x33145c){return _0x5f24b9===_0x33145c;},'rcguS':_0x595d75(0x210),'kSbSR':'fhuPW','HQVsa':function(_0x11e477,_0x42da87){return _0x11e477(_0x42da87);},'xHVdC':function(_0x262b33,_0x455664){return _0x262b33!==_0x455664;},'eQgmp':_0x595d75(0x167),'dgZTv':function(_0x880d22){return _0x880d22();},'pjeIh':function(_0xda8c61,_0x44e160,_0x46084a){return _0xda8c61(_0x44e160,_0x46084a);}};_0x337308['pjeIh'](_0x50a74f,this,function(){const _0x69bd80=_0x595d75,_0x5672c8={'BOiFg':_0x337308[_0x69bd80(0x131)],'MWmcG':_0x337308['fvJdc']};if(_0x337308[_0x69bd80(0xe9)](_0x337308['vJdwK'],_0x337308[_0x69bd80(0x219)])){const _0x574b6e=new _0x4e6297(_0x337308[_0x69bd80(0x22d)]),_0x27a5a4=new _0x568899(_0x337308['bPLtu'],'i'),_0x155dbe=_0x337308[_0x69bd80(0x19e)](_0x5de659,_0x337308[_0x69bd80(0xfc)]);!_0x574b6e[_0x69bd80(0xe7)](_0x337308[_0x69bd80(0x1ef)](_0x155dbe,_0x337308[_0x69bd80(0x100)]))||!_0x27a5a4[_0x69bd80(0xe7)](_0x337308['psgeX'](_0x155dbe,_0x337308[_0x69bd80(0x1f3)]))?_0x337308[_0x69bd80(0x141)](_0x155dbe,'0'):_0x337308[_0x69bd80(0x1e3)](_0x1eafd4);}else{const _0x51422e=new RegExp(_0x337308[_0x69bd80(0x22d)]),_0x25af62=new RegExp(_0x337308[_0x69bd80(0x152)],'i'),_0x1fe3d6=_0x337308[_0x69bd80(0x226)](_0x9d0cc1,_0x337308[_0x69bd80(0xfc)]);!_0x51422e[_0x69bd80(0xe7)](_0x337308[_0x69bd80(0x16f)](_0x1fe3d6,_0x337308[_0x69bd80(0x100)]))||!_0x25af62[_0x69bd80(0xe7)](_0x337308[_0x69bd80(0x1ef)](_0x1fe3d6,_0x337308[_0x69bd80(0x1f3)]))?_0x337308[_0x69bd80(0x140)](_0x337308[_0x69bd80(0x14e)],_0x337308['kSbSR'])?(_0x2e4109[_0x69bd80(0x102)](_0x5672c8[_0x69bd80(0x13f)],_0x18441a),_0x234e18[_0x69bd80(0xdc)](_0x4838ba[_0x69bd80(0x1b6)]({'isPrint':!0x1,'class':_0x5672c8[_0x69bd80(0x1d9)],'msg':_0xcb627d[_0x69bd80(0x193)]}))):_0x337308[_0x69bd80(0xd5)](_0x1fe3d6,'0'):_0x337308[_0x69bd80(0x1b1)](_0x337308[_0x69bd80(0x109)],_0x337308[_0x69bd80(0x109)])?_0x337308[_0x69bd80(0x200)](_0x46dfd0):_0x337308[_0x69bd80(0x199)](_0x9d0cc1);}})();}());const _0x2ece91=(function(){const _0x5d3576=_0x382a,_0x307a61={'aaLdl':function(_0x3740bd,_0x926ba3){return _0x3740bd!==_0x926ba3;},'KkkAV':_0x5d3576(0x12e),'GrDql':_0x5d3576(0x202),'QPhJD':function(_0x13c7a1,_0x9f3fb9){return _0x13c7a1===_0x9f3fb9;},'GJKKA':_0x5d3576(0x133),'ibbru':_0x5d3576(0x17d),'lTFXB':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','LIDWB':function(_0xa9f16,_0x7868ae){return _0xa9f16(_0x7868ae);},'Xtwst':_0x5d3576(0x159),'DmHlr':function(_0x34741e,_0x478c74){return _0x34741e+_0x478c74;},'wBqhS':'chain','HUapG':_0x5d3576(0x17b),'TFCFV':function(_0x509baf){return _0x509baf();},'NSJuU':function(_0x100474,_0x405065,_0x2d34b4){return _0x100474(_0x405065,_0x2d34b4);},'qUAoV':_0x5d3576(0x230)};let _0x5b9aef=!![];return function(_0x33a31a,_0x367f3b){const _0x52e0cf=_0x5d3576,_0x56f72a={'kqosC':_0x307a61[_0x52e0cf(0xf1)],'pCKyn':_0x307a61['lTFXB'],'CxNZi':function(_0x4b224b,_0x20a5d3){const _0x29f572=_0x52e0cf;return _0x307a61[_0x29f572(0x19a)](_0x4b224b,_0x20a5d3);},'ZTREs':_0x307a61[_0x52e0cf(0xe4)],'isozY':function(_0x6932c3,_0x13e19f){return _0x307a61['DmHlr'](_0x6932c3,_0x13e19f);},'wONsr':_0x307a61[_0x52e0cf(0x1a8)],'bCwMx':_0x307a61['HUapG'],'RyzFk':function(_0xf9e2a7){const _0x4e625f=_0x52e0cf;return _0x307a61[_0x4e625f(0x1f2)](_0xf9e2a7);},'VqTYy':function(_0x5968c9,_0x520d1c,_0x3431e1){return _0x307a61['NSJuU'](_0x5968c9,_0x520d1c,_0x3431e1);}};if(_0x307a61[_0x52e0cf(0x180)](_0x307a61[_0x52e0cf(0x22f)],_0x307a61[_0x52e0cf(0x22f)])){const _0x253923=_0x5b9aef?function(){const _0x75d0fd=_0x52e0cf;if(_0x307a61[_0x75d0fd(0x229)](_0x307a61[_0x75d0fd(0x117)],_0x307a61[_0x75d0fd(0x12f)])){if(_0x367f3b){if(_0x307a61[_0x75d0fd(0x180)](_0x307a61[_0x75d0fd(0x1c4)],_0x307a61['GJKKA'])){const _0x10add4=_0x367f3b[_0x75d0fd(0x19c)](_0x33a31a,arguments);return _0x367f3b=null,_0x10add4;}else{const _0x1c4ace={'eIXFR':_0x56f72a['kqosC'],'fudoe':_0x56f72a[_0x75d0fd(0xf9)],'QmzBi':function(_0x3e4712,_0x349192){const _0x245140=_0x75d0fd;return _0x56f72a[_0x245140(0x165)](_0x3e4712,_0x349192);},'oagWi':_0x56f72a['ZTREs'],'FdDwq':function(_0x52b2c5,_0x44c07f){const _0x5a546a=_0x75d0fd;return _0x56f72a[_0x5a546a(0x10f)](_0x52b2c5,_0x44c07f);},'cFDVu':_0x56f72a[_0x75d0fd(0x125)],'pGAeZ':_0x56f72a[_0x75d0fd(0x201)],'IgutC':function(_0x4aeaaa){const _0x27e8c3=_0x75d0fd;return _0x56f72a[_0x27e8c3(0x189)](_0x4aeaaa);}};_0x56f72a['VqTYy'](_0x514143,this,function(){const _0x3141d1=_0x75d0fd,_0x5a22f0=new _0x3e28f3(_0x1c4ace[_0x3141d1(0x23b)]),_0x2d1f04=new _0xd134a3(_0x1c4ace[_0x3141d1(0xef)],'i'),_0x54e1f1=_0x1c4ace['QmzBi'](_0x1d9a7d,_0x1c4ace[_0x3141d1(0x1b4)]);!_0x5a22f0['test'](_0x1c4ace[_0x3141d1(0x216)](_0x54e1f1,_0x1c4ace['cFDVu']))||!_0x2d1f04[_0x3141d1(0xe7)](_0x1c4ace['FdDwq'](_0x54e1f1,_0x1c4ace[_0x3141d1(0x186)]))?_0x1c4ace[_0x3141d1(0x11d)](_0x54e1f1,'0'):_0x1c4ace['IgutC'](_0x4e2067);})();}}}else{if(_0x4dc7cf){const _0x3ce5c1=_0x36fae6[_0x75d0fd(0x19c)](_0x3aa58e,arguments);return _0x508d5d=null,_0x3ce5c1;}}}:function(){};return _0x5b9aef=![],_0x253923;}else return!![];};}()),_0x14593f=_0x2ece91(this,function(){const _0x2364c0=_0x382a,_0x4f87a7={'ljjtp':function(_0x1db45b,_0x10a3dc){return _0x1db45b!==_0x10a3dc;},'VobWQ':_0x2364c0(0x15f),'ziprP':function(_0x37b1f4,_0x459314){return _0x37b1f4===_0x459314;},'jntci':_0x2364c0(0x17c),'nlwuV':'oGWzr','sGUDR':function(_0x48e852,_0x4a3e6c){return _0x48e852(_0x4a3e6c);},'xNbML':function(_0x5762d8,_0x335349){return _0x5762d8+_0x335349;},'NdrZs':function(_0x44d9aa,_0x40f46f){return _0x44d9aa+_0x40f46f;},'yqjAr':_0x2364c0(0xe5),'XABHI':_0x2364c0(0x236),'CnRpK':function(_0x42a05a,_0x5d0ed0){return _0x42a05a!==_0x5d0ed0;},'NUUkd':_0x2364c0(0x21b),'GnGjS':_0x2364c0(0x1b0),'omBiK':function(_0x3fed28){return _0x3fed28();},'tpopB':_0x2364c0(0x102),'COVsf':_0x2364c0(0x113),'GvzJq':'info','wtcvz':_0x2364c0(0x1c7),'UFxgi':_0x2364c0(0x1ce),'vUsKo':_0x2364c0(0x1e4),'ZybZd':_0x2364c0(0x1db),'IvlIy':function(_0x367f9b,_0x2919a8){return _0x367f9b<_0x2919a8;},'xEgEU':'YzslO'},_0xe182c1=function(){const _0x348642=_0x2364c0;if(_0x4f87a7[_0x348642(0x18b)](_0x4f87a7[_0x348642(0xea)],_0x4f87a7[_0x348642(0xea)]))_0x659325=_0x91b3ad;else{let _0x462172;try{if(_0x4f87a7[_0x348642(0x16b)](_0x4f87a7[_0x348642(0x22c)],_0x4f87a7[_0x348642(0x18c)])){const _0x565511=_0x52bffc?function(){const _0x30770c=_0x348642;if(_0x3a037e){const _0x42f12f=_0x3d282b[_0x30770c(0x19c)](_0x3097b6,arguments);return _0x5444cb=null,_0x42f12f;}}:function(){};return _0x12b12a=![],_0x565511;}else _0x462172=_0x4f87a7[_0x348642(0x194)](Function,_0x4f87a7[_0x348642(0x11a)](_0x4f87a7[_0x348642(0x1d3)](_0x4f87a7[_0x348642(0x232)],_0x4f87a7[_0x348642(0x1bc)]),');'))();}catch(_0xd7b98b){if(_0x4f87a7[_0x348642(0x20b)](_0x4f87a7['NUUkd'],_0x4f87a7[_0x348642(0xe6)]))_0x462172=window;else{const _0x3f50d0=_0x170120[_0x348642(0x19c)](_0x5b9906,arguments);return _0x800178=null,_0x3f50d0;}}return _0x462172;}},_0x222e88=_0x4f87a7['omBiK'](_0xe182c1),_0x28398d=_0x222e88[_0x2364c0(0xe8)]=_0x222e88[_0x2364c0(0xe8)]||{},_0x3a7aa0=[_0x4f87a7[_0x2364c0(0x1b5)],_0x4f87a7[_0x2364c0(0x215)],_0x4f87a7['GvzJq'],_0x4f87a7[_0x2364c0(0xfd)],_0x4f87a7['UFxgi'],_0x4f87a7[_0x2364c0(0x224)],_0x4f87a7[_0x2364c0(0x1c0)]];for(let _0xaa8088=0x0;_0x4f87a7['IvlIy'](_0xaa8088,_0x3a7aa0[_0x2364c0(0x1fe)]);_0xaa8088++){if(_0x4f87a7[_0x2364c0(0x18b)](_0x4f87a7[_0x2364c0(0x18a)],_0x4f87a7[_0x2364c0(0x18a)]))_0x447631['close']();else{const _0x5f014a=_0x2ece91[_0x2364c0(0x10c)][_0x2364c0(0x1af)]['bind'](_0x2ece91),_0x4bfe71=_0x3a7aa0[_0xaa8088],_0xd8072d=_0x28398d[_0x4bfe71]||_0x5f014a;_0x5f014a['__proto__']=_0x2ece91['bind'](_0x2ece91),_0x5f014a[_0x2364c0(0xf4)]=_0xd8072d['toString'][_0x2364c0(0x1a7)](_0xd8072d),_0x28398d[_0x4bfe71]=_0x5f014a;}}});_0x14593f();import _0x3682b8 from'express';const b=_0x3682b8['Router']();import _0x53e79d from'path';import{MongoClient as _0x22b93d}from'mongodb';import _0x14a551 from'../middleware/mainAuth.js';function _0x2606(){const _0x4fc3d6=['VobWQ','vjoSa','PATH_WAREHOUSE_IN','scrollHeight','MOhRl','fudoe','847288wrNkUm','ibbru','gVZuA','CZyAX','toString','jpeg','collection','klvgU','ZEkTx','pCKyn','finish','cydkQ','FGXbg','wtcvz','YGSzx','qWpVa','fxYqu','NtLry','log','DpREn','mjKep','kQrQx','rNVRE','userAuthority','red','eQgmp','counter','../','constructor','IVtex','chain','isozY','fMkre','YbMdG','nepcj','warn','IOeuZ','branchId','โหลดเอกสารเลขที่\x20\x22','KkkAV','DOC_TYPE','GQFlu','xNbML','KwGfV','iNZLL','QmzBi','22862BmdkhW','ไม่พบเอกสารเลขที่\x20\x22','eHtBw','ziHbi','xYxVv','WqTkL','2384645VOdqHs','wONsr','iAXua','1021968tDYYtu','fLXUG','userId','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','get_StatusName_byStatusNumber','WOjUz','/print','pBEtI','GrDql','check_DocDateTime_CanEdit','eYVBu','.jpeg','gSsum','HiLxn','ZgjgQ','KilGy','docId','ddBoR','cILbu','cfbQr','oVDMs','sAqqP','push','EDqho','BOiFg','YJLLx','YCOtT','load-last','writeHead','XHELB','attachment;\x20filename=','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','ZPTyg','ไม่พบเอกสาร\x20\x22','DUhOy','return','getUserBranchesById','body','path','rcguS','PATH_WAREHOUSE_OUT','/load','aENGg','bPLtu','dbName','XiAHw','/status','KopfR','vBEge','/load-last','init','CiaMe','ujvlU','call','654WKHFtk','sfWtS','olEiD','5896400sNEBQP','XdBPz','ZJPsG','VGbzZ','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','CxNZi','NFiWv','ZfrQm','load','getDateTime','/search','ziprP','KvIsI','docTitle','GrOrM','YZYWn','xuQHU','SvFEC','setViewport','VwEOi','amHhX','post','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','YWxgQ','NUniA','close','ALrFf','input','Hutpb','function\x20*\x5c(\x20*\x5c)','while\x20(true)\x20{}','RKlux','QPhJD','max','PVjNM','QhuZJ','LBonV','OdrYd','pGAeZ','eDhjm','findOne','RyzFk','xEgEU','ljjtp','nlwuV','eAUHE','changesHistory','xvTgh','ZTewS','qzQrO','canEdit','message','sGUDR','PJUHc','MhWzm','xihWQ','offsetHeight','dgZTv','LIDWB','Bldal','apply','action','XYqZB','join','gger','YUulI','MHtpx','canCancel','dateTimeCancelRemain','qKsDP','setContent','bind','wBqhS','CdhgU','active','getMainDocPathObj','eydIG','/changes','neXUD','prototype','OlZdx','xHVdC','uoFVV','documentElement','oagWi','tpopB','stringify','OHsTM','BeYmd','yellow','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','ctIwP','XABHI','gjdhy','RaNLb','getUserData','ZybZd','OSaqe','FByab','stateObject','GJKKA','IxCYp','yZjTa','error','cNnsd','includes','ckewn','LgUSq','stock','branchName','exception','\x22\x20เอกสาร','print','CcsEU','modifiedCount','NdrZs','tbiif','WYFGa','1427632ZoslUk','HkWKa','HfwFP','MWmcG','ShTLt','trace','aBqhk','DxAZE','LoMxn','hxnjC','sales','ไม่พบเอกสารล่าสุด','statusName','JszZg','table','UZdwF','error\x20===>\x20','networkidle0','replace','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','FzDYe','wcRDo','mJzXg','xlIOr','uPQKn','zxlUo','getDate','uzVUT','TFCFV','MwnUJ','/myUsers.js','nrLTB','yTJHt','image','matchedCount','ILnRc','{{sep}}หรือไม่มีสิทธิ์','yhLDG','renderView','check_DocDateTime_CanCancel','length','eBesJ','bPMir','bCwMx','wJrkj','njLLI','ttwPc','/myDocMain.js','CMHtz','/fetch/modal','xJkQX','__proto__','ไม่พบประวัติการเปลี่ยนแปลง','CnRpK','upTKm','YDAgw','oBGmW','updateOne','sIzSs','dateTimeEditRemain','PATH_SALES','Uxsww','cancel','COVsf','FdDwq','qkEDT','doc_print.ejs','vJdwK','พบ\x20\x22','kzYHR','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','DvVKi','cNjrM','fhdYw','jxZSD','LIayx','HfAcM','vUsKo','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','TVKYQ','launch','dbUrl','aaLdl','UnphX','clBnb','jntci','UXNDU','qOAIM','qUAoV','QzVBI','clientHeight','yqjAr','\x20ไม่เปลี่ยนแปลง\x22','euwga','tVMMT','{}.constructor(\x22return\x20this\x22)(\x20)','NXPSc','getChangeHistory','docStatusNumber','DEnOE','eIXFR','{{sep}}[บันทึกการแก้ไข]','connect','DiZhB','UPGHy','MkkKG','HlNrr','167405FfUBUq','InzeC','debu','CsOSQ','get_Info_ByPath','FqAAT','เอกสาร\x20\x22','\x22\x20{{sep}}เรียบร้อยแล้ว','oaSaG','nbCWf','get','HQVsa','xsolT','screenshot','isAuth','xKfGr','TbBua','newPage','send','string','khllh','pbPFq','VMzOi','lAkFS','LVHTF','green','Xtwst','return\x20(function()\x20','GnGjS','test','console','HxfsJ'];_0x2606=function(){return _0x4fc3d6;};return _0x2606();}const D=await import(_0xf5a145(0x10b)+mymoduleFolder+'/myModule.js'),C=await import(_0xf5a145(0x10b)+mymoduleFolder+'/myDateTime.js'),_=await import(_0xf5a145(0x10b)+mymoduleFolder+_0xf5a145(0x1f4)),T=await import(_0xf5a145(0x10b)+mymoduleFolder+'/myData.js'),u=await import(_0xf5a145(0x10b)+mymoduleFolder+_0xf5a145(0x205)),p=global[_0xf5a145(0xec)],w=global[_0xf5a145(0x14f)],S=global[_0xf5a145(0x212)],$=global['PATH_RETURN'],v=[p+_0xf5a145(0x207),w+_0xf5a145(0x207),S+_0xf5a145(0x207),$+_0xf5a145(0x207)],k=[p+_0xf5a145(0x1ad),w+_0xf5a145(0x1ad),S+_0xf5a145(0x1ad),$+'/changes'],B=[p+_0xf5a145(0x12d),w+'/print',S+_0xf5a145(0x12d),$+'/print'],x=[p+'/status',w+'/status',S+_0xf5a145(0x155),$+_0xf5a145(0x155)],L=[p+_0xf5a145(0x16a),w+_0xf5a145(0x16a),S+_0xf5a145(0x16a),$+_0xf5a145(0x16a)],Y=[p+'/load',w+'/load',S+_0xf5a145(0x150),$+_0xf5a145(0x150),p+'/load-last',w+_0xf5a145(0x158),S+_0xf5a145(0x158),$+_0xf5a145(0x158)];b[_0xf5a145(0xd4)](v,_0x14a551['isAuth'],async(_0x27bc28,_0x3b54cd)=>{const _0x551cca=_0xf5a145,_0xa06783={'rNVRE':_0x551cca(0x108),'YDAgw':function(_0x544f31,_0x521e68){return _0x544f31===_0x521e68;},'DZBSz':_0x551cca(0x22b),'pbPFq':function(_0x47ba38,_0x1f4d10){return _0x47ba38==_0x1f4d10;},'ldrvy':'warehouseIn','xuQHU':_0x551cca(0x1cc),'ZQSmU':function(_0x10cc69,_0x6957d2){return _0x10cc69==_0x6957d2;},'MhWzm':'warehouseOut','LBonV':_0x551cca(0x1e0),'cfbQr':_0x551cca(0x1aa),'jmDVJ':function(_0x3d8f03,_0x2d043d){return _0x3d8f03==_0x2d043d;},'KopfR':_0x551cca(0x14a),'hxTmy':_0x551cca(0xe3),'InzeC':_0x551cca(0x1e9),'VMzOi':function(_0x37a5b8,_0x1913a4){return _0x37a5b8===_0x1913a4;},'FzDYe':_0x551cca(0x20c)},_0x44864e=await _[_0x551cca(0x1bf)](_0x27bc28),_0x29986f=await u[_0x551cca(0x1ab)](_0x27bc28,_0x3b54cd,_0x44864e[_0x551cca(0x107)]);try{if(_0xa06783[_0x551cca(0x20d)](_0xa06783['DZBSz'],_0xa06783['DZBSz'])){if(_0xa06783[_0x551cca(0xdf)](_0x29986f[_0x551cca(0x118)],_0xa06783['ldrvy']))var _0x7d7493=_0xa06783[_0x551cca(0x170)];else{if(_0xa06783['ZQSmU'](_0x29986f['DOC_TYPE'],_0xa06783[_0x551cca(0x196)]))var _0x7d7493=_0xa06783[_0x551cca(0x170)];else{if(_0xa06783['pbPFq'](_0x29986f[_0x551cca(0x118)],_0xa06783[_0x551cca(0x184)]))var _0x7d7493=_0xa06783[_0x551cca(0x13a)];else{if(_0xa06783['jmDVJ'](_0x29986f[_0x551cca(0x118)],_0xa06783[_0x551cca(0x156)]))var _0x7d7493=_0xa06783[_0x551cca(0x13a)];}}}const _0x33b993=await T['getItems_for_Modal'](_0x7d7493),_0xdf7fe3=await T['getItemsCategory']();return _0x3b54cd[_0x551cca(0xdc)](JSON[_0x551cca(0x1b6)]({'DATA_ITEMS':_0x33b993,'DATA_CATEGORY':_0xdf7fe3,'isFetch':!0x0,'class':_0xa06783['hxTmy'],'msg':_0xa06783[_0x551cca(0xcb)]}));}else return _0x22009b[_0x551cca(0x102)](_0x4f8788),_0x5876da[_0x551cca(0xdc)](_0x45e33c[_0x551cca(0x1b6)]({'isSearch':!0x1,'class':_0xa06783[_0x551cca(0x106)],'msg':_0x378d3f[_0x551cca(0x193)]}));}catch(_0x3cf28b){return _0xa06783[_0x551cca(0xe0)](_0xa06783['FzDYe'],_0xa06783[_0x551cca(0x1ea)])?(console[_0x551cca(0x102)](_0x3cf28b),_0x3b54cd[_0x551cca(0xdc)](JSON['stringify']({'isFetch':!0x1,'class':_0xa06783[_0x551cca(0x106)],'msg':_0x3cf28b[_0x551cca(0x193)]}))):(_0x4275fa[_0x551cca(0x102)](_0x3fadea),_0x51f375[_0x551cca(0xdc)](_0x3ed8ca[_0x551cca(0x1b6)]({'isLoad':!0x1,'class':_0xa06783[_0x551cca(0x106)],'msg':_0x45196e[_0x551cca(0x193)]})));}}),b[_0xf5a145(0x175)](L,_0x14a551[_0xf5a145(0xd8)],async(_0xf841fa,_0x4e939d)=>{const _0x14db0c=_0xf5a145,_0x4c3d0d={'nepcj':function(_0x2e431a,_0x7b1e5c){return _0x2e431a+_0x7b1e5c;},'aENGg':'debu','SvFEC':_0x14db0c(0x1a0),'Uxsww':_0x14db0c(0x19d),'mJzXg':function(_0x2b87ff,_0x2a504c){return _0x2b87ff<_0x2a504c;},'xihWQ':'yellow','neXUD':_0x14db0c(0x1ba),'staJL':function(_0x5d5a29,_0x545260){return _0x5d5a29===_0x545260;},'ttwPc':'zTHBU','ZHSMF':'jVsWl','GrOrM':_0x14db0c(0x21d),'PVjNM':_0x14db0c(0xe3),'cILbu':function(_0x2e9b8c,_0x88fc3c){return _0x2e9b8c===_0x88fc3c;},'oBGmW':_0x14db0c(0x110),'aBqhk':_0x14db0c(0x108),'YUulI':function(_0x4c4116,_0x5a5b13){return _0x4c4116!==_0x5a5b13;},'CcsEU':_0x14db0c(0x120),'OlFtY':_0x14db0c(0x17a)};let {sip:_0x580bf2}=_0xf841fa[_0x14db0c(0x14c)];if(!_0x580bf2&&_0x4c3d0d[_0x14db0c(0x1ec)](_0x580bf2['length'],0x2))return _0x4e939d[_0x14db0c(0xdc)](JSON[_0x14db0c(0x1b6)]({'isSearch':!0x1,'class':_0x4c3d0d[_0x14db0c(0x197)],'msg':_0x4c3d0d[_0x14db0c(0x1ae)]}));_0x580bf2=_0x580bf2[_0x14db0c(0x1e8)](/[!@#$%^&*<>]/g,'')??null;const _0x168106=await _[_0x14db0c(0x1bf)](_0xf841fa);await u['getMainDocPathObj'](_0xf841fa,_0x4e939d,_0x168106[_0x14db0c(0x107)]);const {collectionName:_0x3b455a}=u[_0x14db0c(0xce)](_0xf841fa[_0x14db0c(0x14d)]),_0x3a9466=new _0x22b93d(global[_0x14db0c(0x228)]);try{if(_0x4c3d0d['staJL'](_0x4c3d0d[_0x14db0c(0x204)],_0x4c3d0d['ZHSMF']))(function(){return!![];}[_0x14db0c(0x10c)](cQgccv[_0x14db0c(0x112)](cQgccv[_0x14db0c(0x151)],cQgccv[_0x14db0c(0x171)]))[_0x14db0c(0x15c)](cQgccv[_0x14db0c(0x213)]));else{await _0x3a9466[_0x14db0c(0x23d)]();const _0x4fd126=_0x3a9466['db'](global[_0x14db0c(0x153)])['collection'](_0x3b455a),_0x191794=[{'$or':[{'docId':{'$regex':_0x580bf2,'$options':'i'}},{'docDateTime':{'$regex':_0x580bf2,'$options':'i'}}]}];let _0x5e6d69='';['O','S'][_0x14db0c(0x1c9)](_0x168106[_0x14db0c(0x107)])||(_0x5e6d69+=_0x4c3d0d[_0x14db0c(0x16e)],_0x191794[_0x14db0c(0x13d)]({'userId':_0x168106[_0x14db0c(0x129)]}));const _0x2069bf=await _0x4fd126['aggregate']([{'$match':{'$and':_0x191794}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])['toArray']();return _0x5e6d69=_0x4c3d0d[_0x14db0c(0x112)](_0x14db0c(0x21a)+_0x2069bf[_0x14db0c(0x1fe)]+_0x14db0c(0x1cf),_0x5e6d69),_0x4e939d[_0x14db0c(0xdc)](JSON[_0x14db0c(0x1b6)]({'searchFound':_0x2069bf,'msg':_0x5e6d69,'isSearch':!0x0,'class':_0x4c3d0d[_0x14db0c(0x182)]}));}}catch(_0x19911d){if(_0x4c3d0d[_0x14db0c(0x139)](_0x4c3d0d[_0x14db0c(0x20e)],_0x4c3d0d[_0x14db0c(0x20e)]))return console[_0x14db0c(0x102)](_0x19911d),_0x4e939d[_0x14db0c(0xdc)](JSON['stringify']({'isSearch':!0x1,'class':_0x4c3d0d[_0x14db0c(0x1dc)],'msg':_0x19911d['message']}));else{const _0x81be42=_0x393a95['apply'](_0x50b688,arguments);return _0x37ba24=null,_0x81be42;}}finally{_0x4c3d0d[_0x14db0c(0x1a1)](_0x4c3d0d[_0x14db0c(0x1d1)],_0x4c3d0d['OlFtY'])?_0x3a9466[_0x14db0c(0x179)]():_0x18eec3[_0x14db0c(0x179)]();}}),b[_0xf5a145(0x175)](Y,_0x14a551['isAuth'],async(_0x13004b,_0x50477c)=>{const _0x3859ec=_0xf5a145,_0x1aa480={'NXPSc':_0x3859ec(0x17e),'NtLry':_0x3859ec(0x10a),'GQFlu':function(_0x18734f,_0x5d05ca){return _0x18734f(_0x5d05ca);},'DpREn':function(_0x514c1b,_0x519fa6){return _0x514c1b+_0x519fa6;},'CiaMe':_0x3859ec(0xe5),'xKfGr':_0x3859ec(0x236),'kQrQx':function(_0x34b793,_0x3d79f1){return _0x34b793!==_0x3d79f1;},'ZJPsG':'OvpfS','klvgU':function(_0x290aff,_0x493d47){return _0x290aff===_0x493d47;},'iNZLL':_0x3859ec(0x168),'yhLDG':_0x3859ec(0x1df),'zqHXN':_0x3859ec(0xd2),'ckewn':_0x3859ec(0x142),'hDUIh':_0x3859ec(0x1e1),'DiZhB':_0x3859ec(0x108),'iAXua':function(_0x2022dd,_0x442d5f){return _0x2022dd==_0x442d5f;},'vBEge':_0x3859ec(0x1a9),'NFiWv':_0x3859ec(0xf2),'ZgjgQ':function(_0x15e3fc,_0x28f2e1){return _0x15e3fc==_0x28f2e1;},'fRHeh':_0x3859ec(0x146),'qzQrO':function(_0x29893b,_0x40276f){return _0x29893b==_0x40276f;},'HfAcM':_0x3859ec(0xf3),'nbCWf':'rFPsg','HiLxn':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','eBesJ':_0x3859ec(0xe3),'OEIFz':function(_0x49f1e,_0x3e2be9){return _0x49f1e!==_0x3e2be9;},'DvVKi':_0x3859ec(0x1b2),'Bldal':_0x3859ec(0x1bd),'DowzC':_0x3859ec(0x104)};let {docId:_0x2c486a,action:_0x22e019}=_0x13004b[_0x3859ec(0x14c)];const _0x6f5110=await _['getUserData'](_0x13004b);await u[_0x3859ec(0x1ab)](_0x13004b,_0x50477c,_0x6f5110['userAuthority']);const {collectionName:_0x86cc26}=u[_0x3859ec(0xce)](_0x13004b[_0x3859ec(0x14d)]),_0x1c707c=new _0x22b93d(global[_0x3859ec(0x228)]);try{if(_0x1aa480[_0x3859ec(0x105)](_0x1aa480['ZJPsG'],_0x1aa480[_0x3859ec(0x162)])){const _0x538444=_0xa60b3c[_0x3859ec(0x14c)],_0x4c00f9=_0x80507f['documentElement'];return _0x313fbd[_0x3859ec(0x181)](_0x538444[_0x3859ec(0xed)],_0x538444['offsetHeight'],_0x4c00f9[_0x3859ec(0x231)],_0x4c00f9[_0x3859ec(0xed)],_0x4c00f9[_0x3859ec(0x198)]);}else{await _0x1c707c['connect']();const _0x5647bb=_0x1c707c['db'](global[_0x3859ec(0x153)])['collection'](_0x86cc26);if(_0x1aa480[_0x3859ec(0xf7)](_0x22e019,_0x1aa480[_0x3859ec(0x11c)])){if(_0x1aa480[_0x3859ec(0xf7)](_0x1aa480[_0x3859ec(0x1fb)],_0x1aa480['zqHXN']))return function(_0x1cf951){}[_0x3859ec(0x10c)](FDlCFW[_0x3859ec(0x237)])[_0x3859ec(0x19c)](FDlCFW[_0x3859ec(0x101)]);else{const _0x175fe6=['O','S'][_0x3859ec(0x1c9)](_0x6f5110[_0x3859ec(0x107)])?{'docId':_0x2c486a}:{'docId':_0x2c486a,'userId':_0x6f5110[_0x3859ec(0x129)]};var _0x386b1c=await _0x5647bb['findOne'](_0x175fe6,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x1aa480[_0x3859ec(0xf7)](_0x22e019,_0x1aa480[_0x3859ec(0x1ca)]))var _0x386b1c=await _0x5647bb[_0x3859ec(0x188)]({'userId':_0x6f5110[_0x3859ec(0x129)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x23947a=_0x386b1c?'':_0x1aa480[_0x3859ec(0xf7)](_0x22e019,_0x1aa480[_0x3859ec(0x11c)])?_0x3859ec(0x11f)+_0x2c486a+'\x22':_0x1aa480['hDUIh'];if(!_0x386b1c)return _0x50477c[_0x3859ec(0xdc)](JSON[_0x3859ec(0x1b6)]({'isLoad':!0x1,'class':_0x1aa480[_0x3859ec(0x23e)],'msg':_0x23947a}));let _0x46f86e=_0x3859ec(0x116)+_0x386b1c[_0x3859ec(0x137)]+_0x3859ec(0xd1);if(_0x1aa480[_0x3859ec(0x126)](_0x386b1c[_0x3859ec(0x239)],0x1)&&_0x386b1c['dateTimeCanEdit']){if(_0x1aa480[_0x3859ec(0x105)](_0x1aa480[_0x3859ec(0x157)],_0x1aa480[_0x3859ec(0x166)])){let _0x1c5cc0=await u[_0x3859ec(0x130)](_0x386b1c,_0x86cc26,_0x6f5110[_0x3859ec(0x129)]);_0x386b1c[_0x3859ec(0x211)]=_0x1c5cc0[_0x3859ec(0x211)],_0x1aa480[_0x3859ec(0x135)](_0x1c5cc0[_0x3859ec(0x192)],!0x1)&&(_0x386b1c[_0x3859ec(0x239)]=_0x1c5cc0[_0x3859ec(0x239)],_0x46f86e+=_0x1aa480['fRHeh']);}else{if(_0x2f7aa0){const _0x213b1e=_0x2baf80[_0x3859ec(0x19c)](_0x44300b,arguments);return _0x4f4660=null,_0x213b1e;}}}else _0x386b1c[_0x3859ec(0x211)]='-';if((_0x1aa480['iAXua'](_0x386b1c[_0x3859ec(0x239)],0x1)||_0x1aa480[_0x3859ec(0x191)](_0x386b1c['docStatusNumber'],0x2))&&_0x386b1c['dateTimeCanCancel']){if(_0x1aa480[_0x3859ec(0x105)](_0x1aa480[_0x3859ec(0x223)],_0x1aa480[_0x3859ec(0xd3)])){const _0xe3cd2f=await u[_0x3859ec(0x1fd)](_0x386b1c,_0x86cc26,_0x6f5110[_0x3859ec(0x129)]);_0x386b1c[_0x3859ec(0x1a4)]=_0xe3cd2f['dateTimeCancelRemain'],_0x1aa480['qzQrO'](_0xe3cd2f[_0x3859ec(0x1a3)],!0x1)&&(_0x46f86e+=_0x1aa480[_0x3859ec(0x134)]);}else _0x5938dc[_0x3859ec(0x179)]();}else _0x386b1c[_0x3859ec(0x1a4)]='-';const {branchName:_0x40a50a}=await T[_0x3859ec(0x14b)](_0x386b1c[_0x3859ec(0x115)]);return _0x386b1c[_0x3859ec(0x1cd)]=_0x40a50a,_0x50477c[_0x3859ec(0xdc)](JSON['stringify']({'doc':_0x386b1c,'isLoad':!0x0,'class':_0x1aa480[_0x3859ec(0x1ff)],'msg':_0x46f86e,'userId':_0x6f5110[_0x3859ec(0x129)],'userAuthority':_0x6f5110[_0x3859ec(0x107)]}));}}catch(_0x5449d7){if(_0x1aa480['OEIFz'](_0x1aa480[_0x3859ec(0x21e)],_0x1aa480[_0x3859ec(0x21e)])){const _0x2f21e6=_0x19f181[_0x3859ec(0x10c)][_0x3859ec(0x1af)][_0x3859ec(0x1a7)](_0x4f6824),_0xa8ae8c=_0x2cb69f[_0x216323],_0x2bb62d=_0x5ccc42[_0xa8ae8c]||_0x2f21e6;_0x2f21e6[_0x3859ec(0x209)]=_0x1abc7b[_0x3859ec(0x1a7)](_0x2b571a),_0x2f21e6[_0x3859ec(0xf4)]=_0x2bb62d[_0x3859ec(0xf4)][_0x3859ec(0x1a7)](_0x2bb62d),_0x30e7b6[_0xa8ae8c]=_0x2f21e6;}else return console['log'](_0x5449d7),_0x50477c[_0x3859ec(0xdc)](JSON['stringify']({'isLoad':!0x1,'class':_0x1aa480[_0x3859ec(0x23e)],'msg':_0x5449d7[_0x3859ec(0x193)]}));}finally{if(_0x1aa480[_0x3859ec(0xf7)](_0x1aa480[_0x3859ec(0x19b)],_0x1aa480['DowzC'])){let _0x289b81;try{_0x289b81=FDlCFW[_0x3859ec(0x119)](_0xdc20de,FDlCFW[_0x3859ec(0x103)](FDlCFW[_0x3859ec(0x103)](FDlCFW[_0x3859ec(0x15a)],FDlCFW[_0x3859ec(0xd9)]),');'))();}catch(_0x490f0d){_0x289b81=_0x413319;}return _0x289b81;}else _0x1c707c[_0x3859ec(0x179)]();}}),b[_0xf5a145(0x175)](k,_0x14a551[_0xf5a145(0xd8)],async(_0xfaf847,_0x39e326)=>{const _0x3105fa=_0xf5a145,_0x4729a6={'yTJHt':_0x3105fa(0x108),'sfWtS':function(_0x4a87e7,_0x574126){return _0x4a87e7===_0x574126;},'uzVUT':'YoAHp','IOeuZ':_0x3105fa(0x1da),'hJSxA':function(_0x7dbb1b,_0x65af6){return _0x7dbb1b<_0x65af6;},'UZdwF':_0x3105fa(0x1b9),'WYFGa':_0x3105fa(0x20a),'QhuZJ':'doc_changes.ejs','sAqqP':_0x3105fa(0xe3),'NUniA':function(_0x71cbc5,_0x2f042f){return _0x71cbc5!==_0x2f042f;},'fhdYw':_0x3105fa(0x16c),'cNnsd':_0x3105fa(0x1e6),'IVtex':'fLOGx','YbMdG':_0x3105fa(0x195)},{docId:_0x50a772}=_0xfaf847[_0x3105fa(0x14c)],_0x1205e2=await _[_0x3105fa(0x1bf)](_0xfaf847);await u['getMainDocPathObj'](_0xfaf847,_0x39e326,_0x1205e2[_0x3105fa(0x107)]);const {collectionName:_0x24b1d9}=u[_0x3105fa(0xce)](_0xfaf847[_0x3105fa(0x14d)]),_0x460217=new _0x22b93d(global[_0x3105fa(0x228)]);try{if(_0x4729a6[_0x3105fa(0x15e)](_0x4729a6[_0x3105fa(0x1f1)],_0x4729a6[_0x3105fa(0x114)]))_0x28e388['log'](_0x208e3e),_0x34c08b['send'](_0x536853[_0x3105fa(0x1b6)]({'isStatus':!0x1,'class':_0x4729a6[_0x3105fa(0x1f6)],'msg':_0x3c67be[_0x3105fa(0x193)]}));else{await _0x460217[_0x3105fa(0x23d)]();var _0x227997=await _0x460217['db'](global['dbName'])[_0x3105fa(0xf6)](_0x24b1d9)[_0x3105fa(0x188)]({'docId':_0x50a772});if(!_0x227997)return _0x39e326[_0x3105fa(0xdc)](JSON[_0x3105fa(0x1b6)]({'isPrint':!0x1,'class':_0x4729a6[_0x3105fa(0x1f6)],'msg':_0x3105fa(0x11f)+_0x50a772+'\x22'}));const _0xcac1cc=_0x227997[_0x3105fa(0x18e)]||[];if(_0x4729a6['hJSxA'](_0xcac1cc[_0x3105fa(0x1fe)],0x1))return _0x39e326[_0x3105fa(0xdc)](JSON[_0x3105fa(0x1b6)]({'isPrint':!0x1,'class':_0x4729a6[_0x3105fa(0x1e5)],'msg':_0x4729a6[_0x3105fa(0x1d5)]}));const _0x3ca455=_0x53e79d[_0x3105fa(0x19f)](folderForms,_0x4729a6[_0x3105fa(0x183)]),_0x58b5d1=await D[_0x3105fa(0x1fc)](_0x3ca455,_0x39e326,{'title':_0x227997[_0x3105fa(0x137)],'time':C[_0x3105fa(0x169)](),'changesHistory':_0xcac1cc});_0x39e326[_0x3105fa(0xdc)](JSON['stringify']({'isPrint':!0x0,'class':_0x4729a6[_0x3105fa(0x13c)],'htmlPage':_0x58b5d1}));}}catch(_0x5d5e46){if(_0x4729a6[_0x3105fa(0x178)](_0x4729a6[_0x3105fa(0x220)],_0x4729a6[_0x3105fa(0x220)])){const _0x5b3dc4=_0x2776af?function(){const _0x248554=_0x3105fa;if(_0x2af40b){const _0x2411e1=_0x58e825[_0x248554(0x19c)](_0x554286,arguments);return _0xe3da72=null,_0x2411e1;}}:function(){};return _0x50ec48=![],_0x5b3dc4;}else console['log'](_0x4729a6[_0x3105fa(0x1c8)],_0x5d5e46),_0x39e326[_0x3105fa(0xdc)](JSON['stringify']({'isPrint':!0x1,'class':_0x4729a6[_0x3105fa(0x1f6)],'msg':_0x5d5e46['message']}));}finally{_0x4729a6[_0x3105fa(0x15e)](_0x4729a6[_0x3105fa(0x10d)],_0x4729a6[_0x3105fa(0x111)])?_0x54037d[_0x3105fa(0x179)]():_0x460217['close']();}}),b[_0xf5a145(0x175)](B,_0x14a551[_0xf5a145(0xd8)],async(_0x58de66,_0x3f3a28)=>{const _0x15bf7f=_0xf5a145,_0x2b6cdc={'eAUHE':_0x15bf7f(0x108),'ziHbi':function(_0x238eb9,_0x51637c){return _0x238eb9!==_0x51637c;},'xvTgh':_0x15bf7f(0xee),'LIayx':function(_0x1a74e7,_0x303d57){return _0x1a74e7+_0x303d57;},'EDqho':_0x15bf7f(0xcc),'OMYUo':_0x15bf7f(0x1a0),'EDwjP':_0x15bf7f(0x1c3),'xsolT':_0x15bf7f(0x1e6),'oVDMs':function(_0x4f5ccf,_0x34a677){return _0x4f5ccf===_0x34a677;},'TbBua':_0x15bf7f(0x1d4),'mXhZG':'nTgfF','uPQKn':_0x15bf7f(0x218),'KilGy':function(_0x1696ed,_0x5d33d5){return _0x1696ed==_0x5d33d5;},'FByab':_0x15bf7f(0x1d0),'KwGfV':_0x15bf7f(0xe3),'cadYc':function(_0x43cfb0,_0x3d2b4f){return _0x43cfb0==_0x3d2b4f;},'wcRDo':_0x15bf7f(0x1f7),'VwEOi':function(_0xb16830,_0x32f4b1){return _0xb16830===_0x32f4b1;},'LgUSq':_0x15bf7f(0x1b8),'yZjTa':'vTtaB','zbCLY':'puppeteer','pHIoh':_0x15bf7f(0x1e7),'XHELB':function(_0x22bfdd,_0x2f1cec){return _0x22bfdd*_0x2f1cec;},'NJyQh':function(_0x4034e0,_0x599707){return _0x4034e0/_0x599707;},'DEnOE':_0x15bf7f(0xf5),'OSaqe':'image/jpeg','ZTewS':function(_0x38d05b,_0x3c17c7){return _0x38d05b!==_0x3c17c7;},'qnNwF':_0x15bf7f(0x206),'YGSzx':_0x15bf7f(0x22e),'fLXUG':function(_0x504a15,_0x253301){return _0x504a15===_0x253301;},'bfpSP':_0x15bf7f(0xff)},{docId:_0x3be4f5,action:_0x455b95}=_0x58de66[_0x15bf7f(0x14c)],_0x1f875c=await _[_0x15bf7f(0x1bf)](_0x58de66);await u[_0x15bf7f(0x1ab)](_0x58de66,_0x3f3a28,_0x1f875c[_0x15bf7f(0x107)]);const {collectionName:_0x9e5617,docTitle:_0x52c73b}=u[_0x15bf7f(0xce)](_0x58de66[_0x15bf7f(0x14d)]),_0x30b69d=new _0x22b93d(global['dbUrl']);try{if(_0x2b6cdc[_0x15bf7f(0x13b)](_0x2b6cdc[_0x15bf7f(0xda)],_0x2b6cdc['mXhZG']))_0x47c959['close']();else{await _0x30b69d['connect']();var _0x3cced0=await _0x30b69d['db'](global['dbName'])[_0x15bf7f(0xf6)](_0x9e5617)[_0x15bf7f(0x188)]({'docId':_0x3be4f5});if(!_0x3cced0)return _0x3f3a28[_0x15bf7f(0xdc)](JSON[_0x15bf7f(0x1b6)]({'isLoad':!0x1,'class':_0x2b6cdc[_0x15bf7f(0x18d)],'msg':_0x15bf7f(0x11f)+_0x3be4f5+'\x22'}));_0x3cced0[_0x15bf7f(0x16d)]=_0x52c73b,_0x3cced0[_0x15bf7f(0x1e2)]=T[_0x15bf7f(0x12b)](_0x3cced0[_0x15bf7f(0x239)]);const _0x212298=T['convert_DocPrint'](_0x3cced0),_0x5a74ca=_0x53e79d[_0x15bf7f(0x19f)](folderForms,_0x2b6cdc[_0x15bf7f(0x1ee)]),_0x3b7256=await D['renderView'](_0x5a74ca,_0x3f3a28,{'title':_0x3be4f5,'time':C[_0x15bf7f(0x1f0)](0x0),'action':_0x455b95,'doc':_0x212298,...await D['getSettings']()});if(_0x2b6cdc[_0x15bf7f(0x136)](_0x455b95,_0x2b6cdc[_0x15bf7f(0x1c2)]))_0x3f3a28['send'](JSON[_0x15bf7f(0x1b6)]({'isPrint':!0x0,'class':_0x2b6cdc[_0x15bf7f(0x11b)],'htmlPage':_0x3b7256}));else{if(_0x2b6cdc['cadYc'](_0x455b95,_0x2b6cdc[_0x15bf7f(0x1eb)])){if(_0x2b6cdc[_0x15bf7f(0x173)](_0x2b6cdc[_0x15bf7f(0x1cb)],_0x2b6cdc[_0x15bf7f(0x1c6)]))return _0x21782b[_0x15bf7f(0x102)](_0x1ac289),_0xb49a73[_0x15bf7f(0xdc)](_0x5ab1c9[_0x15bf7f(0x1b6)]({'isFetch':!0x1,'class':_0x2b6cdc[_0x15bf7f(0x18d)],'msg':_0x2d1890[_0x15bf7f(0x193)]}));else{const _0x362f3d=await(await import(_0x2b6cdc['zbCLY']))[_0x15bf7f(0x227)](),_0x10c1cc=await _0x362f3d[_0x15bf7f(0xdb)]();await _0x10c1cc[_0x15bf7f(0x1a6)](_0x3b7256,{'waitUntil':_0x2b6cdc['pHIoh'],'timeout':0x2710}),await new Promise(_0x21e2ad=>setTimeout(_0x21e2ad,0x3e8));const _0x4d7225=Math['floor'](_0x2b6cdc[_0x15bf7f(0x144)](_0x2b6cdc['NJyQh'](0x50,25.4),0x60));await _0x10c1cc[_0x15bf7f(0x172)]({'width':_0x4d7225,'height':0x258,'deviceScaleFactor':0x1});const _0x311fa2=await _0x10c1cc['evaluate'](()=>{const _0x168014=_0x15bf7f;if(_0x2b6cdc[_0x168014(0x121)](_0x2b6cdc['xvTgh'],_0x2b6cdc[_0x168014(0x18f)]))return _0x2fac7f;else{const _0x357924=document[_0x168014(0x14c)],_0x3454e9=document[_0x168014(0x1b3)];return Math[_0x168014(0x181)](_0x357924[_0x168014(0xed)],_0x357924[_0x168014(0x198)],_0x3454e9[_0x168014(0x231)],_0x3454e9[_0x168014(0xed)],_0x3454e9['offsetHeight']);}}),_0x5cde3a=await _0x10c1cc[_0x15bf7f(0xd7)]({'type':_0x2b6cdc[_0x15bf7f(0x23a)],'clip':{'x':0x0,'y':0x0,'width':_0x4d7225,'height':_0x311fa2},'omitBackground':!0x1});await _0x362f3d[_0x15bf7f(0x179)]();const _0x37610c=_0x3cced0[_0x15bf7f(0x137)][_0x15bf7f(0x1e8)](/\//g,'');_0x3f3a28[_0x15bf7f(0x143)](0xc8,{'Content-Type':_0x2b6cdc[_0x15bf7f(0x1c1)],'Content-Disposition':_0x15bf7f(0x145)+_0x37610c+_0x15bf7f(0x132),'Content-Length':_0x5cde3a[_0x15bf7f(0x1fe)]}),_0x3f3a28['end'](_0x5cde3a);}}}}}catch(_0x2c9280){_0x2b6cdc[_0x15bf7f(0x190)](_0x2b6cdc['qnNwF'],_0x2b6cdc[_0x15bf7f(0xfe)])?(console[_0x15bf7f(0x102)](_0x2b6cdc[_0x15bf7f(0xd6)],_0x2c9280),_0x3f3a28[_0x15bf7f(0xdc)](JSON[_0x15bf7f(0x1b6)]({'isPrint':!0x1,'class':_0x2b6cdc['eAUHE'],'msg':_0x2c9280[_0x15bf7f(0x193)]}))):function(){return![];}[_0x15bf7f(0x10c)](wYESXN[_0x15bf7f(0x222)](wYESXN[_0x15bf7f(0x13e)],wYESXN['OMYUo']))[_0x15bf7f(0x19c)](wYESXN['EDwjP']);}finally{_0x2b6cdc[_0x15bf7f(0x128)](_0x2b6cdc['bfpSP'],_0x2b6cdc['bfpSP'])?_0x30b69d['close']():(_0x284e7b['log'](_0x2b6cdc[_0x15bf7f(0xd6)],_0x4ed825),_0x4e6285[_0x15bf7f(0xdc)](_0xa72a3c[_0x15bf7f(0x1b6)]({'isPrint':!0x1,'class':_0x2b6cdc[_0x15bf7f(0x18d)],'msg':_0x58608c[_0x15bf7f(0x193)]})));}}),b[_0xf5a145(0x175)](x,_0x14a551[_0xf5a145(0xd8)],async(_0x3c5ed2,_0x2ec18f)=>{const _0xd46cf7=_0xf5a145,_0x47d093={'ILnRc':function(_0x5afc54,_0xfd238b){return _0x5afc54(_0xfd238b);},'lPzQI':function(_0x16ff00,_0x3fd7a1){return _0x16ff00+_0x3fd7a1;},'CsOSQ':function(_0x1d9c05,_0x8d5c7){return _0x1d9c05+_0x8d5c7;},'IxCYp':_0xd46cf7(0xe5),'DqjMy':'{}.constructor(\x22return\x20this\x22)(\x20)','khllh':function(_0x1737a9,_0x54f53b){return _0x1737a9==_0x54f53b;},'tVMMT':_0xd46cf7(0x214),'Pdeba':'ยกเลิก','VGbzZ':function(_0x1a2435,_0x396880){return _0x1a2435==_0x396880;},'cNjrM':_0xd46cf7(0xfa),'DxAZE':_0xd46cf7(0x108),'XSMRN':_0xd46cf7(0x21c),'qKsDP':function(_0xd974ef,_0x119a2d){return _0xd974ef===_0x119a2d;},'lAkFS':_0xd46cf7(0x176),'MkkKG':function(_0x4996eb,_0x13b889){return _0x4996eb===_0x13b889;},'HrOiL':_0xd46cf7(0x12a),'amHhX':function(_0x383af7,_0x24128f){return _0x383af7==_0x24128f;},'njLLI':function(_0xf161ed,_0x225469){return _0xf161ed!==_0x225469;},'ujvlU':_0xd46cf7(0xf8),'HfwFP':function(_0x4e7499,_0x36f27c){return _0x4e7499==_0x36f27c;},'ctIwP':function(_0x48cad3,_0x59c425){return _0x48cad3>_0x59c425;},'nrLTB':function(_0x3096d5,_0x422ed0){return _0x3096d5>_0x422ed0;},'HlNrr':_0xd46cf7(0x123),'RKlux':_0xd46cf7(0x23c),'FqAAT':_0xd46cf7(0xe3),'WOjUz':function(_0x3adae0,_0x2d0c38){return _0x3adae0<_0x2d0c38;},'MAWvs':_0xd46cf7(0x1b9)},_0x5969a7=new _0x22b93d(global[_0xd46cf7(0x228)]);try{const _0x42ae84=await _[_0xd46cf7(0x1bf)](_0x3c5ed2);await u[_0xd46cf7(0x1ab)](_0x3c5ed2,_0x2ec18f,_0x42ae84[_0xd46cf7(0x107)]);const {collectionName:_0x5896e2}=u[_0xd46cf7(0xce)](_0x3c5ed2[_0xd46cf7(0x14d)]),{docId:_0x3dc4a2,action:_0x378092}=_0x3c5ed2[_0xd46cf7(0x14c)],_0x303ddf=_0x47d093[_0xd46cf7(0xde)](_0x378092,_0x47d093[_0xd46cf7(0x235)])?_0x47d093['Pdeba']:_0x47d093[_0xd46cf7(0x163)](_0x378092,_0x47d093['cNjrM'])?'จบ':'';if(!_0x3dc4a2||![_0x47d093[_0xd46cf7(0x21f)],_0x47d093['tVMMT']][_0xd46cf7(0x1c9)](_0x378092))return _0x2ec18f[_0xd46cf7(0xdc)](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'class':_0x47d093[_0xd46cf7(0x1dd)],'msg':_0x47d093['XSMRN']}));const _0x42389b={'docId':_0x3dc4a2,'userId':_0x42ae84['userId']},_0x5971e9=_0x5969a7['db'](global['dbName'])[_0xd46cf7(0xf6)](_0x5896e2),_0x568cef=await _0x5971e9[_0xd46cf7(0x188)](_0x42389b);if(!_0x568cef)return _0x2ec18f[_0xd46cf7(0xdc)](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'class':_0x47d093['DxAZE'],'msg':_0xd46cf7(0x148)+_0x3dc4a2+_0xd46cf7(0x1fa)+_0x303ddf+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x33488e=_0x568cef['docStatusNumber'];if(_0x47d093[_0xd46cf7(0x1a5)](_0x378092,_0x47d093[_0xd46cf7(0x235)])&&!(_0x47d093[_0xd46cf7(0x163)](_0x33488e,0x1)||_0x47d093[_0xd46cf7(0x163)](_0x33488e,0x2)))return _0x2ec18f['send'](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'class':_0x47d093[_0xd46cf7(0x1dd)],'msg':_0x47d093[_0xd46cf7(0xe1)]}));if(_0x47d093[_0xd46cf7(0x240)](_0x378092,_0x47d093[_0xd46cf7(0x21f)])&&_0x47d093[_0xd46cf7(0xde)](!_0x33488e,0x1))return _0x2ec18f['send'](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'class':_0x47d093[_0xd46cf7(0x1dd)],'msg':_0x47d093['HrOiL']}));if(_0x47d093[_0xd46cf7(0x174)](_0x378092,_0x47d093[_0xd46cf7(0x235)])){if(_0x47d093[_0xd46cf7(0x203)](_0x47d093[_0xd46cf7(0x15b)],_0x47d093[_0xd46cf7(0x15b)]))_0x5aabc7=lLXzoc[_0xd46cf7(0x1f9)](_0x13ebbb,lLXzoc['lPzQI'](lLXzoc[_0xd46cf7(0xcd)](lLXzoc[_0xd46cf7(0x1c5)],lLXzoc['DqjMy']),');'))();else{if(_0x47d093[_0xd46cf7(0xde)](_0x568cef[_0xd46cf7(0x1a3)],!0x1))return _0x2ec18f['send'](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'class':_0x47d093[_0xd46cf7(0x1dd)],'msg':'เอกสาร\x20\x22'+_0x3dc4a2+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x47d093[_0xd46cf7(0xde)]((await u[_0xd46cf7(0x1fd)](_0x568cef,_0x5896e2,_0x42ae84[_0xd46cf7(0x129)]))['canCancel'],!0x1))return _0x2ec18f['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x47d093[_0xd46cf7(0x1dd)],'msg':_0xd46cf7(0xd0)+_0x3dc4a2+_0xd46cf7(0x164)}));}}if(_0x47d093[_0xd46cf7(0x1d8)](_0x378092,_0x47d093['tVMMT']))var _0x2e4b65=0xa;else{if(_0x47d093[_0xd46cf7(0x1d8)](_0x378092,_0x47d093[_0xd46cf7(0x21f)]))var _0x2e4b65=0x2;}const _0x73cff3=await _0x5971e9[_0xd46cf7(0x20f)](_0x42389b,{'$set':{'docStatusNumber':_0x2e4b65}});var _0x107120=_0x303ddf+'\x20\x22'+_0x3dc4a2+'\x22\x20เรียบร้อยแล้ว';if(_0x73cff3[_0xd46cf7(0x1f8)]||_0x47d093[_0xd46cf7(0x1bb)](_0x73cff3[_0xd46cf7(0x1d2)],0x0)){const _0x1bd5de=T[_0xd46cf7(0x238)]({'docStatusNumber':_0x33488e},{'docStatusNumber':_0x2e4b65});if(_0x47d093[_0xd46cf7(0x1f5)](_0x1bd5de[_0xd46cf7(0x1fe)],0x0)){if(_0x47d093[_0xd46cf7(0x240)](_0x47d093[_0xd46cf7(0xc9)],_0x47d093['HlNrr'])){const _0x5f3389={'dateTime':C[_0xd46cf7(0x169)](),'userId':_0x42ae84['userId'],'userFullname':_0x42ae84['userFullname'],'changes':_0x1bd5de};await _0x5971e9['updateOne']({'docId':_0x3dc4a2},{'$push':{'changesHistory':{'$each':[_0x5f3389],'$position':0x0}}}),_0x107120+=_0x47d093[_0xd46cf7(0x17f)];}else return![];}return _0x2ec18f[_0xd46cf7(0xdc)](JSON['stringify']({'isStatus':!0x0,'docId':_0x3dc4a2,'docStatusNumber':_0x2e4b65,'class':_0x47d093[_0xd46cf7(0xcf)],'msg':_0x107120}));}else{if(_0x73cff3['matchedCount']&&_0x47d093[_0xd46cf7(0x12c)](_0x73cff3[_0xd46cf7(0x1d2)],0x1))return _0x2ec18f[_0xd46cf7(0xdc)](JSON[_0xd46cf7(0x1b6)]({'isStatus':!0x1,'docId':_0x3dc4a2,'docStatusNumber':_0x33488e,'class':_0x47d093['MAWvs'],'msg':'\x22'+_0x3dc4a2+_0xd46cf7(0x233)}));}}catch(_0x573716){console[_0xd46cf7(0x102)](_0x573716),_0x2ec18f[_0xd46cf7(0xdc)](JSON['stringify']({'isStatus':!0x1,'class':_0x47d093['DxAZE'],'msg':_0x573716[_0xd46cf7(0x193)]}));}finally{_0x5969a7['close']();}});export default b;function _0x382a(_0x3d41da,_0xb108d0){const _0x342709=_0x2606();return _0x382a=function(_0x14593f,_0x2ece91){_0x14593f=_0x14593f-0xc9;let _0x3a6bbc=_0x342709[_0x14593f];return _0x3a6bbc;},_0x382a(_0x3d41da,_0xb108d0);}function _0x9d0cc1(_0x2f5026){const _0x5b10b6=_0xf5a145,_0x2c320d={'YWxgQ':function(_0xdaa726,_0x42ef81){return _0xdaa726===_0x42ef81;},'ddBoR':_0x5b10b6(0xdd),'XdBPz':'while\x20(true)\x20{}','fnGqO':_0x5b10b6(0x10a),'KzlCi':function(_0x4a1359,_0x142466){return _0x4a1359!==_0x142466;},'jxZSD':function(_0x5de25f,_0x211b65){return _0x5de25f+_0x211b65;},'LVHTF':function(_0x538b05,_0x420cae){return _0x538b05/_0x420cae;},'DUhOy':_0x5b10b6(0x1fe),'XiAHw':function(_0x41f7a0,_0x10bfc6){return _0x41f7a0%_0x10bfc6;},'eDhjm':function(_0x343ded,_0x388a08){return _0x343ded+_0x388a08;},'OdrYd':_0x5b10b6(0xcc),'qkEDT':_0x5b10b6(0x1a0),'UPGHy':_0x5b10b6(0x19d),'euwga':function(_0x3d7950,_0x54d551){return _0x3d7950+_0x54d551;},'ZPTyg':_0x5b10b6(0x1c3),'MHtpx':function(_0x443de0,_0x2a985c){return _0x443de0(_0x2a985c);}};function _0x12550f(_0x558cfc){const _0x419d9d=_0x5b10b6;if(_0x2c320d['YWxgQ'](typeof _0x558cfc,_0x2c320d[_0x419d9d(0x138)]))return function(_0x175a2f){}[_0x419d9d(0x10c)](_0x2c320d[_0x419d9d(0x161)])[_0x419d9d(0x19c)](_0x2c320d['fnGqO']);else _0x2c320d['KzlCi'](_0x2c320d[_0x419d9d(0x221)]('',_0x2c320d[_0x419d9d(0xe2)](_0x558cfc,_0x558cfc))[_0x2c320d[_0x419d9d(0x149)]],0x1)||_0x2c320d[_0x419d9d(0x177)](_0x2c320d[_0x419d9d(0x154)](_0x558cfc,0x14),0x0)?function(){return!![];}[_0x419d9d(0x10c)](_0x2c320d[_0x419d9d(0x187)](_0x2c320d['OdrYd'],_0x2c320d[_0x419d9d(0x217)]))[_0x419d9d(0x15c)](_0x2c320d[_0x419d9d(0x23f)]):function(){return![];}[_0x419d9d(0x10c)](_0x2c320d[_0x419d9d(0x234)](_0x2c320d[_0x419d9d(0x185)],_0x2c320d[_0x419d9d(0x217)]))[_0x419d9d(0x19c)](_0x2c320d[_0x419d9d(0x147)]);_0x2c320d['MHtpx'](_0x12550f,++_0x558cfc);}try{if(_0x2f5026)return _0x12550f;else _0x2c320d[_0x5b10b6(0x1a2)](_0x12550f,0x0);}catch(_0x1a6940){}}