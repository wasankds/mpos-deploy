const _0x3ecefe=_0x2396;function _0x5818(){const _0x1c8b56=['txlCz','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','jpeg','cVNOh','error\x20===>\x20','push','CzIqJ','collectionName','clientHeight','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','error','AXQKk','rqdAb','rFkYf','AlWoH','dClAj','return\x20(function()\x20','vmLzZ','idmEi','/fetch/modal','lyMcE','ALnNA','JgBpb','WUFra','scrollHeight','getUserBranchesById','LXRTC','renderView','ZndVI','BCfQD','CuyJr','getMainDocPathObj','docStatusNumber','payDebtRows','gvXXo','xqBFc','nsMLr','FlapI','pznTd','QWXPA','offsetHeight','\x22\x20{{sep}}เรียบร้อยแล้ว','FrkFZ','getItems_for_Modal','init','dbUrl','max','kFsJX','message','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','cFNmM','ZHiAl','OmeYF','2586221fXijCp','PAY_TYPE','RZYMF','findOne','wqSoS','userAuthority','folderForms','yawqR','close','get_StatusName_byStatusNumber','FuQmg','cdrDo','paymentMethod2','stateObject','zUnfC','string','warehouseOut','Arvvn','nbxSH','BUpzT','OHkJF','paytype','/myData.js','brpqF','WDhdC','bTEpk','fzayt','connect','WZUhs','PATH_SALES','{}.constructor(\x22return\x20this\x22)(\x20)','Igacv','apply','prfCU','aHMdk','getItemsCategory','10gMazEs','TKOlP','get','canCancel','networkidle0','jjJSC','gger','MttUC','action','WCnAM','LSojy','PATH_WAREHOUSE_IN','2056572bYFqID','tkkED','onewg','red','onyfn','LfbJS','dbName','warehouseIn','path','ไม่พบเอกสารล่าสุด','PATH_WAREHOUSE_OUT','เอกสาร\x20\x22','ermlY','เอกสารที่ตันเองไม่ได้สร้าง','Cqxkq','kairq','aggregate','green','getDateTime','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','dOQde','UcLxr','azXml','kkKFg','writeHead','getChangeHistory','setContent','branchName','KInVc','YfhdN','userId','HFbJB','image','flnPE','check_DocDateTime_CanCancel','19XqDlIF','/load-last','docId','asryS','eixaf','bBRsT','matchedCount','BWmcR','16bdjatR','sxdRc','kfUGY','exception','ReyiL','yJtqZ','dateTimeEditRemain','setViewport','cgVMH','lRuNN','nWSqn','ZpbhT','userFullname','พบ\x20\x22','dqxhe','QtKBO','SImaK','fypSF','/status','LbEAc','XPVWY','call','/load','JWVNb','qoRqL','YNdnT','canEdit','while\x20(true)\x20{}','ไม่พบประวัติการเปลี่ยนแปลง','PQyWj','/myModule.js','aXfpA','prototype','getSessionData','VGxap','replace','check_DocDateTime_CanEdit','__proto__','AKHjT','counter','VGlzf','eazzw','collection','changesHistory','getSuppliers_for_Modal','OuFhZ','doc_changes.ejs','vdIAI','launch','TvNuu','NzCYQ','ktqKc','end','\x22\x20เรียบร้อยแล้ว','QNtEi','MBniw','ExdXS','mAQGz','input','image/jpeg','AZaOD','AsOkC','hKeXQ','JlmBX','1100113DohivG','SaSvh','RRvlj','bind','DdJnm','seUPc','RETDx','FFmAV','MDfaB','/changes','GBQxq','get_Info_ByPath','/myDateTime.js','xouak','faDYS','length','zggTk','ไม่พบเอกสารเลขที่\x20\x22','Zldef','kYrWe','rklyf','xKJkW','VhQbZ','rpGqZ','834438pZfcKh','puCct','gtsVB','console','ZWFwe','kYzhD','xNQOJ','kjIZj','hOvvb','DQdcG','RcOvM','wHGvn','log','dateTimeCancelRemain','UzkSk','tuhAv','sLgDJ','/search','yellow','sales','puppeteer','WWuPW','FBHwA','wpvZR','join','/print','floor','paymentMethod1','body','HJCAV','sMLcC','isAuth','KfQaq','RMsPO','jwupZ','ยกเลิก','cqKVV','TypzM','warn','includes','ZieHz','VJjfM','nrQZf','YzBXU','wTOIb','KjWsB','TFkSA','YZKfM','dateTimeCanEdit','cEnYD','FHPrG','239346sZlhKl','MyXip','DRzFN','pHLBd','Router','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','512764aFsLoj','DOC_TYPE','send','trace','KJHcP','bJlkq','getUserData','load-last','tiusc','EarPY','ZtYGf','lxMHJ','KIaKI','cAbnv','LKzXQ','eDuez','doc_print.ejs','VmPZa','ประวัติการแก้ไขเอกสาร\x20:\x20','20672PDgcJQ','.jpeg','gRhNL','sucrD','hkYRI','BivtU','VMtVR','Rypnw','sqYgt','toArray','ypIrA','../','bPEYN','table','hOdmm','olpaH','WQFZH','xaExd','lFvIb','PgQIH','modifiedCount','GZQkj','5MDiVLl','jofAS','\x22\x20มีบันทึกชำระหนี้แล้ว{{sep}}ไม่สามารถยกเลิกได้','dhfSB','PeYld','TQAqt','zJIqL','ogwKm','lndKR','DUffl','post','documentElement','gKDal','getDate','toString','debu','branchId','payTypeThai','constructor','BzvYF','info','print','qeZzH','zvYwF','QWQDb','jtFmx','eNjnp','AZvUW','\x20ไม่เปลี่ยนแปลง\x22','vEQBB','GWRWr','convert_DocPrint','CyFgS','zasSD','jKcVz','find','function\x20*\x5c(\x20*\x5c)','attachment;\x20filename=','/myDocMain.js','LQihe','bGAPb','gEnvo','test','aFESj','JOtLp','statusName','stringify','ftwGl','KRgLq','jWyGo','/myUsers.js','LdnvV','xSopT','OdZKB','ivSAO','SpLQc','PATH_RETURN','bFGul','tfdrH','dateTimeCanCancel','QknWI','REDUd','chain'];_0x5818=function(){return _0x1c8b56;};return _0x5818();}(function(_0xc0d9e2,_0x273ec1){const _0x37cad4=_0x2396,_0xb7582c=_0xc0d9e2();while(!![]){try{const _0x10e15d=parseInt(_0x37cad4(0x152))/0x1*(parseInt(_0x37cad4(0x1fe))/0x2)+parseInt(_0x37cad4(0x1e5))/0x3+parseInt(_0x37cad4(0x1eb))/0x4+parseInt(_0x37cad4(0x214))/0x5*(parseInt(_0x37cad4(0x1b2))/0x6)+-parseInt(_0x37cad4(0x19a))/0x7*(parseInt(_0x37cad4(0x15a))/0x8)+-parseInt(_0x37cad4(0x12f))/0x9+parseInt(_0x37cad4(0x2ac))/0xa*(parseInt(_0x37cad4(0x288))/0xb);if(_0x10e15d===_0x273ec1)break;else _0xb7582c['push'](_0xb7582c['shift']());}catch(_0x2bb80e){_0xb7582c['push'](_0xb7582c['shift']());}}}(_0x5818,0x398c3));const _0x1b4cac=(function(){const _0x116927=_0x2396,_0x4c4cba={'NBQyB':_0x116927(0x132),'ZpbhT':function(_0x2f94ac,_0x2a7b3d){return _0x2f94ac!==_0x2a7b3d;},'CcDDv':_0x116927(0x189),'sqyqT':function(_0x57639f,_0xbc640c){return _0x57639f===_0xbc640c;},'KfQaq':_0x116927(0x1f7),'pXQcv':_0x116927(0x159),'GBQxq':_0x116927(0x19c)};let _0x5e6ac7=!![];return function(_0x19605b,_0x2cf7bf){const _0x4e18ee=_0x116927,_0x5c3ea3={'gKDal':_0x4c4cba['NBQyB'],'xqBFc':function(_0x4dc020,_0x5acf2c){const _0x3a9035=_0x2396;return _0x4c4cba[_0x3a9035(0x165)](_0x4dc020,_0x5acf2c);},'jjJSC':_0x4c4cba['CcDDv'],'RcOvM':function(_0x249d99,_0x3eb6e0){return _0x4c4cba['sqyqT'](_0x249d99,_0x3eb6e0);},'bJlkq':_0x4c4cba[_0x4e18ee(0x1d2)],'xaExd':_0x4c4cba['pXQcv']};if(_0x4c4cba[_0x4e18ee(0x165)](_0x4c4cba[_0x4e18ee(0x1a4)],_0x4c4cba['GBQxq'])){const _0x11c801=_0x414757[_0x4e18ee(0x2a8)](_0x1bdc32,arguments);return _0x2e6687=null,_0x11c801;}else{const _0x5798bd=_0x5e6ac7?function(){const _0x7b6916=_0x4e18ee,_0x14c7c7={'hOvvb':_0x5c3ea3[_0x7b6916(0x220)]};if(_0x5c3ea3[_0x7b6916(0x276)](_0x5c3ea3['jjJSC'],_0x5c3ea3[_0x7b6916(0x2b1)]))_0x13f309[_0x7b6916(0x1be)](_0x397ddf),_0x405c01[_0x7b6916(0x1ed)](_0x223480[_0x7b6916(0x242)]({'isStatus':!0x1,'class':_0x14c7c7[_0x7b6916(0x1ba)],'msg':_0x31ac4f[_0x7b6916(0x283)]}));else{if(_0x2cf7bf){if(_0x5c3ea3[_0x7b6916(0x1bc)](_0x5c3ea3[_0x7b6916(0x1f0)],_0x5c3ea3[_0x7b6916(0x20f)])){const _0xb9c4b9=_0x5513aa?function(){const _0x1aa882=_0x7b6916;if(_0xd85e8b){const _0x4540a2=_0x26f100[_0x1aa882(0x2a8)](_0x25c361,arguments);return _0xdc9e41=null,_0x4540a2;}}:function(){};return _0x26b964=![],_0xb9c4b9;}else{const _0x481f5c=_0x2cf7bf['apply'](_0x19605b,arguments);return _0x2cf7bf=null,_0x481f5c;}}}}:function(){};return _0x5e6ac7=![],_0x5798bd;}};}());(function(){const _0x31c4c2=_0x2396,_0x105e66={'zJIqL':function(_0x4a3a47,_0x3fb40b){return _0x4a3a47(_0x3fb40b);},'onewg':function(_0x464b43,_0x41f009){return _0x464b43+_0x41f009;},'puCct':_0x31c4c2(0x263),'cyJRj':'{}.constructor(\x22return\x20this\x22)(\x20)','gtsVB':_0x31c4c2(0x223),'WWuPW':'gger','OHkJF':_0x31c4c2(0x2b4),'bTEpk':function(_0x5bed9,_0xdc022a){return _0x5bed9!==_0xdc022a;},'QWQDb':'bNWIq','CyFgS':'function\x20*\x5c(\x20*\x5c)','eDuez':_0x31c4c2(0x284),'KInVc':'init','Kicdi':function(_0x207241,_0x2d81ab){return _0x207241+_0x2d81ab;},'bBRsT':'chain','fzayt':_0x31c4c2(0x194),'MttUC':_0x31c4c2(0x172),'ceXOH':function(_0xa09aeb,_0x7bacf2){return _0xa09aeb===_0x7bacf2;},'zggTk':_0x31c4c2(0x169),'jWyGo':function(_0x613eac){return _0x613eac();},'VJjfM':function(_0x206c70,_0x27ed0e,_0x45b47f){return _0x206c70(_0x27ed0e,_0x45b47f);}};_0x105e66[_0x31c4c2(0x1db)](_0x1b4cac,this,function(){const _0x3e25aa=_0x31c4c2,_0x42bae1={'QknWI':function(_0x25af3d,_0x5ce5ad){const _0x57a75=_0x2396;return _0x105e66[_0x57a75(0x21a)](_0x25af3d,_0x5ce5ad);},'BCfQD':function(_0x3b5656,_0x2f841b){return _0x105e66['onewg'](_0x3b5656,_0x2f841b);},'SaSvh':_0x105e66[_0x3e25aa(0x1b3)],'tfdrH':_0x105e66['cyJRj'],'oERsz':_0x105e66[_0x3e25aa(0x1b4)],'HFbJB':_0x105e66[_0x3e25aa(0x1c7)],'jtFmx':_0x105e66[_0x3e25aa(0x29c)]};if(_0x105e66['bTEpk'](_0x105e66[_0x3e25aa(0x22c)],_0x105e66[_0x3e25aa(0x22c)]))_0x4a1182=_0x42bae1[_0x3e25aa(0x250)](_0x407518,_0x42bae1['BCfQD'](_0x42bae1['BCfQD'](_0x42bae1[_0x3e25aa(0x19b)],_0x42bae1[_0x3e25aa(0x24e)]),');'))();else{const _0x182966=new RegExp(_0x105e66[_0x3e25aa(0x234)]),_0x51b6e2=new RegExp(_0x105e66[_0x3e25aa(0x1fa)],'i'),_0x4f5606=_0x105e66[_0x3e25aa(0x21a)](_0x1fdb85,_0x105e66[_0x3e25aa(0x14b)]);if(!_0x182966[_0x3e25aa(0x23e)](_0x105e66['Kicdi'](_0x4f5606,_0x105e66[_0x3e25aa(0x157)]))||!_0x51b6e2['test'](_0x105e66[_0x3e25aa(0x131)](_0x4f5606,_0x105e66[_0x3e25aa(0x2a2)])))_0x105e66[_0x3e25aa(0x2a1)](_0x105e66[_0x3e25aa(0x2b3)],_0x105e66[_0x3e25aa(0x2b3)])?function(){return!![];}[_0x3e25aa(0x226)](_0x42bae1[_0x3e25aa(0x270)](_0x42bae1['oERsz'],_0x42bae1[_0x3e25aa(0x14e)]))[_0x3e25aa(0x16f)](_0x42bae1[_0x3e25aa(0x22d)]):_0x105e66[_0x3e25aa(0x21a)](_0x4f5606,'0');else{if(_0x105e66['ceXOH'](_0x105e66[_0x3e25aa(0x1aa)],_0x105e66[_0x3e25aa(0x1aa)]))_0x105e66[_0x3e25aa(0x245)](_0x1fdb85);else{if(_0x2b1f16){const _0xbf7a70=_0x2152eb['apply'](_0x54ceb1,arguments);return _0x15f3ad=null,_0xbf7a70;}}}}})();}());const _0x5b7aee=(function(){const _0x41ba3e=_0x2396,_0x31edd6={'MYnrN':'while\x20(true)\x20{}','xNQOJ':_0x41ba3e(0x181),'OdZKB':function(_0x233d2a,_0x38fef7){return _0x233d2a!==_0x38fef7;},'ssmGH':_0x41ba3e(0x22b),'cqKVV':_0x41ba3e(0x25f),'zUnfC':function(_0x7832d8,_0x2664e8){return _0x7832d8!==_0x2664e8;},'olpaH':_0x41ba3e(0x287),'onyfn':function(_0x32dd36,_0x39b17a){return _0x32dd36(_0x39b17a);},'bPEYN':'SmBkq'};let _0x802bac=!![];return function(_0x2fedda,_0x1c7d8b){const _0x1536af=_0x41ba3e,_0x1ccbb5={'Arvvn':function(_0x135399,_0x61cf9e){const _0x5e968c=_0x2396;return _0x31edd6[_0x5e968c(0x133)](_0x135399,_0x61cf9e);}};if(_0x31edd6[_0x1536af(0x296)](_0x31edd6['bPEYN'],_0x31edd6[_0x1536af(0x20a)]))return function(_0x1dde3c){}[_0x1536af(0x226)](_0x31edd6['MYnrN'])[_0x1536af(0x2a8)](_0x31edd6[_0x1536af(0x1b8)]);else{const _0x17b31d=_0x802bac?function(){const _0x2b53ab=_0x1536af;if(_0x31edd6[_0x2b53ab(0x249)](_0x31edd6['ssmGH'],_0x31edd6[_0x2b53ab(0x1d6)])){if(_0x1c7d8b){if(_0x31edd6[_0x2b53ab(0x296)](_0x31edd6[_0x2b53ab(0x20d)],_0x31edd6['olpaH']))_0x1ccbb5[_0x2b53ab(0x299)](_0x2827ec,0x0);else{const _0x39703d=_0x1c7d8b[_0x2b53ab(0x2a8)](_0x2fedda,arguments);return _0x1c7d8b=null,_0x39703d;}}}else _0x293d1f[_0x2b53ab(0x290)]();}:function(){};return _0x802bac=![],_0x17b31d;}};}()),_0x2ef1bf=_0x5b7aee(this,function(){const _0x15ec03=_0x2396,_0x4afb5f={'PeYld':_0x15ec03(0x132),'ZtYGf':function(_0x36cad0,_0x5474b8){return _0x36cad0!==_0x5474b8;},'kFsJX':_0x15ec03(0x23d),'aMaaZ':_0x15ec03(0x1a7),'ZxYvj':function(_0x254062,_0x24bd02){return _0x254062===_0x24bd02;},'XPVWY':'IURkO','TFkSA':_0x15ec03(0x1cf),'pznTd':function(_0xd97389,_0x319bf4){return _0xd97389(_0x319bf4);},'vpAxl':function(_0xde92c6,_0x41440d){return _0xde92c6+_0x41440d;},'gvXXo':function(_0x4e71ae,_0x24d413){return _0x4e71ae+_0x24d413;},'wTOIb':_0x15ec03(0x263),'JlmBX':_0x15ec03(0x2a6),'bGAPb':function(_0x2a59c2,_0x48df26){return _0x2a59c2!==_0x48df26;},'wSyVr':_0x15ec03(0x268),'DoEKM':_0x15ec03(0x265),'NzCYQ':function(_0x2b7076){return _0x2b7076();},'dXIVb':function(_0x3ae54c){return _0x3ae54c();},'kkKFg':_0x15ec03(0x1be),'cEnYD':_0x15ec03(0x1d8),'rpGqZ':_0x15ec03(0x228),'ivSAO':_0x15ec03(0x25d),'Cqxkq':_0x15ec03(0x15d),'WUFra':_0x15ec03(0x20b),'ermlY':_0x15ec03(0x1ee),'nrQZf':function(_0x1c7c55,_0x541e10){return _0x1c7c55<_0x541e10;},'AKHjT':_0x15ec03(0x14c)},_0x2d1c1f=function(){const _0x3b61f0=_0x15ec03;if(_0x4afb5f[_0x3b61f0(0x1f5)](_0x4afb5f[_0x3b61f0(0x282)],_0x4afb5f['aMaaZ'])){let _0x33e8ae;try{if(_0x4afb5f['ZxYvj'](_0x4afb5f[_0x3b61f0(0x16e)],_0x4afb5f[_0x3b61f0(0x1e0)]))return![];else _0x33e8ae=_0x4afb5f[_0x3b61f0(0x279)](Function,_0x4afb5f['vpAxl'](_0x4afb5f[_0x3b61f0(0x275)](_0x4afb5f[_0x3b61f0(0x1de)],_0x4afb5f[_0x3b61f0(0x199)]),');'))();}catch(_0x4e8c61){if(_0x4afb5f[_0x3b61f0(0x23c)](_0x4afb5f['wSyVr'],_0x4afb5f['DoEKM']))_0x33e8ae=window;else return _0x17a904['log'](_0x134608),_0x1e4b99[_0x3b61f0(0x1ed)](_0x341ce0['stringify']({'isSearch':!0x1,'class':_0x4afb5f[_0x3b61f0(0x218)],'msg':_0x48ee23[_0x3b61f0(0x283)]}));}return _0x33e8ae;}else return!![];},_0x5cfa98=_0x4afb5f['dXIVb'](_0x2d1c1f),_0x11eb19=_0x5cfa98['console']=_0x5cfa98[_0x15ec03(0x1b5)]||{},_0x4e7ba3=[_0x4afb5f[_0x15ec03(0x146)],_0x4afb5f[_0x15ec03(0x1e3)],_0x4afb5f[_0x15ec03(0x1b1)],_0x4afb5f[_0x15ec03(0x24a)],_0x4afb5f[_0x15ec03(0x13d)],_0x4afb5f[_0x15ec03(0x26a)],_0x4afb5f[_0x15ec03(0x13b)]];for(let _0x1ead0e=0x0;_0x4afb5f[_0x15ec03(0x1dc)](_0x1ead0e,_0x4e7ba3[_0x15ec03(0x1a9)]);_0x1ead0e++){if(_0x4afb5f['ZtYGf'](_0x4afb5f[_0x15ec03(0x180)],_0x4afb5f[_0x15ec03(0x180)]))_0x4afb5f[_0x15ec03(0x18c)](_0x474351);else{const _0x96a723=_0x5b7aee['constructor'][_0x15ec03(0x17a)]['bind'](_0x5b7aee),_0x3df3e6=_0x4e7ba3[_0x1ead0e],_0x110936=_0x11eb19[_0x3df3e6]||_0x96a723;_0x96a723[_0x15ec03(0x17f)]=_0x5b7aee['bind'](_0x5b7aee),_0x96a723[_0x15ec03(0x222)]=_0x110936[_0x15ec03(0x222)][_0x15ec03(0x19d)](_0x110936),_0x11eb19[_0x3df3e6]=_0x96a723;}}});_0x2ef1bf();import _0x5b4b93 from'express';const b=_0x5b4b93[_0x3ecefe(0x1e9)]();import _0x263cb5 from'path';import{MongoClient as _0x5aa471}from'mongodb';import _0xd88385 from'../middleware/mainAuth.js';const C=await import(_0x3ecefe(0x209)+mymoduleFolder+_0x3ecefe(0x178)),E=await import('../'+mymoduleFolder+_0x3ecefe(0x1a6)),T=await import(_0x3ecefe(0x209)+mymoduleFolder+_0x3ecefe(0x246)),u=await import(_0x3ecefe(0x209)+mymoduleFolder+_0x3ecefe(0x29e)),m=await import('../'+mymoduleFolder+_0x3ecefe(0x23a)),p=global[_0x3ecefe(0x2b7)],S=global[_0x3ecefe(0x139)],w=global[_0x3ecefe(0x2a5)],_=global[_0x3ecefe(0x24c)],v=[p+_0x3ecefe(0x266),S+_0x3ecefe(0x266),w+'/fetch/modal',_+_0x3ecefe(0x266)],k=[p+_0x3ecefe(0x1a3),S+_0x3ecefe(0x1a3),w+_0x3ecefe(0x1a3),_+'/changes'],L=[p+_0x3ecefe(0x1cb),S+'/print',w+_0x3ecefe(0x1cb),_+_0x3ecefe(0x1cb)],B=[p+'/status',S+_0x3ecefe(0x16c),w+_0x3ecefe(0x16c),_+_0x3ecefe(0x16c)],Y=[p+_0x3ecefe(0x1c3),S+'/search',w+_0x3ecefe(0x1c3),_+'/search'],x=[p+_0x3ecefe(0x170),S+'/load',w+_0x3ecefe(0x170),_+_0x3ecefe(0x170),p+'/load-last',S+_0x3ecefe(0x153),w+'/load-last',_+_0x3ecefe(0x153)];b[_0x3ecefe(0x2ae)](v,_0xd88385[_0x3ecefe(0x1d1)],async(_0x42b46,_0xfdb114)=>{const _0x1d50c7=_0x3ecefe,_0x3f6ca8={'VmPZa':function(_0x27715b,_0x2f91d4){return _0x27715b(_0x2f91d4);},'sMLcC':function(_0x2d6ad8,_0x55ec6e){return _0x2d6ad8!==_0x55ec6e;},'CuyJr':'ilVZH','TuJDF':_0x1d50c7(0x177),'aFESj':function(_0x398032,_0x2e88e1){return _0x398032==_0x2e88e1;},'yibEU':_0x1d50c7(0x136),'ZWFwe':'stock','LbEAc':'active','FFmAV':_0x1d50c7(0x298),'UcLxr':function(_0x4531df,_0xb7523a){return _0x4531df==_0xb7523a;},'DUffl':_0x1d50c7(0x1c5),'ReyiL':'return','nbxSH':_0x1d50c7(0x140),'evHzF':_0x1d50c7(0x142),'kYzhD':function(_0xac022,_0x2b3a5a){return _0xac022===_0x2b3a5a;},'prfCU':_0x1d50c7(0x1f4),'QNtEi':_0x1d50c7(0x132)},_0x15e70f=await T[_0x1d50c7(0x17b)](_0x42b46),_0x5afbd5=await m['getMainDocPathObj'](_0x42b46,_0xfdb114,_0x15e70f[_0x1d50c7(0x28d)]);try{if(_0x3f6ca8[_0x1d50c7(0x1d0)](_0x3f6ca8[_0x1d50c7(0x271)],_0x3f6ca8['TuJDF'])){if(_0x3f6ca8[_0x1d50c7(0x23f)](_0x5afbd5[_0x1d50c7(0x1ec)],_0x3f6ca8['yibEU']))var _0x35da04=await u[_0x1d50c7(0x27e)](_0x3f6ca8[_0x1d50c7(0x1b6)]),_0x322d6e=await u[_0x1d50c7(0x186)](_0x3f6ca8['LbEAc']);else{if(_0x3f6ca8['aFESj'](_0x5afbd5[_0x1d50c7(0x1ec)],_0x3f6ca8[_0x1d50c7(0x1a1)]))var _0x35da04=await u['getItems_for_Modal'](_0x3f6ca8[_0x1d50c7(0x1b6)]),_0x322d6e=[];else{if(_0x3f6ca8[_0x1d50c7(0x144)](_0x5afbd5['DOC_TYPE'],_0x3f6ca8[_0x1d50c7(0x21d)]))var _0x35da04=await u[_0x1d50c7(0x27e)](_0x3f6ca8[_0x1d50c7(0x16d)],_0x15e70f[_0x1d50c7(0x224)]),_0x322d6e=[];else{if(_0x3f6ca8[_0x1d50c7(0x23f)](_0x5afbd5[_0x1d50c7(0x1ec)],_0x3f6ca8[_0x1d50c7(0x15e)]))var _0x35da04=await u['getItems_for_Modal'](_0x3f6ca8[_0x1d50c7(0x16d)],_0x15e70f[_0x1d50c7(0x224)]),_0x322d6e=[];}}}const _0x487b3a=await u[_0x1d50c7(0x2ab)]();return _0xfdb114[_0x1d50c7(0x1ed)](JSON[_0x1d50c7(0x242)]({'DATA_ITEMS':_0x35da04,'DATA_CATEGORY':_0x487b3a,'DATA_SUPPLIERS':_0x322d6e,'isFetch':!0x0,'class':_0x3f6ca8[_0x1d50c7(0x29a)],'msg':_0x3f6ca8['evHzF']}));}else{const _0x96a225=_0x345b7a[_0x1d50c7(0x226)]['prototype'][_0x1d50c7(0x19d)](_0x1f9fb1),_0x46018e=_0x4867bc[_0x3e2478],_0x156bd9=_0x1ad526[_0x46018e]||_0x96a225;_0x96a225['__proto__']=_0x11b4a2[_0x1d50c7(0x19d)](_0x5f1a1e),_0x96a225[_0x1d50c7(0x222)]=_0x156bd9['toString'][_0x1d50c7(0x19d)](_0x156bd9),_0x894e9e[_0x46018e]=_0x96a225;}}catch(_0x24c854){if(_0x3f6ca8[_0x1d50c7(0x1b7)](_0x3f6ca8[_0x1d50c7(0x2a9)],_0x3f6ca8[_0x1d50c7(0x2a9)]))return console[_0x1d50c7(0x1be)](_0x24c854),_0xfdb114['send'](JSON[_0x1d50c7(0x242)]({'isFetch':!0x1,'class':_0x3f6ca8[_0x1d50c7(0x190)],'msg':_0x24c854['message']}));else oQLKbb[_0x1d50c7(0x1fc)](_0x26f331,'0');}}),b[_0x3ecefe(0x21e)](Y,_0xd88385[_0x3ecefe(0x1d1)],async(_0x4e4221,_0x3050bd)=>{const _0x486fce=_0x3ecefe,_0x1af2de={'FfPZq':function(_0x2e6b1e,_0x24e30d){return _0x2e6b1e<_0x24e30d;},'QyGwL':_0x486fce(0x1c4),'TvNuu':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','azXml':function(_0xc7513c,_0x17401b){return _0xc7513c!==_0x17401b;},'FfRbx':'GvCFw','iZLCS':_0x486fce(0x1ac),'JRaTu':'{{sep}}[\x20ค้นหาเฉพาะในสาขาตนเอง\x20]','vmLzZ':function(_0x2be21e,_0xd2ba50){return _0x2be21e+_0xd2ba50;},'RETDx':'green','eazzw':function(_0x5ce4bb,_0x16ad1d){return _0x5ce4bb!==_0x16ad1d;},'yawqR':_0x486fce(0x1b0),'FuQmg':_0x486fce(0x132),'WDhdC':'okUdA'};let {sip:_0x3ef458}=_0x4e4221[_0x486fce(0x1ce)];if(!_0x3ef458&&_0x1af2de['FfPZq'](_0x3ef458[_0x486fce(0x1a9)],0x2))return _0x3050bd[_0x486fce(0x1ed)](JSON[_0x486fce(0x242)]({'isSearch':!0x1,'class':_0x1af2de['QyGwL'],'msg':_0x1af2de[_0x486fce(0x18b)]}));_0x3ef458=_0x3ef458[_0x486fce(0x17d)](/[!@#$%^&*<>]/g,'')??null;const _0x52ba7=await T[_0x486fce(0x1f1)](_0x4e4221);await m[_0x486fce(0x272)](_0x4e4221,_0x3050bd,_0x52ba7['userAuthority']);const _0x5b4628=m[_0x486fce(0x1a5)](_0x4e4221[_0x486fce(0x137)]),_0x346a74=new _0x5aa471(global['dbUrl']);try{if(_0x1af2de[_0x486fce(0x145)](_0x1af2de['FfRbx'],_0x1af2de['iZLCS'])){await _0x346a74['connect']();const _0x329947=_0x346a74['db'](global[_0x486fce(0x135)])['collection'](_0x5b4628[_0x486fce(0x25a)]),_0x3ebee4=[{'$or':[{'docId':{'$regex':_0x3ef458,'$options':'i'}},{'docDateTime':{'$regex':_0x3ef458,'$options':'i'}}]}];let _0x4f4b37='';['O','S'][_0x486fce(0x1d9)](_0x52ba7[_0x486fce(0x28d)])||(_0x4f4b37+=_0x1af2de['JRaTu'],_0x3ebee4[_0x486fce(0x258)]({'branchId':_0x52ba7[_0x486fce(0x224)]}));const _0x5a30c0=await _0x329947[_0x486fce(0x13f)]([{'$match':{'$and':_0x3ebee4}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x486fce(0x207)]();return _0x4f4b37=_0x1af2de[_0x486fce(0x264)](_0x486fce(0x167)+_0x5a30c0['length']+'\x22\x20เอกสาร',_0x4f4b37),_0x3050bd['send'](JSON[_0x486fce(0x242)]({'searchFound':_0x5a30c0,'msg':_0x4f4b37,'isSearch':!0x0,'class':_0x1af2de[_0x486fce(0x1a0)]}));}else _0x15a7d2[_0x486fce(0x290)]();}catch(_0x55b0d8){if(_0x1af2de[_0x486fce(0x183)](_0x1af2de[_0x486fce(0x28f)],_0x1af2de[_0x486fce(0x28f)]))_0x526c57[_0x486fce(0x290)]();else return console['log'](_0x55b0d8),_0x3050bd[_0x486fce(0x1ed)](JSON['stringify']({'isSearch':!0x1,'class':_0x1af2de[_0x486fce(0x292)],'msg':_0x55b0d8['message']}));}finally{if(_0x1af2de['azXml'](_0x1af2de[_0x486fce(0x2a0)],_0x1af2de[_0x486fce(0x2a0)])){const _0x33b0e2=_0x48e81e[_0x486fce(0x1ce)],_0x1bb9bc=_0x1c2b5e[_0x486fce(0x21f)];return _0x5efb56[_0x486fce(0x281)](_0x33b0e2[_0x486fce(0x26b)],_0x33b0e2[_0x486fce(0x27b)],_0x1bb9bc[_0x486fce(0x25b)],_0x1bb9bc[_0x486fce(0x26b)],_0x1bb9bc['offsetHeight']);}else _0x346a74['close']();}}),b[_0x3ecefe(0x21e)](x,_0xd88385[_0x3ecefe(0x1d1)],async(_0x1619b6,_0x58ff59)=>{const _0x389c42=_0x3ecefe,_0x47e141={'DdJnm':'red','KXQfN':_0x389c42(0x257),'VGlzf':function(_0x1b5d52,_0x10c103){return _0x1b5d52!==_0x10c103;},'JgBpb':'nJBhM','Ibhlh':function(_0xc643e5,_0x1449b3){return _0xc643e5===_0x1449b3;},'gRhNL':'load','sxdRc':'cgzcH','VGxap':_0x389c42(0x1f2),'BxWSH':function(_0x17aab9,_0x17b6ce){return _0x17aab9===_0x17b6ce;},'hKeXQ':_0x389c42(0x138),'RZYMF':function(_0x4aeb2c,_0x1c66dc){return _0x4aeb2c==_0x1c66dc;},'dqxhe':function(_0x130ca1,_0x51d4b0){return _0x130ca1!==_0x51d4b0;},'aXfpA':_0x389c42(0x1f3),'WQFZH':_0x389c42(0x1ea),'jwupZ':'EPdej','WWffb':_0x389c42(0x150),'mEhdC':_0x389c42(0x140),'KjWsB':function(_0x15e943,_0x3b39df){return _0x15e943===_0x3b39df;},'MTHcM':_0x389c42(0x1d3),'TXDRh':'AhYjo'};let {docId:_0x41e517,action:_0x40a8dc}=_0x1619b6['body'];const _0x42a954=await T[_0x389c42(0x1f1)](_0x1619b6);await m[_0x389c42(0x272)](_0x1619b6,_0x58ff59,_0x42a954[_0x389c42(0x28d)]);const _0x2cd8c1=m[_0x389c42(0x1a5)](_0x1619b6[_0x389c42(0x137)]),_0xa491a0=new _0x5aa471(global[_0x389c42(0x280)]);try{if(_0x47e141[_0x389c42(0x182)](_0x47e141['JgBpb'],_0x47e141[_0x389c42(0x269)]))_0x2e489b=_0x4a266b;else{await _0xa491a0[_0x389c42(0x2a3)]();const _0x5ea153=_0xa491a0['db'](global[_0x389c42(0x135)])['collection'](_0x2cd8c1[_0x389c42(0x25a)]);if(_0x47e141['Ibhlh'](_0x40a8dc,_0x47e141[_0x389c42(0x200)])){if(_0x47e141[_0x389c42(0x182)](_0x47e141[_0x389c42(0x15b)],_0x47e141[_0x389c42(0x15b)]))return _0x36d33d[_0x389c42(0x1be)](_0x177458),_0x23875c[_0x389c42(0x1ed)](_0x4c94a3[_0x389c42(0x242)]({'isFetch':!0x1,'class':_0x47e141[_0x389c42(0x19e)],'msg':_0x28ac88['message']}));else{const _0x146c2f=['O','S'][_0x389c42(0x1d9)](_0x42a954[_0x389c42(0x28d)])?{'docId':_0x41e517}:{'docId':_0x41e517,'branchId':_0x42a954[_0x389c42(0x224)]};var _0x46426d=await _0x5ea153[_0x389c42(0x28b)](_0x146c2f,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x47e141['Ibhlh'](_0x40a8dc,_0x47e141[_0x389c42(0x17c)]))var _0x46426d=await _0x5ea153[_0x389c42(0x28b)]({'userId':_0x42a954[_0x389c42(0x14d)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x27ff60=_0x46426d?'':_0x47e141['BxWSH'](_0x40a8dc,_0x47e141['gRhNL'])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x41e517+'\x22':_0x47e141[_0x389c42(0x198)];if(!_0x46426d)return _0x58ff59[_0x389c42(0x1ed)](JSON['stringify']({'isLoad':!0x1,'class':_0x47e141[_0x389c42(0x19e)],'msg':_0x27ff60}));if(_0x47e141[_0x389c42(0x28a)](_0x46426d['docStatusNumber'],0x1)&&_0x46426d[_0x389c42(0x1e2)]){if(_0x47e141[_0x389c42(0x168)](_0x47e141[_0x389c42(0x179)],_0x47e141['aXfpA']))_0x8a0fc3[_0x389c42(0x1be)](_0x47e141['KXQfN'],_0x1e73d2),_0x36c6eb[_0x389c42(0x1ed)](_0x3e1da3[_0x389c42(0x242)]({'isPrint':!0x1,'class':_0x47e141[_0x389c42(0x19e)],'msg':_0x290496[_0x389c42(0x283)]}));else{let _0x218fdb=await m[_0x389c42(0x17e)](_0x46426d,_0x2cd8c1[_0x389c42(0x25a)],_0x42a954[_0x389c42(0x14d)]);_0x46426d[_0x389c42(0x160)]=_0x218fdb[_0x389c42(0x160)],_0x47e141[_0x389c42(0x28a)](_0x218fdb[_0x389c42(0x174)],!0x1)&&(_0x46426d[_0x389c42(0x273)]=_0x218fdb['docStatusNumber'],msg+=_0x47e141[_0x389c42(0x20e)]);}}if((_0x47e141['RZYMF'](_0x46426d['docStatusNumber'],0x1)||_0x47e141['RZYMF'](_0x46426d[_0x389c42(0x273)],0x2))&&_0x46426d[_0x389c42(0x24f)]){if(_0x47e141[_0x389c42(0x182)](_0x47e141[_0x389c42(0x1d4)],_0x47e141['WWffb'])){const _0x521757=await m[_0x389c42(0x151)](_0x46426d,_0x2cd8c1[_0x389c42(0x25a)],_0x42a954[_0x389c42(0x14d)]);_0x46426d[_0x389c42(0x1bf)]=_0x521757['dateTimeCancelRemain'];}else return _0x515fa8[_0x389c42(0x1be)](_0x654405),_0x18cb9d['send'](_0x253b0f[_0x389c42(0x242)]({'isLoad':!0x1,'class':_0x47e141['DdJnm'],'msg':_0x39c6d2['message']}));}const {branchName:_0x3ed490}=await u[_0x389c42(0x26c)](_0x46426d[_0x389c42(0x224)]);return _0x46426d[_0x389c42(0x14a)]=_0x3ed490,_0x58ff59['send'](JSON['stringify']({'doc':_0x46426d,'isLoad':!0x0,'class':_0x47e141['mEhdC'],'msg':'โหลดเอกสารเลขที่\x20\x22'+_0x46426d[_0x389c42(0x154)]+_0x389c42(0x27c),'userId':_0x42a954['userId'],'userAuthority':_0x42a954[_0x389c42(0x28d)]}));}}catch(_0x30c9e0){if(_0x47e141[_0x389c42(0x1df)](_0x47e141['MTHcM'],_0x47e141['MTHcM']))return console['log'](_0x30c9e0),_0x58ff59[_0x389c42(0x1ed)](JSON[_0x389c42(0x242)]({'isLoad':!0x1,'class':_0x47e141[_0x389c42(0x19e)],'msg':_0x30c9e0['message']}));else{const _0x16319e=_0x3940b1['apply'](_0x292f9c,arguments);return _0x5dc114=null,_0x16319e;}}finally{if(_0x47e141[_0x389c42(0x1df)](_0x47e141['TXDRh'],_0x47e141['TXDRh']))_0xa491a0[_0x389c42(0x290)]();else return _0x3641ff;}}),b[_0x3ecefe(0x21e)](k,_0xd88385[_0x3ecefe(0x1d1)],async(_0x101a12,_0x23de1e)=>{const _0x2867be=_0x3ecefe,_0x223375={'lRuNN':_0x2867be(0x238),'seUPc':_0x2867be(0x284),'MDfaB':function(_0x39498c,_0x19f495){return _0x39498c(_0x19f495);},'zasSD':_0x2867be(0x27f),'npZxJ':function(_0x27858e,_0x418fa1){return _0x27858e+_0x418fa1;},'WCnAM':_0x2867be(0x252),'lyMcE':function(_0x398292,_0x4a33ce){return _0x398292+_0x4a33ce;},'sucrD':'input','XfRos':function(_0x5859fd){return _0x5859fd();},'FrkFZ':function(_0xb28170,_0x5f1453){return _0xb28170(_0x5f1453);},'TKOlP':function(_0xac5f41,_0x131739){return _0xac5f41+_0x131739;},'zFCAZ':_0x2867be(0x263),'LfbJS':_0x2867be(0x2a6),'rklyf':function(_0x12f3e0,_0xe39d88){return _0x12f3e0===_0xe39d88;},'eNjnp':_0x2867be(0x1e6),'hvWzc':_0x2867be(0x293),'AXQKk':'red','iUlCj':function(_0x20e709,_0x5e5472){return _0x20e709<_0x5e5472;},'hkYRI':_0x2867be(0x1c4),'YzBXU':_0x2867be(0x176),'KJHcP':_0x2867be(0x188),'YervY':_0x2867be(0x140),'FlapI':'OnVaa','TypzM':_0x2867be(0x257),'LSojy':function(_0x2d7046,_0x50db55){return _0x2d7046!==_0x50db55;},'ZieHz':'zWbkH'},{docId:_0x585555}=_0x101a12[_0x2867be(0x1ce)],_0x42cd7f=await T[_0x2867be(0x17b)](_0x101a12);await m['getMainDocPathObj'](_0x101a12,_0x23de1e,_0x42cd7f[_0x2867be(0x28d)]);const {collectionName:_0x497f6c}=m['get_Info_ByPath'](_0x101a12[_0x2867be(0x137)]),_0x4850f1=new _0x5aa471(global[_0x2867be(0x280)]);try{if(_0x223375[_0x2867be(0x1ae)](_0x223375[_0x2867be(0x22e)],_0x223375['hvWzc'])){const _0x370cce=new _0x2b03de(ooigdd[_0x2867be(0x163)]),_0x4a7808=new _0x3feeac(ooigdd[_0x2867be(0x19f)],'i'),_0x5627d8=ooigdd[_0x2867be(0x1a2)](_0x26934c,ooigdd[_0x2867be(0x235)]);!_0x370cce['test'](ooigdd['npZxJ'](_0x5627d8,ooigdd[_0x2867be(0x2b5)]))||!_0x4a7808['test'](ooigdd[_0x2867be(0x267)](_0x5627d8,ooigdd[_0x2867be(0x201)]))?ooigdd[_0x2867be(0x1a2)](_0x5627d8,'0'):ooigdd['XfRos'](_0x21e18f);}else{await _0x4850f1['connect']();var _0xe2f82d=await _0x4850f1['db'](global[_0x2867be(0x135)])['collection'](_0x497f6c)[_0x2867be(0x28b)]({'docId':_0x585555});if(!_0xe2f82d)return _0x23de1e[_0x2867be(0x1ed)](JSON['stringify']({'isPrint':!0x1,'class':_0x223375['AXQKk'],'msg':_0x2867be(0x1ab)+_0x585555+'\x22'}));const _0x361256=_0xe2f82d[_0x2867be(0x185)]||[];if(_0x223375['iUlCj'](_0x361256[_0x2867be(0x1a9)],0x1))return _0x23de1e[_0x2867be(0x1ed)](JSON[_0x2867be(0x242)]({'isPrint':!0x1,'class':_0x223375[_0x2867be(0x202)],'msg':_0x223375[_0x2867be(0x1dd)]}));const _0x1ecbe6=_0x263cb5[_0x2867be(0x1ca)](folderForms,_0x223375[_0x2867be(0x1ef)]),_0x33f0b3=await C[_0x2867be(0x26e)](_0x1ecbe6,_0x23de1e,{'title':_0x2867be(0x1fd)+_0xe2f82d[_0x2867be(0x154)],'time':E[_0x2867be(0x141)](),'changesHistory':_0x361256});_0x23de1e['send'](JSON[_0x2867be(0x242)]({'isPrint':!0x0,'class':_0x223375['YervY'],'htmlPage':_0x33f0b3}));}}catch(_0x4d9097){if(_0x223375[_0x2867be(0x1ae)](_0x223375[_0x2867be(0x278)],_0x223375[_0x2867be(0x278)]))console[_0x2867be(0x1be)](_0x223375[_0x2867be(0x1d7)],_0x4d9097),_0x23de1e[_0x2867be(0x1ed)](JSON[_0x2867be(0x242)]({'isPrint':!0x1,'class':_0x223375[_0x2867be(0x25e)],'msg':_0x4d9097[_0x2867be(0x283)]}));else{let _0x2bc5d0;try{_0x2bc5d0=ooigdd[_0x2867be(0x27d)](_0x4d8fff,ooigdd['npZxJ'](ooigdd[_0x2867be(0x2ad)](ooigdd['zFCAZ'],ooigdd[_0x2867be(0x134)]),');'))();}catch(_0x4adefc){_0x2bc5d0=_0x54421e;}return _0x2bc5d0;}}finally{if(_0x223375[_0x2867be(0x2b6)](_0x223375[_0x2867be(0x1da)],_0x223375[_0x2867be(0x1da)])){if(_0x424edc)return _0x4f7acd;else ooigdd['FrkFZ'](_0x411abf,0x0);}else _0x4850f1[_0x2867be(0x290)]();}}),b[_0x3ecefe(0x21e)](L,_0xd88385['isAuth'],async(_0x80a6b3,_0x3241ed)=>{const _0x4e630f=_0x3ecefe,_0x24c503={'DQdcG':function(_0x3d43be,_0x20515a){return _0x3d43be!==_0x20515a;},'kfUGY':'Rydtt','SpLQc':'function\x20*\x5c(\x20*\x5c)','ZndVI':_0x4e630f(0x284),'GZQkj':function(_0x3b1514,_0x106542){return _0x3b1514(_0x106542);},'nWSqn':_0x4e630f(0x27f),'ogwKm':function(_0x5a549c,_0xad077d){return _0x5a549c+_0xad077d;},'asryS':_0x4e630f(0x252),'jKcVz':_0x4e630f(0x194),'AlWoH':function(_0x4602f2,_0x16bbcc){return _0x4602f2(_0x16bbcc);},'REDUd':function(_0xe5b456){return _0xe5b456();},'qeZzH':function(_0x4ddb43,_0x56edbb,_0x5cd390){return _0x4ddb43(_0x56edbb,_0x5cd390);},'BivtU':'nLasc','ktqKc':_0x4e630f(0x29b),'lndKR':_0x4e630f(0x132),'dhfSB':_0x4e630f(0x1fb),'ZHiAl':function(_0x2fc7f1,_0x235b45){return _0x2fc7f1==_0x235b45;},'kYrWe':_0x4e630f(0x229),'SImaK':_0x4e630f(0x140),'kjIZj':function(_0x116962,_0xf0a7b){return _0x116962==_0xf0a7b;},'cVNOh':_0x4e630f(0x14f),'YNdnT':_0x4e630f(0x143),'AZaOD':'WFFMm','bMeJE':_0x4e630f(0x1c6),'cAbnv':_0x4e630f(0x2b0),'eixaf':function(_0x1337e7,_0x54ddd8){return _0x1337e7*_0x54ddd8;},'xSopT':function(_0x3f875d,_0x17e98a){return _0x3f875d/_0x17e98a;},'kairq':_0x4e630f(0x255),'wqSoS':_0x4e630f(0x195),'QWXPA':_0x4e630f(0x171),'dClAj':_0x4e630f(0x162),'KRgLq':_0x4e630f(0x257),'YZKfM':_0x4e630f(0x2a7),'tuhAv':_0x4e630f(0x243)},{docId:_0x19e969,action:_0x5651b5}=_0x80a6b3[_0x4e630f(0x1ce)],_0x18e87a=await T[_0x4e630f(0x17b)](_0x80a6b3);await m['getMainDocPathObj'](_0x80a6b3,_0x3241ed,_0x18e87a[_0x4e630f(0x28d)]);const {collectionName:_0x1bbd71,docTitle:_0x1719c8,docType:_0x2cee2f}=m[_0x4e630f(0x1a5)](_0x80a6b3[_0x4e630f(0x137)]),_0x55108d=new _0x5aa471(global[_0x4e630f(0x280)]);try{if(_0x24c503['DQdcG'](_0x24c503[_0x4e630f(0x203)],_0x24c503[_0x4e630f(0x18d)])){await _0x55108d[_0x4e630f(0x2a3)]();var _0xe73bd2=await _0x55108d['db'](global[_0x4e630f(0x135)])[_0x4e630f(0x184)](_0x1bbd71)[_0x4e630f(0x28b)]({'docId':_0x19e969});if(!_0xe73bd2)return _0x3241ed[_0x4e630f(0x1ed)](JSON[_0x4e630f(0x242)]({'isLoad':!0x1,'class':_0x24c503[_0x4e630f(0x21c)],'msg':_0x4e630f(0x1ab)+_0x19e969+'\x22'}));_0xe73bd2['docTitle']=_0x1719c8,_0xe73bd2[_0x4e630f(0x241)]=u[_0x4e630f(0x291)](_0xe73bd2[_0x4e630f(0x273)]);const _0x44b4d4=u[_0x4e630f(0x233)](_0xe73bd2);_0x44b4d4[_0x4e630f(0x1cd)]&&(_0x44b4d4['paymentMethod1Name']=global[_0x4e630f(0x289)][_0x4e630f(0x237)](_0x316e9d=>_0x316e9d[_0x4e630f(0x29d)]==_0x44b4d4[_0x4e630f(0x1cd)])?.[_0x4e630f(0x225)]||''),_0x44b4d4[_0x4e630f(0x294)]&&(_0x44b4d4['paymentMethod2Name']=global[_0x4e630f(0x289)]['find'](_0x1b66f5=>_0x1b66f5['paytype']==_0x44b4d4[_0x4e630f(0x294)])?.['payTypeThai']||'');const _0x2474a3=_0x263cb5['join'](global[_0x4e630f(0x28e)],_0x24c503[_0x4e630f(0x217)]),_0x473aa3=await C['renderView'](_0x2474a3,_0x3241ed,{'title':_0x19e969,'time':E[_0x4e630f(0x221)](0x0),'action':_0x5651b5,'docType':_0x2cee2f,'doc':_0x44b4d4,'settings':await C['getSettings']()});if(_0x24c503[_0x4e630f(0x286)](_0x5651b5,_0x24c503[_0x4e630f(0x1ad)]))_0x3241ed['send'](JSON[_0x4e630f(0x242)]({'isPrint':!0x0,'class':_0x24c503[_0x4e630f(0x16a)],'htmlPage':_0x473aa3}));else{if(_0x24c503[_0x4e630f(0x1b9)](_0x5651b5,_0x24c503[_0x4e630f(0x256)])){if(_0x24c503[_0x4e630f(0x1bb)](_0x24c503[_0x4e630f(0x173)],_0x24c503[_0x4e630f(0x196)])){const _0x2c101f=await(await import(_0x24c503['bMeJE']))[_0x4e630f(0x18a)](),_0x153dc3=await _0x2c101f['newPage']();await _0x153dc3[_0x4e630f(0x149)](_0x473aa3,{'waitUntil':_0x24c503[_0x4e630f(0x1f8)],'timeout':0x2710}),await new Promise(_0x32663f=>setTimeout(_0x32663f,0x3e8));const _0x33f62d=Math[_0x4e630f(0x1cc)](_0x24c503[_0x4e630f(0x156)](_0x24c503[_0x4e630f(0x248)](0x50,25.4),0x60));await _0x153dc3[_0x4e630f(0x161)]({'width':_0x33f62d,'height':0x258,'deviceScaleFactor':0x1});const _0x3f8411=await _0x153dc3['evaluate'](()=>{const _0x465fd3=_0x4e630f;if(_0x24c503[_0x465fd3(0x1bb)](_0x24c503[_0x465fd3(0x15c)],_0x24c503[_0x465fd3(0x15c)]))_0x1dda96[_0x465fd3(0x290)]();else{const _0x4704dc=document[_0x465fd3(0x1ce)],_0x126863=document['documentElement'];return Math[_0x465fd3(0x281)](_0x4704dc[_0x465fd3(0x26b)],_0x4704dc[_0x465fd3(0x27b)],_0x126863[_0x465fd3(0x25b)],_0x126863[_0x465fd3(0x26b)],_0x126863[_0x465fd3(0x27b)]);}}),_0x39fbd5=await _0x153dc3['screenshot']({'type':_0x24c503[_0x4e630f(0x13e)],'clip':{'x':0x0,'y':0x0,'width':_0x33f62d,'height':_0x3f8411},'omitBackground':!0x1});await _0x2c101f[_0x4e630f(0x290)]();const _0x137fdb=_0xe73bd2[_0x4e630f(0x154)]['replace'](/\//g,'');_0x3241ed[_0x4e630f(0x147)](0xc8,{'Content-Type':_0x24c503[_0x4e630f(0x28c)],'Content-Disposition':_0x4e630f(0x239)+_0x137fdb+_0x4e630f(0x1ff),'Content-Length':_0x39fbd5[_0x4e630f(0x1a9)]}),_0x3241ed[_0x4e630f(0x18e)](_0x39fbd5);}else{if(_0x19a48e){const _0x79efca=_0x22e8dc['apply'](_0x45446d,arguments);return _0x16a0bd=null,_0x79efca;}}}}}else{const _0x341a82={'AsOkC':VlEiXh[_0x4e630f(0x24b)],'PgQIH':VlEiXh[_0x4e630f(0x26f)],'wHGvn':function(_0x4bf648,_0x3e5742){const _0x215ee7=_0x4e630f;return VlEiXh[_0x215ee7(0x213)](_0x4bf648,_0x3e5742);},'bFGul':VlEiXh[_0x4e630f(0x164)],'xKJkW':function(_0x5352f1,_0x3f4dbd){const _0x22a64d=_0x4e630f;return VlEiXh[_0x22a64d(0x21b)](_0x5352f1,_0x3f4dbd);},'lxMHJ':VlEiXh[_0x4e630f(0x155)],'yJtqZ':VlEiXh[_0x4e630f(0x236)],'fxRbF':function(_0x1fbe2b,_0x5b270c){const _0x32cb77=_0x4e630f;return VlEiXh[_0x32cb77(0x261)](_0x1fbe2b,_0x5b270c);},'lvFFT':function(_0x47640d){const _0x32477a=_0x4e630f;return VlEiXh[_0x32477a(0x251)](_0x47640d);}};VlEiXh[_0x4e630f(0x22a)](_0x233c43,this,function(){const _0x2db2c1=_0x4e630f,_0x4e8baa=new _0x1a5868(_0x341a82[_0x2db2c1(0x197)]),_0x5cdc24=new _0x4f1e3a(_0x341a82[_0x2db2c1(0x211)],'i'),_0x4f0ec4=_0x341a82[_0x2db2c1(0x1bd)](_0x40bb6a,_0x341a82[_0x2db2c1(0x24d)]);!_0x4e8baa['test'](_0x341a82['xKJkW'](_0x4f0ec4,_0x341a82[_0x2db2c1(0x1f6)]))||!_0x5cdc24[_0x2db2c1(0x23e)](_0x341a82[_0x2db2c1(0x1af)](_0x4f0ec4,_0x341a82[_0x2db2c1(0x15f)]))?_0x341a82['fxRbF'](_0x4f0ec4,'0'):_0x341a82['lvFFT'](_0xeabeba);})();}}catch(_0x3a50e7){if(_0x24c503[_0x4e630f(0x1bb)](_0x24c503[_0x4e630f(0x27a)],_0x24c503[_0x4e630f(0x262)]))console[_0x4e630f(0x1be)](_0x24c503[_0x4e630f(0x244)],_0x3a50e7),_0x3241ed[_0x4e630f(0x1ed)](JSON[_0x4e630f(0x242)]({'isPrint':!0x1,'class':_0x24c503['lndKR'],'msg':_0x3a50e7[_0x4e630f(0x283)]}));else{const _0x37073e=_0x5f1f87?function(){const _0xccdbd9=_0x4e630f;if(_0x41a369){const _0x59bb7a=_0x50612f[_0xccdbd9(0x2a8)](_0x20f7c5,arguments);return _0x2e0bf5=null,_0x59bb7a;}}:function(){};return _0x30da90=![],_0x37073e;}}finally{_0x24c503['DQdcG'](_0x24c503[_0x4e630f(0x1e1)],_0x24c503[_0x4e630f(0x1c1)])?_0x55108d[_0x4e630f(0x290)]():_0x99b697[_0x4e630f(0x290)]();}}),b[_0x3ecefe(0x21e)](B,_0xd88385[_0x3ecefe(0x1d1)],async(_0x293174,_0xffece)=>{const _0x2b4591=_0x3ecefe,_0x575630={'PiPPr':function(_0x95d9b5,_0x37a0c8){return _0x95d9b5+_0x37a0c8;},'TQAqt':_0x2b4591(0x223),'Rypnw':'gger','lFvIb':_0x2b4591(0x295),'kRnHz':_0x2b4591(0x257),'vEQBB':'red','JOtLp':function(_0xbfb9c8,_0x697ba){return _0xbfb9c8==_0x697ba;},'ypIrA':'cancel','FHPrG':_0x2b4591(0x1d5),'FBHwA':'finish','LKzXQ':'เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','zlUNz':function(_0x1a2d14,_0x30ca8c){return _0x1a2d14===_0x30ca8c;},'brpqF':function(_0x1a7904,_0x33ca0c){return _0x1a7904==_0x33ca0c;},'sqYgt':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','ruTfU':function(_0x485440,_0x28e29d){return _0x485440===_0x28e29d;},'wpvZR':_0x2b4591(0x25c),'BzvYF':function(_0x260fa3,_0xdfadba){return _0x260fa3==_0xdfadba;},'jofAS':function(_0x11da71,_0x1ba48e){return _0x11da71===_0x1ba48e;},'LXRTC':'xzSfi','yOXEc':function(_0x307a54,_0x5eaf2e){return _0x307a54==_0x5eaf2e;},'LdnvV':function(_0x53250f,_0x290b9a){return _0x53250f>_0x290b9a;},'aHMdk':function(_0x5a7626,_0x25e033){return _0x5a7626==_0x25e033;},'JsiCl':function(_0x52e6c0,_0x398e47){return _0x52e6c0==_0x398e47;},'pHLBd':function(_0x6ff188,_0xce7fc3){return _0x6ff188===_0xce7fc3;},'sLgDJ':'BslnS','WZUhs':'BuQbs','txlCz':'{{sep}}[บันทึกการแก้ไข]','heKnj':_0x2b4591(0x140),'AZvUW':function(_0x58c4e5,_0xb4a724){return _0x58c4e5<_0xb4a724;},'faDYS':'yellow'},_0x5e555f=new _0x5aa471(global['dbUrl']);try{const _0x220f60=await T['getSessionData'](_0x293174);await m[_0x2b4591(0x272)](_0x293174,_0xffece,_0x220f60['userAuthority']);const {collectionName:_0x1c8e81}=m[_0x2b4591(0x1a5)](_0x293174['path']),{docId:_0x1e3371,action:_0x11ac89}=_0x293174[_0x2b4591(0x1ce)],_0x4fc7ca=_0x575630[_0x2b4591(0x240)](_0x11ac89,_0x575630[_0x2b4591(0x208)])?_0x575630[_0x2b4591(0x1e4)]:_0x575630['JOtLp'](_0x11ac89,_0x575630[_0x2b4591(0x1c8)])?'จบ':'';if(!_0x1e3371||![_0x575630[_0x2b4591(0x1c8)],_0x575630[_0x2b4591(0x208)]][_0x2b4591(0x1d9)](_0x11ac89))return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630[_0x2b4591(0x231)],'msg':_0x575630[_0x2b4591(0x1f9)]}));const _0x1b79a2={'docId':_0x1e3371,'userId':_0x220f60[_0x2b4591(0x14d)]},_0x1914d9=_0x5e555f['db'](global[_0x2b4591(0x135)])[_0x2b4591(0x184)](_0x1c8e81),_0x11bf1b=await _0x1914d9[_0x2b4591(0x28b)](_0x1b79a2);if(!_0x11bf1b)return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630[_0x2b4591(0x231)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x1e3371+'{{sep}}หรือไม่มีสิทธิ์'+_0x4fc7ca+_0x2b4591(0x13c)}));const _0x2b5a1c=_0x11bf1b['docStatusNumber'];if(_0x575630['zlUNz'](_0x11ac89,_0x575630[_0x2b4591(0x208)])&&!(_0x575630[_0x2b4591(0x240)](_0x2b5a1c,0x1)||_0x575630[_0x2b4591(0x29f)](_0x2b5a1c,0x2)))return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630[_0x2b4591(0x231)],'msg':_0x575630[_0x2b4591(0x206)]}));if(_0x575630['ruTfU'](_0x11ac89,_0x575630[_0x2b4591(0x1c8)])&&_0x575630[_0x2b4591(0x29f)](!_0x2b5a1c,0x1))return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630['vEQBB'],'msg':_0x575630[_0x2b4591(0x1c9)]}));if(_0x575630['BzvYF'](_0x11ac89,_0x575630['ypIrA'])){if(_0x575630[_0x2b4591(0x215)](_0x575630[_0x2b4591(0x26d)],_0x575630[_0x2b4591(0x26d)])){if(_0x575630['yOXEc'](_0x11bf1b[_0x2b4591(0x2af)],!0x1))return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630[_0x2b4591(0x231)],'msg':_0x2b4591(0x13a)+_0x1e3371+_0x2b4591(0x254)}));if(_0x575630[_0x2b4591(0x227)]((await m[_0x2b4591(0x151)](_0x11bf1b,_0x1c8e81,_0x220f60['userId']))[_0x2b4591(0x2af)],!0x1))return _0xffece['send'](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630[_0x2b4591(0x231)],'msg':_0x2b4591(0x13a)+_0x1e3371+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}else(function(){return![];}[_0x2b4591(0x226)](DoGmWo['PiPPr'](DoGmWo[_0x2b4591(0x219)],DoGmWo[_0x2b4591(0x205)]))[_0x2b4591(0x2a8)](DoGmWo[_0x2b4591(0x210)]));}if(_0x11bf1b['payDebtRows']&&_0x575630[_0x2b4591(0x247)](_0x11bf1b[_0x2b4591(0x274)][_0x2b4591(0x1a9)],0x0))return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630['vEQBB'],'msg':'เอกสาร\x20\x22'+_0x1e3371+_0x2b4591(0x216)}));if(_0x575630[_0x2b4591(0x2aa)](_0x11ac89,_0x575630[_0x2b4591(0x208)]))var _0x22fc1a=0xa;else{if(_0x575630['JsiCl'](_0x11ac89,_0x575630[_0x2b4591(0x1c8)]))var _0x22fc1a=0x2;}const _0x3fa327=await _0x1914d9['updateOne'](_0x1b79a2,{'$set':{'docStatusNumber':_0x22fc1a}});var _0x297640=_0x4fc7ca+'\x20\x22'+_0x1e3371+_0x2b4591(0x18f);if(_0x3fa327[_0x2b4591(0x158)]||_0x575630[_0x2b4591(0x247)](_0x3fa327[_0x2b4591(0x212)],0x0)){const _0x4afef1=u[_0x2b4591(0x148)]({'docStatusNumber':_0x2b5a1c},{'docStatusNumber':_0x22fc1a});if(_0x575630[_0x2b4591(0x247)](_0x4afef1['length'],0x0)){if(_0x575630[_0x2b4591(0x1e8)](_0x575630[_0x2b4591(0x1c2)],_0x575630[_0x2b4591(0x2a4)]))_0x506546['log'](_0x575630['kRnHz'],_0x26c55a),_0x5c701e['send'](_0x2ae61d[_0x2b4591(0x242)]({'isPrint':!0x1,'class':_0x575630['vEQBB'],'msg':_0x51811f['message']}));else{const _0xe041b8={'dateTime':E[_0x2b4591(0x141)](),'userId':_0x220f60[_0x2b4591(0x14d)],'userFullname':_0x220f60[_0x2b4591(0x166)],'changes':_0x4afef1};await _0x1914d9['updateOne']({'docId':_0x1e3371},{'$push':{'changesHistory':{'$each':[_0xe041b8],'$position':0x0}}}),_0x297640+=_0x575630[_0x2b4591(0x253)];}}return _0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x0,'docId':_0x1e3371,'docStatusNumber':_0x22fc1a,'class':_0x575630['heKnj'],'msg':_0x297640}));}else{if(_0x3fa327[_0x2b4591(0x158)]&&_0x575630[_0x2b4591(0x22f)](_0x3fa327['modifiedCount'],0x1))return _0xffece['send'](JSON['stringify']({'isStatus':!0x1,'docId':_0x1e3371,'docStatusNumber':_0x2b5a1c,'class':_0x575630[_0x2b4591(0x1a8)],'msg':'\x22'+_0x1e3371+_0x2b4591(0x230)}));}}catch(_0x415016){console[_0x2b4591(0x1be)](_0x415016),_0xffece[_0x2b4591(0x1ed)](JSON[_0x2b4591(0x242)]({'isStatus':!0x1,'class':_0x575630['vEQBB'],'msg':_0x415016[_0x2b4591(0x283)]}));}finally{_0x5e555f[_0x2b4591(0x290)]();}});function _0x2396(_0x6b067e,_0x290c12){const _0x40d706=_0x5818();return _0x2396=function(_0x2ef1bf,_0x5b7aee){_0x2ef1bf=_0x2ef1bf-0x12f;let _0x521d40=_0x40d706[_0x2ef1bf];return _0x521d40;},_0x2396(_0x6b067e,_0x290c12);}export default b;function _0x1fdb85(_0x1231fe){const _0x2dd091=_0x3ecefe,_0x9d31c6={'cFNmM':function(_0x382164,_0x174252){return _0x382164===_0x174252;},'ExdXS':_0x2dd091(0x297),'gMFNb':_0x2dd091(0x175),'hOdmm':_0x2dd091(0x181),'LQihe':function(_0x4b623e,_0xc5f631){return _0x4b623e!==_0xc5f631;},'GWRWr':function(_0x33efe4,_0x55d4b4){return _0x33efe4+_0x55d4b4;},'tkkED':function(_0xd336fb,_0x2c422f){return _0xd336fb/_0x2c422f;},'OuFhZ':_0x2dd091(0x1a9),'rFkYf':function(_0x7117a7,_0x4f2cd7){return _0x7117a7===_0x4f2cd7;},'CzIqJ':function(_0x33d722,_0x5e89c1){return _0x33d722%_0x5e89c1;},'fypSF':function(_0x59419c,_0x184206){return _0x59419c+_0x184206;},'mAQGz':'debu','nsMLr':_0x2dd091(0x2b2),'DRzFN':'action','UzkSk':_0x2dd091(0x295),'VMtVR':function(_0x2af282,_0x2e09e4){return _0x2af282(_0x2e09e4);},'MBniw':function(_0x5e2b02,_0x31a3ed){return _0x5e2b02(_0x31a3ed);}};function _0x894083(_0xf7571e){const _0x33f3ee=_0x2dd091;if(_0x9d31c6[_0x33f3ee(0x285)](typeof _0xf7571e,_0x9d31c6[_0x33f3ee(0x192)]))return function(_0x3a4659){}[_0x33f3ee(0x226)](_0x9d31c6['gMFNb'])[_0x33f3ee(0x2a8)](_0x9d31c6[_0x33f3ee(0x20c)]);else _0x9d31c6[_0x33f3ee(0x23b)](_0x9d31c6[_0x33f3ee(0x232)]('',_0x9d31c6[_0x33f3ee(0x130)](_0xf7571e,_0xf7571e))[_0x9d31c6[_0x33f3ee(0x187)]],0x1)||_0x9d31c6[_0x33f3ee(0x260)](_0x9d31c6[_0x33f3ee(0x259)](_0xf7571e,0x14),0x0)?function(){return!![];}[_0x33f3ee(0x226)](_0x9d31c6[_0x33f3ee(0x16b)](_0x9d31c6['mAQGz'],_0x9d31c6[_0x33f3ee(0x277)]))['call'](_0x9d31c6[_0x33f3ee(0x1e7)]):function(){return![];}[_0x33f3ee(0x226)](_0x9d31c6[_0x33f3ee(0x232)](_0x9d31c6[_0x33f3ee(0x193)],_0x9d31c6[_0x33f3ee(0x277)]))[_0x33f3ee(0x2a8)](_0x9d31c6[_0x33f3ee(0x1c0)]);_0x9d31c6[_0x33f3ee(0x204)](_0x894083,++_0xf7571e);}try{if(_0x1231fe)return _0x894083;else _0x9d31c6[_0x2dd091(0x191)](_0x894083,0x0);}catch(_0x5f2717){}}