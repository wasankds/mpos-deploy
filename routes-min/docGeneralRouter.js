const _0x51821f=_0x3bf5;(function(_0x2ebb89,_0x57fcc3){const _0x5aeac5=_0x3bf5,_0x399679=_0x2ebb89();while(!![]){try{const _0x28a54e=parseInt(_0x5aeac5(0x221))/0x1+-parseInt(_0x5aeac5(0x200))/0x2*(parseInt(_0x5aeac5(0x1df))/0x3)+-parseInt(_0x5aeac5(0x1cf))/0x4*(-parseInt(_0x5aeac5(0x17e))/0x5)+parseInt(_0x5aeac5(0x1fe))/0x6+parseInt(_0x5aeac5(0x1c7))/0x7+parseInt(_0x5aeac5(0x16b))/0x8*(-parseInt(_0x5aeac5(0x1e0))/0x9)+-parseInt(_0x5aeac5(0x234))/0xa;if(_0x28a54e===_0x57fcc3)break;else _0x399679['push'](_0x399679['shift']());}catch(_0x1ab30a){_0x399679['push'](_0x399679['shift']());}}}(_0x1b06,0x2868b));const _0x79f090=(function(){const _0x5a459a=_0x3bf5,_0x45238f={'OOhwj':_0x5a459a(0x1e3),'hlhkv':'error\x20===>\x20','EwiTt':function(_0x24e849,_0x592161){return _0x24e849===_0x592161;},'HmpLk':_0x5a459a(0x170),'eGtcv':_0x5a459a(0x2e4),'rQiuy':_0x5a459a(0x171),'slJAM':function(_0x20c89b,_0xe85529){return _0x20c89b!==_0xe85529;},'rYSpf':_0x5a459a(0x2d6)};let _0x77fbe6=!![];return function(_0x244b4e,_0x3233b2){const _0x5908ec=_0x5a459a,_0x26062c={'JnCMZ':_0x45238f[_0x5908ec(0x187)],'ThjLo':_0x45238f[_0x5908ec(0x2f0)],'CNdLB':function(_0x170687,_0x4534b9){return _0x45238f['EwiTt'](_0x170687,_0x4534b9);},'dlKby':_0x45238f[_0x5908ec(0x20d)],'IAyMk':_0x45238f[_0x5908ec(0x210)],'hJgIa':_0x45238f['rQiuy']};if(_0x45238f['slJAM'](_0x45238f['rYSpf'],_0x45238f['rYSpf']))_0x436adb['log'](_0x526109),_0xeb07ca[_0x5908ec(0x2f2)](_0x9544ef[_0x5908ec(0x1b8)]({'isStatus':!0x1,'class':_0x26062c['JnCMZ'],'msg':_0x8e7f7a[_0x5908ec(0x292)]}));else{const _0x2cd5f3=_0x77fbe6?function(){const _0x212ba1=_0x5908ec;if(_0x26062c[_0x212ba1(0x19e)](_0x26062c[_0x212ba1(0x2ec)],_0x26062c[_0x212ba1(0x2ec)])){if(_0x3233b2){if(_0x26062c[_0x212ba1(0x19e)](_0x26062c[_0x212ba1(0x21d)],_0x26062c[_0x212ba1(0x2e1)])){const _0x407b52=_0x50911a?function(){const _0x43ea95=_0x212ba1;if(_0x4a3599){const _0x161355=_0x3114e7[_0x43ea95(0x1d5)](_0x21a4f9,arguments);return _0x4449ce=null,_0x161355;}}:function(){};return _0xa8109=![],_0x407b52;}else{const _0x329446=_0x3233b2[_0x212ba1(0x1d5)](_0x244b4e,arguments);return _0x3233b2=null,_0x329446;}}}else _0x58f621['log'](_0x26062c[_0x212ba1(0x26d)],_0x247fe2),_0x261570[_0x212ba1(0x2f2)](_0x29e008['stringify']({'isPrint':!0x1,'class':_0x26062c[_0x212ba1(0x245)],'msg':_0x5e822b[_0x212ba1(0x292)]}));}:function(){};return _0x77fbe6=![],_0x2cd5f3;}};}());(function(){const _0x5bf48d=_0x3bf5,_0x41f28b={'UzcEk':function(_0x228b08,_0x37b152){return _0x228b08(_0x37b152);},'NtKLw':function(_0x2c9491,_0x1f62bd){return _0x2c9491+_0x1f62bd;},'oayKS':function(_0x24b8af,_0x316e66){return _0x24b8af+_0x316e66;},'WaUJC':_0x5bf48d(0x21e),'ijxBq':_0x5bf48d(0x2db),'Inmse':function(_0x1ca588){return _0x1ca588();},'LiVVI':function(_0x5a7be4,_0x44aee1){return _0x5a7be4===_0x44aee1;},'wmMYj':_0x5bf48d(0x182),'ozATC':'tkonQ','GbORt':_0x5bf48d(0x1c0),'NCEpu':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','efzgR':function(_0x5e892f,_0x1b5210){return _0x5e892f(_0x1b5210);},'jTdlV':_0x5bf48d(0x1b7),'XaMxZ':'chain','FSajK':function(_0x26ec1b,_0x1d4f0b){return _0x26ec1b+_0x1d4f0b;},'ArbTA':_0x5bf48d(0x24c),'WipdP':'KtDWA','ALhdo':_0x5bf48d(0x24f),'JpcNo':function(_0x31554b,_0x591592){return _0x31554b(_0x591592);},'aVqQo':function(_0xeb9da4,_0x4dfd7e){return _0xeb9da4===_0x4dfd7e;},'hWiWG':'AeZzy','QqmPV':_0x5bf48d(0x262),'VQPRp':function(_0x671b52){return _0x671b52();},'BPqeG':function(_0x437174,_0x4b0046,_0x1fdd6b){return _0x437174(_0x4b0046,_0x1fdd6b);}};_0x41f28b[_0x5bf48d(0x29d)](_0x79f090,this,function(){const _0x1beef5=_0x5bf48d;if(_0x41f28b['LiVVI'](_0x41f28b[_0x1beef5(0x201)],_0x41f28b[_0x1beef5(0x2c0)])){if(_0x241859){const _0x5d69f0=_0x45ca70[_0x1beef5(0x1d5)](_0x65fc2d,arguments);return _0x4f39c0=null,_0x5d69f0;}}else{const _0x4bf2f4=new RegExp(_0x41f28b[_0x1beef5(0x278)]),_0x30825b=new RegExp(_0x41f28b[_0x1beef5(0x254)],'i'),_0x2f4fea=_0x41f28b[_0x1beef5(0x2f9)](_0x5f7b67,_0x41f28b[_0x1beef5(0x1e9)]);if(!_0x4bf2f4[_0x1beef5(0x2cf)](_0x41f28b[_0x1beef5(0x21a)](_0x2f4fea,_0x41f28b[_0x1beef5(0x2a6)]))||!_0x30825b[_0x1beef5(0x2cf)](_0x41f28b[_0x1beef5(0x21b)](_0x2f4fea,_0x41f28b[_0x1beef5(0x24d)]))){if(_0x41f28b[_0x1beef5(0x2be)](_0x41f28b[_0x1beef5(0x267)],_0x41f28b[_0x1beef5(0x231)])){const _0x16a27c=_0xdc8e18['apply'](_0x4941ee,arguments);return _0x29b5d0=null,_0x16a27c;}else _0x41f28b['JpcNo'](_0x2f4fea,'0');}else{if(_0x41f28b[_0x1beef5(0x22f)](_0x41f28b['hWiWG'],_0x41f28b[_0x1beef5(0x1b5)])){const _0x230721=_0x41f28b[_0x1beef5(0x281)](_0x3758de,_0x41f28b[_0x1beef5(0x21a)](_0x41f28b[_0x1beef5(0x202)](_0x41f28b[_0x1beef5(0x17f)],_0x41f28b[_0x1beef5(0x21c)]),');'));_0x82a437=_0x41f28b[_0x1beef5(0x28c)](_0x230721);}else _0x41f28b[_0x1beef5(0x1a8)](_0x5f7b67);}}})();}());const _0x3d756d=(function(){const _0x45ffc8=_0x3bf5,_0x122133={'gNDLX':_0x45ffc8(0x1c0),'pQiDI':_0x45ffc8(0x2a9),'RCUlH':function(_0xebdeb,_0x482415){return _0xebdeb(_0x482415);},'ByPAp':_0x45ffc8(0x1b7),'fiWuk':function(_0x57c85f,_0x18959b){return _0x57c85f+_0x18959b;},'zIVFv':_0x45ffc8(0x25d),'voHsB':_0x45ffc8(0x24c),'YGxTZ':function(_0x321041){return _0x321041();},'olmvu':function(_0x5f57e2,_0x3c94bd,_0x321b2f){return _0x5f57e2(_0x3c94bd,_0x321b2f);},'nCznX':_0x45ffc8(0x1e3),'XyJai':function(_0x42d954,_0x43fa5b){return _0x42d954!==_0x43fa5b;},'fGwib':_0x45ffc8(0x240),'JjhwY':function(_0x5e5143,_0x15e6a9){return _0x5e5143===_0x15e6a9;},'GebGI':_0x45ffc8(0x28d),'IOYol':_0x45ffc8(0x19c),'yAERN':_0x45ffc8(0x180)};let _0x5d6e18=!![];return function(_0x37f169,_0x11644a){const _0x179bcc=_0x45ffc8;if(_0x122133[_0x179bcc(0x19b)](_0x122133[_0x179bcc(0x1d6)],_0x122133['yAERN'])){const _0x3c6cc9=_0x5d6e18?function(){const _0x3b79d6=_0x179bcc,_0x2a791c={'rhMoh':_0x122133[_0x3b79d6(0x1dc)],'YVbXe':_0x122133[_0x3b79d6(0x2ca)],'YVfgV':function(_0x2ca995,_0x2e68ab){return _0x122133['RCUlH'](_0x2ca995,_0x2e68ab);},'UhbyI':_0x122133[_0x3b79d6(0x1a0)],'aPHSP':function(_0x5ad6c4,_0x5315fe){const _0x394297=_0x3b79d6;return _0x122133[_0x394297(0x2ef)](_0x5ad6c4,_0x5315fe);},'ErIQc':_0x122133[_0x3b79d6(0x1f5)],'PRLoM':_0x122133[_0x3b79d6(0x269)],'ODByH':function(_0x11d4eb,_0x842389){const _0x704860=_0x3b79d6;return _0x122133[_0x704860(0x272)](_0x11d4eb,_0x842389);},'NYmny':function(_0x13182d){return _0x122133['YGxTZ'](_0x13182d);},'LXznb':function(_0x2d7c38,_0x3e7a48,_0x45a220){const _0xbd65cd=_0x3b79d6;return _0x122133[_0xbd65cd(0x24b)](_0x2d7c38,_0x3e7a48,_0x45a220);},'TUIKw':_0x122133[_0x3b79d6(0x27d)]};if(_0x122133[_0x3b79d6(0x1f1)](_0x122133['fGwib'],_0x122133[_0x3b79d6(0x296)]))_0x2a791c[_0x3b79d6(0x1f8)](_0x3aef66,this,function(){const _0x6898ea=_0x3b79d6,_0x5c3b97=new _0x331d31(_0x2a791c['rhMoh']),_0x5a52a0=new _0x59a46c(_0x2a791c['YVbXe'],'i'),_0x1be382=_0x2a791c[_0x6898ea(0x1bd)](_0x4ed70f,_0x2a791c['UhbyI']);!_0x5c3b97[_0x6898ea(0x2cf)](_0x2a791c[_0x6898ea(0x1a9)](_0x1be382,_0x2a791c[_0x6898ea(0x1f7)]))||!_0x5a52a0['test'](_0x2a791c[_0x6898ea(0x1a9)](_0x1be382,_0x2a791c[_0x6898ea(0x27f)]))?_0x2a791c['ODByH'](_0x1be382,'0'):_0x2a791c[_0x6898ea(0x217)](_0x1b9e88);})();else{if(_0x11644a){if(_0x122133['JjhwY'](_0x122133['GebGI'],_0x122133[_0x3b79d6(0x19a)]))return _0x54de97[_0x3b79d6(0x1b9)](_0x4bf52c),_0xf3e3d2['send'](_0x115a2c[_0x3b79d6(0x1b8)]({'isLoad':!0x1,'class':_0x2a791c['TUIKw'],'msg':_0x541c60[_0x3b79d6(0x292)]}));else{const _0x973fb5=_0x11644a[_0x3b79d6(0x1d5)](_0x37f169,arguments);return _0x11644a=null,_0x973fb5;}}}}:function(){};return _0x5d6e18=![],_0x3c6cc9;}else _0x35ad32[_0x179bcc(0x1d7)]();};}()),_0x3360e5=_0x3d756d(this,function(){const _0x78361c=_0x3bf5,_0x5d3652={'HfNaU':function(_0x4abd37,_0x1caaf1){return _0x4abd37(_0x1caaf1);},'dXdSU':function(_0x378f3b,_0x4c19d7){return _0x378f3b+_0x4c19d7;},'TXRJD':_0x78361c(0x2ff),'vQIlX':'gger','mnifI':_0x78361c(0x2fb),'HhcrS':function(_0x1fa647,_0x25cf3e){return _0x1fa647===_0x25cf3e;},'JUjng':'BdvJB','EJAqt':function(_0x4e557c,_0x1cae09){return _0x4e557c+_0x1cae09;},'sPPiz':'return\x20(function()\x20','BaWan':'{}.constructor(\x22return\x20this\x22)(\x20)','DMrXI':function(_0x18271f){return _0x18271f();},'fqEGO':_0x78361c(0x27b),'LFDHT':_0x78361c(0x288),'kcgtK':_0x78361c(0x1b9),'XGygZ':_0x78361c(0x263),'tBcKJ':_0x78361c(0x2a7),'lunqD':_0x78361c(0x2cb),'GQZnJ':_0x78361c(0x2ba),'Cykvg':_0x78361c(0x266),'LfGvj':_0x78361c(0x20e),'fBIxr':function(_0x2e6252,_0x13a037){return _0x2e6252<_0x13a037;},'qqRap':function(_0x542ab0,_0x4e5d44){return _0x542ab0!==_0x4e5d44;},'wTjMl':'FJSFO'};let _0xabb32b;try{if(_0x5d3652[_0x78361c(0x2ce)](_0x5d3652[_0x78361c(0x174)],_0x5d3652[_0x78361c(0x174)])){const _0x1fc950=_0x5d3652[_0x78361c(0x1c8)](Function,_0x5d3652['dXdSU'](_0x5d3652[_0x78361c(0x224)](_0x5d3652[_0x78361c(0x1ce)],_0x5d3652[_0x78361c(0x1ba)]),');'));_0xabb32b=_0x5d3652[_0x78361c(0x2b1)](_0x1fc950);}else{if(_0x48403e){const _0xaf8be2=_0xb2733b[_0x78361c(0x1d5)](_0x5e201a,arguments);return _0x5bcbda=null,_0xaf8be2;}}}catch(_0x4d9a80){_0x5d3652[_0x78361c(0x2ce)](_0x5d3652['fqEGO'],_0x5d3652[_0x78361c(0x279)])?_0x5d3652[_0x78361c(0x1c8)](_0x36f1ae,0x0):_0xabb32b=window;}const _0x6163cb=_0xabb32b['console']=_0xabb32b[_0x78361c(0x230)]||{},_0x380121=[_0x5d3652['kcgtK'],_0x5d3652['XGygZ'],_0x5d3652[_0x78361c(0x1eb)],_0x5d3652[_0x78361c(0x20a)],_0x5d3652[_0x78361c(0x2fd)],_0x5d3652[_0x78361c(0x2d2)],_0x5d3652[_0x78361c(0x2ad)]];for(let _0x1ef808=0x0;_0x5d3652[_0x78361c(0x23a)](_0x1ef808,_0x380121['length']);_0x1ef808++){if(_0x5d3652[_0x78361c(0x295)](_0x5d3652['wTjMl'],_0x5d3652[_0x78361c(0x25c)]))(function(){return![];}[_0x78361c(0x18e)](_0x5d3652['dXdSU'](_0x5d3652[_0x78361c(0x214)],_0x5d3652[_0x78361c(0x198)]))[_0x78361c(0x1d5)](_0x5d3652[_0x78361c(0x26a)]));else{const _0x3a1157=_0x3d756d['constructor'][_0x78361c(0x1fd)][_0x78361c(0x23e)](_0x3d756d),_0x4884e2=_0x380121[_0x1ef808],_0x3c3a0d=_0x6163cb[_0x4884e2]||_0x3a1157;_0x3a1157[_0x78361c(0x193)]=_0x3d756d[_0x78361c(0x23e)](_0x3d756d),_0x3a1157[_0x78361c(0x2b7)]=_0x3c3a0d[_0x78361c(0x2b7)][_0x78361c(0x23e)](_0x3c3a0d),_0x6163cb[_0x4884e2]=_0x3a1157;}}});_0x3360e5();function _0x1b06(){const _0x37224f=['dbName','MfTMb','folderForms','getSessionData','WJEWH','fBIxr','Kjklt','JXMWB','cgMUI','bind','scrollHeight','ZcrmS','VYitP','paytype','/fetch/modal','wCqOX','JnCMZ','hDsnA','../','QLpsr','doc_print.ejs','WLfqZ','olmvu','input','ArbTA','push','mcgvA','userId','/myModule.js','NdDwG','kbjcw','NCEpu','ประวัติการแก้ไขเอกสาร\x20:\x20','gger','lOZty','join','xnqnb','zTDKZ','dateTimeCancelRemain','wTjMl','chain','olfJK','sPbTn','umPvV','ไม่พบเอกสาร\x20\x22','mCCMg','warn','post','lGjvb','table','WipdP','iamqU','voHsB','mnifI','aUgdo','while\x20(true)\x20{}','ThjLo','porPL','OvUNX','nrHDZ','get_StatusName_byStatusNumber','RCUlH','oVBpC','/load','pxOUR','getItems_for_Modal','screenshot','GbORt','LFDHT','SqaGP','BSduX','image/jpeg','nCznX','string','PRLoM','fmBnN','UzcEk','connect','statusName','PATH_WAREHOUSE_IN','ZqVzb','lPwAQ','DfWlo','mRVHf','Imbjd','dateTimeCanCancel','branchName','Inmse','QdovV','VVHDL','QyeVX','kWZAb','โหลดเอกสารเลขที่\x20\x22','message','FADYr','ไม่พบประวัติการเปลี่ยนแปลง','qqRap','fGwib','WhUKL','ldpwU','SQyFK','renderView','paymentMethod2','cbDUC','BPqeG','nmApz','uUefg','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','eXSnr','paymentMethod1Name','changesHistory','body','/load-last','XaMxZ','info','find','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','error\x20===>\x20','aggregate','LfGvj','HHJpF','XKkfb','image','DMrXI','bxskC','branchId','eonLG','includes','lBZnk','toString','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','writeHead','exception','OnTsh','quoQB','BljJB','LiVVI','active','ozATC','length','NbtPO','max','QMQHo','\x22\x20เอกสาร','McNUn','NtHYr','pkpCT','SmOTa','pQiDI','error','paymentMethod1','ENocp','HhcrS','test','OkOCa','replace','Cykvg','load','hyxFt','finish','yaihr','FMMci','XRITD','SqAOs','puppeteer','{}.constructor(\x22return\x20this\x22)(\x20)','sQkxs','getChangeHistory','cancel','DLmXg','jvCEz','hJgIa','QxAIc','wkgud','nFbQg','fQwZW','XDfXe','wmoWt','PKThh','gDPDG','yellow','LFoFz','dlKby','PAY_TYPE','getUserData','fiWuk','hlhkv','dZSrT','send','VtqNH','cBrTl','zQIOL','clientHeight','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','networkidle0','efzgR','LOvja','stateObject','NYRLE','GQZnJ','FoXyO','debu','LGNpT','matchedCount','8MyRxlD','Anncn','getDate','HWPVG','mAYsd','youly','ZiqMv','action','stock','JUjng','collection','end','JBOfT','.jpeg','CopBf','ไม่พบเอกสารล่าสุด','dzKox','canCancel','print','145izlUAk','WaUJC','uexKC','vkriM','RLmPB','WNYyo','RlVOn','ZQWxV','/search','OOhwj','getMainDocPathObj','findOne','PATH_WAREHOUSE_OUT','/print','updateOne','mmmiI','constructor','ulgRT','JlrKO','newPage','qJYaQ','__proto__','cENdI','EHVgM','LeuIE','RmVIL','vQIlX','\x22\x20{{sep}}เรียบร้อยแล้ว','IOYol','JjhwY','alvOG','XcyQc','CNdLB','ยกเลิก','ByPAp','hEbgf','XBxwm','gpIbs','eWTNu','PATH_SALES','zJDfV','payTypeThai','VQPRp','aPHSP','QiyFE','oVjki','IHPyb','wcTZo','doc_changes.ejs','Router','WFebr','RGBSr','RcZcy','DUxag','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','QqmPV','fzcfS','init','stringify','log','BaWan','GzbYG','jeRic','YVfgV','szIiI','GoMzU','function\x20*\x5c(\x20*\x5c)','yJIkq','uarNI','modifiedCount','zPOYy','collectionName','vVggW','115171zDdZNH','HfNaU','userAuthority','{{sep}}[บันทึกการแก้ไข]','AvyWj','lfPaK','DOC_TYPE','sPPiz','33272XAIoeJ','sWwMI','lcUMF','NXJHT','check_DocDateTime_CanCancel','LkaFc','apply','yAERN','close','warehouseIn','green','ไม่พบเอกสารเลขที่\x20\x22','INoPa','gNDLX','qpRqy','docId','276WFRXBU','1170054texvDT','pBUpH','HPGTX','red','dUZdF','เอกสารที่ตันเองไม่ได้สร้าง','\x22\x20เรียบร้อยแล้ว','tlZxn','docStatusNumber','jTdlV','gvloC','tBcKJ','JmjRj','documentElement','YhEBs','zqRgK','path','XyJai','bYFNi','getItemsCategory','qkuls','zIVFv','PcLbm','ErIQc','LXznb','ooPYz','/myDateTime.js','getSettings','JXsyi','prototype','1347702HiJxHe','OqeYI','4954qjINkX','wmMYj','oayKS','/changes','paymentMethod2Name','return','xsUxL','Olpvk','/status','uTFhM','lunqD','CdoQr','offsetHeight','HmpLk','trace','{{sep}}[\x20ค้นหาเฉพาะในสาขาตนเอง\x20]','eGtcv','QBLdu','wtQhw','dbUrl','TXRJD','GkCiU','attachment;\x20filename=','NYmny','check_DocDateTime_CanEdit','PDosc','NtKLw','FSajK','ijxBq','IAyMk','return\x20(function()\x20','DXbjA','dateTimeCanEdit','308656nAMQAO','/myUsers.js','canEdit','EJAqt','get_Info_ByPath','isAuth','dateTimeEditRemain','load-last','\x20ไม่เปลี่ยนแปลง\x22','counter','FQBzT','hclnw','JUxVy','YuDAo','aVqQo','console','ALhdo','OHyCR','oQvrA','2675430tETtrl'];_0x1b06=function(){return _0x37224f;};return _0x1b06();}import _0x58f79d from'express';const y=_0x58f79d[_0x51821f(0x1af)]();import _0x1320ba from'path';import{MongoClient as _0x3d8ee0}from'mongodb';import _0x560e94 from'../middleware/mainAuth.js';const C=await import(_0x51821f(0x247)+mymoduleFolder+_0x51821f(0x251)),E=await import(_0x51821f(0x247)+mymoduleFolder+_0x51821f(0x1fa)),$=await import('../'+mymoduleFolder+_0x51821f(0x222)),u=await import(_0x51821f(0x247)+mymoduleFolder+'/myData.js'),m=await import(_0x51821f(0x247)+mymoduleFolder+'/myDocMain.js'),b=global[_0x51821f(0x284)],p=global[_0x51821f(0x18a)],S=global[_0x51821f(0x1a5)],w=global['PATH_RETURN'],v=[b+_0x51821f(0x243),p+_0x51821f(0x243),S+_0x51821f(0x243),w+_0x51821f(0x243)],k=[b+_0x51821f(0x203),p+'/changes',S+_0x51821f(0x203),w+_0x51821f(0x203)],L=[b+_0x51821f(0x18b),p+_0x51821f(0x18b),S+_0x51821f(0x18b),w+_0x51821f(0x18b)],B=[b+_0x51821f(0x208),p+_0x51821f(0x208),S+_0x51821f(0x208),w+'/status'],Y=[b+_0x51821f(0x186),p+_0x51821f(0x186),S+'/search',w+_0x51821f(0x186)],x=[b+_0x51821f(0x274),p+_0x51821f(0x274),S+'/load',w+_0x51821f(0x274),b+_0x51821f(0x2a5),p+'/load-last',S+_0x51821f(0x2a5),w+_0x51821f(0x2a5)];y['get'](v,_0x560e94[_0x51821f(0x226)],async(_0x428f91,_0x4d0efa)=>{const _0x1fc692=_0x51821f,_0x4d8aed={'lOZty':function(_0x21e6c0,_0x3afc6a){return _0x21e6c0(_0x3afc6a);},'SQyFK':function(_0x39806c,_0x30eab9){return _0x39806c(_0x30eab9);},'OcGob':function(_0x8da071,_0x281766){return _0x8da071+_0x281766;},'HHJpF':function(_0x11a5fe,_0x2abd7d){return _0x11a5fe+_0x2abd7d;},'ZlweM':_0x1fc692(0x21e),'QxAIc':_0x1fc692(0x2db),'oVBpC':function(_0x1e9f05){return _0x1e9f05();},'kgrqU':'log','YhEBs':_0x1fc692(0x263),'cBrTl':'info','WutOl':_0x1fc692(0x2cb),'IHPyb':_0x1fc692(0x2ba),'KotDk':_0x1fc692(0x266),'AvyWj':'trace','LGNpT':function(_0x3f9982,_0xdbccfa){return _0x3f9982<_0xdbccfa;},'zqRgK':function(_0x407d3f,_0x1bfdc0){return _0x407d3f!==_0x1bfdc0;},'yJIkq':_0x1fc692(0x1f4),'UyrRW':function(_0x3c5e34,_0x57ff74){return _0x3c5e34==_0x57ff74;},'uarNI':_0x1fc692(0x1d8),'FADYr':_0x1fc692(0x173),'NtHYr':_0x1fc692(0x2bf),'McNUn':function(_0x695fdc,_0x242db3){return _0x695fdc==_0x242db3;},'wdXUy':'warehouseOut','fmBnN':'sales','gSvLN':_0x1fc692(0x205),'hclnw':_0x1fc692(0x1d9),'WLfqZ':_0x1fc692(0x2aa),'wtQhw':_0x1fc692(0x26b),'UMHmN':_0x1fc692(0x1e3)},_0x2b448b=await $[_0x1fc692(0x238)](_0x428f91),_0x3524d3=await m[_0x1fc692(0x188)](_0x428f91,_0x4d0efa,_0x2b448b[_0x1fc692(0x1c9)]);try{if(_0x4d8aed['zqRgK'](_0x4d8aed[_0x1fc692(0x1c1)],_0x4d8aed[_0x1fc692(0x1c1)])){if(_0x4eb1aa)return _0x3c34a0;else KrrdgL[_0x1fc692(0x257)](_0x4735b6,0x0);}else{if(_0x4d8aed['UyrRW'](_0x3524d3[_0x1fc692(0x1cd)],_0x4d8aed[_0x1fc692(0x1c2)]))var _0x1a98f4=await u['getItems_for_Modal'](_0x4d8aed['FADYr']),_0xdc083a=await u['getSuppliers_for_Modal'](_0x4d8aed[_0x1fc692(0x2c7)]);else{if(_0x4d8aed['McNUn'](_0x3524d3[_0x1fc692(0x1cd)],_0x4d8aed['wdXUy']))var _0x1a98f4=await u[_0x1fc692(0x276)](_0x4d8aed[_0x1fc692(0x293)]),_0xdc083a=[];else{if(_0x4d8aed[_0x1fc692(0x2c6)](_0x3524d3[_0x1fc692(0x1cd)],_0x4d8aed[_0x1fc692(0x280)]))var _0x1a98f4=await u[_0x1fc692(0x276)](_0x4d8aed[_0x1fc692(0x2c7)],_0x2b448b[_0x1fc692(0x2b3)]),_0xdc083a=[];else{if(_0x4d8aed[_0x1fc692(0x2c6)](_0x3524d3[_0x1fc692(0x1cd)],_0x4d8aed['gSvLN']))var _0x1a98f4=await u['getItems_for_Modal'](_0x4d8aed[_0x1fc692(0x2c7)],_0x2b448b[_0x1fc692(0x2b3)]),_0xdc083a=[];}}}const _0x422147=await u[_0x1fc692(0x1f3)]();return _0x4d0efa[_0x1fc692(0x2f2)](JSON[_0x1fc692(0x1b8)]({'DATA_ITEMS':_0x1a98f4,'DATA_CATEGORY':_0x422147,'DATA_SUPPLIERS':_0xdc083a,'isFetch':!0x0,'class':_0x4d8aed[_0x1fc692(0x22c)],'msg':_0x4d8aed[_0x1fc692(0x24a)]}));}}catch(_0x153735){if(_0x4d8aed[_0x1fc692(0x1ef)](_0x4d8aed[_0x1fc692(0x212)],_0x4d8aed[_0x1fc692(0x212)])){let _0x20e430;try{const _0x2cb262=KrrdgL[_0x1fc692(0x299)](_0x2b2b52,KrrdgL['OcGob'](KrrdgL[_0x1fc692(0x2ae)](KrrdgL['ZlweM'],KrrdgL[_0x1fc692(0x2e2)]),');'));_0x20e430=KrrdgL[_0x1fc692(0x273)](_0x2cb262);}catch(_0x3187a9){_0x20e430=_0x1bc413;}const _0x25d0fa=_0x20e430['console']=_0x20e430[_0x1fc692(0x230)]||{},_0x41ac93=[KrrdgL['kgrqU'],KrrdgL[_0x1fc692(0x1ee)],KrrdgL[_0x1fc692(0x2f4)],KrrdgL['WutOl'],KrrdgL[_0x1fc692(0x1ac)],KrrdgL['KotDk'],KrrdgL[_0x1fc692(0x1cb)]];for(let _0xec80b=0x0;KrrdgL[_0x1fc692(0x169)](_0xec80b,_0x41ac93[_0x1fc692(0x2c1)]);_0xec80b++){const _0x86ed31=_0x4f8113[_0x1fc692(0x18e)][_0x1fc692(0x1fd)][_0x1fc692(0x23e)](_0x530df3),_0x1ad8a9=_0x41ac93[_0xec80b],_0xea20cd=_0x25d0fa[_0x1ad8a9]||_0x86ed31;_0x86ed31['__proto__']=_0x209667[_0x1fc692(0x23e)](_0x2109aa),_0x86ed31[_0x1fc692(0x2b7)]=_0xea20cd[_0x1fc692(0x2b7)][_0x1fc692(0x23e)](_0xea20cd),_0x25d0fa[_0x1ad8a9]=_0x86ed31;}}else return console[_0x1fc692(0x1b9)](_0x153735),_0x4d0efa[_0x1fc692(0x2f2)](JSON[_0x1fc692(0x1b8)]({'isFetch':!0x1,'class':_0x4d8aed['UMHmN'],'msg':_0x153735[_0x1fc692(0x292)]}));}}),y['post'](Y,_0x560e94[_0x51821f(0x226)],async(_0x47b04c,_0x42738a)=>{const _0x4b9638=_0x51821f,_0x3372c2={'RmVIL':function(_0x4ebf06,_0x317415){return _0x4ebf06<_0x317415;},'VtqNH':_0x4b9638(0x2ea),'CopBf':_0x4b9638(0x1b4),'LFoFz':function(_0x37c8ae,_0x5297c3){return _0x37c8ae===_0x5297c3;},'kWZAb':_0x4b9638(0x1aa),'ENocp':_0x4b9638(0x20f),'JmjRj':function(_0x367b5f,_0x2431cd){return _0x367b5f+_0x2431cd;},'cgMUI':'green','QMQHo':_0x4b9638(0x2e0),'uTFhM':'red','OnTsh':function(_0x143c84,_0x36d558){return _0x143c84===_0x36d558;},'bYFNi':_0x4b9638(0x1e2),'DBNcq':_0x4b9638(0x1a6)};let {sip:_0x5ec4d1}=_0x47b04c[_0x4b9638(0x2a4)];if(!_0x5ec4d1&&_0x3372c2[_0x4b9638(0x197)](_0x5ec4d1[_0x4b9638(0x2c1)],0x2))return _0x42738a[_0x4b9638(0x2f2)](JSON['stringify']({'isSearch':!0x1,'class':_0x3372c2[_0x4b9638(0x2f3)],'msg':_0x3372c2[_0x4b9638(0x179)]}));_0x5ec4d1=_0x5ec4d1[_0x4b9638(0x2d1)](/[!@#$%^&*<>]/g,'')??null;const _0x2b1c5b=await $[_0x4b9638(0x2ee)](_0x47b04c);await m[_0x4b9638(0x188)](_0x47b04c,_0x42738a,_0x2b1c5b[_0x4b9638(0x1c9)]);const _0x23bea2=m['get_Info_ByPath'](_0x47b04c[_0x4b9638(0x1f0)]),_0xbfbe9e=new _0x3d8ee0(global[_0x4b9638(0x213)]);try{if(_0x3372c2['LFoFz'](_0x3372c2[_0x4b9638(0x290)],_0x3372c2['kWZAb'])){await _0xbfbe9e[_0x4b9638(0x282)]();const _0x3c4069=_0xbfbe9e['db'](global[_0x4b9638(0x235)])[_0x4b9638(0x175)](_0x23bea2[_0x4b9638(0x1c5)]),_0x303773=[{'$or':[{'docId':{'$regex':_0x5ec4d1,'$options':'i'}},{'docDateTime':{'$regex':_0x5ec4d1,'$options':'i'}}]}];let _0xf8aa73='';['O','S'][_0x4b9638(0x2b5)](_0x2b1c5b[_0x4b9638(0x1c9)])||(_0xf8aa73+=_0x3372c2[_0x4b9638(0x2cd)],_0x303773[_0x4b9638(0x24e)]({'branchId':_0x2b1c5b[_0x4b9638(0x2b3)]}));const _0x1b8b99=await _0x3c4069[_0x4b9638(0x2ac)]([{'$match':{'$and':_0x303773}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])['toArray']();return _0xf8aa73=_0x3372c2[_0x4b9638(0x1ec)]('พบ\x20\x22'+_0x1b8b99['length']+_0x4b9638(0x2c5),_0xf8aa73),_0x42738a[_0x4b9638(0x2f2)](JSON['stringify']({'searchFound':_0x1b8b99,'msg':_0xf8aa73,'isSearch':!0x0,'class':_0x3372c2[_0x4b9638(0x23d)]}));}else _0x2b8bfd=_0x16542b;}catch(_0x2f3e3a){return _0x3372c2[_0x4b9638(0x2eb)](_0x3372c2[_0x4b9638(0x2c4)],_0x3372c2[_0x4b9638(0x2c4)])?(console[_0x4b9638(0x1b9)](_0x2f3e3a),_0x42738a[_0x4b9638(0x2f2)](JSON['stringify']({'isSearch':!0x1,'class':_0x3372c2[_0x4b9638(0x209)],'msg':_0x2f3e3a[_0x4b9638(0x292)]}))):!![];}finally{if(_0x3372c2[_0x4b9638(0x2bb)](_0x3372c2[_0x4b9638(0x1f2)],_0x3372c2['DBNcq']))return _0x1e1d96;else _0xbfbe9e['close']();}}),y[_0x51821f(0x264)](x,_0x560e94[_0x51821f(0x226)],async(_0x5bf9c4,_0x5de4a6)=>{const _0xf221f4=_0x51821f,_0x374a01={'lBZnk':_0xf221f4(0x1e3),'EHVgM':function(_0x52ce7f){return _0x52ce7f();},'VYitP':function(_0x419388,_0x42ded3){return _0x419388(_0x42ded3);},'XBxwm':function(_0x100b91,_0x360b19){return _0x100b91!==_0x360b19;},'CdoQr':_0xf221f4(0x1a1),'tlZxn':_0xf221f4(0x1f9),'vVggW':function(_0x37fe3b,_0x59426b){return _0x37fe3b===_0x59426b;},'umPvV':_0xf221f4(0x2d3),'ldpwU':_0xf221f4(0x28e),'npWWC':_0xf221f4(0x2e9),'NbtPO':_0xf221f4(0x228),'oVjki':_0xf221f4(0x17a),'lGjvb':function(_0x51e182,_0x474f44){return _0x51e182==_0x474f44;},'JBOfT':function(_0x73e76c,_0x33509f){return _0x73e76c!==_0x33509f;},'PkHSQ':_0xf221f4(0x25a),'quoQB':_0xf221f4(0x16c),'DUxag':_0xf221f4(0x2a0),'GkCiU':_0xf221f4(0x1c4),'wmoWt':_0xf221f4(0x18d),'SqaGP':'green','ZQWxV':function(_0x554f5d,_0x53f7b6){return _0x554f5d!==_0x53f7b6;},'GoMzU':'GRPFw','Gviok':_0xf221f4(0x2c9),'LOvja':_0xf221f4(0x2af),'qMNfs':_0xf221f4(0x23b)};let {docId:_0x593136,action:_0x16735c}=_0x5bf9c4[_0xf221f4(0x2a4)];const _0x3930bf=await $[_0xf221f4(0x2ee)](_0x5bf9c4);await m[_0xf221f4(0x188)](_0x5bf9c4,_0x5de4a6,_0x3930bf[_0xf221f4(0x1c9)]);const _0x4f17cb=m[_0xf221f4(0x225)](_0x5bf9c4[_0xf221f4(0x1f0)]),_0x15bade=new _0x3d8ee0(global[_0xf221f4(0x213)]);try{if(_0x374a01[_0xf221f4(0x1a2)](_0x374a01[_0xf221f4(0x20b)],_0x374a01[_0xf221f4(0x1e7)])){await _0x15bade[_0xf221f4(0x282)]();const _0x260caa=_0x15bade['db'](global['dbName'])[_0xf221f4(0x175)](_0x4f17cb[_0xf221f4(0x1c5)]);if(_0x374a01[_0xf221f4(0x1c6)](_0x16735c,_0x374a01['umPvV'])){if(_0x374a01[_0xf221f4(0x1a2)](_0x374a01[_0xf221f4(0x298)],_0x374a01['npWWC'])){const _0x234b26=['O','S'][_0xf221f4(0x2b5)](_0x3930bf[_0xf221f4(0x1c9)])?{'docId':_0x593136}:{'docId':_0x593136,'branchId':_0x3930bf[_0xf221f4(0x2b3)]};var _0x5d1a3a=await _0x260caa[_0xf221f4(0x189)](_0x234b26,{'projection':{'_id':0x0,'changesHistory':0x0}});}else return![];}else{if(_0x374a01[_0xf221f4(0x1c6)](_0x16735c,_0x374a01[_0xf221f4(0x2c2)]))var _0x5d1a3a=await _0x260caa[_0xf221f4(0x189)]({'userId':_0x3930bf[_0xf221f4(0x250)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x7f73ec=_0x5d1a3a?'':_0x374a01['vVggW'](_0x16735c,_0x374a01[_0xf221f4(0x260)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x593136+'\x22':_0x374a01[_0xf221f4(0x1ab)];if(!_0x5d1a3a)return _0x5de4a6['send'](JSON[_0xf221f4(0x1b8)]({'isLoad':!0x1,'class':_0x374a01[_0xf221f4(0x2b6)],'msg':_0x7f73ec}));if(_0x374a01['lGjvb'](_0x5d1a3a[_0xf221f4(0x1e8)],0x1)&&_0x5d1a3a[_0xf221f4(0x220)]){if(_0x374a01[_0xf221f4(0x177)](_0x374a01['PkHSQ'],_0x374a01[_0xf221f4(0x2bc)])){let _0x503331=await m[_0xf221f4(0x218)](_0x5d1a3a,_0x4f17cb[_0xf221f4(0x1c5)],_0x3930bf['userId']);_0x5d1a3a[_0xf221f4(0x227)]=_0x503331[_0xf221f4(0x227)],_0x374a01[_0xf221f4(0x265)](_0x503331[_0xf221f4(0x223)],!0x1)&&(_0x5d1a3a[_0xf221f4(0x1e8)]=_0x503331[_0xf221f4(0x1e8)],msg+=_0x374a01[_0xf221f4(0x1b3)]);}else return _0x36aff0[_0xf221f4(0x1b9)](_0xf757c6),_0x3a7ac6[_0xf221f4(0x2f2)](_0x1c4670[_0xf221f4(0x1b8)]({'isFetch':!0x1,'class':_0x374a01['lBZnk'],'msg':_0x47b172[_0xf221f4(0x292)]}));}if((_0x374a01['lGjvb'](_0x5d1a3a[_0xf221f4(0x1e8)],0x1)||_0x374a01['lGjvb'](_0x5d1a3a[_0xf221f4(0x1e8)],0x2))&&_0x5d1a3a[_0xf221f4(0x28a)]){if(_0x374a01[_0xf221f4(0x1a2)](_0x374a01[_0xf221f4(0x215)],_0x374a01[_0xf221f4(0x2e7)])){const _0x5d8f73=await m[_0xf221f4(0x1d3)](_0x5d1a3a,_0x4f17cb[_0xf221f4(0x1c5)],_0x3930bf[_0xf221f4(0x250)]);_0x5d1a3a[_0xf221f4(0x25b)]=_0x5d8f73[_0xf221f4(0x25b)];}else lylnHd[_0xf221f4(0x195)](_0x107dc5);}const {branchName:_0x173655}=await u['getUserBranchesById'](_0x5d1a3a[_0xf221f4(0x2b3)]);return _0x5d1a3a[_0xf221f4(0x28b)]=_0x173655,_0x5de4a6[_0xf221f4(0x2f2)](JSON[_0xf221f4(0x1b8)]({'doc':_0x5d1a3a,'isLoad':!0x0,'class':_0x374a01[_0xf221f4(0x27a)],'msg':_0xf221f4(0x291)+_0x5d1a3a['docId']+_0xf221f4(0x199),'userId':_0x3930bf[_0xf221f4(0x250)],'userAuthority':_0x3930bf[_0xf221f4(0x1c9)]}));}else lylnHd[_0xf221f4(0x241)](_0x5e7b15,'0');}catch(_0x35f8d3){if(_0x374a01[_0xf221f4(0x185)](_0x374a01[_0xf221f4(0x1bf)],_0x374a01['Gviok']))return console['log'](_0x35f8d3),_0x5de4a6[_0xf221f4(0x2f2)](JSON['stringify']({'isLoad':!0x1,'class':_0x374a01[_0xf221f4(0x2b6)],'msg':_0x35f8d3[_0xf221f4(0x292)]}));else _0x3c2733[_0xf221f4(0x1d7)]();}finally{if(_0x374a01[_0xf221f4(0x1c6)](_0x374a01[_0xf221f4(0x2fa)],_0x374a01['qMNfs'])){const _0x4c71f8=_0x3ace17[_0xf221f4(0x18e)]['prototype'][_0xf221f4(0x23e)](_0x8b2caf),_0x4eb500=_0x434761[_0x29c3ef],_0x185559=_0x2fe08b[_0x4eb500]||_0x4c71f8;_0x4c71f8[_0xf221f4(0x193)]=_0x4c9551[_0xf221f4(0x23e)](_0x4fd01f),_0x4c71f8[_0xf221f4(0x2b7)]=_0x185559[_0xf221f4(0x2b7)]['bind'](_0x185559),_0x1ce4eb[_0x4eb500]=_0x4c71f8;}else _0x15bade[_0xf221f4(0x1d7)]();}}),y[_0x51821f(0x264)](k,_0x560e94[_0x51821f(0x226)],async(_0x1b55d2,_0x105ddf)=>{const _0x19bee0=_0x51821f,_0x1cef39={'RifSB':_0x19bee0(0x26c),'WcxOu':_0x19bee0(0x22a),'wCqOX':'red','lcUMF':function(_0x294b2e,_0x4aa5ca){return _0x294b2e!==_0x4aa5ca;},'WNYyo':_0x19bee0(0x219),'sWwMI':'gdAph','FoBXh':function(_0xbf7e4e,_0x1434a4){return _0xbf7e4e<_0x1434a4;},'sdCda':_0x19bee0(0x2ea),'JXsyi':_0x19bee0(0x294),'YuDAo':_0x19bee0(0x1ae),'OHyCR':_0x19bee0(0x1d9),'NdDwG':function(_0x5a0a42,_0x128561){return _0x5a0a42===_0x128561;},'zJuCe':_0x19bee0(0x207),'bxmSa':'ykVkv','BVQvb':'error\x20===>\x20','xsUxL':function(_0x2b451e,_0x49b5e7){return _0x2b451e!==_0x49b5e7;},'BljJB':_0x19bee0(0x2c8),'vkriM':_0x19bee0(0x2dc)},{docId:_0x37163d}=_0x1b55d2[_0x19bee0(0x2a4)],_0x424e40=await $['getSessionData'](_0x1b55d2);await m['getMainDocPathObj'](_0x1b55d2,_0x105ddf,_0x424e40[_0x19bee0(0x1c9)]);const {collectionName:_0x220498}=m['get_Info_ByPath'](_0x1b55d2['path']),_0x4f32fb=new _0x3d8ee0(global[_0x19bee0(0x213)]);try{if(_0x1cef39[_0x19bee0(0x1d1)](_0x1cef39[_0x19bee0(0x183)],_0x1cef39[_0x19bee0(0x1d0)])){await _0x4f32fb['connect']();var _0x99f245=await _0x4f32fb['db'](global['dbName'])[_0x19bee0(0x175)](_0x220498)['findOne']({'docId':_0x37163d});if(!_0x99f245)return _0x105ddf[_0x19bee0(0x2f2)](JSON[_0x19bee0(0x1b8)]({'isPrint':!0x1,'class':_0x1cef39[_0x19bee0(0x244)],'msg':_0x19bee0(0x1da)+_0x37163d+'\x22'}));const _0x100dae=_0x99f245[_0x19bee0(0x2a3)]||[];if(_0x1cef39['FoBXh'](_0x100dae['length'],0x1))return _0x105ddf[_0x19bee0(0x2f2)](JSON['stringify']({'isPrint':!0x1,'class':_0x1cef39['sdCda'],'msg':_0x1cef39[_0x19bee0(0x1fc)]}));const _0x27f563=_0x1320ba[_0x19bee0(0x258)](folderForms,_0x1cef39[_0x19bee0(0x22e)]),_0x52faf9=await C[_0x19bee0(0x29a)](_0x27f563,_0x105ddf,{'title':_0x19bee0(0x255)+_0x99f245[_0x19bee0(0x1de)],'time':E['getDateTime'](),'changesHistory':_0x100dae});_0x105ddf['send'](JSON['stringify']({'isPrint':!0x0,'class':_0x1cef39[_0x19bee0(0x232)],'htmlPage':_0x52faf9}));}else return function(_0x370c54){}[_0x19bee0(0x18e)](waAXaA['RifSB'])['apply'](waAXaA['WcxOu']);}catch(_0x14acc4){_0x1cef39[_0x19bee0(0x252)](_0x1cef39['zJuCe'],_0x1cef39['bxmSa'])?_0x5c2b3c['close']():(console[_0x19bee0(0x1b9)](_0x1cef39['BVQvb'],_0x14acc4),_0x105ddf[_0x19bee0(0x2f2)](JSON[_0x19bee0(0x1b8)]({'isPrint':!0x1,'class':_0x1cef39[_0x19bee0(0x244)],'msg':_0x14acc4['message']})));}finally{if(_0x1cef39[_0x19bee0(0x206)](_0x1cef39[_0x19bee0(0x2bd)],_0x1cef39[_0x19bee0(0x181)]))_0x4f32fb[_0x19bee0(0x1d7)]();else return _0x14be3a['log'](_0xad9120),_0x20860c['send'](_0x429312[_0x19bee0(0x1b8)]({'isSearch':!0x1,'class':_0x1cef39[_0x19bee0(0x244)],'msg':_0x19f28b['message']}));}}),y[_0x51821f(0x264)](L,_0x560e94[_0x51821f(0x226)],async(_0x3a6674,_0x28d839)=>{const _0x55c32c=_0x51821f,_0x5ac604={'dZSrT':function(_0x430cba,_0x172a58){return _0x430cba!==_0x172a58;},'HWPVG':_0x55c32c(0x2b2),'WhUKL':function(_0x18e242,_0x57fad6){return _0x18e242+_0x57fad6;},'fQwZW':_0x55c32c(0x2ff),'wcTZo':_0x55c32c(0x256),'nmApz':_0x55c32c(0x172),'NXJHT':function(_0x3a9ad1,_0x52a7c3){return _0x3a9ad1!==_0x52a7c3;},'RGBSr':_0x55c32c(0x26f),'hDsnA':_0x55c32c(0x1e3),'QVNZK':_0x55c32c(0x249),'WFebr':function(_0x18584c,_0x4d1581){return _0x18584c==_0x4d1581;},'fvMww':_0x55c32c(0x17d),'Imbjd':_0x55c32c(0x1d9),'JUxVy':function(_0x3f9a3d,_0x1a1db4){return _0x3f9a3d==_0x1a1db4;},'INoPa':_0x55c32c(0x2b0),'jaRJA':function(_0x102912,_0x5aa71c){return _0x102912!==_0x5aa71c;},'gvloC':_0x55c32c(0x1e4),'LeuIE':_0x55c32c(0x286),'szIiI':_0x55c32c(0x2da),'KaKel':_0x55c32c(0x2f8),'XcyQc':function(_0x423c85,_0x500034){return _0x423c85*_0x500034;},'fzcfS':function(_0x3ea363,_0x53ff7a){return _0x3ea363/_0x53ff7a;},'RlVOn':'jpeg','nrHDZ':_0x55c32c(0x27c),'JXMWB':function(_0x15fc4f,_0x30bdd8){return _0x15fc4f!==_0x30bdd8;},'WhrCn':_0x55c32c(0x21f),'pxOUR':_0x55c32c(0x2a1),'wkgud':_0x55c32c(0x2ab),'MfTMb':function(_0x3ba3cf,_0x262b76){return _0x3ba3cf===_0x262b76;},'XRITD':_0x55c32c(0x285)},{docId:_0x3d9829,action:_0x24889d}=_0x3a6674[_0x55c32c(0x2a4)],_0x392740=await $['getSessionData'](_0x3a6674);await m[_0x55c32c(0x188)](_0x3a6674,_0x28d839,_0x392740['userAuthority']);const {collectionName:_0x5957f7,docTitle:_0x665e48,docType:_0x330df5}=m[_0x55c32c(0x225)](_0x3a6674[_0x55c32c(0x1f0)]),_0x3ec5a0=new _0x3d8ee0(global[_0x55c32c(0x213)]);try{if(_0x5ac604[_0x55c32c(0x1d2)](_0x5ac604[_0x55c32c(0x1b1)],_0x5ac604[_0x55c32c(0x1b1)]))_0x27a97a[_0x55c32c(0x1d7)]();else{await _0x3ec5a0[_0x55c32c(0x282)]();var _0x1b1a6d=await _0x3ec5a0['db'](global[_0x55c32c(0x235)])['collection'](_0x5957f7)[_0x55c32c(0x189)]({'docId':_0x3d9829});if(!_0x1b1a6d)return _0x28d839[_0x55c32c(0x2f2)](JSON[_0x55c32c(0x1b8)]({'isLoad':!0x1,'class':_0x5ac604[_0x55c32c(0x246)],'msg':_0x55c32c(0x1da)+_0x3d9829+'\x22'}));_0x1b1a6d['docTitle']=_0x665e48,_0x1b1a6d[_0x55c32c(0x283)]=u[_0x55c32c(0x271)](_0x1b1a6d[_0x55c32c(0x1e8)]);const _0x304cf8=u['convert_DocPrint'](_0x1b1a6d);_0x304cf8['paymentMethod1']&&(_0x304cf8[_0x55c32c(0x2a2)]=global[_0x55c32c(0x2ed)][_0x55c32c(0x2a8)](_0x54c7cd=>_0x54c7cd[_0x55c32c(0x242)]==_0x304cf8[_0x55c32c(0x2cc)])?.[_0x55c32c(0x1a7)]||''),_0x304cf8[_0x55c32c(0x29b)]&&(_0x304cf8[_0x55c32c(0x204)]=global['PAY_TYPE'][_0x55c32c(0x2a8)](_0x2c21bd=>_0x2c21bd[_0x55c32c(0x242)]==_0x304cf8[_0x55c32c(0x29b)])?.['payTypeThai']||'');const _0x1f5d65=_0x1320ba[_0x55c32c(0x258)](global[_0x55c32c(0x237)],_0x5ac604['QVNZK']),_0x2aaf76=await C['renderView'](_0x1f5d65,_0x28d839,{'title':_0x3d9829,'time':E[_0x55c32c(0x16d)](0x0),'action':_0x24889d,'docType':_0x330df5,'doc':_0x304cf8,'settings':await C[_0x55c32c(0x1fb)]()});if(_0x5ac604[_0x55c32c(0x1b0)](_0x24889d,_0x5ac604['fvMww']))_0x28d839[_0x55c32c(0x2f2)](JSON[_0x55c32c(0x1b8)]({'isPrint':!0x0,'class':_0x5ac604[_0x55c32c(0x289)],'htmlPage':_0x2aaf76}));else{if(_0x5ac604[_0x55c32c(0x22d)](_0x24889d,_0x5ac604[_0x55c32c(0x1db)])){if(_0x5ac604['jaRJA'](_0x5ac604[_0x55c32c(0x1ea)],_0x5ac604[_0x55c32c(0x196)])){const _0x18d53e=await(await import(_0x5ac604[_0x55c32c(0x1be)]))['launch'](),_0x36dbba=await _0x18d53e[_0x55c32c(0x191)]();await _0x36dbba['setContent'](_0x2aaf76,{'waitUntil':_0x5ac604['KaKel'],'timeout':0x2710}),await new Promise(_0x13639c=>setTimeout(_0x13639c,0x3e8));const _0x484fb0=Math['floor'](_0x5ac604[_0x55c32c(0x19d)](_0x5ac604[_0x55c32c(0x1b6)](0x50,25.4),0x60));await _0x36dbba['setViewport']({'width':_0x484fb0,'height':0x258,'deviceScaleFactor':0x1});const _0x37131b=await _0x36dbba['evaluate'](()=>{const _0x35ec28=_0x55c32c;if(_0x5ac604[_0x35ec28(0x2f1)](_0x5ac604[_0x35ec28(0x16e)],_0x5ac604[_0x35ec28(0x16e)]))_0x1bbaca['close']();else{const _0x393e88=document[_0x35ec28(0x2a4)],_0x3338e9=document['documentElement'];return Math[_0x35ec28(0x2c3)](_0x393e88[_0x35ec28(0x23f)],_0x393e88['offsetHeight'],_0x3338e9['clientHeight'],_0x3338e9[_0x35ec28(0x23f)],_0x3338e9['offsetHeight']);}}),_0x3bce12=await _0x36dbba[_0x55c32c(0x277)]({'type':_0x5ac604[_0x55c32c(0x184)],'clip':{'x':0x0,'y':0x0,'width':_0x484fb0,'height':_0x37131b},'omitBackground':!0x1});await _0x18d53e[_0x55c32c(0x1d7)]();const _0x462410=_0x1b1a6d['docId'][_0x55c32c(0x2d1)](/\//g,'');_0x28d839[_0x55c32c(0x2b9)](0xc8,{'Content-Type':_0x5ac604[_0x55c32c(0x270)],'Content-Disposition':_0x55c32c(0x216)+_0x462410+_0x55c32c(0x178),'Content-Length':_0x3bce12[_0x55c32c(0x2c1)]}),_0x28d839[_0x55c32c(0x176)](_0x3bce12);}else{const _0x3e6867=_0x4b1a18[_0x55c32c(0x1d5)](_0x499b41,arguments);return _0x3cf462=null,_0x3e6867;}}}}}catch(_0x923c2b){if(_0x5ac604[_0x55c32c(0x23c)](_0x5ac604['WhrCn'],_0x5ac604[_0x55c32c(0x275)]))console[_0x55c32c(0x1b9)](_0x5ac604[_0x55c32c(0x2e3)],_0x923c2b),_0x28d839[_0x55c32c(0x2f2)](JSON['stringify']({'isPrint':!0x1,'class':_0x5ac604['hDsnA'],'msg':_0x923c2b[_0x55c32c(0x292)]}));else{const _0x182ca2=_0x554d05?function(){const _0x532bd1=_0x55c32c;if(_0x5e281a){const _0x1fbda9=_0x98b1bd[_0x532bd1(0x1d5)](_0x3285fe,arguments);return _0x5d644e=null,_0x1fbda9;}}:function(){};return _0x3ee86d=![],_0x182ca2;}}finally{_0x5ac604[_0x55c32c(0x236)](_0x5ac604[_0x55c32c(0x2d8)],_0x5ac604[_0x55c32c(0x2d8)])?_0x3ec5a0[_0x55c32c(0x1d7)]():function(){return!![];}[_0x55c32c(0x18e)](mhUFKi[_0x55c32c(0x297)](mhUFKi[_0x55c32c(0x2e5)],mhUFKi[_0x55c32c(0x1ad)]))['call'](mhUFKi[_0x55c32c(0x29e)]);}}),y[_0x51821f(0x264)](B,_0x560e94[_0x51821f(0x226)],async(_0x35f5ec,_0x91a441)=>{const _0x267fcf=_0x51821f,_0x14b83a={'sPbTn':_0x267fcf(0x1c0),'gpIbs':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','xnqnb':function(_0x2ce372,_0xcca4e8){return _0x2ce372(_0xcca4e8);},'jeRic':_0x267fcf(0x1b7),'dzKox':function(_0x3a3863,_0x349ba4){return _0x3a3863+_0x349ba4;},'qJYaQ':_0x267fcf(0x25d),'QyeVX':_0x267fcf(0x24c),'eonLG':function(_0x929602){return _0x929602();},'cbDUC':'error\x20===>\x20','eWTNu':'red','WJEWH':function(_0x481f41,_0x140edf){return _0x481f41==_0x140edf;},'NYRLE':_0x267fcf(0x2de),'GzbYG':_0x267fcf(0x19f),'SqAOs':function(_0x178715,_0x1246e9){return _0x178715==_0x1246e9;},'qpRqy':_0x267fcf(0x2d5),'FoXyO':'เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','lfPaK':function(_0x13527c,_0x31fc0f){return _0x13527c===_0x31fc0f;},'YSKmg':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','ypaIP':function(_0x2abc6b,_0x1790d6){return _0x2abc6b==_0x1790d6;},'DLmXg':_0x267fcf(0x2f7),'mAYsd':function(_0x34a94a,_0x234c58){return _0x34a94a!==_0x234c58;},'FQBzT':_0x267fcf(0x233),'JTYLB':function(_0x4b30fb,_0x1cb7ae){return _0x4b30fb==_0x1cb7ae;},'ThExu':function(_0x5289f3,_0xff33cd){return _0x5289f3==_0xff33cd;},'uUefg':function(_0x2ab565,_0x1d9cc4){return _0x2ab565>_0x1d9cc4;},'XDfXe':function(_0x5cec4f,_0x4214cb){return _0x5cec4f!==_0x4214cb;},'kbjcw':'XYMNz','OqeYI':'HSUkb','zQIOL':_0x267fcf(0x1ca),'porPL':_0x267fcf(0x1d9),'DfWlo':function(_0x1f12da,_0x4e30e7){return _0x1f12da<_0x4e30e7;},'LkaFc':_0x267fcf(0x2ea)},_0x4d15fa=new _0x3d8ee0(global[_0x267fcf(0x213)]);try{const _0x5b678c=await $['getSessionData'](_0x35f5ec);await m[_0x267fcf(0x188)](_0x35f5ec,_0x91a441,_0x5b678c['userAuthority']);const {collectionName:_0xb84e8e}=m[_0x267fcf(0x225)](_0x35f5ec[_0x267fcf(0x1f0)]),{docId:_0x2c9ecf,action:_0x172048}=_0x35f5ec[_0x267fcf(0x2a4)],_0x5f6725=_0x14b83a[_0x267fcf(0x239)](_0x172048,_0x14b83a[_0x267fcf(0x2fc)])?_0x14b83a[_0x267fcf(0x1bb)]:_0x14b83a['SqAOs'](_0x172048,_0x14b83a[_0x267fcf(0x1dd)])?'จบ':'';if(!_0x2c9ecf||![_0x14b83a[_0x267fcf(0x1dd)],_0x14b83a[_0x267fcf(0x2fc)]][_0x267fcf(0x2b5)](_0x172048))return _0x91a441[_0x267fcf(0x2f2)](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a[_0x267fcf(0x1a4)],'msg':_0x14b83a[_0x267fcf(0x2fe)]}));const _0x538585={'docId':_0x2c9ecf,'userId':_0x5b678c['userId']},_0x226d5b=_0x4d15fa['db'](global[_0x267fcf(0x235)])[_0x267fcf(0x175)](_0xb84e8e),_0x399ebc=await _0x226d5b[_0x267fcf(0x189)](_0x538585);if(!_0x399ebc)return _0x91a441[_0x267fcf(0x2f2)](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a[_0x267fcf(0x1a4)],'msg':_0x267fcf(0x261)+_0x2c9ecf+'{{sep}}หรือไม่มีสิทธิ์'+_0x5f6725+_0x267fcf(0x1e5)}));const _0x2e6d7e=_0x399ebc[_0x267fcf(0x1e8)];if(_0x14b83a['lfPaK'](_0x172048,_0x14b83a['NYRLE'])&&!(_0x14b83a[_0x267fcf(0x239)](_0x2e6d7e,0x1)||_0x14b83a[_0x267fcf(0x2d9)](_0x2e6d7e,0x2)))return _0x91a441[_0x267fcf(0x2f2)](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a['eWTNu'],'msg':_0x14b83a['YSKmg']}));if(_0x14b83a[_0x267fcf(0x1cc)](_0x172048,_0x14b83a[_0x267fcf(0x1dd)])&&_0x14b83a['ypaIP'](!_0x2e6d7e,0x1))return _0x91a441[_0x267fcf(0x2f2)](JSON['stringify']({'isStatus':!0x1,'class':_0x14b83a['eWTNu'],'msg':_0x14b83a[_0x267fcf(0x2df)]}));if(_0x14b83a['SqAOs'](_0x172048,_0x14b83a[_0x267fcf(0x2fc)])){if(_0x14b83a[_0x267fcf(0x16f)](_0x14b83a['FQBzT'],_0x14b83a[_0x267fcf(0x22b)])){const _0x194114=new _0x2f001f(UNyLGb[_0x267fcf(0x25f)]),_0x58d443=new _0x4437ee(UNyLGb[_0x267fcf(0x1a3)],'i'),_0x30c166=UNyLGb[_0x267fcf(0x259)](_0x2c1c09,UNyLGb[_0x267fcf(0x1bc)]);!_0x194114[_0x267fcf(0x2cf)](UNyLGb[_0x267fcf(0x17b)](_0x30c166,UNyLGb[_0x267fcf(0x192)]))||!_0x58d443[_0x267fcf(0x2cf)](UNyLGb['dzKox'](_0x30c166,UNyLGb[_0x267fcf(0x28f)]))?UNyLGb['xnqnb'](_0x30c166,'0'):UNyLGb[_0x267fcf(0x2b4)](_0x4cd99c);}else{if(_0x14b83a['JTYLB'](_0x399ebc['canCancel'],!0x1))return _0x91a441[_0x267fcf(0x2f2)](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a[_0x267fcf(0x1a4)],'msg':'เอกสาร\x20\x22'+_0x2c9ecf+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x14b83a['SqAOs']((await m[_0x267fcf(0x1d3)](_0x399ebc,_0xb84e8e,_0x5b678c[_0x267fcf(0x250)]))[_0x267fcf(0x17c)],!0x1))return _0x91a441[_0x267fcf(0x2f2)](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a['eWTNu'],'msg':'เอกสาร\x20\x22'+_0x2c9ecf+_0x267fcf(0x2b8)}));}}if(_0x14b83a[_0x267fcf(0x2d9)](_0x172048,_0x14b83a['NYRLE']))var _0x361396=0xa;else{if(_0x14b83a['ThExu'](_0x172048,_0x14b83a[_0x267fcf(0x1dd)]))var _0x361396=0x2;}const _0x3a5608=await _0x226d5b[_0x267fcf(0x18c)](_0x538585,{'$set':{'docStatusNumber':_0x361396}});var _0x4ed912=_0x5f6725+'\x20\x22'+_0x2c9ecf+_0x267fcf(0x1e6);if(_0x3a5608[_0x267fcf(0x16a)]||_0x14b83a[_0x267fcf(0x29f)](_0x3a5608[_0x267fcf(0x1c3)],0x0)){if(_0x14b83a[_0x267fcf(0x2e6)](_0x14b83a[_0x267fcf(0x253)],_0x14b83a[_0x267fcf(0x253)]))_0x45242d[_0x267fcf(0x1b9)](_0x14b83a[_0x267fcf(0x29c)],_0x23b9e7),_0x480fd0['send'](_0x8c65d6[_0x267fcf(0x1b8)]({'isPrint':!0x1,'class':_0x14b83a['eWTNu'],'msg':_0x3e3aed['message']}));else{const _0x2dd083=u[_0x267fcf(0x2dd)]({'docStatusNumber':_0x2e6d7e},{'docStatusNumber':_0x361396});if(_0x14b83a[_0x267fcf(0x29f)](_0x2dd083[_0x267fcf(0x2c1)],0x0)){if(_0x14b83a[_0x267fcf(0x16f)](_0x14b83a[_0x267fcf(0x1ff)],_0x14b83a[_0x267fcf(0x1ff)])){const _0x4dfa1f=_0x4df00e['body'],_0x140c42=_0x4a96c7[_0x267fcf(0x1ed)];return _0x35a0d9['max'](_0x4dfa1f[_0x267fcf(0x23f)],_0x4dfa1f['offsetHeight'],_0x140c42[_0x267fcf(0x2f6)],_0x140c42[_0x267fcf(0x23f)],_0x140c42[_0x267fcf(0x20c)]);}else{const _0x1f46ac={'dateTime':E['getDateTime'](),'userId':_0x5b678c[_0x267fcf(0x250)],'userFullname':_0x5b678c['userFullname'],'changes':_0x2dd083};await _0x226d5b[_0x267fcf(0x18c)]({'docId':_0x2c9ecf},{'$push':{'changesHistory':{'$each':[_0x1f46ac],'$position':0x0}}}),_0x4ed912+=_0x14b83a[_0x267fcf(0x2f5)];}}return _0x91a441['send'](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x0,'docId':_0x2c9ecf,'docStatusNumber':_0x361396,'class':_0x14b83a[_0x267fcf(0x26e)],'msg':_0x4ed912}));}}else{if(_0x3a5608['matchedCount']&&_0x14b83a[_0x267fcf(0x287)](_0x3a5608[_0x267fcf(0x1c3)],0x1))return _0x91a441['send'](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'docId':_0x2c9ecf,'docStatusNumber':_0x2e6d7e,'class':_0x14b83a[_0x267fcf(0x1d4)],'msg':'\x22'+_0x2c9ecf+_0x267fcf(0x229)}));}}catch(_0x3874cb){console[_0x267fcf(0x1b9)](_0x3874cb),_0x91a441['send'](JSON[_0x267fcf(0x1b8)]({'isStatus':!0x1,'class':_0x14b83a[_0x267fcf(0x1a4)],'msg':_0x3874cb['message']}));}finally{_0x4d15fa[_0x267fcf(0x1d7)]();}});function _0x3bf5(_0x4e4759,_0xfd70a5){const _0x274806=_0x1b06();return _0x3bf5=function(_0x3360e5,_0x3d756d){_0x3360e5=_0x3360e5-0x169;let _0x2d1531=_0x274806[_0x3360e5];return _0x2d1531;},_0x3bf5(_0x4e4759,_0xfd70a5);}export default y;function _0x5f7b67(_0x11d9f1){const _0x108f65=_0x51821f,_0xc30b4f={'RnPRM':function(_0xdfd037,_0x2f1e06){return _0xdfd037===_0x2f1e06;},'tYekJ':_0x108f65(0x27e),'FMMci':_0x108f65(0x26c),'PKThh':_0x108f65(0x22a),'QLpsr':function(_0x2f40c8,_0x56730f){return _0x2f40c8!==_0x56730f;},'olfJK':function(_0x5ee773,_0x291ac9){return _0x5ee773+_0x291ac9;},'cENdI':function(_0x437042,_0x145778){return _0x437042/_0x145778;},'iamqU':'length','QBLdu':function(_0x6d0539,_0x1ea14f){return _0x6d0539===_0x1ea14f;},'OkOCa':function(_0x591319,_0x48c1a1){return _0x591319%_0x48c1a1;},'hyxFt':_0x108f65(0x2ff),'PcLbm':_0x108f65(0x256),'pBUpH':'action','JlrKO':function(_0x58ebec,_0x4880ce){return _0x58ebec+_0x4880ce;},'RcZcy':_0x108f65(0x2fb),'ulgRT':function(_0x525bfd,_0x3e0326){return _0x525bfd(_0x3e0326);}};function _0x149134(_0x1bca4e){const _0x453f5c=_0x108f65;if(_0xc30b4f['RnPRM'](typeof _0x1bca4e,_0xc30b4f['tYekJ']))return function(_0xe63c21){}['constructor'](_0xc30b4f[_0x453f5c(0x2d7)])[_0x453f5c(0x1d5)](_0xc30b4f[_0x453f5c(0x2e8)]);else _0xc30b4f[_0x453f5c(0x248)](_0xc30b4f[_0x453f5c(0x25e)]('',_0xc30b4f[_0x453f5c(0x194)](_0x1bca4e,_0x1bca4e))[_0xc30b4f[_0x453f5c(0x268)]],0x1)||_0xc30b4f[_0x453f5c(0x211)](_0xc30b4f[_0x453f5c(0x2d0)](_0x1bca4e,0x14),0x0)?function(){return!![];}[_0x453f5c(0x18e)](_0xc30b4f['olfJK'](_0xc30b4f[_0x453f5c(0x2d4)],_0xc30b4f[_0x453f5c(0x1f6)]))['call'](_0xc30b4f[_0x453f5c(0x1e1)]):function(){return![];}[_0x453f5c(0x18e)](_0xc30b4f[_0x453f5c(0x190)](_0xc30b4f[_0x453f5c(0x2d4)],_0xc30b4f[_0x453f5c(0x1f6)]))['apply'](_0xc30b4f[_0x453f5c(0x1b2)]);_0xc30b4f[_0x453f5c(0x18f)](_0x149134,++_0x1bca4e);}try{if(_0x11d9f1)return _0x149134;else _0xc30b4f[_0x108f65(0x18f)](_0x149134,0x0);}catch(_0x5d1dfb){}}