const _0x254708=_0x48ea;function _0x18c5(){const _0x4f7464=['wNnbe','send','VLIbd','load-last','body','QhiRK','doc_changes.ejs','counter','fWlNU','kSwAH','aaqLz','jnElO','SOHeZ','vshXh','rLghj','CsIVU','../','gmcxx','GFwqg','post','dVuQP','COxvo','zXXoG','yellow','doc_print.ejs','FdKDR','docId','changesHistory','154904tkbLiT','qYSJY','stateObject','hWMaj','/load','acJZt','MnTIn','renderView','log','PErtq','puppeteer','OLvEa','GovLI','oRbDB','debu','/changes','DNgNi','rLGHe','171786pnLmxj','length','getMainDocPathObj','lVGNd','red','/fetch/modal','OPSXx','rnrAL','zJHiA','qAtvY','yteYp','WbOiv','IOXDr','IwKxi','return\x20(function()\x20','kETct','dateTimeEditRemain','while\x20(true)\x20{}','RYoLt','CahrG','.jpeg','nIpeo','string','HYmIu','yeqTT','LFzRA','ISqUZ','cLGeL','HHjSv','SnPLV','qfFhD','zUYXN','dKeDV','constructor','sFuNF','function\x20*\x5c(\x20*\x5c)','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','hiWfO','ไม่พบเอกสารเลขที่\x20\x22','aWztH','launch','BhhHd','QSdjn','BCfQp','opzsb','olQgp','NmOVV','table','pMSoz','stringify','jpeg','28SGhQuM','ZiFAc','oBvNk','SwlCV','cmuea','active','OPgru','connect','\x22\x20เรียบร้อยแล้ว','toArray','check_DocDateTime_CanEdit','getSettings','xcaCv','AfDTm','wRLPC','pnOmI','rYWSQ','eLQMp','QnYTk','XjgVk','JBjUg','HyQeb','userFullname','xdBRT','evaluate','rGaeT','stock','getDate','AGVor','Dtusl','bind','bbcyI','sXRoy','setContent','qpxps','srVxU','{}.constructor(\x22return\x20this\x22)(\x20)','Mdzms','qMZyF','WITSH','pBpSO','LmRpw','finish','jvFDC','fMOpE','ayxVb','JDDHM','userId','IPQub','cancel','wTlzd','lWPbg','aOoRh','aggregate','mhqai','kSCfV','PATH_SALES','AcdgH','680112htLqsu','statusName','get','message','SEOzh','buKPJ','RCPAG','warehouseIn','eZfhS','xTSZH','987210xQeVQR','branchId','38GmLZUX','hYZcJ','join','input','zMrkH','dateTimeCancelRemain','ยกเลิก','QpMSe','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','lOmIs','jwNib','ivSii','VNEFq','TXRZa','BpWtL','QVgVz','10VTkwWS','pJUJy','dbUrl','HJnNy','whpMc','{{sep}}[บันทึกการแก้ไข]','LqGbe','EwEtQ','apply','QGpit','JvkAl','cRVYu','matchedCount','get_Info_ByPath','rjFMk','QmTmr','collection','OMefM','UEmeJ','nfdpt','lnmdE','Uzniq','MtAph','40JHjOIP','1716319ieXNqB','setViewport','kvqxv','NKIxW','getDateTime','kpNFB','cDSlU','updateOne','MKNUP','userAuthority','dbName','xmGxl','trace','NVEkd','findOne','load','toString','เอกสารที่ตันเองไม่ได้สร้าง','dateTimeCanCancel','chain','MdkXE','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','RkBtg','lqtZH','path','MvVut','HGHfD','badAQ','pcJXE','getItemsCategory','uoTAF','rvKID','close','docTitle','getUserData','getItems_for_Modal','ySdBd','bqXpE','convert_DocPrint','NSukA','TGAtc','nbWrB','image','LJZru','wpQEA','SAWfr','izvEA','JSVAH','oosoX','PATH_WAREHOUSE_OUT','/myDateTime.js','action','docStatusNumber','/search','iZIHK','isAuth','push','HjGbH','OKXwQ','xkSzP','attachment;\x20filename=','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','cwPOT','console','newPage','cbeqi','writeHead','green','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','jkngN','bAOZi','โหลดเอกสารเลขที่\x20\x22','UtlHR','oXSdV','YzByi','end','HFxHM','Router','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','ZtJfi','/myUsers.js','image/jpeg','HptuR','includes','IMKMW','SGDgY','fqbgg','replace','{{sep}}หรือไม่มีสิทธิ์','error\x20===>\x20','xAgDC','HoZev','PATH_WAREHOUSE_IN','vDrIG','getUserBranchesById','dateTimeCanEdit','13180HiaddH','/myModule.js','exJLv','PDYdy','init','mtXvx','fxkac','NMadj','KBZBr','RclEB','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','sWPSf','mqAVG','เอกสาร\x20\x22','dZmSb','call','ไม่พบเอกสาร\x20\x22','DOC_TYPE','/myDocMain.js','branchName','cbYuC','/myData.js','scrollHeight','bdAlV','OvxwK','jubRJ','canEdit','LalZs','พบ\x20\x22','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','mmYhu','yOswC','bMbZT','BLjDf','ไม่พบเอกสารล่าสุด','test','print','nEPeS','modifiedCount','screenshot','olVTw','clientHeight','sales','\x22\x20เอกสาร','/print','ZCnyH','gger','hWJvf','/load-last','get_StatusName_byStatusNumber','info','3067695neeATZ','DKFqc','canCancel','cHmuz','PFApH','gvoAP','INAyh','ubQQw','offsetHeight','QyxcL','pXMav','qZmPl','__proto__','max','ISZVl','/status','OUAGm','\x20ไม่เปลี่ยนแปลง\x22','prototype','wZMzd'];_0x18c5=function(){return _0x4f7464;};return _0x18c5();}(function(_0x1743de,_0x1a4386){const _0x200ebd=_0x48ea,_0x2ced92=_0x1743de();while(!![]){try{const _0x3c8457=-parseInt(_0x200ebd(0x259))/0x1*(parseInt(_0x200ebd(0x1d1))/0x2)+parseInt(_0x200ebd(0x158))/0x3+-parseInt(_0x200ebd(0x146))/0x4*(parseInt(_0x200ebd(0x1e1))/0x5)+-parseInt(_0x200ebd(0x1cf))/0x6+-parseInt(_0x200ebd(0x18b))/0x7*(-parseInt(_0x200ebd(0x1c5))/0x8)+-parseInt(_0x200ebd(0x116))/0x9+-parseInt(_0x200ebd(0x1f8))/0xa*(-parseInt(_0x200ebd(0x1f9))/0xb);if(_0x3c8457===_0x1a4386)break;else _0x2ced92['push'](_0x2ced92['shift']());}catch(_0x1e433b){_0x2ced92['push'](_0x2ced92['shift']());}}}(_0x18c5,0x2df0c));const _0x171bbc=(function(){const _0x3807fc=_0x48ea,_0x91c68b={'dCyBq':_0x3807fc(0x15c),'HoZev':function(_0x36bba2,_0x1cf1f7){return _0x36bba2===_0x1cf1f7;},'jwNib':'IzgtC','NMadj':'wKksG','XAnxB':function(_0x5496b7,_0x1ca686){return _0x5496b7!==_0x1ca686;},'olQgp':_0x3807fc(0x256),'LXjNW':'JRkjJ','XHdVE':function(_0x18c80a,_0x40927d){return _0x18c80a===_0x40927d;},'HGHfD':_0x3807fc(0x25f),'pXMav':_0x3807fc(0x224)};let _0x15423f=!![];return function(_0x1bc4d6,_0x54a25a){const _0x4f1868=_0x3807fc,_0x32ca3c={'UeBJQ':_0x91c68b['dCyBq'],'cmuea':function(_0x6e42e2,_0x2ce62c){const _0x74b5e8=_0x48ea;return _0x91c68b[_0x74b5e8(0x254)](_0x6e42e2,_0x2ce62c);},'qAtvY':_0x91c68b[_0x4f1868(0x1db)],'xmGxl':_0x91c68b[_0x4f1868(0x260)],'opzsb':function(_0x313509,_0x4adaf0){return _0x91c68b['XAnxB'](_0x313509,_0x4adaf0);},'BnPla':_0x91c68b[_0x4f1868(0x185)],'JBjUg':_0x91c68b['LXjNW']};if(_0x91c68b['XHdVE'](_0x91c68b[_0x4f1868(0x213)],_0x91c68b[_0x4f1868(0x120)]))_0x3f0196[_0x4f1868(0x14e)](_0xdcc635),_0x42ad37[_0x4f1868(0x12b)](_0x46c402[_0x4f1868(0x189)]({'isStatus':!0x1,'class':_0x32ca3c['UeBJQ'],'msg':_0x468bc5['message']}));else{const _0x266673=_0x15423f?function(){const _0x1eeb97=_0x4f1868;if(_0x32ca3c[_0x1eeb97(0x18f)](_0x32ca3c[_0x1eeb97(0x161)],_0x32ca3c[_0x1eeb97(0x204)])){if(_0x1e098d){const _0x531725=_0x328701['apply'](_0x4d8320,arguments);return _0x269d97=null,_0x531725;}}else{if(_0x54a25a){if(_0x32ca3c[_0x1eeb97(0x184)](_0x32ca3c['BnPla'],_0x32ca3c[_0x1eeb97(0x19f)])){const _0x1af740=_0x54a25a['apply'](_0x1bc4d6,arguments);return _0x54a25a=null,_0x1af740;}else _0x26c174=_0x49d017;}}}:function(){};return _0x15423f=![],_0x266673;}};}());(function(){const _0x2cf465=_0x48ea,_0x24724={'sWPSf':'red','oTFdi':function(_0x5f401d,_0x6e8965){return _0x5f401d(_0x6e8965);},'aWztH':function(_0x5b0eb9,_0x1c37e2){return _0x5b0eb9+_0x1c37e2;},'OLvEa':function(_0x1534ba,_0x7e0827){return _0x1534ba+_0x7e0827;},'SQZBz':_0x2cf465(0x166),'wNnbe':_0x2cf465(0x1af),'cbYuC':function(_0x2dc53d,_0x30ea4c){return _0x2dc53d!==_0x30ea4c;},'PFApH':_0x2cf465(0xfb),'etDpH':_0x2cf465(0x17b),'XhVto':_0x2cf465(0x263),'PDYdy':function(_0x246af6,_0x3623b7){return _0x246af6(_0x3623b7);},'SGDgY':'init','vLggP':_0x2cf465(0x20c),'zJHiA':_0x2cf465(0x1d4),'NSukA':function(_0x1fe1e,_0x35d126){return _0x1fe1e!==_0x35d126;},'whpMc':_0x2cf465(0x147),'wwBgS':_0x2cf465(0x217),'exJLv':function(_0x11217f,_0x388306){return _0x11217f===_0x388306;},'COxvo':'GVGCM','JSVAH':function(_0x373202){return _0x373202();},'ubQQw':function(_0x491854,_0x42f315,_0x1a9173){return _0x491854(_0x42f315,_0x1a9173);}};_0x24724[_0x2cf465(0x11d)](_0x171bbc,this,function(){const _0x38ee1f=_0x2cf465;if(_0x24724[_0x38ee1f(0xf7)](_0x24724[_0x38ee1f(0x11a)],_0x24724[_0x38ee1f(0x11a)]))return _0x345780[_0x38ee1f(0x14e)](_0x4c61cb),_0x5c881a[_0x38ee1f(0x12b)](_0x42121f[_0x38ee1f(0x189)]({'isFetch':!0x1,'class':_0x24724[_0x38ee1f(0x264)],'msg':_0x2dcc14[_0x38ee1f(0x1c8)]}));else{const _0x313d22=new RegExp(_0x24724['etDpH']),_0x13e7ff=new RegExp(_0x24724['XhVto'],'i'),_0x2c24db=_0x24724['PDYdy'](_0x479be5,_0x24724[_0x38ee1f(0x24e)]);if(!_0x313d22[_0x38ee1f(0x106)](_0x24724[_0x38ee1f(0x151)](_0x2c24db,_0x24724['vLggP']))||!_0x13e7ff[_0x38ee1f(0x106)](_0x24724[_0x38ee1f(0x151)](_0x2c24db,_0x24724[_0x38ee1f(0x160)])))_0x24724[_0x38ee1f(0x220)](_0x24724[_0x38ee1f(0x1e5)],_0x24724['wwBgS'])?_0x24724[_0x38ee1f(0x25c)](_0x2c24db,'0'):_0x322d86=_0x24724['oTFdi'](_0x3c611f,_0x24724[_0x38ee1f(0x17f)](_0x24724[_0x38ee1f(0x151)](_0x24724['SQZBz'],_0x24724[_0x38ee1f(0x12a)]),');'))();else{if(_0x24724[_0x38ee1f(0x25b)](_0x24724[_0x38ee1f(0x13f)],_0x24724[_0x38ee1f(0x13f)]))_0x24724[_0x38ee1f(0x228)](_0x479be5);else{const _0x286c46=_0xe7bb7e['constructor'][_0x38ee1f(0x128)][_0x38ee1f(0x1a9)](_0x1f7f1f),_0x1292b8=_0x10120f[_0x1efcb1],_0xa53ed3=_0x103ae1[_0x1292b8]||_0x286c46;_0x286c46[_0x38ee1f(0x122)]=_0x4f8664[_0x38ee1f(0x1a9)](_0x24249c),_0x286c46[_0x38ee1f(0x209)]=_0xa53ed3[_0x38ee1f(0x209)][_0x38ee1f(0x1a9)](_0xa53ed3),_0x34bbaa[_0x1292b8]=_0x286c46;}}}})();}());const _0x44b904=(function(){const _0x255573=_0x48ea,_0x3ef841={'PnNRS':function(_0x20ef8e,_0x484ff9){return _0x20ef8e!==_0x484ff9;},'oosoX':_0x255573(0x19c),'SAWfr':function(_0x1ee69c,_0x550df1){return _0x1ee69c!==_0x550df1;},'kvqxv':_0x255573(0x108),'OVJuV':_0x255573(0x252),'jvFDC':_0x255573(0x15c),'WbOiv':function(_0x1244e2,_0x3c113e){return _0x1244e2===_0x3c113e;},'Rlftb':'chvLz','GovLI':_0x255573(0x212)};let _0x58ba9c=!![];return function(_0x5ee288,_0x251ddf){const _0x13d793=_0x255573,_0x3ee562={'hWMaj':_0x3ef841['OVJuV'],'AxvRw':_0x3ef841[_0x13d793(0x1b6)]};if(_0x3ef841[_0x13d793(0x163)](_0x3ef841['Rlftb'],_0x3ef841[_0x13d793(0x152)]))_0x4de93b['log'](_0x3ee562[_0x13d793(0x149)],_0x14363b),_0x48487f[_0x13d793(0x12b)](_0x163005[_0x13d793(0x189)]({'isPrint':!0x1,'class':_0x3ee562['AxvRw'],'msg':_0x1f7db7[_0x13d793(0x1c8)]}));else{const _0xa5aac5=_0x58ba9c?function(){const _0x10879a=_0x13d793;if(_0x3ef841['PnNRS'](_0x3ef841['oosoX'],_0x3ef841[_0x10879a(0x229)])){const _0x3aa4eb=_0x4c1475['body'],_0x3ec57b=_0x324738['documentElement'];return _0xdac7ee['max'](_0x3aa4eb[_0x10879a(0xf9)],_0x3aa4eb[_0x10879a(0x11e)],_0x3ec57b[_0x10879a(0x10c)],_0x3ec57b[_0x10879a(0xf9)],_0x3ec57b[_0x10879a(0x11e)]);}else{if(_0x251ddf){if(_0x3ef841[_0x10879a(0x226)](_0x3ef841[_0x10879a(0x1fb)],_0x3ef841[_0x10879a(0x1fb)])){const _0x4cdfb6=_0x37c91d[_0x10879a(0x1e9)](_0x501f77,arguments);return _0x46b857=null,_0x4cdfb6;}else{const _0x398ced=_0x251ddf[_0x10879a(0x1e9)](_0x5ee288,arguments);return _0x251ddf=null,_0x398ced;}}}}:function(){};return _0x58ba9c=![],_0xa5aac5;}};}()),_0x5c67c8=_0x44b904(this,function(){const _0x47ffed=_0x48ea,_0x3de852={'BhhHd':_0x47ffed(0x252),'OUAGm':_0x47ffed(0x15c),'bMbZT':function(_0x13cab7,_0x4c5244){return _0x13cab7!==_0x4c5244;},'qfFhD':_0x47ffed(0x19e),'XOvHD':_0x47ffed(0x17a),'cbeqi':_0x47ffed(0x248),'ISZVl':function(_0x523169,_0x1dd538){return _0x523169(_0x1dd538);},'veEzi':function(_0x175414,_0x471d50){return _0x175414+_0x471d50;},'eAmmf':function(_0x4e8279,_0x10fe14){return _0x4e8279+_0x10fe14;},'MnTIn':_0x47ffed(0x166),'cLGeL':_0x47ffed(0x1af),'olVTw':_0x47ffed(0x19d),'pBpSO':function(_0x5f560c,_0x3e0cae){return _0x5f560c(_0x3e0cae);},'QVgVz':function(_0x6faab6,_0x3a9bfe){return _0x6faab6+_0x3a9bfe;},'XvoRf':function(_0x5de2f0){return _0x5de2f0();},'cezad':_0x47ffed(0x14e),'KBZBr':'warn','xTSZH':_0x47ffed(0x115),'IAQLR':'error','xkSzP':'exception','sXRoy':_0x47ffed(0x187),'lqtZH':_0x47ffed(0x205),'mtXvx':function(_0x2fd375,_0x453ac0){return _0x2fd375<_0x453ac0;},'kSCfV':function(_0x47b5a2,_0x3d5373){return _0x47b5a2===_0x3d5373;},'QGpit':_0x47ffed(0x15e)},_0x3e82f2=function(){const _0xfc6295=_0x47ffed,_0x39c8db={'MtAph':_0x3de852[_0xfc6295(0x126)]};if(_0x3de852[_0xfc6295(0x103)](_0x3de852[_0xfc6295(0x176)],_0x3de852[_0xfc6295(0x176)]))return _0x418e66[_0xfc6295(0x14e)](_0x5dcd4f),_0x220760[_0xfc6295(0x12b)](_0x4d2c12[_0xfc6295(0x189)]({'isLoad':!0x1,'class':_0x39c8db[_0xfc6295(0x1f7)],'msg':_0x107f2c[_0xfc6295(0x1c8)]}));else{let _0x22f5cd;try{if(_0x3de852[_0xfc6295(0x103)](_0x3de852['XOvHD'],_0x3de852[_0xfc6295(0x23a)]))_0x22f5cd=_0x3de852[_0xfc6295(0x124)](Function,_0x3de852['veEzi'](_0x3de852['eAmmf'](_0x3de852[_0xfc6295(0x14c)],_0x3de852[_0xfc6295(0x173)]),');'))();else{if(_0x441283){const _0x2e8070=_0x1675b0[_0xfc6295(0x1e9)](_0x16b9fe,arguments);return _0x358ccf=null,_0x2e8070;}}}catch(_0x4d16f4){_0x3de852[_0xfc6295(0x103)](_0x3de852[_0xfc6295(0x10b)],_0x3de852[_0xfc6295(0x10b)])?(_0x226c5a[_0xfc6295(0x14e)](_0x3de852[_0xfc6295(0x181)],_0x5bbdba),_0x2105e0[_0xfc6295(0x12b)](_0x3950a3[_0xfc6295(0x189)]({'isPrint':!0x1,'class':_0x3de852[_0xfc6295(0x126)],'msg':_0x4bb722['message']}))):_0x22f5cd=window;}return _0x22f5cd;}},_0x5010fa=_0x3de852['XvoRf'](_0x3e82f2),_0x2a8fc3=_0x5010fa[_0x47ffed(0x238)]=_0x5010fa[_0x47ffed(0x238)]||{},_0x3a6d8a=[_0x3de852['cezad'],_0x3de852[_0x47ffed(0x261)],_0x3de852[_0x47ffed(0x1ce)],_0x3de852['IAQLR'],_0x3de852[_0x47ffed(0x234)],_0x3de852[_0x47ffed(0x1ab)],_0x3de852[_0x47ffed(0x210)]];for(let _0x1c78f6=0x0;_0x3de852[_0x47ffed(0x25e)](_0x1c78f6,_0x3a6d8a[_0x47ffed(0x159)]);_0x1c78f6++){if(_0x3de852[_0x47ffed(0x1c2)](_0x3de852[_0x47ffed(0x1ea)],_0x3de852['QGpit'])){const _0x46d496=_0x44b904[_0x47ffed(0x179)][_0x47ffed(0x128)][_0x47ffed(0x1a9)](_0x44b904),_0x78613b=_0x3a6d8a[_0x1c78f6],_0x56d5a3=_0x2a8fc3[_0x78613b]||_0x46d496;_0x46d496[_0x47ffed(0x122)]=_0x44b904['bind'](_0x44b904),_0x46d496['toString']=_0x56d5a3[_0x47ffed(0x209)]['bind'](_0x56d5a3),_0x2a8fc3[_0x78613b]=_0x46d496;}else{let _0x584b23;try{_0x584b23=_0x3de852[_0x47ffed(0x1b3)](_0x18c63e,_0x3de852[_0x47ffed(0x1e0)](_0x3de852[_0x47ffed(0x1e0)](_0x3de852[_0x47ffed(0x14c)],_0x3de852['cLGeL']),');'))();}catch(_0x348737){_0x584b23=_0x53793d;}return _0x584b23;}}});_0x5c67c8();import _0x5f4634 from'express';const b=_0x5f4634[_0x254708(0x246)]();import _0xb3ce8d from'path';import{MongoClient as _0xdb57e9}from'mongodb';import _0x5b18cf from'../middleware/mainAuth.js';const P=await import('../'+mymoduleFolder+_0x254708(0x25a)),D=await import(_0x254708(0x13a)+mymoduleFolder+_0x254708(0x22b)),$=await import(_0x254708(0x13a)+mymoduleFolder+_0x254708(0x249)),_=await import(_0x254708(0x13a)+mymoduleFolder+_0x254708(0xf8)),u=await import(_0x254708(0x13a)+mymoduleFolder+_0x254708(0xf5)),w=global[_0x254708(0x255)],p=global[_0x254708(0x22a)],S=global[_0x254708(0x1c3)],M=[w+_0x254708(0x15d),p+_0x254708(0x15d),S+_0x254708(0x15d)],v=[w+_0x254708(0x155),p+'/changes',S+_0x254708(0x155)],k=[w+_0x254708(0x10f),p+_0x254708(0x10f),S+_0x254708(0x10f)],B=[w+_0x254708(0x125),p+_0x254708(0x125),S+_0x254708(0x125)],x=[w+'/search',p+_0x254708(0x22e),S+'/search'],L=[w+_0x254708(0x14a),p+_0x254708(0x14a),S+_0x254708(0x14a),w+_0x254708(0x113),p+_0x254708(0x113),S+_0x254708(0x113)];b[_0x254708(0x1c7)](M,_0x5b18cf[_0x254708(0x230)],async(_0x7ab15c,_0x3d34b4)=>{const _0x56c91b=_0x254708,_0x415230={'SnPLV':function(_0x46e6a2,_0x232d4c){return _0x46e6a2===_0x232d4c;},'lWPbg':_0x56c91b(0x21d),'rYWSQ':_0x56c91b(0x1bd),'IPQub':function(_0x2a5e95,_0xcd89ac){return _0x2a5e95==_0xcd89ac;},'vZFrs':_0x56c91b(0x1cc),'LFzRA':_0x56c91b(0x1a5),'CsIVU':'warehouseOut','vshXh':function(_0x3f677e,_0x14c60b){return _0x3f677e==_0x14c60b;},'lCJkt':_0x56c91b(0x10d),'JImdL':_0x56c91b(0x190),'lnmdE':_0x56c91b(0x23c),'nbWrB':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','QhiRK':function(_0x384e9b,_0x28751d){return _0x384e9b!==_0x28751d;},'BlskR':_0x56c91b(0x1ca),'BlZuV':_0x56c91b(0x110),'HdNrX':_0x56c91b(0x15c)},_0xe91c21=await $[_0x56c91b(0x21b)](_0x7ab15c),_0x5669bb=await u['getMainDocPathObj'](_0x7ab15c,_0x3d34b4,_0xe91c21[_0x56c91b(0x202)]);try{if(_0x415230[_0x56c91b(0x175)](_0x415230[_0x56c91b(0x1be)],_0x415230[_0x56c91b(0x19b)])){const _0x41e147=_0xe0f7cb[_0x56c91b(0x1e9)](_0xd92e33,arguments);return _0x25436a=null,_0x41e147;}else{if(_0x415230[_0x56c91b(0x1bb)](_0x5669bb[_0x56c91b(0xf4)],_0x415230['vZFrs']))var _0x347a37=_0x415230[_0x56c91b(0x171)];else{if(_0x415230[_0x56c91b(0x1bb)](_0x5669bb[_0x56c91b(0xf4)],_0x415230[_0x56c91b(0x139)]))var _0x347a37=_0x415230[_0x56c91b(0x171)];else{if(_0x415230[_0x56c91b(0x137)](_0x5669bb[_0x56c91b(0xf4)],_0x415230['lCJkt']))var _0x347a37=_0x415230['JImdL'];}}const _0x390cfb=await _[_0x56c91b(0x21c)](_0x347a37),_0x6ec57e=await _[_0x56c91b(0x216)]();return _0x3d34b4[_0x56c91b(0x12b)](JSON['stringify']({'DATA_ITEMS':_0x390cfb,'DATA_CATEGORY':_0x6ec57e,'isFetch':!0x0,'class':_0x415230[_0x56c91b(0x1f5)],'msg':_0x415230[_0x56c91b(0x222)]}));}}catch(_0x25b5cf){return _0x415230[_0x56c91b(0x12f)](_0x415230['BlskR'],_0x415230['BlZuV'])?(console[_0x56c91b(0x14e)](_0x25b5cf),_0x3d34b4['send'](JSON[_0x56c91b(0x189)]({'isFetch':!0x1,'class':_0x415230['HdNrX'],'msg':_0x25b5cf['message']}))):_0x3ab0c2;}}),b[_0x254708(0x13d)](x,_0x5b18cf[_0x254708(0x230)],async(_0x45a0b9,_0x357f6b)=>{const _0x494bed=_0x254708,_0x52c696={'fqbgg':function(_0x5a043b,_0x2746a2){return _0x5a043b+_0x2746a2;},'rnrAL':_0x494bed(0x154),'DNgNi':_0x494bed(0x111),'bqXpE':_0x494bed(0x22c),'kSwAH':function(_0x4ce4ba,_0xbf6799){return _0x4ce4ba<_0xbf6799;},'Uzniq':_0x494bed(0x141),'ehmBw':_0x494bed(0x20e),'cFooS':function(_0x410912,_0x581e57){return _0x410912===_0x581e57;},'dKeDV':_0x494bed(0x1b7),'BCfQp':_0x494bed(0x23d),'fwvot':'green','AfDTm':function(_0x37002d,_0x29f9dd){return _0x37002d===_0x29f9dd;},'JoCho':'yZMlF','RQpLX':_0x494bed(0x182),'gvoAP':_0x494bed(0x15c),'ZiFAc':_0x494bed(0x1c4)};let {sip:_0x28ad44}=_0x45a0b9[_0x494bed(0x12e)];if(!_0x28ad44&&_0x52c696[_0x494bed(0x133)](_0x28ad44[_0x494bed(0x159)],0x2))return _0x357f6b[_0x494bed(0x12b)](JSON[_0x494bed(0x189)]({'isSearch':!0x1,'class':_0x52c696[_0x494bed(0x1f6)],'msg':_0x52c696['ehmBw']}));_0x28ad44=_0x28ad44['replace'](/[!@#$%^&*<>]/g,'')??null;const _0x5bffba=await $[_0x494bed(0x21b)](_0x45a0b9);await u[_0x494bed(0x15a)](_0x45a0b9,_0x357f6b,_0x5bffba['userAuthority']);const {collectionName:_0xb14106}=u['get_Info_ByPath'](_0x45a0b9['path']),_0x570f58=new _0xdb57e9(global[_0x494bed(0x1e3)]);try{if(_0x52c696['cFooS'](_0x52c696[_0x494bed(0x178)],_0x52c696[_0x494bed(0x178)])){await _0x570f58[_0x494bed(0x192)]();const _0x10ed0c=_0x570f58['db'](global[_0x494bed(0x203)])[_0x494bed(0x1f1)](_0xb14106),_0x1322e5=[{'$or':[{'docId':{'$regex':_0x28ad44,'$options':'i'}},{'docDateTime':{'$regex':_0x28ad44,'$options':'i'}}]}];let _0x5b25bd='';['O','S'][_0x494bed(0x24c)](_0x5bffba['userAuthority'])||(_0x5b25bd+=_0x52c696[_0x494bed(0x183)],_0x1322e5[_0x494bed(0x231)]({'userId':_0x5bffba[_0x494bed(0x1ba)]}));const _0x112425=await _0x10ed0c[_0x494bed(0x1c0)]([{'$match':{'$and':_0x1322e5}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])[_0x494bed(0x194)]();return _0x5b25bd=_0x52c696[_0x494bed(0x24f)](_0x494bed(0xff)+_0x112425[_0x494bed(0x159)]+_0x494bed(0x10e),_0x5b25bd),_0x357f6b[_0x494bed(0x12b)](JSON[_0x494bed(0x189)]({'searchFound':_0x112425,'msg':_0x5b25bd,'isSearch':!0x0,'class':_0x52c696['fwvot']}));}else(function(){return!![];}[_0x494bed(0x179)](kVXcdr[_0x494bed(0x24f)](kVXcdr[_0x494bed(0x15f)],kVXcdr[_0x494bed(0x156)]))['call'](kVXcdr[_0x494bed(0x21e)]));}catch(_0x5c466f){if(_0x52c696[_0x494bed(0x198)](_0x52c696['JoCho'],_0x52c696['RQpLX']))_0x5e22a0[_0x494bed(0x219)]();else return console['log'](_0x5c466f),_0x357f6b[_0x494bed(0x12b)](JSON['stringify']({'isSearch':!0x1,'class':_0x52c696[_0x494bed(0x11b)],'msg':_0x5c466f[_0x494bed(0x1c8)]}));}finally{_0x52c696[_0x494bed(0x198)](_0x52c696['ZiFAc'],_0x52c696[_0x494bed(0x18c)])?_0x570f58[_0x494bed(0x219)]():_0xea7881[_0x494bed(0x219)]();}}),b['post'](L,_0x5b18cf[_0x254708(0x230)],async(_0x2d4692,_0x2647d5)=>{const _0x667ca5=_0x254708,_0x3351fd={'QmTmr':function(_0x572392,_0x2fe64f){return _0x572392(_0x2fe64f);},'MQKVh':function(_0x1aa298){return _0x1aa298();},'rvKID':function(_0x16a2fb,_0x3e1a2b){return _0x16a2fb===_0x3e1a2b;},'IOXDr':_0x667ca5(0x117),'gmBLE':function(_0x391482,_0x2c9673){return _0x391482===_0x2c9673;},'HptuR':_0x667ca5(0x208),'IMKMW':function(_0x3dd35d,_0x4c3f6e){return _0x3dd35d!==_0x4c3f6e;},'RCPAG':_0x667ca5(0x1b4),'XfPOu':_0x667ca5(0x12d),'gWOiT':_0x667ca5(0x105),'gmcxx':_0x667ca5(0x15c),'nIpeo':function(_0x2fc6bb,_0x20edfe){return _0x2fc6bb==_0x20edfe;},'azBom':function(_0x556eb9,_0x38b1b8){return _0x556eb9!==_0x38b1b8;},'OTmHK':'pgtlL','qpxps':_0x667ca5(0x165),'yOKzi':function(_0x31bf51,_0x577698){return _0x31bf51==_0x577698;},'DHgAy':_0x667ca5(0x247),'wDJiD':function(_0x2cb869,_0x313547){return _0x2cb869==_0x313547;},'RclEB':'xmNTx','zMrkH':_0x667ca5(0x121),'kpNFB':function(_0x364b37,_0x1e9e7a){return _0x364b37==_0x1e9e7a;},'AGVor':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','eZfhS':_0x667ca5(0x23c),'kHBRd':function(_0x1f07b2,_0x2c4ff9){return _0x1f07b2===_0x2c4ff9;},'CahrG':_0x667ca5(0xf1),'IQNJA':'WuXVH','yteYp':_0x667ca5(0x241)};let {docId:_0x1e1242,action:_0x5c3153}=_0x2d4692[_0x667ca5(0x12e)];const _0x259370=await $['getUserData'](_0x2d4692);await u[_0x667ca5(0x15a)](_0x2d4692,_0x2647d5,_0x259370[_0x667ca5(0x202)]);const {collectionName:_0x4e7ff0}=u['get_Info_ByPath'](_0x2d4692[_0x667ca5(0x211)]),_0x2a36d3=new _0xdb57e9(global[_0x667ca5(0x1e3)]);try{if(_0x3351fd[_0x667ca5(0x218)](_0x3351fd[_0x667ca5(0x164)],_0x3351fd[_0x667ca5(0x164)])){await _0x2a36d3[_0x667ca5(0x192)]();const _0x40f3c2=_0x2a36d3['db'](global[_0x667ca5(0x203)])[_0x667ca5(0x1f1)](_0x4e7ff0);if(_0x3351fd['gmBLE'](_0x5c3153,_0x3351fd[_0x667ca5(0x24b)])){if(_0x3351fd[_0x667ca5(0x24d)](_0x3351fd['RCPAG'],_0x3351fd[_0x667ca5(0x1cb)]))wKaQtZ[_0x667ca5(0x1f0)](_0x37c1be,'0');else{const _0x1beaea=['O','S'][_0x667ca5(0x24c)](_0x259370[_0x667ca5(0x202)])?{'docId':_0x1e1242}:{'docId':_0x1e1242,'userId':_0x259370[_0x667ca5(0x1ba)]};var _0x4fad01=await _0x40f3c2[_0x667ca5(0x207)](_0x1beaea,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x3351fd[_0x667ca5(0x218)](_0x5c3153,_0x3351fd['XfPOu']))var _0x4fad01=await _0x40f3c2[_0x667ca5(0x207)]({'userId':_0x259370['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x4017de=_0x4fad01?'':_0x3351fd['gmBLE'](_0x5c3153,_0x3351fd[_0x667ca5(0x24b)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x1e1242+'\x22':_0x3351fd['gWOiT'];if(!_0x4fad01)return _0x2647d5[_0x667ca5(0x12b)](JSON[_0x667ca5(0x189)]({'isLoad':!0x1,'class':_0x3351fd[_0x667ca5(0x13b)],'msg':_0x4017de}));let _0x116cfd=_0x667ca5(0x240)+_0x4fad01[_0x667ca5(0x144)]+'\x22\x20{{sep}}เรียบร้อยแล้ว';if(_0x3351fd[_0x667ca5(0x16d)](_0x4fad01[_0x667ca5(0x22d)],0x1)&&_0x4fad01[_0x667ca5(0x258)]){if(_0x3351fd['azBom'](_0x3351fd['OTmHK'],_0x3351fd[_0x667ca5(0x1ad)])){let _0x1b2add=await u[_0x667ca5(0x195)](_0x4fad01,_0x4e7ff0,_0x259370['userId']);_0x4fad01[_0x667ca5(0x168)]=_0x1b2add['dateTimeEditRemain'],_0x3351fd['yOKzi'](_0x1b2add[_0x667ca5(0xfd)],!0x1)&&(_0x4fad01[_0x667ca5(0x22d)]=_0x1b2add[_0x667ca5(0x22d)],_0x116cfd+=_0x3351fd['DHgAy']);}else wKaQtZ['MQKVh'](_0x2b1a6b);}else _0x4fad01[_0x667ca5(0x168)]='-';if((_0x3351fd[_0x667ca5(0x16d)](_0x4fad01[_0x667ca5(0x22d)],0x1)||_0x3351fd['wDJiD'](_0x4fad01['docStatusNumber'],0x2))&&_0x4fad01[_0x667ca5(0x20b)]){if(_0x3351fd[_0x667ca5(0x218)](_0x3351fd[_0x667ca5(0x262)],_0x3351fd[_0x667ca5(0x1d5)])){const _0x4ac153=_0x36f2d0?function(){const _0x34faf4=_0x667ca5;if(_0x2e9b18){const _0x5bf5dd=_0x3f4daa[_0x34faf4(0x1e9)](_0x5b3891,arguments);return _0x76a894=null,_0x5bf5dd;}}:function(){};return _0x5744d4=![],_0x4ac153;}else{const _0x10aa1b=await u['check_DocDateTime_CanCancel'](_0x4fad01,_0x4e7ff0,_0x259370[_0x667ca5(0x1ba)]);_0x4fad01[_0x667ca5(0x1d6)]=_0x10aa1b[_0x667ca5(0x1d6)],_0x3351fd[_0x667ca5(0x1fe)](_0x10aa1b['canCancel'],!0x1)&&(_0x116cfd+=_0x3351fd[_0x667ca5(0x1a7)]);}}else _0x4fad01[_0x667ca5(0x1d6)]='-';const {branchName:_0x3e5395}=await _[_0x667ca5(0x257)](_0x4fad01[_0x667ca5(0x1d0)]);return _0x4fad01[_0x667ca5(0xf6)]=_0x3e5395,_0x2647d5[_0x667ca5(0x12b)](JSON['stringify']({'doc':_0x4fad01,'isLoad':!0x0,'class':_0x3351fd[_0x667ca5(0x1cd)],'msg':_0x116cfd,'userId':_0x259370[_0x667ca5(0x1ba)],'userAuthority':_0x259370[_0x667ca5(0x202)]}));}else _0x5d8cf2[_0x667ca5(0x219)]();}catch(_0x23e144){if(_0x3351fd['kHBRd'](_0x3351fd[_0x667ca5(0x16b)],_0x3351fd['IQNJA']))_0x126118[_0x667ca5(0x219)]();else return console[_0x667ca5(0x14e)](_0x23e144),_0x2647d5['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x3351fd[_0x667ca5(0x13b)],'msg':_0x23e144[_0x667ca5(0x1c8)]}));}finally{if(_0x3351fd[_0x667ca5(0x24d)](_0x3351fd[_0x667ca5(0x162)],_0x3351fd[_0x667ca5(0x162)]))return![];else _0x2a36d3['close']();}}),b['post'](v,_0x5b18cf[_0x254708(0x230)],async(_0x357c43,_0x292965)=>{const _0x1c0cc6=_0x254708,_0x2b2247={'nfdpt':_0x1c0cc6(0x169),'srVxU':_0x1c0cc6(0x131),'bAOZi':function(_0x4c3f23,_0x5d4aea){return _0x4c3f23(_0x5d4aea);},'Mdzms':function(_0x25d89,_0x138c2e){return _0x25d89===_0x138c2e;},'badAQ':'HWLlp','kETct':_0x1c0cc6(0x1aa),'hYZcJ':_0x1c0cc6(0x15c),'wRLPC':function(_0x30e43e,_0x43e253){return _0x30e43e<_0x43e253;},'lVGNd':'yellow','aOoRh':'ไม่พบประวัติการเปลี่ยนแปลง','AiQdb':_0x1c0cc6(0x130),'xcaCv':_0x1c0cc6(0x23c),'MKNUP':_0x1c0cc6(0x1b8),'jubRJ':_0x1c0cc6(0x252),'cRVYu':function(_0x778163,_0x1d92fe){return _0x778163!==_0x1d92fe;},'VLIbd':_0x1c0cc6(0x191)},{docId:_0x1ed1fe}=_0x357c43['body'],_0x5eae4e=await $[_0x1c0cc6(0x21b)](_0x357c43);await u['getMainDocPathObj'](_0x357c43,_0x292965,_0x5eae4e['userAuthority']);const {collectionName:_0x1e8f8b}=u[_0x1c0cc6(0x1ee)](_0x357c43[_0x1c0cc6(0x211)]),_0x3b2d80=new _0xdb57e9(global[_0x1c0cc6(0x1e3)]);try{if(_0x2b2247[_0x1c0cc6(0x1b0)](_0x2b2247[_0x1c0cc6(0x214)],_0x2b2247[_0x1c0cc6(0x167)]))return function(_0x46c0f7){}[_0x1c0cc6(0x179)](HrESdl[_0x1c0cc6(0x1f4)])['apply'](HrESdl[_0x1c0cc6(0x1ae)]);else{await _0x3b2d80['connect']();var _0x2497f8=await _0x3b2d80['db'](global['dbName'])[_0x1c0cc6(0x1f1)](_0x1e8f8b)[_0x1c0cc6(0x207)]({'docId':_0x1ed1fe});if(!_0x2497f8)return _0x292965[_0x1c0cc6(0x12b)](JSON['stringify']({'isPrint':!0x1,'class':_0x2b2247[_0x1c0cc6(0x1d2)],'msg':_0x1c0cc6(0x17e)+_0x1ed1fe+'\x22'}));const _0x210008=_0x2497f8[_0x1c0cc6(0x145)]||[];if(_0x2b2247[_0x1c0cc6(0x199)](_0x210008[_0x1c0cc6(0x159)],0x1))return _0x292965[_0x1c0cc6(0x12b)](JSON[_0x1c0cc6(0x189)]({'isPrint':!0x1,'class':_0x2b2247[_0x1c0cc6(0x15b)],'msg':_0x2b2247[_0x1c0cc6(0x1bf)]}));const _0x3c05cd=_0xb3ce8d[_0x1c0cc6(0x1d3)](folderForms,_0x2b2247['AiQdb']),_0x13c2b6=await P['renderView'](_0x3c05cd,_0x292965,{'title':_0x2497f8[_0x1c0cc6(0x144)],'time':D[_0x1c0cc6(0x1fd)](),'changesHistory':_0x210008});_0x292965[_0x1c0cc6(0x12b)](JSON['stringify']({'isPrint':!0x0,'class':_0x2b2247[_0x1c0cc6(0x197)],'htmlPage':_0x13c2b6}));}}catch(_0x32392c){if(_0x2b2247[_0x1c0cc6(0x1b0)](_0x2b2247[_0x1c0cc6(0x201)],_0x2b2247[_0x1c0cc6(0x201)]))console['log'](_0x2b2247[_0x1c0cc6(0xfc)],_0x32392c),_0x292965['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x2b2247[_0x1c0cc6(0x1d2)],'msg':_0x32392c['message']}));else{if(_0x1f00ec)return _0x4670b7;else HrESdl[_0x1c0cc6(0x23f)](_0x33270c,0x0);}}finally{if(_0x2b2247[_0x1c0cc6(0x1ec)](_0x2b2247[_0x1c0cc6(0x12c)],_0x2b2247[_0x1c0cc6(0x12c)]))return!![];else _0x3b2d80[_0x1c0cc6(0x219)]();}}),b[_0x254708(0x13d)](k,_0x5b18cf[_0x254708(0x230)],async(_0xb6921f,_0x4d9f7d)=>{const _0x41315b=_0x254708,_0xe9bd0e={'mqAVG':function(_0x46605a,_0x3c7f23){return _0x46605a+_0x3c7f23;},'oRbDB':'debu','zXXoG':_0x41315b(0x111),'nLCbs':_0x41315b(0x148),'QpMSe':function(_0x124ed7,_0x54058f){return _0x124ed7!==_0x54058f;},'xxdss':_0x41315b(0x206),'Dtusl':'DdiHf','ivSii':'function\x20*\x5c(\x20*\x5c)','PErtq':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','LqGbe':function(_0x1bb275,_0x3b62d3){return _0x1bb275(_0x3b62d3);},'rLGHe':_0x41315b(0x25d),'izvEA':_0x41315b(0x20c),'iZIHK':function(_0x3b8856,_0x237815){return _0x3b8856+_0x237815;},'rjFMk':_0x41315b(0x1d4),'oXSdV':function(_0x4ca995){return _0x4ca995();},'cDSlU':function(_0x4017ff,_0x3126ac){return _0x4017ff(_0x3126ac);},'ISqUZ':function(_0xb2d51d){return _0xb2d51d();},'HjGbH':function(_0x596be3,_0x30d30a,_0x57a347){return _0x596be3(_0x30d30a,_0x57a347);},'WITSH':function(_0x2725ce,_0x4165e0){return _0x2725ce===_0x4165e0;},'INAyh':_0x41315b(0x237),'oBvNk':_0x41315b(0x15c),'FdKDR':_0x41315b(0x142),'cHmuz':function(_0x1c4487,_0x3d0c5c){return _0x1c4487==_0x3d0c5c;},'dVuQP':_0x41315b(0x107),'QyxcL':_0x41315b(0x23c),'OKXwQ':_0x41315b(0x223),'GFwqg':function(_0x37b91b,_0x556770){return _0x37b91b!==_0x556770;},'mmYhu':_0x41315b(0x135),'jkngN':_0x41315b(0x16f),'EwEtQ':_0x41315b(0x150),'RYoLt':'networkidle0','SwlCV':function(_0x179db6,_0x1a91ea){return _0x179db6*_0x1a91ea;},'JvkAl':function(_0x1d53a6,_0x366670){return _0x1d53a6/_0x366670;},'NTRuS':_0x41315b(0x18a),'rLghj':_0x41315b(0x24a),'yeqTT':function(_0x3644ff,_0x824ff3){return _0x3644ff===_0x824ff3;},'HFxHM':'EMNJS','wpQEA':_0x41315b(0x1e2),'woqRu':_0x41315b(0x252),'saPtr':_0x41315b(0x174),'MdkXE':'uqnxS'},{docId:_0x416a94,action:_0x292daa}=_0xb6921f['body'],_0x16656c=await $[_0x41315b(0x21b)](_0xb6921f);await u[_0x41315b(0x15a)](_0xb6921f,_0x4d9f7d,_0x16656c[_0x41315b(0x202)]);const {collectionName:_0x7ca94f,docTitle:_0xe58ddc}=u['get_Info_ByPath'](_0xb6921f['path']),_0x456370=new _0xdb57e9(global[_0x41315b(0x1e3)]);try{if(_0xe9bd0e[_0x41315b(0x1b2)](_0xe9bd0e[_0x41315b(0x11c)],_0xe9bd0e['INAyh'])){await _0x456370[_0x41315b(0x192)]();var _0x2f0983=await _0x456370['db'](global[_0x41315b(0x203)])['collection'](_0x7ca94f)[_0x41315b(0x207)]({'docId':_0x416a94});if(!_0x2f0983)return _0x4d9f7d['send'](JSON['stringify']({'isLoad':!0x1,'class':_0xe9bd0e['oBvNk'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x416a94+'\x22'}));_0x2f0983[_0x41315b(0x21a)]=_0xe58ddc,_0x2f0983[_0x41315b(0x1c6)]=_[_0x41315b(0x114)](_0x2f0983[_0x41315b(0x22d)]);const _0x480a8f=_[_0x41315b(0x21f)](_0x2f0983),_0x3e7d4a=_0xb3ce8d[_0x41315b(0x1d3)](folderForms,_0xe9bd0e[_0x41315b(0x143)]),_0x294224=await P[_0x41315b(0x14d)](_0x3e7d4a,_0x4d9f7d,{'title':_0x416a94,'time':D[_0x41315b(0x1a6)](0x0),'action':_0x292daa,'doc':_0x480a8f,...await P[_0x41315b(0x196)]()});if(_0xe9bd0e[_0x41315b(0x119)](_0x292daa,_0xe9bd0e[_0x41315b(0x13e)]))_0x4d9f7d[_0x41315b(0x12b)](JSON[_0x41315b(0x189)]({'isPrint':!0x0,'class':_0xe9bd0e[_0x41315b(0x11f)],'htmlPage':_0x294224}));else{if(_0xe9bd0e[_0x41315b(0x119)](_0x292daa,_0xe9bd0e[_0x41315b(0x233)])){if(_0xe9bd0e[_0x41315b(0x13c)](_0xe9bd0e[_0x41315b(0x101)],_0xe9bd0e[_0x41315b(0x23e)])){const _0x4bc899=await(await import(_0xe9bd0e[_0x41315b(0x1e8)]))[_0x41315b(0x180)](),_0x15da8a=await _0x4bc899[_0x41315b(0x239)]();await _0x15da8a[_0x41315b(0x1ac)](_0x294224,{'waitUntil':_0xe9bd0e[_0x41315b(0x16a)],'timeout':0x2710}),await new Promise(_0x5a9a44=>setTimeout(_0x5a9a44,0x3e8));const _0x2bdc50=Math['floor'](_0xe9bd0e[_0x41315b(0x18e)](_0xe9bd0e[_0x41315b(0x1eb)](0x50,25.4),0x60));await _0x15da8a[_0x41315b(0x1fa)]({'width':_0x2bdc50,'height':0x258,'deviceScaleFactor':0x1});const _0x114f53=await _0x15da8a[_0x41315b(0x1a3)](()=>{const _0x183ac5=_0x41315b;if(_0xe9bd0e[_0x183ac5(0x1d8)](_0xe9bd0e['xxdss'],_0xe9bd0e[_0x183ac5(0x1a8)])){const _0x494d25=document[_0x183ac5(0x12e)],_0x19a757=document['documentElement'];return Math[_0x183ac5(0x123)](_0x494d25[_0x183ac5(0xf9)],_0x494d25[_0x183ac5(0x11e)],_0x19a757[_0x183ac5(0x10c)],_0x19a757['scrollHeight'],_0x19a757['offsetHeight']);}else(function(){return![];}[_0x183ac5(0x179)](vpfxnk[_0x183ac5(0x265)](vpfxnk[_0x183ac5(0x153)],vpfxnk[_0x183ac5(0x140)]))[_0x183ac5(0x1e9)](vpfxnk['nLCbs']));}),_0x5699bd=await _0x15da8a[_0x41315b(0x10a)]({'type':_0xe9bd0e['NTRuS'],'clip':{'x':0x0,'y':0x0,'width':_0x2bdc50,'height':_0x114f53},'omitBackground':!0x1});await _0x4bc899['close']();const _0x2c249c=_0x2f0983[_0x41315b(0x144)][_0x41315b(0x250)](/\//g,'');_0x4d9f7d[_0x41315b(0x23b)](0xc8,{'Content-Type':_0xe9bd0e[_0x41315b(0x138)],'Content-Disposition':_0x41315b(0x235)+_0x2c249c+_0x41315b(0x16c),'Content-Length':_0x5699bd[_0x41315b(0x159)]}),_0x4d9f7d[_0x41315b(0x244)](_0x5699bd);}else{const _0xca8a61=new _0x51348e(vpfxnk[_0x41315b(0x1dc)]),_0x1dfdb7=new _0x4a84c6(vpfxnk['PErtq'],'i'),_0x2969ff=vpfxnk[_0x41315b(0x1e7)](_0x57108f,vpfxnk[_0x41315b(0x157)]);!_0xca8a61['test'](vpfxnk['mqAVG'](_0x2969ff,vpfxnk[_0x41315b(0x227)]))||!_0x1dfdb7['test'](vpfxnk[_0x41315b(0x22f)](_0x2969ff,vpfxnk[_0x41315b(0x1ef)]))?vpfxnk['LqGbe'](_0x2969ff,'0'):vpfxnk[_0x41315b(0x242)](_0x2d0394);}}}}else vpfxnk[_0x41315b(0x1e7)](_0x3c8395,0x0);}catch(_0x3fceff){if(_0xe9bd0e[_0x41315b(0x170)](_0xe9bd0e[_0x41315b(0x245)],_0xe9bd0e[_0x41315b(0x225)])){const _0x80e210=_0x2e4d48?function(){const _0x2815bc=_0x41315b;if(_0x55bcfe){const _0x13e413=_0x1fc542[_0x2815bc(0x1e9)](_0x167492,arguments);return _0x541d9b=null,_0x13e413;}}:function(){};return _0x19c04b=![],_0x80e210;}else console[_0x41315b(0x14e)](_0xe9bd0e['woqRu'],_0x3fceff),_0x4d9f7d[_0x41315b(0x12b)](JSON[_0x41315b(0x189)]({'isPrint':!0x1,'class':_0xe9bd0e[_0x41315b(0x18d)],'msg':_0x3fceff[_0x41315b(0x1c8)]}));}finally{_0xe9bd0e[_0x41315b(0x170)](_0xe9bd0e['saPtr'],_0xe9bd0e[_0x41315b(0x20d)])?vpfxnk[_0x41315b(0x232)](_0x56807c,this,function(){const _0x2783a2=_0x41315b,_0x450408=new _0x49a0ea(vpfxnk[_0x2783a2(0x1dc)]),_0x24ad9a=new _0x787aa2(vpfxnk[_0x2783a2(0x14f)],'i'),_0x543aa5=vpfxnk[_0x2783a2(0x1ff)](_0x20cbe0,vpfxnk[_0x2783a2(0x157)]);!_0x450408['test'](vpfxnk[_0x2783a2(0x265)](_0x543aa5,vpfxnk[_0x2783a2(0x227)]))||!_0x24ad9a[_0x2783a2(0x106)](vpfxnk[_0x2783a2(0x22f)](_0x543aa5,vpfxnk[_0x2783a2(0x1ef)]))?vpfxnk['cDSlU'](_0x543aa5,'0'):vpfxnk[_0x2783a2(0x172)](_0x2f02cd);})():_0x456370['close']();}}),b[_0x254708(0x13d)](B,_0x5b18cf[_0x254708(0x230)],async(_0x5dd43d,_0xecc2be)=>{const _0x32994c=_0x254708,_0x490691={'SEOzh':_0x32994c(0x15c),'xAgDC':function(_0x532cff,_0x35100b){return _0x532cff==_0x35100b;},'pcJXE':_0x32994c(0x1bc),'mhqai':_0x32994c(0x1d7),'rGaeT':_0x32994c(0x1b5),'TGAtc':_0x32994c(0x17c),'acJZt':function(_0x2d9667,_0x47c448){return _0x2d9667===_0x47c448;},'pnOmI':_0x32994c(0x1d9),'OMefM':function(_0x4c5d80,_0x7c7860){return _0x4c5d80===_0x7c7860;},'aaqLz':_0x32994c(0x100),'xdBRT':_0x32994c(0x188),'qMZyF':'omOBx','rpiLh':function(_0x3f9e08,_0x21c97c){return _0x3f9e08==_0x21c97c;},'zUYXN':function(_0x5c2579,_0x587e5f){return _0x5c2579==_0x587e5f;},'NKIxW':function(_0x2d19ef,_0x5d3af7){return _0x2d19ef==_0x5d3af7;},'hiWfO':function(_0x5ef682,_0x166119){return _0x5ef682>_0x166119;},'rMuQU':_0x32994c(0x1e4),'yOswC':_0x32994c(0x1f3),'hWJvf':_0x32994c(0x1e6),'ntHZA':'green','JDDHM':function(_0x1cc662,_0x2816b4){return _0x1cc662<_0x2816b4;},'NmOVV':_0x32994c(0x141)},_0x525872=new _0xdb57e9(global[_0x32994c(0x1e3)]);try{const _0x5c6d40=await $['getUserData'](_0x5dd43d);await u[_0x32994c(0x15a)](_0x5dd43d,_0xecc2be,_0x5c6d40[_0x32994c(0x202)]);const {collectionName:_0x167f2b}=u['get_Info_ByPath'](_0x5dd43d['path']),{docId:_0x5eb99f,action:_0x119e2c}=_0x5dd43d[_0x32994c(0x12e)],_0x947402=_0x490691[_0x32994c(0x253)](_0x119e2c,_0x490691[_0x32994c(0x215)])?_0x490691[_0x32994c(0x1c1)]:_0x490691[_0x32994c(0x253)](_0x119e2c,_0x490691[_0x32994c(0x1a4)])?'จบ':'';if(!_0x5eb99f||![_0x490691[_0x32994c(0x1a4)],_0x490691[_0x32994c(0x215)]]['includes'](_0x119e2c))return _0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x490691[_0x32994c(0x221)]}));const _0x4c42bd={'docId':_0x5eb99f,'userId':_0x5c6d40[_0x32994c(0x1ba)]},_0x36a178=_0x525872['db'](global['dbName'])[_0x32994c(0x1f1)](_0x167f2b),_0x10cdb5=await _0x36a178[_0x32994c(0x207)](_0x4c42bd);if(!_0x10cdb5)return _0xecc2be[_0x32994c(0x12b)](JSON['stringify']({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x32994c(0xf3)+_0x5eb99f+_0x32994c(0x251)+_0x947402+_0x32994c(0x20a)}));const _0x6f44c9=_0x10cdb5[_0x32994c(0x22d)];if(_0x490691[_0x32994c(0x14b)](_0x119e2c,_0x490691['pcJXE'])&&!(_0x490691['xAgDC'](_0x6f44c9,0x1)||_0x490691['xAgDC'](_0x6f44c9,0x2)))return _0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x490691[_0x32994c(0x19a)]}));if(_0x490691[_0x32994c(0x1f2)](_0x119e2c,_0x490691[_0x32994c(0x1a4)])&&_0x490691[_0x32994c(0x253)](!_0x6f44c9,0x1))return _0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x490691[_0x32994c(0x134)]}));if(_0x490691[_0x32994c(0x253)](_0x119e2c,_0x490691[_0x32994c(0x215)])){if(_0x490691[_0x32994c(0x14b)](_0x490691[_0x32994c(0x1a2)],_0x490691[_0x32994c(0x1b1)]))_0x412196['close']();else{if(_0x490691['rpiLh'](_0x10cdb5[_0x32994c(0x118)],!0x1))return _0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x32994c(0x266)+_0x5eb99f+_0x32994c(0x236)}));if(_0x490691[_0x32994c(0x177)]((await u['check_DocDateTime_CanCancel'](_0x10cdb5,_0x167f2b,_0x5c6d40[_0x32994c(0x1ba)]))[_0x32994c(0x118)],!0x1))return _0xecc2be['send'](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':'เอกสาร\x20\x22'+_0x5eb99f+_0x32994c(0x236)}));}}if(_0x490691[_0x32994c(0x1fc)](_0x119e2c,_0x490691['pcJXE']))var _0x22aa11=0xa;else{if(_0x490691[_0x32994c(0x253)](_0x119e2c,_0x490691[_0x32994c(0x1a4)]))var _0x22aa11=0x2;}const _0x4e183d=await _0x36a178[_0x32994c(0x200)](_0x4c42bd,{'$set':{'docStatusNumber':_0x22aa11}});var _0x4ce0f6=_0x947402+'\x20\x22'+_0x5eb99f+_0x32994c(0x193);if(_0x4e183d[_0x32994c(0x1ed)]||_0x490691[_0x32994c(0x17d)](_0x4e183d['modifiedCount'],0x0)){const _0x463a01=_['getChangeHistory']({'docStatusNumber':_0x6f44c9},{'docStatusNumber':_0x22aa11});if(_0x490691['hiWfO'](_0x463a01['length'],0x0)){if(_0x490691[_0x32994c(0x14b)](_0x490691['rMuQU'],_0x490691[_0x32994c(0x102)]))return _0xa85cd7[_0x32994c(0x14e)](_0x20128c),_0x8c53fd[_0x32994c(0x12b)](_0x481dfd['stringify']({'isSearch':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x2a607d['message']}));else{const _0x187499={'dateTime':D['getDateTime'](),'userId':_0x5c6d40['userId'],'userFullname':_0x5c6d40[_0x32994c(0x1a1)],'changes':_0x463a01};await _0x36a178[_0x32994c(0x200)]({'docId':_0x5eb99f},{'$push':{'changesHistory':{'$each':[_0x187499],'$position':0x0}}}),_0x4ce0f6+=_0x490691[_0x32994c(0x112)];}}return _0xecc2be[_0x32994c(0x12b)](JSON['stringify']({'isStatus':!0x0,'docId':_0x5eb99f,'docStatusNumber':_0x22aa11,'class':_0x490691['ntHZA'],'msg':_0x4ce0f6}));}else{if(_0x4e183d['matchedCount']&&_0x490691[_0x32994c(0x1b9)](_0x4e183d[_0x32994c(0x109)],0x1))return _0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'docId':_0x5eb99f,'docStatusNumber':_0x6f44c9,'class':_0x490691[_0x32994c(0x186)],'msg':'\x22'+_0x5eb99f+_0x32994c(0x127)}));}}catch(_0x563439){console[_0x32994c(0x14e)](_0x563439),_0xecc2be[_0x32994c(0x12b)](JSON[_0x32994c(0x189)]({'isStatus':!0x1,'class':_0x490691[_0x32994c(0x1c9)],'msg':_0x563439['message']}));}finally{_0x525872[_0x32994c(0x219)]();}});export default b;function _0x48ea(_0xb716b1,_0x1f2984){const _0x7f29f8=_0x18c5();return _0x48ea=function(_0x5c67c8,_0x44b904){_0x5c67c8=_0x5c67c8-0xf1;let _0x5b2c57=_0x7f29f8[_0x5c67c8];return _0x5b2c57;},_0x48ea(_0xb716b1,_0x1f2984);}function _0x479be5(_0x352557){const _0x200f3f=_0x254708,_0x1e6df9={'BLjDf':function(_0x360627,_0x3f204d){return _0x360627===_0x3f204d;},'VNEFq':_0x200f3f(0x16e),'TXRZa':_0x200f3f(0x169),'sffcX':'counter','LalZs':function(_0x5e7eea,_0x153023){return _0x5e7eea!==_0x153023;},'YzByi':function(_0x3ec76c,_0x313c83){return _0x3ec76c+_0x313c83;},'wZMzd':function(_0x1e5221,_0x20bd6e){return _0x1e5221/_0x20bd6e;},'BpWtL':'length','lOmIs':function(_0x17ebfe,_0x22608f){return _0x17ebfe%_0x22608f;},'bdAlV':_0x200f3f(0x154),'RkBtg':_0x200f3f(0x111),'fWlNU':_0x200f3f(0x22c),'PZUFl':function(_0x4c4d97,_0x321903){return _0x4c4d97+_0x321903;},'SOHeZ':_0x200f3f(0x148),'HyQeb':function(_0x3f955f,_0x3e62ef){return _0x3f955f(_0x3e62ef);}};function _0x4f820e(_0x38a0c9){const _0x4301a6=_0x200f3f;if(_0x1e6df9[_0x4301a6(0x104)](typeof _0x38a0c9,_0x1e6df9[_0x4301a6(0x1dd)]))return function(_0x50c9ed){}[_0x4301a6(0x179)](_0x1e6df9[_0x4301a6(0x1de)])[_0x4301a6(0x1e9)](_0x1e6df9['sffcX']);else _0x1e6df9[_0x4301a6(0xfe)](_0x1e6df9[_0x4301a6(0x243)]('',_0x1e6df9[_0x4301a6(0x129)](_0x38a0c9,_0x38a0c9))[_0x1e6df9[_0x4301a6(0x1df)]],0x1)||_0x1e6df9[_0x4301a6(0x104)](_0x1e6df9[_0x4301a6(0x1da)](_0x38a0c9,0x14),0x0)?function(){return!![];}[_0x4301a6(0x179)](_0x1e6df9['YzByi'](_0x1e6df9[_0x4301a6(0xfa)],_0x1e6df9[_0x4301a6(0x20f)]))[_0x4301a6(0xf2)](_0x1e6df9[_0x4301a6(0x132)]):function(){return![];}[_0x4301a6(0x179)](_0x1e6df9['PZUFl'](_0x1e6df9[_0x4301a6(0xfa)],_0x1e6df9['RkBtg']))[_0x4301a6(0x1e9)](_0x1e6df9[_0x4301a6(0x136)]);_0x1e6df9['HyQeb'](_0x4f820e,++_0x38a0c9);}try{if(_0x352557)return _0x4f820e;else _0x1e6df9[_0x200f3f(0x1a0)](_0x4f820e,0x0);}catch(_0x53ced9){}}