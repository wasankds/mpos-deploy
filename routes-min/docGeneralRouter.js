const _0x2172b5=_0x59d4;(function(_0x2db36a,_0xf112df){const _0x39e9f3=_0x59d4,_0xb75447=_0x2db36a();while(!![]){try{const _0x1e89ff=-parseInt(_0x39e9f3(0x35d))/0x1*(-parseInt(_0x39e9f3(0x227))/0x2)+parseInt(_0x39e9f3(0x311))/0x3*(parseInt(_0x39e9f3(0x31a))/0x4)+-parseInt(_0x39e9f3(0x2fd))/0x5*(-parseInt(_0x39e9f3(0x2dc))/0x6)+-parseInt(_0x39e9f3(0x1e7))/0x7+parseInt(_0x39e9f3(0x32f))/0x8*(parseInt(_0x39e9f3(0x2ad))/0x9)+parseInt(_0x39e9f3(0x300))/0xa*(parseInt(_0x39e9f3(0x2a2))/0xb)+-parseInt(_0x39e9f3(0x2d9))/0xc*(parseInt(_0x39e9f3(0x244))/0xd);if(_0x1e89ff===_0xf112df)break;else _0xb75447['push'](_0xb75447['shift']());}catch(_0x336bf4){_0xb75447['push'](_0xb75447['shift']());}}}(_0x5177,0x6a1d7));function _0x59d4(_0x3f4062,_0x375727){const _0x335ce4=_0x5177();return _0x59d4=function(_0xbca2c2,_0x45fb81){_0xbca2c2=_0xbca2c2-0x1d2;let _0x5383f7=_0x335ce4[_0xbca2c2];return _0x5383f7;},_0x59d4(_0x3f4062,_0x375727);}const _0x12a540=(function(){const _0x1c952f=_0x59d4,_0x58e400={'vGbID':_0x1c952f(0x200),'Zqeay':'error\x20===>\x20','SeJBe':function(_0x379683,_0x1ba413){return _0x379683===_0x1ba413;},'Jiyhg':'dRTHU','eGApb':_0x1c952f(0x266),'shpjb':function(_0x287575,_0x3cd34c){return _0x287575!==_0x3cd34c;},'HahSB':'fVumt','Gcdlj':'qQvOI','QfOyH':_0x1c952f(0x2e6)};let _0x2ba29f=!![];return function(_0x5be70b,_0x2579c4){const _0x3281f9=_0x1c952f,_0x386312={'uptDx':_0x58e400['vGbID'],'shclN':_0x58e400[_0x3281f9(0x30a)],'hYmUK':function(_0x47be2e,_0x4aacd1){return _0x58e400['SeJBe'](_0x47be2e,_0x4aacd1);},'DlGJA':_0x58e400[_0x3281f9(0x30c)],'sCCsQ':_0x58e400[_0x3281f9(0x331)],'xZWFk':function(_0x466cf2,_0x47c031){return _0x58e400['shpjb'](_0x466cf2,_0x47c031);},'zqTUT':_0x58e400[_0x3281f9(0x20c)],'nuuOR':_0x58e400[_0x3281f9(0x2cd)]};if(_0x58e400['SeJBe'](_0x58e400[_0x3281f9(0x29f)],_0x58e400[_0x3281f9(0x29f)])){const _0x226d7d=_0x2ba29f?function(){const _0x252253=_0x3281f9;if(_0x386312[_0x252253(0x271)](_0x386312[_0x252253(0x247)],_0x386312[_0x252253(0x1f9)]))return _0x30fa71[_0x252253(0x340)](_0x4cc48c),_0x3eb22c[_0x252253(0x1dc)](_0x40d714[_0x252253(0x20f)]({'isSearch':!0x1,'class':_0x386312[_0x252253(0x2d3)],'msg':_0x208f34[_0x252253(0x237)]}));else{if(_0x2579c4){if(_0x386312[_0x252253(0x249)](_0x386312[_0x252253(0x314)],_0x386312[_0x252253(0x21d)])){const _0x450bf7=_0x2579c4[_0x252253(0x2e1)](_0x5be70b,arguments);return _0x2579c4=null,_0x450bf7;}else _0x183243['log'](_0x386312[_0x252253(0x1fa)],_0x44e66b),_0x39f3a7[_0x252253(0x1dc)](_0x248c9d[_0x252253(0x20f)]({'isPrint':!0x1,'class':_0x386312['uptDx'],'msg':_0x1da5e4[_0x252253(0x237)]}));}}}:function(){};return _0x2ba29f=![],_0x226d7d;}else{if(_0x3a7e74){const _0x58cf12=_0x203022[_0x3281f9(0x2e1)](_0x466f95,arguments);return _0x58cc3a=null,_0x58cf12;}}};}());(function(){const _0x1c2b92=_0x59d4,_0x56cff0={'eSfEI':function(_0x47331d,_0x1faadc){return _0x47331d(_0x1faadc);},'Jgtsa':function(_0xfd2bf0,_0x1be34f){return _0xfd2bf0(_0x1be34f);},'UoEKO':function(_0x5b1d85,_0x2f5f97){return _0x5b1d85+_0x2f5f97;},'yKAYq':function(_0x17f603,_0x3c465a){return _0x17f603+_0x3c465a;},'ipLIu':'return\x20(function()\x20','erxsr':_0x1c2b92(0x321),'MggqZ':function(_0x141170,_0x166250){return _0x141170!==_0x166250;},'PmyQW':'QGrxs','NYkRC':_0x1c2b92(0x2bc),'cacNX':_0x1c2b92(0x2c6),'iKMVq':_0x1c2b92(0x336),'HihmW':function(_0x96f4f4,_0xebcb51){return _0x96f4f4(_0xebcb51);},'BxNwo':'init','FqYwA':'chain','aWjNj':function(_0x4c3641,_0x30ae48){return _0x4c3641+_0x30ae48;},'GdmFp':_0x1c2b92(0x2ec),'copBJ':function(_0x3fbad5,_0x21c2b3){return _0x3fbad5!==_0x21c2b3;},'FPGZR':_0x1c2b92(0x2c8),'JGcUu':function(_0x287839,_0x514aaf){return _0x287839(_0x514aaf);},'RHmUb':function(_0x10168d,_0x56dd6b){return _0x10168d===_0x56dd6b;},'UqsWh':_0x1c2b92(0x21c),'XZROS':'BBipb','eUHyv':function(_0x2fed57){return _0x2fed57();},'JgKcB':function(_0x25a960,_0x4778f0,_0x24a6c1){return _0x25a960(_0x4778f0,_0x24a6c1);}};_0x56cff0['JgKcB'](_0x12a540,this,function(){const _0x3307f7=_0x1c2b92,_0x56be7d={'XMoit':function(_0x26d42d,_0x9cddc9){const _0x4fd202=_0x59d4;return _0x56cff0[_0x4fd202(0x2f3)](_0x26d42d,_0x9cddc9);},'QjNfs':function(_0x433edf,_0x437ac2){const _0x32df20=_0x59d4;return _0x56cff0[_0x32df20(0x1eb)](_0x433edf,_0x437ac2);},'RZqyH':function(_0x16bdf3,_0x36b446){const _0x4cf89f=_0x59d4;return _0x56cff0[_0x4cf89f(0x309)](_0x16bdf3,_0x36b446);},'kMYVk':_0x56cff0[_0x3307f7(0x35b)],'IqWOT':_0x56cff0[_0x3307f7(0x23a)]};if(_0x56cff0[_0x3307f7(0x1ed)](_0x56cff0[_0x3307f7(0x2ca)],_0x56cff0[_0x3307f7(0x308)])){const _0x4ae1a8=new RegExp(_0x56cff0[_0x3307f7(0x254)]),_0x37a53d=new RegExp(_0x56cff0[_0x3307f7(0x2db)],'i'),_0x17ea0c=_0x56cff0[_0x3307f7(0x1ee)](_0x4754aa,_0x56cff0[_0x3307f7(0x335)]);!_0x4ae1a8[_0x3307f7(0x33c)](_0x56cff0[_0x3307f7(0x1eb)](_0x17ea0c,_0x56cff0['FqYwA']))||!_0x37a53d['test'](_0x56cff0[_0x3307f7(0x31e)](_0x17ea0c,_0x56cff0[_0x3307f7(0x2c5)]))?_0x56cff0[_0x3307f7(0x307)](_0x56cff0['FPGZR'],_0x56cff0[_0x3307f7(0x2b0)])?_0x56cff0[_0x3307f7(0x201)](_0x4d8fab,0x0):_0x56cff0[_0x3307f7(0x343)](_0x17ea0c,'0'):_0x56cff0[_0x3307f7(0x22d)](_0x56cff0['UqsWh'],_0x56cff0[_0x3307f7(0x280)])?_0x1078a2=_0x56be7d[_0x3307f7(0x1e8)](_0x92dc6a,_0x56be7d[_0x3307f7(0x334)](_0x56be7d[_0x3307f7(0x337)](_0x56be7d[_0x3307f7(0x35c)],_0x56be7d['IqWOT']),');'))():_0x56cff0[_0x3307f7(0x303)](_0x4754aa);}else _0x1961d7[_0x3307f7(0x22c)]();})();}());const _0x45fb81=(function(){const _0x4f053f=_0x59d4,_0x45be54={'lRhON':function(_0x1d5f0e){return _0x1d5f0e();},'QbWru':function(_0x4613c8,_0x2a8021){return _0x4613c8===_0x2a8021;},'PENrl':'cPtCY','zGotZ':'Cbzhu','fyEPF':function(_0x576c73,_0x502e27){return _0x576c73===_0x502e27;},'adSxZ':_0x4f053f(0x2d2),'syPMd':_0x4f053f(0x345)};let _0x56b4db=!![];return function(_0x2c7830,_0x3c00ca){const _0x4b99a1=_0x4f053f,_0x563c1d={'bNLXN':function(_0x1d111b){const _0x2a96d9=_0x59d4;return _0x45be54[_0x2a96d9(0x238)](_0x1d111b);},'tUalq':function(_0x4f030f,_0x3598f7){const _0x41e643=_0x59d4;return _0x45be54[_0x41e643(0x1fc)](_0x4f030f,_0x3598f7);},'TfrEG':_0x45be54['PENrl'],'QxyUi':_0x45be54[_0x4b99a1(0x24b)]};if(_0x45be54[_0x4b99a1(0x1f6)](_0x45be54['adSxZ'],_0x45be54[_0x4b99a1(0x31c)]))_0x15ccbb['close']();else{const _0x2f9b21=_0x56b4db?function(){const _0x125b3a=_0x4b99a1,_0x59dd78={'hePxM':function(_0x58c728){return _0x563c1d['bNLXN'](_0x58c728);}};if(_0x563c1d['tUalq'](_0x563c1d[_0x125b3a(0x285)],_0x563c1d[_0x125b3a(0x285)])){if(_0x3c00ca){if(_0x563c1d[_0x125b3a(0x28e)](_0x563c1d[_0x125b3a(0x245)],_0x563c1d[_0x125b3a(0x245)])){const _0x2ada9b=_0x3c00ca[_0x125b3a(0x2e1)](_0x2c7830,arguments);return _0x3c00ca=null,_0x2ada9b;}else{if(_0x397be9){const _0x20dc37=_0x567d25[_0x125b3a(0x2e1)](_0xa6a64d,arguments);return _0x3492b5=null,_0x20dc37;}}}}else _0x59dd78[_0x125b3a(0x322)](_0x26bb38);}:function(){};return _0x56b4db=![],_0x2f9b21;}};}()),_0xbca2c2=_0x45fb81(this,function(){const _0x4b51c5=_0x59d4,_0x3cdf2c={'JaWFO':_0x4b51c5(0x200),'GwxTT':function(_0x37c28f,_0x1dff6c){return _0x37c28f!==_0x1dff6c;},'NXRqk':_0x4b51c5(0x296),'cSnTC':_0x4b51c5(0x23e),'fbWlg':function(_0x49ea39,_0x4dda42){return _0x49ea39===_0x4dda42;},'FSTQd':_0x4b51c5(0x1ec),'oqSjH':function(_0x4d6ae4,_0x31309a){return _0x4d6ae4(_0x31309a);},'bVuaB':function(_0x48732a,_0x537d41){return _0x48732a+_0x537d41;},'SEHiY':'return\x20(function()\x20','yAOEd':_0x4b51c5(0x321),'QJjEY':function(_0x190d3e,_0x128843){return _0x190d3e===_0x128843;},'UNtty':_0x4b51c5(0x1f3),'TUNSp':function(_0x85f681){return _0x85f681();},'wYrLU':_0x4b51c5(0x340),'XrnKT':_0x4b51c5(0x1d4),'lLqnU':_0x4b51c5(0x30b),'XYcCd':'error','TasSI':_0x4b51c5(0x310),'Aztob':_0x4b51c5(0x2ff),'oceDx':'trace','QlPZE':function(_0x48773c,_0x465607){return _0x48773c<_0x465607;},'dxKDn':function(_0x3d2f00,_0x5b22e1){return _0x3d2f00===_0x5b22e1;},'MqjjL':_0x4b51c5(0x232)},_0x5dc6d0=function(){const _0x4640c5=_0x4b51c5;if(_0x3cdf2c['GwxTT'](_0x3cdf2c[_0x4640c5(0x2e0)],_0x3cdf2c[_0x4640c5(0x1d3)])){let _0x521194;try{_0x3cdf2c[_0x4640c5(0x229)](_0x3cdf2c[_0x4640c5(0x1de)],_0x3cdf2c[_0x4640c5(0x1de)])?_0x521194=_0x3cdf2c['oqSjH'](Function,_0x3cdf2c[_0x4640c5(0x1fd)](_0x3cdf2c['bVuaB'](_0x3cdf2c[_0x4640c5(0x217)],_0x3cdf2c[_0x4640c5(0x28f)]),');'))():_0x5e9ef4=_0x19759e;}catch(_0x30d597){if(_0x3cdf2c[_0x4640c5(0x349)](_0x3cdf2c['UNtty'],_0x3cdf2c['UNtty']))_0x521194=window;else{const _0x3e8e00=_0x3829e3[_0x4640c5(0x2e1)](_0x57afd6,arguments);return _0x285d76=null,_0x3e8e00;}}return _0x521194;}else _0x3779fc[_0x4640c5(0x340)](_0x5459fe),_0x4a13dc[_0x4640c5(0x1dc)](_0x1fe6f0[_0x4640c5(0x20f)]({'isStatus':!0x1,'class':_0x3cdf2c[_0x4640c5(0x35e)],'msg':_0x253517[_0x4640c5(0x237)]}));},_0x5a7975=_0x3cdf2c[_0x4b51c5(0x31d)](_0x5dc6d0),_0x424580=_0x5a7975[_0x4b51c5(0x33a)]=_0x5a7975[_0x4b51c5(0x33a)]||{},_0x56e6f2=[_0x3cdf2c[_0x4b51c5(0x1e9)],_0x3cdf2c[_0x4b51c5(0x2dd)],_0x3cdf2c[_0x4b51c5(0x2bd)],_0x3cdf2c[_0x4b51c5(0x29c)],_0x3cdf2c[_0x4b51c5(0x26a)],_0x3cdf2c['Aztob'],_0x3cdf2c['oceDx']];for(let _0x40bf01=0x0;_0x3cdf2c[_0x4b51c5(0x235)](_0x40bf01,_0x56e6f2['length']);_0x40bf01++){if(_0x3cdf2c[_0x4b51c5(0x23c)](_0x3cdf2c[_0x4b51c5(0x2b6)],_0x3cdf2c[_0x4b51c5(0x2b6)])){const _0x8aa1e5=_0x45fb81['constructor'][_0x4b51c5(0x2ed)][_0x4b51c5(0x2ee)](_0x45fb81),_0x417c26=_0x56e6f2[_0x40bf01],_0x1e376e=_0x424580[_0x417c26]||_0x8aa1e5;_0x8aa1e5[_0x4b51c5(0x1f4)]=_0x45fb81[_0x4b51c5(0x2ee)](_0x45fb81),_0x8aa1e5[_0x4b51c5(0x2bb)]=_0x1e376e['toString']['bind'](_0x1e376e),_0x424580[_0x417c26]=_0x8aa1e5;}else return _0x2a1233[_0x4b51c5(0x340)](_0x2673f8),_0x4c9458[_0x4b51c5(0x1dc)](_0x4106c3['stringify']({'isFetch':!0x1,'class':_0x3cdf2c[_0x4b51c5(0x35e)],'msg':_0x55d6bf[_0x4b51c5(0x237)]}));}});_0xbca2c2();function _0x5177(){const _0x487d15=['tsWmq','load','pkOfR','fDDAB','bCkPv','lOtuU','QlPZE','dateTimeCancelRemain','message','lRhON','while\x20(true)\x20{}','erxsr','hkWNR','dxKDn','error\x20===>\x20','yYUVv','CshJz','เอกสาร\x20\x22','print','Akgop','wTfue','567216apbFCF','QxyUi','PATH_SALES','DlGJA','/load-last','xZWFk','yyclX','zGotZ','ไม่พบเอกสารล่าสุด','return\x20(function()\x20','GzOfN','ยกเลิก','HTxDr','zzdJR','BdUXY','xDJIt','cacNX','TsFQt','load-last','zJtnt','max','Pamvn','qwhie','nPGrV','paymentMethod1','getDateTime','documentElement','KKJoq','pISdI','mGFWr','isAuth','get_Info_ByPath','docId','KGsOz','wDXBd','CNgNJ','FpFna','paymentMethod2','TasSI','../','JCpsW','DjFbY','/fetch/modal','BtMAU','sGszh','hYmUK','CvbuO','PATH_RETURN','Auwab','green','getDate','ocFfz','jVHJL','zPxFt','bsvje','RAcgI','userAuthority','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','active','ffIyB','XZROS','{{sep}}หรือไม่มีสิทธิ์','{{sep}}[บันทึกการแก้ไข]','/status','yDvWB','TfrEG','rOjwF','payTypeThai','cancel','{{sep}}[\x20ค้นหาเฉพาะในสาขาตนเอง\x20]','modifiedCount','McrlZ','FAMRS','/print','tUalq','yAOEd','check_DocDateTime_CanCancel','pZaur','connect','exoPW','xYlEm','lYsxl','qFXzi','sales','jIsOh','xgRRm','JoREq','fgGKw','XYcCd','ndqcb','return','QfOyH','findOne','IBCvL','11429WIsgwe','yenfq','lpeYw','AAnHf','kyuSG','folderForms','collectionName','xlGrP','collection','PATH_WAREHOUSE_OUT','Pxsdx','1476eajrqo','OBgxG','canEdit','FPGZR','lpEZn','gger','launch','PAY_TYPE','branchId','MqjjL','renderView','includes','BrhnZ','getItemsCategory','toString','DoxPR','lLqnU','userFullname','nJVjZ','setContent','BzRuZ','dpyjg','QzkPK','flGcw','GdmFp','function\x20*\x5c(\x20*\x5c)','NEnAN','JSyXI','wbrpn','PmyQW','hYlwk','yeYxC','Gcdlj','action','paymentMethod2Name','/search','HNICi','iHUVF','uptDx','dateTimeEditRemain','stock','\x20ไม่เปลี่ยนแปลง\x22','dZHWp','/myDocMain.js','468StaeGh','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','iKMVq','942VyTbAJ','XrnKT','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','getItems_for_Modal','NXRqk','apply','DOC_TYPE','paytype','cYtFb','TzWWM','bMQbO','ClYSE','convert_DocPrint','WtJLl','path','replace','input','prototype','bind','FfLwq','HnkHM','AteSx','VuqBm','Jgtsa','zHuFr','HYtXd','XxSoQ','yoOBH','changesHistory','debu','Ufbwg','MfsDs','SEerY','26905UEioRR','constructor','table','4780qSmahF','YButv','IHzAW','eUHyv','WPHKy','warehouseIn','tgKmO','copBJ','NYkRC','yKAYq','Zqeay','info','Jiyhg','JFBRz','wQTSM','โหลดเอกสารเลขที่\x20\x22','exception','897IKDUpz','matchedCount','offsetHeight','zqTUT','PHcNu','KyPaR','length','TEaEy','dateTimeCanCancel','5404pDUohM','puppeteer','syPMd','TUNSp','aWjNj','ไม่พบเอกสารเลขที่\x20\x22','body','{}.constructor(\x22return\x20this\x22)(\x20)','hePxM','aupFz','eAvIm','nsyIF','EyFNM','RCsRE','find','string','ozEgz','ZJmdY','updateOne','getMainDocPathObj','CeBNq','32864aLPqSm','RJOCh','eGApb','QuGal','aggregate','QjNfs','BxNwo','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','RZqyH','dqjvc','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','console','uDqFT','test','yOCIg','hVeRQ','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','log','RAKmj','kJCWy','JGcUu','OpSRP','bciGQ','ไม่พบประวัติการเปลี่ยนแปลง','getChangeHistory','พบ\x20\x22','QJjEY','statusName','paymentMethod1Name','OoMVl','tJXEd','doc_print.ejs','clientHeight','getSettings','newPage','RXexQ','call','/myModule.js','KYENB','Router','\x22\x20เอกสาร','\x22\x20{{sep}}เรียบร้อยแล้ว','EDXxQ','xbWiZ','ipLIu','kMYVk','19702TopDSR','JaWFO','init','cSnTC','warn','floor','warehouseOut','TlwoU','dbName','EkVVG','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','DTWYp','send','jDIaM','FSTQd','suEpS','AvpJI','kwfzY','iggmW','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','yellow','mDwwv','post','2255603lXjZVA','XMoit','wYrLU','apXSe','UoEKO','BvsAD','MggqZ','HihmW','push','/load','jTFSc','VpPKm','PlWzN','__proto__','UEPjX','fyEPF','YUkkZ','.jpeg','sCCsQ','shclN','QDqhQ','QbWru','bVuaB','check_DocDateTime_CanEdit','userId','red','eSfEI','/changes','JgSHN','end','dbUrl','join','fFaYE','kphzM','GSVJw','lwGOi','wuDzx','HahSB','scrollHeight','wlmGn','stringify','docStatusNumber','ygkxO','canCancel','DtmqJ','mqRjd','XzNwV','/myData.js','SEHiY','jKRxQ','UwTLk','ifgOj','เอกสารที่ตันเองไม่ได้สร้าง','rGAKp','nuuOR','DRhWh','counter','getSessionData','IdXai','chain','stateObject','UCMbZ','VLGQd','getUserData','4StqvVB','HWkfx','fbWlg','ไม่พบเอกสาร\x20\x22','UxKaG','close','RHmUb','writeHead'];_0x5177=function(){return _0x487d15;};return _0x5177();}import _0x19c652 from'express';const y=_0x19c652[_0x2172b5(0x356)]();import _0x4ae144 from'path';import{MongoClient as _0xd75162}from'mongodb';import _0x311066 from'../middleware/mainAuth.js';const C=await import(_0x2172b5(0x26b)+mymoduleFolder+_0x2172b5(0x354)),E=await import(_0x2172b5(0x26b)+mymoduleFolder+'/myDateTime.js'),$=await import('../'+mymoduleFolder+'/myUsers.js'),u=await import(_0x2172b5(0x26b)+mymoduleFolder+_0x2172b5(0x216)),m=await import(_0x2172b5(0x26b)+mymoduleFolder+_0x2172b5(0x2d8)),b=global['PATH_WAREHOUSE_IN'],p=global[_0x2172b5(0x2ab)],S=global[_0x2172b5(0x246)],w=global[_0x2172b5(0x273)],v=[b+_0x2172b5(0x26e),p+'/fetch/modal',S+_0x2172b5(0x26e),w+_0x2172b5(0x26e)],k=[b+_0x2172b5(0x202),p+'/changes',S+_0x2172b5(0x202),w+_0x2172b5(0x202)],L=[b+_0x2172b5(0x28d),p+_0x2172b5(0x28d),S+_0x2172b5(0x28d),w+'/print'],B=[b+_0x2172b5(0x283),p+_0x2172b5(0x283),S+'/status',w+'/status'],Y=[b+'/search',p+_0x2172b5(0x2d0),S+_0x2172b5(0x2d0),w+_0x2172b5(0x2d0)],x=[b+'/load',p+_0x2172b5(0x1f0),S+_0x2172b5(0x1f0),w+_0x2172b5(0x1f0),b+'/load-last',p+_0x2172b5(0x248),S+'/load-last',w+_0x2172b5(0x248)];y['get'](v,_0x311066[_0x2172b5(0x262)],async(_0x1b9b02,_0x103249)=>{const _0x230d37=_0x2172b5,_0x189798={'kwfzY':function(_0x50ec4d,_0x35eb1a){return _0x50ec4d!==_0x35eb1a;},'cbJUX':'mlppc','wQTSM':_0x230d37(0x302),'gYOpW':function(_0x201716,_0x1ea789){return _0x201716==_0x1ea789;},'bsvje':_0x230d37(0x305),'UEPjX':_0x230d37(0x2d5),'lwGOi':_0x230d37(0x27e),'HWkfx':function(_0x62eff6,_0x2f3ee9){return _0x62eff6==_0x2f3ee9;},'uDCsw':_0x230d37(0x1d6),'pZaur':_0x230d37(0x297),'DTWYp':_0x230d37(0x29e),'IdXai':_0x230d37(0x275),'ndqcb':_0x230d37(0x1e3),'hVeRQ':function(_0x5589c7,_0x10c33a){return _0x5589c7!==_0x10c33a;},'dZHWp':_0x230d37(0x344),'EbDYP':_0x230d37(0x200)},_0x5f0bd1=await $[_0x230d37(0x220)](_0x1b9b02),_0x2cf778=await m[_0x230d37(0x32d)](_0x1b9b02,_0x103249,_0x5f0bd1[_0x230d37(0x27c)]);try{if(_0x189798[_0x230d37(0x1e1)](_0x189798['cbJUX'],_0x189798[_0x230d37(0x30e)])){if(_0x189798['gYOpW'](_0x2cf778[_0x230d37(0x2e2)],_0x189798[_0x230d37(0x27a)]))var _0x4b4473=await u[_0x230d37(0x2df)](_0x189798[_0x230d37(0x1f5)]),_0xa77d6c=await u['getSuppliers_for_Modal'](_0x189798[_0x230d37(0x20a)]);else{if(_0x189798[_0x230d37(0x228)](_0x2cf778[_0x230d37(0x2e2)],_0x189798['uDCsw']))var _0x4b4473=await u[_0x230d37(0x2df)](_0x189798['UEPjX']),_0xa77d6c=[];else{if(_0x189798['HWkfx'](_0x2cf778['DOC_TYPE'],_0x189798[_0x230d37(0x291)]))var _0x4b4473=await u[_0x230d37(0x2df)](_0x189798[_0x230d37(0x20a)],_0x5f0bd1[_0x230d37(0x2b5)]),_0xa77d6c=[];else{if(_0x189798[_0x230d37(0x228)](_0x2cf778[_0x230d37(0x2e2)],_0x189798[_0x230d37(0x1db)]))var _0x4b4473=await u[_0x230d37(0x2df)](_0x189798[_0x230d37(0x20a)],_0x5f0bd1[_0x230d37(0x2b5)]),_0xa77d6c=[];}}}const _0x499ee1=await u[_0x230d37(0x2ba)]();return _0x103249['send'](JSON[_0x230d37(0x20f)]({'DATA_ITEMS':_0x4b4473,'DATA_CATEGORY':_0x499ee1,'DATA_SUPPLIERS':_0xa77d6c,'isFetch':!0x0,'class':_0x189798[_0x230d37(0x221)],'msg':_0x189798[_0x230d37(0x29d)]}));}else{const _0x21e87b=_0x44a601[_0x230d37(0x2e1)](_0x15b34a,arguments);return _0x3fdafe=null,_0x21e87b;}}catch(_0x1aeb17){if(_0x189798[_0x230d37(0x33e)](_0x189798[_0x230d37(0x2d7)],_0x189798[_0x230d37(0x2d7)])){const _0x23d4f5=_0xf50fa2?function(){const _0x247a4b=_0x230d37;if(_0x4b8bfb){const _0x2ce31f=_0x47358d[_0x247a4b(0x2e1)](_0x3ffcda,arguments);return _0x32a0ea=null,_0x2ce31f;}}:function(){};return _0x15af40=![],_0x23d4f5;}else return console[_0x230d37(0x340)](_0x1aeb17),_0x103249['send'](JSON[_0x230d37(0x20f)]({'isFetch':!0x1,'class':_0x189798['EbDYP'],'msg':_0x1aeb17['message']}));}}),y[_0x2172b5(0x1e6)](Y,_0x311066[_0x2172b5(0x262)],async(_0x53ee83,_0x42ffd4)=>{const _0x21bac5=_0x2172b5,_0x4392bf={'lpEZn':function(_0x2fc9b7,_0x4b9a2d){return _0x2fc9b7+_0x4b9a2d;},'yeYxC':_0x21bac5(0x2f9),'FTCcr':_0x21bac5(0x2b2),'nsyIF':_0x21bac5(0x2ce),'CeBNq':_0x21bac5(0x2c6),'HTxDr':_0x21bac5(0x336),'yOCIg':function(_0x25748a,_0x263856){return _0x25748a(_0x263856);},'ygkxO':_0x21bac5(0x1d2),'CAAhY':'chain','pISdI':function(_0x4ddc4e,_0x5813df){return _0x4ddc4e+_0x5813df;},'TEaEy':_0x21bac5(0x2ec),'tsWmq':function(_0x116e13){return _0x116e13();},'CvbuO':function(_0x4025d3,_0x40e55f){return _0x4025d3<_0x40e55f;},'DtmqJ':_0x21bac5(0x1e4),'CNgNJ':_0x21bac5(0x27d),'nJVjZ':function(_0x2d05e6,_0x1eac5a){return _0x2d05e6===_0x1eac5a;},'KGsOz':_0x21bac5(0x32a),'KKJoq':_0x21bac5(0x289),'RJOCh':_0x21bac5(0x275),'JgSHN':_0x21bac5(0x2f0),'OoMVl':'red','GhaOY':function(_0x43daa9,_0x3326ff){return _0x43daa9!==_0x3326ff;},'yyclX':_0x21bac5(0x2cb)};let {sip:_0x38b38b}=_0x53ee83[_0x21bac5(0x320)];if(!_0x38b38b&&_0x4392bf[_0x21bac5(0x272)](_0x38b38b[_0x21bac5(0x317)],0x2))return _0x42ffd4['send'](JSON['stringify']({'isSearch':!0x1,'class':_0x4392bf[_0x21bac5(0x213)],'msg':_0x4392bf[_0x21bac5(0x267)]}));_0x38b38b=_0x38b38b['replace'](/[!@#$%^&*<>]/g,'')??null;const _0x331d80=await $[_0x21bac5(0x226)](_0x53ee83);await m[_0x21bac5(0x32d)](_0x53ee83,_0x42ffd4,_0x331d80[_0x21bac5(0x27c)]);const _0x1c2fa6=m[_0x21bac5(0x263)](_0x53ee83[_0x21bac5(0x2ea)]),_0x440db6=new _0xd75162(global[_0x21bac5(0x205)]);try{if(_0x4392bf[_0x21bac5(0x2bf)](_0x4392bf[_0x21bac5(0x265)],_0x4392bf[_0x21bac5(0x265)])){await _0x440db6[_0x21bac5(0x292)]();const _0x22d878=_0x440db6['db'](global[_0x21bac5(0x1d8)])['collection'](_0x1c2fa6[_0x21bac5(0x2a8)]),_0x1468ed=[{'$or':[{'docId':{'$regex':_0x38b38b,'$options':'i'}},{'docDateTime':{'$regex':_0x38b38b,'$options':'i'}}]}];let _0x204278='';['O','S'][_0x21bac5(0x2b8)](_0x331d80[_0x21bac5(0x27c)])||(_0x204278+=_0x4392bf[_0x21bac5(0x25f)],_0x1468ed[_0x21bac5(0x1ef)]({'branchId':_0x331d80[_0x21bac5(0x2b5)]}));const _0x4a0f75=await _0x22d878[_0x21bac5(0x333)]([{'$match':{'$and':_0x1468ed}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDateTime':0x1,'userId':0x1}}])['toArray']();return _0x204278=_0x4392bf[_0x21bac5(0x260)](_0x21bac5(0x348)+_0x4a0f75['length']+_0x21bac5(0x357),_0x204278),_0x42ffd4[_0x21bac5(0x1dc)](JSON[_0x21bac5(0x20f)]({'searchFound':_0x4a0f75,'msg':_0x204278,'isSearch':!0x0,'class':_0x4392bf[_0x21bac5(0x330)]}));}else return _0x34142f;}catch(_0x374816){if(_0x4392bf[_0x21bac5(0x2bf)](_0x4392bf[_0x21bac5(0x203)],_0x4392bf[_0x21bac5(0x203)]))return console['log'](_0x374816),_0x42ffd4['send'](JSON[_0x21bac5(0x20f)]({'isSearch':!0x1,'class':_0x4392bf[_0x21bac5(0x34c)],'msg':_0x374816['message']}));else(function(){return!![];}[_0x21bac5(0x2fe)](dbqDqh[_0x21bac5(0x2b1)](dbqDqh[_0x21bac5(0x2cc)],dbqDqh['FTCcr']))[_0x21bac5(0x353)](dbqDqh[_0x21bac5(0x325)]));}finally{if(_0x4392bf['GhaOY'](_0x4392bf['yyclX'],_0x4392bf[_0x21bac5(0x24a)])){const _0x53c5bd=new _0x24719f(dbqDqh[_0x21bac5(0x32e)]),_0x3fd9af=new _0x9e2bae(dbqDqh[_0x21bac5(0x250)],'i'),_0x562855=dbqDqh[_0x21bac5(0x33d)](_0x39931c,dbqDqh[_0x21bac5(0x211)]);!_0x53c5bd['test'](dbqDqh[_0x21bac5(0x2b1)](_0x562855,dbqDqh['CAAhY']))||!_0x3fd9af[_0x21bac5(0x33c)](dbqDqh[_0x21bac5(0x260)](_0x562855,dbqDqh[_0x21bac5(0x318)]))?dbqDqh[_0x21bac5(0x33d)](_0x562855,'0'):dbqDqh[_0x21bac5(0x22f)](_0x58810f);}else _0x440db6[_0x21bac5(0x22c)]();}}),y[_0x2172b5(0x1e6)](x,_0x311066['isAuth'],async(_0x211d8a,_0x22cea8)=>{const _0x39dc34=_0x2172b5,_0x40d8d4={'TlwoU':_0x39dc34(0x2c6),'exoPW':_0x39dc34(0x336),'cYtFb':function(_0x433adc,_0x2e43c2){return _0x433adc(_0x2e43c2);},'IQzib':_0x39dc34(0x1d2),'McrlZ':function(_0x491bca,_0x14416d){return _0x491bca+_0x14416d;},'xgRRm':_0x39dc34(0x222),'Owbkr':_0x39dc34(0x2ec),'lpeYw':function(_0x1d0d89){return _0x1d0d89();},'suLnV':function(_0x5d8be0,_0x3be0c6,_0x54670a){return _0x5d8be0(_0x3be0c6,_0x54670a);},'lOtuU':'debu','ZJmdY':_0x39dc34(0x2b2),'wlmGn':_0x39dc34(0x223),'FfLwq':function(_0x436184,_0x29921e){return _0x436184!==_0x29921e;},'KyPaR':_0x39dc34(0x2d1),'zJtnt':_0x39dc34(0x215),'txFPD':function(_0x3b844c,_0x1e0917){return _0x3b844c===_0x1e0917;},'iggmW':_0x39dc34(0x230),'JCpsW':function(_0x271e22,_0x22c735){return _0x271e22===_0x22c735;},'MfsDs':_0x39dc34(0x23b),'UkrxJ':function(_0x1db53c,_0x16b001){return _0x1db53c===_0x16b001;},'ZFzNd':_0x39dc34(0x256),'Pamvn':_0x39dc34(0x24c),'FAMRS':_0x39dc34(0x200),'JoREq':function(_0x30bcbf,_0x569711){return _0x30bcbf==_0x569711;},'xYlEm':_0x39dc34(0x2f2),'yenfq':_0x39dc34(0x2f7),'wuDzx':function(_0x350742,_0x66048b){return _0x350742==_0x66048b;},'UxKaG':_0x39dc34(0x1da),'FpFna':function(_0x5e00e8,_0x8344ea){return _0x5e00e8==_0x8344ea;},'oQIRR':_0x39dc34(0x2c4),'nNasE':_0x39dc34(0x279),'azXoD':_0x39dc34(0x275),'QDqhQ':function(_0x322131,_0x40e65c){return _0x322131!==_0x40e65c;},'ZTkLE':'upIJY','kyuSG':'JWAfX','QGZzt':function(_0x344d96,_0x5ef5f4){return _0x344d96!==_0x5ef5f4;},'ocFfz':_0x39dc34(0x2e7),'dipen':_0x39dc34(0x295)};let {docId:_0x397331,action:_0x4cf008}=_0x211d8a['body'];const _0x4e9ac3=await $['getUserData'](_0x211d8a);await m[_0x39dc34(0x32d)](_0x211d8a,_0x22cea8,_0x4e9ac3['userAuthority']);const _0x2575c7=m[_0x39dc34(0x263)](_0x211d8a[_0x39dc34(0x2ea)]),_0x1cd923=new _0xd75162(global['dbUrl']);try{if(_0x40d8d4[_0x39dc34(0x2ef)](_0x40d8d4[_0x39dc34(0x316)],_0x40d8d4[_0x39dc34(0x257)])){await _0x1cd923[_0x39dc34(0x292)]();const _0x394b2d=_0x1cd923['db'](global['dbName'])[_0x39dc34(0x2aa)](_0x2575c7[_0x39dc34(0x2a8)]);if(_0x40d8d4['txFPD'](_0x4cf008,_0x40d8d4['iggmW'])){if(_0x40d8d4[_0x39dc34(0x26c)](_0x40d8d4[_0x39dc34(0x2fb)],_0x40d8d4['MfsDs'])){const _0x47a00f=['O','S']['includes'](_0x4e9ac3[_0x39dc34(0x27c)])?{'docId':_0x397331}:{'docId':_0x397331,'branchId':_0x4e9ac3[_0x39dc34(0x2b5)]};var _0x3ea5c7=await _0x394b2d[_0x39dc34(0x2a0)](_0x47a00f,{'projection':{'_id':0x0,'changesHistory':0x0}});}else{const _0x568927={'ifgOj':gLNMkM[_0x39dc34(0x1d7)],'jIsOh':gLNMkM[_0x39dc34(0x293)],'xfxIT':function(_0x4fe8f2,_0x7e9bd){const _0x3e62a2=_0x39dc34;return gLNMkM[_0x3e62a2(0x2e4)](_0x4fe8f2,_0x7e9bd);},'jDIaM':gLNMkM['IQzib'],'mqRjd':function(_0x170737,_0x59abef){return gLNMkM['McrlZ'](_0x170737,_0x59abef);},'xbWiZ':gLNMkM[_0x39dc34(0x299)],'BrhnZ':function(_0x3d2fe4,_0x11ccc8){const _0x44ff01=_0x39dc34;return gLNMkM[_0x44ff01(0x28b)](_0x3d2fe4,_0x11ccc8);},'BzRuZ':gLNMkM['Owbkr'],'sGszh':function(_0x8f1302){const _0x378460=_0x39dc34;return gLNMkM[_0x378460(0x2a4)](_0x8f1302);}};gLNMkM['suLnV'](_0x386ad9,this,function(){const _0x1f29af=_0x39dc34,_0x543a59=new _0x2191b4(_0x568927[_0x1f29af(0x21a)]),_0x5538ed=new _0x2dae69(_0x568927[_0x1f29af(0x298)],'i'),_0x3666ba=_0x568927['xfxIT'](_0x41a81f,_0x568927[_0x1f29af(0x1dd)]);!_0x543a59[_0x1f29af(0x33c)](_0x568927[_0x1f29af(0x214)](_0x3666ba,_0x568927[_0x1f29af(0x35a)]))||!_0x5538ed['test'](_0x568927[_0x1f29af(0x2b9)](_0x3666ba,_0x568927[_0x1f29af(0x2c1)]))?_0x568927['xfxIT'](_0x3666ba,'0'):_0x568927[_0x1f29af(0x270)](_0x31fba4);})();}}else{if(_0x40d8d4['UkrxJ'](_0x4cf008,_0x40d8d4['ZFzNd']))var _0x3ea5c7=await _0x394b2d[_0x39dc34(0x2a0)]({'userId':_0x4e9ac3[_0x39dc34(0x1ff)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0xbd5462=_0x3ea5c7?'':_0x40d8d4[_0x39dc34(0x26c)](_0x4cf008,_0x40d8d4[_0x39dc34(0x1e2)])?_0x39dc34(0x31f)+_0x397331+'\x22':_0x40d8d4[_0x39dc34(0x259)];if(!_0x3ea5c7)return _0x22cea8[_0x39dc34(0x1dc)](JSON['stringify']({'isLoad':!0x1,'class':_0x40d8d4[_0x39dc34(0x28c)],'msg':_0xbd5462}));if(_0x40d8d4[_0x39dc34(0x29a)](_0x3ea5c7[_0x39dc34(0x210)],0x1)&&_0x3ea5c7['dateTimeCanEdit']){if(_0x40d8d4['JCpsW'](_0x40d8d4[_0x39dc34(0x294)],_0x40d8d4[_0x39dc34(0x2a3)]))(function(){return![];}[_0x39dc34(0x2fe)](gLNMkM[_0x39dc34(0x28b)](gLNMkM[_0x39dc34(0x234)],gLNMkM[_0x39dc34(0x32b)]))['apply'](gLNMkM[_0x39dc34(0x20e)]));else{let _0x93408b=await m[_0x39dc34(0x1fe)](_0x3ea5c7,_0x2575c7['collectionName'],_0x4e9ac3[_0x39dc34(0x1ff)]);_0x3ea5c7[_0x39dc34(0x2d4)]=_0x93408b['dateTimeEditRemain'],_0x40d8d4[_0x39dc34(0x20b)](_0x93408b[_0x39dc34(0x2af)],!0x1)&&(_0x3ea5c7['docStatusNumber']=_0x93408b['docStatusNumber'],msg+=_0x40d8d4[_0x39dc34(0x22b)]);}}if((_0x40d8d4['wuDzx'](_0x3ea5c7[_0x39dc34(0x210)],0x1)||_0x40d8d4[_0x39dc34(0x268)](_0x3ea5c7['docStatusNumber'],0x2))&&_0x3ea5c7[_0x39dc34(0x319)]){if(_0x40d8d4['FfLwq'](_0x40d8d4['oQIRR'],_0x40d8d4['nNasE'])){const _0x4a158b=await m[_0x39dc34(0x290)](_0x3ea5c7,_0x2575c7[_0x39dc34(0x2a8)],_0x4e9ac3[_0x39dc34(0x1ff)]);_0x3ea5c7[_0x39dc34(0x236)]=_0x4a158b[_0x39dc34(0x236)];}else _0x3a0d3c[_0x39dc34(0x22c)]();}const {branchName:_0x3f08e8}=await u['getUserBranchesById'](_0x3ea5c7[_0x39dc34(0x2b5)]);return _0x3ea5c7['branchName']=_0x3f08e8,_0x22cea8['send'](JSON[_0x39dc34(0x20f)]({'doc':_0x3ea5c7,'isLoad':!0x0,'class':_0x40d8d4['azXoD'],'msg':_0x39dc34(0x30f)+_0x3ea5c7[_0x39dc34(0x264)]+_0x39dc34(0x358),'userId':_0x4e9ac3[_0x39dc34(0x1ff)],'userAuthority':_0x4e9ac3[_0x39dc34(0x27c)]}));}else{const _0x36d045=_0x50fe0c?function(){const _0x138cf0=_0x39dc34;if(_0x30495f){const _0x38f93b=_0x48ec63[_0x138cf0(0x2e1)](_0x1f865a,arguments);return _0x568bae=null,_0x38f93b;}}:function(){};return _0x1555b5=![],_0x36d045;}}catch(_0x1e67da){if(_0x40d8d4[_0x39dc34(0x1fb)](_0x40d8d4['ZTkLE'],_0x40d8d4[_0x39dc34(0x2a6)]))return console['log'](_0x1e67da),_0x22cea8[_0x39dc34(0x1dc)](JSON['stringify']({'isLoad':!0x1,'class':_0x40d8d4[_0x39dc34(0x28c)],'msg':_0x1e67da[_0x39dc34(0x237)]}));else _0x44e042[_0x39dc34(0x22c)]();}finally{if(_0x40d8d4['QGZzt'](_0x40d8d4[_0x39dc34(0x277)],_0x40d8d4['dipen']))_0x1cd923[_0x39dc34(0x22c)]();else return![];}}),y[_0x2172b5(0x1e6)](k,_0x311066['isAuth'],async(_0x50b1d4,_0x2cca6f)=>{const _0x2711d8=_0x2172b5,_0x4fdac1={'jKRxQ':_0x2711d8(0x23d),'fFaYE':_0x2711d8(0x200),'aupFz':_0x2711d8(0x239),'KYENB':'counter','AvpJI':function(_0x3d8a53,_0x4bc385){return _0x3d8a53!==_0x4bc385;},'PHcNu':_0x2711d8(0x209),'EyFNM':function(_0x333448,_0x16e9fd){return _0x333448<_0x16e9fd;},'CshJz':_0x2711d8(0x1e4),'NqAtT':_0x2711d8(0x346),'RSNcQ':'doc_changes.ejs','HYtXd':_0x2711d8(0x275),'zzdJR':function(_0x4bc02a,_0x2eb1b6){return _0x4bc02a!==_0x2eb1b6;},'oLnIG':'eotKL','DRhWh':'OKQQB','dgWgP':function(_0xbf86,_0x8ab99c){return _0xbf86===_0x8ab99c;},'EkVVG':_0x2711d8(0x341),'mGFWr':_0x2711d8(0x2a9)},{docId:_0x46d4fe}=_0x50b1d4[_0x2711d8(0x320)],_0xa225cc=await $[_0x2711d8(0x220)](_0x50b1d4);await m[_0x2711d8(0x32d)](_0x50b1d4,_0x2cca6f,_0xa225cc[_0x2711d8(0x27c)]);const {collectionName:_0x5b3f66}=m[_0x2711d8(0x263)](_0x50b1d4[_0x2711d8(0x2ea)]),_0x8447e2=new _0xd75162(global['dbUrl']);try{if(_0x4fdac1[_0x2711d8(0x1e0)](_0x4fdac1['PHcNu'],_0x4fdac1[_0x2711d8(0x315)]))_0x4bcce2[_0x2711d8(0x340)](_0x4fdac1[_0x2711d8(0x218)],_0x5d9279),_0x4f29d5[_0x2711d8(0x1dc)](_0x2d3aa7[_0x2711d8(0x20f)]({'isPrint':!0x1,'class':_0x4fdac1[_0x2711d8(0x207)],'msg':_0xc9b4de['message']}));else{await _0x8447e2[_0x2711d8(0x292)]();var _0x31ba71=await _0x8447e2['db'](global[_0x2711d8(0x1d8)])[_0x2711d8(0x2aa)](_0x5b3f66)[_0x2711d8(0x2a0)]({'docId':_0x46d4fe});if(!_0x31ba71)return _0x2cca6f[_0x2711d8(0x1dc)](JSON[_0x2711d8(0x20f)]({'isPrint':!0x1,'class':_0x4fdac1[_0x2711d8(0x207)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x46d4fe+'\x22'}));const _0x12c080=_0x31ba71[_0x2711d8(0x2f8)]||[];if(_0x4fdac1[_0x2711d8(0x326)](_0x12c080[_0x2711d8(0x317)],0x1))return _0x2cca6f[_0x2711d8(0x1dc)](JSON[_0x2711d8(0x20f)]({'isPrint':!0x1,'class':_0x4fdac1[_0x2711d8(0x23f)],'msg':_0x4fdac1['NqAtT']}));const _0x2ed306=_0x4ae144[_0x2711d8(0x206)](folderForms,_0x4fdac1['RSNcQ']),_0x2c43a1=await C[_0x2711d8(0x2b7)](_0x2ed306,_0x2cca6f,{'title':'ประวัติการแก้ไขเอกสาร\x20:\x20'+_0x31ba71[_0x2711d8(0x264)],'time':E[_0x2711d8(0x25d)](),'changesHistory':_0x12c080});_0x2cca6f[_0x2711d8(0x1dc)](JSON[_0x2711d8(0x20f)]({'isPrint':!0x0,'class':_0x4fdac1[_0x2711d8(0x2f5)],'htmlPage':_0x2c43a1}));}}catch(_0xf0a9d6){if(_0x4fdac1[_0x2711d8(0x251)](_0x4fdac1['oLnIG'],_0x4fdac1[_0x2711d8(0x21e)]))console[_0x2711d8(0x340)](_0x4fdac1[_0x2711d8(0x218)],_0xf0a9d6),_0x2cca6f[_0x2711d8(0x1dc)](JSON['stringify']({'isPrint':!0x1,'class':_0x4fdac1['fFaYE'],'msg':_0xf0a9d6[_0x2711d8(0x237)]}));else return function(_0x236cce){}[_0x2711d8(0x2fe)](YKqkst[_0x2711d8(0x323)])[_0x2711d8(0x2e1)](YKqkst[_0x2711d8(0x355)]);}finally{_0x4fdac1['dgWgP'](_0x4fdac1[_0x2711d8(0x1d9)],_0x4fdac1[_0x2711d8(0x261)])?_0xdd3370[_0x2711d8(0x22c)]():_0x8447e2[_0x2711d8(0x22c)]();}}),y[_0x2172b5(0x1e6)](L,_0x311066[_0x2172b5(0x262)],async(_0x1e9d22,_0x33e40e)=>{const _0x5b85cb=_0x2172b5,_0x181bf3={'BlBRx':function(_0x4fc7b3,_0xada62b){return _0x4fc7b3(_0xada62b);},'RFRhZ':function(_0x5f227d,_0x2b0797){return _0x5f227d+_0x2b0797;},'hPYqd':function(_0x472b97,_0x3bbc26){return _0x472b97+_0x3bbc26;},'pkOfR':_0x5b85cb(0x24d),'RCsRE':_0x5b85cb(0x321),'jlPUi':function(_0x92558e,_0x5665e0){return _0x92558e(_0x5665e0);},'bCkPv':function(_0x488c41,_0x712ca8){return _0x488c41===_0x712ca8;},'dqjvc':_0x5b85cb(0x255),'JFBRz':function(_0x428c10,_0x2064a2){return _0x428c10!==_0x2064a2;},'wbrpn':'vZjhx','jVHJL':_0x5b85cb(0x27b),'fgGKw':_0x5b85cb(0x200),'WtJLl':_0x5b85cb(0x34e),'QSwER':function(_0x335464,_0x4632c4){return _0x335464==_0x4632c4;},'kJCWy':_0x5b85cb(0x241),'wTfue':_0x5b85cb(0x275),'EDXxQ':function(_0x2c61eb,_0x490bdf){return _0x2c61eb==_0x490bdf;},'Auwab':'image','jTFSc':function(_0x102881,_0x36ba14){return _0x102881!==_0x36ba14;},'Gvych':_0x5b85cb(0x252),'DjFbY':_0x5b85cb(0x31b),'MGbUt':'networkidle0','iQILg':function(_0x28492e,_0xaf493c){return _0x28492e*_0xaf493c;},'Ufbwg':function(_0x32ff28,_0x317516){return _0x32ff28/_0x317516;},'IBCvL':'jpeg','SCNBn':'image/jpeg','zPMYj':function(_0x5993ba,_0x39f150){return _0x5993ba!==_0x39f150;},'yDvWB':'LYYxs','BtMAU':_0x5b85cb(0x23d),'nPGrV':function(_0x549a8a,_0x523363){return _0x549a8a!==_0x523363;},'wScgm':'hFLmF'},{docId:_0x5b1664,action:_0x5b8a4f}=_0x1e9d22[_0x5b85cb(0x320)],_0x5992cf=await $[_0x5b85cb(0x220)](_0x1e9d22);await m['getMainDocPathObj'](_0x1e9d22,_0x33e40e,_0x5992cf[_0x5b85cb(0x27c)]);const {collectionName:_0x3314d2,docTitle:_0x13b7a0,docType:_0x4b6384}=m['get_Info_ByPath'](_0x1e9d22[_0x5b85cb(0x2ea)]),_0x6214c5=new _0xd75162(global['dbUrl']);try{if(_0x181bf3[_0x5b85cb(0x30d)](_0x181bf3[_0x5b85cb(0x2c9)],_0x181bf3[_0x5b85cb(0x278)])){await _0x6214c5[_0x5b85cb(0x292)]();var _0x40e742=await _0x6214c5['db'](global[_0x5b85cb(0x1d8)])['collection'](_0x3314d2)[_0x5b85cb(0x2a0)]({'docId':_0x5b1664});if(!_0x40e742)return _0x33e40e[_0x5b85cb(0x1dc)](JSON[_0x5b85cb(0x20f)]({'isLoad':!0x1,'class':_0x181bf3['fgGKw'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x5b1664+'\x22'}));_0x40e742['docTitle']=_0x13b7a0,_0x40e742[_0x5b85cb(0x34a)]=u['get_StatusName_byStatusNumber'](_0x40e742[_0x5b85cb(0x210)]);const _0x481064=u[_0x5b85cb(0x2e8)](_0x40e742);_0x481064[_0x5b85cb(0x25c)]&&(_0x481064[_0x5b85cb(0x34b)]=global[_0x5b85cb(0x2b4)]['find'](_0x8cddd2=>_0x8cddd2[_0x5b85cb(0x2e3)]==_0x481064[_0x5b85cb(0x25c)])?.[_0x5b85cb(0x287)]||''),_0x481064[_0x5b85cb(0x269)]&&(_0x481064[_0x5b85cb(0x2cf)]=global[_0x5b85cb(0x2b4)][_0x5b85cb(0x328)](_0x16c018=>_0x16c018[_0x5b85cb(0x2e3)]==_0x481064['paymentMethod2'])?.[_0x5b85cb(0x287)]||'');const _0x3aad84=_0x4ae144[_0x5b85cb(0x206)](global[_0x5b85cb(0x2a7)],_0x181bf3[_0x5b85cb(0x2e9)]),_0x4d30d4=await C[_0x5b85cb(0x2b7)](_0x3aad84,_0x33e40e,{'title':_0x5b1664,'time':E[_0x5b85cb(0x276)](0x0),'action':_0x5b8a4f,'docType':_0x4b6384,'doc':_0x481064,'settings':await C[_0x5b85cb(0x350)]()});if(_0x181bf3['QSwER'](_0x5b8a4f,_0x181bf3[_0x5b85cb(0x342)]))_0x33e40e[_0x5b85cb(0x1dc)](JSON[_0x5b85cb(0x20f)]({'isPrint':!0x0,'class':_0x181bf3[_0x5b85cb(0x243)],'htmlPage':_0x4d30d4}));else{if(_0x181bf3[_0x5b85cb(0x359)](_0x5b8a4f,_0x181bf3[_0x5b85cb(0x274)])){if(_0x181bf3[_0x5b85cb(0x1f1)](_0x181bf3['Gvych'],_0x181bf3['Gvych'])){let _0x5e6111;try{_0x5e6111=AgCFQs['BlBRx'](_0x46acaf,AgCFQs['RFRhZ'](AgCFQs['hPYqd'](AgCFQs[_0x5b85cb(0x231)],AgCFQs[_0x5b85cb(0x327)]),');'))();}catch(_0x4dd34e){_0x5e6111=_0x5f4020;}return _0x5e6111;}else{const _0x573d73=await(await import(_0x181bf3[_0x5b85cb(0x26d)]))[_0x5b85cb(0x2b3)](),_0x5aa49c=await _0x573d73[_0x5b85cb(0x351)]();await _0x5aa49c[_0x5b85cb(0x2c0)](_0x4d30d4,{'waitUntil':_0x181bf3['MGbUt'],'timeout':0x2710}),await new Promise(_0x2eb089=>setTimeout(_0x2eb089,0x3e8));const _0x526524=Math[_0x5b85cb(0x1d5)](_0x181bf3['iQILg'](_0x181bf3[_0x5b85cb(0x2fa)](0x50,25.4),0x60));await _0x5aa49c['setViewport']({'width':_0x526524,'height':0x258,'deviceScaleFactor':0x1});const _0x4b9b99=await _0x5aa49c['evaluate'](()=>{const _0x243918=_0x5b85cb,_0x2deaff={'aHPwy':function(_0x77e858,_0x106ea6){return _0x181bf3['jlPUi'](_0x77e858,_0x106ea6);}};if(_0x181bf3[_0x243918(0x233)](_0x181bf3['dqjvc'],_0x181bf3[_0x243918(0x338)])){const _0x16747e=document[_0x243918(0x320)],_0x47e893=document[_0x243918(0x25e)];return Math['max'](_0x16747e['scrollHeight'],_0x16747e[_0x243918(0x313)],_0x47e893[_0x243918(0x34f)],_0x47e893[_0x243918(0x20d)],_0x47e893[_0x243918(0x313)]);}else{if(_0x1f5ed7)return _0x44da1a;else JMXqKK['aHPwy'](_0x480cf9,0x0);}}),_0x270a88=await _0x5aa49c['screenshot']({'type':_0x181bf3[_0x5b85cb(0x2a1)],'clip':{'x':0x0,'y':0x0,'width':_0x526524,'height':_0x4b9b99},'omitBackground':!0x1});await _0x573d73[_0x5b85cb(0x22c)]();const _0x47b573=_0x40e742[_0x5b85cb(0x264)][_0x5b85cb(0x2eb)](/\//g,'');_0x33e40e[_0x5b85cb(0x22e)](0xc8,{'Content-Type':_0x181bf3['SCNBn'],'Content-Disposition':'attachment;\x20filename='+_0x47b573+_0x5b85cb(0x1f8),'Content-Length':_0x270a88[_0x5b85cb(0x317)]}),_0x33e40e[_0x5b85cb(0x204)](_0x270a88);}}}}else{const _0x3f3215=_0x17dfb7['body'],_0x1b4a80=_0x4f63d1[_0x5b85cb(0x25e)];return _0x1a2be0[_0x5b85cb(0x258)](_0x3f3215['scrollHeight'],_0x3f3215['offsetHeight'],_0x1b4a80[_0x5b85cb(0x34f)],_0x1b4a80[_0x5b85cb(0x20d)],_0x1b4a80[_0x5b85cb(0x313)]);}}catch(_0x60acff){_0x181bf3['zPMYj'](_0x181bf3[_0x5b85cb(0x284)],_0x181bf3[_0x5b85cb(0x284)])?AgCFQs['jlPUi'](_0x46cbdd,'0'):(console[_0x5b85cb(0x340)](_0x181bf3[_0x5b85cb(0x26f)],_0x60acff),_0x33e40e[_0x5b85cb(0x1dc)](JSON[_0x5b85cb(0x20f)]({'isPrint':!0x1,'class':_0x181bf3[_0x5b85cb(0x29b)],'msg':_0x60acff[_0x5b85cb(0x237)]})));}finally{if(_0x181bf3[_0x5b85cb(0x25b)](_0x181bf3['wScgm'],_0x181bf3['wScgm'])){const _0xb986fb=_0x395bfa[_0x5b85cb(0x2fe)][_0x5b85cb(0x2ed)]['bind'](_0x3ff6cd),_0x37674c=_0x21f4a2[_0x4f1d10],_0xa4268c=_0x4f2c95[_0x37674c]||_0xb986fb;_0xb986fb[_0x5b85cb(0x1f4)]=_0x228a58[_0x5b85cb(0x2ee)](_0x3e3319),_0xb986fb[_0x5b85cb(0x2bb)]=_0xa4268c['toString'][_0x5b85cb(0x2ee)](_0xa4268c),_0x3aa993[_0x37674c]=_0xb986fb;}else _0x6214c5['close']();}}),y['post'](B,_0x311066['isAuth'],async(_0x1309b3,_0x36d43f)=>{const _0x2ac812=_0x2172b5,_0x32050e={'OBgxG':_0x2ac812(0x200),'tgKmO':function(_0x34e29e,_0x25a370){return _0x34e29e==_0x25a370;},'NEnAN':_0x2ac812(0x288),'GzOfN':_0x2ac812(0x24f),'mDwwv':function(_0x106a05,_0x25e451){return _0x106a05==_0x25e451;},'VLGQd':'finish','rOjwF':_0x2ac812(0x2de),'dpyjg':function(_0x3e4221,_0x44a5bd){return _0x3e4221===_0x44a5bd;},'DWwNP':function(_0x341c38,_0x361b6f){return _0x341c38==_0x361b6f;},'EsQlD':_0x2ac812(0x2da),'Pxsdx':function(_0x5ac457,_0x23ccbb){return _0x5ac457==_0x23ccbb;},'WPHKy':_0x2ac812(0x339),'UwTLk':function(_0x42d524,_0x5a648d){return _0x42d524!==_0x5a648d;},'YUkkZ':_0x2ac812(0x1f2),'UCMbZ':function(_0x3fda1d,_0x48f459){return _0x3fda1d==_0x48f459;},'QuGal':function(_0x1ba13d,_0x2bc3ba){return _0x1ba13d==_0x2bc3ba;},'ffIyB':function(_0x1836ec,_0x1d2793){return _0x1836ec>_0x1d2793;},'tJXEd':_0x2ac812(0x253),'eAvIm':_0x2ac812(0x282),'uDqFT':_0x2ac812(0x275),'kphzM':function(_0x1cc56d,_0x37e6b8){return _0x1cc56d<_0x37e6b8;},'apXSe':'yellow'},_0x376fef=new _0xd75162(global['dbUrl']);try{const _0x10916a=await $[_0x2ac812(0x220)](_0x1309b3);await m['getMainDocPathObj'](_0x1309b3,_0x36d43f,_0x10916a[_0x2ac812(0x27c)]);const {collectionName:_0x92c277}=m[_0x2ac812(0x263)](_0x1309b3[_0x2ac812(0x2ea)]),{docId:_0x41657e,action:_0x3913d7}=_0x1309b3[_0x2ac812(0x320)],_0x58e5fc=_0x32050e[_0x2ac812(0x306)](_0x3913d7,_0x32050e[_0x2ac812(0x2c7)])?_0x32050e[_0x2ac812(0x24e)]:_0x32050e[_0x2ac812(0x1e5)](_0x3913d7,_0x32050e[_0x2ac812(0x225)])?'จบ':'';if(!_0x41657e||![_0x32050e['VLGQd'],_0x32050e[_0x2ac812(0x2c7)]]['includes'](_0x3913d7))return _0x36d43f[_0x2ac812(0x1dc)](JSON['stringify']({'isStatus':!0x1,'class':_0x32050e['OBgxG'],'msg':_0x32050e[_0x2ac812(0x286)]}));const _0x11c4a3={'docId':_0x41657e,'userId':_0x10916a['userId']},_0x27f366=_0x376fef['db'](global['dbName'])['collection'](_0x92c277),_0x19a531=await _0x27f366[_0x2ac812(0x2a0)](_0x11c4a3);if(!_0x19a531)return _0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e['OBgxG'],'msg':_0x2ac812(0x22a)+_0x41657e+_0x2ac812(0x281)+_0x58e5fc+_0x2ac812(0x21b)}));const _0x4b4ea7=_0x19a531[_0x2ac812(0x210)];if(_0x32050e[_0x2ac812(0x2c2)](_0x3913d7,_0x32050e['NEnAN'])&&!(_0x32050e['DWwNP'](_0x4b4ea7,0x1)||_0x32050e['mDwwv'](_0x4b4ea7,0x2)))return _0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x32050e['EsQlD']}));if(_0x32050e[_0x2ac812(0x2c2)](_0x3913d7,_0x32050e[_0x2ac812(0x225)])&&_0x32050e[_0x2ac812(0x2ac)](!_0x4b4ea7,0x1))return _0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x32050e[_0x2ac812(0x304)]}));if(_0x32050e[_0x2ac812(0x2ac)](_0x3913d7,_0x32050e[_0x2ac812(0x2c7)])){if(_0x32050e[_0x2ac812(0x219)](_0x32050e[_0x2ac812(0x1f7)],_0x32050e[_0x2ac812(0x1f7)]))return _0x5d056b[_0x2ac812(0x340)](_0xc3b5a1),_0x302bf6[_0x2ac812(0x1dc)](_0xac9a86['stringify']({'isLoad':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x5670c2[_0x2ac812(0x237)]}));else{if(_0x32050e[_0x2ac812(0x1e5)](_0x19a531[_0x2ac812(0x212)],!0x1))return _0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x2ac812(0x240)+_0x41657e+_0x2ac812(0x33f)}));if(_0x32050e[_0x2ac812(0x224)]((await m['check_DocDateTime_CanCancel'](_0x19a531,_0x92c277,_0x10916a[_0x2ac812(0x1ff)]))[_0x2ac812(0x212)],!0x1))return _0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x2ac812(0x240)+_0x41657e+_0x2ac812(0x33f)}));}}if(_0x32050e['tgKmO'](_0x3913d7,_0x32050e[_0x2ac812(0x2c7)]))var _0x31a2ac=0xa;else{if(_0x32050e[_0x2ac812(0x332)](_0x3913d7,_0x32050e[_0x2ac812(0x225)]))var _0x31a2ac=0x2;}const _0x5d2e05=await _0x27f366[_0x2ac812(0x32c)](_0x11c4a3,{'$set':{'docStatusNumber':_0x31a2ac}});var _0x211943=_0x58e5fc+'\x20\x22'+_0x41657e+'\x22\x20เรียบร้อยแล้ว';if(_0x5d2e05['matchedCount']||_0x32050e['ffIyB'](_0x5d2e05[_0x2ac812(0x28a)],0x0)){const _0x17b611=u[_0x2ac812(0x347)]({'docStatusNumber':_0x4b4ea7},{'docStatusNumber':_0x31a2ac});if(_0x32050e[_0x2ac812(0x27f)](_0x17b611['length'],0x0)){if(_0x32050e[_0x2ac812(0x219)](_0x32050e[_0x2ac812(0x34d)],_0x32050e[_0x2ac812(0x34d)]))return!![];else{const _0xd3956b={'dateTime':E[_0x2ac812(0x25d)](),'userId':_0x10916a[_0x2ac812(0x1ff)],'userFullname':_0x10916a[_0x2ac812(0x2be)],'changes':_0x17b611};await _0x27f366[_0x2ac812(0x32c)]({'docId':_0x41657e},{'$push':{'changesHistory':{'$each':[_0xd3956b],'$position':0x0}}}),_0x211943+=_0x32050e[_0x2ac812(0x324)];}}return _0x36d43f['send'](JSON['stringify']({'isStatus':!0x0,'docId':_0x41657e,'docStatusNumber':_0x31a2ac,'class':_0x32050e[_0x2ac812(0x33b)],'msg':_0x211943}));}else{if(_0x5d2e05[_0x2ac812(0x312)]&&_0x32050e[_0x2ac812(0x208)](_0x5d2e05[_0x2ac812(0x28a)],0x1))return _0x36d43f[_0x2ac812(0x1dc)](JSON['stringify']({'isStatus':!0x1,'docId':_0x41657e,'docStatusNumber':_0x4b4ea7,'class':_0x32050e[_0x2ac812(0x1ea)],'msg':'\x22'+_0x41657e+_0x2ac812(0x2d6)}));}}catch(_0x252e28){console['log'](_0x252e28),_0x36d43f[_0x2ac812(0x1dc)](JSON[_0x2ac812(0x20f)]({'isStatus':!0x1,'class':_0x32050e[_0x2ac812(0x2ae)],'msg':_0x252e28[_0x2ac812(0x237)]}));}finally{_0x376fef['close']();}});export default y;function _0x4754aa(_0x39330f){const _0x90c251=_0x2172b5,_0x1c4326={'MaKiR':function(_0x4b9763,_0x5ad55d){return _0x4b9763===_0x5ad55d;},'RXexQ':_0x90c251(0x329),'zJiVy':_0x90c251(0x239),'YButv':_0x90c251(0x21f),'AteSx':function(_0xcf23dc,_0x48d08e){return _0xcf23dc!==_0x48d08e;},'MJElY':function(_0x4b750b,_0x559ae9){return _0x4b750b+_0x559ae9;},'TzWWM':function(_0x115676,_0x2bd535){return _0x115676/_0x2bd535;},'MHYLt':_0x90c251(0x317),'AAnHf':function(_0x461703,_0x45017b){return _0x461703===_0x45017b;},'XxSoQ':function(_0x5d3799,_0x262db7){return _0x5d3799%_0x262db7;},'SEerY':function(_0x3eb028,_0x4dfbbf){return _0x3eb028+_0x4dfbbf;},'qwhie':_0x90c251(0x2f9),'suEpS':'gger','MptHq':_0x90c251(0x2ce),'zHuFr':function(_0x340f20,_0x35dcee){return _0x340f20+_0x35dcee;},'QzkPK':_0x90c251(0x223),'Akgop':function(_0x5dd25e,_0x277382){return _0x5dd25e(_0x277382);}};function _0xacdd56(_0x37af2c){const _0x1b1846=_0x90c251;if(_0x1c4326['MaKiR'](typeof _0x37af2c,_0x1c4326[_0x1b1846(0x352)]))return function(_0x36a6f0){}['constructor'](_0x1c4326['zJiVy'])['apply'](_0x1c4326[_0x1b1846(0x301)]);else _0x1c4326[_0x1b1846(0x2f1)](_0x1c4326['MJElY']('',_0x1c4326[_0x1b1846(0x2e5)](_0x37af2c,_0x37af2c))[_0x1c4326['MHYLt']],0x1)||_0x1c4326[_0x1b1846(0x2a5)](_0x1c4326[_0x1b1846(0x2f6)](_0x37af2c,0x14),0x0)?function(){return!![];}[_0x1b1846(0x2fe)](_0x1c4326[_0x1b1846(0x2fc)](_0x1c4326[_0x1b1846(0x25a)],_0x1c4326['suEpS']))[_0x1b1846(0x353)](_0x1c4326['MptHq']):function(){return![];}[_0x1b1846(0x2fe)](_0x1c4326[_0x1b1846(0x2f4)](_0x1c4326[_0x1b1846(0x25a)],_0x1c4326[_0x1b1846(0x1df)]))[_0x1b1846(0x2e1)](_0x1c4326[_0x1b1846(0x2c3)]);_0x1c4326[_0x1b1846(0x242)](_0xacdd56,++_0x37af2c);}try{if(_0x39330f)return _0xacdd56;else _0x1c4326['Akgop'](_0xacdd56,0x0);}catch(_0x1f5a66){}}