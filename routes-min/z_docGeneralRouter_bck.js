const _0x204218=_0x59ff;(function(_0x56f780,_0xe5a9f2){const _0x3c07c8=_0x59ff,_0x1730e4=_0x56f780();while(!![]){try{const _0x20130a=-parseInt(_0x3c07c8(0x24f))/0x1+parseInt(_0x3c07c8(0x131))/0x2+-parseInt(_0x3c07c8(0x129))/0x3+-parseInt(_0x3c07c8(0x260))/0x4*(-parseInt(_0x3c07c8(0x276))/0x5)+-parseInt(_0x3c07c8(0x13f))/0x6+parseInt(_0x3c07c8(0x199))/0x7+parseInt(_0x3c07c8(0x1f9))/0x8*(parseInt(_0x3c07c8(0x1c5))/0x9);if(_0x20130a===_0xe5a9f2)break;else _0x1730e4['push'](_0x1730e4['shift']());}catch(_0x3cd2fe){_0x1730e4['push'](_0x1730e4['shift']());}}}(_0x11b5,0x6f0ef));const _0x5f8d4e=(function(){const _0x233dd6=_0x59ff,_0x1ab014={'PQLuw':function(_0x49671a,_0x53a66c){return _0x49671a!==_0x53a66c;},'hIMuv':_0x233dd6(0x19f),'xHERo':function(_0x4e8b23,_0x12817e){return _0x4e8b23===_0x12817e;},'bVoFm':_0x233dd6(0x1e4),'JwMkM':_0x233dd6(0x1fd),'pBIex':function(_0x19c7a4){return _0x19c7a4();},'iMdaN':function(_0x296589,_0x29c6f7){return _0x296589(_0x29c6f7);},'fxaQG':_0x233dd6(0x116),'dWVtz':'tZCPx'};let _0x4f79f2=!![];return function(_0x306531,_0x102ca9){const _0x3845d1=_0x233dd6,_0x2aacd0={'IyVKL':_0x1ab014['JwMkM'],'xAcFK':function(_0x5bc0bf){const _0x55efe4=_0x59ff;return _0x1ab014[_0x55efe4(0x15a)](_0x5bc0bf);},'RZXxV':function(_0x300f49,_0x44e91b){const _0x745708=_0x59ff;return _0x1ab014[_0x745708(0x12c)](_0x300f49,_0x44e91b);}};if(_0x1ab014[_0x3845d1(0x19e)](_0x1ab014[_0x3845d1(0x214)],_0x1ab014[_0x3845d1(0x1c8)]))return _0x3785e7[_0x3845d1(0x215)](_0x380f06),_0x3b9fb1['send'](_0x347ab8['stringify']({'isLoad':!0x1,'class':_0x2aacd0[_0x3845d1(0x1d0)],'msg':_0x2d3bdf['message']}));else{const _0x422822=_0x4f79f2?function(){const _0xddbcfa=_0x3845d1;if(_0x1ab014['PQLuw'](_0x1ab014['hIMuv'],_0x1ab014['hIMuv']))_0x2aacd0[_0xddbcfa(0x1bd)](_0x4c3a3c);else{if(_0x102ca9){if(_0x1ab014[_0xddbcfa(0x19e)](_0x1ab014[_0xddbcfa(0x243)],_0x1ab014[_0xddbcfa(0x243)])){const _0x3bf011=_0x102ca9[_0xddbcfa(0x173)](_0x306531,arguments);return _0x102ca9=null,_0x3bf011;}else _0x2aacd0[_0xddbcfa(0x1cf)](_0x5f0d43,'0');}}}:function(){};return _0x4f79f2=![],_0x422822;}};}());(function(){const _0x14cead=_0x59ff,_0x5d4475={'DmseO':function(_0x2c2848,_0x59b4a7){return _0x2c2848(_0x59b4a7);},'KFWry':function(_0x28418f,_0x3e166b){return _0x28418f+_0x3e166b;},'rVqhZ':function(_0x3285d5,_0x129f59){return _0x3285d5+_0x129f59;},'mqklg':_0x14cead(0x207),'omKIv':'{}.constructor(\x22return\x20this\x22)(\x20)','aYNBd':function(_0xd3865a){return _0xd3865a();},'HLrAa':_0x14cead(0x215),'yNTkd':_0x14cead(0x1ad),'SLMNr':_0x14cead(0x118),'eVcMU':'error','mSnUj':_0x14cead(0x193),'IKNFV':_0x14cead(0x19a),'BtNDZ':'trace','TpyRI':function(_0x41b3c6,_0x4088f0){return _0x41b3c6<_0x4088f0;},'mSIrz':function(_0x317cad,_0x1b239b){return _0x317cad!==_0x1b239b;},'vJLtS':_0x14cead(0x160),'djGIr':'kJYAL','CrbOr':_0x14cead(0x143),'gqQAY':_0x14cead(0x1a9),'BKXzw':'init','Xuatc':function(_0x4fc406,_0x26550b){return _0x4fc406+_0x26550b;},'WGrRH':_0x14cead(0x26c),'XRQUB':function(_0x11122d,_0x358dec){return _0x11122d+_0x358dec;},'wMJkh':_0x14cead(0x133),'HGiGx':function(_0x563e88,_0x2b7b36){return _0x563e88!==_0x2b7b36;},'bmZDH':'fhGzK','BpUDa':_0x14cead(0x283),'jqKYN':function(_0x4fd9b6,_0x233ca5){return _0x4fd9b6===_0x233ca5;},'kRkva':_0x14cead(0x238),'tsovE':function(_0xf7eca6){return _0xf7eca6();},'NJzTg':function(_0x24811e,_0x237edf,_0x53896a){return _0x24811e(_0x237edf,_0x53896a);}};_0x5d4475[_0x14cead(0x1e9)](_0x5f8d4e,this,function(){const _0x9677ff=_0x14cead;if(_0x5d4475[_0x9677ff(0x25a)](_0x5d4475[_0x9677ff(0x22e)],_0x5d4475['djGIr'])){const _0x48e946=new RegExp(_0x5d4475[_0x9677ff(0x1cc)]),_0x5beb59=new RegExp(_0x5d4475[_0x9677ff(0x167)],'i'),_0x4137ac=_0x5d4475[_0x9677ff(0x22f)](_0x455afd,_0x5d4475[_0x9677ff(0x202)]);if(!_0x48e946[_0x9677ff(0x252)](_0x5d4475[_0x9677ff(0x278)](_0x4137ac,_0x5d4475['WGrRH']))||!_0x5beb59[_0x9677ff(0x252)](_0x5d4475['XRQUB'](_0x4137ac,_0x5d4475[_0x9677ff(0x13d)])))_0x5d4475['HGiGx'](_0x5d4475[_0x9677ff(0x1d6)],_0x5d4475[_0x9677ff(0x222)])?_0x5d4475['DmseO'](_0x4137ac,'0'):_0x16d1d2[_0x9677ff(0x21f)]();else{if(_0x5d4475[_0x9677ff(0x18c)](_0x5d4475['kRkva'],_0x5d4475['kRkva']))_0x5d4475[_0x9677ff(0x1c1)](_0x455afd);else{let _0x5d14bf;try{const _0x1ceefc=_0x5d4475[_0x9677ff(0x22f)](_0x16301b,_0x5d4475[_0x9677ff(0x1a6)](_0x5d4475[_0x9677ff(0x22c)](_0x5d4475[_0x9677ff(0x280)],_0x5d4475[_0x9677ff(0x273)]),');'));_0x5d14bf=_0x5d4475[_0x9677ff(0x186)](_0x1ceefc);}catch(_0x32152f){_0x5d14bf=_0x31845b;}const _0x577ad6=_0x5d14bf['console']=_0x5d14bf[_0x9677ff(0x15c)]||{},_0x299e55=[_0x5d4475[_0x9677ff(0x206)],_0x5d4475[_0x9677ff(0x190)],_0x5d4475[_0x9677ff(0x18d)],_0x5d4475[_0x9677ff(0x1b0)],_0x5d4475[_0x9677ff(0x272)],_0x5d4475[_0x9677ff(0x269)],_0x5d4475[_0x9677ff(0x23e)]];for(let _0x12dbcb=0x0;_0x5d4475['TpyRI'](_0x12dbcb,_0x299e55[_0x9677ff(0x142)]);_0x12dbcb++){const _0x189fd7=_0x538cce[_0x9677ff(0x1c9)][_0x9677ff(0x263)][_0x9677ff(0x220)](_0xcf6144),_0x27c857=_0x299e55[_0x12dbcb],_0x53ff27=_0x577ad6[_0x27c857]||_0x189fd7;_0x189fd7[_0x9677ff(0x1f7)]=_0x6fc4b0[_0x9677ff(0x220)](_0x5e9da2),_0x189fd7[_0x9677ff(0x123)]=_0x53ff27[_0x9677ff(0x123)]['bind'](_0x53ff27),_0x577ad6[_0x27c857]=_0x189fd7;}}}}else{const _0x275f43=_0x181684[_0x9677ff(0x173)](_0x300f23,arguments);return _0x12d40f=null,_0x275f43;}})();}());const _0x2c2d01=(function(){const _0x4e2575=_0x59ff,_0x3e2cd1={'fZIIh':'red','ooMJy':_0x4e2575(0x143),'dTMbj':_0x4e2575(0x1a9),'luwys':function(_0x229f21,_0x12c231){return _0x229f21(_0x12c231);},'eyTYN':_0x4e2575(0x27a),'UHDkw':function(_0x2d09a5,_0xce3a68){return _0x2d09a5+_0xce3a68;},'EUBgU':_0x4e2575(0x26c),'dPulL':_0x4e2575(0x133),'sdMAL':function(_0x327e91){return _0x327e91();},'sevDG':_0x4e2575(0x207),'GkoNE':'{}.constructor(\x22return\x20this\x22)(\x20)','slaXr':function(_0x28a52e,_0x135a14){return _0x28a52e!==_0x135a14;},'SlpBq':'cKuIw','fjRDb':_0x4e2575(0x189),'kxZBU':_0x4e2575(0x234),'yKYJB':_0x4e2575(0x11a),'DUPqY':function(_0x4b1218,_0x26541b){return _0x4b1218!==_0x26541b;},'zKLQG':_0x4e2575(0x137)};let _0x217815=!![];return function(_0xe35e33,_0x3a1ef2){const _0x3e785d=_0x4e2575,_0x24f76c={'fUMfg':_0x3e2cd1[_0x3e785d(0x141)],'PispU':_0x3e2cd1['dTMbj'],'ilBRZ':function(_0xb75f58,_0x13c91a){const _0x5bdcf5=_0x3e785d;return _0x3e2cd1[_0x5bdcf5(0x115)](_0xb75f58,_0x13c91a);},'atDjy':_0x3e2cd1['eyTYN'],'ySeHj':function(_0x1521fb,_0x2c745a){const _0x46a01e=_0x3e785d;return _0x3e2cd1[_0x46a01e(0x132)](_0x1521fb,_0x2c745a);},'wvola':_0x3e2cd1['EUBgU'],'LCpay':_0x3e2cd1['dPulL'],'UpZtz':function(_0x266e20){const _0x5be825=_0x3e785d;return _0x3e2cd1[_0x5be825(0x1c0)](_0x266e20);},'bMIVw':_0x3e2cd1[_0x3e785d(0x201)],'kYWpr':_0x3e2cd1[_0x3e785d(0x170)],'ECIWL':function(_0x2be802){const _0x2be9a6=_0x3e785d;return _0x3e2cd1[_0x2be9a6(0x1c0)](_0x2be802);},'nRLpS':function(_0x55feb0,_0x36a325){const _0x3ae460=_0x3e785d;return _0x3e2cd1[_0x3ae460(0x23c)](_0x55feb0,_0x36a325);},'hoZax':_0x3e2cd1['SlpBq'],'aenNp':_0x3e2cd1[_0x3e785d(0x1df)],'zJoZk':function(_0xd62f55,_0x4b1b16){const _0x21eeb5=_0x3e785d;return _0x3e2cd1[_0x21eeb5(0x23c)](_0xd62f55,_0x4b1b16);},'lfrzW':_0x3e2cd1[_0x3e785d(0x27e)],'auXRm':_0x3e2cd1['yKYJB']};if(_0x3e2cd1['DUPqY'](_0x3e2cd1[_0x3e785d(0x125)],_0x3e2cd1[_0x3e785d(0x125)]))_0xd148d1['log'](_0x20c822),_0x3cdcda[_0x3e785d(0x216)](_0x442997[_0x3e785d(0x18f)]({'isStatus':!0x1,'class':_0x3e2cd1[_0x3e785d(0x19d)],'msg':_0x3f4e7b['message']}));else{const _0x4e6f5b=_0x217815?function(){const _0x130cfe=_0x3e785d,_0x158639={'dMGCc':_0x24f76c['fUMfg'],'eFlRm':_0x24f76c['PispU'],'EgxIL':function(_0x43d3c8,_0x122722){return _0x24f76c['ilBRZ'](_0x43d3c8,_0x122722);},'MTshl':_0x24f76c['atDjy'],'CAgjG':function(_0x7b71e,_0x7b364c){const _0x5a41d8=_0x59ff;return _0x24f76c[_0x5a41d8(0x22d)](_0x7b71e,_0x7b364c);},'qyPGS':_0x24f76c['wvola'],'XTqMd':_0x24f76c[_0x130cfe(0x144)],'CAQus':function(_0x401db3,_0x3fb987){const _0x4f53ee=_0x130cfe;return _0x24f76c[_0x4f53ee(0x1da)](_0x401db3,_0x3fb987);},'AEjcy':function(_0x34c3b4){const _0x3dc5ab=_0x130cfe;return _0x24f76c[_0x3dc5ab(0x1b1)](_0x34c3b4);},'IlrYo':function(_0x3a2423,_0x4a95ef){const _0x4b0219=_0x130cfe;return _0x24f76c[_0x4b0219(0x1da)](_0x3a2423,_0x4a95ef);},'JTeSM':function(_0x14e166,_0x3743d1){return _0x24f76c['ySeHj'](_0x14e166,_0x3743d1);},'kXsGu':_0x24f76c[_0x130cfe(0x25e)],'TEidC':_0x24f76c[_0x130cfe(0x119)],'JaGpY':function(_0x5f0609){const _0x494912=_0x130cfe;return _0x24f76c[_0x494912(0x14e)](_0x5f0609);}};if(_0x24f76c[_0x130cfe(0x1db)](_0x24f76c['hoZax'],_0x24f76c[_0x130cfe(0x102)])){if(_0x3a1ef2){if(_0x24f76c[_0x130cfe(0x185)](_0x24f76c['lfrzW'],_0x24f76c[_0x130cfe(0x1bf)])){const _0x53f467=_0x3a1ef2[_0x130cfe(0x173)](_0xe35e33,arguments);return _0x3a1ef2=null,_0x53f467;}else{const _0x2fa5b2=new _0x84cfce(_0x158639[_0x130cfe(0x145)]),_0x2e5581=new _0x1ff5e7(_0x158639[_0x130cfe(0x21b)],'i'),_0x4df1d4=_0x158639[_0x130cfe(0x15f)](_0x4cb300,_0x158639[_0x130cfe(0x1f2)]);!_0x2fa5b2[_0x130cfe(0x252)](_0x158639[_0x130cfe(0x15e)](_0x4df1d4,_0x158639[_0x130cfe(0x1dd)]))||!_0x2e5581['test'](_0x158639['CAgjG'](_0x4df1d4,_0x158639[_0x130cfe(0x21c)]))?_0x158639[_0x130cfe(0x130)](_0x4df1d4,'0'):_0x158639[_0x130cfe(0x231)](_0x537034);}}}else{const _0x3f29a9=_0x158639[_0x130cfe(0x23f)](_0x1320a8,_0x158639[_0x130cfe(0x15e)](_0x158639[_0x130cfe(0x200)](_0x158639['kXsGu'],_0x158639['TEidC']),');'));_0x328dc0=_0x158639[_0x130cfe(0x1ed)](_0x3f29a9);}}:function(){};return _0x217815=![],_0x4e6f5b;}};}()),_0x4d8bad=_0x2c2d01(this,function(){const _0x4c0838=_0x59ff,_0x2c6cd7={'WJwhR':function(_0x1a990a,_0x51daa7){return _0x1a990a(_0x51daa7);},'qfjNe':function(_0x220316,_0x274f23){return _0x220316!==_0x274f23;},'dxxGH':_0x4c0838(0x180),'IfbTA':'jvOAK','QtbBH':function(_0x308282,_0x2e2eb8){return _0x308282(_0x2e2eb8);},'dIqBV':function(_0x3e8a5e,_0x4d6f78){return _0x3e8a5e+_0x4d6f78;},'MLPVY':function(_0x1a9bbd,_0x593885){return _0x1a9bbd+_0x593885;},'tWjQM':'return\x20(function()\x20','IbdQr':_0x4c0838(0x1fe),'EVAOt':function(_0x23f421){return _0x23f421();},'AupjF':function(_0xaf7598,_0x2140a5){return _0xaf7598===_0x2140a5;},'hNzjo':_0x4c0838(0x14c),'JKmPC':'log','dmPOk':_0x4c0838(0x1ad),'AkJbq':_0x4c0838(0x118),'ALMbz':'error','KXPSd':_0x4c0838(0x193),'xFcFD':_0x4c0838(0x19a),'bUgyA':_0x4c0838(0x19b),'AepNa':function(_0x14089b,_0x21cd6e){return _0x14089b<_0x21cd6e;},'KWVrG':'cXXgi','njTkE':'LsWyB'};let _0x40453e;try{if(_0x2c6cd7[_0x4c0838(0x1f0)](_0x2c6cd7[_0x4c0838(0x182)],_0x2c6cd7[_0x4c0838(0x140)])){const _0x532217=_0x2c6cd7[_0x4c0838(0x122)](Function,_0x2c6cd7[_0x4c0838(0x159)](_0x2c6cd7[_0x4c0838(0x254)](_0x2c6cd7['tWjQM'],_0x2c6cd7[_0x4c0838(0x12d)]),');'));_0x40453e=_0x2c6cd7['EVAOt'](_0x532217);}else{const _0x1da1d8=_0x27c721[_0x4c0838(0x173)](_0x5ed9c0,arguments);return _0xb139b9=null,_0x1da1d8;}}catch(_0x26ee4a){_0x2c6cd7[_0x4c0838(0x110)](_0x2c6cd7[_0x4c0838(0x1b7)],_0x2c6cd7[_0x4c0838(0x1b7)])?_0x40453e=window:_0x1d65dd['close']();}const _0x59aa09=_0x40453e[_0x4c0838(0x15c)]=_0x40453e[_0x4c0838(0x15c)]||{},_0x550b64=[_0x2c6cd7[_0x4c0838(0x267)],_0x2c6cd7['dmPOk'],_0x2c6cd7[_0x4c0838(0x1cb)],_0x2c6cd7[_0x4c0838(0x233)],_0x2c6cd7[_0x4c0838(0x270)],_0x2c6cd7[_0x4c0838(0x1d4)],_0x2c6cd7['bUgyA']];for(let _0x2025c5=0x0;_0x2c6cd7[_0x4c0838(0x23a)](_0x2025c5,_0x550b64['length']);_0x2025c5++){if(_0x2c6cd7[_0x4c0838(0x110)](_0x2c6cd7['KWVrG'],_0x2c6cd7[_0x4c0838(0x10e)]))_0x2c6cd7[_0x4c0838(0x26f)](_0x33e496,0x0);else{const _0x14c84d=_0x2c2d01[_0x4c0838(0x1c9)]['prototype'][_0x4c0838(0x220)](_0x2c2d01),_0x579bfe=_0x550b64[_0x2025c5],_0x315d8e=_0x59aa09[_0x579bfe]||_0x14c84d;_0x14c84d[_0x4c0838(0x1f7)]=_0x2c2d01['bind'](_0x2c2d01),_0x14c84d[_0x4c0838(0x123)]=_0x315d8e[_0x4c0838(0x123)][_0x4c0838(0x220)](_0x315d8e),_0x59aa09[_0x579bfe]=_0x14c84d;}}});_0x4d8bad();import _0x3cad11 from'express';const b=_0x3cad11[_0x204218(0x158)]();function _0x11b5(){const _0x50947e=['BQzNQ','gqQAY','KVBXw','toArray','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','originalUrl','WnUzI','QFjXq','ZpWLe','mJCCb','GkoNE','เอกสารที่ตันเองไม่ได้สร้าง','/load','apply','llDut','getUserBranchesById','EiCCz','gger','azNnK','asxgk','wEjlc','HvKNc','ZaDFw','doc_changes.ejs','findOne','ไม่พบเอกสารเลขที่\x20\x22','EGOYv','aBmdE','dxxGH','getMainDocPathObj','WlfOv','zJoZk','aYNBd','Jpuay','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','Ducgj','XJBZL','join','jqKYN','SLMNr','BZhWc','stringify','yNTkd','shzoJ','getUserData','exception','Jlpua','load-last','NTMfE','msxgN','active','3136385jfGzex','table','trace','XRUtE','fZIIh','xHERo','ZJofI','CETYp','WSNRi','XfiJu','includes','userId','bClqf','KFWry','mHpLu','DbDNj','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ไม่พบประวัติการเปลี่ยนแปลง','YNoGS','UxhTA','warn','WPrtV','/fetch/modal','eVcMU','UpZtz','coeAi','getChangeHistory','krwHI','pxQWo','error\x20===>\x20','hNzjo','hhJXS','wYGwv','ygZaA','formatDateTime','tsmEY','xAcFK','fyJtz','auXRm','sdMAL','tsovE','end','uDiXA','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','2529SDkqcZ','rZgrM','kNUHS','dWVtz','constructor','UTWzi','AkJbq','CrbOr','canEdit','/status','RZXxV','IyVKL','convert_DocPrint','tEUsn','DhfZa','xFcFD','sASYU','bmZDH','print','OqJhg','check_DocDateTime_CanCancel','ilBRZ','nRLpS','ไม่พบเอกสารล่าสุด','qyPGS','GRSQo','fjRDb','WchAd','WnoDo','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','zKLcM','NhBez','replace','kRrZm','jLVts','MaqdN','NJzTg','nVLgE','offsetHeight','bFNpw','JaGpY','DOC_TYPE','userAuthority','qfjNe','SWYrN','MTshl','qjyAJ','wewII','dbName','SPXej','__proto__','getItems_for_Modal','37024BhYOtt','zWiKd','gpycR','FFfIC','red','{}.constructor(\x22return\x20this\x22)(\x20)','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','JTeSM','sevDG','BKXzw','IVkJP','jXOha','KfmHs','HLrAa','return\x20(function()\x20','IEkDv','AWHJF','ยกเลิก','call','kxPRk','Qcqsd','CJBtR','HALKJ','isAuth','bOboA','YjoKm','cancel','fxaQG','log','send','max','rVwDq','BQDMD','jpeg','eFlRm','XTqMd','tISjQ','gcGtU','close','bind','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','BpUDa','ZkDCr','dateTimeCanCancel','/search','floor','LHetT','dateTimeCancelRemain','/changes','duVCC','JUJnN','rVqhZ','ySeHj','vJLtS','DmseO','RrIjF','AEjcy','PATH_WAREHOUSE_OUT','ALMbz','brydZ','EfHuK','jgjZz','nDjRv','JCfmf','pLevo','AepNa','uSbGL','slaXr','attachment;\x20filename=','BtNDZ','IlrYo','NfYYb','tsvOa','iWUkl','bVoFm','CSuYg','screenshot','MiUDd','gusVO','XPEFa','JYbHe','DAJFG','networkidle0','post','cAndl','ไม่พบเอกสาร\x20\x22','851130ekVUQC','/print','ROkTn','test','WzxeY','MLPVY','collection','VVrUC','connect','DWaMA','renderView','mSIrz','CWCct','\x22\x20{{sep}}เรียบร้อยแล้ว','PATH_SALES','bMIVw','sMdpA','38748amppsa','tNHwU','documentElement','prototype','green','lkPOO','string','JKmPC','YpORG','IKNFV','launch','hkLyI','chain','.jpeg','docId','WJwhR','KXPSd','/load-last','mSnUj','omKIv','dApDU','while\x20(true)\x20{}','5wLIolZ','KxhgC','Xuatc','scrollHeight','init','NOEtp','VrOJp','modifiedCount','kxZBU','get_StatusName_byStatusNumber','mqklg','rRgSt','bRPLd','eFmeg','get_Info_ByUrl','rkJqC','load','aenNp','sales','bnyDi','fAqgi','QuyHP','setViewport','bLQGx','PosRn','{{sep}}[บันทึกการแก้ไข]','nJOPX','body','dateTimeEditRemain','njTkE','nEjMm','AupjF','เอกสาร\x20\x22','yfqpC','changesHistory','stateObject','luwys','vlFsU','tpzfQ','info','kYWpr','RKtYU','formatDate','VZVJM','counter','CsoYZ','QfLOr','VCjQU','{{sep}}หรือไม่มีสิทธิ์','QtbBH','toString','YaJjU','zKLQG','evaluate','EDbhX','warehouseIn','2126997IliEEh','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','AlSHV','iMdaN','IbdQr','MTZla','iCEin','CAQus','826828jJdEij','UHDkw','input','diiqW','check_DocDateTime_CanEdit','CHgIk','iZzOf','updateOne','newPage','umKKw','fQopC','qZhBQ','wMJkh','yellow','939600xaucVG','IfbTA','ooMJy','length','function\x20*\x5c(\x20*\x5c)','LCpay','dMGCc','message','debu','userFullname','branchName','push','jQWOG','HjwJE','dbUrl','ECIWL','puppeteer','writeHead','canCancel','qaQMc','pFoCA','docStatusNumber','setContent','VjnVP','lKvCw','Router','dIqBV','pBIex','qisVb','console','โหลดเอกสารเลขที่\x20\x22','CAgjG','EgxIL','NVvPG','ekqin','XnnPG','\x20ไม่เปลี่ยนแปลง\x22','QWLNm','get'];_0x11b5=function(){return _0x50947e;};return _0x11b5();}import _0x5ddb5a from'path';import{MongoClient as _0x4714d5}from'mongodb';import _0xb06d71 from'../middleware/mainAuth.js';import*as _0x1de79a from'../mymodule/myUsers.js';import*as _0x5bfa9e from'../mymodule/myDateTime.js';import*as _0x32458a from'../mymodule/myModule.js';import*as _0x1a77da from'../mymodule/myDocMain.js';function _0x59ff(_0x594f4f,_0x143f63){const _0x460e23=_0x11b5();return _0x59ff=function(_0x4d8bad,_0x2c2d01){_0x4d8bad=_0x4d8bad-0xff;let _0xb3cc0f=_0x460e23[_0x4d8bad];return _0xb3cc0f;},_0x59ff(_0x594f4f,_0x143f63);}import*as _0x41dbb9 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0x204218(0x232)],p=global[_0x204218(0x25d)],M=[w+'/changes',S+_0x204218(0x229),p+_0x204218(0x229)],v=[w+_0x204218(0x250),S+_0x204218(0x250),p+_0x204218(0x250)],k=[w+_0x204218(0x1ce),S+_0x204218(0x1ce),p+_0x204218(0x1ce)],B=[w+'/search',S+'/search',p+_0x204218(0x225)],x=[w+_0x204218(0x172),S+_0x204218(0x172),p+_0x204218(0x172),w+_0x204218(0x271),S+_0x204218(0x271),p+_0x204218(0x271)],L=[w+_0x204218(0x1af),S+_0x204218(0x1af),p+_0x204218(0x1af)];b[_0x204218(0x165)](L,_0xb06d71[_0x204218(0x210)],async(_0x216b1f,_0xd79e56)=>{const _0x45f67b=_0x204218,_0xbd45cf={'VVrUC':function(_0x5bea92,_0xbc64df){return _0x5bea92+_0xbc64df;},'fQopC':_0x45f67b(0x147),'JUJnN':'gger','hkLyI':_0x45f67b(0x114),'RTApV':function(_0x566b7c,_0x2be8db){return _0x566b7c===_0x2be8db;},'VZVJM':_0x45f67b(0x191),'duVCC':_0x45f67b(0x1fa),'RrIjF':function(_0x1fac31,_0x3fc8be){return _0x1fac31==_0x3fc8be;},'MTZla':_0x45f67b(0x128),'DbDNj':'stock','dTKRF':function(_0x46b677,_0x234d62){return _0x46b677==_0x234d62;},'NfYYb':'warehouseOut','WSNRi':function(_0x5593b1,_0x5c3ced){return _0x5593b1==_0x5c3ced;},'BZhWc':_0x45f67b(0x103),'nEhTW':_0x45f67b(0x198),'qZhBQ':_0x45f67b(0x264),'YhYSE':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','uSbGL':function(_0x39d920,_0x378d6d){return _0x39d920!==_0x378d6d;},'DxGqH':'wZCvC','SWYrN':_0x45f67b(0x1f4),'OqJhg':_0x45f67b(0x1fd)},_0x5077c2=await _0x1de79a[_0x45f67b(0x192)](_0x216b1f),_0x459d2c=await _0x1a77da[_0x45f67b(0x183)](_0x216b1f,_0xd79e56,_0x5077c2[_0x45f67b(0x1ef)]);try{if(_0xbd45cf['RTApV'](_0xbd45cf[_0x45f67b(0x11c)],_0xbd45cf[_0x45f67b(0x22a)])){const _0x244562=_0x13cca9[_0x45f67b(0x10c)],_0xab1773=_0x4ff9fe[_0x45f67b(0x262)];return _0x490112[_0x45f67b(0x217)](_0x244562[_0x45f67b(0x279)],_0x244562[_0x45f67b(0x1eb)],_0xab1773['clientHeight'],_0xab1773['scrollHeight'],_0xab1773[_0x45f67b(0x1eb)]);}else{if(_0xbd45cf[_0x45f67b(0x230)](_0x459d2c['DOC_TYPE'],_0xbd45cf[_0x45f67b(0x12e)]))var _0x5a44ae=await _0x41dbb9[_0x45f67b(0x1f8)](_0xbd45cf[_0x45f67b(0x1a8)]);else{if(_0xbd45cf['dTKRF'](_0x459d2c[_0x45f67b(0x1ee)],_0xbd45cf[_0x45f67b(0x240)]))var _0x5a44ae=await _0x41dbb9[_0x45f67b(0x1f8)](_0xbd45cf[_0x45f67b(0x1a8)]);else{if(_0xbd45cf[_0x45f67b(0x1a1)](_0x459d2c[_0x45f67b(0x1ee)],_0xbd45cf[_0x45f67b(0x18e)]))var _0x5a44ae=await _0x41dbb9[_0x45f67b(0x1f8)](_0xbd45cf['nEhTW']);}}const _0x14e94b=await _0x41dbb9['getItemsCategory']();return _0xd79e56['send'](JSON[_0x45f67b(0x18f)]({'DATA_ITEMS':_0x5a44ae,'DATA_CATEGORY':_0x14e94b,'isFetch':!0x0,'class':_0xbd45cf[_0x45f67b(0x13c)],'msg':_0xbd45cf['YhYSE']}));}}catch(_0x991815){if(_0xbd45cf[_0x45f67b(0x23b)](_0xbd45cf['DxGqH'],_0xbd45cf[_0x45f67b(0x1f1)]))return console[_0x45f67b(0x215)](_0x991815),_0xd79e56['send'](JSON['stringify']({'isFetch':!0x1,'class':_0xbd45cf[_0x45f67b(0x1d8)],'msg':_0x991815[_0x45f67b(0x146)]}));else(function(){return![];}[_0x45f67b(0x1c9)](PlggZn[_0x45f67b(0x256)](PlggZn[_0x45f67b(0x13b)],PlggZn[_0x45f67b(0x22b)]))['apply'](PlggZn[_0x45f67b(0x26b)]));}}),b[_0x204218(0x24c)](B,_0xb06d71[_0x204218(0x210)],async(_0x558d74,_0x183799)=>{const _0x23f579=_0x204218,_0x47b1de={'IHNNB':function(_0x396478,_0x1dd2db){return _0x396478<_0x1dd2db;},'YaJjU':_0x23f579(0x13e),'qfoLW':_0x23f579(0x1ff),'rVwDq':function(_0x2958b2,_0x3fc8ef){return _0x2958b2===_0x3fc8ef;},'yfqpC':_0x23f579(0x20e),'Qcqsd':_0x23f579(0x16a),'MaCsY':function(_0x14f605,_0x5a9202){return _0x14f605+_0x5a9202;},'hHkxc':_0x23f579(0x264),'ROkTn':function(_0x524081,_0x1efc83){return _0x524081!==_0x1efc83;},'bRPLd':'ThyST','URBvF':_0x23f579(0x1fd),'EfHuK':'BxIQk'};let {sip:_0x49c8c6}=_0x558d74[_0x23f579(0x10c)];if(!_0x49c8c6&&_0x47b1de['IHNNB'](_0x49c8c6[_0x23f579(0x142)],0x2))return _0x183799[_0x23f579(0x216)](JSON[_0x23f579(0x18f)]({'isSearch':!0x1,'class':_0x47b1de[_0x23f579(0x124)],'msg':_0x47b1de['qfoLW']}));_0x49c8c6=_0x49c8c6[_0x23f579(0x1e5)](/[!@#$%^&*<>]/g,'')??null;const _0x539c65=await _0x1de79a[_0x23f579(0x192)](_0x558d74);await _0x1a77da[_0x23f579(0x183)](_0x558d74,_0x183799,_0x539c65[_0x23f579(0x1ef)]);const {collectionName:_0x2fa326}=_0x41dbb9['get_Info_ByUrl'](_0x558d74['originalUrl']),_0x198cff=new _0x4714d5(global['dbUrl']);try{if(_0x47b1de[_0x23f579(0x218)](_0x47b1de[_0x23f579(0x112)],_0x47b1de['yfqpC'])){await _0x198cff[_0x23f579(0x257)]();const _0x2d4d1d=_0x198cff['db'](global['dbName'])[_0x23f579(0x255)](_0x2fa326),_0x4a2925=[{'$or':[{'docId':{'$regex':_0x49c8c6,'$options':'i'}},{'docDate':{'$regex':_0x49c8c6,'$options':'i'}}]}];let _0x547811='';['O','S'][_0x23f579(0x1a3)](_0x539c65[_0x23f579(0x1ef)])||(_0x547811+=_0x47b1de[_0x23f579(0x20d)],_0x4a2925[_0x23f579(0x14a)]({'userId':_0x539c65[_0x23f579(0x1a4)]}));const _0x22904e=await _0x2d4d1d['aggregate']([{'$match':{'$and':_0x4a2925}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x23f579(0x169)]();return _0x547811=_0x47b1de['MaCsY']('พบ\x20\x22'+_0x22904e['length']+'\x22\x20เอกสาร',_0x547811),_0x183799[_0x23f579(0x216)](JSON[_0x23f579(0x18f)]({'searchFound':_0x22904e,'msg':_0x547811,'isSearch':!0x0,'class':_0x47b1de['hHkxc']}));}else _0x2380a9[_0x23f579(0x21f)]();}catch(_0x306858){if(_0x47b1de[_0x23f579(0x251)](_0x47b1de[_0x23f579(0x282)],_0x47b1de[_0x23f579(0x282)])){if(_0x4e40d5){const _0x35d6d0=_0x297944[_0x23f579(0x173)](_0x15cc7b,arguments);return _0x31c026=null,_0x35d6d0;}}else return console[_0x23f579(0x215)](_0x306858),_0x183799[_0x23f579(0x216)](JSON['stringify']({'isSearch':!0x1,'class':_0x47b1de['URBvF'],'msg':_0x306858[_0x23f579(0x146)]}));}finally{if(_0x47b1de[_0x23f579(0x251)](_0x47b1de[_0x23f579(0x235)],_0x47b1de[_0x23f579(0x235)])){const _0x154647=_0x8cf10f?function(){const _0x5cb282=_0x23f579;if(_0x529de1){const _0xc442ab=_0x5815f0[_0x5cb282(0x173)](_0x1f235f,arguments);return _0x4fd36d=null,_0xc442ab;}}:function(){};return _0x262c88=![],_0x154647;}else _0x198cff[_0x23f579(0x21f)]();}}),b['post'](x,_0xb06d71[_0x204218(0x210)],async(_0x5d6b11,_0x50c19e)=>{const _0x189010=_0x204218,_0xac8904={'LHetT':_0x189010(0x275),'mHpLu':'counter','XPEFa':'error\x20===>\x20','EiCCz':_0x189010(0x1fd),'SPXej':function(_0x109233,_0x101e48){return _0x109233===_0x101e48;},'NTMfE':_0x189010(0x281),'Jlpua':_0x189010(0x101),'WnUzI':function(_0x4fef89,_0x39f112){return _0x4fef89===_0x39f112;},'XAKKo':_0x189010(0x1e0),'bFNpw':_0x189010(0x24d),'pYVzU':function(_0x4de586,_0x4fecb2){return _0x4de586===_0x4fecb2;},'KxhgC':_0x189010(0x195),'pxQWo':_0x189010(0x1dc),'sASYU':function(_0x36dd99,_0x267ee2){return _0x36dd99==_0x267ee2;},'UAdzp':function(_0x52f1f9,_0x2f2ed7){return _0x52f1f9!==_0x2f2ed7;},'rkJqC':_0x189010(0x1de),'YhXYj':_0x189010(0x16d),'wYGwv':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','bClqf':_0x189010(0x223),'HvKNc':_0x189010(0x27b),'bLQGx':_0x189010(0x1e2),'lKvCw':'green','QuyHP':function(_0x1adbb8,_0x33541a){return _0x1adbb8===_0x33541a;},'XJBZL':'MisuA','PosRn':'TRMTk','sJhOX':function(_0x1b1436,_0x536596){return _0x1b1436!==_0x536596;},'XnnPG':_0x189010(0x1ba),'bOboA':_0x189010(0x247)};let {docId:_0x5c4db4,action:_0x2d0b52}=_0x5d6b11['body'];const _0x2a77df=await _0x1de79a['getUserData'](_0x5d6b11);await _0x1a77da['getMainDocPathObj'](_0x5d6b11,_0x50c19e,_0x2a77df[_0x189010(0x1ef)]);const {collectionName:_0x37852c}=_0x41dbb9[_0x189010(0xff)](_0x5d6b11['originalUrl']),_0x21d8b1=new _0x4714d5(global[_0x189010(0x14d)]);try{if(_0xac8904[_0x189010(0x1f6)](_0xac8904[_0x189010(0x196)],_0xac8904[_0x189010(0x196)])){await _0x21d8b1[_0x189010(0x257)]();const _0x44b378=_0x21d8b1['db'](global[_0x189010(0x1f5)])[_0x189010(0x255)](_0x37852c);if(_0xac8904[_0x189010(0x1f6)](_0x2d0b52,_0xac8904[_0x189010(0x194)])){if(_0xac8904['WnUzI'](_0xac8904['XAKKo'],_0xac8904[_0x189010(0x1ec)]))return function(_0x35798e){}['constructor'](qMirhN[_0x189010(0x227)])[_0x189010(0x173)](qMirhN[_0x189010(0x1a7)]);else{const _0x4c9773=['O','S'][_0x189010(0x1a3)](_0x2a77df[_0x189010(0x1ef)])?{'docId':_0x5c4db4}:{'docId':_0x5c4db4,'userId':_0x2a77df[_0x189010(0x1a4)]};var _0x669195=await _0x44b378['findOne'](_0x4c9773,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0xac8904['pYVzU'](_0x2d0b52,_0xac8904[_0x189010(0x277)]))var _0x669195=await _0x44b378[_0x189010(0x17e)]({'userId':_0x2a77df[_0x189010(0x1a4)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x590e65=_0x669195?'':_0xac8904[_0x189010(0x16c)](_0x2d0b52,_0xac8904[_0x189010(0x194)])?_0x189010(0x17f)+_0x5c4db4+'\x22':_0xac8904[_0x189010(0x1b5)];if(!_0x669195)return _0x50c19e[_0x189010(0x216)](JSON[_0x189010(0x18f)]({'isLoad':!0x1,'class':_0xac8904[_0x189010(0x176)],'msg':_0x590e65}));let _0x503410=_0x189010(0x15d)+_0x669195[_0x189010(0x26e)]+_0x189010(0x25c);if(_0xac8904[_0x189010(0x1d5)](_0x669195[_0x189010(0x154)],0x1)&&_0x669195['dateTimeCanEdit']){if(_0xac8904['UAdzp'](_0xac8904[_0x189010(0x100)],_0xac8904['YhXYj'])){let _0x501943=await _0x41dbb9[_0x189010(0x135)](_0x669195,_0x37852c,_0x2a77df[_0x189010(0x1a4)]);_0x669195[_0x189010(0x10d)]=_0x501943[_0x189010(0x10d)],_0xac8904[_0x189010(0x1d5)](_0x501943[_0x189010(0x1cd)],!0x1)&&(_0x669195[_0x189010(0x154)]=_0x501943[_0x189010(0x154)],_0x503410+=_0xac8904[_0x189010(0x1b9)]);}else _0x5128c1[_0x189010(0x215)](_0xac8904[_0x189010(0x248)],_0x2ace68),_0x42c83c[_0x189010(0x216)](_0x16e4d1['stringify']({'isPrint':!0x1,'class':_0xac8904['EiCCz'],'msg':_0x4d8edb[_0x189010(0x146)]}));}else _0x669195[_0x189010(0x10d)]='-';if((_0xac8904[_0x189010(0x1d5)](_0x669195[_0x189010(0x154)],0x1)||_0xac8904[_0x189010(0x1d5)](_0x669195[_0x189010(0x154)],0x2))&&_0x669195[_0x189010(0x224)]){if(_0xac8904[_0x189010(0x1f6)](_0xac8904[_0x189010(0x1a5)],_0xac8904[_0x189010(0x17b)]))return _0x4d142a;else{const _0x545f2a=await _0x41dbb9[_0x189010(0x1d9)](_0x669195,_0x37852c,_0x2a77df[_0x189010(0x1a4)]);_0x669195[_0x189010(0x228)]=_0x545f2a['dateTimeCancelRemain'],_0xac8904[_0x189010(0x1d5)](_0x545f2a[_0x189010(0x151)],!0x1)&&(_0x503410+=_0xac8904[_0x189010(0x108)]);}}else _0x669195[_0x189010(0x228)]='-';const {branchName:_0x5a9de9}=await _0x41dbb9[_0x189010(0x175)](_0x669195['branchId']);return _0x669195[_0x189010(0x149)]=_0x5a9de9,_0x50c19e[_0x189010(0x216)](JSON[_0x189010(0x18f)]({'doc':_0x669195,'isLoad':!0x0,'class':_0xac8904[_0x189010(0x157)],'msg':_0x503410}));}else _0x1e01b3=_0x933365;}catch(_0x148c16){if(_0xac8904[_0x189010(0x106)](_0xac8904[_0x189010(0x18a)],_0xac8904[_0x189010(0x109)]))_0x4f8fb7[_0x189010(0x21f)]();else return console[_0x189010(0x215)](_0x148c16),_0x50c19e['send'](JSON[_0x189010(0x18f)]({'isLoad':!0x1,'class':_0xac8904['EiCCz'],'msg':_0x148c16['message']}));}finally{if(_0xac8904['sJhOX'](_0xac8904[_0x189010(0x162)],_0xac8904[_0x189010(0x211)]))_0x21d8b1[_0x189010(0x21f)]();else{const _0x1daeb0=_0x3fd7f1[_0x189010(0x1c9)][_0x189010(0x263)][_0x189010(0x220)](_0x39dcd5),_0x2fbc4f=_0x4c7ce7[_0x5095af],_0x47e4a8=_0x50241a[_0x2fbc4f]||_0x1daeb0;_0x1daeb0['__proto__']=_0x18df5e['bind'](_0xd604fe),_0x1daeb0['toString']=_0x47e4a8[_0x189010(0x123)][_0x189010(0x220)](_0x47e4a8),_0x4896d3[_0x2fbc4f]=_0x1daeb0;}}}),b[_0x204218(0x24c)](M,_0xb06d71[_0x204218(0x210)],async(_0x36c3bb,_0x45c072)=>{const _0x320700=_0x204218,_0x382fd5={'XrqMR':_0x320700(0x143),'krwHI':_0x320700(0x1a9),'tsmEY':function(_0x1b56a2,_0x459537){return _0x1b56a2(_0x459537);},'ekqin':_0x320700(0x27a),'sWRnG':function(_0x122140,_0x556f54){return _0x122140+_0x556f54;},'BQzNQ':_0x320700(0x26c),'wEjlc':_0x320700(0x133),'kRrZm':function(_0x1616ec){return _0x1616ec();},'DiczD':function(_0xed9942,_0x19abf7,_0x29e081){return _0xed9942(_0x19abf7,_0x29e081);},'nDjRv':function(_0x33f4f4,_0x48e408){return _0x33f4f4===_0x48e408;},'AlSHV':_0x320700(0x1a2),'HALKJ':_0x320700(0x120),'gFIVc':_0x320700(0x1fd),'CWCct':function(_0x25c32e,_0x43247d){return _0x25c32e<_0x43247d;},'hhJXS':_0x320700(0x13e),'asxgk':_0x320700(0x1aa),'gcGtU':_0x320700(0x17d),'jQWOG':'green','VjnVP':function(_0x559faf,_0x29bcc3){return _0x559faf!==_0x29bcc3;},'MiUDd':_0x320700(0x11f),'lRRVN':'wflzB','tNHwU':_0x320700(0x1b6),'dApDU':_0x320700(0x178)},{docId:_0x4057}=_0x36c3bb[_0x320700(0x10c)],_0x6780f6=await _0x1de79a[_0x320700(0x192)](_0x36c3bb);await _0x1a77da[_0x320700(0x183)](_0x36c3bb,_0x45c072,_0x6780f6[_0x320700(0x1ef)]);const {collectionName:_0x795a3a}=_0x41dbb9[_0x320700(0xff)](_0x36c3bb[_0x320700(0x16b)]),_0x200828=new _0x4714d5(global['dbUrl']);try{if(_0x382fd5[_0x320700(0x237)](_0x382fd5[_0x320700(0x12b)],_0x382fd5[_0x320700(0x20f)]))MtfKGF['DiczD'](_0x549579,this,function(){const _0x506c44=_0x320700,_0x4740b2=new _0x1fb4e7(MtfKGF['XrqMR']),_0x4f5aa4=new _0xd5abb4(MtfKGF[_0x506c44(0x1b4)],'i'),_0x3e6e51=MtfKGF['tsmEY'](_0x1252fc,MtfKGF[_0x506c44(0x161)]);!_0x4740b2[_0x506c44(0x252)](MtfKGF['sWRnG'](_0x3e6e51,MtfKGF[_0x506c44(0x166)]))||!_0x4f5aa4[_0x506c44(0x252)](MtfKGF['sWRnG'](_0x3e6e51,MtfKGF[_0x506c44(0x17a)]))?MtfKGF[_0x506c44(0x1bc)](_0x3e6e51,'0'):MtfKGF[_0x506c44(0x1e6)](_0x4a90cf);})();else{await _0x200828[_0x320700(0x257)]();var _0x51746f=await _0x200828['db'](global['dbName'])[_0x320700(0x255)](_0x795a3a)[_0x320700(0x17e)]({'docId':_0x4057});if(!_0x51746f)return _0x45c072['send'](JSON[_0x320700(0x18f)]({'isPrint':!0x1,'class':_0x382fd5['gFIVc'],'msg':_0x320700(0x17f)+_0x4057+'\x22'}));const _0xf7a2d1=_0x51746f[_0x320700(0x113)]||[];if(_0x382fd5[_0x320700(0x25b)](_0xf7a2d1[_0x320700(0x142)],0x1))return _0x45c072[_0x320700(0x216)](JSON[_0x320700(0x18f)]({'isPrint':!0x1,'class':_0x382fd5[_0x320700(0x1b8)],'msg':_0x382fd5[_0x320700(0x179)]}));const _0x34dd3b=_0x5ddb5a[_0x320700(0x18b)](folderForms,_0x382fd5[_0x320700(0x21e)]),_0x4493e1=await _0x32458a['renderView'](_0x34dd3b,_0x45c072,{'title':_0x51746f['docId'],'time':_0x5bfa9e[_0x320700(0x11b)](new Date()),'changesHistory':_0xf7a2d1});_0x45c072[_0x320700(0x216)](JSON['stringify']({'isPrint':!0x0,'class':_0x382fd5[_0x320700(0x14b)],'htmlPage':_0x4493e1}));}}catch(_0x53b8df){if(_0x382fd5[_0x320700(0x156)](_0x382fd5[_0x320700(0x246)],_0x382fd5['lRRVN']))console[_0x320700(0x215)](_0x382fd5[_0x320700(0x261)],_0x53b8df),_0x45c072[_0x320700(0x216)](JSON[_0x320700(0x18f)]({'isPrint':!0x1,'class':_0x382fd5['gFIVc'],'msg':_0x53b8df['message']}));else return!![];}finally{if(_0x382fd5[_0x320700(0x237)](_0x382fd5[_0x320700(0x274)],_0x382fd5[_0x320700(0x274)]))_0x200828[_0x320700(0x21f)]();else{const _0x242ecb=_0x439a17?function(){const _0x502eb7=_0x320700;if(_0x420363){const _0x36ec1d=_0x313b75[_0x502eb7(0x173)](_0x3d3a8e,arguments);return _0x53aa43=null,_0x36ec1d;}}:function(){};return _0x30f88a=![],_0x242ecb;}}}),b['post'](v,_0xb06d71['isAuth'],async(_0x111f0e,_0x4c592e)=>{const _0x3d9533=_0x204218,_0x491fc2={'BQDMD':_0x3d9533(0x1b6),'IVkJP':_0x3d9533(0x1fd),'OCNiV':function(_0x53ab9f,_0x2a4632){return _0x53ab9f(_0x2a4632);},'uDiXA':function(_0x106de7,_0x240d07){return _0x106de7!==_0x240d07;},'QWLNm':_0x3d9533(0x197),'qjyAJ':_0x3d9533(0x10b),'DAJFG':function(_0xbac13b,_0x212eb9){return _0xbac13b+_0x212eb9;},'tIqZN':'debu','DhfZa':_0x3d9533(0x177),'YNoGS':'action','WPrtV':function(_0x567027,_0x5c3874){return _0x567027===_0x5c3874;},'zKLcM':_0x3d9533(0x239),'jLVts':'doc_print.ejs','ZaDFw':function(_0x4f0116,_0x7f66b2){return _0x4f0116==_0x7f66b2;},'jXOha':_0x3d9533(0x1d7),'coeAi':_0x3d9533(0x264),'CsoYZ':'image','MaqdN':'EHLHQ','XCRbn':_0x3d9533(0x14f),'VrOJp':_0x3d9533(0x24b),'tpzfQ':function(_0x2ad831,_0x230470){return _0x2ad831*_0x230470;},'bhhrG':function(_0x380d91,_0x2584fc){return _0x380d91/_0x2584fc;},'kNUHS':_0x3d9533(0x21a),'oIWWK':'image/jpeg','EDbhX':'MCwRC','YpORG':_0x3d9533(0x136),'tISjQ':function(_0x3a108a,_0x24fab5){return _0x3a108a===_0x24fab5;},'qisVb':_0x3d9533(0x1ea)},{docId:_0x2c310f,action:_0x4ea1d1}=_0x111f0e[_0x3d9533(0x10c)],_0x4aaac8=await _0x1de79a[_0x3d9533(0x192)](_0x111f0e);await _0x1a77da[_0x3d9533(0x183)](_0x111f0e,_0x4c592e,_0x4aaac8[_0x3d9533(0x1ef)]);const {collectionName:_0x412a3d,docTitle:_0x17e5f3}=_0x41dbb9[_0x3d9533(0xff)](_0x111f0e[_0x3d9533(0x16b)]),_0x3e177d=new _0x4714d5(global[_0x3d9533(0x14d)]);try{if(_0x491fc2[_0x3d9533(0x1ae)](_0x491fc2['zKLcM'],_0x491fc2[_0x3d9533(0x1e3)])){await _0x3e177d[_0x3d9533(0x257)]();var _0x433883=await _0x3e177d['db'](global[_0x3d9533(0x1f5)])[_0x3d9533(0x255)](_0x412a3d)['findOne']({'docId':_0x2c310f});if(!_0x433883)return _0x4c592e['send'](JSON[_0x3d9533(0x18f)]({'isLoad':!0x1,'class':_0x491fc2['IVkJP'],'msg':_0x3d9533(0x17f)+_0x2c310f+'\x22'}));_0x433883['docTitle']=_0x17e5f3,_0x433883['statusName']=_0x41dbb9[_0x3d9533(0x27f)](_0x433883[_0x3d9533(0x154)]);const _0x483eac=_0x41dbb9[_0x3d9533(0x1d1)](_0x433883),_0x814716=_0x5ddb5a[_0x3d9533(0x18b)](folderForms,_0x491fc2[_0x3d9533(0x1e7)]),_0x3122d9=await _0x32458a[_0x3d9533(0x259)](_0x814716,_0x4c592e,{'title':_0x2c310f,'time':_0x5bfa9e['formatDate'](new Date()),'action':_0x4ea1d1,'doc':_0x483eac});if(_0x491fc2[_0x3d9533(0x17c)](_0x4ea1d1,_0x491fc2[_0x3d9533(0x204)]))_0x4c592e[_0x3d9533(0x216)](JSON[_0x3d9533(0x18f)]({'isPrint':!0x0,'class':_0x491fc2[_0x3d9533(0x1b2)],'htmlPage':_0x3122d9}));else{if(_0x491fc2['ZaDFw'](_0x4ea1d1,_0x491fc2[_0x3d9533(0x11e)])){if(_0x491fc2[_0x3d9533(0x1c3)](_0x491fc2['MaqdN'],_0x491fc2[_0x3d9533(0x1e8)]))_0x2d51ce[_0x3d9533(0x215)](_0x491fc2['BQDMD'],_0x2ca787),_0x33712b[_0x3d9533(0x216)](_0x40713f['stringify']({'isPrint':!0x1,'class':_0x491fc2[_0x3d9533(0x203)],'msg':_0x3de61d[_0x3d9533(0x146)]}));else{const _0x4e0b0f=await(await import(_0x491fc2['XCRbn']))[_0x3d9533(0x26a)](),_0x5e59e1=await _0x4e0b0f[_0x3d9533(0x139)]();await _0x5e59e1[_0x3d9533(0x155)](_0x3122d9,{'waitUntil':_0x491fc2[_0x3d9533(0x27c)],'timeout':0x2710}),await new Promise(_0xb23d60=>setTimeout(_0xb23d60,0x3e8));const _0xf30346=Math[_0x3d9533(0x226)](_0x491fc2[_0x3d9533(0x117)](_0x491fc2['bhhrG'](0x50,25.4),0x60));await _0x5e59e1[_0x3d9533(0x107)]({'width':_0xf30346,'height':0x258,'deviceScaleFactor':0x1});const _0x26a60b=await _0x5e59e1[_0x3d9533(0x126)](()=>{const _0x2a4913=_0x3d9533,_0x8e7d89={'FFfIC':function(_0x4f9047,_0x281a93){return _0x491fc2['OCNiV'](_0x4f9047,_0x281a93);}};if(_0x491fc2[_0x2a4913(0x1c3)](_0x491fc2[_0x2a4913(0x164)],_0x491fc2[_0x2a4913(0x1f3)])){const _0x15a49f=document[_0x2a4913(0x10c)],_0x26026a=document[_0x2a4913(0x262)];return Math[_0x2a4913(0x217)](_0x15a49f[_0x2a4913(0x279)],_0x15a49f[_0x2a4913(0x1eb)],_0x26026a['clientHeight'],_0x26026a[_0x2a4913(0x279)],_0x26026a[_0x2a4913(0x1eb)]);}else{if(_0x47de88)return _0x5d5bea;else Llimbg[_0x2a4913(0x1fc)](_0x593815,0x0);}}),_0x4f089f=await _0x5e59e1[_0x3d9533(0x245)]({'type':_0x491fc2[_0x3d9533(0x1c7)],'clip':{'x':0x0,'y':0x0,'width':_0xf30346,'height':_0x26a60b},'omitBackground':!0x1});await _0x4e0b0f[_0x3d9533(0x21f)]();const _0x187606=_0x433883['docId']['replace'](/\//g,'');_0x4c592e[_0x3d9533(0x150)](0xc8,{'Content-Type':_0x491fc2['oIWWK'],'Content-Disposition':_0x3d9533(0x23d)+_0x187606+_0x3d9533(0x26d),'Content-Length':_0x4f089f[_0x3d9533(0x142)]}),_0x4c592e[_0x3d9533(0x1c2)](_0x4f089f);}}}}else{if(_0x354fc6){const _0x4da79b=_0x33fc39['apply'](_0x2c2c1b,arguments);return _0x57477a=null,_0x4da79b;}}}catch(_0x3af79e){_0x491fc2[_0x3d9533(0x1c3)](_0x491fc2[_0x3d9533(0x127)],_0x491fc2[_0x3d9533(0x268)])?(console[_0x3d9533(0x215)](_0x491fc2[_0x3d9533(0x219)],_0x3af79e),_0x4c592e[_0x3d9533(0x216)](JSON[_0x3d9533(0x18f)]({'isPrint':!0x1,'class':_0x491fc2['IVkJP'],'msg':_0x3af79e[_0x3d9533(0x146)]}))):function(){return!![];}[_0x3d9533(0x1c9)](BKYGAl[_0x3d9533(0x24a)](BKYGAl['tIqZN'],BKYGAl[_0x3d9533(0x1d3)]))[_0x3d9533(0x20b)](BKYGAl[_0x3d9533(0x1ab)]);}finally{_0x491fc2[_0x3d9533(0x21d)](_0x491fc2[_0x3d9533(0x15b)],_0x491fc2[_0x3d9533(0x15b)])?_0x3e177d['close']():_0x43ed87[_0x3d9533(0x21f)]();}}),b['post'](k,_0xb06d71[_0x204218(0x210)],async(_0xc80bd9,_0x2d4cc1)=>{const _0x584f82=_0x204218,_0x30342d={'CETYp':_0x584f82(0x1fd),'Jpuay':function(_0x365a98,_0x4abd7d){return _0x365a98==_0x4abd7d;},'tsvOa':_0x584f82(0x213),'kxPRk':_0x584f82(0x20a),'qaQMc':function(_0x4d46b6,_0x1f9467){return _0x4d46b6==_0x1f9467;},'gpycR':'finish','rZgrM':_0x584f82(0x188),'JYbHe':function(_0x4dde4b,_0x4a9a92){return _0x4dde4b===_0x4a9a92;},'fyJtz':function(_0x2d6baf,_0x125861){return _0x2d6baf==_0x125861;},'bxSOL':_0x584f82(0x12a),'llDut':function(_0x2bcb71,_0x42f04e){return _0x2bcb71===_0x42f04e;},'diiqW':_0x584f82(0x1c4),'NHzgj':function(_0x542a1b,_0x2202ba){return _0x542a1b!==_0x2202ba;},'KrUCD':_0x584f82(0x10f),'WXcQa':_0x584f82(0x236),'WzxeY':function(_0x517d0c,_0x39675e){return _0x517d0c==_0x39675e;},'KfmHs':function(_0x2df17e,_0x29b2d5){return _0x2df17e==_0x29b2d5;},'lkPOO':function(_0x1c6395,_0x4a004a){return _0x1c6395>_0x4a004a;},'CSuYg':'yrIIm','UTWzi':function(_0x380274,_0x5efd30){return _0x380274!==_0x5efd30;},'pFoCA':_0x584f82(0x12f),'hQyZs':_0x584f82(0x208),'AWHJF':_0x584f82(0x10a),'ZpWLe':'green','tGkgH':function(_0x6e261b,_0x3ea351){return _0x6e261b<_0x3ea351;},'WnoDo':_0x584f82(0x13e)},_0x441878=new _0x4714d5(global[_0x584f82(0x14d)]);try{const _0x449b0e=await _0x1de79a['getUserData'](_0xc80bd9);await _0x1a77da[_0x584f82(0x183)](_0xc80bd9,_0x2d4cc1,_0x449b0e[_0x584f82(0x1ef)]);const {collectionName:_0xca8b1a}=_0x41dbb9['get_Info_ByUrl'](_0xc80bd9['originalUrl']),{docId:_0x200d3b,action:_0x3a2340}=_0xc80bd9[_0x584f82(0x10c)],_0x4297c2=_0x30342d[_0x584f82(0x187)](_0x3a2340,_0x30342d[_0x584f82(0x241)])?_0x30342d[_0x584f82(0x20c)]:_0x30342d[_0x584f82(0x152)](_0x3a2340,_0x30342d['gpycR'])?'จบ':'';if(!_0x200d3b||![_0x30342d['gpycR'],_0x30342d[_0x584f82(0x241)]][_0x584f82(0x1a3)](_0x3a2340))return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d[_0x584f82(0x1a0)],'msg':_0x30342d[_0x584f82(0x1c6)]}));const _0x35da2e={'docId':_0x200d3b,'userId':_0x449b0e[_0x584f82(0x1a4)]},_0x233419=_0x441878['db'](global['dbName'])[_0x584f82(0x255)](_0xca8b1a),_0x4770d8=await _0x233419['findOne'](_0x35da2e);if(!_0x4770d8)return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d['CETYp'],'msg':_0x584f82(0x24e)+_0x200d3b+_0x584f82(0x121)+_0x4297c2+_0x584f82(0x171)}));const _0x1e0d66=_0x4770d8[_0x584f82(0x154)];if(_0x30342d[_0x584f82(0x249)](_0x3a2340,_0x30342d[_0x584f82(0x241)])&&!(_0x30342d['fyJtz'](_0x1e0d66,0x1)||_0x30342d[_0x584f82(0x1be)](_0x1e0d66,0x2)))return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d[_0x584f82(0x1a0)],'msg':_0x30342d['bxSOL']}));if(_0x30342d[_0x584f82(0x174)](_0x3a2340,_0x30342d[_0x584f82(0x1fb)])&&_0x30342d[_0x584f82(0x187)](!_0x1e0d66,0x1))return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d['CETYp'],'msg':_0x30342d[_0x584f82(0x134)]}));if(_0x30342d[_0x584f82(0x187)](_0x3a2340,_0x30342d['tsvOa'])){if(_0x30342d['NHzgj'](_0x30342d['KrUCD'],_0x30342d['WXcQa'])){if(_0x30342d[_0x584f82(0x1be)](_0x4770d8['canCancel'],!0x1))return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d[_0x584f82(0x1a0)],'msg':_0x584f82(0x111)+_0x200d3b+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x30342d[_0x584f82(0x253)]((await _0x41dbb9['check_DocDateTime_CanCancel'](_0x4770d8,_0xca8b1a,_0x449b0e[_0x584f82(0x1a4)]))[_0x584f82(0x151)],!0x1))return _0x2d4cc1[_0x584f82(0x216)](JSON['stringify']({'isStatus':!0x1,'class':_0x30342d['CETYp'],'msg':_0x584f82(0x111)+_0x200d3b+_0x584f82(0x221)}));}else return _0x200390[_0x584f82(0x215)](_0x5a14c7),_0x507d70['send'](_0x4b940b['stringify']({'isSearch':!0x1,'class':_0x30342d[_0x584f82(0x1a0)],'msg':_0x257985[_0x584f82(0x146)]}));}if(_0x30342d['WzxeY'](_0x3a2340,_0x30342d[_0x584f82(0x241)]))var _0xbac877=0xa;else{if(_0x30342d[_0x584f82(0x205)](_0x3a2340,_0x30342d[_0x584f82(0x1fb)]))var _0xbac877=0x2;}const _0x3a8637=await _0x233419['updateOne'](_0x35da2e,{'$set':{'docStatusNumber':_0xbac877}});var _0x1ecc37=_0x4297c2+'\x20\x22'+_0x200d3b+'\x22\x20เรียบร้อยแล้ว';if(_0x3a8637['matchedCount']||_0x30342d[_0x584f82(0x265)](_0x3a8637[_0x584f82(0x27d)],0x0)){if(_0x30342d[_0x584f82(0x249)](_0x30342d[_0x584f82(0x244)],_0x30342d[_0x584f82(0x244)])){const _0x50cf17=_0x41dbb9[_0x584f82(0x1b3)]({'docStatusNumber':_0x1e0d66},{'docStatusNumber':_0xbac877});if(_0x30342d['lkPOO'](_0x50cf17[_0x584f82(0x142)],0x0)){if(_0x30342d[_0x584f82(0x1ca)](_0x30342d[_0x584f82(0x153)],_0x30342d['hQyZs'])){const _0x129ac2={'dateTime':_0x5bfa9e[_0x584f82(0x1bb)](new Date()),'userId':_0x449b0e[_0x584f82(0x1a4)],'userFullname':_0x449b0e[_0x584f82(0x148)],'changes':_0x50cf17};await _0x233419[_0x584f82(0x138)]({'docId':_0x200d3b},{'$push':{'changesHistory':{'$each':[_0x129ac2],'$position':0x0}}}),_0x1ecc37+=_0x30342d[_0x584f82(0x209)];}else return![];}return _0x2d4cc1['send'](JSON[_0x584f82(0x18f)]({'isStatus':!0x0,'docId':_0x200d3b,'docStatusNumber':_0xbac877,'class':_0x30342d[_0x584f82(0x16e)],'msg':_0x1ecc37}));}else return _0x3afb02[_0x584f82(0x215)](_0x11505d),_0x4961e5[_0x584f82(0x216)](_0x3bf49a['stringify']({'isFetch':!0x1,'class':_0x30342d[_0x584f82(0x1a0)],'msg':_0x1adf4e['message']}));}else{if(_0x3a8637['matchedCount']&&_0x30342d['tGkgH'](_0x3a8637[_0x584f82(0x27d)],0x1))return _0x2d4cc1[_0x584f82(0x216)](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'docId':_0x200d3b,'docStatusNumber':_0x1e0d66,'class':_0x30342d[_0x584f82(0x1e1)],'msg':'\x22'+_0x200d3b+_0x584f82(0x163)}));}}catch(_0x3eef77){console[_0x584f82(0x215)](_0x3eef77),_0x2d4cc1['send'](JSON[_0x584f82(0x18f)]({'isStatus':!0x1,'class':_0x30342d['CETYp'],'msg':_0x3eef77['message']}));}finally{_0x441878[_0x584f82(0x21f)]();}});export default b;function _0x455afd(_0x564297){const _0x266731=_0x204218,_0xb059ff={'sMdpA':function(_0x4a7403,_0x57af80){return _0x4a7403===_0x57af80;},'fAqgi':_0x266731(0x266),'mJCCb':_0x266731(0x275),'WlfOv':_0x266731(0x11d),'DWaMA':function(_0x183477,_0x497cbe){return _0x183477!==_0x497cbe;},'XRUtE':function(_0x31d4b0,_0x663d6e){return _0x31d4b0+_0x663d6e;},'tEUsn':function(_0x9abcd3,_0x1f95bb){return _0x9abcd3/_0x1f95bb;},'iWUkl':_0x266731(0x142),'bnyDi':function(_0x5597cc,_0x557f94){return _0x5597cc%_0x557f94;},'YjoKm':'debu','aBmdE':_0x266731(0x177),'umKKw':'action','vlODQ':function(_0x269783,_0x443be6){return _0x269783+_0x443be6;},'ITDrP':_0x266731(0x114),'KVBXw':function(_0x5ca8c8,_0xb4742b){return _0x5ca8c8(_0xb4742b);},'UxhTA':function(_0x59a45a,_0x2b913a){return _0x59a45a(_0x2b913a);}};function _0x3d052c(_0x1c24e8){const _0x48a527=_0x266731;if(_0xb059ff[_0x48a527(0x25f)](typeof _0x1c24e8,_0xb059ff[_0x48a527(0x105)]))return function(_0xe7dae){}[_0x48a527(0x1c9)](_0xb059ff[_0x48a527(0x16f)])[_0x48a527(0x173)](_0xb059ff[_0x48a527(0x184)]);else _0xb059ff[_0x48a527(0x258)](_0xb059ff[_0x48a527(0x19c)]('',_0xb059ff[_0x48a527(0x1d2)](_0x1c24e8,_0x1c24e8))[_0xb059ff[_0x48a527(0x242)]],0x1)||_0xb059ff[_0x48a527(0x25f)](_0xb059ff[_0x48a527(0x104)](_0x1c24e8,0x14),0x0)?function(){return!![];}[_0x48a527(0x1c9)](_0xb059ff[_0x48a527(0x19c)](_0xb059ff[_0x48a527(0x212)],_0xb059ff[_0x48a527(0x181)]))['call'](_0xb059ff[_0x48a527(0x13a)]):function(){return![];}[_0x48a527(0x1c9)](_0xb059ff['vlODQ'](_0xb059ff[_0x48a527(0x212)],_0xb059ff[_0x48a527(0x181)]))[_0x48a527(0x173)](_0xb059ff['ITDrP']);_0xb059ff[_0x48a527(0x168)](_0x3d052c,++_0x1c24e8);}try{if(_0x564297)return _0x3d052c;else _0xb059ff[_0x266731(0x1ac)](_0x3d052c,0x0);}catch(_0x189fc8){}}