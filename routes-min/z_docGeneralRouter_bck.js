const _0x4966d2=_0x25c9;(function(_0x791926,_0x1a25c4){const _0x107023=_0x25c9,_0x374221=_0x791926();while(!![]){try{const _0x1c8cad=parseInt(_0x107023(0x13a))/0x1*(parseInt(_0x107023(0x100))/0x2)+-parseInt(_0x107023(0x18c))/0x3+parseInt(_0x107023(0xf7))/0x4+parseInt(_0x107023(0x1e9))/0x5*(parseInt(_0x107023(0x181))/0x6)+-parseInt(_0x107023(0x203))/0x7*(-parseInt(_0x107023(0x1ea))/0x8)+-parseInt(_0x107023(0x1a1))/0x9*(parseInt(_0x107023(0x19c))/0xa)+-parseInt(_0x107023(0xcb))/0xb;if(_0x1c8cad===_0x1a25c4)break;else _0x374221['push'](_0x374221['shift']());}catch(_0x47d4fe){_0x374221['push'](_0x374221['shift']());}}}(_0x17e7,0x7db6f));const _0x203f38=(function(){const _0x10ccd2=_0x25c9,_0x433877={'pzrju':function(_0x451c96,_0x39b948){return _0x451c96(_0x39b948);},'bWHXK':function(_0x4ce953,_0xa756d9){return _0x4ce953!==_0xa756d9;},'AKvQI':_0x10ccd2(0x10e),'KAnKk':'hxCQK','ohaKP':function(_0x5ae67c,_0xe0a35a){return _0x5ae67c===_0xe0a35a;},'muhuB':_0x10ccd2(0xec),'RsbiB':_0x10ccd2(0x10c),'ctCYS':_0x10ccd2(0x196),'zyuFr':_0x10ccd2(0x1c4)};let _0x51b4c7=!![];return function(_0x2bc5ab,_0x9b439f){const _0x4300c7=_0x10ccd2,_0x360cbe={'kfkfT':function(_0x309365,_0xd67360){const _0xd07386=_0x25c9;return _0x433877[_0xd07386(0x93)](_0x309365,_0xd67360);},'Wdioy':function(_0x1b3233,_0x3d2d4b){return _0x433877['bWHXK'](_0x1b3233,_0x3d2d4b);},'VhrJa':_0x433877[_0x4300c7(0xc6)],'lJNcQ':_0x433877[_0x4300c7(0x1f3)],'HwSyE':function(_0x2c7a45,_0x3d3196){const _0x47565f=_0x4300c7;return _0x433877[_0x47565f(0x1e5)](_0x2c7a45,_0x3d3196);},'BHJnv':_0x433877[_0x4300c7(0x145)],'VMwFu':_0x433877[_0x4300c7(0x1e2)]};if(_0x433877[_0x4300c7(0x1e5)](_0x433877['ctCYS'],_0x433877[_0x4300c7(0x1c6)]))_0x1b7944['close']();else{const _0xb47587=_0x51b4c7?function(){const _0x54a715=_0x4300c7;if(_0x360cbe[_0x54a715(0x18e)](_0x360cbe[_0x54a715(0x11b)],_0x360cbe[_0x54a715(0xc0)])){if(_0x9b439f){if(_0x360cbe[_0x54a715(0x11d)](_0x360cbe[_0x54a715(0x148)],_0x360cbe[_0x54a715(0xd8)]))_0x60e193[_0x54a715(0x173)]();else{const _0x5bfbd4=_0x9b439f['apply'](_0x2bc5ab,arguments);return _0x9b439f=null,_0x5bfbd4;}}}else _0x360cbe[_0x54a715(0x174)](_0x128a78,'0');}:function(){};return _0x51b4c7=![],_0xb47587;}};}());(function(){const _0x33c3b5=_0x25c9,_0x196fce={'TYxid':'error\x20===>\x20','IyyYQ':_0x33c3b5(0x1cf),'WyYTE':function(_0x1e34f8,_0x3d0039){return _0x1e34f8!==_0x3d0039;},'nHyRF':_0x33c3b5(0xcc),'UhWPO':'function\x20*\x5c(\x20*\x5c)','LBCnj':_0x33c3b5(0x1f9),'xHpep':function(_0x2b7d1b,_0x5d4109){return _0x2b7d1b(_0x5d4109);},'dpdyb':'init','jfbHM':function(_0x54ab51,_0x168345){return _0x54ab51+_0x168345;},'WUtuP':_0x33c3b5(0x122),'PimoA':function(_0x34db57,_0x358ca8){return _0x34db57+_0x358ca8;},'kcZdK':_0x33c3b5(0x1f6),'xKXPh':function(_0x559b25,_0x1d029a){return _0x559b25===_0x1d029a;},'jCUbI':_0x33c3b5(0x9e),'Smfpv':function(_0x7b9385,_0x3119aa){return _0x7b9385(_0x3119aa);},'iPWqY':function(_0x59bdf6,_0x322174){return _0x59bdf6!==_0x322174;},'YhnTK':_0x33c3b5(0x1aa),'IkksQ':function(_0x4bd574){return _0x4bd574();},'vjSfD':function(_0x4f242e,_0x3f615b,_0x52de5d){return _0x4f242e(_0x3f615b,_0x52de5d);}};_0x196fce['vjSfD'](_0x203f38,this,function(){const _0x4c9011=_0x33c3b5;if(_0x196fce[_0x4c9011(0x96)](_0x196fce[_0x4c9011(0xce)],_0x196fce['nHyRF']))return _0x237dc1;else{const _0x44f0a4=new RegExp(_0x196fce[_0x4c9011(0xe0)]),_0x34e981=new RegExp(_0x196fce[_0x4c9011(0x197)],'i'),_0x355210=_0x196fce[_0x4c9011(0x1c3)](_0x2242a7,_0x196fce[_0x4c9011(0x1f5)]);if(!_0x44f0a4[_0x4c9011(0x1a0)](_0x196fce['jfbHM'](_0x355210,_0x196fce[_0x4c9011(0x1d2)]))||!_0x34e981[_0x4c9011(0x1a0)](_0x196fce['PimoA'](_0x355210,_0x196fce[_0x4c9011(0x9c)])))_0x196fce['xKXPh'](_0x196fce['jCUbI'],_0x196fce[_0x4c9011(0x1de)])?_0x196fce[_0x4c9011(0x155)](_0x355210,'0'):(_0x378c9b[_0x4c9011(0xfc)](_0x196fce['TYxid'],_0x273f2c),_0x1202bc[_0x4c9011(0x87)](_0x40d1fc['stringify']({'isPrint':!0x1,'class':_0x196fce[_0x4c9011(0x1bc)],'msg':_0x356bac['message']})));else{if(_0x196fce[_0x4c9011(0x160)](_0x196fce[_0x4c9011(0xfb)],_0x196fce[_0x4c9011(0xfb)])){const _0x182722=_0x93cf5[_0x4c9011(0x135)]['prototype'][_0x4c9011(0x205)](_0x441ae4),_0x320cd3=_0x47b763[_0x1543e0],_0x4fb406=_0x575378[_0x320cd3]||_0x182722;_0x182722[_0x4c9011(0x127)]=_0x162c77[_0x4c9011(0x205)](_0x589c77),_0x182722[_0x4c9011(0x112)]=_0x4fb406[_0x4c9011(0x112)]['bind'](_0x4fb406),_0x2911d5[_0x320cd3]=_0x182722;}else _0x196fce[_0x4c9011(0x1eb)](_0x2242a7);}}})();}());const _0x507180=(function(){const _0x3cb584=_0x25c9,_0x3f7cdb={'BUtqg':_0x3cb584(0x1cf),'vAZAi':function(_0x4a4651,_0x1e2c74){return _0x4a4651===_0x1e2c74;},'uNsDo':'kfpSD','eTlsR':function(_0x335ee9,_0x8c384d){return _0x335ee9!==_0x8c384d;},'xsBFm':_0x3cb584(0x1b0),'QWFEd':'jcuvC','dxUjJ':function(_0x5bf70d,_0x2aeb87){return _0x5bf70d!==_0x2aeb87;},'DfeLL':_0x3cb584(0x1c8),'RzwUQ':_0x3cb584(0x193)};let _0x4ebfee=!![];return function(_0x11a9f2,_0x1ad9e4){const _0x437a1c=_0x3cb584,_0x3700e2={'nERfL':_0x3f7cdb[_0x437a1c(0xd3)],'DQWOE':function(_0x418162,_0x3bab03){return _0x3f7cdb['vAZAi'](_0x418162,_0x3bab03);},'wyHhZ':_0x3f7cdb[_0x437a1c(0x11f)],'OGAqJ':function(_0x3a4dac,_0x44e5ae){const _0x18dc3c=_0x437a1c;return _0x3f7cdb[_0x18dc3c(0xb0)](_0x3a4dac,_0x44e5ae);},'XMnON':_0x3f7cdb[_0x437a1c(0x159)],'DqKcs':_0x3f7cdb[_0x437a1c(0x204)]};if(_0x3f7cdb['dxUjJ'](_0x3f7cdb['DfeLL'],_0x3f7cdb[_0x437a1c(0x113)])){const _0x5abdbf=_0x4ebfee?function(){const _0x12ac2b=_0x437a1c;if(_0x3700e2['DQWOE'](_0x3700e2[_0x12ac2b(0x167)],_0x3700e2[_0x12ac2b(0x167)])){if(_0x1ad9e4){if(_0x3700e2[_0x12ac2b(0x17e)](_0x3700e2[_0x12ac2b(0x111)],_0x3700e2[_0x12ac2b(0xc5)])){const _0x4a31d3=_0x1ad9e4[_0x12ac2b(0x163)](_0x11a9f2,arguments);return _0x1ad9e4=null,_0x4a31d3;}else return _0x329504[_0x12ac2b(0xfc)](_0x3baa5c),_0xacbc8d[_0x12ac2b(0x87)](_0x94eee2[_0x12ac2b(0x1ab)]({'isSearch':!0x1,'class':_0x3700e2[_0x12ac2b(0x1f2)],'msg':_0x43e793[_0x12ac2b(0xee)]}));}}else return!![];}:function(){};return _0x4ebfee=![],_0x5abdbf;}else{const _0xc31fe=_0x5677a9['apply'](_0x112be8,arguments);return _0x358a0c=null,_0xc31fe;}};}()),_0x58e97b=_0x507180(this,function(){const _0x1f8f73=_0x25c9,_0x162b2f={'GmsfB':_0x1f8f73(0xc4),'mBSUH':_0x1f8f73(0x1f9),'hsMmI':function(_0x221a27,_0x231a4f){return _0x221a27(_0x231a4f);},'CbPLi':_0x1f8f73(0x1e1),'NTWnz':function(_0x30a2c7,_0x35fe58){return _0x30a2c7+_0x35fe58;},'ZmKFM':_0x1f8f73(0x122),'YfnUv':function(_0x52b4bf,_0x3730c0){return _0x52b4bf+_0x3730c0;},'AaYaJ':_0x1f8f73(0x1f6),'YcgBN':function(_0x2ec87e){return _0x2ec87e();},'AMDUt':function(_0x3e31e8){return _0x3e31e8();},'vdjOb':function(_0x2781da,_0x5edfe5){return _0x2781da!==_0x5edfe5;},'YLSkO':_0x1f8f73(0x1f7),'envqv':_0x1f8f73(0x90),'uQinb':function(_0x469b8c,_0x535bc8){return _0x469b8c(_0x535bc8);},'ENyEw':function(_0x487e2a,_0x544ab5){return _0x487e2a+_0x544ab5;},'BnRGK':_0x1f8f73(0x1bd),'oZsZo':_0x1f8f73(0x1bb),'dpTMV':function(_0x18ba95,_0x307375){return _0x18ba95===_0x307375;},'AFJWS':_0x1f8f73(0xf8),'QtjZc':'log','wNzov':_0x1f8f73(0x169),'zDBDk':_0x1f8f73(0x1b2),'hXuvE':_0x1f8f73(0x134),'nDjQP':_0x1f8f73(0x12f),'rPlmq':_0x1f8f73(0xe6),'ZfsQu':_0x1f8f73(0xa3),'bgUkx':function(_0x5f5b0e,_0x733753){return _0x5f5b0e<_0x733753;},'wAoxe':function(_0x5a39a5,_0x3b69ff){return _0x5a39a5!==_0x3b69ff;},'WbTTF':_0x1f8f73(0x1d4),'nGrqY':'vbAwc'},_0xbb3b56=function(){const _0x91d1f9=_0x1f8f73,_0x57cca0={'fBIAT':function(_0x292468){return _0x162b2f['AMDUt'](_0x292468);},'BKxef':function(_0x53f220,_0x21cf09){const _0x316f4b=_0x25c9;return _0x162b2f[_0x316f4b(0xb9)](_0x53f220,_0x21cf09);}};if(_0x162b2f[_0x91d1f9(0x1da)](_0x162b2f[_0x91d1f9(0xf0)],_0x162b2f[_0x91d1f9(0xf0)])){const _0x4e1dba=new _0x4d6a0e(_0x162b2f[_0x91d1f9(0xe5)]),_0x81a0a4=new _0x3d1250(_0x162b2f[_0x91d1f9(0x182)],'i'),_0x1d8796=_0x162b2f[_0x91d1f9(0xb9)](_0x742781,_0x162b2f['CbPLi']);!_0x4e1dba['test'](_0x162b2f['NTWnz'](_0x1d8796,_0x162b2f[_0x91d1f9(0xa6)]))||!_0x81a0a4['test'](_0x162b2f[_0x91d1f9(0x109)](_0x1d8796,_0x162b2f[_0x91d1f9(0x85)]))?_0x162b2f['hsMmI'](_0x1d8796,'0'):_0x162b2f[_0x91d1f9(0x1b1)](_0x56aa5d);}else{let _0x420bc6;try{_0x162b2f[_0x91d1f9(0x1da)](_0x162b2f[_0x91d1f9(0x172)],_0x162b2f[_0x91d1f9(0x172)])?_0x57cca0[_0x91d1f9(0xed)](_0x184459):_0x420bc6=_0x162b2f[_0x91d1f9(0x1dd)](Function,_0x162b2f[_0x91d1f9(0x189)](_0x162b2f[_0x91d1f9(0x189)](_0x162b2f[_0x91d1f9(0xf4)],_0x162b2f[_0x91d1f9(0x150)]),');'))();}catch(_0x4ea91d){_0x162b2f[_0x91d1f9(0xca)](_0x162b2f[_0x91d1f9(0x14d)],_0x162b2f['AFJWS'])?_0x420bc6=window:_0x57cca0[_0x91d1f9(0x184)](_0x5a109a,0x0);}return _0x420bc6;}},_0x15f0e4=_0x162b2f[_0x1f8f73(0x1b1)](_0xbb3b56),_0x4623ec=_0x15f0e4[_0x1f8f73(0x157)]=_0x15f0e4[_0x1f8f73(0x157)]||{},_0x264ce0=[_0x162b2f[_0x1f8f73(0x19b)],_0x162b2f[_0x1f8f73(0x164)],_0x162b2f[_0x1f8f73(0x19a)],_0x162b2f['hXuvE'],_0x162b2f[_0x1f8f73(0x9d)],_0x162b2f[_0x1f8f73(0x19f)],_0x162b2f[_0x1f8f73(0xbe)]];for(let _0x4f2ccd=0x0;_0x162b2f['bgUkx'](_0x4f2ccd,_0x264ce0[_0x1f8f73(0x12d)]);_0x4f2ccd++){if(_0x162b2f['wAoxe'](_0x162b2f['WbTTF'],_0x162b2f['nGrqY'])){const _0x298c1e=_0x507180[_0x1f8f73(0x135)]['prototype']['bind'](_0x507180),_0x51801a=_0x264ce0[_0x4f2ccd],_0x59303a=_0x4623ec[_0x51801a]||_0x298c1e;_0x298c1e[_0x1f8f73(0x127)]=_0x507180[_0x1f8f73(0x205)](_0x507180),_0x298c1e[_0x1f8f73(0x112)]=_0x59303a[_0x1f8f73(0x112)][_0x1f8f73(0x205)](_0x59303a),_0x4623ec[_0x51801a]=_0x298c1e;}else _0x2e40d9[_0x1f8f73(0x173)]();}});_0x58e97b();function _0x17e7(){const _0x5790df=['scrollHeight','aCYin','qOkys','Wuddr','PATH_SALES','โหลดเอกสารเลขที่\x20\x22','envqv','close','kfkfT','BOoJk','load','WwGiD','iNMpc','error\x20===>\x20','canEdit','gRRJJ','kLvlj','lSawI','OGAqJ','Xqvom','DfrRM','6Wtjevh','mBSUH','finish','BKxef','TNPGr','rSEoT','debu','\x22\x20{{sep}}เรียบร้อยแล้ว','ENyEw','พบ\x20\x22','userId','722781IANJjU','aPbWI','Wdioy','call','Kyyly','body','DFiCQ','ITCnc','NiiQz','ocbZw','EkVmw','LBCnj','zKeQV','afuVW','zDBDk','QtjZc','430VlXSXS','sHFGH','afLRp','rPlmq','test','128610lwyHaL','GOvHE','inTcU','AZfIN','/changes','attachment;\x20filename=','ixcAA','OhLbJ','gger','LogbZ','stringify','TmwCy','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','dfFdC','DTREj','brPOY','YcgBN','info','get_Info_ByUrl','setContent','puppeteer','ไม่พบเอกสาร\x20\x22','convert_DocPrint','TQPJg','rrgev','UGLIY','{}.constructor(\x22return\x20this\x22)(\x20)','IyyYQ','return\x20(function()\x20','iSigb','eGIUP','aggregate','MUgyc','image','xHpep','SqgZF','replace','zyuFr','hgMgW','wCyYD','uoAGW','syIKf','gyLAA','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','VGkTl','kgGWB','red','push','ITSiv','WUtuP','getItemsCategory','tnTzj','pSAkN','ZEgtc','max','/load-last','statusName','vdjOb','JVNJo','networkidle0','uQinb','jCUbI','check_DocDateTime_CanCancel','xbngN','init','RsbiB','Khtgk','MgXkm','ohaKP','dateTimeCancelRemain','formatDate','sales','3135105dLaGlm','936qJKmuo','IkksQ','stateObject','docStatusNumber','kfjQs','yellow','OUKOK','print','nERfL','KAnKk','action','dpdyb','input','rmJSL','qvgTD','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','JbruI','PyITS','kPcdG','DQpen','pbYcn','getUserData','getItems_for_Modal','collection','yhhep','15659JrRGYk','QWFEd','bind','stfJG','{{sep}}[บันทึกการแก้ไข]','getMainDocPathObj','rOQBp','dateTimeEditRemain','SdcVX','oiZfx','AaYaJ','ไม่พบประวัติการเปลี่ยนแปลง','send','docId','connect','formatDateTime','uztkf','JFZXw','uQrHt','AkbxS','cancel','gHzxX','WlnzI','doc_changes.ejs','pzrju','WBpUJ','includes','WyYTE','warehouseOut','idReM','counter','/load','dbName','kcZdK','nDjQP','xbpVd','bsBEZ','IpxnF','sbJJJ','ไม่พบเอกสารล่าสุด','trace','hIsVG','MLRje','ZmKFM','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','XeRJn','AGNpF','.jpeg','newPage','PATH_WAREHOUSE_IN','Zgjjl','DOC_TYPE','DkBis','eTlsR','QBRvN','/search','TKPsv','offsetHeight','/status','image/jpeg','ADUmt','pzhYS','hsMmI','updateOne','BZiZc','lHfCt','xcXdj','ZfsQu','dateTimeCanEdit','lJNcQ','dateTimeCanCancel','ViVZR','mgLCj','function\x20*\x5c(\x20*\x5c)','DqKcs','AKvQI','ZxZOO','zMmZM','PjAWV','dpTMV','5540062qkOsTv','dGFKR','vZWPW','nHyRF','SeDfQ','znTAq','userFullname','qTPWe','BUtqg','join','originalUrl','launch','SjkfS','VMwFu','HueFa','\x22\x20เรียบร้อยแล้ว','lJitQ','branchId','/print','green','ibVmm','UhWPO','getUserBranchesById','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','COFjq','PATH_WAREHOUSE_OUT','GmsfB','table','nHVUE','deqjO','DaIeF','WAlpS','efSmD','VhPdd','fBIAT','message','IWWoW','YLSkO','aPMqb','floor','uUAfy','BnRGK','FgExJ','dbUrl','885164CQXsTy','kxfTU','renderView','sxjYi','YhnTK','log','SJrjX','matchedCount','QdmEj','1527850zLsczl','findOne','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','acBxt','screenshot','canCancel','VhhLv','changesHistory','getChangeHistory','YfnUv','userAuthority','toArray','KpxZu','qpRTP','Prlnk','cpZZB','uWhVx','XMnON','toString','RzwUQ','evaluate','opYyS','wbTTr','get','mSbyX','FnALE','EbKgo','VhrJa','modifiedCount','HwSyE','active','uNsDo','post','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','chain','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','HyKWf','stock','mGIpH','__proto__','CHMih','npbpg','TaKXZ','YmunY','GeXcA','length','\x22\x20เอกสาร','exception','BymBS','load-last','jpeg','RwXYe','error','constructor','documentElement','EILen','เอกสาร\x20\x22','onnfk','1pJmHbK','tRHRc','tEzUW','zkVPu','isAuth','umsUI','fyLZd','ruOIw','EbzoP','yfnKm','NRvNT','muhuB','zkuro','ifgTC','BHJnv','EByGE','DVoqE','PHxWe','while\x20(true)\x20{}','AFJWS','htRRl','OyEqa','oZsZo','BiYBf','VtHIl','fxiAX','clientHeight','Smfpv','QWvfM','console','fiTuB','xsBFm','FYjXy','JmhEm','QIwSY','CQVUF','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','CUYlG','iPWqY','/fetch/modal','{{sep}}หรือไม่มีสิทธิ์','apply','wNzov','NOOqc','EipIV','wyHhZ','ไม่พบเอกสารเลขที่\x20\x22','warn','Qjicu','vHnDN'];_0x17e7=function(){return _0x5790df;};return _0x17e7();}import _0x5a4a1c from'express';const b=_0x5a4a1c['Router']();import _0x133094 from'path';import{MongoClient as _0x56b1a3}from'mongodb';import _0x4f28ed from'../middleware/mainAuth.js';import*as _0x5de494 from'../mymodule/myUsers.js';import*as _0x526523 from'../mymodule/myDateTime.js';import*as _0x4dcfcf from'../mymodule/myModule.js';import*as _0x3a303a from'../mymodule/myDocMain.js';function _0x25c9(_0x3b7910,_0x2d7e09){const _0x27cdbd=_0x17e7();return _0x25c9=function(_0x58e97b,_0x507180){_0x58e97b=_0x58e97b-0x7e;let _0x3eb17d=_0x27cdbd[_0x58e97b];return _0x3eb17d;},_0x25c9(_0x3b7910,_0x2d7e09);}import*as _0x6aa427 from'../mymodule/myData.js';const w=global[_0x4966d2(0xac)],S=global[_0x4966d2(0xe4)],p=global[_0x4966d2(0x170)],M=[w+_0x4966d2(0x1a5),S+_0x4966d2(0x1a5),p+_0x4966d2(0x1a5)],v=[w+_0x4966d2(0xdd),S+_0x4966d2(0xdd),p+'/print'],k=[w+_0x4966d2(0xb5),S+_0x4966d2(0xb5),p+_0x4966d2(0xb5)],B=[w+'/search',S+'/search',p+_0x4966d2(0xb2)],x=[w+_0x4966d2(0x9a),S+_0x4966d2(0x9a),p+'/load',w+_0x4966d2(0x1d8),S+'/load-last',p+_0x4966d2(0x1d8)],L=[w+_0x4966d2(0x161),S+_0x4966d2(0x161),p+'/fetch/modal'];b[_0x4966d2(0x117)](L,_0x4f28ed[_0x4966d2(0x13e)],async(_0x16bd0c,_0xd016bd)=>{const _0x2f159c=_0x4966d2,_0x198d3f={'TaKXZ':function(_0x677b09,_0x38b3fb){return _0x677b09+_0x38b3fb;},'qOkys':_0x2f159c(0x187),'SdcVX':'gger','TQPOe':_0x2f159c(0x1ec),'PHxWe':function(_0x5732c8,_0x4f146f){return _0x5732c8===_0x4f146f;},'Kyyly':_0x2f159c(0x15a),'mGIpH':function(_0x535a27,_0x42bce0){return _0x535a27==_0x42bce0;},'TmwCy':'warehouseIn','FnALE':_0x2f159c(0x125),'yhhep':function(_0x214ab6,_0x5ad282){return _0x214ab6==_0x5ad282;},'HNfdn':_0x2f159c(0x97),'sxjYi':function(_0x316778,_0x45c65f){return _0x316778==_0x45c65f;},'EbKgo':_0x2f159c(0x1e8),'aPbWI':_0x2f159c(0x11e),'Zgjjl':'green','iSigb':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','ADUmt':_0x2f159c(0x130),'hZcut':'red'},_0x4cb7d4=await _0x5de494[_0x2f159c(0x1ff)](_0x16bd0c),_0x1fcb2e=await _0x3a303a[_0x2f159c(0x80)](_0x16bd0c,_0xd016bd,_0x4cb7d4[_0x2f159c(0x10a)]);try{if(_0x198d3f[_0x2f159c(0x14b)](_0x198d3f[_0x2f159c(0x190)],_0x198d3f['Kyyly'])){if(_0x198d3f[_0x2f159c(0x126)](_0x1fcb2e['DOC_TYPE'],_0x198d3f[_0x2f159c(0x1ac)]))var _0x6e543=await _0x6aa427['getItems_for_Modal'](_0x198d3f[_0x2f159c(0x119)]);else{if(_0x198d3f[_0x2f159c(0x202)](_0x1fcb2e[_0x2f159c(0xae)],_0x198d3f['HNfdn']))var _0x6e543=await _0x6aa427[_0x2f159c(0x200)](_0x198d3f[_0x2f159c(0x119)]);else{if(_0x198d3f[_0x2f159c(0xfa)](_0x1fcb2e['DOC_TYPE'],_0x198d3f[_0x2f159c(0x11a)]))var _0x6e543=await _0x6aa427['getItems_for_Modal'](_0x198d3f[_0x2f159c(0x18d)]);}}const _0x137477=await _0x6aa427[_0x2f159c(0x1d3)]();return _0xd016bd['send'](JSON[_0x2f159c(0x1ab)]({'DATA_ITEMS':_0x6e543,'DATA_CATEGORY':_0x137477,'isFetch':!0x0,'class':_0x198d3f[_0x2f159c(0xad)],'msg':_0x198d3f[_0x2f159c(0x1be)]}));}else{const _0x494301=_0x1f97d8?function(){const _0x39a099=_0x2f159c;if(_0x52fcaf){const _0x2fe355=_0x5f317e[_0x39a099(0x163)](_0x200a30,arguments);return _0x122b63=null,_0x2fe355;}}:function(){};return _0xe3937=![],_0x494301;}}catch(_0x403c10){if(_0x198d3f['PHxWe'](_0x198d3f[_0x2f159c(0xb7)],_0x198d3f['ADUmt']))return console[_0x2f159c(0xfc)](_0x403c10),_0xd016bd[_0x2f159c(0x87)](JSON[_0x2f159c(0x1ab)]({'isFetch':!0x1,'class':_0x198d3f['hZcut'],'msg':_0x403c10[_0x2f159c(0xee)]}));else(function(){return![];}[_0x2f159c(0x135)](SbSomP[_0x2f159c(0x12a)](SbSomP[_0x2f159c(0x16e)],SbSomP[_0x2f159c(0x83)]))[_0x2f159c(0x163)](SbSomP['TQPOe']));}}),b[_0x4966d2(0x120)](B,_0x4f28ed[_0x4966d2(0x13e)],async(_0x136771,_0x34277a)=>{const _0x2e2a4f=_0x4966d2,_0x40865a={'JmhEm':function(_0x57a10c,_0x2d50c0){return _0x57a10c(_0x2d50c0);},'EipIV':function(_0x5060b6,_0x45d016){return _0x5060b6+_0x45d016;},'YhWjx':function(_0x140750,_0xa2da6e){return _0x140750+_0xa2da6e;},'HyKWf':_0x2e2a4f(0x1bd),'Wuddr':_0x2e2a4f(0x1bb),'kLvlj':_0x2e2a4f(0x179),'UGLIY':_0x2e2a4f(0x1cf),'SeDfQ':function(_0x1946cb,_0x1ff832){return _0x1946cb<_0x1ff832;},'ixcAA':_0x2e2a4f(0x1ef),'efSmD':_0x2e2a4f(0x1ad),'QdmEj':function(_0x3fe364,_0x459657){return _0x3fe364===_0x459657;},'NRvNT':_0x2e2a4f(0xe8),'TzLnp':_0x2e2a4f(0xe2),'ocbZw':_0x2e2a4f(0xde),'aPMqb':_0x2e2a4f(0x1cb),'npbpg':_0x2e2a4f(0xe7),'MgXkm':function(_0xeb201,_0x405dfd){return _0xeb201!==_0x405dfd;},'OyEqa':_0x2e2a4f(0x94)};let {sip:_0x5e730b}=_0x136771[_0x2e2a4f(0x191)];if(!_0x5e730b&&_0x40865a[_0x2e2a4f(0xcf)](_0x5e730b[_0x2e2a4f(0x12d)],0x2))return _0x34277a[_0x2e2a4f(0x87)](JSON[_0x2e2a4f(0x1ab)]({'isSearch':!0x1,'class':_0x40865a[_0x2e2a4f(0x1a7)],'msg':_0x40865a[_0x2e2a4f(0xeb)]}));_0x5e730b=_0x5e730b['replace'](/[!@#$%^&*<>]/g,'')??null;const _0x2a26a8=await _0x5de494[_0x2e2a4f(0x1ff)](_0x136771);await _0x3a303a[_0x2e2a4f(0x80)](_0x136771,_0x34277a,_0x2a26a8[_0x2e2a4f(0x10a)]);const {collectionName:_0xfad5c0}=_0x6aa427[_0x2e2a4f(0x1b3)](_0x136771[_0x2e2a4f(0xd5)]),_0x3edf01=new _0x56b1a3(global[_0x2e2a4f(0xf6)]);try{if(_0x40865a[_0x2e2a4f(0xff)](_0x40865a[_0x2e2a4f(0x144)],_0x40865a[_0x2e2a4f(0x144)])){await _0x3edf01[_0x2e2a4f(0x89)]();const _0x7da225=_0x3edf01['db'](global[_0x2e2a4f(0x9b)])[_0x2e2a4f(0x201)](_0xfad5c0),_0x1ec6d1=[{'$or':[{'docId':{'$regex':_0x5e730b,'$options':'i'}},{'docDate':{'$regex':_0x5e730b,'$options':'i'}}]}];let _0x18ebf9='';['O','S'][_0x2e2a4f(0x95)](_0x2a26a8[_0x2e2a4f(0x10a)])||(_0x18ebf9+=_0x40865a['TzLnp'],_0x1ec6d1[_0x2e2a4f(0x1d0)]({'userId':_0x2a26a8[_0x2e2a4f(0x18b)]}));const _0x2648b0=await _0x7da225[_0x2e2a4f(0x1c0)]([{'$match':{'$and':_0x1ec6d1}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x2e2a4f(0x10b)]();return _0x18ebf9=_0x40865a[_0x2e2a4f(0x166)](_0x2e2a4f(0x18a)+_0x2648b0[_0x2e2a4f(0x12d)]+_0x2e2a4f(0x12e),_0x18ebf9),_0x34277a['send'](JSON[_0x2e2a4f(0x1ab)]({'searchFound':_0x2648b0,'msg':_0x18ebf9,'isSearch':!0x0,'class':_0x40865a[_0x2e2a4f(0x195)]}));}else{if(_0x1358d0){const _0x3769f4=_0x38fd09[_0x2e2a4f(0x163)](_0x5119a3,arguments);return _0x461860=null,_0x3769f4;}}}catch(_0x5f13ee){if(_0x40865a['QdmEj'](_0x40865a[_0x2e2a4f(0xf1)],_0x40865a[_0x2e2a4f(0x129)])){let _0x3ef794;try{_0x3ef794=bugpLQ[_0x2e2a4f(0x15b)](_0x437ef3,bugpLQ[_0x2e2a4f(0x166)](bugpLQ['YhWjx'](bugpLQ[_0x2e2a4f(0x124)],bugpLQ[_0x2e2a4f(0x16f)]),');'))();}catch(_0xb67ad2){_0x3ef794=_0x590638;}return _0x3ef794;}else return console[_0x2e2a4f(0xfc)](_0x5f13ee),_0x34277a[_0x2e2a4f(0x87)](JSON[_0x2e2a4f(0x1ab)]({'isSearch':!0x1,'class':_0x40865a[_0x2e2a4f(0x1ba)],'msg':_0x5f13ee[_0x2e2a4f(0xee)]}));}finally{_0x40865a[_0x2e2a4f(0x1e4)](_0x40865a[_0x2e2a4f(0x14f)],_0x40865a[_0x2e2a4f(0x14f)])?(_0x2a3981[_0x2e2a4f(0xfc)](_0x40865a[_0x2e2a4f(0x17c)],_0x1d0f20),_0x378d41[_0x2e2a4f(0x87)](_0x458d56['stringify']({'isPrint':!0x1,'class':_0x40865a['UGLIY'],'msg':_0x23d632['message']}))):_0x3edf01[_0x2e2a4f(0x173)]();}}),b[_0x4966d2(0x120)](x,_0x4f28ed[_0x4966d2(0x13e)],async(_0x56c2fc,_0x136aef)=>{const _0x5d6506=_0x4966d2,_0x279c14={'fiTuB':_0x5d6506(0x1cf),'zkuro':function(_0x4f2837,_0x4afe10){return _0x4f2837+_0x4afe10;},'QWvfM':_0x5d6506(0x187),'NiiQz':_0x5d6506(0x1a9),'DkBis':_0x5d6506(0x1f4),'Qjicu':function(_0x2f9d1f,_0x66fa81){return _0x2f9d1f(_0x66fa81);},'uztkf':function(_0x1449f7,_0x3f948a){return _0x1449f7!==_0x3f948a;},'AkbxS':_0x5d6506(0x16d),'DfrRM':function(_0x4d5254,_0x5cf16d){return _0x4d5254===_0x5cf16d;},'ZEgtc':_0x5d6506(0x176),'mgLCj':_0x5d6506(0xf5),'uUAfy':_0x5d6506(0x165),'uoAGW':_0x5d6506(0x131),'BiYBf':function(_0x1a3b8e,_0x185b75){return _0x1a3b8e===_0x185b75;},'qTPWe':_0x5d6506(0xa2),'GOvHE':function(_0xcc273e,_0x27a083){return _0xcc273e==_0x27a083;},'WwGiD':function(_0x4c9c45,_0x57ddfd){return _0x4c9c45===_0x57ddfd;},'pbYcn':'brbef','albxy':_0x5d6506(0x102),'fxiAX':function(_0x34eccb,_0x426b6f){return _0x34eccb==_0x426b6f;},'opYyS':function(_0x27ea5d,_0x520d03){return _0x27ea5d==_0x520d03;},'inTcU':function(_0x15b8f8,_0x3a7a91){return _0x15b8f8!==_0x3a7a91;},'WAlpS':_0x5d6506(0x17f),'TNPGr':function(_0x37d881,_0x6e4365){return _0x37d881==_0x6e4365;},'DQpen':_0x5d6506(0x123),'JVNJo':_0x5d6506(0xde),'TKPsv':function(_0x18ae58,_0x209390){return _0x18ae58===_0x209390;},'ESGnV':'mMVeQ','VGkTl':_0x5d6506(0xc8),'WlnzI':'vrtjZ'};let {docId:_0xbdbcb9,action:_0x2d6cd8}=_0x56c2fc['body'];const _0x4cd81f=await _0x5de494[_0x5d6506(0x1ff)](_0x56c2fc);await _0x3a303a['getMainDocPathObj'](_0x56c2fc,_0x136aef,_0x4cd81f[_0x5d6506(0x10a)]);const {collectionName:_0x201db6}=_0x6aa427['get_Info_ByUrl'](_0x56c2fc[_0x5d6506(0xd5)]),_0x206b68=new _0x56b1a3(global[_0x5d6506(0xf6)]);try{if(_0x279c14[_0x5d6506(0x8b)](_0x279c14[_0x5d6506(0x8e)],_0x279c14[_0x5d6506(0x8e)]))_0x2f9e14[_0x5d6506(0x173)]();else{await _0x206b68[_0x5d6506(0x89)]();const _0x271cd2=_0x206b68['db'](global[_0x5d6506(0x9b)])[_0x5d6506(0x201)](_0x201db6);if(_0x279c14[_0x5d6506(0x180)](_0x2d6cd8,_0x279c14[_0x5d6506(0x1d6)])){if(_0x279c14['DfrRM'](_0x279c14[_0x5d6506(0xc3)],_0x279c14[_0x5d6506(0xf3)]))return _0x205ea7['log'](_0x3e395a),_0x2bd379['send'](_0x3fe434[_0x5d6506(0x1ab)]({'isFetch':!0x1,'class':_0x279c14[_0x5d6506(0x158)],'msg':_0x1b3c18[_0x5d6506(0xee)]}));else{const _0x3cc050=['O','S'][_0x5d6506(0x95)](_0x4cd81f['userAuthority'])?{'docId':_0xbdbcb9}:{'docId':_0xbdbcb9,'userId':_0x4cd81f[_0x5d6506(0x18b)]};var _0x21de57=await _0x271cd2[_0x5d6506(0x101)](_0x3cc050,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x279c14[_0x5d6506(0x180)](_0x2d6cd8,_0x279c14[_0x5d6506(0x1c9)]))var _0x21de57=await _0x271cd2[_0x5d6506(0x101)]({'userId':_0x4cd81f[_0x5d6506(0x18b)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x4a4355=_0x21de57?'':_0x279c14[_0x5d6506(0x151)](_0x2d6cd8,_0x279c14['ZEgtc'])?'ไม่พบเอกสารเลขที่\x20\x22'+_0xbdbcb9+'\x22':_0x279c14[_0x5d6506(0xd2)];if(!_0x21de57)return _0x136aef['send'](JSON[_0x5d6506(0x1ab)]({'isLoad':!0x1,'class':_0x279c14[_0x5d6506(0x158)],'msg':_0x4a4355}));let _0x5b6ce7=_0x5d6506(0x171)+_0x21de57[_0x5d6506(0x88)]+_0x5d6506(0x188);if(_0x279c14[_0x5d6506(0x1a2)](_0x21de57[_0x5d6506(0x1ed)],0x1)&&_0x21de57[_0x5d6506(0xbf)]){if(_0x279c14[_0x5d6506(0x177)](_0x279c14[_0x5d6506(0x1fe)],_0x279c14[_0x5d6506(0x1fe)])){let _0x9c4244=await _0x6aa427['check_DocDateTime_CanEdit'](_0x21de57,_0x201db6,_0x4cd81f[_0x5d6506(0x18b)]);_0x21de57['dateTimeEditRemain']=_0x9c4244['dateTimeEditRemain'],_0x279c14['GOvHE'](_0x9c4244[_0x5d6506(0x17a)],!0x1)&&(_0x21de57[_0x5d6506(0x1ed)]=_0x9c4244[_0x5d6506(0x1ed)],_0x5b6ce7+=_0x279c14['albxy']);}else(function(){return!![];}[_0x5d6506(0x135)](rzzugQ[_0x5d6506(0x146)](rzzugQ[_0x5d6506(0x156)],rzzugQ[_0x5d6506(0x194)]))[_0x5d6506(0x18f)](rzzugQ[_0x5d6506(0xaf)]));}else _0x21de57[_0x5d6506(0x82)]='-';if((_0x279c14[_0x5d6506(0x153)](_0x21de57[_0x5d6506(0x1ed)],0x1)||_0x279c14[_0x5d6506(0x115)](_0x21de57[_0x5d6506(0x1ed)],0x2))&&_0x21de57[_0x5d6506(0xc1)]){if(_0x279c14[_0x5d6506(0x1a3)](_0x279c14[_0x5d6506(0xea)],_0x279c14[_0x5d6506(0xea)]))_0x512b37['close']();else{const _0x509bd1=await _0x6aa427[_0x5d6506(0x1df)](_0x21de57,_0x201db6,_0x4cd81f['userId']);_0x21de57[_0x5d6506(0x1e6)]=_0x509bd1['dateTimeCancelRemain'],_0x279c14[_0x5d6506(0x185)](_0x509bd1[_0x5d6506(0x105)],!0x1)&&(_0x5b6ce7+=_0x279c14[_0x5d6506(0x1fd)]);}}else _0x21de57[_0x5d6506(0x1e6)]='-';const {branchName:_0x1f5353}=await _0x6aa427[_0x5d6506(0xe1)](_0x21de57[_0x5d6506(0xdc)]);return _0x21de57['branchName']=_0x1f5353,_0x136aef[_0x5d6506(0x87)](JSON[_0x5d6506(0x1ab)]({'doc':_0x21de57,'isLoad':!0x0,'class':_0x279c14[_0x5d6506(0x1db)],'msg':_0x5b6ce7}));}}catch(_0x242e26){if(_0x279c14[_0x5d6506(0xb3)](_0x279c14['ESGnV'],_0x279c14[_0x5d6506(0x1cd)])){if(_0x5c5497)return _0x1cee54;else rzzugQ[_0x5d6506(0x16a)](_0x4e45c2,0x0);}else return console[_0x5d6506(0xfc)](_0x242e26),_0x136aef[_0x5d6506(0x87)](JSON[_0x5d6506(0x1ab)]({'isLoad':!0x1,'class':_0x279c14[_0x5d6506(0x158)],'msg':_0x242e26[_0x5d6506(0xee)]}));}finally{if(_0x279c14[_0x5d6506(0x1a3)](_0x279c14[_0x5d6506(0x91)],_0x279c14['WlnzI'])){const _0x2b0fa0=_0x507bb6['body'],_0x5b90a0=_0x2c5b6a[_0x5d6506(0x136)];return _0x130aea[_0x5d6506(0x1d7)](_0x2b0fa0[_0x5d6506(0x16c)],_0x2b0fa0[_0x5d6506(0xb4)],_0x5b90a0[_0x5d6506(0x154)],_0x5b90a0[_0x5d6506(0x16c)],_0x5b90a0['offsetHeight']);}else _0x206b68[_0x5d6506(0x173)]();}}),b['post'](M,_0x4f28ed[_0x4966d2(0x13e)],async(_0x2c18ae,_0xcd83b4)=>{const _0x462cd5=_0x4966d2,_0x2dc991={'oiZfx':function(_0x518959,_0x263858){return _0x518959===_0x263858;},'CHMih':_0x462cd5(0xd9),'DFiCQ':'red','xcXdj':function(_0x30b759,_0x10756f){return _0x30b759<_0x10756f;},'bsBEZ':'yellow','wVKaP':_0x462cd5(0x86),'uWhVx':_0x462cd5(0x92),'gRRJJ':_0x462cd5(0xde),'rSEoT':'sthKF','AGNpF':_0x462cd5(0xc2),'kgGWB':'error\x20===>\x20','AZfIN':_0x462cd5(0xbb)},{docId:_0x50e160}=_0x2c18ae[_0x462cd5(0x191)],_0x2d5230=await _0x5de494['getUserData'](_0x2c18ae);await _0x3a303a[_0x462cd5(0x80)](_0x2c18ae,_0xcd83b4,_0x2d5230['userAuthority']);const {collectionName:_0x427d43}=_0x6aa427['get_Info_ByUrl'](_0x2c18ae['originalUrl']),_0x2eb8b4=new _0x56b1a3(global['dbUrl']);try{if(_0x2dc991[_0x462cd5(0x84)](_0x2dc991[_0x462cd5(0x128)],_0x2dc991[_0x462cd5(0x128)])){await _0x2eb8b4[_0x462cd5(0x89)]();var _0x4b4529=await _0x2eb8b4['db'](global[_0x462cd5(0x9b)])[_0x462cd5(0x201)](_0x427d43)['findOne']({'docId':_0x50e160});if(!_0x4b4529)return _0xcd83b4['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x2dc991[_0x462cd5(0x192)],'msg':_0x462cd5(0x168)+_0x50e160+'\x22'}));const _0x4af248=_0x4b4529[_0x462cd5(0x107)]||[];if(_0x2dc991[_0x462cd5(0xbd)](_0x4af248[_0x462cd5(0x12d)],0x1))return _0xcd83b4['send'](JSON[_0x462cd5(0x1ab)]({'isPrint':!0x1,'class':_0x2dc991[_0x462cd5(0x9f)],'msg':_0x2dc991['wVKaP']}));const _0x12cf18=_0x133094[_0x462cd5(0xd4)](folderForms,_0x2dc991[_0x462cd5(0x110)]),_0x52e8a9=await _0x4dcfcf[_0x462cd5(0xf9)](_0x12cf18,_0xcd83b4,{'title':_0x4b4529['docId'],'time':_0x526523[_0x462cd5(0x1e7)](new Date()),'changesHistory':_0x4af248});_0xcd83b4['send'](JSON[_0x462cd5(0x1ab)]({'isPrint':!0x0,'class':_0x2dc991[_0x462cd5(0x17b)],'htmlPage':_0x52e8a9}));}else return![];}catch(_0x10bf31){if(_0x2dc991['oiZfx'](_0x2dc991[_0x462cd5(0x186)],_0x2dc991[_0x462cd5(0xa9)])){if(_0x2be3ac){const _0x551897=_0x4797ce[_0x462cd5(0x163)](_0x1e4305,arguments);return _0x5331aa=null,_0x551897;}}else console[_0x462cd5(0xfc)](_0x2dc991[_0x462cd5(0x1ce)],_0x10bf31),_0xcd83b4['send'](JSON[_0x462cd5(0x1ab)]({'isPrint':!0x1,'class':_0x2dc991[_0x462cd5(0x192)],'msg':_0x10bf31[_0x462cd5(0xee)]}));}finally{if(_0x2dc991[_0x462cd5(0x84)](_0x2dc991['AZfIN'],_0x2dc991[_0x462cd5(0x1a4)]))_0x2eb8b4[_0x462cd5(0x173)]();else{const _0x213be5=_0x51cedf?function(){const _0x52b891=_0x462cd5;if(_0x27fca9){const _0x3e8098=_0x5cca9a[_0x52b891(0x163)](_0x162d62,arguments);return _0x32f1e2=null,_0x3e8098;}}:function(){};return _0x40e2af=![],_0x213be5;}}}),b[_0x4966d2(0x120)](v,_0x4f28ed[_0x4966d2(0x13e)],async(_0x1ae145,_0x2fe112)=>{const _0x1fdc05=_0x4966d2,_0x4c4470={'ITSiv':_0x1fdc05(0x14c),'mSbyX':_0x1fdc05(0x99),'SjkfS':function(_0x369b59,_0x1813d7){return _0x369b59===_0x1813d7;},'eGIUP':_0x1fdc05(0xe9),'JbruI':'jxSmh','MLRje':'red','OUKOK':function(_0x44a903,_0x423548){return _0x44a903(_0x423548);},'oFniT':function(_0x5bcc90,_0x508fe7){return _0x5bcc90+_0x508fe7;},'ruOIw':_0x1fdc05(0x1bd),'pSAkN':_0x1fdc05(0x1bb),'IWWoW':function(_0x308cf4,_0x477a86){return _0x308cf4===_0x477a86;},'rOQBp':_0x1fdc05(0x15d),'lSawI':'doc_print.ejs','JFZXw':function(_0xd71d0f,_0x2a482a){return _0xd71d0f==_0x2a482a;},'obAJK':_0x1fdc05(0x1f1),'JdnPd':_0x1fdc05(0xde),'qvgTD':function(_0x284e2,_0x248825){return _0x284e2==_0x248825;},'sbJJJ':_0x1fdc05(0x1c2),'ifgTC':'dGFYM','NGsKP':_0x1fdc05(0x1b5),'XeRJn':_0x1fdc05(0x1dc),'lmKvN':function(_0x11f57c,_0x25ac1c){return _0x11f57c*_0x25ac1c;},'hcQBO':function(_0x576d02,_0x11ca7f){return _0x576d02/_0x11ca7f;},'ugVyq':_0x1fdc05(0x132),'wbTTr':_0x1fdc05(0xb6),'znTAq':_0x1fdc05(0x98),'VhhLv':_0x1fdc05(0xc9),'MUgyc':_0x1fdc05(0x179),'vZWPW':function(_0x26e41f,_0x4aaefd){return _0x26e41f===_0x4aaefd;},'umsUI':_0x1fdc05(0x19d),'fyLZd':_0x1fdc05(0x7e)},{docId:_0x4c6b71,action:_0x9387e3}=_0x1ae145['body'],_0x3aea3d=await _0x5de494[_0x1fdc05(0x1ff)](_0x1ae145);await _0x3a303a[_0x1fdc05(0x80)](_0x1ae145,_0x2fe112,_0x3aea3d[_0x1fdc05(0x10a)]);const {collectionName:_0x4d88f1,docTitle:_0x2a5379}=_0x6aa427['get_Info_ByUrl'](_0x1ae145[_0x1fdc05(0xd5)]),_0x212c29=new _0x56b1a3(global[_0x1fdc05(0xf6)]);try{if(_0x4c4470[_0x1fdc05(0xef)](_0x4c4470[_0x1fdc05(0x81)],_0x4c4470[_0x1fdc05(0x81)])){await _0x212c29[_0x1fdc05(0x89)]();var _0x4c2fb8=await _0x212c29['db'](global['dbName'])[_0x1fdc05(0x201)](_0x4d88f1)[_0x1fdc05(0x101)]({'docId':_0x4c6b71});if(!_0x4c2fb8)return _0x2fe112[_0x1fdc05(0x87)](JSON[_0x1fdc05(0x1ab)]({'isLoad':!0x1,'class':_0x4c4470[_0x1fdc05(0xa5)],'msg':_0x1fdc05(0x168)+_0x4c6b71+'\x22'}));_0x4c2fb8['docTitle']=_0x2a5379,_0x4c2fb8[_0x1fdc05(0x1d9)]=_0x6aa427['get_StatusName_byStatusNumber'](_0x4c2fb8[_0x1fdc05(0x1ed)]);const _0x46b9b7=_0x6aa427[_0x1fdc05(0x1b7)](_0x4c2fb8),_0x45652e=_0x133094[_0x1fdc05(0xd4)](folderForms,_0x4c4470[_0x1fdc05(0x17d)]),_0x1e5b3f=await _0x4dcfcf[_0x1fdc05(0xf9)](_0x45652e,_0x2fe112,{'title':_0x4c6b71,'time':_0x526523['formatDate'](new Date()),'action':_0x9387e3,'doc':_0x46b9b7});if(_0x4c4470[_0x1fdc05(0x8c)](_0x9387e3,_0x4c4470['obAJK']))_0x2fe112[_0x1fdc05(0x87)](JSON[_0x1fdc05(0x1ab)]({'isPrint':!0x0,'class':_0x4c4470['JdnPd'],'htmlPage':_0x1e5b3f}));else{if(_0x4c4470[_0x1fdc05(0x1f8)](_0x9387e3,_0x4c4470[_0x1fdc05(0xa1)])){if(_0x4c4470[_0x1fdc05(0xd7)](_0x4c4470[_0x1fdc05(0x147)],_0x4c4470[_0x1fdc05(0x147)])){const _0x5a406c=await(await import(_0x4c4470['NGsKP']))[_0x1fdc05(0xd6)](),_0x30e512=await _0x5a406c[_0x1fdc05(0xab)]();await _0x30e512[_0x1fdc05(0x1b4)](_0x1e5b3f,{'waitUntil':_0x4c4470[_0x1fdc05(0xa8)],'timeout':0x2710}),await new Promise(_0x277fc5=>setTimeout(_0x277fc5,0x3e8));const _0x318ef2=Math[_0x1fdc05(0xf2)](_0x4c4470['lmKvN'](_0x4c4470['hcQBO'](0x50,25.4),0x60));await _0x30e512['setViewport']({'width':_0x318ef2,'height':0x258,'deviceScaleFactor':0x1});const _0xc55e9f=await _0x30e512[_0x1fdc05(0x114)](()=>{const _0x186844=_0x1fdc05,_0x41a361={'vPqOl':_0x4c4470[_0x186844(0x1d1)],'dfFdC':_0x4c4470[_0x186844(0x118)]};if(_0x4c4470[_0x186844(0xd7)](_0x4c4470[_0x186844(0x1bf)],_0x4c4470[_0x186844(0x1fa)]))return function(_0x33f9ad){}['constructor'](gKdfvJ['vPqOl'])[_0x186844(0x163)](gKdfvJ[_0x186844(0x1ae)]);else{const _0x4f295c=document[_0x186844(0x191)],_0x4e5acf=document['documentElement'];return Math[_0x186844(0x1d7)](_0x4f295c[_0x186844(0x16c)],_0x4f295c[_0x186844(0xb4)],_0x4e5acf[_0x186844(0x154)],_0x4e5acf[_0x186844(0x16c)],_0x4e5acf[_0x186844(0xb4)]);}}),_0x1578eb=await _0x30e512[_0x1fdc05(0x104)]({'type':_0x4c4470['ugVyq'],'clip':{'x':0x0,'y':0x0,'width':_0x318ef2,'height':_0xc55e9f},'omitBackground':!0x1});await _0x5a406c[_0x1fdc05(0x173)]();const _0x38fadd=_0x4c2fb8[_0x1fdc05(0x88)][_0x1fdc05(0x1c5)](/\//g,'');_0x2fe112['writeHead'](0xc8,{'Content-Type':_0x4c4470[_0x1fdc05(0x116)],'Content-Disposition':_0x1fdc05(0x1a6)+_0x38fadd+_0x1fdc05(0xaa),'Content-Length':_0x1578eb[_0x1fdc05(0x12d)]}),_0x2fe112['end'](_0x1578eb);}else _0x261bad['log'](_0x2f1477),_0x575c42[_0x1fdc05(0x87)](_0x1b7cd7[_0x1fdc05(0x1ab)]({'isStatus':!0x1,'class':_0x4c4470['MLRje'],'msg':_0x3cd52e[_0x1fdc05(0xee)]}));}}}else _0x287f31=_0x354d33;}catch(_0x5919ba){if(_0x4c4470['SjkfS'](_0x4c4470[_0x1fdc05(0xd0)],_0x4c4470[_0x1fdc05(0x106)])){const _0x17b0a9=_0x1bd30b[_0x1fdc05(0x163)](_0x43f061,arguments);return _0x37ebb7=null,_0x17b0a9;}else console['log'](_0x4c4470[_0x1fdc05(0x1c1)],_0x5919ba),_0x2fe112[_0x1fdc05(0x87)](JSON[_0x1fdc05(0x1ab)]({'isPrint':!0x1,'class':_0x4c4470[_0x1fdc05(0xa5)],'msg':_0x5919ba[_0x1fdc05(0xee)]}));}finally{_0x4c4470[_0x1fdc05(0xcd)](_0x4c4470[_0x1fdc05(0x13f)],_0x4c4470[_0x1fdc05(0x140)])?_0x400ab0=mUGRoB[_0x1fdc05(0x1f0)](_0x1358fc,mUGRoB['oFniT'](mUGRoB['oFniT'](mUGRoB[_0x1fdc05(0x141)],mUGRoB[_0x1fdc05(0x1d5)]),');'))():_0x212c29[_0x1fdc05(0x173)]();}}),b[_0x4966d2(0x120)](k,_0x4f28ed['isAuth'],async(_0x130f2b,_0x5d8c12)=>{const _0x436ae7=_0x4966d2,_0x41978a={'BOoJk':_0x436ae7(0xc4),'QIwSY':_0x436ae7(0x1f9),'IpxnF':function(_0x20d9c0,_0x21bee2){return _0x20d9c0(_0x21bee2);},'iNMpc':_0x436ae7(0x1e1),'jmxPd':function(_0x298904,_0x5482a3){return _0x298904+_0x5482a3;},'KuDxH':_0x436ae7(0x122),'yfnKm':'input','gamvh':function(_0x3f6f6b){return _0x3f6f6b();},'YmunY':function(_0x13a1ab,_0xd9a727,_0x571f7b){return _0x13a1ab(_0xd9a727,_0x571f7b);},'rrgev':_0x436ae7(0x1cf),'afLRp':function(_0x5cf662,_0x695714){return _0x5cf662==_0x695714;},'COFjq':_0x436ae7(0x8f),'EILen':'ยกเลิก','tRHRc':_0x436ae7(0x183),'EByGE':_0x436ae7(0x1cc),'kfjQs':function(_0x57c6c0,_0x40ce92){return _0x57c6c0===_0x40ce92;},'ibVmm':function(_0x299bc2,_0x27b18d){return _0x299bc2==_0x27b18d;},'cpZZB':function(_0x27271d,_0x4c7d8d){return _0x27271d==_0x4c7d8d;},'gggVm':_0x436ae7(0xa7),'uQrHt':_0x436ae7(0x15e),'TQPJg':_0x436ae7(0x198),'syIKf':function(_0x14ded6,_0x5ad409){return _0x14ded6==_0x5ad409;},'VtHIl':function(_0x441ac1,_0x221d15){return _0x441ac1==_0x221d15;},'Khtgk':function(_0x3a382f,_0x3f6196){return _0x3a382f==_0x3f6196;},'LNkjv':function(_0x1839d2,_0x59a2d7){return _0x1839d2>_0x59a2d7;},'onnfk':function(_0x5c3897,_0x2a185d){return _0x5c3897>_0x2a185d;},'afuVW':function(_0x26f1e7,_0xb55e7d){return _0x26f1e7!==_0xb55e7d;},'vHnDN':'fdQmP','pzhYS':_0x436ae7(0x15f),'htRRl':_0x436ae7(0x7f),'SJrjX':_0x436ae7(0xde),'zYeke':function(_0x17df04,_0x4050e7){return _0x17df04<_0x4050e7;},'hgMgW':_0x436ae7(0x1ef)},_0xf91d4b=new _0x56b1a3(global[_0x436ae7(0xf6)]);try{const _0x1b4b03=await _0x5de494[_0x436ae7(0x1ff)](_0x130f2b);await _0x3a303a[_0x436ae7(0x80)](_0x130f2b,_0x5d8c12,_0x1b4b03[_0x436ae7(0x10a)]);const {collectionName:_0x35c149}=_0x6aa427['get_Info_ByUrl'](_0x130f2b['originalUrl']),{docId:_0x3a672e,action:_0x653437}=_0x130f2b['body'],_0x3ef3c0=_0x41978a[_0x436ae7(0x19e)](_0x653437,_0x41978a[_0x436ae7(0xe3)])?_0x41978a[_0x436ae7(0x137)]:_0x41978a[_0x436ae7(0x19e)](_0x653437,_0x41978a[_0x436ae7(0x13b)])?'จบ':'';if(!_0x3a672e||![_0x41978a[_0x436ae7(0x13b)],_0x41978a['COFjq']][_0x436ae7(0x95)](_0x653437))return _0x5d8c12[_0x436ae7(0x87)](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x41978a[_0x436ae7(0x149)]}));const _0x13d836={'docId':_0x3a672e,'userId':_0x1b4b03[_0x436ae7(0x18b)]},_0x22891b=_0xf91d4b['db'](global[_0x436ae7(0x9b)])[_0x436ae7(0x201)](_0x35c149),_0x469f4d=await _0x22891b[_0x436ae7(0x101)](_0x13d836);if(!_0x469f4d)return _0x5d8c12[_0x436ae7(0x87)](JSON['stringify']({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x436ae7(0x1b6)+_0x3a672e+_0x436ae7(0x162)+_0x3ef3c0+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x26058d=_0x469f4d[_0x436ae7(0x1ed)];if(_0x41978a[_0x436ae7(0x1ee)](_0x653437,_0x41978a[_0x436ae7(0xe3)])&&!(_0x41978a[_0x436ae7(0xdf)](_0x26058d,0x1)||_0x41978a[_0x436ae7(0x10f)](_0x26058d,0x2)))return _0x5d8c12[_0x436ae7(0x87)](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x41978a['gggVm']}));if(_0x41978a['kfjQs'](_0x653437,_0x41978a['tRHRc'])&&_0x41978a[_0x436ae7(0x19e)](!_0x26058d,0x1))return _0x5d8c12[_0x436ae7(0x87)](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x41978a[_0x436ae7(0x8d)]}));if(_0x41978a['afLRp'](_0x653437,_0x41978a[_0x436ae7(0xe3)])){if(_0x41978a[_0x436ae7(0x1ee)](_0x41978a[_0x436ae7(0x1b8)],_0x41978a[_0x436ae7(0x1b8)])){if(_0x41978a[_0x436ae7(0x1ca)](_0x469f4d['canCancel'],!0x1))return _0x5d8c12[_0x436ae7(0x87)](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x436ae7(0x138)+_0x3a672e+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x41978a[_0x436ae7(0x152)]((await _0x6aa427[_0x436ae7(0x1df)](_0x469f4d,_0x35c149,_0x1b4b03[_0x436ae7(0x18b)]))['canCancel'],!0x1))return _0x5d8c12['send'](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':'เอกสาร\x20\x22'+_0x3a672e+_0x436ae7(0x121)}));}else{const _0x45e53b={'OhLbJ':bSVuRt[_0x436ae7(0x175)],'hIsVG':bSVuRt[_0x436ae7(0x15c)],'tEzUW':function(_0x2f18df,_0x4622ed){const _0x394e29=_0x436ae7;return bSVuRt[_0x394e29(0xa0)](_0x2f18df,_0x4622ed);},'UcXyL':bSVuRt[_0x436ae7(0x178)],'DTREj':function(_0x4cdaec,_0x3f573b){return bSVuRt['jmxPd'](_0x4cdaec,_0x3f573b);},'JRXvM':bSVuRt['KuDxH'],'eOqTu':function(_0x28b942,_0x56df3c){return bSVuRt['jmxPd'](_0x28b942,_0x56df3c);},'qpRTP':bSVuRt[_0x436ae7(0x143)],'EbzoP':function(_0x4c177c){return bSVuRt['gamvh'](_0x4c177c);}};bSVuRt[_0x436ae7(0x12b)](_0x20094d,this,function(){const _0x54cd05=_0x436ae7,_0x1f1d87=new _0x4cc79e(_0x45e53b[_0x54cd05(0x1a8)]),_0x46408a=new _0x540b8c(_0x45e53b[_0x54cd05(0xa4)],'i'),_0x35bb0a=_0x45e53b['tEzUW'](_0x1d184c,_0x45e53b['UcXyL']);!_0x1f1d87[_0x54cd05(0x1a0)](_0x45e53b[_0x54cd05(0x1af)](_0x35bb0a,_0x45e53b['JRXvM']))||!_0x46408a['test'](_0x45e53b['eOqTu'](_0x35bb0a,_0x45e53b[_0x54cd05(0x10d)]))?_0x45e53b[_0x54cd05(0x13c)](_0x35bb0a,'0'):_0x45e53b[_0x54cd05(0x142)](_0x41914c);})();}}if(_0x41978a[_0x436ae7(0x1e3)](_0x653437,_0x41978a['COFjq']))var _0x59d85c=0xa;else{if(_0x41978a[_0x436ae7(0x152)](_0x653437,_0x41978a[_0x436ae7(0x13b)]))var _0x59d85c=0x2;}const _0xdc4bba=await _0x22891b[_0x436ae7(0xba)](_0x13d836,{'$set':{'docStatusNumber':_0x59d85c}});var _0x241e37=_0x3ef3c0+'\x20\x22'+_0x3a672e+_0x436ae7(0xda);if(_0xdc4bba[_0x436ae7(0xfe)]||_0x41978a['LNkjv'](_0xdc4bba[_0x436ae7(0x11c)],0x0)){const _0x28675a=_0x6aa427[_0x436ae7(0x108)]({'docStatusNumber':_0x26058d},{'docStatusNumber':_0x59d85c});if(_0x41978a[_0x436ae7(0x139)](_0x28675a[_0x436ae7(0x12d)],0x0)){if(_0x41978a[_0x436ae7(0x199)](_0x41978a[_0x436ae7(0x16b)],_0x41978a[_0x436ae7(0xb8)])){const _0x5f56da={'dateTime':_0x526523[_0x436ae7(0x8a)](new Date()),'userId':_0x1b4b03[_0x436ae7(0x18b)],'userFullname':_0x1b4b03[_0x436ae7(0xd1)],'changes':_0x28675a};await _0x22891b[_0x436ae7(0xba)]({'docId':_0x3a672e},{'$push':{'changesHistory':{'$each':[_0x5f56da],'$position':0x0}}}),_0x241e37+=_0x41978a[_0x436ae7(0x14e)];}else return _0x38b77b[_0x436ae7(0xfc)](_0x5f450d),_0x332e0a['send'](_0x32eaba[_0x436ae7(0x1ab)]({'isLoad':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x4c42d9[_0x436ae7(0xee)]}));}return _0x5d8c12[_0x436ae7(0x87)](JSON['stringify']({'isStatus':!0x0,'docId':_0x3a672e,'docStatusNumber':_0x59d85c,'class':_0x41978a[_0x436ae7(0xfd)],'msg':_0x241e37}));}else{if(_0xdc4bba[_0x436ae7(0xfe)]&&_0x41978a['zYeke'](_0xdc4bba['modifiedCount'],0x1))return _0x5d8c12[_0x436ae7(0x87)](JSON[_0x436ae7(0x1ab)]({'isStatus':!0x1,'docId':_0x3a672e,'docStatusNumber':_0x26058d,'class':_0x41978a[_0x436ae7(0x1c7)],'msg':'\x22'+_0x3a672e+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x466530){console[_0x436ae7(0xfc)](_0x466530),_0x5d8c12[_0x436ae7(0x87)](JSON['stringify']({'isStatus':!0x1,'class':_0x41978a[_0x436ae7(0x1b9)],'msg':_0x466530[_0x436ae7(0xee)]}));}finally{_0xf91d4b['close']();}});export default b;function _0x2242a7(_0x26a96d){const _0xd56ad6=_0x4966d2,_0x3e0503={'ZxZOO':function(_0x3e50f1,_0x239d29){return _0x3e50f1===_0x239d29;},'xbngN':'string','DVoqE':'while\x20(true)\x20{}','lHfCt':_0xd56ad6(0x99),'lJitQ':function(_0x3e4c51,_0x5d0737){return _0x3e4c51!==_0x5d0737;},'GeXcA':function(_0x20c501,_0x227705){return _0x20c501+_0x227705;},'PyITS':function(_0x4b740f,_0x32ce5f){return _0x4b740f/_0x32ce5f;},'RwXYe':_0xd56ad6(0x12d),'zkVPu':function(_0x13e738,_0x288be5){return _0x13e738%_0x288be5;},'QBRvN':_0xd56ad6(0x187),'kPcdG':_0xd56ad6(0x1a9),'acBxt':_0xd56ad6(0x1f4),'fHVxo':_0xd56ad6(0x1ec),'uZLmD':function(_0x26e9a5,_0x1af98a){return _0x26e9a5(_0x1af98a);}};function _0x4c4bcb(_0x479e3d){const _0x558d80=_0xd56ad6;if(_0x3e0503[_0x558d80(0xc7)](typeof _0x479e3d,_0x3e0503[_0x558d80(0x1e0)]))return function(_0xbb3d8e){}[_0x558d80(0x135)](_0x3e0503[_0x558d80(0x14a)])[_0x558d80(0x163)](_0x3e0503[_0x558d80(0xbc)]);else _0x3e0503[_0x558d80(0xdb)](_0x3e0503['GeXcA']('',_0x3e0503[_0x558d80(0x1fb)](_0x479e3d,_0x479e3d))[_0x3e0503[_0x558d80(0x133)]],0x1)||_0x3e0503[_0x558d80(0xc7)](_0x3e0503[_0x558d80(0x13d)](_0x479e3d,0x14),0x0)?function(){return!![];}[_0x558d80(0x135)](_0x3e0503[_0x558d80(0x12c)](_0x3e0503[_0x558d80(0xb1)],_0x3e0503[_0x558d80(0x1fc)]))[_0x558d80(0x18f)](_0x3e0503[_0x558d80(0x103)]):function(){return![];}[_0x558d80(0x135)](_0x3e0503[_0x558d80(0x12c)](_0x3e0503[_0x558d80(0xb1)],_0x3e0503[_0x558d80(0x1fc)]))[_0x558d80(0x163)](_0x3e0503['fHVxo']);_0x3e0503['uZLmD'](_0x4c4bcb,++_0x479e3d);}try{if(_0x26a96d)return _0x4c4bcb;else _0x3e0503['uZLmD'](_0x4c4bcb,0x0);}catch(_0x161b50){}}