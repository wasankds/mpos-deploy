const _0x1aaddc=_0x3a7a;(function(_0x5d5b12,_0x11bbc9){const _0xca5dd8=_0x3a7a,_0x2bb749=_0x5d5b12();while(!![]){try{const _0x4f8166=parseInt(_0xca5dd8(0x30f))/0x1*(-parseInt(_0xca5dd8(0x22b))/0x2)+-parseInt(_0xca5dd8(0x2e3))/0x3+parseInt(_0xca5dd8(0x22f))/0x4+parseInt(_0xca5dd8(0x2d6))/0x5*(-parseInt(_0xca5dd8(0x310))/0x6)+-parseInt(_0xca5dd8(0x290))/0x7*(-parseInt(_0xca5dd8(0x282))/0x8)+-parseInt(_0xca5dd8(0x30e))/0x9*(-parseInt(_0xca5dd8(0x1f9))/0xa)+parseInt(_0xca5dd8(0x236))/0xb;if(_0x4f8166===_0x11bbc9)break;else _0x2bb749['push'](_0x2bb749['shift']());}catch(_0x3bf292){_0x2bb749['push'](_0x2bb749['shift']());}}}(_0x1443,0x1c746));const _0x5cc1a8=(function(){const _0x2a5ed7=_0x3a7a,_0x44eb80={'qgoLD':function(_0xfc3286,_0x3b87b3){return _0xfc3286(_0x3b87b3);},'pmath':function(_0x31c94a,_0x20d419){return _0x31c94a+_0x20d419;},'zCFNc':function(_0x22efae,_0x108a82){return _0x22efae+_0x108a82;},'ZRvQl':_0x2a5ed7(0x240),'zIdxg':_0x2a5ed7(0x25b),'EESwc':function(_0x2c29ab){return _0x2c29ab();},'SEhwu':'log','QtKFS':_0x2a5ed7(0x1e8),'bgHxl':_0x2a5ed7(0x273),'vclac':_0x2a5ed7(0x331),'jnVnC':'exception','azwad':_0x2a5ed7(0x2d4),'rRUMx':_0x2a5ed7(0x32d),'VlTKg':function(_0x375f39,_0x3f3788){return _0x375f39<_0x3f3788;},'Zyshw':function(_0x2df208,_0x816b21){return _0x2df208!==_0x816b21;},'YyBny':'SuQgk','swUYS':_0x2a5ed7(0x2d7),'baBiZ':function(_0x2cc6f5,_0x156c90){return _0x2cc6f5===_0x156c90;},'WgyoL':_0x2a5ed7(0x206),'ySGlf':_0x2a5ed7(0x291),'VvpUD':_0x2a5ed7(0x2e0),'GFPHp':_0x2a5ed7(0x215)};let _0x138b00=!![];return function(_0xf7f45e,_0x1c2455){const _0x608015=_0x2a5ed7,_0x3b7a23={'kUKEG':function(_0x48b0dd,_0x24ec73){const _0x2d08d6=_0x3a7a;return _0x44eb80[_0x2d08d6(0x308)](_0x48b0dd,_0x24ec73);},'ikMRy':_0x44eb80[_0x608015(0x312)],'bMofl':_0x44eb80[_0x608015(0x231)],'XMWBE':function(_0x445962,_0x32fbb9){const _0x4ee589=_0x608015;return _0x44eb80[_0x4ee589(0x2c5)](_0x445962,_0x32fbb9);},'cNQXq':_0x44eb80['WgyoL'],'zbIJb':_0x44eb80[_0x608015(0x251)]};if(_0x44eb80['Zyshw'](_0x44eb80[_0x608015(0x294)],_0x44eb80[_0x608015(0x202)])){const _0x4bb5c3=_0x138b00?function(){const _0x49e5e8=_0x608015;if(_0x3b7a23[_0x49e5e8(0x1e7)](_0x3b7a23[_0x49e5e8(0x2ba)],_0x3b7a23['bMofl'])){if(_0x1c2455){if(_0x3b7a23['XMWBE'](_0x3b7a23['cNQXq'],_0x3b7a23[_0x49e5e8(0x327)])){const _0x2cb22b=_0xea3d80[_0x49e5e8(0x2c6)],_0x45d2a0=_0x2120dd[_0x49e5e8(0x264)];return _0x3ac46d['max'](_0x2cb22b['scrollHeight'],_0x2cb22b['offsetHeight'],_0x45d2a0[_0x49e5e8(0x326)],_0x45d2a0[_0x49e5e8(0x21a)],_0x45d2a0[_0x49e5e8(0x2b6)]);}else{const _0x1a7840=_0x1c2455[_0x49e5e8(0x268)](_0xf7f45e,arguments);return _0x1c2455=null,_0x1a7840;}}}else _0x28fe9d[_0x49e5e8(0x26f)]();}:function(){};return _0x138b00=![],_0x4bb5c3;}else{let _0x452e44;try{const _0x59fee6=_0x44eb80[_0x608015(0x25f)](_0x160e8e,_0x44eb80[_0x608015(0x1d9)](_0x44eb80['zCFNc'](_0x44eb80['ZRvQl'],_0x44eb80[_0x608015(0x33f)]),');'));_0x452e44=_0x44eb80[_0x608015(0x252)](_0x59fee6);}catch(_0x2f5438){_0x452e44=_0x44d5f5;}const _0xdf72c7=_0x452e44[_0x608015(0x1cd)]=_0x452e44['console']||{},_0x13a554=[_0x44eb80['SEhwu'],_0x44eb80['QtKFS'],_0x44eb80[_0x608015(0x20d)],_0x44eb80[_0x608015(0x26e)],_0x44eb80['jnVnC'],_0x44eb80['azwad'],_0x44eb80[_0x608015(0x29f)]];for(let _0x3d4488=0x0;_0x44eb80[_0x608015(0x2cd)](_0x3d4488,_0x13a554['length']);_0x3d4488++){const _0x2c8b98=_0x280d48['constructor'][_0x608015(0x2e9)][_0x608015(0x319)](_0x2b2dfb),_0x2e12d3=_0x13a554[_0x3d4488],_0x563365=_0xdf72c7[_0x2e12d3]||_0x2c8b98;_0x2c8b98[_0x608015(0x300)]=_0x3bbe12[_0x608015(0x319)](_0x21e9db),_0x2c8b98[_0x608015(0x316)]=_0x563365[_0x608015(0x316)][_0x608015(0x319)](_0x563365),_0xdf72c7[_0x2e12d3]=_0x2c8b98;}}};}());(function(){const _0x5ee631=_0x3a7a,_0x1dcf2f={'Exevm':function(_0x135f0e,_0x561ebf){return _0x135f0e+_0x561ebf;},'FhxGp':_0x5ee631(0x339),'uukWA':_0x5ee631(0x27b),'BxuXJ':_0x5ee631(0x2cc),'BzdPk':_0x5ee631(0x315),'hOLFJ':function(_0x596c8d,_0xe5434c){return _0x596c8d===_0xe5434c;},'poRmX':_0x5ee631(0x2d8),'gcUEG':_0x5ee631(0x2f1),'ieMnF':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','kxRsH':function(_0x502149,_0x4fd9ca){return _0x502149(_0x4fd9ca);},'vDzlW':'init','qsgpY':'chain','eSgGL':function(_0x215a79,_0x5a42d2){return _0x215a79+_0x5a42d2;},'YcIiB':_0x5ee631(0x1f4),'mQzWN':_0x5ee631(0x28e),'YKLNE':_0x5ee631(0x24f),'OPsPb':function(_0xedd14e,_0x45b9ef){return _0xedd14e!==_0x45b9ef;},'guOSM':_0x5ee631(0x2ef),'bcwGs':function(_0x2dd81a){return _0x2dd81a();},'VgCpy':function(_0xf41ac7,_0x47a74c,_0x411fc5){return _0xf41ac7(_0x47a74c,_0x411fc5);}};_0x1dcf2f['VgCpy'](_0x5cc1a8,this,function(){const _0x56d3cc=_0x5ee631,_0x3a201f={'bBTEP':_0x1dcf2f[_0x56d3cc(0x1fa)]};if(_0x1dcf2f[_0x56d3cc(0x205)](_0x1dcf2f[_0x56d3cc(0x2e7)],_0x1dcf2f[_0x56d3cc(0x2e7)])){const _0x4189f2=new RegExp(_0x1dcf2f[_0x56d3cc(0x306)]),_0x5b2411=new RegExp(_0x1dcf2f[_0x56d3cc(0x203)],'i'),_0x2fb4d3=_0x1dcf2f['kxRsH'](_0x5d495a,_0x1dcf2f[_0x56d3cc(0x2c4)]);if(!_0x4189f2[_0x56d3cc(0x2fb)](_0x1dcf2f['Exevm'](_0x2fb4d3,_0x1dcf2f[_0x56d3cc(0x320)]))||!_0x5b2411[_0x56d3cc(0x2fb)](_0x1dcf2f['eSgGL'](_0x2fb4d3,_0x1dcf2f[_0x56d3cc(0x30c)])))_0x1dcf2f['hOLFJ'](_0x1dcf2f[_0x56d3cc(0x239)],_0x1dcf2f[_0x56d3cc(0x1d8)])?function(){return![];}[_0x56d3cc(0x20c)](_0x1dcf2f['Exevm'](_0x1dcf2f['FhxGp'],_0x1dcf2f[_0x56d3cc(0x20b)]))[_0x56d3cc(0x268)](_0x1dcf2f[_0x56d3cc(0x201)]):_0x1dcf2f[_0x56d3cc(0x23e)](_0x2fb4d3,'0');else{if(_0x1dcf2f['OPsPb'](_0x1dcf2f[_0x56d3cc(0x211)],_0x1dcf2f[_0x56d3cc(0x211)]))return _0x3619da[_0x56d3cc(0x277)](_0x591da2),_0x1c5d81[_0x56d3cc(0x217)](_0x13f6a9['stringify']({'isFetch':!0x1,'class':_0x3a201f[_0x56d3cc(0x1e3)],'msg':_0xf2f1c2[_0x56d3cc(0x232)]}));else _0x1dcf2f[_0x56d3cc(0x1da)](_0x5d495a);}}else _0xa89e77[_0x56d3cc(0x277)](_0x43944d),_0x28d2ba[_0x56d3cc(0x217)](_0x1bd29c[_0x56d3cc(0x1fb)]({'isStatus':!0x1,'class':_0x1dcf2f['BzdPk'],'msg':_0x42d9ed[_0x56d3cc(0x232)]}));})();}());function _0x1443(){const _0x374a51=['string','YyBny','VMJnV','qhxVD','red','toString','NwkzX','bmRtO','bind','LbyAO','findOne','statusName','SwAnR','PWEKn','sales','qsgpY','attachment;\x20filename=','NJLLC','iSWop','OPqSX','RVwiR','clientHeight','zbIJb','SMrrz','LOEVI','ไม่พบเอกสารเลขที่\x20\x22','{{sep}}หรือไม่มีสิทธิ์','BZZjV','trace','sWwjn','PATH_WAREHOUSE_IN','warehouseIn','error','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','xntQA','TkRGv','dateTimeCanCancel','max','sLPAQ','NOzBF','debu','cancel','canEdit','TFHiW','dateTimeCancelRemain','XgBiD','zIdxg','btsdY','vohfC','exception','fMwMu','ePNjx','canCancel','hiLZj','ljRWK','FwlfQ','rtVZX','AoIdL','/load','Tuhdo','console','dPLwM','ndqAk','zSAOb','HFbtr','RSgPE','gYVnq','/print','xRzEf','TWTBO','convert_DocPrint','YKLNE','pmath','bcwGs','dBfSi','cpppM','NNWsl','AcAaz','ALpNX','active','เอกสาร\x20\x22','originalUrl','bBTEP','call','UJvMp','error\x20===>\x20','kUKEG','warn','TJnWN','MCbNF','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','ไม่พบเอกสาร\x20\x22','wFuxV','image','isAuth','jCuUO','floor','blSgX','UbnHn','input','โหลดเอกสารเลขที่\x20\x22','ZyJgz','dateTimeCanEdit','tMXoG','580MOQaJy','BzdPk','stringify','doFue','getMainDocPathObj','rCDru','dZBhh','FnDgZ','BxuXJ','GFPHp','ieMnF','userFullname','hOLFJ','JDQiu','mrbWc','length','userAuthority','renderView','uukWA','constructor','bgHxl','kySbB','TCWLI','branchName','guOSM','ozwwx','toArray','tjJxz','lenwu','gbvHh','send','KEIxe','.jpeg','scrollHeight','idVke','jTNDQ','chain','POwyp','FNhII','get_StatusName_byStatusNumber','OeANj','KsjRH','jMeyY','maZIv','dbName','YNJyP','OSepF','nlouA','load-last','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','1954iBsuhO','docStatusNumber','\x22\x20เรียบร้อยแล้ว','replace','538272tecyLW','JeXZZ','swUYS','message','fuVsi','dCnqU','finish','832381PxEkUn','branchId','vnKyw','mQzWN','SvJDm','ywrYw','cHyQg','KGnZE','kxRsH','eKozJ','return\x20(function()\x20','KTyih','GNKol','collection','zOdQe','ZMjGk','AizvO','warehouseOut','UeUrS','เอกสารที่ตันเองไม่ได้สร้าง','matchedCount','stHGt','eXbBj','kIeWO','LBxnB','diqKg','yJlqV','ySGlf','EESwc','jpeg','get_Info_ByUrl','xkEwL','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','qtpVy','while\x20(true)\x20{}','vzMJn','getUserData','{}.constructor(\x22return\x20this\x22)(\x20)','{{sep}}[บันทึกการแก้ไข]','ไม่พบเอกสารล่าสุด','print','qgoLD','MBqai','YJSzu','includes','xaAWP','documentElement','formatDate','connect','green','apply','DHYqM','tKiin','LkcDS','nwXcA','end','vclac','close','yellow','DOC_TYPE','formatDateTime','info','sOdJb','action','pDDjH','log','ribWc','PhWKF','LZgNF','gger','/fetch/modal','OCFTM','petMy','zZMOf','updateOne','BPALl','8oUCEXu','พบ\x20\x22','docId','YiAIG','changesHistory','tUMne','getChangeHistory','iKqED','dbUrl','push','cKSKI','userId','YVHji','fmMJy','90062WTTaiG','sRdoV','XPgdo','jVOte','VvpUD','oeXWM','HdEBd','eavVO','KOCCr','ulWrB','aIKxp','fQLxY','CeUUU','iwEZP','xpKbw','rRUMx','dVnes','xJaUa','phhDh','hZGLT','JjUuS','getItems_for_Modal','iBjiN','oAfnE','MlxlT','lRPIO','get','SOLfP','aggregate','xGtch','HkOLZ','/search','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','ยกเลิก','/status','AGIKX','oQAOI','lSyif','offsetHeight','sqsHw','cTGHO','kWcUI','ikMRy','doc_changes.ejs','Npndp','doc_print.ejs','opEOn','XBwkd','TPLoV','image/jpeg','qOzcC','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','vDzlW','baBiZ','body','CUcOR','setContent','load','newPage','/load-last','stateObject','VlTKg','FGHRr','xNEZI','Fzknv','\x22\x20เอกสาร','EcQDo','KNjTO','table','xrpmo','85515CQfifu','meFNK','SCZqi','OPUSy','wiSMd','xOoSf','fGUyS','getUserBranchesById','izKFi','BVuqU','SYVKR','NMCEP','UNiOR','268143UIfTGy','screenshot','QboAP','GdSES','poRmX','KiCbm','prototype','OMkHg','networkidle0','PATH_WAREHOUSE_OUT','xUCGL','init','BZktc','WAqZi','function\x20*\x5c(\x20*\x5c)','sPvOm','UmBfu','puppeteer','FFtkd','check_DocDateTime_CanCancel','gjdjN','cLuUu','UbGmj','wVfOr','test','post','iiaIW','OleIC','fdSuK','__proto__','ybatJ','WoSWU','check_DocDateTime_CanEdit','WBehz','liTPe','gcUEG','/changes','Zyshw','wEufG','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','KKlZQ','YcIiB','join','747TrsRrr','5jIVCyV','6pNXKAX'];_0x1443=function(){return _0x374a51;};return _0x1443();}const _0x217af6=(function(){const _0x5ae01d=_0x3a7a,_0x493849={'ulWrB':function(_0x26b03f,_0x1cd362){return _0x26b03f===_0x1cd362;},'BZZjV':_0x5ae01d(0x23f),'xNEZI':_0x5ae01d(0x2e8),'xJaUa':'GHgzI','wEufG':'ZgYzq','pDDjH':_0x5ae01d(0x228),'SOLfP':_0x5ae01d(0x27d)};let _0x674475=!![];return function(_0x2d3088,_0x2e4cb5){const _0x986c6e=_0x5ae01d,_0x23677b={'oeXWM':function(_0x1d44cd,_0x5cb3e0){const _0x390171=_0x3a7a;return _0x493849[_0x390171(0x299)](_0x1d44cd,_0x5cb3e0);},'UNiOR':_0x493849[_0x986c6e(0x32c)],'cHyQg':_0x493849[_0x986c6e(0x2cf)],'yJlqV':function(_0x2631c9,_0x22c471){const _0x46f180=_0x986c6e;return _0x493849[_0x46f180(0x299)](_0x2631c9,_0x22c471);},'dPLwM':_0x493849[_0x986c6e(0x2a1)],'Npndp':_0x493849[_0x986c6e(0x309)]};if(_0x493849['ulWrB'](_0x493849[_0x986c6e(0x276)],_0x493849[_0x986c6e(0x2ab)])){const _0x45fec1=_0x53b3e9[_0x986c6e(0x268)](_0x570cf5,arguments);return _0x49dd66=null,_0x45fec1;}else{const _0x2c8043=_0x674475?function(){const _0x5c2162=_0x986c6e;if(_0x23677b[_0x5c2162(0x295)](_0x23677b[_0x5c2162(0x2e2)],_0x23677b[_0x5c2162(0x23c)]))_0x5a9e1a[_0x5c2162(0x26f)]();else{if(_0x2e4cb5){if(_0x23677b[_0x5c2162(0x250)](_0x23677b[_0x5c2162(0x1ce)],_0x23677b[_0x5c2162(0x2bc)])){const _0x1f1394=_0x3493d0?function(){const _0x49f7e2=_0x5c2162;if(_0x59f5c2){const _0x48113f=_0x3569ed[_0x49f7e2(0x268)](_0x7a1d83,arguments);return _0x4dc13f=null,_0x48113f;}}:function(){};return _0x35bb38=![],_0x1f1394;}else{const _0x2c6a6=_0x2e4cb5[_0x5c2162(0x268)](_0x2d3088,arguments);return _0x2e4cb5=null,_0x2c6a6;}}}}:function(){};return _0x674475=![],_0x2c8043;}};}()),_0x3bbf59=_0x217af6(this,function(){const _0x398958=_0x3a7a,_0x3af616={'pTiIh':_0x398958(0x315),'Tuhdo':function(_0x30fc5d,_0x143ccc){return _0x30fc5d===_0x143ccc;},'vnKyw':'ftnJw','bmRtO':function(_0x2a9a8a,_0x4b918f){return _0x2a9a8a(_0x4b918f);},'hBsAE':function(_0x6b3062,_0x1b0bc0){return _0x6b3062+_0x1b0bc0;},'QenCN':'return\x20(function()\x20','hiLZj':_0x398958(0x25b),'POwyp':function(_0x2e34a1){return _0x2e34a1();},'SvJDm':_0x398958(0x23b),'SiNhk':_0x398958(0x305),'AizvO':_0x398958(0x277),'LAQpA':_0x398958(0x1e8),'sPvOm':'info','tSqMS':_0x398958(0x331),'hZGLT':_0x398958(0x1c2),'iiaIW':_0x398958(0x2d4),'AcAaz':_0x398958(0x32d),'aIKxp':function(_0x164a9a,_0x184302){return _0x164a9a<_0x184302;},'kySbB':_0x398958(0x1fc)};let _0x1a3667;try{if(_0x3af616['Tuhdo'](_0x3af616[_0x398958(0x238)],_0x3af616[_0x398958(0x238)])){const _0x11229e=_0x3af616[_0x398958(0x318)](Function,_0x3af616['hBsAE'](_0x3af616['hBsAE'](_0x3af616['QenCN'],_0x3af616[_0x398958(0x1c6)]),');'));_0x1a3667=_0x3af616[_0x398958(0x21e)](_0x11229e);}else _0x2d56b0=_0x5348fe;}catch(_0x376053){if(_0x3af616['Tuhdo'](_0x3af616[_0x398958(0x23a)],_0x3af616['SiNhk'])){const _0x4e1cd9=_0x4d83e7[_0x398958(0x20c)][_0x398958(0x2e9)]['bind'](_0x46819c),_0x1a7c70=_0x523bf7[_0x3664c2],_0x143bbd=_0x4fe44e[_0x1a7c70]||_0x4e1cd9;_0x4e1cd9[_0x398958(0x300)]=_0x50328d[_0x398958(0x319)](_0x1ef2d0),_0x4e1cd9[_0x398958(0x316)]=_0x143bbd[_0x398958(0x316)][_0x398958(0x319)](_0x143bbd),_0x1603c4[_0x1a7c70]=_0x4e1cd9;}else _0x1a3667=window;}const _0x1ef8c6=_0x1a3667[_0x398958(0x1cd)]=_0x1a3667[_0x398958(0x1cd)]||{},_0x40f598=[_0x3af616[_0x398958(0x246)],_0x3af616['LAQpA'],_0x3af616[_0x398958(0x2f2)],_0x3af616['tSqMS'],_0x3af616[_0x398958(0x2a3)],_0x3af616[_0x398958(0x2fd)],_0x3af616[_0x398958(0x1de)]];for(let _0x2cd3af=0x0;_0x3af616[_0x398958(0x29a)](_0x2cd3af,_0x40f598[_0x398958(0x208)]);_0x2cd3af++){if(_0x3af616[_0x398958(0x1cc)](_0x3af616[_0x398958(0x20e)],_0x3af616[_0x398958(0x20e)])){const _0x5cb90a=_0x217af6[_0x398958(0x20c)][_0x398958(0x2e9)][_0x398958(0x319)](_0x217af6),_0x1c3e55=_0x40f598[_0x2cd3af],_0x160a1=_0x1ef8c6[_0x1c3e55]||_0x5cb90a;_0x5cb90a['__proto__']=_0x217af6[_0x398958(0x319)](_0x217af6),_0x5cb90a[_0x398958(0x316)]=_0x160a1[_0x398958(0x316)][_0x398958(0x319)](_0x160a1),_0x1ef8c6[_0x1c3e55]=_0x5cb90a;}else return _0x3322d4[_0x398958(0x277)](_0x17b370),_0xfaafe[_0x398958(0x217)](_0x3c8a58[_0x398958(0x1fb)]({'isLoad':!0x1,'class':_0x3af616['pTiIh'],'msg':_0x14de41['message']}));}});_0x3bbf59();import _0x31829b from'express';const b=_0x31829b['Router']();import _0x278269 from'path';import{MongoClient as _0x181595}from'mongodb';import _0x2c39af from'../middleware/mainAuth.js';import*as _0xed321b from'../mymodule/myUsers.js';import*as _0x5a601b from'../mymodule/myDateTime.js';import*as _0x108854 from'../mymodule/myModule.js';import*as _0x209e01 from'../mymodule/myDocMain.js';function _0x3a7a(_0x349fd8,_0x10040d){const _0xe42cd2=_0x1443();return _0x3a7a=function(_0x3bbf59,_0x217af6){_0x3bbf59=_0x3bbf59-0x1c1;let _0xf8a00d=_0xe42cd2[_0x3bbf59];return _0xf8a00d;},_0x3a7a(_0x349fd8,_0x10040d);}import*as _0x4b734d from'../mymodule/myData.js';const w=global[_0x1aaddc(0x32f)],S=global[_0x1aaddc(0x2ec)],p=global['PATH_SALES'],M=[w+_0x1aaddc(0x307),S+'/changes',p+_0x1aaddc(0x307)],v=[w+_0x1aaddc(0x1d4),S+_0x1aaddc(0x1d4),p+_0x1aaddc(0x1d4)],k=[w+'/status',S+_0x1aaddc(0x2b2),p+_0x1aaddc(0x2b2)],B=[w+'/search',S+_0x1aaddc(0x2af),p+_0x1aaddc(0x2af)],x=[w+_0x1aaddc(0x1cb),S+_0x1aaddc(0x1cb),p+_0x1aaddc(0x1cb),w+_0x1aaddc(0x2cb),S+'/load-last',p+'/load-last'],L=[w+_0x1aaddc(0x27c),S+_0x1aaddc(0x27c),p+'/fetch/modal'];b[_0x1aaddc(0x2aa)](L,_0x2c39af[_0x1aaddc(0x1ef)],async(_0x3ea225,_0x579ae5)=>{const _0x11c4a3=_0x1aaddc,_0x26aea6={'zSAOb':function(_0x3d5ce8,_0x103c12){return _0x3d5ce8(_0x103c12);},'sOdJb':function(_0x57a015,_0x188abf){return _0x57a015!==_0x188abf;},'wlvDb':'hmvap','FFtkd':'qYuwH','AGIKX':function(_0x2c9efa,_0x47dbd4){return _0x2c9efa==_0x47dbd4;},'sIITK':_0x11c4a3(0x330),'ribWc':'stock','UnbxL':function(_0x1f8720,_0x38e42d){return _0x1f8720==_0x38e42d;},'sqsHw':_0x11c4a3(0x247),'HFbtr':function(_0x1633db,_0x184219){return _0x1633db==_0x184219;},'qOzcC':_0x11c4a3(0x31f),'Fzknv':_0x11c4a3(0x1e0),'QXcqs':_0x11c4a3(0x267),'xOoSf':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','fuVsi':'oPFVK','lprAY':_0x11c4a3(0x315)},_0x476e09=await _0xed321b[_0x11c4a3(0x25a)](_0x3ea225),_0x4c18f9=await _0x209e01['getMainDocPathObj'](_0x3ea225,_0x579ae5,_0x476e09[_0x11c4a3(0x209)]);try{if(_0x26aea6[_0x11c4a3(0x274)](_0x26aea6['wlvDb'],_0x26aea6[_0x11c4a3(0x2f5)])){if(_0x26aea6[_0x11c4a3(0x2b3)](_0x4c18f9[_0x11c4a3(0x271)],_0x26aea6['sIITK']))var _0x576eb2=await _0x4b734d['getItems_for_Modal'](_0x26aea6[_0x11c4a3(0x278)]);else{if(_0x26aea6['UnbxL'](_0x4c18f9[_0x11c4a3(0x271)],_0x26aea6[_0x11c4a3(0x2b7)]))var _0x576eb2=await _0x4b734d['getItems_for_Modal'](_0x26aea6[_0x11c4a3(0x278)]);else{if(_0x26aea6[_0x11c4a3(0x1d1)](_0x4c18f9[_0x11c4a3(0x271)],_0x26aea6[_0x11c4a3(0x2c2)]))var _0x576eb2=await _0x4b734d[_0x11c4a3(0x2a5)](_0x26aea6[_0x11c4a3(0x2d0)]);}}const _0x260293=await _0x4b734d['getItemsCategory']();return _0x579ae5['send'](JSON[_0x11c4a3(0x1fb)]({'DATA_ITEMS':_0x576eb2,'DATA_CATEGORY':_0x260293,'isFetch':!0x0,'class':_0x26aea6['QXcqs'],'msg':_0x26aea6[_0x11c4a3(0x2db)]}));}else{if(_0x3ffccd)return _0x3ea701;else mCLgrw[_0x11c4a3(0x1d0)](_0x36ace4,0x0);}}catch(_0x1a76bc){if(_0x26aea6[_0x11c4a3(0x274)](_0x26aea6[_0x11c4a3(0x233)],_0x26aea6[_0x11c4a3(0x233)]))_0x254425[_0x11c4a3(0x26f)]();else return console[_0x11c4a3(0x277)](_0x1a76bc),_0x579ae5[_0x11c4a3(0x217)](JSON[_0x11c4a3(0x1fb)]({'isFetch':!0x1,'class':_0x26aea6['lprAY'],'msg':_0x1a76bc[_0x11c4a3(0x232)]}));}}),b[_0x1aaddc(0x2fc)](B,_0x2c39af[_0x1aaddc(0x1ef)],async(_0x359f52,_0x5f464d)=>{const _0x14b7aa=_0x1aaddc,_0x213489={'NJLLC':'function\x20*\x5c(\x20*\x5c)','xpKbw':_0x14b7aa(0x1eb),'HtCSH':function(_0x494fb2,_0x103608){return _0x494fb2(_0x103608);},'oQAOI':_0x14b7aa(0x2ee),'iSWop':function(_0xe524f8,_0x49326a){return _0xe524f8+_0x49326a;},'KsjRH':'chain','ePNjx':_0x14b7aa(0x1f4),'lRPIO':function(_0x38987a,_0x1ba071){return _0x38987a(_0x1ba071);},'ouuaS':function(_0x400a19){return _0x400a19();},'cpppM':function(_0x468ae8){return _0x468ae8();},'ljRWK':function(_0x3777f3,_0x51a6d8){return _0x3777f3<_0x51a6d8;},'BPALl':_0x14b7aa(0x270),'sLPAQ':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','dBfSi':function(_0x5bf844,_0x210b83){return _0x5bf844!==_0x210b83;},'ZMjGk':_0x14b7aa(0x230),'kIeWO':_0x14b7aa(0x256),'wVfOr':_0x14b7aa(0x267),'dCnqU':function(_0x69b833,_0x3a842a){return _0x69b833===_0x3a842a;},'XPgdo':_0x14b7aa(0x2f7),'DWGRu':_0x14b7aa(0x315),'fdSuK':function(_0xb082cb,_0x5de9de){return _0xb082cb===_0x5de9de;},'TFHiW':'mYVSs','jWlTg':_0x14b7aa(0x1f0)};let {sip:_0x268975}=_0x359f52[_0x14b7aa(0x2c6)];if(!_0x268975&&_0x213489[_0x14b7aa(0x1c7)](_0x268975['length'],0x2))return _0x5f464d[_0x14b7aa(0x217)](JSON[_0x14b7aa(0x1fb)]({'isSearch':!0x1,'class':_0x213489[_0x14b7aa(0x281)],'msg':_0x213489[_0x14b7aa(0x337)]}));_0x268975=_0x268975[_0x14b7aa(0x22e)](/[!@#$%^&*<>]/g,'')??null;const _0x2aec8e=await _0xed321b[_0x14b7aa(0x25a)](_0x359f52);await _0x209e01[_0x14b7aa(0x1fd)](_0x359f52,_0x5f464d,_0x2aec8e[_0x14b7aa(0x209)]);const {collectionName:_0x541e1c}=_0x4b734d[_0x14b7aa(0x254)](_0x359f52[_0x14b7aa(0x1e2)]),_0x2ba405=new _0x181595(global[_0x14b7aa(0x28a)]);try{if(_0x213489[_0x14b7aa(0x1db)](_0x213489['ZMjGk'],_0x213489[_0x14b7aa(0x245)])){const _0x198582=new _0x5e5acc(xDNQaV[_0x14b7aa(0x322)]),_0x24989c=new _0x441417(xDNQaV[_0x14b7aa(0x29e)],'i'),_0x5b5998=xDNQaV['HtCSH'](_0x478b69,xDNQaV[_0x14b7aa(0x2b4)]);!_0x198582[_0x14b7aa(0x2fb)](xDNQaV[_0x14b7aa(0x323)](_0x5b5998,xDNQaV[_0x14b7aa(0x222)]))||!_0x24989c[_0x14b7aa(0x2fb)](xDNQaV['iSWop'](_0x5b5998,xDNQaV[_0x14b7aa(0x1c4)]))?xDNQaV[_0x14b7aa(0x2a9)](_0x5b5998,'0'):xDNQaV['ouuaS'](_0x388c36);}else{await _0x2ba405[_0x14b7aa(0x266)]();const _0x2a43fc=_0x2ba405['db'](global[_0x14b7aa(0x225)])[_0x14b7aa(0x243)](_0x541e1c),_0x366e8b=[{'$or':[{'docId':{'$regex':_0x268975,'$options':'i'}},{'docDate':{'$regex':_0x268975,'$options':'i'}}]}];let _0x1d5f29='';['O','S']['includes'](_0x2aec8e[_0x14b7aa(0x209)])||(_0x1d5f29+=_0x213489[_0x14b7aa(0x24d)],_0x366e8b[_0x14b7aa(0x28b)]({'userId':_0x2aec8e[_0x14b7aa(0x28d)]}));const _0x4a9dd0=await _0x2a43fc[_0x14b7aa(0x2ac)]([{'$match':{'$and':_0x366e8b}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x14b7aa(0x213)]();return _0x1d5f29=_0x213489[_0x14b7aa(0x323)](_0x14b7aa(0x283)+_0x4a9dd0[_0x14b7aa(0x208)]+_0x14b7aa(0x2d1),_0x1d5f29),_0x5f464d['send'](JSON[_0x14b7aa(0x1fb)]({'searchFound':_0x4a9dd0,'msg':_0x1d5f29,'isSearch':!0x0,'class':_0x213489[_0x14b7aa(0x2fa)]}));}}catch(_0x36a391){if(_0x213489[_0x14b7aa(0x234)](_0x213489['XPgdo'],_0x213489[_0x14b7aa(0x292)]))return console['log'](_0x36a391),_0x5f464d[_0x14b7aa(0x217)](JSON[_0x14b7aa(0x1fb)]({'isSearch':!0x1,'class':_0x213489['DWGRu'],'msg':_0x36a391[_0x14b7aa(0x232)]}));else xDNQaV[_0x14b7aa(0x1dc)](_0x31f141);}finally{if(_0x213489[_0x14b7aa(0x2ff)](_0x213489[_0x14b7aa(0x33c)],_0x213489['jWlTg'])){if(_0x10d1c9){const _0x259609=_0x20deef['apply'](_0x1c12a2,arguments);return _0x109fa8=null,_0x259609;}}else _0x2ba405['close']();}}),b[_0x1aaddc(0x2fc)](x,_0x2c39af[_0x1aaddc(0x1ef)],async(_0x3cbdaf,_0x44bde4)=>{const _0x34787c=_0x1aaddc,_0x1f6c36={'vzMJn':_0x34787c(0x2f1),'DHYqM':_0x34787c(0x1eb),'eXbBj':function(_0xcdabc4,_0xaa12b){return _0xcdabc4(_0xaa12b);},'UsQnc':_0x34787c(0x2ee),'rCDru':function(_0x379fcf,_0x2ec518){return _0x379fcf+_0x2ec518;},'FqbfA':_0x34787c(0x21d),'CeUUU':function(_0x208f13,_0x1fb098){return _0x208f13+_0x1fb098;},'OSepF':'input','WoSWU':function(_0x37597e,_0x4d0871){return _0x37597e(_0x4d0871);},'GBAQS':function(_0x565189){return _0x565189();},'JjUuS':function(_0x369b6d,_0x590885,_0x27bb0e){return _0x369b6d(_0x590885,_0x27bb0e);},'VMJnV':function(_0x4971c8,_0xc04dc3){return _0x4971c8(_0xc04dc3);},'KKlZQ':_0x34787c(0x1e6),'RSgPE':_0x34787c(0x315),'gbvHh':_0x34787c(0x258),'mrbWc':'counter','fQLxY':function(_0x3ba449,_0x1b4556){return _0x3ba449!==_0x1b4556;},'qViJp':_0x34787c(0x221),'xGtch':_0x34787c(0x1ed),'ybatJ':function(_0x52f988,_0x51b187){return _0x52f988===_0x51b187;},'LZgNF':_0x34787c(0x2c9),'eavVO':function(_0xf9c63,_0x5d8da3){return _0xf9c63===_0x5d8da3;},'tKiin':_0x34787c(0x1cf),'WAqZi':_0x34787c(0x1c1),'NNWsl':_0x34787c(0x229),'JZdFm':function(_0x37e997,_0x2b5819){return _0x37e997===_0x2b5819;},'cKSKI':_0x34787c(0x25d),'TCWLI':function(_0x48e5e4,_0x16daf9){return _0x48e5e4==_0x16daf9;},'TPLoV':'bvTxX','PhWKF':function(_0x651c56,_0x301934){return _0x651c56==_0x301934;},'lfrTx':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','PWEKn':function(_0x2be756,_0x5eafe0){return _0x2be756==_0x5eafe0;},'dVnes':'fneOg','LBxnB':_0x34787c(0x2b0),'iDdIt':'green','kfDxZ':function(_0x2de85b,_0x41ef2b){return _0x2de85b===_0x41ef2b;},'tMXoG':'sCWla','OMkHg':function(_0x18b911,_0x53e662){return _0x18b911===_0x53e662;},'oAfnE':'cGeHy'};let {docId:_0x38def3,action:_0x2ac434}=_0x3cbdaf[_0x34787c(0x2c6)];const _0x1b54a8=await _0xed321b[_0x34787c(0x25a)](_0x3cbdaf);await _0x209e01[_0x34787c(0x1fd)](_0x3cbdaf,_0x44bde4,_0x1b54a8[_0x34787c(0x209)]);const {collectionName:_0x3ac488}=_0x4b734d['get_Info_ByUrl'](_0x3cbdaf['originalUrl']),_0x521988=new _0x181595(global['dbUrl']);try{if(_0x1f6c36[_0x34787c(0x29b)](_0x1f6c36['qViJp'],_0x1f6c36[_0x34787c(0x2ad)])){await _0x521988[_0x34787c(0x266)]();const _0x714874=_0x521988['db'](global[_0x34787c(0x225)])['collection'](_0x3ac488);if(_0x1f6c36[_0x34787c(0x301)](_0x2ac434,_0x1f6c36[_0x34787c(0x27a)])){if(_0x1f6c36[_0x34787c(0x297)](_0x1f6c36[_0x34787c(0x26a)],_0x1f6c36[_0x34787c(0x2f0)])){const _0x31d2a7={'FNhII':MRUUaa[_0x34787c(0x259)],'zOdQe':MRUUaa[_0x34787c(0x269)],'DrwgF':function(_0x1a7ec7,_0x335f7b){const _0x39b99c=_0x34787c;return MRUUaa[_0x39b99c(0x24c)](_0x1a7ec7,_0x335f7b);},'vUJgz':MRUUaa['UsQnc'],'MlxlT':function(_0x30be03,_0x892b5c){const _0x400b52=_0x34787c;return MRUUaa[_0x400b52(0x1fe)](_0x30be03,_0x892b5c);},'izKFi':MRUUaa['FqbfA'],'cTGHO':function(_0xe9e414,_0x54e301){const _0x46c315=_0x34787c;return MRUUaa[_0x46c315(0x29c)](_0xe9e414,_0x54e301);},'nwXcA':MRUUaa[_0x34787c(0x227)],'HdEBd':function(_0x20e34c,_0x3a514d){const _0x52c24a=_0x34787c;return MRUUaa[_0x52c24a(0x302)](_0x20e34c,_0x3a514d);},'zYoiF':function(_0x18f9b5){return MRUUaa['GBAQS'](_0x18f9b5);}};MRUUaa[_0x34787c(0x2a4)](_0x4f2739,this,function(){const _0x47a461=_0x34787c,_0x2b8e9b=new _0x145c49(_0x31d2a7[_0x47a461(0x21f)]),_0x3e6b5a=new _0x5c6c5b(_0x31d2a7[_0x47a461(0x244)],'i'),_0x12c55c=_0x31d2a7['DrwgF'](_0x2cacde,_0x31d2a7['vUJgz']);!_0x2b8e9b[_0x47a461(0x2fb)](_0x31d2a7[_0x47a461(0x2a8)](_0x12c55c,_0x31d2a7[_0x47a461(0x2de)]))||!_0x3e6b5a[_0x47a461(0x2fb)](_0x31d2a7[_0x47a461(0x2b8)](_0x12c55c,_0x31d2a7[_0x47a461(0x26c)]))?_0x31d2a7[_0x47a461(0x296)](_0x12c55c,'0'):_0x31d2a7['zYoiF'](_0x177538);})();}else{const _0x845478=['O','S'][_0x34787c(0x262)](_0x1b54a8[_0x34787c(0x209)])?{'docId':_0x38def3}:{'docId':_0x38def3,'userId':_0x1b54a8[_0x34787c(0x28d)]};var _0x5281a9=await _0x714874[_0x34787c(0x31b)](_0x845478,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x1f6c36['ybatJ'](_0x2ac434,_0x1f6c36[_0x34787c(0x1dd)]))var _0x5281a9=await _0x714874[_0x34787c(0x31b)]({'userId':_0x1b54a8[_0x34787c(0x28d)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x5914c8=_0x5281a9?'':_0x1f6c36['JZdFm'](_0x2ac434,_0x1f6c36[_0x34787c(0x27a)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x38def3+'\x22':_0x1f6c36[_0x34787c(0x28c)];if(!_0x5281a9)return _0x44bde4[_0x34787c(0x217)](JSON[_0x34787c(0x1fb)]({'isLoad':!0x1,'class':_0x1f6c36[_0x34787c(0x1d2)],'msg':_0x5914c8}));let _0x78206=_0x34787c(0x1f5)+_0x5281a9['docId']+'\x22\x20{{sep}}เรียบร้อยแล้ว';if(_0x1f6c36['TCWLI'](_0x5281a9[_0x34787c(0x22c)],0x1)&&_0x5281a9[_0x34787c(0x1f7)]){if(_0x1f6c36[_0x34787c(0x29b)](_0x1f6c36[_0x34787c(0x2c0)],_0x1f6c36['TPLoV']))MRUUaa[_0x34787c(0x313)](_0x114e4e,0x0);else{let _0x268ee5=await _0x4b734d[_0x34787c(0x303)](_0x5281a9,_0x3ac488,_0x1b54a8[_0x34787c(0x28d)]);_0x5281a9['dateTimeEditRemain']=_0x268ee5['dateTimeEditRemain'],_0x1f6c36[_0x34787c(0x279)](_0x268ee5[_0x34787c(0x33b)],!0x1)&&(_0x5281a9['docStatusNumber']=_0x268ee5[_0x34787c(0x22c)],_0x78206+=_0x1f6c36['lfrTx']);}}else _0x5281a9['dateTimeEditRemain']='-';if((_0x1f6c36[_0x34787c(0x20f)](_0x5281a9[_0x34787c(0x22c)],0x1)||_0x1f6c36[_0x34787c(0x31e)](_0x5281a9['docStatusNumber'],0x2))&&_0x5281a9[_0x34787c(0x335)]){if(_0x1f6c36[_0x34787c(0x29b)](_0x1f6c36[_0x34787c(0x2a0)],_0x1f6c36[_0x34787c(0x2a0)]))_0x580183[_0x34787c(0x277)](_0x1f6c36[_0x34787c(0x30b)],_0x554264),_0x3211fb[_0x34787c(0x217)](_0x47537a[_0x34787c(0x1fb)]({'isPrint':!0x1,'class':_0x1f6c36[_0x34787c(0x1d2)],'msg':_0x2c5c7e['message']}));else{const _0x7461f9=await _0x4b734d[_0x34787c(0x2f6)](_0x5281a9,_0x3ac488,_0x1b54a8[_0x34787c(0x28d)]);_0x5281a9['dateTimeCancelRemain']=_0x7461f9[_0x34787c(0x33d)],_0x1f6c36[_0x34787c(0x279)](_0x7461f9[_0x34787c(0x1c5)],!0x1)&&(_0x78206+=_0x1f6c36[_0x34787c(0x24e)]);}}else _0x5281a9[_0x34787c(0x33d)]='-';const {branchName:_0x4c84ed}=await _0x4b734d[_0x34787c(0x2dd)](_0x5281a9[_0x34787c(0x237)]);return _0x5281a9[_0x34787c(0x210)]=_0x4c84ed,_0x44bde4['send'](JSON['stringify']({'doc':_0x5281a9,'isLoad':!0x0,'class':_0x1f6c36['iDdIt'],'msg':_0x78206}));}else{const _0x165bba=_0x198c27?function(){const _0x395c4e=_0x34787c;if(_0x398d14){const _0x555c98=_0x311ed9[_0x395c4e(0x268)](_0x5c5d83,arguments);return _0x1eb9bd=null,_0x555c98;}}:function(){};return _0x1f4ee7=![],_0x165bba;}}catch(_0x2e72e9){return _0x1f6c36['kfDxZ'](_0x1f6c36[_0x34787c(0x1f8)],_0x1f6c36[_0x34787c(0x1f8)])?(console[_0x34787c(0x277)](_0x2e72e9),_0x44bde4[_0x34787c(0x217)](JSON[_0x34787c(0x1fb)]({'isLoad':!0x1,'class':_0x1f6c36[_0x34787c(0x1d2)],'msg':_0x2e72e9[_0x34787c(0x232)]}))):function(_0x43511d){}[_0x34787c(0x20c)](MRUUaa[_0x34787c(0x216)])[_0x34787c(0x268)](MRUUaa[_0x34787c(0x207)]);}finally{if(_0x1f6c36[_0x34787c(0x2ea)](_0x1f6c36[_0x34787c(0x2a7)],_0x1f6c36[_0x34787c(0x2a7)]))_0x521988[_0x34787c(0x26f)]();else return![];}}),b[_0x1aaddc(0x2fc)](M,_0x2c39af['isAuth'],async(_0x4d3238,_0x5bee37)=>{const _0x288df2=_0x1aaddc,_0x2149cd={'fGUyS':function(_0x1428ea,_0x30d0df){return _0x1428ea(_0x30d0df);},'KEIxe':function(_0x59c1bd,_0x1977db){return _0x59c1bd(_0x1977db);},'YNJyP':function(_0x4a8ac8,_0x3c86a6){return _0x4a8ac8+_0x3c86a6;},'maZIv':function(_0x1c3c6d,_0x13d7f3){return _0x1c3c6d+_0x13d7f3;},'yLYKa':_0x288df2(0x240),'oIgeY':_0x288df2(0x25b),'jnOkN':function(_0x57bd0c){return _0x57bd0c();},'NJRoU':function(_0xf58151,_0x20f644){return _0xf58151!==_0x20f644;},'fMwMu':'msPDp','XBwkd':_0x288df2(0x2a2),'jMeyY':_0x288df2(0x315),'xUCGL':function(_0x1c30ff,_0x35c0b1){return _0x1c30ff<_0x35c0b1;},'OleIC':_0x288df2(0x270),'FwlfQ':'ไม่พบประวัติการเปลี่ยนแปลง','ZyJgz':_0x288df2(0x2bb),'JXAjs':'green','GNKol':function(_0x144eda,_0x5b8797){return _0x144eda===_0x5b8797;},'iKqED':_0x288df2(0x287),'UbGmj':_0x288df2(0x1f3),'KNjTO':'error\x20===>\x20','iJZoR':function(_0x5e8a39,_0x5cfa77){return _0x5e8a39===_0x5cfa77;},'jTNDQ':_0x288df2(0x23d),'zZMOf':'TvaMs'},{docId:_0x442aa5}=_0x4d3238['body'],_0x5b05c7=await _0xed321b[_0x288df2(0x25a)](_0x4d3238);await _0x209e01[_0x288df2(0x1fd)](_0x4d3238,_0x5bee37,_0x5b05c7[_0x288df2(0x209)]);const {collectionName:_0x2c02b1}=_0x4b734d['get_Info_ByUrl'](_0x4d3238[_0x288df2(0x1e2)]),_0x615444=new _0x181595(global['dbUrl']);try{if(_0x2149cd['NJRoU'](_0x2149cd[_0x288df2(0x1c3)],_0x2149cd[_0x288df2(0x2bf)])){await _0x615444['connect']();var _0x641c6a=await _0x615444['db'](global['dbName'])[_0x288df2(0x243)](_0x2c02b1)['findOne']({'docId':_0x442aa5});if(!_0x641c6a)return _0x5bee37['send'](JSON[_0x288df2(0x1fb)]({'isPrint':!0x1,'class':_0x2149cd['jMeyY'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x442aa5+'\x22'}));const _0x371baf=_0x641c6a[_0x288df2(0x286)]||[];if(_0x2149cd[_0x288df2(0x2ed)](_0x371baf['length'],0x1))return _0x5bee37['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x2149cd[_0x288df2(0x2fe)],'msg':_0x2149cd[_0x288df2(0x1c8)]}));const _0x596589=_0x278269[_0x288df2(0x30d)](folderForms,_0x2149cd[_0x288df2(0x1f6)]),_0x540877=await _0x108854[_0x288df2(0x20a)](_0x596589,_0x5bee37,{'title':_0x641c6a[_0x288df2(0x284)],'time':_0x5a601b[_0x288df2(0x265)](new Date()),'changesHistory':_0x371baf});_0x5bee37[_0x288df2(0x217)](JSON['stringify']({'isPrint':!0x0,'class':_0x2149cd['JXAjs'],'htmlPage':_0x540877}));}else _0x5efaf9[_0x288df2(0x26f)]();}catch(_0x3c0d08){_0x2149cd[_0x288df2(0x242)](_0x2149cd[_0x288df2(0x289)],_0x2149cd[_0x288df2(0x2f9)])?IyXvFx[_0x288df2(0x2dc)](_0x18d9d0,'0'):(console[_0x288df2(0x277)](_0x2149cd[_0x288df2(0x2d3)],_0x3c0d08),_0x5bee37[_0x288df2(0x217)](JSON[_0x288df2(0x1fb)]({'isPrint':!0x1,'class':_0x2149cd[_0x288df2(0x223)],'msg':_0x3c0d08['message']})));}finally{if(_0x2149cd['iJZoR'](_0x2149cd[_0x288df2(0x21c)],_0x2149cd[_0x288df2(0x27f)])){const _0x52866d=IyXvFx[_0x288df2(0x218)](_0x2c8183,IyXvFx[_0x288df2(0x226)](IyXvFx[_0x288df2(0x224)](IyXvFx['yLYKa'],IyXvFx['oIgeY']),');'));_0x57c1f7=IyXvFx['jnOkN'](_0x52866d);}else _0x615444['close']();}}),b[_0x1aaddc(0x2fc)](v,_0x2c39af[_0x1aaddc(0x1ef)],async(_0x178b09,_0x590957)=>{const _0x275394=_0x1aaddc,_0x330131={'fmMJy':function(_0x352e1a,_0x5cf73f){return _0x352e1a!==_0x5cf73f;},'HoWCH':'erCCg','btsdY':_0x275394(0x334),'YJSzu':_0x275394(0x315),'XRWxJ':function(_0xc5aec,_0x5bf690){return _0xc5aec+_0x5bf690;},'NOzBF':_0x275394(0x339),'blSgX':_0x275394(0x27b),'KOCCr':_0x275394(0x275),'EcQDo':_0x275394(0x1e6),'FGHRr':_0x275394(0x325),'tjJxz':_0x275394(0x2bd),'FnDgZ':function(_0x542be4,_0x5c3cb7){return _0x542be4==_0x5c3cb7;},'xdlvG':_0x275394(0x25e),'gEzyb':_0x275394(0x267),'QboAP':_0x275394(0x1ee),'xkEwL':_0x275394(0x304),'HsZNp':_0x275394(0x329),'XgBiD':_0x275394(0x2f4),'TJnWN':_0x275394(0x2eb),'wiSMd':function(_0x18717e,_0x40166b){return _0x18717e*_0x40166b;},'gYVnq':function(_0x3241cc,_0xffbef8){return _0x3241cc/_0xffbef8;},'KTyih':_0x275394(0x253),'stHGt':_0x275394(0x2c1),'UmBfu':'VkxMu','MCbNF':function(_0x17de5c,_0x35e341){return _0x17de5c===_0x35e341;},'AoIdL':_0x275394(0x32e),'bRGUu':'oKheC'},{docId:_0x4ef3f7,action:_0xd6430}=_0x178b09[_0x275394(0x2c6)],_0x2abaaf=await _0xed321b[_0x275394(0x25a)](_0x178b09);await _0x209e01[_0x275394(0x1fd)](_0x178b09,_0x590957,_0x2abaaf['userAuthority']);const {collectionName:_0x389feb,docTitle:_0x45f882}=_0x4b734d[_0x275394(0x254)](_0x178b09[_0x275394(0x1e2)]),_0x3a9554=new _0x181595(global['dbUrl']);try{if(_0x330131[_0x275394(0x28f)](_0x330131[_0x275394(0x2ce)],_0x330131['FGHRr'])){const _0x5a7c91=_0x1c1797[_0x275394(0x268)](_0x42db9e,arguments);return _0x3c1cfa=null,_0x5a7c91;}else{await _0x3a9554[_0x275394(0x266)]();var _0x5904d4=await _0x3a9554['db'](global['dbName'])['collection'](_0x389feb)[_0x275394(0x31b)]({'docId':_0x4ef3f7});if(!_0x5904d4)return _0x590957[_0x275394(0x217)](JSON[_0x275394(0x1fb)]({'isLoad':!0x1,'class':_0x330131[_0x275394(0x261)],'msg':_0x275394(0x32a)+_0x4ef3f7+'\x22'}));_0x5904d4['docTitle']=_0x45f882,_0x5904d4[_0x275394(0x31c)]=_0x4b734d[_0x275394(0x220)](_0x5904d4[_0x275394(0x22c)]);const _0x43c150=_0x4b734d[_0x275394(0x1d7)](_0x5904d4),_0x42e9a9=_0x278269['join'](folderForms,_0x330131[_0x275394(0x214)]),_0x41fabc=await _0x108854[_0x275394(0x20a)](_0x42e9a9,_0x590957,{'title':_0x4ef3f7,'time':_0x5a601b[_0x275394(0x265)](new Date()),'action':_0xd6430,'doc':_0x43c150});if(_0x330131[_0x275394(0x200)](_0xd6430,_0x330131['xdlvG']))_0x590957[_0x275394(0x217)](JSON[_0x275394(0x1fb)]({'isPrint':!0x0,'class':_0x330131['gEzyb'],'htmlPage':_0x41fabc}));else{if(_0x330131[_0x275394(0x200)](_0xd6430,_0x330131[_0x275394(0x2e5)])){if(_0x330131['fmMJy'](_0x330131[_0x275394(0x255)],_0x330131['HsZNp'])){const _0x2caf45=await(await import(_0x330131[_0x275394(0x33e)]))['launch'](),_0x62cd51=await _0x2caf45[_0x275394(0x2ca)]();await _0x62cd51[_0x275394(0x2c8)](_0x41fabc,{'waitUntil':_0x330131[_0x275394(0x1e9)],'timeout':0x2710}),await new Promise(_0x40be8e=>setTimeout(_0x40be8e,0x3e8));const _0x480077=Math[_0x275394(0x1f1)](_0x330131[_0x275394(0x2da)](_0x330131[_0x275394(0x1d3)](0x50,25.4),0x60));await _0x62cd51['setViewport']({'width':_0x480077,'height':0x258,'deviceScaleFactor':0x1});const _0x2c1bad=await _0x62cd51['evaluate'](()=>{const _0x174057=_0x275394;if(_0x330131['fmMJy'](_0x330131['HoWCH'],_0x330131[_0x174057(0x340)])){const _0x40c9ba=document['body'],_0x5187ce=document[_0x174057(0x264)];return Math[_0x174057(0x336)](_0x40c9ba[_0x174057(0x21a)],_0x40c9ba[_0x174057(0x2b6)],_0x5187ce[_0x174057(0x326)],_0x5187ce[_0x174057(0x21a)],_0x5187ce[_0x174057(0x2b6)]);}else return _0xd32e41;}),_0x5bb53f=await _0x62cd51[_0x275394(0x2e4)]({'type':_0x330131[_0x275394(0x241)],'clip':{'x':0x0,'y':0x0,'width':_0x480077,'height':_0x2c1bad},'omitBackground':!0x1});await _0x2caf45[_0x275394(0x26f)]();const _0x12bcac=_0x5904d4[_0x275394(0x284)][_0x275394(0x22e)](/\//g,'');_0x590957['writeHead'](0xc8,{'Content-Type':_0x330131[_0x275394(0x24b)],'Content-Disposition':_0x275394(0x321)+_0x12bcac+_0x275394(0x219),'Content-Length':_0x5bb53f[_0x275394(0x208)]}),_0x590957[_0x275394(0x26d)](_0x5bb53f);}else return _0x535948[_0x275394(0x277)](_0x5e63bc),_0x184247[_0x275394(0x217)](_0x24acf6[_0x275394(0x1fb)]({'isSearch':!0x1,'class':_0x330131[_0x275394(0x261)],'msg':_0x29c3f1[_0x275394(0x232)]}));}}}}catch(_0x7d86aa){_0x330131[_0x275394(0x28f)](_0x330131[_0x275394(0x2f3)],_0x330131[_0x275394(0x2f3)])?function(){return!![];}[_0x275394(0x20c)](frNgon['XRWxJ'](frNgon[_0x275394(0x338)],frNgon[_0x275394(0x1f2)]))[_0x275394(0x1e4)](frNgon[_0x275394(0x298)]):(console[_0x275394(0x277)](_0x330131[_0x275394(0x2d2)],_0x7d86aa),_0x590957['send'](JSON[_0x275394(0x1fb)]({'isPrint':!0x1,'class':_0x330131[_0x275394(0x261)],'msg':_0x7d86aa[_0x275394(0x232)]})));}finally{_0x330131[_0x275394(0x1ea)](_0x330131[_0x275394(0x1ca)],_0x330131['bRGUu'])?(_0x156837[_0x275394(0x277)](_0x330131['EcQDo'],_0x1e6af2),_0x40ef65[_0x275394(0x217)](_0x30192a[_0x275394(0x1fb)]({'isPrint':!0x1,'class':_0x330131[_0x275394(0x261)],'msg':_0x1ca41e[_0x275394(0x232)]}))):_0x3a9554[_0x275394(0x26f)]();}}),b['post'](k,_0x2c39af['isAuth'],async(_0xfa8ebe,_0x21927b)=>{const _0x3b84db=_0x1aaddc,_0x3959d7={'UJvMp':function(_0x107122,_0x4e607e){return _0x107122==_0x4e607e;},'MBqai':_0x3b84db(0x33a),'PuxKv':_0x3b84db(0x2b1),'iBjiN':function(_0x5e1b56,_0x38127d){return _0x5e1b56==_0x38127d;},'NwkzX':_0x3b84db(0x235),'xRzEf':'red','SMrrz':_0x3b84db(0x30a),'UeUrS':function(_0x4db0a0,_0x18f708){return _0x4db0a0===_0x18f708;},'SwAnR':function(_0x4d32e3,_0x14df20){return _0x4d32e3==_0x14df20;},'OPqSX':_0x3b84db(0x2c3),'ALpNX':function(_0x51cab8,_0x5005e4){return _0x51cab8===_0x5005e4;},'KGwEM':_0x3b84db(0x22a),'HkOLZ':function(_0x5028cc,_0x21475c){return _0x5028cc!==_0x21475c;},'lSyif':_0x3b84db(0x257),'reteE':_0x3b84db(0x293),'HUnoT':function(_0x48737c,_0x47994b){return _0x48737c==_0x47994b;},'azsjO':function(_0x266dd9,_0x427f48){return _0x266dd9==_0x427f48;},'yUYmj':function(_0x2b9ab5,_0x4de74d){return _0x2b9ab5==_0x4de74d;},'jcThq':function(_0x2e74df,_0x114e6c){return _0x2e74df==_0x114e6c;},'pRPWR':function(_0x49830a,_0x5beb9e){return _0x49830a>_0x5beb9e;},'petMy':_0x3b84db(0x1c9),'GdSES':_0x3b84db(0x31a),'xntQA':function(_0x2221a7,_0x4c4956){return _0x2221a7>_0x4c4956;},'qhxVD':_0x3b84db(0x285),'TWTBO':_0x3b84db(0x25c),'LkcDS':_0x3b84db(0x267),'wRAiK':function(_0x40638e,_0xe24135){return _0x40638e<_0xe24135;},'dZBhh':'yellow'},_0x40119c=new _0x181595(global[_0x3b84db(0x28a)]);try{const _0x3dd020=await _0xed321b[_0x3b84db(0x25a)](_0xfa8ebe);await _0x209e01['getMainDocPathObj'](_0xfa8ebe,_0x21927b,_0x3dd020[_0x3b84db(0x209)]);const {collectionName:_0xcc0d2d}=_0x4b734d[_0x3b84db(0x254)](_0xfa8ebe[_0x3b84db(0x1e2)]),{docId:_0x4a98eb,action:_0x4cdbaf}=_0xfa8ebe[_0x3b84db(0x2c6)],_0x193d35=_0x3959d7[_0x3b84db(0x1e5)](_0x4cdbaf,_0x3959d7['MBqai'])?_0x3959d7['PuxKv']:_0x3959d7[_0x3b84db(0x2a6)](_0x4cdbaf,_0x3959d7['NwkzX'])?'จบ':'';if(!_0x4a98eb||![_0x3959d7[_0x3b84db(0x317)],_0x3959d7['MBqai']]['includes'](_0x4cdbaf))return _0x21927b[_0x3b84db(0x217)](JSON['stringify']({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':_0x3959d7[_0x3b84db(0x328)]}));const _0x1548f4={'docId':_0x4a98eb,'userId':_0x3dd020['userId']},_0x44f378=_0x40119c['db'](global['dbName'])[_0x3b84db(0x243)](_0xcc0d2d),_0x52f84e=await _0x44f378[_0x3b84db(0x31b)](_0x1548f4);if(!_0x52f84e)return _0x21927b[_0x3b84db(0x217)](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':_0x3b84db(0x1ec)+_0x4a98eb+_0x3b84db(0x32b)+_0x193d35+_0x3b84db(0x249)}));const _0x2096ce=_0x52f84e[_0x3b84db(0x22c)];if(_0x3959d7[_0x3b84db(0x248)](_0x4cdbaf,_0x3959d7[_0x3b84db(0x260)])&&!(_0x3959d7[_0x3b84db(0x1e5)](_0x2096ce,0x1)||_0x3959d7[_0x3b84db(0x31d)](_0x2096ce,0x2)))return _0x21927b[_0x3b84db(0x217)](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7['xRzEf'],'msg':_0x3959d7[_0x3b84db(0x324)]}));if(_0x3959d7[_0x3b84db(0x1df)](_0x4cdbaf,_0x3959d7[_0x3b84db(0x317)])&&_0x3959d7[_0x3b84db(0x2a6)](!_0x2096ce,0x1))return _0x21927b[_0x3b84db(0x217)](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':_0x3959d7['KGwEM']}));if(_0x3959d7[_0x3b84db(0x31d)](_0x4cdbaf,_0x3959d7[_0x3b84db(0x260)])){if(_0x3959d7[_0x3b84db(0x2ae)](_0x3959d7[_0x3b84db(0x2b5)],_0x3959d7['reteE'])){if(_0x3959d7['HUnoT'](_0x52f84e['canCancel'],!0x1))return _0x21927b['send'](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':'เอกสาร\x20\x22'+_0x4a98eb+_0x3b84db(0x332)}));if(_0x3959d7['azsjO']((await _0x4b734d[_0x3b84db(0x2f6)](_0x52f84e,_0xcc0d2d,_0x3dd020['userId']))[_0x3b84db(0x1c5)],!0x1))return _0x21927b[_0x3b84db(0x217)](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':_0x3b84db(0x1e1)+_0x4a98eb+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}else{if(_0x2c4460){const _0x5a2940=_0x1330ee['apply'](_0x28b3d6,arguments);return _0x4a0a4e=null,_0x5a2940;}}}if(_0x3959d7['yUYmj'](_0x4cdbaf,_0x3959d7[_0x3b84db(0x260)]))var _0x527f32=0xa;else{if(_0x3959d7['jcThq'](_0x4cdbaf,_0x3959d7[_0x3b84db(0x317)]))var _0x527f32=0x2;}const _0x308617=await _0x44f378[_0x3b84db(0x280)](_0x1548f4,{'$set':{'docStatusNumber':_0x527f32}});var _0x5681a8=_0x193d35+'\x20\x22'+_0x4a98eb+_0x3b84db(0x22d);if(_0x308617[_0x3b84db(0x24a)]||_0x3959d7['pRPWR'](_0x308617['modifiedCount'],0x0)){if(_0x3959d7[_0x3b84db(0x2ae)](_0x3959d7[_0x3b84db(0x27e)],_0x3959d7[_0x3b84db(0x2e6)])){const _0x393922=_0x4b734d[_0x3b84db(0x288)]({'docStatusNumber':_0x2096ce},{'docStatusNumber':_0x527f32});if(_0x3959d7[_0x3b84db(0x333)](_0x393922['length'],0x0)){if(_0x3959d7[_0x3b84db(0x248)](_0x3959d7[_0x3b84db(0x314)],_0x3959d7[_0x3b84db(0x314)])){const _0x2a1242={'dateTime':_0x5a601b[_0x3b84db(0x272)](new Date()),'userId':_0x3dd020[_0x3b84db(0x28d)],'userFullname':_0x3dd020[_0x3b84db(0x204)],'changes':_0x393922};await _0x44f378['updateOne']({'docId':_0x4a98eb},{'$push':{'changesHistory':{'$each':[_0x2a1242],'$position':0x0}}}),_0x5681a8+=_0x3959d7[_0x3b84db(0x1d6)];}else return!![];}return _0x21927b['send'](JSON['stringify']({'isStatus':!0x0,'docId':_0x4a98eb,'docStatusNumber':_0x527f32,'class':_0x3959d7[_0x3b84db(0x26b)],'msg':_0x5681a8}));}else _0x1d93dd[_0x3b84db(0x26f)]();}else{if(_0x308617[_0x3b84db(0x24a)]&&_0x3959d7['wRAiK'](_0x308617['modifiedCount'],0x1))return _0x21927b[_0x3b84db(0x217)](JSON['stringify']({'isStatus':!0x1,'docId':_0x4a98eb,'docStatusNumber':_0x2096ce,'class':_0x3959d7[_0x3b84db(0x1ff)],'msg':'\x22'+_0x4a98eb+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x426960){console['log'](_0x426960),_0x21927b[_0x3b84db(0x217)](JSON[_0x3b84db(0x1fb)]({'isStatus':!0x1,'class':_0x3959d7[_0x3b84db(0x1d5)],'msg':_0x426960[_0x3b84db(0x232)]}));}finally{_0x40119c[_0x3b84db(0x26f)]();}});export default b;function _0x5d495a(_0x315f3b){const _0x9b6c56=_0x1aaddc,_0x7defd9={'SWmHC':function(_0x2ff8c9,_0x46fe58){return _0x2ff8c9===_0x46fe58;},'cLuUu':_0x9b6c56(0x311),'NRZpU':_0x9b6c56(0x258),'NMCEP':'counter','xrpmo':function(_0xe0833f,_0x1d7293){return _0xe0833f!==_0x1d7293;},'BVuqU':function(_0x1cf508,_0x3c5de7){return _0x1cf508+_0x3c5de7;},'hPcle':function(_0x459709,_0xbf501c){return _0x459709/_0xbf501c;},'kWcUI':_0x9b6c56(0x208),'opEOn':function(_0xe39f74,_0x4ebf7b){return _0xe39f74===_0x4ebf7b;},'idVke':function(_0x85bad9,_0x468f75){return _0x85bad9%_0x468f75;},'OPUSy':_0x9b6c56(0x339),'xaAWP':_0x9b6c56(0x27b),'iwEZP':_0x9b6c56(0x275),'CUcOR':_0x9b6c56(0x2cc),'ozwwx':function(_0x1e614a,_0x41233c){return _0x1e614a(_0x41233c);}};function _0x1672af(_0x393849){const _0x221d10=_0x9b6c56;if(_0x7defd9['SWmHC'](typeof _0x393849,_0x7defd9[_0x221d10(0x2f8)]))return function(_0x73c333){}['constructor'](_0x7defd9['NRZpU'])['apply'](_0x7defd9[_0x221d10(0x2e1)]);else _0x7defd9[_0x221d10(0x2d5)](_0x7defd9[_0x221d10(0x2df)]('',_0x7defd9['hPcle'](_0x393849,_0x393849))[_0x7defd9[_0x221d10(0x2b9)]],0x1)||_0x7defd9[_0x221d10(0x2be)](_0x7defd9[_0x221d10(0x21b)](_0x393849,0x14),0x0)?function(){return!![];}['constructor'](_0x7defd9[_0x221d10(0x2df)](_0x7defd9[_0x221d10(0x2d9)],_0x7defd9[_0x221d10(0x263)]))[_0x221d10(0x1e4)](_0x7defd9[_0x221d10(0x29d)]):function(){return![];}[_0x221d10(0x20c)](_0x7defd9['BVuqU'](_0x7defd9['OPUSy'],_0x7defd9[_0x221d10(0x263)]))[_0x221d10(0x268)](_0x7defd9[_0x221d10(0x2c7)]);_0x7defd9['ozwwx'](_0x1672af,++_0x393849);}try{if(_0x315f3b)return _0x1672af;else _0x7defd9[_0x9b6c56(0x212)](_0x1672af,0x0);}catch(_0x15d49e){}}