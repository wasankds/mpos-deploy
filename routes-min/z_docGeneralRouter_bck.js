const _0x756086=_0x5edc;(function(_0x115250,_0x421b69){const _0x241b26=_0x5edc,_0x347317=_0x115250();while(!![]){try{const _0x5b4dc8=parseInt(_0x241b26(0x20a))/0x1+parseInt(_0x241b26(0x16a))/0x2*(parseInt(_0x241b26(0x28c))/0x3)+-parseInt(_0x241b26(0x24e))/0x4+parseInt(_0x241b26(0x14c))/0x5*(parseInt(_0x241b26(0x190))/0x6)+-parseInt(_0x241b26(0x224))/0x7+-parseInt(_0x241b26(0x1ce))/0x8*(parseInt(_0x241b26(0x1ab))/0x9)+-parseInt(_0x241b26(0x260))/0xa*(parseInt(_0x241b26(0x159))/0xb);if(_0x5b4dc8===_0x421b69)break;else _0x347317['push'](_0x347317['shift']());}catch(_0x4c9bad){_0x347317['push'](_0x347317['shift']());}}}(_0x513f,0xbf41f));const _0x39a49d=(function(){const _0x186cc4=_0x5edc,_0x4e9b46={'WCgBV':_0x186cc4(0x1aa),'bbhxv':_0x186cc4(0x205),'gtFhz':function(_0x2d1278,_0x1f0acc){return _0x2d1278(_0x1f0acc);},'rfltk':_0x186cc4(0x133),'SoedI':function(_0x5c0a0d,_0x20bfa9){return _0x5c0a0d+_0x20bfa9;},'RgXEP':_0x186cc4(0x286),'oQUZF':_0x186cc4(0x13b),'tkXiZ':function(_0x599ff1,_0x1cc7a0){return _0x599ff1(_0x1cc7a0);},'SuQTT':function(_0x12967a){return _0x12967a();},'RoYOB':function(_0x5002de,_0x234987){return _0x5002de!==_0x234987;},'wxpmX':_0x186cc4(0x211),'HowTu':function(_0x589acd,_0x3b203e){return _0x589acd!==_0x3b203e;},'QZQdC':_0x186cc4(0x2a1),'PljKK':_0x186cc4(0x1b3),'Izuum':function(_0x204041,_0xb7d811,_0x440c66){return _0x204041(_0xb7d811,_0x440c66);},'lPivJ':_0x186cc4(0x22e),'MyVIK':_0x186cc4(0x170),'HbbdJ':function(_0x10e0fe,_0x953b79){return _0x10e0fe===_0x953b79;},'gPlQf':'ipBCu'};let _0xa39638=!![];return function(_0x252cb3,_0x54a44a){const _0x462137=_0x186cc4,_0x444607={'jxCrZ':function(_0x441587,_0x3b9082,_0x58c693){const _0x854d42=_0x5edc;return _0x4e9b46[_0x854d42(0x247)](_0x441587,_0x3b9082,_0x58c693);},'PleOj':_0x4e9b46['lPivJ'],'JdVnM':_0x4e9b46[_0x462137(0x1f3)]};if(_0x4e9b46[_0x462137(0x28b)](_0x4e9b46['gPlQf'],_0x4e9b46[_0x462137(0x2a0)])){const _0x491779=_0xa39638?function(){const _0x425bd7=_0x462137,_0x453ddd={'CtHBM':_0x4e9b46[_0x425bd7(0x1fd)],'jNWQa':_0x4e9b46[_0x425bd7(0x1a7)],'iJRVt':function(_0x1fecc1,_0x2bedc1){const _0x49c570=_0x425bd7;return _0x4e9b46[_0x49c570(0x1e4)](_0x1fecc1,_0x2bedc1);},'VHoaK':_0x4e9b46[_0x425bd7(0x144)],'UfGKC':function(_0x2bf889,_0x4ff0e0){const _0x124c6a=_0x425bd7;return _0x4e9b46[_0x124c6a(0x258)](_0x2bf889,_0x4ff0e0);},'FesSB':_0x4e9b46[_0x425bd7(0x290)],'YkCFn':function(_0x3408b5,_0x47201a){return _0x4e9b46['SoedI'](_0x3408b5,_0x47201a);},'XGiUq':_0x4e9b46['oQUZF'],'tCYTZ':function(_0xb64402,_0x11d4df){const _0x1838b4=_0x425bd7;return _0x4e9b46[_0x1838b4(0x250)](_0xb64402,_0x11d4df);},'tyFmH':function(_0x32c9b1){const _0x556b58=_0x425bd7;return _0x4e9b46[_0x556b58(0x293)](_0x32c9b1);}};if(_0x4e9b46[_0x425bd7(0x289)](_0x4e9b46[_0x425bd7(0x1d9)],_0x4e9b46['wxpmX']))_0x444607[_0x425bd7(0x284)](_0x2baaa9,this,function(){const _0x25a871=_0x425bd7,_0x4418d5=new _0x3780d7(_0x453ddd['CtHBM']),_0x3b5198=new _0x211038(_0x453ddd['jNWQa'],'i'),_0x3a94f9=_0x453ddd['iJRVt'](_0x505254,_0x453ddd[_0x25a871(0x1ca)]);!_0x4418d5[_0x25a871(0x182)](_0x453ddd[_0x25a871(0x263)](_0x3a94f9,_0x453ddd[_0x25a871(0x1a6)]))||!_0x3b5198[_0x25a871(0x182)](_0x453ddd[_0x25a871(0x288)](_0x3a94f9,_0x453ddd[_0x25a871(0x251)]))?_0x453ddd['tCYTZ'](_0x3a94f9,'0'):_0x453ddd[_0x25a871(0x1af)](_0x1058cd);})();else{if(_0x54a44a){if(_0x4e9b46[_0x425bd7(0x244)](_0x4e9b46[_0x425bd7(0x1d0)],_0x4e9b46[_0x425bd7(0x27f)])){const _0x3d03b7=_0x54a44a['apply'](_0x252cb3,arguments);return _0x54a44a=null,_0x3d03b7;}else _0x56ffd9[_0x425bd7(0x218)](_0x444607[_0x425bd7(0x254)],_0x424311),_0x201e2b[_0x425bd7(0x23d)](_0x40b07e[_0x425bd7(0x26a)]({'isPrint':!0x1,'class':_0x444607[_0x425bd7(0x198)],'msg':_0x43fad2['message']}));}}}:function(){};return _0xa39638=![],_0x491779;}else return![];};}());(function(){const _0x6c81fe=_0x5edc,_0x188316={'PkhRC':_0x6c81fe(0x170),'fpZPV':_0x6c81fe(0x257),'lHSsg':_0x6c81fe(0x15c),'KOjth':function(_0x34def7,_0x23c86a){return _0x34def7===_0x23c86a;},'onCsA':'loatl','jOkrq':_0x6c81fe(0x175),'JWCPa':_0x6c81fe(0x1aa),'IFKMA':_0x6c81fe(0x205),'woSoE':function(_0x26aae3,_0x57b4b0){return _0x26aae3(_0x57b4b0);},'XaTiD':_0x6c81fe(0x133),'KeEhr':function(_0x1e3a11,_0x22fff7){return _0x1e3a11+_0x22fff7;},'eCtlS':_0x6c81fe(0x286),'kOkti':function(_0x51e39f,_0x3db308){return _0x51e39f+_0x3db308;},'PTFwC':'input','gXWBh':_0x6c81fe(0x256),'XrkvE':function(_0x340168,_0x24b52d){return _0x340168(_0x24b52d);},'sfalo':function(_0x48f8bf,_0x5971fd){return _0x48f8bf===_0x5971fd;},'XqYsC':_0x6c81fe(0x239),'eJWYC':function(_0x5f1dfc){return _0x5f1dfc();},'Kddge':function(_0x39b92a,_0x11f123,_0x37d9d4){return _0x39b92a(_0x11f123,_0x37d9d4);}};_0x188316[_0x6c81fe(0x1b6)](_0x39a49d,this,function(){const _0x30fcf6=_0x6c81fe,_0x486a7d={'vQqYS':_0x188316[_0x30fcf6(0x191)],'DIOeD':_0x188316[_0x30fcf6(0x150)]};if(_0x188316[_0x30fcf6(0x142)](_0x188316[_0x30fcf6(0x1a3)],_0x188316[_0x30fcf6(0x24d)]))return function(_0x10ba5f){}[_0x30fcf6(0x2a3)](_0x486a7d['vQqYS'])[_0x30fcf6(0x1f1)](_0x486a7d[_0x30fcf6(0x1bf)]);else{const _0x1d02c4=new RegExp(_0x188316[_0x30fcf6(0x29a)]),_0x55ba19=new RegExp(_0x188316[_0x30fcf6(0x246)],'i'),_0x23b309=_0x188316['woSoE'](_0x251554,_0x188316[_0x30fcf6(0x1f2)]);if(!_0x1d02c4['test'](_0x188316['KeEhr'](_0x23b309,_0x188316[_0x30fcf6(0x27c)]))||!_0x55ba19['test'](_0x188316['kOkti'](_0x23b309,_0x188316[_0x30fcf6(0x1bb)]))){if(_0x188316[_0x30fcf6(0x142)](_0x188316[_0x30fcf6(0x187)],_0x188316[_0x30fcf6(0x187)]))_0x188316[_0x30fcf6(0x13f)](_0x23b309,'0');else return _0x53b964['log'](_0x4db4c6),_0x1a5a04[_0x30fcf6(0x23d)](_0x184caa['stringify']({'isFetch':!0x1,'class':_0x188316[_0x30fcf6(0x229)],'msg':_0x16446e[_0x30fcf6(0x1be)]}));}else{if(_0x188316[_0x30fcf6(0x19d)](_0x188316[_0x30fcf6(0x2b1)],_0x188316['XqYsC']))_0x188316[_0x30fcf6(0x24a)](_0x251554);else{const _0x5f1454=_0x447ff9?function(){const _0x22b58f=_0x30fcf6;if(_0x41c6ad){const _0x21feb4=_0x282177[_0x22b58f(0x1f1)](_0x3ef202,arguments);return _0x3ab5c5=null,_0x21feb4;}}:function(){};return _0x3d1b8b=![],_0x5f1454;}}}})();}());const _0x7ed669=(function(){const _0x56d8d6=_0x5edc,_0x149eac={'bLHRM':_0x56d8d6(0x1aa),'SPexm':_0x56d8d6(0x205),'dIFYA':function(_0x5cc088,_0x514e3f){return _0x5cc088(_0x514e3f);},'QHTmn':_0x56d8d6(0x133),'zBlSh':function(_0x57529f,_0x277a99){return _0x57529f+_0x277a99;},'OjwSK':'chain','HAaai':_0x56d8d6(0x13b),'BxjMJ':function(_0x43b295){return _0x43b295();},'MuvYz':function(_0x53b011,_0x5b5a52){return _0x53b011===_0x5b5a52;},'wAgxe':_0x56d8d6(0x1b7),'SugKc':function(_0x3ba8e1,_0x5e12f2){return _0x3ba8e1!==_0x5e12f2;},'fWBcE':_0x56d8d6(0x22c),'OtDzR':'mdOpJ','dBMIA':'hpvtW'};let _0x44f133=!![];return function(_0x31aebb,_0x24c1d3){const _0x2a2a25=_0x56d8d6,_0x37ab76={'fGown':_0x149eac[_0x2a2a25(0x240)],'mbJsd':_0x149eac[_0x2a2a25(0x1e8)],'rizia':function(_0x5ce0e2,_0x43e6f0){return _0x149eac['dIFYA'](_0x5ce0e2,_0x43e6f0);},'Jvvbs':_0x149eac['QHTmn'],'VpoOc':function(_0x1f180f,_0x551fa5){return _0x149eac['zBlSh'](_0x1f180f,_0x551fa5);},'GKQcW':_0x149eac[_0x2a2a25(0x2b3)],'fghnc':function(_0x1a9a15,_0x10a055){const _0x144714=_0x2a2a25;return _0x149eac[_0x144714(0x2a7)](_0x1a9a15,_0x10a055);},'ujbch':_0x149eac['HAaai'],'ewjNA':function(_0xbed3de){const _0x464cbc=_0x2a2a25;return _0x149eac[_0x464cbc(0x136)](_0xbed3de);},'RspDm':function(_0x19f160,_0x220118){return _0x149eac['MuvYz'](_0x19f160,_0x220118);},'FVQMS':_0x149eac[_0x2a2a25(0x151)],'mNfpR':function(_0x428ece,_0x586760){const _0x383bd3=_0x2a2a25;return _0x149eac[_0x383bd3(0x197)](_0x428ece,_0x586760);},'aEoPx':_0x149eac[_0x2a2a25(0x152)]};if(_0x149eac[_0x2a2a25(0x197)](_0x149eac[_0x2a2a25(0x1c9)],_0x149eac['dBMIA'])){const _0x77bdf8=_0x44f133?function(){const _0x163d41=_0x2a2a25;if(_0x37ab76['RspDm'](_0x37ab76[_0x163d41(0x18c)],_0x37ab76[_0x163d41(0x18c)])){if(_0x24c1d3){if(_0x37ab76['mNfpR'](_0x37ab76['aEoPx'],_0x37ab76[_0x163d41(0x1e3)])){const _0x4e0238=_0x3b9e70?function(){const _0x81c677=_0x163d41;if(_0x3aa41c){const _0x379d7b=_0x2beb24[_0x81c677(0x1f1)](_0x1f321e,arguments);return _0x4f41a5=null,_0x379d7b;}}:function(){};return _0x4aa413=![],_0x4e0238;}else{const _0x719ef6=_0x24c1d3[_0x163d41(0x1f1)](_0x31aebb,arguments);return _0x24c1d3=null,_0x719ef6;}}}else{const _0xd68e4a=new _0x4c31fd(_0x37ab76['fGown']),_0x5866e5=new _0x161b63(_0x37ab76['mbJsd'],'i'),_0x1a5288=_0x37ab76[_0x163d41(0x13a)](_0x4ff34d,_0x37ab76[_0x163d41(0x15d)]);!_0xd68e4a[_0x163d41(0x182)](_0x37ab76['VpoOc'](_0x1a5288,_0x37ab76['GKQcW']))||!_0x5866e5[_0x163d41(0x182)](_0x37ab76['fghnc'](_0x1a5288,_0x37ab76[_0x163d41(0x135)]))?_0x37ab76[_0x163d41(0x13a)](_0x1a5288,'0'):_0x37ab76[_0x163d41(0x1e1)](_0x244907);}}:function(){};return _0x44f133=![],_0x77bdf8;}else{const _0x38fcdd=_0x1e6a82[_0x2a2a25(0x1f1)](_0x544f7f,arguments);return _0x23ef11=null,_0x38fcdd;}};}()),_0x3ad8ce=_0x7ed669(this,function(){const _0x25839b=_0x5edc,_0xce6bd4={'aFYfO':'red','jmwCx':function(_0x196e6c,_0x314ffa){return _0x196e6c(_0x314ffa);},'IVVIc':function(_0x1551ac,_0x3d7b25){return _0x1551ac===_0x3d7b25;},'EyhGc':_0x25839b(0x176),'uPZvi':function(_0x539284,_0x2c27a6){return _0x539284===_0x2c27a6;},'UBvVC':'eRDZr','xvSLX':_0x25839b(0x1d2),'OJPdV':function(_0x475eae,_0x8837c9){return _0x475eae(_0x8837c9);},'Paiyj':function(_0x411f36,_0x3748ef){return _0x411f36+_0x3748ef;},'ynPGB':function(_0xb00524,_0x166cb5){return _0xb00524+_0x166cb5;},'njcfe':_0x25839b(0x2ab),'iObWo':_0x25839b(0x1a5),'ifAYh':function(_0x1a9008,_0x45f610){return _0x1a9008!==_0x45f610;},'RNbpC':_0x25839b(0x297),'fHUEh':_0x25839b(0x19a),'TGhXp':function(_0x3b4c78){return _0x3b4c78();},'VKfMG':'log','VgxQi':_0x25839b(0x202),'eshTj':_0x25839b(0x294),'PxDXD':_0x25839b(0x21a),'NPrLs':_0x25839b(0x137),'RFBLG':'table','WJEjh':_0x25839b(0x1bd),'CwHkT':function(_0x230de1,_0x21fd25){return _0x230de1<_0x21fd25;},'lTzDR':function(_0x246937,_0x25710a){return _0x246937!==_0x25710a;},'nzrXA':_0x25839b(0x1dd),'xKQTs':'pdfCO'},_0xcce2e4=function(){const _0x1bc896=_0x25839b,_0x4a7640={'ZLGaL':_0xce6bd4[_0x1bc896(0x180)],'nvpQV':function(_0x373da6,_0x55375f){return _0xce6bd4['jmwCx'](_0x373da6,_0x55375f);}};if(_0xce6bd4[_0x1bc896(0x196)](_0xce6bd4[_0x1bc896(0x280)],_0xce6bd4[_0x1bc896(0x280)])){let _0x312cba;try{if(_0xce6bd4[_0x1bc896(0x2ad)](_0xce6bd4[_0x1bc896(0x134)],_0xce6bd4[_0x1bc896(0x231)])){if(_0x30a3a7){const _0x50353e=_0x6307c0['apply'](_0xea7a68,arguments);return _0x13d9a4=null,_0x50353e;}}else _0x312cba=_0xce6bd4[_0x1bc896(0x199)](Function,_0xce6bd4[_0x1bc896(0x174)](_0xce6bd4[_0x1bc896(0x1c6)](_0xce6bd4[_0x1bc896(0x24b)],_0xce6bd4['iObWo']),');'))();}catch(_0x5ea1e2){if(_0xce6bd4[_0x1bc896(0x1c4)](_0xce6bd4[_0x1bc896(0x166)],_0xce6bd4[_0x1bc896(0x230)]))_0x312cba=window;else return _0x4ebd6b[_0x1bc896(0x218)](_0x2b5834),_0x4b2277[_0x1bc896(0x23d)](_0x2617ca[_0x1bc896(0x26a)]({'isSearch':!0x1,'class':_0x4a7640['ZLGaL'],'msg':_0x5be448[_0x1bc896(0x1be)]}));}return _0x312cba;}else _0x4a7640[_0x1bc896(0x171)](_0x34ba16,0x0);},_0x107dae=_0xce6bd4[_0x25839b(0x2ba)](_0xcce2e4),_0x5185d4=_0x107dae[_0x25839b(0x29d)]=_0x107dae[_0x25839b(0x29d)]||{},_0x19255d=[_0xce6bd4[_0x25839b(0x1ba)],_0xce6bd4[_0x25839b(0x160)],_0xce6bd4[_0x25839b(0x1b0)],_0xce6bd4[_0x25839b(0x20b)],_0xce6bd4['NPrLs'],_0xce6bd4[_0x25839b(0x184)],_0xce6bd4['WJEjh']];for(let _0x5e7027=0x0;_0xce6bd4[_0x25839b(0x16b)](_0x5e7027,_0x19255d[_0x25839b(0x220)]);_0x5e7027++){if(_0xce6bd4[_0x25839b(0x1d5)](_0xce6bd4[_0x25839b(0x2a4)],_0xce6bd4[_0x25839b(0x28e)])){const _0x4b37fe=_0x7ed669[_0x25839b(0x2a3)]['prototype'][_0x25839b(0x24c)](_0x7ed669),_0x5361b8=_0x19255d[_0x5e7027],_0x2e04bf=_0x5185d4[_0x5361b8]||_0x4b37fe;_0x4b37fe[_0x25839b(0x138)]=_0x7ed669[_0x25839b(0x24c)](_0x7ed669),_0x4b37fe[_0x25839b(0x1e7)]=_0x2e04bf[_0x25839b(0x1e7)][_0x25839b(0x24c)](_0x2e04bf),_0x5185d4[_0x5361b8]=_0x4b37fe;}else{const _0x432666=_0x3af24a[_0x25839b(0x17d)],_0x40b25e=_0x11a47e[_0x25839b(0x1c0)];return _0x5413d7[_0x25839b(0x1ea)](_0x432666[_0x25839b(0x1a9)],_0x432666[_0x25839b(0x1e9)],_0x40b25e[_0x25839b(0x1d6)],_0x40b25e[_0x25839b(0x1a9)],_0x40b25e[_0x25839b(0x1e9)]);}}});_0x3ad8ce();import _0x431f60 from'express';const b=_0x431f60[_0x756086(0x165)]();import _0x58a39a from'path';function _0x5edc(_0x24eb10,_0x2bc0f8){const _0x25b22e=_0x513f();return _0x5edc=function(_0x3ad8ce,_0x7ed669){_0x3ad8ce=_0x3ad8ce-0x132;let _0x473e01=_0x25b22e[_0x3ad8ce];return _0x473e01;},_0x5edc(_0x24eb10,_0x2bc0f8);}import{MongoClient as _0x33ed9d}from'mongodb';import _0x287848 from'../middleware/mainAuth.js';import*as _0x3be726 from'../mymodule/myUsers.js';import*as _0x5049de from'../mymodule/myDateTime.js';import*as _0x13d5ae from'../mymodule/myModule.js';function _0x513f(){const _0x2f4d9e=['\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','WiWey','rDYGV','djPpD','screenshot','1539387wjqxdq','PxDXD','get_StatusName_byStatusNumber','EuXYQ','OSJAo','WWyuD','PpMQC','IDGbs','oFRIt','getUserData','image/jpeg','fVcOU','DxjRX','ZNvWk','log','stateObject','error','FXfxq','\x22\x20{{sep}}เรียบร้อยแล้ว','zYVvR','KIHdD','ckYVO','length','getItemsCategory','end','userId','2290421IrJUHB','qhobE','JJlad','GWXlD','findOne','PkhRC','getMainDocPathObj','DXsrn','tseFU','PCmnE','error\x20===>\x20','WNmil','fHUEh','xvSLX','/search','WckbO','connect','AiBOg','/print','formatDate','toArray','MaKUR','lynSw','btwFu','DOC_TYPE','send','xLjWg','userAuthority','bLHRM','/load','doc_print.ejs','vHoSo','HowTu','GQDNW','IFKMA','Izuum','mfLfk','load','eJWYC','njcfe','bind','jOkrq','4913832jmtFZn','LtZRa','tkXiZ','XGiUq','wesRs','เอกสาร\x20\x22','PleOj','rPogg','OqZNb','while\x20(true)\x20{}','SoedI','ไม่พบเอกสารล่าสุด','renderView','SjQdR','sales','rGjJS','dbName','floor','90GKisSO','wiuKp','TBsGM','UfGKC','docId','changesHistory','NiCss','/status','maUlW','dateTimeCanEdit','stringify','BBvze','PURgy','convert_DocPrint','RWcSt','dateTimeCancelRemain','พบ\x20\x22','docTitle','kUzEE','formatDateTime','gger','SqBTn','UxVDX','ZLaPt','vkFDu','print','UXRSm','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','eCtlS','CSFvB','call','PljKK','EyhGc','bjMvU','updateOne','JoJki','jxCrZ','isAuth','chain','PFPQO','YkCFn','RoYOB','push','HbbdJ','222843vEpCHc','Ppplr','xKQTs','/changes','RgXEP','load-last','green','SuQTT','info','docStatusNumber','JLUwX','kIfBe','getItems_for_Modal','hVDsT','JWCPa','close','anSSL','console','mgWyR','vkHes','gPlQf','OeSsD','NeWhY','constructor','nzrXA','PQdtK','warehouseIn','zBlSh','NCYvC','stock','girds','return\x20(function()\x20','โหลดเอกสารเลขที่\x20\x22','uPZvi','DWeOA','branchId','RIFLH','XqYsC','ofqRq','OjwSK','post','cDCQb','check_DocDateTime_CanEdit','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','rcZPG','{{sep}}หรือไม่มีสิทธิ์','TGhXp','rohKa','evaluate','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','init','UBvVC','ujbch','BxjMJ','exception','__proto__','NzscT','rizia','input','pPGvc','cFtrT','suIrp','XrkvE','mmwGW','HlquM','KOjth','\x22\x20เอกสาร','rfltk','KEMqa','JLOOC','oGtLB','RYOjF','nhMib','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','124750cpvxyQ','image','aCoNJ','jpeg','lHSsg','wAgxe','fWBcE','Pgpnk','\x22\x20เรียบร้อยแล้ว','IiHnd','sJwOp','IthSP','vwpGT','40931ZlcDvl','modifiedCount','cHjQp','counter','Jvvbs','wihMv','mpQNj','VgxQi','branchName','CDBkP','get','canEdit','Router','RNbpC','tGyyA','CNNcf','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','2gKbLRj','CwHkT','ziXJd','xyRtX','pJsQs','KwIbG','red','nvpQV','qOLbQ','UPVGt','Paiyj','OWsDD','hTNbo','doUIg','DEjwm','rXvpy','qRpMB','yellow','เอกสารที่ตันเองไม่ได้สร้าง','body','kETcK','FJedw','aFYfO','ยกเลิก','test','GUFZC','RFBLG','tAJPH','join','gXWBh','xTsJE','collection','yrkNj','rIQTa','FVQMS','CpBqM','check_DocDateTime_CanCancel','includes','210XEpNJL','fpZPV','doc_changes.ejs','dZlrW','ไม่พบเอกสาร\x20\x22','lPxiq','IVVIc','SugKc','JdVnM','OJPdV','ucIxN','gnFnL','MGFHw','sfalo','BSyMW','IisqI','bhLyY','nmfwN','EzUdH','onCsA','NszhS','{}.constructor(\x22return\x20this\x22)(\x20)','FesSB','bbhxv','lVCjZ','scrollHeight','function\x20*\x5c(\x20*\x5c)','9EmknxS','rhTsx','OHXow','matchedCount','tyFmH','eshTj','tYYwR','HPBir','qvSov','CdBwd','originalUrl','Kddge','LNfLs','ไม่พบเอกสารเลขที่\x20\x22','rcCWa','VKfMG','PTFwC','JLJsg','trace','message','DIOeD','documentElement','ไม่พบประวัติการเปลี่ยนแปลง','nVUlg','dateTimeEditRemain','ifAYh','canCancel','ynPGB','attachment;\x20filename=','cOdAS','OtDzR','VHoaK','/load-last','otAib','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','915016OPaWmj','kiHxc','QZQdC','NNpZy','MvqJt','SWHVX','NbJrD','lTzDR','clientHeight','dbUrl','awEvs','wxpmX','rdgSa','zpOhG','vhxuR','kGUtn','TaRgG','DSVjs','MNgqC','ewjNA','newPage','aEoPx','gtFhz','UgPPO','kabpj','toString','SPexm','offsetHeight','max','UzDWD','qfzkZ','mRgIF','emgoU','lkjFy','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','apply','XaTiD','MyVIK','statusName','Epiif','LhUdR','pjLPo','puppeteer','fDxDg','qcrdX','debu','RGxEb','WCgBV','/fetch/modal','tTeWh','setContent','replace','warn','get_Info_ByUrl','SUKbP'];_0x513f=function(){return _0x2f4d9e;};return _0x513f();}import*as _0x1dab8a from'../mymodule/myDocMain.js';import*as _0x323749 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global['PATH_WAREHOUSE_OUT'],p=global['PATH_SALES'],M=[w+_0x756086(0x28f),S+_0x756086(0x28f),p+_0x756086(0x28f)],v=[w+'/print',S+_0x756086(0x236),p+'/print'],k=[w+'/status',S+_0x756086(0x267),p+_0x756086(0x267)],B=[w+_0x756086(0x232),S+_0x756086(0x232),p+_0x756086(0x232)],x=[w+_0x756086(0x241),S+_0x756086(0x241),p+'/load',w+'/load-last',S+_0x756086(0x1cb),p+_0x756086(0x1cb)],L=[w+_0x756086(0x1fe),S+'/fetch/modal',p+'/fetch/modal'];b[_0x756086(0x163)](L,_0x287848[_0x756086(0x285)],async(_0x18e3ba,_0x112630)=>{const _0x37e34b=_0x756086,_0x5cd2f4={'LtZRa':function(_0x361eeb,_0x471ac5){return _0x361eeb===_0x471ac5;},'NzscT':_0x37e34b(0x243),'lynSw':function(_0x3b90d5,_0x1f8e55){return _0x3b90d5==_0x1f8e55;},'jRCEX':_0x37e34b(0x2a6),'CpBqM':_0x37e34b(0x2a9),'lPxiq':'warehouseOut','rcCWa':function(_0x166c09,_0xf0868e){return _0x166c09==_0xf0868e;},'KEMqa':_0x37e34b(0x25c),'JLUwX':'active','IthSP':_0x37e34b(0x292),'rohKa':_0x37e34b(0x27b),'tRJQS':function(_0x48574f,_0x2de054){return _0x48574f===_0x2de054;},'NeWhY':_0x37e34b(0x2a5),'lJzor':_0x37e34b(0x1ec),'fVcOU':_0x37e34b(0x170)},_0x4052f5=await _0x3be726['getUserData'](_0x18e3ba),_0x4167ea=await _0x1dab8a[_0x37e34b(0x22a)](_0x18e3ba,_0x112630,_0x4052f5[_0x37e34b(0x23f)]);try{if(_0x5cd2f4[_0x37e34b(0x24f)](_0x5cd2f4[_0x37e34b(0x139)],_0x5cd2f4[_0x37e34b(0x139)])){if(_0x5cd2f4[_0x37e34b(0x23a)](_0x4167ea[_0x37e34b(0x23c)],_0x5cd2f4['jRCEX']))var _0x35f5a4=await _0x323749[_0x37e34b(0x298)](_0x5cd2f4[_0x37e34b(0x18d)]);else{if(_0x5cd2f4[_0x37e34b(0x23a)](_0x4167ea[_0x37e34b(0x23c)],_0x5cd2f4[_0x37e34b(0x195)]))var _0x35f5a4=await _0x323749[_0x37e34b(0x298)](_0x5cd2f4[_0x37e34b(0x18d)]);else{if(_0x5cd2f4[_0x37e34b(0x1b9)](_0x4167ea['DOC_TYPE'],_0x5cd2f4[_0x37e34b(0x145)]))var _0x35f5a4=await _0x323749[_0x37e34b(0x298)](_0x5cd2f4[_0x37e34b(0x296)]);}}const _0x4ba779=await _0x323749[_0x37e34b(0x221)]();return _0x112630[_0x37e34b(0x23d)](JSON[_0x37e34b(0x26a)]({'DATA_ITEMS':_0x35f5a4,'DATA_CATEGORY':_0x4ba779,'isFetch':!0x0,'class':_0x5cd2f4[_0x37e34b(0x157)],'msg':_0x5cd2f4[_0x37e34b(0x2bb)]}));}else _0x1f063d[_0x37e34b(0x29b)]();}catch(_0x5c8fd7){if(_0x5cd2f4['tRJQS'](_0x5cd2f4[_0x37e34b(0x2a2)],_0x5cd2f4['lJzor'])){const _0xaaf6c5=_0x3c01e2[_0x37e34b(0x2a3)]['prototype'][_0x37e34b(0x24c)](_0x975acf),_0x4264eb=_0x4ffd2c[_0x321fc0],_0x35cec9=_0x14953d[_0x4264eb]||_0xaaf6c5;_0xaaf6c5[_0x37e34b(0x138)]=_0x20f5c2[_0x37e34b(0x24c)](_0x296888),_0xaaf6c5[_0x37e34b(0x1e7)]=_0x35cec9[_0x37e34b(0x1e7)][_0x37e34b(0x24c)](_0x35cec9),_0xc76f07[_0x4264eb]=_0xaaf6c5;}else return console[_0x37e34b(0x218)](_0x5c8fd7),_0x112630[_0x37e34b(0x23d)](JSON[_0x37e34b(0x26a)]({'isFetch':!0x1,'class':_0x5cd2f4[_0x37e34b(0x215)],'msg':_0x5c8fd7['message']}));}}),b[_0x756086(0x2b4)](B,_0x287848['isAuth'],async(_0x50aa39,_0x51003d)=>{const _0x3252f0=_0x756086,_0x52f82f={'mpQNj':function(_0x7cac9c,_0xed49c0){return _0x7cac9c(_0xed49c0);},'btwFu':function(_0xc7e650,_0x257db8){return _0xc7e650<_0x257db8;},'rcZPG':_0x3252f0(0x17b),'rdgSa':_0x3252f0(0x14a),'lduwI':function(_0x587c97,_0x34c9ae){return _0x587c97===_0x34c9ae;},'nVUlg':_0x3252f0(0x281),'wesRs':_0x3252f0(0x168),'UxVDX':_0x3252f0(0x169),'MNgqC':function(_0x42e5e4,_0x32198b){return _0x42e5e4+_0x32198b;},'UPVGt':'green','ZNvWk':function(_0x48f489,_0x5eb493){return _0x48f489===_0x5eb493;},'rXvpy':_0x3252f0(0x25d),'qcrdX':_0x3252f0(0x170),'FXfxq':function(_0x12baa5,_0x958904){return _0x12baa5!==_0x958904;},'RorlB':_0x3252f0(0x17e),'DSVjs':_0x3252f0(0x153)};let {sip:_0x12e329}=_0x50aa39[_0x3252f0(0x17d)];if(!_0x12e329&&_0x52f82f[_0x3252f0(0x23b)](_0x12e329['length'],0x2))return _0x51003d['send'](JSON[_0x3252f0(0x26a)]({'isSearch':!0x1,'class':_0x52f82f[_0x3252f0(0x2b8)],'msg':_0x52f82f[_0x3252f0(0x1da)]}));_0x12e329=_0x12e329[_0x3252f0(0x201)](/[!@#$%^&*<>]/g,'')??null;const _0x4774b8=await _0x3be726[_0x3252f0(0x213)](_0x50aa39);await _0x1dab8a[_0x3252f0(0x22a)](_0x50aa39,_0x51003d,_0x4774b8[_0x3252f0(0x23f)]);const {collectionName:_0x51fa71}=_0x323749['get_Info_ByUrl'](_0x50aa39['originalUrl']),_0x4b0aba=new _0x33ed9d(global['dbUrl']);try{if(_0x52f82f['lduwI'](_0x52f82f[_0x3252f0(0x1c2)],_0x52f82f[_0x3252f0(0x252)]))_0x1b4fd0=_0x3309c5;else{await _0x4b0aba[_0x3252f0(0x234)]();const _0x530e1f=_0x4b0aba['db'](global[_0x3252f0(0x25e)])[_0x3252f0(0x189)](_0x51fa71),_0xda3900=[{'$or':[{'docId':{'$regex':_0x12e329,'$options':'i'}},{'docDate':{'$regex':_0x12e329,'$options':'i'}}]}];let _0x527e46='';['O','S'][_0x3252f0(0x18f)](_0x4774b8[_0x3252f0(0x23f)])||(_0x527e46+=_0x52f82f[_0x3252f0(0x276)],_0xda3900[_0x3252f0(0x28a)]({'userId':_0x4774b8['userId']}));const _0x3e8784=await _0x530e1f['aggregate']([{'$match':{'$and':_0xda3900}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x3252f0(0x238)]();return _0x527e46=_0x52f82f[_0x3252f0(0x1e0)](_0x3252f0(0x270)+_0x3e8784[_0x3252f0(0x220)]+_0x3252f0(0x143),_0x527e46),_0x51003d[_0x3252f0(0x23d)](JSON[_0x3252f0(0x26a)]({'searchFound':_0x3e8784,'msg':_0x527e46,'isSearch':!0x0,'class':_0x52f82f[_0x3252f0(0x173)]}));}}catch(_0x5308dc){if(_0x52f82f[_0x3252f0(0x217)](_0x52f82f[_0x3252f0(0x179)],_0x52f82f[_0x3252f0(0x179)]))return console[_0x3252f0(0x218)](_0x5308dc),_0x51003d['send'](JSON[_0x3252f0(0x26a)]({'isSearch':!0x1,'class':_0x52f82f[_0x3252f0(0x1fa)],'msg':_0x5308dc['message']}));else _0x47048e[_0x3252f0(0x29b)]();}finally{_0x52f82f[_0x3252f0(0x21b)](_0x52f82f['RorlB'],_0x52f82f[_0x3252f0(0x1df)])?_0x4b0aba[_0x3252f0(0x29b)]():RcGZkk[_0x3252f0(0x15f)](_0x539b66,'0');}}),b[_0x756086(0x2b4)](x,_0x287848[_0x756086(0x285)],async(_0x124f80,_0x24ca09)=>{const _0x58b716=_0x756086,_0x1cac74={'qhobE':_0x58b716(0x22e),'HlquM':'red','cHjQp':function(_0x5780c2,_0x389b6b){return _0x5780c2+_0x389b6b;},'yrkNj':'debu','xTsJE':_0x58b716(0x274),'KwIbG':'action','RWcSt':function(_0x26601d,_0x3d7b80){return _0x26601d!==_0x3d7b80;},'Epiif':_0x58b716(0x1ef),'aCoNJ':function(_0x53c4c7,_0x304932){return _0x53c4c7===_0x304932;},'zYVvR':_0x58b716(0x249),'emgoU':_0x58b716(0x216),'DWeOA':_0x58b716(0x272),'SqBTn':_0x58b716(0x291),'gtskW':function(_0x59983e,_0x594aa5){return _0x59983e===_0x594aa5;},'PstmR':_0x58b716(0x259),'PURgy':function(_0x3496c8,_0xd03474){return _0x3496c8==_0xd03474;},'oGtLB':function(_0x1b22ed,_0x260bba){return _0x1b22ed!==_0x260bba;},'qYLfn':_0x58b716(0x299),'JLOOC':_0x58b716(0x13c),'gzJxW':_0x58b716(0x132),'pJsQs':function(_0x549f3a,_0x3a7b17){return _0x549f3a==_0x3a7b17;},'BSyMW':function(_0x26a2da,_0x58bb12){return _0x26a2da==_0x58bb12;},'OSJAo':function(_0x22d4ba,_0x5bd692){return _0x22d4ba!==_0x5bd692;},'nPwKB':_0x58b716(0x261),'UgPPO':_0x58b716(0x20d),'RIFLH':function(_0x239438,_0x277e51){return _0x239438==_0x277e51;},'WWyuD':_0x58b716(0x1f0),'qRpMB':_0x58b716(0x292),'fDxDg':_0x58b716(0x1d3),'LKlCj':'vKucH','rPogg':_0x58b716(0x268),'vkFDu':'gQguX'};let {docId:_0x59a6ad,action:_0x34213e}=_0x124f80[_0x58b716(0x17d)];const _0x76e729=await _0x3be726['getUserData'](_0x124f80);await _0x1dab8a[_0x58b716(0x22a)](_0x124f80,_0x24ca09,_0x76e729[_0x58b716(0x23f)]);const {collectionName:_0x4cbcb0}=_0x323749['get_Info_ByUrl'](_0x124f80['originalUrl']),_0x5baddd=new _0x33ed9d(global[_0x58b716(0x1d7)]);try{if(_0x1cac74[_0x58b716(0x26e)](_0x1cac74[_0x58b716(0x1f5)],_0x1cac74[_0x58b716(0x1f5)]))_0x288075['log'](_0x1cac74[_0x58b716(0x225)],_0x443bfe),_0x244f11[_0x58b716(0x23d)](_0x25b2ac[_0x58b716(0x26a)]({'isPrint':!0x1,'class':_0x1cac74[_0x58b716(0x141)],'msg':_0x256938[_0x58b716(0x1be)]}));else{await _0x5baddd[_0x58b716(0x234)]();const _0x4e9f4e=_0x5baddd['db'](global[_0x58b716(0x25e)])['collection'](_0x4cbcb0);if(_0x1cac74[_0x58b716(0x14e)](_0x34213e,_0x1cac74[_0x58b716(0x21d)])){if(_0x1cac74[_0x58b716(0x14e)](_0x1cac74[_0x58b716(0x1ee)],_0x1cac74[_0x58b716(0x2ae)]))_0x3fdea6[_0x58b716(0x29b)]();else{const _0x4b1009=['O','S'][_0x58b716(0x18f)](_0x76e729[_0x58b716(0x23f)])?{'docId':_0x59a6ad}:{'docId':_0x59a6ad,'userId':_0x76e729[_0x58b716(0x223)]};var _0x52eeec=await _0x4e9f4e[_0x58b716(0x228)](_0x4b1009,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x1cac74[_0x58b716(0x14e)](_0x34213e,_0x1cac74[_0x58b716(0x275)]))var _0x52eeec=await _0x4e9f4e[_0x58b716(0x228)]({'userId':_0x76e729[_0x58b716(0x223)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x53003c=_0x52eeec?'':_0x1cac74['gtskW'](_0x34213e,_0x1cac74[_0x58b716(0x21d)])?_0x58b716(0x1b8)+_0x59a6ad+'\x22':_0x1cac74['PstmR'];if(!_0x52eeec)return _0x24ca09[_0x58b716(0x23d)](JSON['stringify']({'isLoad':!0x1,'class':_0x1cac74['HlquM'],'msg':_0x53003c}));let _0x23dc76=_0x58b716(0x2ac)+_0x52eeec['docId']+_0x58b716(0x21c);if(_0x1cac74[_0x58b716(0x26c)](_0x52eeec[_0x58b716(0x295)],0x1)&&_0x52eeec[_0x58b716(0x269)]){if(_0x1cac74[_0x58b716(0x147)](_0x1cac74['qYLfn'],_0x1cac74[_0x58b716(0x146)])){let _0xb4741=await _0x323749[_0x58b716(0x2b6)](_0x52eeec,_0x4cbcb0,_0x76e729[_0x58b716(0x223)]);_0x52eeec[_0x58b716(0x1c3)]=_0xb4741[_0x58b716(0x1c3)],_0x1cac74['PURgy'](_0xb4741[_0x58b716(0x164)],!0x1)&&(_0x52eeec[_0x58b716(0x295)]=_0xb4741[_0x58b716(0x295)],_0x23dc76+=_0x1cac74['gzJxW']);}else{const _0x8e3b06=_0x5dba19[_0x58b716(0x1f1)](_0x551506,arguments);return _0x5ad5e6=null,_0x8e3b06;}}else _0x52eeec[_0x58b716(0x1c3)]='-';if((_0x1cac74[_0x58b716(0x16e)](_0x52eeec[_0x58b716(0x295)],0x1)||_0x1cac74[_0x58b716(0x19e)](_0x52eeec[_0x58b716(0x295)],0x2))&&_0x52eeec['dateTimeCanCancel']){if(_0x1cac74[_0x58b716(0x20e)](_0x1cac74['nPwKB'],_0x1cac74[_0x58b716(0x1e5)])){const _0x3f27e2=await _0x323749[_0x58b716(0x18e)](_0x52eeec,_0x4cbcb0,_0x76e729[_0x58b716(0x223)]);_0x52eeec[_0x58b716(0x26f)]=_0x3f27e2[_0x58b716(0x26f)],_0x1cac74[_0x58b716(0x2b0)](_0x3f27e2[_0x58b716(0x1c5)],!0x1)&&(_0x23dc76+=_0x1cac74[_0x58b716(0x20f)]);}else return!![];}else _0x52eeec[_0x58b716(0x26f)]='-';const {branchName:_0x12c037}=await _0x323749['getUserBranchesById'](_0x52eeec[_0x58b716(0x2af)]);return _0x52eeec[_0x58b716(0x161)]=_0x12c037,_0x24ca09['send'](JSON[_0x58b716(0x26a)]({'doc':_0x52eeec,'isLoad':!0x0,'class':_0x1cac74[_0x58b716(0x17a)],'msg':_0x23dc76}));}}catch(_0x5a283f){return _0x1cac74[_0x58b716(0x26e)](_0x1cac74[_0x58b716(0x1f9)],_0x1cac74['LKlCj'])?(console[_0x58b716(0x218)](_0x5a283f),_0x24ca09[_0x58b716(0x23d)](JSON[_0x58b716(0x26a)]({'isLoad':!0x1,'class':_0x1cac74[_0x58b716(0x141)],'msg':_0x5a283f[_0x58b716(0x1be)]}))):_0x480a27;}finally{_0x1cac74[_0x58b716(0x20e)](_0x1cac74[_0x58b716(0x255)],_0x1cac74[_0x58b716(0x278)])?_0x5baddd[_0x58b716(0x29b)]():function(){return!![];}[_0x58b716(0x2a3)](ncWZVc[_0x58b716(0x15b)](ncWZVc[_0x58b716(0x18a)],ncWZVc[_0x58b716(0x188)]))['call'](ncWZVc[_0x58b716(0x16f)]);}}),b[_0x756086(0x2b4)](M,_0x287848['isAuth'],async(_0xdc46cb,_0x2201df)=>{const _0x4eaba8=_0x756086,_0x586b3b={'UXRSm':function(_0x279d97){return _0x279d97();},'RYOjF':function(_0x2b8ce0,_0x2c4f5f){return _0x2b8ce0(_0x2c4f5f);},'JLJsg':function(_0x3e13fb,_0x2c486c){return _0x3e13fb+_0x2c486c;},'pMXfx':function(_0x16ee17,_0x2aae3d){return _0x16ee17+_0x2aae3d;},'ckYVO':'return\x20(function()\x20','SUKbP':_0x4eaba8(0x1a5),'OHXow':function(_0x2b10b8,_0x5736b9){return _0x2b10b8!==_0x5736b9;},'bhLyY':_0x4eaba8(0x19b),'xyRtX':'ukBAG','FJedw':_0x4eaba8(0x170),'kiHxc':function(_0x11d0b6,_0x48372e){return _0x11d0b6<_0x48372e;},'MlBBg':_0x4eaba8(0x17b),'tTeWh':_0x4eaba8(0x1c1),'wihMv':_0x4eaba8(0x192),'AiBOg':_0x4eaba8(0x292),'cFtrT':function(_0xd52ef,_0x31c72d){return _0xd52ef!==_0x31c72d;},'cDCQb':_0x4eaba8(0x1e6),'RyTgY':_0x4eaba8(0x23e),'djPpD':_0x4eaba8(0x22e),'GQDNW':function(_0x1dece8,_0x37c7b7){return _0x1dece8!==_0x37c7b7;},'rDYGV':_0x4eaba8(0x19c)},{docId:_0x472a90}=_0xdc46cb[_0x4eaba8(0x17d)],_0xef161e=await _0x3be726[_0x4eaba8(0x213)](_0xdc46cb);await _0x1dab8a[_0x4eaba8(0x22a)](_0xdc46cb,_0x2201df,_0xef161e['userAuthority']);const {collectionName:_0x2fe7d0}=_0x323749[_0x4eaba8(0x203)](_0xdc46cb[_0x4eaba8(0x1b5)]),_0x5597dd=new _0x33ed9d(global[_0x4eaba8(0x1d7)]);try{if(_0x586b3b[_0x4eaba8(0x1ad)](_0x586b3b[_0x4eaba8(0x1a0)],_0x586b3b[_0x4eaba8(0x16d)])){await _0x5597dd['connect']();var _0x5cdd14=await _0x5597dd['db'](global[_0x4eaba8(0x25e)])['collection'](_0x2fe7d0)['findOne']({'docId':_0x472a90});if(!_0x5cdd14)return _0x2201df[_0x4eaba8(0x23d)](JSON[_0x4eaba8(0x26a)]({'isPrint':!0x1,'class':_0x586b3b[_0x4eaba8(0x17f)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x472a90+'\x22'}));const _0x41c679=_0x5cdd14[_0x4eaba8(0x265)]||[];if(_0x586b3b[_0x4eaba8(0x1cf)](_0x41c679[_0x4eaba8(0x220)],0x1))return _0x2201df['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x586b3b['MlBBg'],'msg':_0x586b3b[_0x4eaba8(0x1ff)]}));const _0x46bec8=_0x58a39a['join'](folderForms,_0x586b3b[_0x4eaba8(0x15e)]),_0x2e8c09=await _0x13d5ae[_0x4eaba8(0x25a)](_0x46bec8,_0x2201df,{'title':_0x5cdd14['docId'],'time':_0x5049de['formatDate'](new Date()),'changesHistory':_0x41c679});_0x2201df[_0x4eaba8(0x23d)](JSON['stringify']({'isPrint':!0x0,'class':_0x586b3b[_0x4eaba8(0x235)],'htmlPage':_0x2e8c09}));}else _0x58ea7c['close']();}catch(_0x2d1de1){_0x586b3b[_0x4eaba8(0x13d)](_0x586b3b[_0x4eaba8(0x2b5)],_0x586b3b['RyTgY'])?(console[_0x4eaba8(0x218)](_0x586b3b[_0x4eaba8(0x208)],_0x2d1de1),_0x2201df[_0x4eaba8(0x23d)](JSON[_0x4eaba8(0x26a)]({'isPrint':!0x1,'class':_0x586b3b[_0x4eaba8(0x17f)],'msg':_0x2d1de1[_0x4eaba8(0x1be)]}))):iaPgrh[_0x4eaba8(0x27a)](_0x4b0766);}finally{if(_0x586b3b[_0x4eaba8(0x245)](_0x586b3b[_0x4eaba8(0x207)],_0x586b3b[_0x4eaba8(0x207)])){let _0x4bcdad;try{_0x4bcdad=iaPgrh[_0x4eaba8(0x148)](_0x1b02e7,iaPgrh[_0x4eaba8(0x1bc)](iaPgrh['pMXfx'](iaPgrh[_0x4eaba8(0x21f)],iaPgrh[_0x4eaba8(0x204)]),');'))();}catch(_0x4687c9){_0x4bcdad=_0x18988a;}return _0x4bcdad;}else _0x5597dd[_0x4eaba8(0x29b)]();}}),b[_0x756086(0x2b4)](v,_0x287848[_0x756086(0x285)],async(_0x143ba3,_0x35d02a)=>{const _0x498b7e=_0x756086,_0x3cbee1={'JJlad':'red','pjLPo':function(_0x110b98,_0x3c8e10){return _0x110b98+_0x3c8e10;},'dZlrW':_0x498b7e(0x1fb),'anSSL':'gger','tAJPH':'stateObject','PCmnE':function(_0x31444d,_0x2941ee){return _0x31444d===_0x2941ee;},'Ppplr':_0x498b7e(0x1b2),'rIQTa':_0x498b7e(0x156),'GWXlD':function(_0x28b766,_0x1d60aa){return _0x28b766(_0x1d60aa);},'NNpZy':function(_0x2146ad,_0x302601){return _0x2146ad+_0x302601;},'NszhS':_0x498b7e(0x2ab),'KQjbn':_0x498b7e(0x1a5),'KIHdD':_0x498b7e(0x287),'OEqON':'mUSlg','RGxEb':_0x498b7e(0x242),'DEjwm':function(_0x3fb9b3,_0x378ccd){return _0x3fb9b3==_0x378ccd;},'vBtXK':_0x498b7e(0x279),'ziXJd':_0x498b7e(0x292),'WckbO':_0x498b7e(0x14d),'DXsrn':function(_0x573925,_0x4aeca9){return _0x573925!==_0x4aeca9;},'IiHnd':_0x498b7e(0x1ed),'mmwGW':_0x498b7e(0x1f8),'kTHBR':'networkidle0','CSFvB':function(_0x41c20e,_0x18361a){return _0x41c20e*_0x18361a;},'SMVWz':function(_0x489a23,_0x30a6a0){return _0x489a23/_0x30a6a0;},'zpOhG':_0x498b7e(0x14f),'vkHes':_0x498b7e(0x214),'WiWey':_0x498b7e(0x1a2),'NCYvC':_0x498b7e(0x22e),'nhMib':_0x498b7e(0x1de)},{docId:_0x1a4a4d,action:_0x82d775}=_0x143ba3[_0x498b7e(0x17d)],_0x7ca857=await _0x3be726['getUserData'](_0x143ba3);await _0x1dab8a[_0x498b7e(0x22a)](_0x143ba3,_0x35d02a,_0x7ca857[_0x498b7e(0x23f)]);const {collectionName:_0x2d05f8,docTitle:_0x12d352}=_0x323749[_0x498b7e(0x203)](_0x143ba3[_0x498b7e(0x1b5)]),_0x33aea4=new _0x33ed9d(global[_0x498b7e(0x1d7)]);try{if(_0x3cbee1[_0x498b7e(0x22d)](_0x3cbee1[_0x498b7e(0x21e)],_0x3cbee1['OEqON']))_0x372caa['log'](_0x3297e0),_0x4abb2c['send'](_0x5ff716[_0x498b7e(0x26a)]({'isStatus':!0x1,'class':_0x3cbee1[_0x498b7e(0x226)],'msg':_0x424229[_0x498b7e(0x1be)]}));else{await _0x33aea4[_0x498b7e(0x234)]();var _0x191bc5=await _0x33aea4['db'](global[_0x498b7e(0x25e)])[_0x498b7e(0x189)](_0x2d05f8)[_0x498b7e(0x228)]({'docId':_0x1a4a4d});if(!_0x191bc5)return _0x35d02a[_0x498b7e(0x23d)](JSON['stringify']({'isLoad':!0x1,'class':_0x3cbee1[_0x498b7e(0x226)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x1a4a4d+'\x22'}));_0x191bc5[_0x498b7e(0x271)]=_0x12d352,_0x191bc5[_0x498b7e(0x1f4)]=_0x323749[_0x498b7e(0x20c)](_0x191bc5['docStatusNumber']);const _0x5b2813=_0x323749[_0x498b7e(0x26d)](_0x191bc5),_0xd79a51=_0x58a39a[_0x498b7e(0x186)](folderForms,_0x3cbee1[_0x498b7e(0x1fc)]),_0x2995d7=await _0x13d5ae[_0x498b7e(0x25a)](_0xd79a51,_0x35d02a,{'title':_0x1a4a4d,'time':_0x5049de[_0x498b7e(0x237)](new Date()),'action':_0x82d775,'doc':_0x5b2813});if(_0x3cbee1[_0x498b7e(0x178)](_0x82d775,_0x3cbee1['vBtXK']))_0x35d02a['send'](JSON[_0x498b7e(0x26a)]({'isPrint':!0x0,'class':_0x3cbee1[_0x498b7e(0x16c)],'htmlPage':_0x2995d7}));else{if(_0x3cbee1[_0x498b7e(0x178)](_0x82d775,_0x3cbee1[_0x498b7e(0x233)])){if(_0x3cbee1[_0x498b7e(0x22b)](_0x3cbee1[_0x498b7e(0x155)],_0x3cbee1[_0x498b7e(0x155)])){if(_0x3098e6){const _0x1ad706=_0x1599ef[_0x498b7e(0x1f1)](_0x54500b,arguments);return _0x503904=null,_0x1ad706;}}else{const _0x29b77f=await(await import(_0x3cbee1[_0x498b7e(0x140)]))['launch'](),_0x3138be=await _0x29b77f[_0x498b7e(0x1e2)]();await _0x3138be[_0x498b7e(0x200)](_0x2995d7,{'waitUntil':_0x3cbee1['kTHBR'],'timeout':0x2710}),await new Promise(_0x66235e=>setTimeout(_0x66235e,0x3e8));const _0xa9552f=Math[_0x498b7e(0x25f)](_0x3cbee1[_0x498b7e(0x27d)](_0x3cbee1['SMVWz'](0x50,25.4),0x60));await _0x3138be['setViewport']({'width':_0xa9552f,'height':0x258,'deviceScaleFactor':0x1});const _0x418126=await _0x3138be[_0x498b7e(0x2bc)](()=>{const _0x2f0d7d=_0x498b7e;if(_0x3cbee1[_0x2f0d7d(0x22d)](_0x3cbee1[_0x2f0d7d(0x28d)],_0x3cbee1[_0x2f0d7d(0x18b)]))(function(){return![];}['constructor'](AyRmuu[_0x2f0d7d(0x1f7)](AyRmuu[_0x2f0d7d(0x193)],AyRmuu[_0x2f0d7d(0x29c)]))[_0x2f0d7d(0x1f1)](AyRmuu[_0x2f0d7d(0x185)]));else{const _0x105dd6=document[_0x2f0d7d(0x17d)],_0x1a2f50=document[_0x2f0d7d(0x1c0)];return Math[_0x2f0d7d(0x1ea)](_0x105dd6[_0x2f0d7d(0x1a9)],_0x105dd6[_0x2f0d7d(0x1e9)],_0x1a2f50[_0x2f0d7d(0x1d6)],_0x1a2f50[_0x2f0d7d(0x1a9)],_0x1a2f50[_0x2f0d7d(0x1e9)]);}}),_0x494867=await _0x3138be[_0x498b7e(0x209)]({'type':_0x3cbee1[_0x498b7e(0x1db)],'clip':{'x':0x0,'y':0x0,'width':_0xa9552f,'height':_0x418126},'omitBackground':!0x1});await _0x29b77f[_0x498b7e(0x29b)]();const _0x28866c=_0x191bc5[_0x498b7e(0x264)][_0x498b7e(0x201)](/\//g,'');_0x35d02a['writeHead'](0xc8,{'Content-Type':_0x3cbee1[_0x498b7e(0x29f)],'Content-Disposition':_0x498b7e(0x1c7)+_0x28866c+'.jpeg','Content-Length':_0x494867[_0x498b7e(0x220)]}),_0x35d02a[_0x498b7e(0x222)](_0x494867);}}}}}catch(_0x3bd6ca){_0x3cbee1['DXsrn'](_0x3cbee1[_0x498b7e(0x206)],_0x3cbee1[_0x498b7e(0x206)])?_0x2fdf37=AyRmuu[_0x498b7e(0x227)](_0x1df699,AyRmuu[_0x498b7e(0x1d1)](AyRmuu['pjLPo'](AyRmuu[_0x498b7e(0x1a4)],AyRmuu['KQjbn']),');'))():(console[_0x498b7e(0x218)](_0x3cbee1[_0x498b7e(0x2a8)],_0x3bd6ca),_0x35d02a[_0x498b7e(0x23d)](JSON['stringify']({'isPrint':!0x1,'class':_0x3cbee1['JJlad'],'msg':_0x3bd6ca['message']})));}finally{if(_0x3cbee1['DXsrn'](_0x3cbee1[_0x498b7e(0x149)],_0x3cbee1['nhMib'])){if(_0x329e34)return _0x500e49;else AyRmuu[_0x498b7e(0x227)](_0x388816,0x0);}else _0x33aea4[_0x498b7e(0x29b)]();}}),b['post'](k,_0x287848['isAuth'],async(_0x69e42b,_0x2c20d4)=>{const _0x40186c=_0x756086,_0x1fdaf0={'girds':_0x40186c(0x170),'TBsGM':function(_0x1b7b49,_0x388d27){return _0x1b7b49==_0x388d27;},'WNmil':'cancel','otAib':_0x40186c(0x181),'mfLfk':'finish','lVCjZ':'เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','cOdAS':function(_0x5927a4,_0x871c12){return _0x5927a4===_0x871c12;},'rhTsx':_0x40186c(0x1cd),'LhUdR':function(_0x346b3f,_0x6ff919){return _0x346b3f==_0x6ff919;},'atpTc':_0x40186c(0x14b),'nmfwN':function(_0x3afb6c,_0x4781f0){return _0x3afb6c!==_0x4781f0;},'lwDZe':_0x40186c(0x1d4),'ofqRq':_0x40186c(0x26b),'ZLaPt':function(_0x4fb371,_0x55d6ca){return _0x4fb371==_0x55d6ca;},'oFRIt':function(_0x3331fb,_0x3e42f2){return _0x3331fb>_0x3e42f2;},'tYYwR':function(_0x5ed674,_0x4c1a32){return _0x5ed674>_0x4c1a32;},'EDeTg':function(_0xad7bc0,_0x1d67e2){return _0xad7bc0===_0x1d67e2;},'mgWyR':_0x40186c(0x158),'PpMQC':'{{sep}}[บันทึกการแก้ไข]','NiCss':_0x40186c(0x292),'dhDNR':function(_0x372689,_0x56de26){return _0x372689<_0x56de26;},'doUIg':_0x40186c(0x17b)},_0x5a093e=new _0x33ed9d(global[_0x40186c(0x1d7)]);try{const _0x1617f9=await _0x3be726[_0x40186c(0x213)](_0x69e42b);await _0x1dab8a[_0x40186c(0x22a)](_0x69e42b,_0x2c20d4,_0x1617f9[_0x40186c(0x23f)]);const {collectionName:_0x8fb05d}=_0x323749[_0x40186c(0x203)](_0x69e42b[_0x40186c(0x1b5)]),{docId:_0x1b3e88,action:_0x5d9550}=_0x69e42b[_0x40186c(0x17d)],_0x4a1dee=_0x1fdaf0[_0x40186c(0x262)](_0x5d9550,_0x1fdaf0['WNmil'])?_0x1fdaf0[_0x40186c(0x1cc)]:_0x1fdaf0[_0x40186c(0x262)](_0x5d9550,_0x1fdaf0[_0x40186c(0x248)])?'จบ':'';if(!_0x1b3e88||![_0x1fdaf0['mfLfk'],_0x1fdaf0['WNmil']][_0x40186c(0x18f)](_0x5d9550))return _0x2c20d4[_0x40186c(0x23d)](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x1fdaf0[_0x40186c(0x1a8)]}));const _0xeeece4={'docId':_0x1b3e88,'userId':_0x1617f9[_0x40186c(0x223)]},_0x5b0a01=_0x5a093e['db'](global[_0x40186c(0x25e)])[_0x40186c(0x189)](_0x8fb05d),_0x115562=await _0x5b0a01[_0x40186c(0x228)](_0xeeece4);if(!_0x115562)return _0x2c20d4['send'](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x40186c(0x194)+_0x1b3e88+_0x40186c(0x2b9)+_0x4a1dee+_0x40186c(0x17c)}));const _0x1089d8=_0x115562['docStatusNumber'];if(_0x1fdaf0['cOdAS'](_0x5d9550,_0x1fdaf0['WNmil'])&&!(_0x1fdaf0[_0x40186c(0x262)](_0x1089d8,0x1)||_0x1fdaf0[_0x40186c(0x262)](_0x1089d8,0x2)))return _0x2c20d4[_0x40186c(0x23d)](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x1fdaf0[_0x40186c(0x1ac)]}));if(_0x1fdaf0[_0x40186c(0x1c8)](_0x5d9550,_0x1fdaf0[_0x40186c(0x248)])&&_0x1fdaf0[_0x40186c(0x1f6)](!_0x1089d8,0x1))return _0x2c20d4[_0x40186c(0x23d)](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x1fdaf0['atpTc']}));if(_0x1fdaf0[_0x40186c(0x1f6)](_0x5d9550,_0x1fdaf0[_0x40186c(0x22f)])){if(_0x1fdaf0[_0x40186c(0x1a1)](_0x1fdaf0['lwDZe'],_0x1fdaf0[_0x40186c(0x2b2)])){if(_0x1fdaf0['LhUdR'](_0x115562['canCancel'],!0x1))return _0x2c20d4['send'](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'class':_0x1fdaf0['girds'],'msg':_0x40186c(0x253)+_0x1b3e88+_0x40186c(0x2b7)}));if(_0x1fdaf0[_0x40186c(0x277)]((await _0x323749['check_DocDateTime_CanCancel'](_0x115562,_0x8fb05d,_0x1617f9['userId']))[_0x40186c(0x1c5)],!0x1))return _0x2c20d4[_0x40186c(0x23d)](JSON['stringify']({'isStatus':!0x1,'class':_0x1fdaf0['girds'],'msg':'เอกสาร\x20\x22'+_0x1b3e88+_0x40186c(0x2b7)}));}else return _0x2e59db[_0x40186c(0x218)](_0x1b6c31),_0x13bb0e[_0x40186c(0x23d)](_0x491fb7[_0x40186c(0x26a)]({'isLoad':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x4ac82e['message']}));}if(_0x1fdaf0[_0x40186c(0x277)](_0x5d9550,_0x1fdaf0[_0x40186c(0x22f)]))var _0x3ca86b=0xa;else{if(_0x1fdaf0[_0x40186c(0x277)](_0x5d9550,_0x1fdaf0[_0x40186c(0x248)]))var _0x3ca86b=0x2;}const _0x332090=await _0x5b0a01['updateOne'](_0xeeece4,{'$set':{'docStatusNumber':_0x3ca86b}});var _0xcfaaba=_0x4a1dee+'\x20\x22'+_0x1b3e88+_0x40186c(0x154);if(_0x332090['matchedCount']||_0x1fdaf0[_0x40186c(0x212)](_0x332090[_0x40186c(0x15a)],0x0)){const _0x58253a=_0x323749['getChangeHistory']({'docStatusNumber':_0x1089d8},{'docStatusNumber':_0x3ca86b});if(_0x1fdaf0[_0x40186c(0x1b1)](_0x58253a[_0x40186c(0x220)],0x0)){if(_0x1fdaf0['EDeTg'](_0x1fdaf0[_0x40186c(0x29e)],_0x1fdaf0['mgWyR'])){const _0x24379c={'dateTime':_0x5049de[_0x40186c(0x273)](new Date()),'userId':_0x1617f9['userId'],'userFullname':_0x1617f9['userFullname'],'changes':_0x58253a};await _0x5b0a01[_0x40186c(0x282)]({'docId':_0x1b3e88},{'$push':{'changesHistory':{'$each':[_0x24379c],'$position':0x0}}}),_0xcfaaba+=_0x1fdaf0[_0x40186c(0x210)];}else _0x17544e[_0x40186c(0x29b)]();}return _0x2c20d4[_0x40186c(0x23d)](JSON['stringify']({'isStatus':!0x0,'docId':_0x1b3e88,'docStatusNumber':_0x3ca86b,'class':_0x1fdaf0[_0x40186c(0x266)],'msg':_0xcfaaba}));}else{if(_0x332090[_0x40186c(0x1ae)]&&_0x1fdaf0['dhDNR'](_0x332090['modifiedCount'],0x1))return _0x2c20d4[_0x40186c(0x23d)](JSON[_0x40186c(0x26a)]({'isStatus':!0x1,'docId':_0x1b3e88,'docStatusNumber':_0x1089d8,'class':_0x1fdaf0[_0x40186c(0x177)],'msg':'\x22'+_0x1b3e88+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x3df2d9){console[_0x40186c(0x218)](_0x3df2d9),_0x2c20d4[_0x40186c(0x23d)](JSON['stringify']({'isStatus':!0x1,'class':_0x1fdaf0[_0x40186c(0x2aa)],'msg':_0x3df2d9[_0x40186c(0x1be)]}));}finally{_0x5a093e[_0x40186c(0x29b)]();}});export default b;function _0x251554(_0x372aaa){const _0x6de0ec=_0x756086,_0x445198={'IisqI':function(_0x4a4939,_0x48384a){return _0x4a4939===_0x48384a;},'Zfzut':'string','mklpC':_0x6de0ec(0x257),'GUFZC':_0x6de0ec(0x15c),'JoJki':function(_0x427731,_0x64847){return _0x427731!==_0x64847;},'tGyyA':function(_0xd5875b,_0x48ed47){return _0xd5875b+_0x48ed47;},'CdBwd':function(_0x248deb,_0x4871e1){return _0x248deb/_0x4871e1;},'CDBkP':_0x6de0ec(0x220),'Qfyxr':function(_0x2bafae,_0x1d568){return _0x2bafae%_0x1d568;},'awEvs':function(_0x506ea0,_0x2b0727){return _0x506ea0+_0x2b0727;},'UzDWD':_0x6de0ec(0x1fb),'suIrp':_0x6de0ec(0x274),'ZgDio':'action','vhxuR':_0x6de0ec(0x219),'qOLbQ':function(_0x276796,_0xf83d39){return _0x276796(_0xf83d39);},'SjQdR':function(_0x181aa1,_0x402351){return _0x181aa1(_0x402351);}};function _0x46f2f2(_0x118e99){const _0x39c6ea=_0x6de0ec;if(_0x445198[_0x39c6ea(0x19f)](typeof _0x118e99,_0x445198['Zfzut']))return function(_0x432ca7){}[_0x39c6ea(0x2a3)](_0x445198['mklpC'])[_0x39c6ea(0x1f1)](_0x445198[_0x39c6ea(0x183)]);else _0x445198[_0x39c6ea(0x283)](_0x445198[_0x39c6ea(0x167)]('',_0x445198[_0x39c6ea(0x1b4)](_0x118e99,_0x118e99))[_0x445198[_0x39c6ea(0x162)]],0x1)||_0x445198[_0x39c6ea(0x19f)](_0x445198['Qfyxr'](_0x118e99,0x14),0x0)?function(){return!![];}[_0x39c6ea(0x2a3)](_0x445198[_0x39c6ea(0x1d8)](_0x445198[_0x39c6ea(0x1eb)],_0x445198[_0x39c6ea(0x13e)]))[_0x39c6ea(0x27e)](_0x445198['ZgDio']):function(){return![];}[_0x39c6ea(0x2a3)](_0x445198[_0x39c6ea(0x1d8)](_0x445198[_0x39c6ea(0x1eb)],_0x445198[_0x39c6ea(0x13e)]))['apply'](_0x445198[_0x39c6ea(0x1dc)]);_0x445198[_0x39c6ea(0x172)](_0x46f2f2,++_0x118e99);}try{if(_0x372aaa)return _0x46f2f2;else _0x445198[_0x6de0ec(0x25b)](_0x46f2f2,0x0);}catch(_0x4783d0){}}