const _0x21150a=_0x519a;(function(_0x2b6176,_0x589623){const _0x41358f=_0x519a,_0x5a5c59=_0x2b6176();while(!![]){try{const _0x36179d=-parseInt(_0x41358f(0x208))/0x1+-parseInt(_0x41358f(0x204))/0x2+parseInt(_0x41358f(0x1e8))/0x3+parseInt(_0x41358f(0x190))/0x4+-parseInt(_0x41358f(0x205))/0x5+-parseInt(_0x41358f(0x246))/0x6*(parseInt(_0x41358f(0x256))/0x7)+parseInt(_0x41358f(0x191))/0x8;if(_0x36179d===_0x589623)break;else _0x5a5c59['push'](_0x5a5c59['shift']());}catch(_0x2841c5){_0x5a5c59['push'](_0x5a5c59['shift']());}}}(_0x5d61,0x8cef9));const _0x28d3a6=(function(){const _0x46e1de=_0x519a,_0xf2a228={'anjro':function(_0x5c0033,_0x54bc11){return _0x5c0033(_0x54bc11);},'STpIo':function(_0x28258f,_0x345edc){return _0x28258f!==_0x345edc;},'EBOiV':'PTGOy','lprfH':'ecWnc','JuRmP':function(_0x110bcd,_0x5e8257){return _0x110bcd===_0x5e8257;},'TLjBm':_0x46e1de(0x275),'JzwHh':_0x46e1de(0x139),'ubdIr':'gqHmr','MAJJV':_0x46e1de(0x15a)};let _0xc4798f=!![];return function(_0x4f0611,_0x46c29f){const _0x1dc489=_0x46e1de,_0x216ee5={'tTgPG':function(_0x5a160d,_0xa4878d){const _0x3795a5=_0x519a;return _0xf2a228[_0x3795a5(0x1b6)](_0x5a160d,_0xa4878d);},'ZcErz':function(_0x57f2e1,_0x21e4fa){const _0x33a83e=_0x519a;return _0xf2a228[_0x33a83e(0x159)](_0x57f2e1,_0x21e4fa);},'mJFgP':_0xf2a228[_0x1dc489(0x187)],'ztdzr':_0xf2a228[_0x1dc489(0x283)],'CVLQJ':function(_0x10826a,_0x588ab0){const _0x1cc566=_0x1dc489;return _0xf2a228[_0x1cc566(0x1ed)](_0x10826a,_0x588ab0);},'mBBJG':_0xf2a228['TLjBm'],'OmNqt':_0xf2a228[_0x1dc489(0x1af)]};if(_0xf2a228[_0x1dc489(0x159)](_0xf2a228['ubdIr'],_0xf2a228[_0x1dc489(0x1df)])){const _0x562bbe=_0xc4798f?function(){const _0x264cb9=_0x1dc489,_0x48cad0={'jJuxd':function(_0x11bc2b,_0x1370f3){return _0x216ee5['tTgPG'](_0x11bc2b,_0x1370f3);}};if(_0x216ee5[_0x264cb9(0x291)](_0x216ee5[_0x264cb9(0x141)],_0x216ee5[_0x264cb9(0x28b)])){if(_0x46c29f){if(_0x216ee5[_0x264cb9(0x12e)](_0x216ee5[_0x264cb9(0x22e)],_0x216ee5['OmNqt'])){const _0x1863a8=_0xe74487[_0x264cb9(0x152)](_0x26204f,arguments);return _0x30077a=null,_0x1863a8;}else{const _0x2adeb4=_0x46c29f[_0x264cb9(0x152)](_0x4f0611,arguments);return _0x46c29f=null,_0x2adeb4;}}}else _0x48cad0[_0x264cb9(0x135)](_0x5010ef,'0');}:function(){};return _0xc4798f=![],_0x562bbe;}else{if(_0x1784ba){const _0x19f0f4=_0x19fd38[_0x1dc489(0x152)](_0x50cb3f,arguments);return _0x4ab3e8=null,_0x19f0f4;}}};}());(function(){const _0xe5534c=_0x519a,_0x4ad6eb={'nUZwp':function(_0x4de07f){return _0x4de07f();},'eDdDm':_0xe5534c(0x154),'chxGz':function(_0x1a99f8,_0x4330c6){return _0x1a99f8!==_0x4330c6;},'saTFj':_0xe5534c(0x1c1),'WfyEk':_0xe5534c(0x247),'eKFmY':_0xe5534c(0x26e),'PcQQa':_0xe5534c(0x1c5),'TlZHj':function(_0x51fef6,_0x3df895){return _0x51fef6(_0x3df895);},'DxMtk':_0xe5534c(0x222),'IErrq':function(_0x58c215,_0x440ac){return _0x58c215+_0x440ac;},'FdZkf':_0xe5534c(0x1ec),'gCJwK':function(_0x2c59fb,_0x1e3534){return _0x2c59fb+_0x1e3534;},'LgYNq':_0xe5534c(0x2a2),'OQFxu':_0xe5534c(0x284),'riSTr':_0xe5534c(0x14d),'PXdDT':function(_0x56cc4a,_0x5ca7ee){return _0x56cc4a(_0x5ca7ee);},'jLXKm':function(_0x26ba99,_0x2c24f6){return _0x26ba99===_0x2c24f6;},'tOmSG':_0xe5534c(0x1bd),'gPciz':_0xe5534c(0x16c),'leYLC':function(_0x4b3429){return _0x4b3429();},'VRdmM':function(_0x48eb85,_0x39e980,_0x944a8d){return _0x48eb85(_0x39e980,_0x944a8d);}};_0x4ad6eb[_0xe5534c(0x241)](_0x28d3a6,this,function(){const _0x349a5b=_0xe5534c,_0xc1ee6d={'Hrthp':function(_0x3542b3){return _0x4ad6eb['nUZwp'](_0x3542b3);},'uoUgx':_0x4ad6eb[_0x349a5b(0x249)]};if(_0x4ad6eb[_0x349a5b(0x1d0)](_0x4ad6eb[_0x349a5b(0x174)],_0x4ad6eb['WfyEk'])){const _0x2fc61e=new RegExp(_0x4ad6eb[_0x349a5b(0x1c7)]),_0x14fc65=new RegExp(_0x4ad6eb[_0x349a5b(0x13c)],'i'),_0x5e87ff=_0x4ad6eb[_0x349a5b(0x19a)](_0x913c53,_0x4ad6eb['DxMtk']);if(!_0x2fc61e['test'](_0x4ad6eb[_0x349a5b(0x24a)](_0x5e87ff,_0x4ad6eb[_0x349a5b(0x140)]))||!_0x14fc65[_0x349a5b(0x223)](_0x4ad6eb[_0x349a5b(0x1a9)](_0x5e87ff,_0x4ad6eb['LgYNq'])))_0x4ad6eb[_0x349a5b(0x1d0)](_0x4ad6eb[_0x349a5b(0x289)],_0x4ad6eb[_0x349a5b(0x12f)])?_0x4ad6eb[_0x349a5b(0x1bb)](_0x5e87ff,'0'):_0xc1ee6d[_0x349a5b(0x29e)](_0x4ba1f2);else{if(_0x4ad6eb[_0x349a5b(0x267)](_0x4ad6eb[_0x349a5b(0x1e6)],_0x4ad6eb['gPciz']))return _0x3cf98d['log'](_0x20abcd),_0x4ab521[_0x349a5b(0x242)](_0x123790[_0x349a5b(0x217)]({'isLoad':!0x1,'class':_0xc1ee6d[_0x349a5b(0x224)],'msg':_0x5f3354[_0x349a5b(0x1d7)]}));else _0x4ad6eb[_0x349a5b(0x163)](_0x913c53);}}else return!![];})();}());const _0x55a1c5=(function(){const _0x4e4660=_0x519a,_0x5cdbcd={'JvyJr':function(_0x7ee66f,_0x298486){return _0x7ee66f(_0x298486);},'Xdhhz':function(_0x1803d9,_0x578857){return _0x1803d9+_0x578857;},'MJkqJ':function(_0x49957e,_0x48ee11){return _0x49957e+_0x48ee11;},'PtPBw':_0x4e4660(0x13d),'fMGmj':_0x4e4660(0x156),'NPhEn':function(_0x5f2129,_0x4cb1aa){return _0x5f2129!==_0x4cb1aa;},'qjivl':_0x4e4660(0x253),'SImEr':'yTkcZ','BFOTP':_0x4e4660(0x1fc),'kLrcu':function(_0x10c8ec,_0x5d0736){return _0x10c8ec===_0x5d0736;},'VaFhR':'GtvCz','YDXbq':_0x4e4660(0x276)};let _0x28afaa=!![];return function(_0x1a889e,_0x3e4710){const _0x5a108d=_0x4e4660,_0x56f4e0={'biDRo':function(_0x4b486,_0x5a613e){const _0x5731c4=_0x519a;return _0x5cdbcd[_0x5731c4(0x1fe)](_0x4b486,_0x5a613e);},'ltxMy':_0x5cdbcd['qjivl'],'SEpDi':function(_0x2ada90,_0x3aa628){return _0x5cdbcd['NPhEn'](_0x2ada90,_0x3aa628);},'oZjeo':_0x5cdbcd[_0x5a108d(0x211)],'Gtole':_0x5cdbcd[_0x5a108d(0x1b0)]};if(_0x5cdbcd['kLrcu'](_0x5cdbcd[_0x5a108d(0x146)],_0x5cdbcd[_0x5a108d(0x29a)])){let _0x167544;try{_0x167544=_0x5cdbcd[_0x5a108d(0x1c9)](_0x3a6f44,_0x5cdbcd[_0x5a108d(0x1e3)](_0x5cdbcd[_0x5a108d(0x25b)](_0x5cdbcd['PtPBw'],_0x5cdbcd[_0x5a108d(0x216)]),');'))();}catch(_0x565c9f){_0x167544=_0x30b7bd;}return _0x167544;}else{const _0x2f9866=_0x28afaa?function(){const _0x34da3c=_0x5a108d;if(_0x56f4e0['biDRo'](_0x56f4e0[_0x34da3c(0x180)],_0x56f4e0[_0x34da3c(0x180)]))_0x33fc2a['close']();else{if(_0x3e4710){if(_0x56f4e0[_0x34da3c(0x12c)](_0x56f4e0[_0x34da3c(0x123)],_0x56f4e0[_0x34da3c(0x12d)])){const _0x1d5a43=_0x3e4710[_0x34da3c(0x152)](_0x1a889e,arguments);return _0x3e4710=null,_0x1d5a43;}else _0x2d3541[_0x34da3c(0x1fb)]();}}}:function(){};return _0x28afaa=![],_0x2f9866;}};}()),_0xa2c8c5=_0x55a1c5(this,function(){const _0x2199d4=_0x519a,_0x440b01={'qQQhF':'error\x20===>\x20','iVPGA':_0x2199d4(0x154),'WXXBb':function(_0x262e00,_0x5c683a){return _0x262e00(_0x5c683a);},'SIhPE':function(_0x519555,_0x4b13a5){return _0x519555===_0x4b13a5;},'flyMa':_0x2199d4(0x1f2),'EtZIK':_0x2199d4(0x162),'AClFd':function(_0x40f838,_0x8e8d36){return _0x40f838===_0x8e8d36;},'gqakS':_0x2199d4(0x133),'hfqMw':function(_0x351120,_0x1cb1ba){return _0x351120(_0x1cb1ba);},'Vgcju':function(_0x5841a2,_0x4ab6b1){return _0x5841a2+_0x4ab6b1;},'ixCJX':'return\x20(function()\x20','ciuZP':_0x2199d4(0x156),'zdozD':function(_0x39f550,_0x3321a6){return _0x39f550!==_0x3321a6;},'cJaXq':_0x2199d4(0x210),'wfxUk':'hECIb','XrmLR':_0x2199d4(0x26e),'YykAP':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','LJzhi':function(_0x3b6ec0,_0xe5a1db){return _0x3b6ec0(_0xe5a1db);},'zkdWW':_0x2199d4(0x222),'yljFV':_0x2199d4(0x1ec),'mgtOy':_0x2199d4(0x2a2),'FRhAb':function(_0x540012){return _0x540012();},'Mifiq':function(_0x4dd7c5){return _0x4dd7c5();},'LSwGK':_0x2199d4(0x255),'owJPc':'warn','ggaSh':_0x2199d4(0x262),'yVDhU':'error','wvWVi':_0x2199d4(0x26a),'kelYT':_0x2199d4(0x26f),'GHLHJ':_0x2199d4(0x127),'KhEVA':function(_0x849ac2,_0x202894){return _0x849ac2<_0x202894;},'dVHjf':function(_0x5064d5,_0x2cb5cb){return _0x5064d5!==_0x2cb5cb;},'qeoOd':'zQmEf','InByv':'swwVd'},_0x328595=function(){const _0x51cb7f=_0x2199d4;if(_0x440b01[_0x51cb7f(0x299)](_0x440b01['flyMa'],_0x440b01[_0x51cb7f(0x19f)])){const _0x12691b=_0x2bd64e?function(){if(_0x1d808c){const _0x377ba8=_0x284c15['apply'](_0x3b7dd0,arguments);return _0x4bfdd8=null,_0x377ba8;}}:function(){};return _0x17650b=![],_0x12691b;}else{let _0x3b87f2;try{_0x440b01[_0x51cb7f(0x22c)](_0x440b01[_0x51cb7f(0x21c)],_0x440b01[_0x51cb7f(0x21c)])?_0x3b87f2=_0x440b01['hfqMw'](Function,_0x440b01[_0x51cb7f(0x16d)](_0x440b01[_0x51cb7f(0x16d)](_0x440b01['ixCJX'],_0x440b01[_0x51cb7f(0x150)]),');'))():(_0x1536f3[_0x51cb7f(0x255)](_0x440b01[_0x51cb7f(0x1fa)],_0x2493d1),_0x47099b[_0x51cb7f(0x242)](_0x4bba91['stringify']({'isPrint':!0x1,'class':_0x440b01[_0x51cb7f(0x21d)],'msg':_0xd5a250[_0x51cb7f(0x1d7)]})));}catch(_0x22c259){_0x440b01[_0x51cb7f(0x1a3)](_0x440b01['cJaXq'],_0x440b01['wfxUk'])?_0x3b87f2=window:_0x440b01[_0x51cb7f(0x260)](_0xd5e500,0x0);}return _0x3b87f2;}},_0x57c178=_0x440b01['Mifiq'](_0x328595),_0x9b93f5=_0x57c178[_0x2199d4(0x202)]=_0x57c178[_0x2199d4(0x202)]||{},_0x5a5ca0=[_0x440b01[_0x2199d4(0x1f7)],_0x440b01[_0x2199d4(0x2a5)],_0x440b01['ggaSh'],_0x440b01[_0x2199d4(0x215)],_0x440b01[_0x2199d4(0x290)],_0x440b01[_0x2199d4(0x27f)],_0x440b01['GHLHJ']];for(let _0x221cc7=0x0;_0x440b01[_0x2199d4(0x1b3)](_0x221cc7,_0x5a5ca0['length']);_0x221cc7++){if(_0x440b01['dVHjf'](_0x440b01['qeoOd'],_0x440b01[_0x2199d4(0x1f8)])){const _0x3653c2=_0x55a1c5[_0x2199d4(0x147)][_0x2199d4(0x19c)][_0x2199d4(0x1c4)](_0x55a1c5),_0x26c4e5=_0x5a5ca0[_0x221cc7],_0x407c30=_0x9b93f5[_0x26c4e5]||_0x3653c2;_0x3653c2[_0x2199d4(0x143)]=_0x55a1c5[_0x2199d4(0x1c4)](_0x55a1c5),_0x3653c2['toString']=_0x407c30[_0x2199d4(0x155)][_0x2199d4(0x1c4)](_0x407c30),_0x9b93f5[_0x26c4e5]=_0x3653c2;}else{const _0x341679=new _0x327854(_0x440b01[_0x2199d4(0x2a6)]),_0x189c7b=new _0x52ab6b(_0x440b01[_0x2199d4(0x1b4)],'i'),_0x36048b=_0x440b01[_0x2199d4(0x197)](_0x9f8bf7,_0x440b01[_0x2199d4(0x1b5)]);!_0x341679[_0x2199d4(0x223)](_0x440b01['Vgcju'](_0x36048b,_0x440b01[_0x2199d4(0x1e1)]))||!_0x189c7b[_0x2199d4(0x223)](_0x440b01['Vgcju'](_0x36048b,_0x440b01[_0x2199d4(0x27d)]))?_0x440b01[_0x2199d4(0x260)](_0x36048b,'0'):_0x440b01['FRhAb'](_0x1f010a);}}});_0xa2c8c5();import _0x43eecf from'express';const b=_0x43eecf[_0x21150a(0x19d)]();import _0x18a745 from'path';function _0x5d61(){const _0x5e3214=['PxIMj','CpqBc','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','EUiZW','CyubW','jJuxd','UkyVy','convert_DocPrint','cjCnF','nMlMi','cLEUr','cRUxY','PcQQa','return\x20(function()\x20','ridfx','ไม่พบประวัติการเปลี่ยนแปลง','FdZkf','mJFgP','Kdjbp','__proto__','cBKMj','check_DocDateTime_CanEdit','VaFhR','constructor','{{sep}}[บันทึกการแก้ไข]','oeaeL','amnul','green','rUrca','qRsfI','branchName','pIDCq','ciuZP','dEfQl','apply','RXBia','red','toString','{}.constructor(\x22return\x20this\x22)(\x20)','IiGFq','GvzvT','STpIo','oJRec','clientHeight','length','Vhbiv','KbJwk','NhnGy','nxRGQ','YKLJq','hjKeL','leYLC','upDIf','MRvnG','body','\x22\x20เอกสาร','check_DocDateTime_CanCancel','tdfWe','FcaHp','toArray','RBfrt','Vgcju','CMuXf','dbUrl','vsBOZ','yfMQE','userFullname','documentElement','saTFj','AplXb','getMainDocPathObj','post','{{sep}}หรือไม่มีสิทธิ์','zMOwh','mDKSw','BCiFe','RwmAg','wVITK','image','dateTimeCanEdit','ltxMy','BakLW','load','tLMQM','SxkYI','uWhNp','launch','EBOiV','zURQk','mjlXP','aBzgc','gkwdP','TNrNQ','.jpeg','OVzOG','image/jpeg','1102896efzAxi','12220936UWeZyD','collection','CdaEh','rjmKU','sEzVu','wZvMo','LJzhi','aSDvd','join','TlZHj','UnnAo','prototype','Router','IpunI','EtZIK','MrfTL','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','originalUrl','zdozD','cQsNm','MUnKL','/status','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','yrLRe','gCJwK','\x22\x20{{sep}}เรียบร้อยแล้ว','เอกสาร\x20\x22','doc_print.ejs','ybdBV','getUserData','JzwHh','BFOTP','floor','yUHNX','KhEVA','YykAP','zkdWW','anjro','/print','connect','userAuthority','iovkV','PXdDT','uwIyK','QHOKW','NItpF','includes','iBZqy','qbHpi','XYYhQ','nZTBz','bind','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','action','eKFmY','WOLdX','JvyJr','warehouseOut','getChangeHistory','oCmpM','unSpt','keZlN','KrYwg','chxGz','getItems_for_Modal','โหลดเอกสารเลขที่\x20\x22','NvwEn','xzCpZ','ePRfE','พบ\x20\x22','message','prsOB','setViewport','TDPpr','ไม่พบเอกสารล่าสุด','PATH_SALES','UfLBn','EuaCO','MAJJV','ZHJRF','yljFV','canCancel','Xdhhz','updateOne','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','tOmSG','RPzoM','3018390igVdtZ','OYXji','push','vmqNF','chain','JuRmP','dateTimeEditRemain','KhyiM','gOQYB','while\x20(true)\x20{}','LVCbJ','yAQuP','isPaS','nJemQ','userId','LSwGK','InByv','JjkTc','qQQhF','close','PLzcf','error\x20===>\x20','NPhEn','TjIic','XiDqi','aggregate','console','formatDate','831566mCruxA','4543830ryepFk','max','stateObject','119616qqPmLs','QZAvD','offsetHeight','docTitle','iWmCh','docStatusNumber','FSdFt','mbEux','kuLpQ','SImEr','active','ไม่พบเอกสารเลขที่\x20\x22','WcMrw','yVDhU','fMGmj','stringify','XmTPb','nGwTE','rykdL','AFwgB','gqakS','iVPGA','setContent','IfKmM','networkidle0','gger','init','test','uoUgx','gNmok','screenshot','ymBdW','/search','Grpia','doc_changes.ejs','get_Info_ByUrl','AClFd','ZWERT','mBBJG','warehouseIn','yellow','ACXbu','BpwwW','string','replace','formatDateTime','bEFbi','stock','get','SbMLF','ggyng','VwHxv','MWWhQ','eVlGf','tToVE','kAQIp','GnWms','VRdmM','send','aYYVX','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','BTHuM','4728198aJOKrS','yunJQ','dateTimeCancelRemain','eDdDm','IErrq','branchId','nYmrF','QIRoq','OMTWE','cancel','VfjFb','evaluate','vNdwe','kwWgQ','dbName','log','7mWqVhV','RnVXb','/load','docId','PATH_WAREHOUSE_IN','MJkqJ','UqueX','load-last','jpeg','rggNV','WXXBb','RcvFu','info','SOOkb','HRHIG','call','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','jLXKm','debu','VmcZz','exception','efXCB','puppeteer','renderView','function\x20*\x5c(\x20*\x5c)','table','isAuth','ymhIU','KMTyB','vEfwN','uCLVo','bwDPg','Llzco','changesHistory','counter','/load-last','PFuiQ','UtZqc','XpzUl','mgtOy','UGIPR','kelYT','OfWip','matchedCount','xnQwj','lprfH','JWGnp','vAHNr','BUbMd','lAEHr','VPSbc','OQFxu','hiPlu','ztdzr','cyQNF','GEqFx','fNnOy','xsujP','wvWVi','ZcErz','usPBO','/fetch/modal','/changes','scrollHeight','ZdZTT','mvHZa','end','SIhPE','YDXbq','lInfx','FhKva','clOxa','Hrthp','getItemsCategory','OJMRs','SKhhD','input','modifiedCount','print','owJPc','XrmLR','pUCzv','COwSc','findOne','BcVCH','qoOwC','\x22\x20เรียบร้อยแล้ว','MRCLn','writeHead','oZjeo','QSBHV','sEoYa','canEdit','trace','bwAdT','XKxtR','EMHSI','DOC_TYPE','SEpDi','Gtole','CVLQJ','riSTr'];_0x5d61=function(){return _0x5e3214;};return _0x5d61();}import{MongoClient as _0x3f90a5}from'mongodb';import _0x216681 from'../middleware/mainAuth.js';import*as _0x40b863 from'../mymodule/myUsers.js';function _0x519a(_0x4c5b23,_0x243b89){const _0x2ab479=_0x5d61();return _0x519a=function(_0xa2c8c5,_0x55a1c5){_0xa2c8c5=_0xa2c8c5-0x11f;let _0x5d79fe=_0x2ab479[_0xa2c8c5];return _0x5d79fe;},_0x519a(_0x4c5b23,_0x243b89);}import*as _0x36ab15 from'../mymodule/myDateTime.js';import*as _0x1edb6b from'../mymodule/myModule.js';import*as _0x1dd159 from'../mymodule/myDocMain.js';import*as _0x36a79e from'../mymodule/myData.js';const w=global[_0x21150a(0x25a)],S=global['PATH_WAREHOUSE_OUT'],p=global[_0x21150a(0x1dc)],M=[w+_0x21150a(0x294),S+'/changes',p+_0x21150a(0x294)],v=[w+'/print',S+_0x21150a(0x1b7),p+_0x21150a(0x1b7)],k=[w+'/status',S+'/status',p+_0x21150a(0x1a6)],B=[w+_0x21150a(0x228),S+_0x21150a(0x228),p+'/search'],x=[w+_0x21150a(0x258),S+_0x21150a(0x258),p+'/load',w+_0x21150a(0x279),S+'/load-last',p+_0x21150a(0x279)],L=[w+'/fetch/modal',S+'/fetch/modal',p+_0x21150a(0x293)];b[_0x21150a(0x238)](L,_0x216681[_0x21150a(0x270)],async(_0x567b86,_0x5729af)=>{const _0xf0559c=_0x21150a,_0x334678={'euyWf':'error\x20===>\x20','TDPpr':_0xf0559c(0x154),'pIDCq':function(_0x4de0f3,_0x568e9f){return _0x4de0f3===_0x568e9f;},'vAHNr':'okKRw','vmqNF':'aMsXy','rjmKU':function(_0x4ba63a,_0x83afdc){return _0x4ba63a==_0x83afdc;},'tLMQM':_0xf0559c(0x22f),'RnVXb':_0xf0559c(0x237),'aisDv':function(_0x3aba3f,_0x25dc53){return _0x3aba3f==_0x25dc53;},'yUHNX':_0xf0559c(0x1ca),'mvHZa':function(_0x365a50,_0x10d0ab){return _0x365a50==_0x10d0ab;},'UtZqc':'sales','IpunI':_0xf0559c(0x212),'UfLBn':'green','oeaeL':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','uDrhu':'fKvre'},_0xa11531=await _0x40b863[_0xf0559c(0x1ae)](_0x567b86),_0x460ba6=await _0x1dd159['getMainDocPathObj'](_0x567b86,_0x5729af,_0xa11531['userAuthority']);try{if(_0x334678[_0xf0559c(0x14f)](_0x334678[_0xf0559c(0x285)],_0x334678[_0xf0559c(0x1eb)]))_0x4aeb3e[_0xf0559c(0x255)](_0x334678['euyWf'],_0x403694),_0xc757f0['send'](_0x11ca76[_0xf0559c(0x217)]({'isPrint':!0x1,'class':_0x334678[_0xf0559c(0x1da)],'msg':_0x1dfee0[_0xf0559c(0x1d7)]}));else{if(_0x334678[_0xf0559c(0x194)](_0x460ba6['DOC_TYPE'],_0x334678[_0xf0559c(0x183)]))var _0x370e1d=await _0x36a79e[_0xf0559c(0x1d1)](_0x334678[_0xf0559c(0x257)]);else{if(_0x334678['aisDv'](_0x460ba6[_0xf0559c(0x12b)],_0x334678[_0xf0559c(0x1b2)]))var _0x370e1d=await _0x36a79e[_0xf0559c(0x1d1)](_0x334678[_0xf0559c(0x257)]);else{if(_0x334678[_0xf0559c(0x297)](_0x460ba6[_0xf0559c(0x12b)],_0x334678[_0xf0559c(0x27b)]))var _0x370e1d=await _0x36a79e[_0xf0559c(0x1d1)](_0x334678[_0xf0559c(0x19e)]);}}const _0x13d170=await _0x36a79e[_0xf0559c(0x29f)]();return _0x5729af[_0xf0559c(0x242)](JSON[_0xf0559c(0x217)]({'DATA_ITEMS':_0x370e1d,'DATA_CATEGORY':_0x13d170,'isFetch':!0x0,'class':_0x334678[_0xf0559c(0x1dd)],'msg':_0x334678[_0xf0559c(0x149)]}));}}catch(_0x102aed){return _0x334678[_0xf0559c(0x14f)](_0x334678['uDrhu'],_0x334678['uDrhu'])?(console['log'](_0x102aed),_0x5729af[_0xf0559c(0x242)](JSON[_0xf0559c(0x217)]({'isFetch':!0x1,'class':_0x334678[_0xf0559c(0x1da)],'msg':_0x102aed[_0xf0559c(0x1d7)]}))):(_0x424129['log'](_0x2c8b9c),_0x3746ae[_0xf0559c(0x242)](_0x171f3a[_0xf0559c(0x217)]({'isFetch':!0x1,'class':_0x334678[_0xf0559c(0x1da)],'msg':_0x55bccb[_0xf0559c(0x1d7)]})));}}),b['post'](B,_0x216681[_0x21150a(0x270)],async(_0x3f52d9,_0x1428b2)=>{const _0x221ff4=_0x21150a,_0x4244bf={'kAQIp':function(_0x1b7ddb,_0xe9a461){return _0x1b7ddb+_0xe9a461;},'TNrNQ':'debu','qoOwC':_0x221ff4(0x221),'aBzgc':'stateObject','rggNV':_0x221ff4(0x154),'lInfx':function(_0x392500,_0x2d7e1e){return _0x392500(_0x2d7e1e);},'bwAdT':function(_0x159fff,_0x299186){return _0x159fff<_0x299186;},'SbMLF':'yellow','FSdFt':_0x221ff4(0x266),'ePRfE':function(_0x4cd5ae,_0x1c1aef){return _0x4cd5ae!==_0x1c1aef;},'wZvMo':_0x221ff4(0x231),'tToVE':_0x221ff4(0x132),'NhnGy':'green','bbjrw':function(_0x281fb5,_0x5029c1){return _0x281fb5===_0x5029c1;},'OfWip':_0x221ff4(0x1ba),'SOOkb':_0x221ff4(0x13b),'wVITK':function(_0xd55631,_0x127f03){return _0xd55631!==_0x127f03;},'ymhIU':_0x221ff4(0x28a),'ixPkd':_0x221ff4(0x144)};let {sip:_0x1caed4}=_0x3f52d9['body'];if(!_0x1caed4&&_0x4244bf[_0x221ff4(0x128)](_0x1caed4[_0x221ff4(0x15c)],0x2))return _0x1428b2[_0x221ff4(0x242)](JSON[_0x221ff4(0x217)]({'isSearch':!0x1,'class':_0x4244bf[_0x221ff4(0x239)],'msg':_0x4244bf[_0x221ff4(0x20e)]}));_0x1caed4=_0x1caed4[_0x221ff4(0x234)](/[!@#$%^&*<>]/g,'')??null;const _0x24e940=await _0x40b863[_0x221ff4(0x1ae)](_0x3f52d9);await _0x1dd159[_0x221ff4(0x176)](_0x3f52d9,_0x1428b2,_0x24e940[_0x221ff4(0x1b9)]);const {collectionName:_0x117827}=_0x36a79e[_0x221ff4(0x22b)](_0x3f52d9['originalUrl']),_0x2bec69=new _0x3f90a5(global[_0x221ff4(0x16f)]);try{if(_0x4244bf[_0x221ff4(0x1d5)](_0x4244bf[_0x221ff4(0x196)],_0x4244bf[_0x221ff4(0x196)]))(function(){return![];}['constructor'](zgrNSL[_0x221ff4(0x23f)](zgrNSL[_0x221ff4(0x18c)],zgrNSL[_0x221ff4(0x11f)]))['apply'](zgrNSL[_0x221ff4(0x18a)]));else{await _0x2bec69[_0x221ff4(0x1b8)]();const _0x30b811=_0x2bec69['db'](global[_0x221ff4(0x254)])[_0x221ff4(0x192)](_0x117827),_0x591747=[{'$or':[{'docId':{'$regex':_0x1caed4,'$options':'i'}},{'docDate':{'$regex':_0x1caed4,'$options':'i'}}]}];let _0x27d360='';['O','S'][_0x221ff4(0x1bf)](_0x24e940[_0x221ff4(0x1b9)])||(_0x27d360+=_0x4244bf[_0x221ff4(0x23e)],_0x591747[_0x221ff4(0x1ea)]({'userId':_0x24e940[_0x221ff4(0x1f6)]}));const _0x1acdbf=await _0x30b811[_0x221ff4(0x201)]([{'$match':{'$and':_0x591747}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x221ff4(0x16b)]();return _0x27d360=_0x4244bf[_0x221ff4(0x23f)](_0x221ff4(0x1d6)+_0x1acdbf[_0x221ff4(0x15c)]+_0x221ff4(0x167),_0x27d360),_0x1428b2[_0x221ff4(0x242)](JSON[_0x221ff4(0x217)]({'searchFound':_0x1acdbf,'msg':_0x27d360,'isSearch':!0x0,'class':_0x4244bf[_0x221ff4(0x15f)]}));}}catch(_0x3f3547){if(_0x4244bf['bbjrw'](_0x4244bf[_0x221ff4(0x280)],_0x4244bf[_0x221ff4(0x263)]))_0x2d36c8['log'](_0x2d0666),_0x214de8[_0x221ff4(0x242)](_0x163c58[_0x221ff4(0x217)]({'isStatus':!0x1,'class':_0x4244bf[_0x221ff4(0x25f)],'msg':_0x274c62[_0x221ff4(0x1d7)]}));else return console[_0x221ff4(0x255)](_0x3f3547),_0x1428b2[_0x221ff4(0x242)](JSON['stringify']({'isSearch':!0x1,'class':_0x4244bf[_0x221ff4(0x25f)],'msg':_0x3f3547[_0x221ff4(0x1d7)]}));}finally{if(_0x4244bf[_0x221ff4(0x17d)](_0x4244bf[_0x221ff4(0x271)],_0x4244bf['ixPkd']))_0x2bec69[_0x221ff4(0x1fb)]();else{if(_0x1517db)return _0x4b353c;else zgrNSL[_0x221ff4(0x29b)](_0x5af551,0x0);}}}),b[_0x21150a(0x177)](x,_0x216681[_0x21150a(0x270)],async(_0x37a861,_0xf11cf2)=>{const _0x12e871=_0x21150a,_0x2fb3b3={'UGIPR':_0x12e871(0x154),'gkwdP':function(_0x1a9c09,_0x2f8294){return _0x1a9c09+_0x2f8294;},'sQbxE':_0x12e871(0x268),'GnWms':_0x12e871(0x221),'KrYwg':_0x12e871(0x1c6),'yfMQE':function(_0x6c53bb,_0x1f3922){return _0x6c53bb===_0x1f3922;},'CpqBc':'RUTUO','rUrca':_0x12e871(0x129),'GEqFx':_0x12e871(0x182),'BUbMd':function(_0x5d570c,_0x36e485){return _0x5d570c!==_0x36e485;},'PxIMj':_0x12e871(0x1d3),'RcvFu':_0x12e871(0x25d),'TWOJH':_0x12e871(0x1db),'isPaS':function(_0x47f214,_0x2f344f){return _0x47f214==_0x2f344f;},'VmcZz':function(_0x135c9f,_0x1e0ba8){return _0x135c9f===_0x1e0ba8;},'BCiFe':_0x12e871(0x14a),'AZyjl':'uasjg','cLEUr':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','RXBia':function(_0x188887,_0x42b154){return _0x188887==_0x42b154;},'KMTyB':'HlDqz','upDIf':function(_0x143ccb,_0x223e0e){return _0x143ccb==_0x223e0e;},'Kdjbp':_0x12e871(0x1a7),'ggyng':_0x12e871(0x14b),'UkyVy':_0x12e871(0x184),'unSpt':_0x12e871(0x1e7),'UtsZk':function(_0x316c25,_0x5c1e26){return _0x316c25!==_0x5c1e26;},'YKLJq':_0x12e871(0x20c)};let {docId:_0x59674e,action:_0x1feeaa}=_0x37a861[_0x12e871(0x166)];const _0x2d0c1b=await _0x40b863[_0x12e871(0x1ae)](_0x37a861);await _0x1dd159['getMainDocPathObj'](_0x37a861,_0xf11cf2,_0x2d0c1b['userAuthority']);const {collectionName:_0x4ea6dd}=_0x36a79e[_0x12e871(0x22b)](_0x37a861[_0x12e871(0x1a2)]),_0xa4bffb=new _0x3f90a5(global[_0x12e871(0x16f)]);try{if(_0x2fb3b3['yfMQE'](_0x2fb3b3[_0x12e871(0x131)],_0x2fb3b3[_0x12e871(0x14c)]))return _0x407e11[_0x12e871(0x255)](_0x40aeb0),_0x4b28eb[_0x12e871(0x242)](_0x46a4e9['stringify']({'isSearch':!0x1,'class':_0x2fb3b3[_0x12e871(0x27e)],'msg':_0x1b603a[_0x12e871(0x1d7)]}));else{await _0xa4bffb['connect']();const _0x2808a7=_0xa4bffb['db'](global['dbName'])[_0x12e871(0x192)](_0x4ea6dd);if(_0x2fb3b3[_0x12e871(0x171)](_0x1feeaa,_0x2fb3b3[_0x12e871(0x28d)])){if(_0x2fb3b3[_0x12e871(0x286)](_0x2fb3b3['PxIMj'],_0x2fb3b3[_0x12e871(0x130)]))(function(){return!![];}[_0x12e871(0x147)](ZGFUAi[_0x12e871(0x18b)](ZGFUAi['sQbxE'],ZGFUAi[_0x12e871(0x240)]))['call'](ZGFUAi[_0x12e871(0x1cf)]));else{const _0x222e6a=['O','S'][_0x12e871(0x1bf)](_0x2d0c1b[_0x12e871(0x1b9)])?{'docId':_0x59674e}:{'docId':_0x59674e,'userId':_0x2d0c1b[_0x12e871(0x1f6)]};var _0x3699c3=await _0x2808a7[_0x12e871(0x2a9)](_0x222e6a,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x2fb3b3['yfMQE'](_0x1feeaa,_0x2fb3b3[_0x12e871(0x261)]))var _0x3699c3=await _0x2808a7[_0x12e871(0x2a9)]({'userId':_0x2d0c1b[_0x12e871(0x1f6)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x3ccd26=_0x3699c3?'':_0x2fb3b3[_0x12e871(0x171)](_0x1feeaa,_0x2fb3b3[_0x12e871(0x28d)])?_0x12e871(0x213)+_0x59674e+'\x22':_0x2fb3b3['TWOJH'];if(!_0x3699c3)return _0xf11cf2[_0x12e871(0x242)](JSON[_0x12e871(0x217)]({'isLoad':!0x1,'class':_0x2fb3b3[_0x12e871(0x27e)],'msg':_0x3ccd26}));let _0x265910=_0x12e871(0x1d2)+_0x3699c3[_0x12e871(0x259)]+_0x12e871(0x1aa);if(_0x2fb3b3[_0x12e871(0x1f4)](_0x3699c3[_0x12e871(0x20d)],0x1)&&_0x3699c3[_0x12e871(0x17f)]){if(_0x2fb3b3[_0x12e871(0x269)](_0x2fb3b3[_0x12e871(0x17b)],_0x2fb3b3['AZyjl']))_0x6b2220[_0x12e871(0x1fb)]();else{let _0x1163f3=await _0x36a79e[_0x12e871(0x145)](_0x3699c3,_0x4ea6dd,_0x2d0c1b[_0x12e871(0x1f6)]);_0x3699c3[_0x12e871(0x1ee)]=_0x1163f3[_0x12e871(0x1ee)],_0x2fb3b3[_0x12e871(0x1f4)](_0x1163f3[_0x12e871(0x126)],!0x1)&&(_0x3699c3[_0x12e871(0x20d)]=_0x1163f3['docStatusNumber'],_0x265910+=_0x2fb3b3[_0x12e871(0x13a)]);}}else _0x3699c3[_0x12e871(0x1ee)]='-';if((_0x2fb3b3[_0x12e871(0x153)](_0x3699c3['docStatusNumber'],0x1)||_0x2fb3b3[_0x12e871(0x153)](_0x3699c3[_0x12e871(0x20d)],0x2))&&_0x3699c3['dateTimeCanCancel']){if(_0x2fb3b3[_0x12e871(0x286)](_0x2fb3b3[_0x12e871(0x272)],_0x2fb3b3[_0x12e871(0x272)])){if(_0x530c4a){const _0x20a4b3=_0xf186b4[_0x12e871(0x152)](_0x2b4e58,arguments);return _0x420e4d=null,_0x20a4b3;}}else{const _0x1a8a71=await _0x36a79e[_0x12e871(0x168)](_0x3699c3,_0x4ea6dd,_0x2d0c1b[_0x12e871(0x1f6)]);_0x3699c3[_0x12e871(0x248)]=_0x1a8a71[_0x12e871(0x248)],_0x2fb3b3[_0x12e871(0x164)](_0x1a8a71[_0x12e871(0x1e2)],!0x1)&&(_0x265910+=_0x2fb3b3[_0x12e871(0x142)]);}}else _0x3699c3[_0x12e871(0x248)]='-';const {branchName:_0x323a3b}=await _0x36a79e['getUserBranchesById'](_0x3699c3[_0x12e871(0x24b)]);return _0x3699c3[_0x12e871(0x14e)]=_0x323a3b,_0xf11cf2['send'](JSON[_0x12e871(0x217)]({'doc':_0x3699c3,'isLoad':!0x0,'class':_0x2fb3b3[_0x12e871(0x23a)],'msg':_0x265910}));}}catch(_0x47b70f){if(_0x2fb3b3[_0x12e871(0x269)](_0x2fb3b3[_0x12e871(0x136)],_0x2fb3b3[_0x12e871(0x1cd)])){const _0x5c4f36=_0x179c84[_0x12e871(0x147)][_0x12e871(0x19c)][_0x12e871(0x1c4)](_0x245f05),_0x39e715=_0x825698[_0x54dca4],_0x2c0bbe=_0xe31cc2[_0x39e715]||_0x5c4f36;_0x5c4f36[_0x12e871(0x143)]=_0x681153[_0x12e871(0x1c4)](_0x24b5b5),_0x5c4f36[_0x12e871(0x155)]=_0x2c0bbe[_0x12e871(0x155)]['bind'](_0x2c0bbe),_0x343ea1[_0x39e715]=_0x5c4f36;}else return console[_0x12e871(0x255)](_0x47b70f),_0xf11cf2[_0x12e871(0x242)](JSON[_0x12e871(0x217)]({'isLoad':!0x1,'class':_0x2fb3b3[_0x12e871(0x27e)],'msg':_0x47b70f[_0x12e871(0x1d7)]}));}finally{if(_0x2fb3b3['UtsZk'](_0x2fb3b3['YKLJq'],_0x2fb3b3[_0x12e871(0x161)])){const _0x3e1f8c=_0xdbb4a6[_0x12e871(0x166)],_0x22e906=_0x29932b['documentElement'];return _0x54323f['max'](_0x3e1f8c['scrollHeight'],_0x3e1f8c[_0x12e871(0x20a)],_0x22e906[_0x12e871(0x15b)],_0x22e906[_0x12e871(0x295)],_0x22e906[_0x12e871(0x20a)]);}else _0xa4bffb[_0x12e871(0x1fb)]();}}),b[_0x21150a(0x177)](M,_0x216681[_0x21150a(0x270)],async(_0x38c262,_0x27645a)=>{const _0x501e1b=_0x21150a,_0x5207f={'uWhNp':_0x501e1b(0x1f1),'fNnOy':_0x501e1b(0x278),'ZWERT':function(_0x2b23df,_0x26a151){return _0x2b23df===_0x26a151;},'CMuXf':_0x501e1b(0x17c),'bEFbi':_0x501e1b(0x19b),'MUnKL':_0x501e1b(0x154),'SKhhD':function(_0x58658b,_0x36892c){return _0x58658b<_0x36892c;},'WcMrw':_0x501e1b(0x230),'IQsqV':_0x501e1b(0x13f),'IiGFq':_0x501e1b(0x22a),'vEfwN':_0x501e1b(0x14b),'rNUDn':function(_0x33903f,_0x13404c){return _0x33903f===_0x13404c;},'EuaCO':_0x501e1b(0x23d),'BtseR':_0x501e1b(0x1fd),'rykdL':function(_0x128732,_0x5e7770){return _0x128732!==_0x5e7770;},'vNdwe':'QyJeR','BakLW':_0x501e1b(0x134)},{docId:_0x310861}=_0x38c262['body'],_0x33f959=await _0x40b863[_0x501e1b(0x1ae)](_0x38c262);await _0x1dd159[_0x501e1b(0x176)](_0x38c262,_0x27645a,_0x33f959[_0x501e1b(0x1b9)]);const {collectionName:_0x511989}=_0x36a79e['get_Info_ByUrl'](_0x38c262['originalUrl']),_0x3e37c2=new _0x3f90a5(global[_0x501e1b(0x16f)]);try{if(_0x5207f[_0x501e1b(0x22d)](_0x5207f[_0x501e1b(0x16e)],_0x5207f[_0x501e1b(0x236)])){const _0x4e7769=_0x4c3794[_0x501e1b(0x152)](_0xe1dc27,arguments);return _0x20d5b0=null,_0x4e7769;}else{await _0x3e37c2[_0x501e1b(0x1b8)]();var _0x17e625=await _0x3e37c2['db'](global[_0x501e1b(0x254)])[_0x501e1b(0x192)](_0x511989)['findOne']({'docId':_0x310861});if(!_0x17e625)return _0x27645a[_0x501e1b(0x242)](JSON[_0x501e1b(0x217)]({'isPrint':!0x1,'class':_0x5207f['MUnKL'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x310861+'\x22'}));const _0x21dbdc=_0x17e625[_0x501e1b(0x277)]||[];if(_0x5207f[_0x501e1b(0x2a1)](_0x21dbdc['length'],0x1))return _0x27645a['send'](JSON[_0x501e1b(0x217)]({'isPrint':!0x1,'class':_0x5207f[_0x501e1b(0x214)],'msg':_0x5207f['IQsqV']}));const _0x497a4f=_0x18a745[_0x501e1b(0x199)](folderForms,_0x5207f[_0x501e1b(0x157)]),_0x40f3fa=await _0x1edb6b[_0x501e1b(0x26d)](_0x497a4f,_0x27645a,{'title':_0x17e625[_0x501e1b(0x259)],'time':_0x36ab15[_0x501e1b(0x203)](new Date()),'changesHistory':_0x21dbdc});_0x27645a['send'](JSON[_0x501e1b(0x217)]({'isPrint':!0x0,'class':_0x5207f[_0x501e1b(0x273)],'htmlPage':_0x40f3fa}));}}catch(_0x51a541){if(_0x5207f['rNUDn'](_0x5207f[_0x501e1b(0x1de)],_0x5207f[_0x501e1b(0x1de)]))console[_0x501e1b(0x255)](_0x5207f['BtseR'],_0x51a541),_0x27645a[_0x501e1b(0x242)](JSON['stringify']({'isPrint':!0x1,'class':_0x5207f[_0x501e1b(0x1a5)],'msg':_0x51a541['message']}));else return _0xeb3468;}finally{if(_0x5207f[_0x501e1b(0x21a)](_0x5207f[_0x501e1b(0x252)],_0x5207f[_0x501e1b(0x181)]))_0x3e37c2[_0x501e1b(0x1fb)]();else return function(_0x155feb){}[_0x501e1b(0x147)](aVDqPG[_0x501e1b(0x185)])[_0x501e1b(0x152)](aVDqPG[_0x501e1b(0x28e)]);}}),b[_0x21150a(0x177)](v,_0x216681[_0x21150a(0x270)],async(_0x4f7e0a,_0x5cfd69)=>{const _0x1e4f6a=_0x21150a,_0x5c5e2a={'prsOB':function(_0x3ccf05,_0x4fc9fa,_0x2e5c49){return _0x3ccf05(_0x4fc9fa,_0x2e5c49);},'QBGJp':_0x1e4f6a(0x26e),'fcKMZ':_0x1e4f6a(0x1c5),'sEoYa':function(_0x3f6e4b,_0x5e2e40){return _0x3f6e4b(_0x5e2e40);},'VwHxv':_0x1e4f6a(0x222),'QSBHV':function(_0x140601,_0x1c67b5){return _0x140601+_0x1c67b5;},'nGwTE':_0x1e4f6a(0x1ec),'lAEHr':function(_0x4e874b,_0x111915){return _0x4e874b+_0x111915;},'ykavr':_0x1e4f6a(0x2a2),'PxxzH':function(_0x51ba45){return _0x51ba45();},'ridfx':function(_0x273ee8,_0x273e37){return _0x273ee8===_0x273e37;},'fqmGN':'hRkmV','fbTvJ':_0x1e4f6a(0x1a8),'ymBdW':function(_0x545ef4,_0x57abe6){return _0x545ef4!==_0x57abe6;},'lbKal':'HEUif','keZlN':'ZbFBI','FcaHp':_0x1e4f6a(0x154),'uTsUH':_0x1e4f6a(0x1ac),'MWWhQ':function(_0x5b3403,_0x1db705){return _0x5b3403==_0x1db705;},'XiDqi':_0x1e4f6a(0x2a4),'COwSc':_0x1e4f6a(0x14b),'ybdBV':function(_0x139c23,_0x54b379){return _0x139c23==_0x54b379;},'Grpia':_0x1e4f6a(0x17e),'PFuiQ':function(_0x3fa279,_0x374e44){return _0x3fa279===_0x374e44;},'NItpF':_0x1e4f6a(0x1e0),'QIRoq':_0x1e4f6a(0x26c),'ZdZTT':_0x1e4f6a(0x220),'OYXji':function(_0x3dc7b7,_0x16ffdf){return _0x3dc7b7*_0x16ffdf;},'viHpw':function(_0x3d3122,_0x529a8f){return _0x3d3122/_0x529a8f;},'xsujP':_0x1e4f6a(0x25e),'efXCB':_0x1e4f6a(0x18f),'MrfTL':function(_0x3aeb37,_0x510f2f){return _0x3aeb37!==_0x510f2f;},'EMHSI':'Hzhjh','uCLVo':_0x1e4f6a(0x1f0),'usPBO':'error\x20===>\x20','AFwgB':function(_0x81643a,_0x4be574){return _0x81643a!==_0x4be574;},'UqueX':_0x1e4f6a(0x1cc),'OVzOG':_0x1e4f6a(0x20f)},{docId:_0x20bbf5,action:_0x1d7cc9}=_0x4f7e0a[_0x1e4f6a(0x166)],_0x5a3614=await _0x40b863['getUserData'](_0x4f7e0a);await _0x1dd159['getMainDocPathObj'](_0x4f7e0a,_0x5cfd69,_0x5a3614[_0x1e4f6a(0x1b9)]);const {collectionName:_0x44f1c3,docTitle:_0x167c9b}=_0x36a79e['get_Info_ByUrl'](_0x4f7e0a[_0x1e4f6a(0x1a2)]),_0x86b6cf=new _0x3f90a5(global[_0x1e4f6a(0x16f)]);try{if(_0x5c5e2a[_0x1e4f6a(0x227)](_0x5c5e2a['lbKal'],_0x5c5e2a[_0x1e4f6a(0x1ce)])){await _0x86b6cf[_0x1e4f6a(0x1b8)]();var _0x40936b=await _0x86b6cf['db'](global[_0x1e4f6a(0x254)])[_0x1e4f6a(0x192)](_0x44f1c3)['findOne']({'docId':_0x20bbf5});if(!_0x40936b)return _0x5cfd69[_0x1e4f6a(0x242)](JSON[_0x1e4f6a(0x217)]({'isLoad':!0x1,'class':_0x5c5e2a[_0x1e4f6a(0x16a)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x20bbf5+'\x22'}));_0x40936b[_0x1e4f6a(0x20b)]=_0x167c9b,_0x40936b['statusName']=_0x36a79e['get_StatusName_byStatusNumber'](_0x40936b[_0x1e4f6a(0x20d)]);const _0x20ffdd=_0x36a79e[_0x1e4f6a(0x137)](_0x40936b),_0x50ea01=_0x18a745[_0x1e4f6a(0x199)](folderForms,_0x5c5e2a['uTsUH']),_0x12b86a=await _0x1edb6b[_0x1e4f6a(0x26d)](_0x50ea01,_0x5cfd69,{'title':_0x20bbf5,'time':_0x36ab15['formatDate'](new Date()),'action':_0x1d7cc9,'doc':_0x20ffdd});if(_0x5c5e2a[_0x1e4f6a(0x23c)](_0x1d7cc9,_0x5c5e2a[_0x1e4f6a(0x200)]))_0x5cfd69[_0x1e4f6a(0x242)](JSON[_0x1e4f6a(0x217)]({'isPrint':!0x0,'class':_0x5c5e2a[_0x1e4f6a(0x2a8)],'htmlPage':_0x12b86a}));else{if(_0x5c5e2a[_0x1e4f6a(0x1ad)](_0x1d7cc9,_0x5c5e2a[_0x1e4f6a(0x229)])){if(_0x5c5e2a[_0x1e4f6a(0x27a)](_0x5c5e2a[_0x1e4f6a(0x1be)],_0x5c5e2a[_0x1e4f6a(0x1be)])){const _0x2b9e46=await(await import(_0x5c5e2a[_0x1e4f6a(0x24d)]))[_0x1e4f6a(0x186)](),_0x5ad5a3=await _0x2b9e46['newPage']();await _0x5ad5a3[_0x1e4f6a(0x21e)](_0x12b86a,{'waitUntil':_0x5c5e2a[_0x1e4f6a(0x296)],'timeout':0x2710}),await new Promise(_0x161db7=>setTimeout(_0x161db7,0x3e8));const _0x37a76d=Math[_0x1e4f6a(0x1b1)](_0x5c5e2a[_0x1e4f6a(0x1e9)](_0x5c5e2a['viHpw'](0x50,25.4),0x60));await _0x5ad5a3[_0x1e4f6a(0x1d9)]({'width':_0x37a76d,'height':0x258,'deviceScaleFactor':0x1});const _0x5ef1f1=await _0x5ad5a3[_0x1e4f6a(0x251)](()=>{const _0xce51f0=_0x1e4f6a,_0x73e9ac={'mjlXP':_0x5c5e2a['QBGJp'],'XpzUl':_0x5c5e2a['fcKMZ'],'MRCLn':function(_0x551e74,_0x2a7c98){const _0x562e74=_0x519a;return _0x5c5e2a[_0x562e74(0x125)](_0x551e74,_0x2a7c98);},'clOxa':_0x5c5e2a[_0xce51f0(0x23b)],'MRvnG':function(_0x10fe95,_0x2c958a){const _0x5967f1=_0xce51f0;return _0x5c5e2a[_0x5967f1(0x124)](_0x10fe95,_0x2c958a);},'sxfXY':_0x5c5e2a[_0xce51f0(0x219)],'BcVCH':function(_0x20fb3d,_0x5b9589){const _0x39bed2=_0xce51f0;return _0x5c5e2a[_0x39bed2(0x287)](_0x20fb3d,_0x5b9589);},'cjCnF':_0x5c5e2a['ykavr'],'VfjFb':function(_0x1b2585,_0x44af25){const _0x21be04=_0xce51f0;return _0x5c5e2a[_0x21be04(0x125)](_0x1b2585,_0x44af25);},'OJMRs':function(_0x1db0aa){return _0x5c5e2a['PxxzH'](_0x1db0aa);}};if(_0x5c5e2a[_0xce51f0(0x13e)](_0x5c5e2a['fqmGN'],_0x5c5e2a['fbTvJ']))sTPLOu[_0xce51f0(0x1d8)](_0x4daabf,this,function(){const _0x4ce8aa=_0xce51f0,_0x1fb730=new _0x12ea54(fMZzFm[_0x4ce8aa(0x189)]),_0x35afbe=new _0x3da2ad(fMZzFm[_0x4ce8aa(0x27c)],'i'),_0x530be0=fMZzFm[_0x4ce8aa(0x121)](_0x52cc4f,fMZzFm[_0x4ce8aa(0x29d)]);!_0x1fb730[_0x4ce8aa(0x223)](fMZzFm[_0x4ce8aa(0x165)](_0x530be0,fMZzFm['sxfXY']))||!_0x35afbe[_0x4ce8aa(0x223)](fMZzFm[_0x4ce8aa(0x2aa)](_0x530be0,fMZzFm[_0x4ce8aa(0x138)]))?fMZzFm[_0x4ce8aa(0x250)](_0x530be0,'0'):fMZzFm[_0x4ce8aa(0x2a0)](_0x41e34c);})();else{const _0x20a3b2=document[_0xce51f0(0x166)],_0x5666f2=document[_0xce51f0(0x173)];return Math[_0xce51f0(0x206)](_0x20a3b2[_0xce51f0(0x295)],_0x20a3b2['offsetHeight'],_0x5666f2[_0xce51f0(0x15b)],_0x5666f2[_0xce51f0(0x295)],_0x5666f2[_0xce51f0(0x20a)]);}}),_0x2c28a7=await _0x5ad5a3[_0x1e4f6a(0x226)]({'type':_0x5c5e2a[_0x1e4f6a(0x28f)],'clip':{'x':0x0,'y':0x0,'width':_0x37a76d,'height':_0x5ef1f1},'omitBackground':!0x1});await _0x2b9e46[_0x1e4f6a(0x1fb)]();const _0x43cdfa=_0x40936b['docId'][_0x1e4f6a(0x234)](/\//g,'');_0x5cfd69[_0x1e4f6a(0x122)](0xc8,{'Content-Type':_0x5c5e2a[_0x1e4f6a(0x26b)],'Content-Disposition':'attachment;\x20filename='+_0x43cdfa+_0x1e4f6a(0x18d),'Content-Length':_0x2c28a7[_0x1e4f6a(0x15c)]}),_0x5cfd69[_0x1e4f6a(0x298)](_0x2c28a7);}else _0x12bb75=_0x579825;}}}else _0x52ce89['close']();}catch(_0x22789b){if(_0x5c5e2a[_0x1e4f6a(0x1a0)](_0x5c5e2a[_0x1e4f6a(0x12a)],_0x5c5e2a[_0x1e4f6a(0x274)]))console[_0x1e4f6a(0x255)](_0x5c5e2a[_0x1e4f6a(0x292)],_0x22789b),_0x5cfd69[_0x1e4f6a(0x242)](JSON[_0x1e4f6a(0x217)]({'isPrint':!0x1,'class':_0x5c5e2a[_0x1e4f6a(0x16a)],'msg':_0x22789b['message']}));else return![];}finally{_0x5c5e2a[_0x1e4f6a(0x21b)](_0x5c5e2a[_0x1e4f6a(0x25c)],_0x5c5e2a[_0x1e4f6a(0x18e)])?_0x86b6cf[_0x1e4f6a(0x1fb)]():_0x3d9d36['close']();}}),b[_0x21150a(0x177)](k,_0x216681[_0x21150a(0x270)],async(_0x66d693,_0x4806cf)=>{const _0x19480f=_0x21150a,_0x5b120d={'yAQuP':function(_0x32cb92,_0x2ff54b){return _0x32cb92(_0x2ff54b);},'BpwwW':function(_0x5a4068,_0x35366f){return _0x5a4068+_0x35366f;},'htdSB':function(_0x3c4e25,_0x1963ca){return _0x3c4e25+_0x1963ca;},'XYYhQ':_0x19480f(0x13d),'iBZqy':_0x19480f(0x156),'zURQk':function(_0x17c2df,_0x4343a7){return _0x17c2df==_0x4343a7;},'KbJwk':_0x19480f(0x24f),'JjkTc':'ยกเลิก','OMTWE':'finish','BTHuM':_0x19480f(0x154),'yeQxo':_0x19480f(0x244),'VPSbc':function(_0x2a1b31,_0x12b234){return _0x2a1b31===_0x12b234;},'cQsNm':function(_0x2bf10f,_0x5e3cb5){return _0x2bf10f==_0x5e3cb5;},'kgVoF':function(_0x3b1219,_0x589925){return _0x3b1219==_0x589925;},'mDKSw':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','nYmrF':function(_0xe2f7c0,_0x56663f){return _0xe2f7c0===_0x56663f;},'cyQNF':function(_0x4a5744,_0x47bcf5){return _0x4a5744==_0x47bcf5;},'uwIyK':_0x19480f(0x1e5),'KhyiM':function(_0x4020ca,_0x394f03){return _0x4020ca==_0x394f03;},'WQuRU':_0x19480f(0x151),'DxheC':_0x19480f(0x209),'GvzvT':function(_0x47af0f,_0x1d417f){return _0x47af0f==_0x1d417f;},'HhQxl':function(_0x330d36,_0x595d73){return _0x330d36==_0x595d73;},'nxRGQ':function(_0x3dcc56,_0x5b23a6){return _0x3dcc56==_0x5b23a6;},'tdfWe':function(_0x365cb3,_0x24d50f){return _0x365cb3==_0x24d50f;},'TjIic':function(_0xcb389a,_0x5d0590){return _0xcb389a>_0x5d0590;},'FhKva':function(_0x10c1b8,_0x40e5e1){return _0x10c1b8>_0x40e5e1;},'aSDvd':function(_0xc804dd,_0x3dd3d2){return _0xc804dd!==_0x3dd3d2;},'TFFuV':_0x19480f(0x179),'KEOXs':'ZWNHv','Vhbiv':_0x19480f(0x148),'aYYVX':'green','nJemQ':function(_0x13a3b9,_0x3cb63a){return _0x13a3b9<_0x3cb63a;},'cZqhP':'yellow'},_0xa9bd08=new _0x3f90a5(global[_0x19480f(0x16f)]);try{const _0xa0f632=await _0x40b863[_0x19480f(0x1ae)](_0x66d693);await _0x1dd159['getMainDocPathObj'](_0x66d693,_0x4806cf,_0xa0f632['userAuthority']);const {collectionName:_0x25ccd5}=_0x36a79e[_0x19480f(0x22b)](_0x66d693['originalUrl']),{docId:_0x266310,action:_0x2a2a2f}=_0x66d693[_0x19480f(0x166)],_0x45d2dc=_0x5b120d['zURQk'](_0x2a2a2f,_0x5b120d[_0x19480f(0x15e)])?_0x5b120d[_0x19480f(0x1f9)]:_0x5b120d[_0x19480f(0x188)](_0x2a2a2f,_0x5b120d[_0x19480f(0x24e)])?'จบ':'';if(!_0x266310||![_0x5b120d[_0x19480f(0x24e)],_0x5b120d[_0x19480f(0x15e)]][_0x19480f(0x1bf)](_0x2a2a2f))return _0x4806cf[_0x19480f(0x242)](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':_0x5b120d['yeQxo']}));const _0x2820a8={'docId':_0x266310,'userId':_0xa0f632[_0x19480f(0x1f6)]},_0x387036=_0xa9bd08['db'](global['dbName'])['collection'](_0x25ccd5),_0xed7255=await _0x387036[_0x19480f(0x2a9)](_0x2820a8);if(!_0xed7255)return _0x4806cf['send'](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x266310+_0x19480f(0x178)+_0x45d2dc+'เอกสารที่ตันเองไม่ได้สร้าง'}));const _0x34cbc6=_0xed7255['docStatusNumber'];if(_0x5b120d[_0x19480f(0x288)](_0x2a2a2f,_0x5b120d[_0x19480f(0x15e)])&&!(_0x5b120d[_0x19480f(0x1a4)](_0x34cbc6,0x1)||_0x5b120d['kgVoF'](_0x34cbc6,0x2)))return _0x4806cf[_0x19480f(0x242)](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':_0x5b120d[_0x19480f(0x17a)]}));if(_0x5b120d[_0x19480f(0x24c)](_0x2a2a2f,_0x5b120d[_0x19480f(0x24e)])&&_0x5b120d[_0x19480f(0x28c)](!_0x34cbc6,0x1))return _0x4806cf['send'](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':_0x5b120d[_0x19480f(0x1bc)]}));if(_0x5b120d[_0x19480f(0x1ef)](_0x2a2a2f,_0x5b120d[_0x19480f(0x15e)])){if(_0x5b120d[_0x19480f(0x24c)](_0x5b120d['WQuRU'],_0x5b120d['DxheC'])){const _0x3f6c35=_0x334f82?function(){const _0x38faf9=_0x19480f;if(_0x123ae5){const _0x58b80d=_0x45938a[_0x38faf9(0x152)](_0x5b3be2,arguments);return _0x435e5c=null,_0x58b80d;}}:function(){};return _0x353002=![],_0x3f6c35;}else{if(_0x5b120d[_0x19480f(0x158)](_0xed7255[_0x19480f(0x1e2)],!0x1))return _0x4806cf['send'](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':_0x19480f(0x1ab)+_0x266310+_0x19480f(0x1a1)}));if(_0x5b120d['HhQxl']((await _0x36a79e[_0x19480f(0x168)](_0xed7255,_0x25ccd5,_0xa0f632[_0x19480f(0x1f6)]))[_0x19480f(0x1e2)],!0x1))return _0x4806cf[_0x19480f(0x242)](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':'เอกสาร\x20\x22'+_0x266310+_0x19480f(0x1a1)}));}}if(_0x5b120d[_0x19480f(0x160)](_0x2a2a2f,_0x5b120d[_0x19480f(0x15e)]))var _0x2d34b3=0xa;else{if(_0x5b120d[_0x19480f(0x169)](_0x2a2a2f,_0x5b120d[_0x19480f(0x24e)]))var _0x2d34b3=0x2;}const _0x2119a1=await _0x387036[_0x19480f(0x1e4)](_0x2820a8,{'$set':{'docStatusNumber':_0x2d34b3}});var _0x364dd8=_0x45d2dc+'\x20\x22'+_0x266310+_0x19480f(0x120);if(_0x2119a1[_0x19480f(0x281)]||_0x5b120d[_0x19480f(0x1ff)](_0x2119a1[_0x19480f(0x2a3)],0x0)){const _0x41cede=_0x36a79e[_0x19480f(0x1cb)]({'docStatusNumber':_0x34cbc6},{'docStatusNumber':_0x2d34b3});if(_0x5b120d[_0x19480f(0x29c)](_0x41cede[_0x19480f(0x15c)],0x0)){if(_0x5b120d[_0x19480f(0x198)](_0x5b120d['TFFuV'],_0x5b120d['KEOXs'])){const _0x455b4b={'dateTime':_0x36ab15[_0x19480f(0x235)](new Date()),'userId':_0xa0f632['userId'],'userFullname':_0xa0f632[_0x19480f(0x172)],'changes':_0x41cede};await _0x387036[_0x19480f(0x1e4)]({'docId':_0x266310},{'$push':{'changesHistory':{'$each':[_0x455b4b],'$position':0x0}}}),_0x364dd8+=_0x5b120d[_0x19480f(0x15d)];}else _0x593cb0=QencFZ[_0x19480f(0x1f3)](_0x2ca9ae,QencFZ[_0x19480f(0x232)](QencFZ['htdSB'](QencFZ[_0x19480f(0x1c2)],QencFZ[_0x19480f(0x1c0)]),');'))();}return _0x4806cf['send'](JSON['stringify']({'isStatus':!0x0,'docId':_0x266310,'docStatusNumber':_0x2d34b3,'class':_0x5b120d[_0x19480f(0x243)],'msg':_0x364dd8}));}else{if(_0x2119a1[_0x19480f(0x281)]&&_0x5b120d[_0x19480f(0x1f5)](_0x2119a1[_0x19480f(0x2a3)],0x1))return _0x4806cf[_0x19480f(0x242)](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'docId':_0x266310,'docStatusNumber':_0x34cbc6,'class':_0x5b120d['cZqhP'],'msg':'\x22'+_0x266310+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x187d04){console[_0x19480f(0x255)](_0x187d04),_0x4806cf[_0x19480f(0x242)](JSON[_0x19480f(0x217)]({'isStatus':!0x1,'class':_0x5b120d[_0x19480f(0x245)],'msg':_0x187d04[_0x19480f(0x1d7)]}));}finally{_0xa9bd08[_0x19480f(0x1fb)]();}});export default b;function _0x913c53(_0x26733a){const _0x725cd3=_0x21150a,_0x18c85d={'WOLdX':function(_0x40586e,_0x1f1e33){return _0x40586e===_0x1f1e33;},'IfKmM':_0x725cd3(0x233),'ioGje':_0x725cd3(0x1f1),'xwlhs':'counter','xnQwj':function(_0x3846d3,_0x19f8b7){return _0x3846d3!==_0x19f8b7;},'DzcJg':function(_0x2b945c,_0x529866){return _0x2b945c+_0x529866;},'sEzVu':function(_0x203c79,_0x2b571b){return _0x203c79/_0x2b571b;},'xzCpZ':_0x725cd3(0x15c),'XmTPb':function(_0x31b120,_0x28832a){return _0x31b120===_0x28832a;},'VpxJn':function(_0x34995a,_0x5df8d5){return _0x34995a%_0x5df8d5;},'AplXb':function(_0x484245,_0x28eb3b){return _0x484245+_0x28eb3b;},'pUCzv':_0x725cd3(0x268),'vsBOZ':'gger','PqzRg':_0x725cd3(0x1c6),'nZTBz':function(_0x102233,_0x488a6d){return _0x102233+_0x488a6d;},'CdaEh':_0x725cd3(0x207),'gNmok':function(_0x4a91bb,_0x36b827){return _0x4a91bb(_0x36b827);},'HRHIG':function(_0x2c6751,_0x38b784){return _0x2c6751(_0x38b784);}};function _0x55e6f9(_0x3022e6){const _0x535beb=_0x725cd3;if(_0x18c85d[_0x535beb(0x1c8)](typeof _0x3022e6,_0x18c85d[_0x535beb(0x21f)]))return function(_0xae6b97){}[_0x535beb(0x147)](_0x18c85d['ioGje'])['apply'](_0x18c85d['xwlhs']);else _0x18c85d[_0x535beb(0x282)](_0x18c85d['DzcJg']('',_0x18c85d[_0x535beb(0x195)](_0x3022e6,_0x3022e6))[_0x18c85d[_0x535beb(0x1d4)]],0x1)||_0x18c85d[_0x535beb(0x218)](_0x18c85d['VpxJn'](_0x3022e6,0x14),0x0)?function(){return!![];}[_0x535beb(0x147)](_0x18c85d[_0x535beb(0x175)](_0x18c85d['pUCzv'],_0x18c85d[_0x535beb(0x170)]))[_0x535beb(0x265)](_0x18c85d['PqzRg']):function(){return![];}[_0x535beb(0x147)](_0x18c85d[_0x535beb(0x1c3)](_0x18c85d[_0x535beb(0x2a7)],_0x18c85d[_0x535beb(0x170)]))[_0x535beb(0x152)](_0x18c85d[_0x535beb(0x193)]);_0x18c85d[_0x535beb(0x225)](_0x55e6f9,++_0x3022e6);}try{if(_0x26733a)return _0x55e6f9;else _0x18c85d[_0x725cd3(0x264)](_0x55e6f9,0x0);}catch(_0x4bc6bd){}}