const _0x2d1a10=_0x3e05;(function(_0x395db7,_0x55a95f){const _0x4999ae=_0x3e05,_0x1c9bc8=_0x395db7();while(!![]){try{const _0x1b5ec3=-parseInt(_0x4999ae(0x22a))/0x1+-parseInt(_0x4999ae(0x241))/0x2*(parseInt(_0x4999ae(0x108))/0x3)+parseInt(_0x4999ae(0x127))/0x4*(-parseInt(_0x4999ae(0x144))/0x5)+-parseInt(_0x4999ae(0x10f))/0x6+-parseInt(_0x4999ae(0x21c))/0x7*(parseInt(_0x4999ae(0x209))/0x8)+parseInt(_0x4999ae(0x1fb))/0x9+parseInt(_0x4999ae(0x177))/0xa*(parseInt(_0x4999ae(0x153))/0xb);if(_0x1b5ec3===_0x55a95f)break;else _0x1c9bc8['push'](_0x1c9bc8['shift']());}catch(_0x523e6e){_0x1c9bc8['push'](_0x1c9bc8['shift']());}}}(_0x1729,0x19f23));const _0x3ac0cb=(function(){const _0xa56268=_0x3e05,_0x24cc28={'IUqiL':function(_0x3b04e2,_0x29959a){return _0x3b04e2+_0x29959a;},'rHLcd':_0xa56268(0x13e),'bDCIH':_0xa56268(0x20e),'dIvwz':_0xa56268(0x14f),'LwgqM':_0xa56268(0x26d),'bTTWW':function(_0x7492cd,_0x374d2b){return _0x7492cd!==_0x374d2b;},'vSNCW':_0xa56268(0x152),'hwcoX':function(_0xed8b8d,_0x312f76){return _0xed8b8d===_0x312f76;},'xBcQs':_0xa56268(0x14b),'OHXCL':'GknFg','TfHTJ':_0xa56268(0x1eb)};let _0x23a399=!![];return function(_0x533c86,_0x2decd7){const _0x22f5df=_0xa56268,_0x48fe15={'dBOZI':function(_0x38dbed,_0x68fe70){const _0x3bb672=_0x3e05;return _0x24cc28[_0x3bb672(0x19e)](_0x38dbed,_0x68fe70);},'aXRoj':_0x24cc28[_0x22f5df(0x138)],'frAEY':_0x24cc28[_0x22f5df(0x137)],'CliOU':_0x24cc28[_0x22f5df(0x1d1)],'FyDtQ':_0x24cc28[_0x22f5df(0x1cd)],'NBwSJ':function(_0x45a9ed,_0x10471b){const _0x3e8208=_0x22f5df;return _0x24cc28[_0x3e8208(0x201)](_0x45a9ed,_0x10471b);},'xEhmV':_0x24cc28[_0x22f5df(0x265)],'iKDGr':function(_0x12f83c,_0x5468aa){const _0x11d1b0=_0x22f5df;return _0x24cc28[_0x11d1b0(0x12f)](_0x12f83c,_0x5468aa);},'kyntV':_0x24cc28['xBcQs'],'pHOFG':_0x24cc28[_0x22f5df(0x211)]};if(_0x24cc28[_0x22f5df(0x201)](_0x24cc28[_0x22f5df(0x1a1)],_0x24cc28[_0x22f5df(0x1a1)]))_0x3e6af7=_0x103cda;else{const _0x5b7fe1=_0x23a399?function(){const _0x10526f=_0x22f5df,_0x331640={'hcNea':function(_0x3aa49c,_0x57abb7){const _0x1e4e3e=_0x3e05;return _0x48fe15[_0x1e4e3e(0x242)](_0x3aa49c,_0x57abb7);},'LDMTz':_0x48fe15[_0x10526f(0x146)],'FJyfZ':_0x48fe15[_0x10526f(0x21d)],'sPUXT':_0x48fe15[_0x10526f(0x1ed)],'QULyP':_0x48fe15[_0x10526f(0x253)]};if(_0x48fe15[_0x10526f(0x149)](_0x48fe15[_0x10526f(0x105)],_0x48fe15[_0x10526f(0x105)]))(function(){return!![];}[_0x10526f(0x26c)](_0x331640[_0x10526f(0x223)](_0x331640[_0x10526f(0x11d)],_0x331640[_0x10526f(0x10a)]))[_0x10526f(0x228)](_0x331640[_0x10526f(0x24f)]));else{if(_0x2decd7){if(_0x48fe15[_0x10526f(0x246)](_0x48fe15[_0x10526f(0x123)],_0x48fe15['pHOFG']))return _0x1377ff['log'](_0x56af64),_0x4da257[_0x10526f(0x165)](_0xc97410['stringify']({'isLoad':!0x1,'class':_0x331640[_0x10526f(0x20a)],'msg':_0x550663[_0x10526f(0x16a)]}));else{const _0x34fc9e=_0x2decd7[_0x10526f(0x11a)](_0x533c86,arguments);return _0x2decd7=null,_0x34fc9e;}}}}:function(){};return _0x23a399=![],_0x5b7fe1;}};}());(function(){const _0xc36091=_0x3e05,_0x196dd6={'KRSiY':function(_0x360c3d,_0x399f3e){return _0x360c3d(_0x399f3e);},'RIaHE':function(_0x504510,_0xc447f3){return _0x504510+_0xc447f3;},'LKOmw':function(_0x1e02ab,_0x5128d3){return _0x1e02ab+_0x5128d3;},'Vurvw':'return\x20(function()\x20','iqfIa':_0xc36091(0x1e6),'BOBOW':function(_0x13c25d,_0x484dc0){return _0x13c25d!==_0x484dc0;},'cnbUr':'YIaOK','yTvVC':_0xc36091(0x1ea),'aLngL':_0xc36091(0x220),'vSKrC':'init','eqOOe':function(_0x190a5a,_0x4366ad){return _0x190a5a+_0x4366ad;},'QtSII':_0xc36091(0x143),'ShidE':_0xc36091(0x15c),'RusNZ':function(_0x3b9f6b,_0x2a4871){return _0x3b9f6b===_0x2a4871;},'TVQYP':_0xc36091(0x252),'JpXGQ':_0xc36091(0x244),'vBHat':_0xc36091(0x217),'ZBFvX':_0xc36091(0x15f),'ijFNc':function(_0x519b76){return _0x519b76();},'MumEM':function(_0x16e6b4,_0x1ef880,_0x1b0c42){return _0x16e6b4(_0x1ef880,_0x1b0c42);}};_0x196dd6['MumEM'](_0x3ac0cb,this,function(){const _0x2ae809=_0xc36091;if(_0x196dd6[_0x2ae809(0x162)](_0x196dd6[_0x2ae809(0x202)],_0x196dd6['cnbUr']))_0x562347=_0x196dd6[_0x2ae809(0x194)](_0x3dd017,_0x196dd6['RIaHE'](_0x196dd6['LKOmw'](_0x196dd6['Vurvw'],_0x196dd6[_0x2ae809(0x140)]),');'))();else{const _0x4bb9ab=new RegExp(_0x196dd6[_0x2ae809(0x182)]),_0x476bf5=new RegExp(_0x196dd6[_0x2ae809(0x258)],'i'),_0x2e9760=_0x196dd6['KRSiY'](_0x5a2a29,_0x196dd6[_0x2ae809(0x26e)]);if(!_0x4bb9ab[_0x2ae809(0x1fd)](_0x196dd6['eqOOe'](_0x2e9760,_0x196dd6['QtSII']))||!_0x476bf5[_0x2ae809(0x1fd)](_0x196dd6['eqOOe'](_0x2e9760,_0x196dd6[_0x2ae809(0x24c)]))){if(_0x196dd6[_0x2ae809(0x260)](_0x196dd6[_0x2ae809(0x1d3)],_0x196dd6[_0x2ae809(0x231)]))return![];else _0x196dd6['KRSiY'](_0x2e9760,'0');}else _0x196dd6[_0x2ae809(0x260)](_0x196dd6[_0x2ae809(0x16c)],_0x196dd6[_0x2ae809(0x23d)])?_0x251a0f['close']():_0x196dd6['ijFNc'](_0x5a2a29);}})();}());const _0x37f370=(function(){const _0x46fae2=_0x3e05,_0x1cc98a={'NJyAy':function(_0x95e3fb,_0x59ca33){return _0x95e3fb!==_0x59ca33;},'XTGfy':'QTONY','HYnIj':function(_0x474f61,_0x4bac3e){return _0x474f61===_0x4bac3e;},'MKKIG':_0x46fae2(0x189),'brMLZ':_0x46fae2(0x24a),'BoXtz':_0x46fae2(0x184),'oPqNA':_0x46fae2(0x26d),'aDUFD':function(_0x496ad5,_0x8d40ce){return _0x496ad5+_0x8d40ce;},'syTtD':'debu','ESkrD':_0x46fae2(0x20e),'qakzp':'stateObject','NBqOH':_0x46fae2(0x1de)};let _0x1a89ed=!![];return function(_0x46d4b0,_0x53146b){const _0x1be4e6=_0x46fae2,_0x3d94ea={'iXyJq':function(_0x32fa58,_0x4678ec){const _0x3d8a49=_0x3e05;return _0x1cc98a[_0x3d8a49(0x19f)](_0x32fa58,_0x4678ec);},'AzlnI':_0x1cc98a[_0x1be4e6(0x1b4)],'QTiZi':_0x1cc98a[_0x1be4e6(0x1b7)],'pQHOO':_0x1cc98a[_0x1be4e6(0x170)]};if(_0x1cc98a['HYnIj'](_0x1cc98a[_0x1be4e6(0x139)],_0x1cc98a[_0x1be4e6(0x139)])){const _0x1f1506=_0x1a89ed?function(){const _0x5665fb=_0x1be4e6;if(_0x1cc98a[_0x5665fb(0x166)](_0x1cc98a[_0x5665fb(0x1f5)],_0x1cc98a[_0x5665fb(0x1f5)]))(function(){return![];}[_0x5665fb(0x26c)](_0x3d94ea[_0x5665fb(0x1bb)](_0x3d94ea['AzlnI'],_0x3d94ea['QTiZi']))[_0x5665fb(0x11a)](_0x3d94ea[_0x5665fb(0x269)]));else{if(_0x53146b){if(_0x1cc98a[_0x5665fb(0x173)](_0x1cc98a['MKKIG'],_0x1cc98a[_0x5665fb(0x21a)])){if(_0x454ef5){const _0x561bf3=_0x26cb14[_0x5665fb(0x11a)](_0x1e9aaa,arguments);return _0x15b73f=null,_0x561bf3;}}else{const _0x1f0d82=_0x53146b[_0x5665fb(0x11a)](_0x46d4b0,arguments);return _0x53146b=null,_0x1f0d82;}}}}:function(){};return _0x1a89ed=![],_0x1f1506;}else _0x160da5[_0x1be4e6(0x1bf)](_0x1cc98a[_0x1be4e6(0x203)],_0x26c889),_0x29bbe0[_0x1be4e6(0x165)](_0x2199e1[_0x1be4e6(0x126)]({'isPrint':!0x1,'class':_0x1cc98a[_0x1be4e6(0x26a)],'msg':_0x3393e5[_0x1be4e6(0x16a)]}));};}()),_0x1cfa3d=_0x37f370(this,function(){const _0x57cd37=_0x3e05,_0xcd9f16={'mxuOx':function(_0x48265d,_0x28fd4d){return _0x48265d(_0x28fd4d);},'ziGaN':_0x57cd37(0x26d),'UsLxJ':function(_0x385952,_0x3828c8){return _0x385952!==_0x3828c8;},'bNFuw':_0x57cd37(0x212),'aMGeC':function(_0x4d67db,_0x47169c){return _0x4d67db!==_0x47169c;},'gBYpF':'wWffg','DXpWL':function(_0x192348,_0x39e295){return _0x192348+_0x39e295;},'uwcsI':'return\x20(function()\x20','EiWDu':_0x57cd37(0x1e6),'xoAiV':_0x57cd37(0x230),'cnKVq':_0x57cd37(0x1ea),'LCgjc':_0x57cd37(0x220),'hIIny':'init','IqSES':_0x57cd37(0x143),'glekJ':_0x57cd37(0x15c),'pakJO':function(_0x330a23){return _0x330a23();},'eFPBg':function(_0x55f916,_0x33c41f,_0x2ce74f){return _0x55f916(_0x33c41f,_0x2ce74f);},'aOIHm':function(_0xf485d8){return _0xf485d8();},'XCgiM':_0x57cd37(0x1bf),'yDkmD':_0x57cd37(0x215),'pckVh':'info','rxWhL':_0x57cd37(0x112),'YgymH':_0x57cd37(0x1d0),'ODBSa':'table','dKhhs':_0x57cd37(0x15a),'hDncC':function(_0x539871,_0x405da2){return _0x539871<_0x405da2;},'gUcPi':function(_0x4cf585,_0x4afeae){return _0x4cf585!==_0x4afeae;},'NXLwx':_0x57cd37(0x20b)},_0x36d4e8=function(){const _0x1b9ccc=_0x57cd37;if(_0xcd9f16['UsLxJ'](_0xcd9f16[_0x1b9ccc(0x1d8)],_0xcd9f16[_0x1b9ccc(0x1d8)]))_0xcd9f16[_0x1b9ccc(0x236)](_0x15373f,0x0);else{let _0x26d301;try{if(_0xcd9f16['aMGeC'](_0xcd9f16[_0x1b9ccc(0x195)],_0xcd9f16[_0x1b9ccc(0x195)])){const _0x4a0af4=_0x2a3b62?function(){const _0x1b0005=_0x1b9ccc;if(_0x34ebc6){const _0x3417bb=_0x548907[_0x1b0005(0x11a)](_0x3539f4,arguments);return _0x3d8499=null,_0x3417bb;}}:function(){};return _0x153e89=![],_0x4a0af4;}else _0x26d301=_0xcd9f16['mxuOx'](Function,_0xcd9f16['DXpWL'](_0xcd9f16[_0x1b9ccc(0x129)](_0xcd9f16[_0x1b9ccc(0x1c8)],_0xcd9f16[_0x1b9ccc(0x13a)]),');'))();}catch(_0x1d4e13){if(_0xcd9f16[_0x1b9ccc(0x237)](_0xcd9f16[_0x1b9ccc(0x1ba)],_0xcd9f16[_0x1b9ccc(0x1ba)]))return _0xb65463[_0x1b9ccc(0x1bf)](_0x1d50af),_0x168c13[_0x1b9ccc(0x165)](_0x490514[_0x1b9ccc(0x126)]({'isFetch':!0x1,'class':_0xcd9f16[_0x1b9ccc(0x1c0)],'msg':_0x1d8f6b[_0x1b9ccc(0x16a)]}));else _0x26d301=window;}return _0x26d301;}},_0x3b5c11=_0xcd9f16[_0x57cd37(0x21e)](_0x36d4e8),_0x26bbe9=_0x3b5c11[_0x57cd37(0x17e)]=_0x3b5c11[_0x57cd37(0x17e)]||{},_0x3c52b9=[_0xcd9f16[_0x57cd37(0x154)],_0xcd9f16[_0x57cd37(0x279)],_0xcd9f16[_0x57cd37(0x1d2)],_0xcd9f16[_0x57cd37(0x248)],_0xcd9f16[_0x57cd37(0x21b)],_0xcd9f16[_0x57cd37(0x1cf)],_0xcd9f16['dKhhs']];for(let _0x5b8435=0x0;_0xcd9f16['hDncC'](_0x5b8435,_0x3c52b9['length']);_0x5b8435++){if(_0xcd9f16['gUcPi'](_0xcd9f16['NXLwx'],_0xcd9f16[_0x57cd37(0x23e)])){const _0x4f799e={'LYLWc':_0xcd9f16['cnKVq'],'xpBfh':_0xcd9f16[_0x57cd37(0x197)],'LtJWN':function(_0x47d375,_0x3f59d9){const _0x38716e=_0x57cd37;return _0xcd9f16[_0x38716e(0x236)](_0x47d375,_0x3f59d9);},'ezSNX':_0xcd9f16[_0x57cd37(0x1df)],'GXEya':function(_0x3d9b1e,_0x2290bc){const _0x26cd9c=_0x57cd37;return _0xcd9f16[_0x26cd9c(0x129)](_0x3d9b1e,_0x2290bc);},'clONV':_0xcd9f16[_0x57cd37(0x1b9)],'ZBHFU':_0xcd9f16[_0x57cd37(0x122)],'koHVk':function(_0x26b0fb){return _0xcd9f16['pakJO'](_0x26b0fb);}};_0xcd9f16['eFPBg'](_0xa073bd,this,function(){const _0x1f3663=_0x57cd37,_0xdc0957=new _0x7d4dbf(_0x4f799e[_0x1f3663(0x18b)]),_0x3bade5=new _0x4e1e2b(_0x4f799e[_0x1f3663(0x18d)],'i'),_0x441ace=_0x4f799e[_0x1f3663(0x157)](_0x46f0ae,_0x4f799e[_0x1f3663(0x225)]);!_0xdc0957[_0x1f3663(0x1fd)](_0x4f799e['GXEya'](_0x441ace,_0x4f799e['clONV']))||!_0x3bade5[_0x1f3663(0x1fd)](_0x4f799e[_0x1f3663(0x245)](_0x441ace,_0x4f799e[_0x1f3663(0x121)]))?_0x4f799e['LtJWN'](_0x441ace,'0'):_0x4f799e[_0x1f3663(0x10d)](_0x499323);})();}else{const _0x463b17=_0x37f370[_0x57cd37(0x26c)][_0x57cd37(0x12b)][_0x57cd37(0x190)](_0x37f370),_0xe0cfca=_0x3c52b9[_0x5b8435],_0x521966=_0x26bbe9[_0xe0cfca]||_0x463b17;_0x463b17['__proto__']=_0x37f370[_0x57cd37(0x190)](_0x37f370),_0x463b17[_0x57cd37(0x117)]=_0x521966[_0x57cd37(0x117)]['bind'](_0x521966),_0x26bbe9[_0xe0cfca]=_0x463b17;}}});function _0x1729(){const _0x2ce7d3=['post','warn','WSoKv','ToxFb','stock','matchedCount','brMLZ','YgymH','118195izfNyJ','frAEY','aOIHm','collection','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','mnMQd','sTRzR','hcNea','XbQgf','ezSNX','CLiTe','dateTimeCanCancel','call','JslBx','139449uLQMyK','get_Info_ByUrl','ULSBe','offsetHeight','zZBtP','branchId','jNEdy','JpXGQ','eShtA','close','isAuth','getChangeHistory','mxuOx','aMGeC','networkidle0','DnLWb','jzvSt','{{sep}}หรือไม่มีสิทธิ์','formatDate','ZBFvX','NXLwx','indOM','docStatusNumber','2gPnjlo','dBOZI','enQsG','feztT','GXEya','iKDGr','userAuthority','rxWhL','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','cFGIZ','dateTimeEditRemain','ShidE','nmhCD','clientHeight','sPUXT','QWqiM','CybIG','rmqex','FyDtQ','NIXFS','JzfRI','rcXuv','aXqLu','aLngL','modifiedCount','\x22\x20เอกสาร','aBeUM','newPage','doc_print.ejs','statusName','join','RusNZ','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','ZzxZo','IBzTW','Yqefw','vSNCW','PWDlg','\x22\x20เรียบร้อยแล้ว','green','pQHOO','oPqNA','floor','constructor','red','vSKrC','aKpoe','documentElement','domOH','TTgeN','fwAJy','PATH_WAREHOUSE_IN','LHeGg','connect','โหลดเอกสารเลขที่\x20\x22','branchName','yDkmD','ZQcUx','cIZkp','warehouseIn','xEhmV','UMcrw','ไม่พบเอกสารล่าสุด','435462cJvvDp','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','FJyfZ','NGwsN','aggregate','koHVk','/status','785640oTrvjs','body','stateObject','error','CHaUF','fVlww','CfBAK','hgseI','toString','ไม่พบเอกสารเลขที่\x20\x22','GatXY','apply','wpCJB','dYaDP','LDMTz','kkuZo','dateTimeCanEdit','counter','ZBHFU','glekJ','kyntV','HhPJp','aGWPi','stringify','547564FGevpt','bwEfY','DXpWL','fcZhn','prototype','print','replace','RjgcY','hwcoX','HqKey','HTKWZ','mGuzo','changesHistory','originalUrl','ULBIC','finish','bDCIH','rHLcd','NBqOH','EiWDu','/load-last','AAjSL','Router','debu','canCancel','iqfIa','RaXil','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','chain','5RSdGNW','GCWFv','aXRoj','VCnkv','RhGUh','NBwSJ','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','VMkcS','bVWgU','dZLZK','/fetch/modal','action','Hkbqv','CUIIF','NuzOx','1441781xTOdCC','XCgiM','pYbpT','เอกสาร\x20\x22','LtJWN','push','FRtJH','trace','pGwBl','input','VwfYG','oKEHh','DWJEb','uxmXZ','ZmBVh','BOBOW','check_DocDateTime_CanCancel','doc_changes.ejs','send','NJyAy','csvPD','FcjJB','ovvki','message','convert_DocPrint','vBHat','eQgiz','XdOXm','DZEzr','qakzp','ไม่พบเอกสาร\x20\x22','SAjez','HYnIj','max','xxbGE','xAztF','50sZrmPs','BsIiw','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','RJgfN','VLGau','VJjEq','getItemsCategory','console','TWEwT','BXjru','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','yTvVC','docId','error\x20===>\x20','mYDaB','/changes','BLlZn','formatDateTime','xOgrf','jnkeU','LYLWc','xRHRf','xpBfh','init','jPxGm','bind','BeTRz','sPuSq','/search','KRSiY','gBYpF','bjaIh','LCgjc','cHSZx','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','\x22\x20{{sep}}เรียบร้อยแล้ว','vckYA','sales','VBzRz','IUqiL','aDUFD','__proto__','TfHTJ','writeHead','RrekR','get_StatusName_byStatusNumber','dbName','wZdyU','FfVzA','pSvlt','.jpeg','load-last','wXpqu','pAHKZ','kzsbs','userFullname','scrollHeight','NErAH','Jhbel','DAGgF','เอกสารที่ตันเองไม่ได้สร้าง','syTtD','getUserData','BXmFy','ESkrD','findOne','IqSES','xoAiV','iXyJq','load','tZVLG','lMIYC','log','ziGaN','qnEDo','LKuxD','ylIFv','BcqhV','while\x20(true)\x20{}','PDywc','Djgtf','uwcsI','docTitle','wxPeb','ZeAFn','YPjQe','LwgqM','SZpfW','ODBSa','exception','dIvwz','pckVh','TVQYP','FjDPx','tRcqZ','/print','dateTimeCancelRemain','bNFuw','XTOVf','CrKNj','userId','Fvnix','length','cnxul','hIIny','HIHdN','QKzru','spTTY','VAdqN','hnlfl','bFsgW','{}.constructor(\x22return\x20this\x22)(\x20)','includes','GeKrI','JGTfw','function\x20*\x5c(\x20*\x5c)','FfUQr','qkgZm','CliOU','getMainDocPathObj','LvLze','active','/load','yellow','alvpf','warehouseOut','XTGfy','vCJnF','fTVbg','end','puppeteer','updateOne','1701801XqoLYK','DOC_TYPE','test','SthpY','get','raAMj','bTTWW','cnbUr','BoXtz','dbUrl','renderView','getItems_for_Modal','ZodeF','toArray','88ETdBGK','QULyP','kpVtr','fHLTv','JygFW','gger','string','iWxoo','OHXCL','TZmJp','mmWqa'];_0x1729=function(){return _0x2ce7d3;};return _0x1729();}_0x1cfa3d();import _0x58101a from'express';const b=_0x58101a[_0x2d1a10(0x13d)]();import _0x442e60 from'path';import{MongoClient as _0x4ab7ea}from'mongodb';import _0x2f5c57 from'../middleware/mainAuth.js';import*as _0x245d60 from'../mymodule/myUsers.js';import*as _0x25c635 from'../mymodule/myDateTime.js';import*as _0x3c5a2e from'../mymodule/myModule.js';import*as _0x2c44f7 from'../mymodule/myDocMain.js';import*as _0xfa8ed6 from'../mymodule/myData.js';const w=global[_0x2d1a10(0x274)],S=global['PATH_WAREHOUSE_OUT'],p=global['PATH_SALES'],M=[w+_0x2d1a10(0x186),S+_0x2d1a10(0x186),p+'/changes'],v=[w+_0x2d1a10(0x1d6),S+_0x2d1a10(0x1d6),p+_0x2d1a10(0x1d6)],k=[w+_0x2d1a10(0x10e),S+_0x2d1a10(0x10e),p+_0x2d1a10(0x10e)],B=[w+_0x2d1a10(0x193),S+'/search',p+_0x2d1a10(0x193)],x=[w+'/load',S+_0x2d1a10(0x1f1),p+'/load',w+_0x2d1a10(0x13b),S+_0x2d1a10(0x13b),p+_0x2d1a10(0x13b)],L=[w+_0x2d1a10(0x14e),S+_0x2d1a10(0x14e),p+'/fetch/modal'];b[_0x2d1a10(0x1ff)](L,_0x2f5c57[_0x2d1a10(0x234)],async(_0x18c969,_0x293a55)=>{const _0x237f5a=_0x2d1a10,_0x2c3ea7={'qkgZm':function(_0x440f84,_0x9e6042){return _0x440f84===_0x9e6042;},'hgseI':_0x237f5a(0x250),'bjaIh':function(_0x3326ca,_0x5b062c){return _0x3326ca==_0x5b062c;},'pofks':_0x237f5a(0x104),'FcjJB':_0x237f5a(0x218),'qtSWK':_0x237f5a(0x1f4),'jZYzv':_0x237f5a(0x19c),'sIKGM':_0x237f5a(0x1f0),'LEFFK':_0x237f5a(0x268),'PWDlg':_0x237f5a(0x181),'qXvPd':function(_0x1ea3b5,_0x4aa3c6){return _0x1ea3b5===_0x4aa3c6;},'NvDWo':_0x237f5a(0x251),'PDywc':_0x237f5a(0x1b2),'JGTfw':_0x237f5a(0x26d)},_0x5a0f0f=await _0x245d60[_0x237f5a(0x1b5)](_0x18c969),_0x4037a0=await _0x2c44f7[_0x237f5a(0x1ee)](_0x18c969,_0x293a55,_0x5a0f0f['userAuthority']);try{if(_0x2c3ea7[_0x237f5a(0x1ec)](_0x2c3ea7[_0x237f5a(0x116)],_0x2c3ea7[_0x237f5a(0x116)])){if(_0x2c3ea7['bjaIh'](_0x4037a0[_0x237f5a(0x1fc)],_0x2c3ea7['pofks']))var _0x58ec68=await _0xfa8ed6[_0x237f5a(0x206)](_0x2c3ea7[_0x237f5a(0x168)]);else{if(_0x2c3ea7[_0x237f5a(0x196)](_0x4037a0[_0x237f5a(0x1fc)],_0x2c3ea7['qtSWK']))var _0x58ec68=await _0xfa8ed6[_0x237f5a(0x206)](_0x2c3ea7['FcjJB']);else{if(_0x2c3ea7[_0x237f5a(0x196)](_0x4037a0[_0x237f5a(0x1fc)],_0x2c3ea7['jZYzv']))var _0x58ec68=await _0xfa8ed6[_0x237f5a(0x206)](_0x2c3ea7['sIKGM']);}}const _0x4058fb=await _0xfa8ed6[_0x237f5a(0x17d)]();return _0x293a55['send'](JSON[_0x237f5a(0x126)]({'DATA_ITEMS':_0x58ec68,'DATA_CATEGORY':_0x4058fb,'isFetch':!0x0,'class':_0x2c3ea7['LEFFK'],'msg':_0x2c3ea7[_0x237f5a(0x266)]}));}else{const _0x3b510c=_0x448de7[_0x237f5a(0x11a)](_0x1cbd9c,arguments);return _0x1bec77=null,_0x3b510c;}}catch(_0x562325){if(_0x2c3ea7['qXvPd'](_0x2c3ea7['NvDWo'],_0x2c3ea7[_0x237f5a(0x1c6)]))_0x878bbd[_0x237f5a(0x233)]();else return console[_0x237f5a(0x1bf)](_0x562325),_0x293a55['send'](JSON['stringify']({'isFetch':!0x1,'class':_0x2c3ea7[_0x237f5a(0x1e9)],'msg':_0x562325[_0x237f5a(0x16a)]}));}}),b[_0x2d1a10(0x214)](B,_0x2f5c57['isAuth'],async(_0x8d457e,_0x46b60e)=>{const _0x2919c4=_0x2d1a10,_0x455a2f={'dZLZK':function(_0x4eff41,_0x545fe2){return _0x4eff41(_0x545fe2);},'wzPTD':function(_0x2570e3,_0x3545e8){return _0x2570e3<_0x3545e8;},'JygFW':_0x2919c4(0x1f2),'YYECQ':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','Hkbqv':function(_0x3b4656,_0x5452d7){return _0x3b4656===_0x5452d7;},'fwAJy':_0x2919c4(0x222),'VAdqN':_0x2919c4(0x109),'BLlZn':function(_0x560f49,_0x517f69){return _0x560f49+_0x517f69;},'lMIYC':_0x2919c4(0x268),'lrYyU':function(_0x252cee,_0x1a4eda){return _0x252cee!==_0x1a4eda;},'pGwBl':_0x2919c4(0x1b0),'xRHRf':_0x2919c4(0x26d),'ZzxZo':function(_0x3a3a52,_0xbc5eb0){return _0x3a3a52===_0xbc5eb0;},'UMcrw':'SJcZZ','RhGUh':'NcJQC'};let {sip:_0x533d25}=_0x8d457e[_0x2919c4(0x110)];if(!_0x533d25&&_0x455a2f['wzPTD'](_0x533d25[_0x2919c4(0x1dd)],0x2))return _0x46b60e['send'](JSON[_0x2919c4(0x126)]({'isSearch':!0x1,'class':_0x455a2f[_0x2919c4(0x20d)],'msg':_0x455a2f['YYECQ']}));_0x533d25=_0x533d25[_0x2919c4(0x12d)](/[!@#$%^&*<>]/g,'')??null;const _0x5dddba=await _0x245d60[_0x2919c4(0x1b5)](_0x8d457e);await _0x2c44f7[_0x2919c4(0x1ee)](_0x8d457e,_0x46b60e,_0x5dddba[_0x2919c4(0x247)]);const {collectionName:_0x5f87c5}=_0xfa8ed6[_0x2919c4(0x22b)](_0x8d457e[_0x2919c4(0x134)]),_0x2dd76d=new _0x4ab7ea(global[_0x2919c4(0x204)]);try{if(_0x455a2f[_0x2919c4(0x150)](_0x455a2f[_0x2919c4(0x273)],_0x455a2f[_0x2919c4(0x273)])){await _0x2dd76d[_0x2919c4(0x276)]();const _0x1ce80b=_0x2dd76d['db'](global[_0x2919c4(0x1a5)])['collection'](_0x5f87c5),_0x61e5cc=[{'$or':[{'docId':{'$regex':_0x533d25,'$options':'i'}},{'docDate':{'$regex':_0x533d25,'$options':'i'}}]}];let _0x1099d0='';['O','S'][_0x2919c4(0x1e7)](_0x5dddba[_0x2919c4(0x247)])||(_0x1099d0+=_0x455a2f[_0x2919c4(0x1e3)],_0x61e5cc[_0x2919c4(0x158)]({'userId':_0x5dddba['userId']}));const _0x12c628=await _0x1ce80b[_0x2919c4(0x10c)]([{'$match':{'$and':_0x61e5cc}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x2919c4(0x208)]();return _0x1099d0=_0x455a2f[_0x2919c4(0x187)]('พบ\x20\x22'+_0x12c628['length']+_0x2919c4(0x25a),_0x1099d0),_0x46b60e['send'](JSON['stringify']({'searchFound':_0x12c628,'msg':_0x1099d0,'isSearch':!0x0,'class':_0x455a2f[_0x2919c4(0x1be)]}));}else{if(_0x4c6966){const _0x45fb23=_0x13ae1f[_0x2919c4(0x11a)](_0x4c56be,arguments);return _0x19e4a5=null,_0x45fb23;}}}catch(_0x3a932a){if(_0x455a2f['lrYyU'](_0x455a2f[_0x2919c4(0x15b)],_0x455a2f[_0x2919c4(0x15b)])){if(_0x110ab9)return _0x36e577;else mvQEnk[_0x2919c4(0x14d)](_0x386fc2,0x0);}else return console[_0x2919c4(0x1bf)](_0x3a932a),_0x46b60e[_0x2919c4(0x165)](JSON[_0x2919c4(0x126)]({'isSearch':!0x1,'class':_0x455a2f[_0x2919c4(0x18c)],'msg':_0x3a932a[_0x2919c4(0x16a)]}));}finally{if(_0x455a2f[_0x2919c4(0x262)](_0x455a2f[_0x2919c4(0x106)],_0x455a2f[_0x2919c4(0x148)])){const _0x5bd843=_0x1a97b9[_0x2919c4(0x26c)][_0x2919c4(0x12b)]['bind'](_0x848c6e),_0x4e3adb=_0x448f19[_0x403542],_0x462138=_0x347cc7[_0x4e3adb]||_0x5bd843;_0x5bd843[_0x2919c4(0x1a0)]=_0x789719[_0x2919c4(0x190)](_0x324ab6),_0x5bd843[_0x2919c4(0x117)]=_0x462138[_0x2919c4(0x117)]['bind'](_0x462138),_0x18971b[_0x4e3adb]=_0x5bd843;}else _0x2dd76d[_0x2919c4(0x233)]();}}),b[_0x2d1a10(0x214)](x,_0x2f5c57['isAuth'],async(_0x4a807a,_0x2e8f81)=>{const _0x4d651a=_0x2d1a10,_0x2cb3b8={'LQMFW':function(_0x1c67ba,_0x1f6473){return _0x1c67ba(_0x1f6473);},'Djgtf':function(_0x5ad4f3,_0x156567){return _0x5ad4f3+_0x156567;},'Yqefw':function(_0x382924,_0x139836){return _0x382924+_0x139836;},'FRtJH':'return\x20(function()\x20','nmhCD':_0x4d651a(0x1e6),'kzsbs':_0x4d651a(0x26d),'ULSBe':function(_0x3318e5,_0x349420){return _0x3318e5(_0x349420);},'RaXil':function(_0x1f7f9d,_0x2c98d4){return _0x1f7f9d!==_0x2c98d4;},'SZpfW':_0x4d651a(0x243),'ZQcUx':function(_0x1a84ac,_0x47a1e2){return _0x1a84ac===_0x47a1e2;},'mGuzo':_0x4d651a(0x1bc),'dYaDP':_0x4d651a(0x178),'pYbpT':_0x4d651a(0x1aa),'HhPJp':function(_0x3c1114,_0x339235){return _0x3c1114===_0x339235;},'VBzRz':_0x4d651a(0x107),'RJgfN':function(_0x506463,_0x2d2040){return _0x506463==_0x2d2040;},'aKpoe':_0x4d651a(0x1ef),'csvPD':_0x4d651a(0x179),'fcZhn':function(_0x259de7,_0x2c66d8){return _0x259de7==_0x2c66d8;},'cIZkp':_0x4d651a(0x1cc),'YXpeW':_0x4d651a(0x180),'fTVbg':_0x4d651a(0x261),'LHeGg':_0x4d651a(0x268),'ULBIC':function(_0x3cc4b5,_0x35a245){return _0x3cc4b5!==_0x35a245;},'TXbNT':_0x4d651a(0x1b6),'xxbGE':_0x4d651a(0x271)};let {docId:_0xf3cbf1,action:_0x3ffec7}=_0x4a807a[_0x4d651a(0x110)];const _0x39fbd4=await _0x245d60[_0x4d651a(0x1b5)](_0x4a807a);await _0x2c44f7[_0x4d651a(0x1ee)](_0x4a807a,_0x2e8f81,_0x39fbd4['userAuthority']);const {collectionName:_0x5ce986}=_0xfa8ed6[_0x4d651a(0x22b)](_0x4a807a['originalUrl']),_0x185c86=new _0x4ab7ea(global[_0x4d651a(0x204)]);try{if(_0x2cb3b8[_0x4d651a(0x141)](_0x2cb3b8['SZpfW'],_0x2cb3b8[_0x4d651a(0x1ce)])){let _0x135434;try{_0x135434=lYyLSe['LQMFW'](_0x29419c,lYyLSe[_0x4d651a(0x1c7)](lYyLSe[_0x4d651a(0x264)](lYyLSe[_0x4d651a(0x159)],lYyLSe[_0x4d651a(0x24d)]),');'))();}catch(_0x5b77dc){_0x135434=_0x1d339b;}return _0x135434;}else{await _0x185c86[_0x4d651a(0x276)]();const _0x5a97a6=_0x185c86['db'](global[_0x4d651a(0x1a5)])[_0x4d651a(0x21f)](_0x5ce986);if(_0x2cb3b8['ZQcUx'](_0x3ffec7,_0x2cb3b8[_0x4d651a(0x132)])){if(_0x2cb3b8['ZQcUx'](_0x2cb3b8['dYaDP'],_0x2cb3b8[_0x4d651a(0x11c)])){const _0x1b056b=['O','S'][_0x4d651a(0x1e7)](_0x39fbd4[_0x4d651a(0x247)])?{'docId':_0xf3cbf1}:{'docId':_0xf3cbf1,'userId':_0x39fbd4[_0x4d651a(0x1db)]};var _0x569ba6=await _0x5a97a6[_0x4d651a(0x1b8)](_0x1b056b,{'projection':{'_id':0x0,'changesHistory':0x0}});}else return _0x1f50a4;}else{if(_0x2cb3b8[_0x4d651a(0x27a)](_0x3ffec7,_0x2cb3b8[_0x4d651a(0x155)]))var _0x569ba6=await _0x5a97a6[_0x4d651a(0x1b8)]({'userId':_0x39fbd4[_0x4d651a(0x1db)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x1f305c=_0x569ba6?'':_0x2cb3b8[_0x4d651a(0x124)](_0x3ffec7,_0x2cb3b8['mGuzo'])?_0x4d651a(0x118)+_0xf3cbf1+'\x22':_0x2cb3b8[_0x4d651a(0x19d)];if(!_0x569ba6)return _0x2e8f81['send'](JSON[_0x4d651a(0x126)]({'isLoad':!0x1,'class':_0x2cb3b8['kzsbs'],'msg':_0x1f305c}));let _0x4b365b=_0x4d651a(0x277)+_0x569ba6['docId']+_0x4d651a(0x19a);if(_0x2cb3b8['RJgfN'](_0x569ba6[_0x4d651a(0x240)],0x1)&&_0x569ba6[_0x4d651a(0x11f)]){if(_0x2cb3b8[_0x4d651a(0x141)](_0x2cb3b8[_0x4d651a(0x26f)],_0x2cb3b8[_0x4d651a(0x26f)]))_0x2daaee[_0x4d651a(0x1bf)](_0xe6d2ef),_0x1dd767[_0x4d651a(0x165)](_0x2bb831[_0x4d651a(0x126)]({'isStatus':!0x1,'class':_0x2cb3b8[_0x4d651a(0x1ad)],'msg':_0x54a7e7[_0x4d651a(0x16a)]}));else{let _0x3adbd9=await _0xfa8ed6['check_DocDateTime_CanEdit'](_0x569ba6,_0x5ce986,_0x39fbd4[_0x4d651a(0x1db)]);_0x569ba6[_0x4d651a(0x24b)]=_0x3adbd9[_0x4d651a(0x24b)],_0x2cb3b8[_0x4d651a(0x17a)](_0x3adbd9['canEdit'],!0x1)&&(_0x569ba6[_0x4d651a(0x240)]=_0x3adbd9[_0x4d651a(0x240)],_0x4b365b+=_0x2cb3b8[_0x4d651a(0x167)]);}}else _0x569ba6['dateTimeEditRemain']='-';if((_0x2cb3b8[_0x4d651a(0x17a)](_0x569ba6[_0x4d651a(0x240)],0x1)||_0x2cb3b8[_0x4d651a(0x12a)](_0x569ba6[_0x4d651a(0x240)],0x2))&&_0x569ba6[_0x4d651a(0x227)]){if(_0x2cb3b8[_0x4d651a(0x27a)](_0x2cb3b8[_0x4d651a(0x103)],_0x2cb3b8['YXpeW']))lYyLSe[_0x4d651a(0x22c)](_0x1d0581,'0');else{const _0x13e5cd=await _0xfa8ed6[_0x4d651a(0x163)](_0x569ba6,_0x5ce986,_0x39fbd4[_0x4d651a(0x1db)]);_0x569ba6['dateTimeCancelRemain']=_0x13e5cd['dateTimeCancelRemain'],_0x2cb3b8[_0x4d651a(0x12a)](_0x13e5cd[_0x4d651a(0x13f)],!0x1)&&(_0x4b365b+=_0x2cb3b8[_0x4d651a(0x1f7)]);}}else _0x569ba6[_0x4d651a(0x1d7)]='-';const {branchName:_0xd48fcc}=await _0xfa8ed6['getUserBranchesById'](_0x569ba6[_0x4d651a(0x22f)]);return _0x569ba6[_0x4d651a(0x278)]=_0xd48fcc,_0x2e8f81[_0x4d651a(0x165)](JSON[_0x4d651a(0x126)]({'doc':_0x569ba6,'isLoad':!0x0,'class':_0x2cb3b8[_0x4d651a(0x275)],'msg':_0x4b365b}));}}catch(_0xcc8396){if(_0x2cb3b8[_0x4d651a(0x135)](_0x2cb3b8['TXbNT'],_0x2cb3b8['TXbNT'])){const _0x3b74b6=_0x2e790d[_0x4d651a(0x11a)](_0x50bd25,arguments);return _0x55d852=null,_0x3b74b6;}else return console['log'](_0xcc8396),_0x2e8f81['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x2cb3b8[_0x4d651a(0x1ad)],'msg':_0xcc8396[_0x4d651a(0x16a)]}));}finally{if(_0x2cb3b8['RaXil'](_0x2cb3b8['xxbGE'],_0x2cb3b8[_0x4d651a(0x175)]))return!![];else _0x185c86['close']();}}),b[_0x2d1a10(0x214)](M,_0x2f5c57['isAuth'],async(_0x4d938c,_0x3e0a60)=>{const _0x5e5367=_0x2d1a10,_0x274aeb={'XTOVf':function(_0x34baac){return _0x34baac();},'EEgNg':function(_0x12155a,_0x1ecee5){return _0x12155a===_0x1ecee5;},'hnlfl':_0x5e5367(0x1e2),'mmWqa':'hSJeN','bwEfY':_0x5e5367(0x26d),'CrKNj':function(_0x1be1b2,_0x2c80da){return _0x1be1b2<_0x2c80da;},'fVlww':'yellow','tZVLG':'ไม่พบประวัติการเปลี่ยนแปลง','QKzru':_0x5e5367(0x164),'XdOXm':_0x5e5367(0x268),'HIHdN':function(_0x48ce83,_0x1bddac){return _0x48ce83===_0x1bddac;},'ylIFv':_0x5e5367(0x191),'sgHgF':'error\x20===>\x20','jnkeU':function(_0x26b585,_0xae101){return _0x26b585!==_0xae101;},'JzfRI':'kTECi','ptMjo':_0x5e5367(0x239)},{docId:_0x2363b3}=_0x4d938c[_0x5e5367(0x110)],_0x249da3=await _0x245d60[_0x5e5367(0x1b5)](_0x4d938c);await _0x2c44f7[_0x5e5367(0x1ee)](_0x4d938c,_0x3e0a60,_0x249da3[_0x5e5367(0x247)]);const {collectionName:_0x4b24f3}=_0xfa8ed6['get_Info_ByUrl'](_0x4d938c[_0x5e5367(0x134)]),_0x246933=new _0x4ab7ea(global[_0x5e5367(0x204)]);try{if(_0x274aeb['EEgNg'](_0x274aeb[_0x5e5367(0x1e4)],_0x274aeb[_0x5e5367(0x213)]))_0x3d3ee7[_0x5e5367(0x233)]();else{await _0x246933[_0x5e5367(0x276)]();var _0x327ddc=await _0x246933['db'](global[_0x5e5367(0x1a5)])[_0x5e5367(0x21f)](_0x4b24f3)[_0x5e5367(0x1b8)]({'docId':_0x2363b3});if(!_0x327ddc)return _0x3e0a60[_0x5e5367(0x165)](JSON['stringify']({'isPrint':!0x1,'class':_0x274aeb[_0x5e5367(0x128)],'msg':_0x5e5367(0x118)+_0x2363b3+'\x22'}));const _0x397ee1=_0x327ddc[_0x5e5367(0x133)]||[];if(_0x274aeb[_0x5e5367(0x1da)](_0x397ee1[_0x5e5367(0x1dd)],0x1))return _0x3e0a60[_0x5e5367(0x165)](JSON[_0x5e5367(0x126)]({'isPrint':!0x1,'class':_0x274aeb[_0x5e5367(0x114)],'msg':_0x274aeb[_0x5e5367(0x1bd)]}));const _0x461839=_0x442e60[_0x5e5367(0x25f)](folderForms,_0x274aeb[_0x5e5367(0x1e1)]),_0x34c3e5=await _0x3c5a2e[_0x5e5367(0x205)](_0x461839,_0x3e0a60,{'title':_0x327ddc['docId'],'time':_0x25c635[_0x5e5367(0x23c)](new Date()),'changesHistory':_0x397ee1});_0x3e0a60[_0x5e5367(0x165)](JSON['stringify']({'isPrint':!0x0,'class':_0x274aeb[_0x5e5367(0x16e)],'htmlPage':_0x34c3e5}));}}catch(_0x2b5232){_0x274aeb[_0x5e5367(0x1e0)](_0x274aeb['ylIFv'],_0x274aeb[_0x5e5367(0x1c3)])?(console[_0x5e5367(0x1bf)](_0x274aeb['sgHgF'],_0x2b5232),_0x3e0a60[_0x5e5367(0x165)](JSON['stringify']({'isPrint':!0x1,'class':_0x274aeb['bwEfY'],'msg':_0x2b5232[_0x5e5367(0x16a)]}))):_0x5a3af5['close']();}finally{_0x274aeb[_0x5e5367(0x18a)](_0x274aeb[_0x5e5367(0x255)],_0x274aeb['ptMjo'])?_0x246933[_0x5e5367(0x233)]():FbciaC[_0x5e5367(0x1d9)](_0x2818f8);}}),b['post'](v,_0x2f5c57[_0x2d1a10(0x234)],async(_0x5527e4,_0x38b8fb)=>{const _0x715fd=_0x2d1a10,_0x1058bf={'DZEzr':_0x715fd(0x26d),'Fvnix':'function\x20*\x5c(\x20*\x5c)','wpCJB':_0x715fd(0x220),'TXrcC':function(_0x232ceb,_0x3c92cb){return _0x232ceb(_0x3c92cb);},'MtUfG':_0x715fd(0x18e),'hosds':function(_0x56daaa,_0x3095c1){return _0x56daaa+_0x3095c1;},'TWEwT':_0x715fd(0x143),'sPuSq':'input','fHLTv':function(_0x971c67,_0x2dcdc9){return _0x971c67(_0x2dcdc9);},'HzkKm':function(_0x52c3a9){return _0x52c3a9();},'zZBtP':function(_0x128c53,_0x20e66b){return _0x128c53===_0x20e66b;},'HTKWZ':'WafVC','qnEDo':function(_0x4d3c1f,_0x3b28b2){return _0x4d3c1f!==_0x3b28b2;},'iWxoo':_0x715fd(0x1a7),'HqKey':_0x715fd(0x25d),'bVWgU':function(_0x51e839,_0x267250){return _0x51e839==_0x267250;},'rcXuv':_0x715fd(0x12c),'XbQgf':_0x715fd(0x268),'kkuZo':function(_0x512d40,_0x5e960c){return _0x512d40==_0x5e960c;},'NIXFS':'image','pSvlt':_0x715fd(0x10b),'nqJyp':_0x715fd(0x23a),'IEQiT':_0x715fd(0x1f9),'GYwdW':_0x715fd(0x238),'LKuxD':function(_0x15403d,_0x1afeb6){return _0x15403d*_0x1afeb6;},'ovvki':function(_0x22f3ce,_0x2cc9b1){return _0x22f3ce/_0x2cc9b1;},'pAHKZ':'jpeg','wZdyU':'image/jpeg','cHSZx':function(_0x29bc60,_0x3e7f3b){return _0x29bc60!==_0x3e7f3b;},'eShtA':_0x715fd(0x1a3),'iTSPU':_0x715fd(0x184),'indOM':_0x715fd(0x12e)},{docId:_0x43510d,action:_0x25aa6f}=_0x5527e4['body'],_0x935bd3=await _0x245d60[_0x715fd(0x1b5)](_0x5527e4);await _0x2c44f7[_0x715fd(0x1ee)](_0x5527e4,_0x38b8fb,_0x935bd3[_0x715fd(0x247)]);const {collectionName:_0xd136cd,docTitle:_0x49e7a3}=_0xfa8ed6['get_Info_ByUrl'](_0x5527e4['originalUrl']),_0x475062=new _0x4ab7ea(global[_0x715fd(0x204)]);try{if(_0x1058bf['qnEDo'](_0x1058bf[_0x715fd(0x210)],_0x1058bf['iWxoo']))return _0x176890[_0x715fd(0x1bf)](_0x954e8a),_0x574a47[_0x715fd(0x165)](_0x26a9dc[_0x715fd(0x126)]({'isSearch':!0x1,'class':_0x1058bf['DZEzr'],'msg':_0x24fe22[_0x715fd(0x16a)]}));else{await _0x475062[_0x715fd(0x276)]();var _0x4187ad=await _0x475062['db'](global['dbName'])[_0x715fd(0x21f)](_0xd136cd)[_0x715fd(0x1b8)]({'docId':_0x43510d});if(!_0x4187ad)return _0x38b8fb[_0x715fd(0x165)](JSON[_0x715fd(0x126)]({'isLoad':!0x1,'class':_0x1058bf[_0x715fd(0x16f)],'msg':_0x715fd(0x118)+_0x43510d+'\x22'}));_0x4187ad[_0x715fd(0x1c9)]=_0x49e7a3,_0x4187ad[_0x715fd(0x25e)]=_0xfa8ed6[_0x715fd(0x1a4)](_0x4187ad[_0x715fd(0x240)]);const _0x10ff32=_0xfa8ed6[_0x715fd(0x16b)](_0x4187ad),_0x474087=_0x442e60['join'](folderForms,_0x1058bf[_0x715fd(0x130)]),_0x1fc685=await _0x3c5a2e[_0x715fd(0x205)](_0x474087,_0x38b8fb,{'title':_0x43510d,'time':_0x25c635[_0x715fd(0x23c)](new Date()),'action':_0x25aa6f,'doc':_0x10ff32});if(_0x1058bf[_0x715fd(0x14c)](_0x25aa6f,_0x1058bf[_0x715fd(0x256)]))_0x38b8fb[_0x715fd(0x165)](JSON[_0x715fd(0x126)]({'isPrint':!0x0,'class':_0x1058bf[_0x715fd(0x224)],'htmlPage':_0x1fc685}));else{if(_0x1058bf[_0x715fd(0x11e)](_0x25aa6f,_0x1058bf[_0x715fd(0x254)])){if(_0x1058bf[_0x715fd(0x1c1)](_0x1058bf[_0x715fd(0x1a8)],_0x1058bf['nqJyp'])){const _0x3e063d=await(await import(_0x1058bf['IEQiT']))['launch'](),_0x32e678=await _0x3e063d[_0x715fd(0x25c)]();await _0x32e678['setContent'](_0x1fc685,{'waitUntil':_0x1058bf['GYwdW'],'timeout':0x2710}),await new Promise(_0x2635ee=>setTimeout(_0x2635ee,0x3e8));const _0x1806be=Math[_0x715fd(0x26b)](_0x1058bf[_0x715fd(0x1c2)](_0x1058bf[_0x715fd(0x169)](0x50,25.4),0x60));await _0x32e678['setViewport']({'width':_0x1806be,'height':0x258,'deviceScaleFactor':0x1});const _0xecd4=await _0x32e678['evaluate'](()=>{const _0xccab6b=_0x715fd,_0x15f705={'aXqLu':_0x1058bf[_0xccab6b(0x1dc)],'wXpqu':_0x1058bf[_0xccab6b(0x11b)],'bAPkn':function(_0x4d3a4d,_0x416f34){return _0x1058bf['TXrcC'](_0x4d3a4d,_0x416f34);},'CUqLu':_0x1058bf['MtUfG'],'vckYA':function(_0x1cef74,_0xd6c6aa){return _0x1058bf['hosds'](_0x1cef74,_0xd6c6aa);},'GatXY':_0x1058bf[_0xccab6b(0x17f)],'xAztF':_0x1058bf[_0xccab6b(0x192)],'tRcqZ':function(_0x4e47a1,_0x5edb65){const _0x578745=_0xccab6b;return _0x1058bf[_0x578745(0x20c)](_0x4e47a1,_0x5edb65);},'Uvsnd':function(_0x407052){return _0x1058bf['HzkKm'](_0x407052);}};if(_0x1058bf[_0xccab6b(0x22e)](_0x1058bf[_0xccab6b(0x131)],_0x1058bf[_0xccab6b(0x131)])){const _0x54c222=document['body'],_0x5c8666=document[_0xccab6b(0x270)];return Math['max'](_0x54c222[_0xccab6b(0x1af)],_0x54c222[_0xccab6b(0x22d)],_0x5c8666[_0xccab6b(0x24e)],_0x5c8666[_0xccab6b(0x1af)],_0x5c8666[_0xccab6b(0x22d)]);}else{const _0x119eb6=new _0x2a11d7(XbaSee[_0xccab6b(0x257)]),_0x421f19=new _0x4bf958(XbaSee[_0xccab6b(0x1ab)],'i'),_0x24ec25=XbaSee['bAPkn'](_0x114cbd,XbaSee['CUqLu']);!_0x119eb6[_0xccab6b(0x1fd)](XbaSee[_0xccab6b(0x19b)](_0x24ec25,XbaSee[_0xccab6b(0x119)]))||!_0x421f19[_0xccab6b(0x1fd)](XbaSee[_0xccab6b(0x19b)](_0x24ec25,XbaSee[_0xccab6b(0x176)]))?XbaSee[_0xccab6b(0x1d5)](_0x24ec25,'0'):XbaSee['Uvsnd'](_0x51f9f4);}}),_0x550352=await _0x32e678['screenshot']({'type':_0x1058bf[_0x715fd(0x1ac)],'clip':{'x':0x0,'y':0x0,'width':_0x1806be,'height':_0xecd4},'omitBackground':!0x1});await _0x3e063d[_0x715fd(0x233)]();const _0x466d66=_0x4187ad[_0x715fd(0x183)][_0x715fd(0x12d)](/\//g,'');_0x38b8fb[_0x715fd(0x1a2)](0xc8,{'Content-Type':_0x1058bf[_0x715fd(0x1a6)],'Content-Disposition':'attachment;\x20filename='+_0x466d66+_0x715fd(0x1a9),'Content-Length':_0x550352['length']}),_0x38b8fb[_0x715fd(0x1f8)](_0x550352);}else{const _0x5c447a=_0x11c5fe?function(){const _0x3cedd4=_0x715fd;if(_0x467ac5){const _0x18f038=_0x1f4d37[_0x3cedd4(0x11a)](_0x469905,arguments);return _0x283092=null,_0x18f038;}}:function(){};return _0x5bd8c4=![],_0x5c447a;}}}}}catch(_0x1c4caf){_0x1058bf[_0x715fd(0x198)](_0x1058bf[_0x715fd(0x232)],_0x1058bf['eShtA'])?_0x75f46f[_0x715fd(0x233)]():(console[_0x715fd(0x1bf)](_0x1058bf['iTSPU'],_0x1c4caf),_0x38b8fb[_0x715fd(0x165)](JSON[_0x715fd(0x126)]({'isPrint':!0x1,'class':_0x1058bf[_0x715fd(0x16f)],'msg':_0x1c4caf[_0x715fd(0x16a)]})));}finally{if(_0x1058bf[_0x715fd(0x1c1)](_0x1058bf[_0x715fd(0x23f)],_0x1058bf['indOM'])){const _0x7d94ba=_0x3eb50c[_0x715fd(0x110)],_0x220ca1=_0x2886e1['documentElement'];return _0x4816e0[_0x715fd(0x174)](_0x7d94ba[_0x715fd(0x1af)],_0x7d94ba['offsetHeight'],_0x220ca1[_0x715fd(0x24e)],_0x220ca1[_0x715fd(0x1af)],_0x220ca1[_0x715fd(0x22d)]);}else _0x475062[_0x715fd(0x233)]();}}),b['post'](k,_0x2f5c57[_0x2d1a10(0x234)],async(_0x2ed013,_0x70dc8e)=>{const _0x1910a8=_0x2d1a10,_0x43f4b8={'ZmBVh':_0x1910a8(0x1c5),'Jhbel':'counter','ZodeF':'error\x20===>\x20','AAjSL':_0x1910a8(0x26d),'BcqhV':function(_0x469f29,_0x25c9a2){return _0x469f29==_0x25c9a2;},'pgVmE':'cancel','VwfYG':'ยกเลิก','mYDaB':_0x1910a8(0x136),'jPxGm':_0x1910a8(0x249),'JslBx':function(_0x58a54b,_0xc52d81){return _0x58a54b===_0xc52d81;},'CUIIF':function(_0xfe211f,_0x25f5d2){return _0xfe211f==_0x25f5d2;},'alvpf':_0x1910a8(0x14a),'GeKrI':_0x1910a8(0x142),'FjDPx':function(_0x586e7a,_0x4e191b){return _0x586e7a===_0x4e191b;},'vCJnF':'PaQjv','dwnsG':function(_0x4d140b,_0x5028a6){return _0x4d140b==_0x5028a6;},'CHaUF':function(_0x31de70,_0x63a803){return _0x31de70>_0x63a803;},'CfBAK':_0x1910a8(0x17c),'SAjez':_0x1910a8(0x1fe),'TTgeN':'{{sep}}[บันทึกการแก้ไข]','aBeUM':_0x1910a8(0x268),'aGWPi':function(_0xa9a595,_0x103f5b){return _0xa9a595<_0x103f5b;},'GCWFv':_0x1910a8(0x1f2)},_0x175df2=new _0x4ab7ea(global[_0x1910a8(0x204)]);try{const _0x21fbc2=await _0x245d60[_0x1910a8(0x1b5)](_0x2ed013);await _0x2c44f7['getMainDocPathObj'](_0x2ed013,_0x70dc8e,_0x21fbc2[_0x1910a8(0x247)]);const {collectionName:_0x54f4ee}=_0xfa8ed6[_0x1910a8(0x22b)](_0x2ed013[_0x1910a8(0x134)]),{docId:_0x49ef1d,action:_0x524d0e}=_0x2ed013['body'],_0x194410=_0x43f4b8[_0x1910a8(0x1c4)](_0x524d0e,_0x43f4b8['pgVmE'])?_0x43f4b8[_0x1910a8(0x15d)]:_0x43f4b8[_0x1910a8(0x1c4)](_0x524d0e,_0x43f4b8[_0x1910a8(0x185)])?'จบ':'';if(!_0x49ef1d||![_0x43f4b8[_0x1910a8(0x185)],_0x43f4b8['pgVmE']][_0x1910a8(0x1e7)](_0x524d0e))return _0x70dc8e['send'](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x43f4b8[_0x1910a8(0x18f)]}));const _0x18711f={'docId':_0x49ef1d,'userId':_0x21fbc2[_0x1910a8(0x1db)]},_0x2e0780=_0x175df2['db'](global[_0x1910a8(0x1a5)])[_0x1910a8(0x21f)](_0x54f4ee),_0x1ef141=await _0x2e0780[_0x1910a8(0x1b8)](_0x18711f);if(!_0x1ef141)return _0x70dc8e[_0x1910a8(0x165)](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'class':_0x43f4b8['AAjSL'],'msg':_0x1910a8(0x171)+_0x49ef1d+_0x1910a8(0x23b)+_0x194410+_0x1910a8(0x1b3)}));const _0x30af22=_0x1ef141['docStatusNumber'];if(_0x43f4b8[_0x1910a8(0x229)](_0x524d0e,_0x43f4b8['pgVmE'])&&!(_0x43f4b8[_0x1910a8(0x1c4)](_0x30af22,0x1)||_0x43f4b8[_0x1910a8(0x151)](_0x30af22,0x2)))return _0x70dc8e[_0x1910a8(0x165)](JSON['stringify']({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x43f4b8[_0x1910a8(0x1f3)]}));if(_0x43f4b8[_0x1910a8(0x229)](_0x524d0e,_0x43f4b8[_0x1910a8(0x185)])&&_0x43f4b8[_0x1910a8(0x151)](!_0x30af22,0x1))return _0x70dc8e['send'](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x43f4b8[_0x1910a8(0x1e8)]}));if(_0x43f4b8['CUIIF'](_0x524d0e,_0x43f4b8['pgVmE'])){if(_0x43f4b8['FjDPx'](_0x43f4b8[_0x1910a8(0x1f6)],_0x43f4b8[_0x1910a8(0x1f6)])){if(_0x43f4b8[_0x1910a8(0x1c4)](_0x1ef141[_0x1910a8(0x13f)],!0x1))return _0x70dc8e[_0x1910a8(0x165)](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x1910a8(0x156)+_0x49ef1d+_0x1910a8(0x199)}));if(_0x43f4b8['dwnsG']((await _0xfa8ed6['check_DocDateTime_CanCancel'](_0x1ef141,_0x54f4ee,_0x21fbc2[_0x1910a8(0x1db)]))[_0x1910a8(0x13f)],!0x1))return _0x70dc8e[_0x1910a8(0x165)](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':'เอกสาร\x20\x22'+_0x49ef1d+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}else return function(_0x56bf18){}[_0x1910a8(0x26c)](VyPtgD[_0x1910a8(0x161)])['apply'](VyPtgD[_0x1910a8(0x1b1)]);}if(_0x43f4b8['CUIIF'](_0x524d0e,_0x43f4b8['pgVmE']))var _0x1feb7f=0xa;else{if(_0x43f4b8['dwnsG'](_0x524d0e,_0x43f4b8[_0x1910a8(0x185)]))var _0x1feb7f=0x2;}const _0x21940c=await _0x2e0780[_0x1910a8(0x1fa)](_0x18711f,{'$set':{'docStatusNumber':_0x1feb7f}});var _0x1772af=_0x194410+'\x20\x22'+_0x49ef1d+_0x1910a8(0x267);if(_0x21940c[_0x1910a8(0x219)]||_0x43f4b8[_0x1910a8(0x113)](_0x21940c[_0x1910a8(0x259)],0x0)){const _0x1c7796=_0xfa8ed6[_0x1910a8(0x235)]({'docStatusNumber':_0x30af22},{'docStatusNumber':_0x1feb7f});if(_0x43f4b8['CHaUF'](_0x1c7796[_0x1910a8(0x1dd)],0x0)){if(_0x43f4b8[_0x1910a8(0x1d4)](_0x43f4b8[_0x1910a8(0x115)],_0x43f4b8[_0x1910a8(0x172)]))_0x208bc0['log'](_0x43f4b8[_0x1910a8(0x207)],_0x115cee),_0x277df2[_0x1910a8(0x165)](_0x3092e5['stringify']({'isPrint':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x4fe791[_0x1910a8(0x16a)]}));else{const _0x21c4c9={'dateTime':_0x25c635[_0x1910a8(0x188)](new Date()),'userId':_0x21fbc2[_0x1910a8(0x1db)],'userFullname':_0x21fbc2[_0x1910a8(0x1ae)],'changes':_0x1c7796};await _0x2e0780[_0x1910a8(0x1fa)]({'docId':_0x49ef1d},{'$push':{'changesHistory':{'$each':[_0x21c4c9],'$position':0x0}}}),_0x1772af+=_0x43f4b8[_0x1910a8(0x272)];}}return _0x70dc8e[_0x1910a8(0x165)](JSON['stringify']({'isStatus':!0x0,'docId':_0x49ef1d,'docStatusNumber':_0x1feb7f,'class':_0x43f4b8[_0x1910a8(0x25b)],'msg':_0x1772af}));}else{if(_0x21940c[_0x1910a8(0x219)]&&_0x43f4b8[_0x1910a8(0x125)](_0x21940c[_0x1910a8(0x259)],0x1))return _0x70dc8e[_0x1910a8(0x165)](JSON[_0x1910a8(0x126)]({'isStatus':!0x1,'docId':_0x49ef1d,'docStatusNumber':_0x30af22,'class':_0x43f4b8[_0x1910a8(0x145)],'msg':'\x22'+_0x49ef1d+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x10e13d){console[_0x1910a8(0x1bf)](_0x10e13d),_0x70dc8e['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x43f4b8[_0x1910a8(0x13c)],'msg':_0x10e13d['message']}));}finally{_0x175df2[_0x1910a8(0x233)]();}});function _0x3e05(_0x55d2a8,_0x4150d9){const _0x538509=_0x1729();return _0x3e05=function(_0x1cfa3d,_0x37f370){_0x1cfa3d=_0x1cfa3d-0x103;let _0x396237=_0x538509[_0x1cfa3d];return _0x396237;},_0x3e05(_0x55d2a8,_0x4150d9);}export default b;function _0x5a2a29(_0x3732c6){const _0x3a2419=_0x2d1a10,_0xe45c12={'raAMj':function(_0x29e894,_0x4b4e7c){return _0x29e894===_0x4b4e7c;},'yqOtZ':_0x3a2419(0x20f),'IBzTW':_0x3a2419(0x1c5),'CLiTe':_0x3a2419(0x120),'AgFot':function(_0x366bfc,_0x5a01c0){return _0x366bfc!==_0x5a01c0;},'eQgiz':function(_0x99a360,_0x380486){return _0x99a360+_0x380486;},'dXhnX':function(_0x3f5242,_0xbc16a0){return _0x3f5242/_0xbc16a0;},'WSoKv':_0x3a2419(0x1dd),'mnMQd':function(_0x135ce1,_0x4a01ba){return _0x135ce1%_0x4a01ba;},'oKEHh':function(_0x49a2b6,_0x1e2f9e){return _0x49a2b6+_0x1e2f9e;},'wxPeb':_0x3a2419(0x13e),'uxmXZ':_0x3a2419(0x20e),'VCnkv':_0x3a2419(0x14f),'VLGau':_0x3a2419(0x111),'bFsgW':function(_0x4ae0c9,_0xcd184c){return _0x4ae0c9(_0xcd184c);},'ZeAFn':function(_0x2000b9,_0x5e2ed9){return _0x2000b9(_0x5e2ed9);}};function _0x15bd38(_0x33efdb){const _0x17ae3b=_0x3a2419;if(_0xe45c12[_0x17ae3b(0x200)](typeof _0x33efdb,_0xe45c12['yqOtZ']))return function(_0x62afa4){}[_0x17ae3b(0x26c)](_0xe45c12[_0x17ae3b(0x263)])[_0x17ae3b(0x11a)](_0xe45c12[_0x17ae3b(0x226)]);else _0xe45c12['AgFot'](_0xe45c12[_0x17ae3b(0x16d)]('',_0xe45c12['dXhnX'](_0x33efdb,_0x33efdb))[_0xe45c12[_0x17ae3b(0x216)]],0x1)||_0xe45c12[_0x17ae3b(0x200)](_0xe45c12[_0x17ae3b(0x221)](_0x33efdb,0x14),0x0)?function(){return!![];}[_0x17ae3b(0x26c)](_0xe45c12[_0x17ae3b(0x15e)](_0xe45c12[_0x17ae3b(0x1ca)],_0xe45c12[_0x17ae3b(0x160)]))['call'](_0xe45c12[_0x17ae3b(0x147)]):function(){return![];}['constructor'](_0xe45c12['eQgiz'](_0xe45c12[_0x17ae3b(0x1ca)],_0xe45c12[_0x17ae3b(0x160)]))[_0x17ae3b(0x11a)](_0xe45c12[_0x17ae3b(0x17b)]);_0xe45c12[_0x17ae3b(0x1e5)](_0x15bd38,++_0x33efdb);}try{if(_0x3732c6)return _0x15bd38;else _0xe45c12[_0x3a2419(0x1cb)](_0x15bd38,0x0);}catch(_0x23ed2f){}}