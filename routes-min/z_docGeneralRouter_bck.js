const _0x2ff5de=_0x6f12;(function(_0x12f510,_0x582e23){const _0x1cb19a=_0x6f12,_0x429621=_0x12f510();while(!![]){try{const _0x5c52c3=-parseInt(_0x1cb19a(0x1b2))/0x1*(parseInt(_0x1cb19a(0x13f))/0x2)+-parseInt(_0x1cb19a(0x1be))/0x3+parseInt(_0x1cb19a(0x1c0))/0x4*(parseInt(_0x1cb19a(0x1b6))/0x5)+parseInt(_0x1cb19a(0x180))/0x6*(-parseInt(_0x1cb19a(0x1b8))/0x7)+-parseInt(_0x1cb19a(0x296))/0x8+parseInt(_0x1cb19a(0x270))/0x9*(-parseInt(_0x1cb19a(0x23f))/0xa)+parseInt(_0x1cb19a(0x286))/0xb;if(_0x5c52c3===_0x582e23)break;else _0x429621['push'](_0x429621['shift']());}catch(_0x170288){_0x429621['push'](_0x429621['shift']());}}}(_0x1dd4,0x50c43));const _0x539e22=(function(){const _0x3d71af=_0x6f12,_0x3b4ee4={'odWVP':'red','mwcwf':function(_0x3cffca,_0x31131a){return _0x3cffca(_0x31131a);},'LnXYm':function(_0x944c04,_0x1b9364){return _0x944c04===_0x1b9364;},'tHLPV':_0x3d71af(0x158),'DkPfe':'ixUdu','NIntU':_0x3d71af(0x1dc),'EBBmt':function(_0x4a16d7,_0x2e2883){return _0x4a16d7===_0x2e2883;},'CgWYM':_0x3d71af(0x214),'ruHLR':_0x3d71af(0x19b)};let _0x2a8c23=!![];return function(_0xe28f61,_0x25967f){const _0x8e8a1c=_0x3d71af,_0x715c30={'FMWMj':_0x3b4ee4[_0x8e8a1c(0x11f)],'EDkWx':function(_0x15f067,_0x2012ab){const _0x32f55a=_0x8e8a1c;return _0x3b4ee4[_0x32f55a(0x151)](_0x15f067,_0x2012ab);},'oSNAh':function(_0x956917,_0x2bb717){const _0x3ab5a8=_0x8e8a1c;return _0x3b4ee4[_0x3ab5a8(0x206)](_0x956917,_0x2bb717);},'DbjgE':_0x3b4ee4['tHLPV'],'RZNsf':_0x3b4ee4[_0x8e8a1c(0x1e7)],'wThDT':_0x3b4ee4[_0x8e8a1c(0x170)]};if(_0x3b4ee4['EBBmt'](_0x3b4ee4[_0x8e8a1c(0x21d)],_0x3b4ee4[_0x8e8a1c(0x22c)]))_0x5cedf6['log'](_0x56f50f),_0x518677[_0x8e8a1c(0x11b)](_0x1ae540[_0x8e8a1c(0x183)]({'isStatus':!0x1,'class':_0x715c30[_0x8e8a1c(0x273)],'msg':_0xd069d5[_0x8e8a1c(0x244)]}));else{const _0x3f6312=_0x2a8c23?function(){const _0xe96951=_0x8e8a1c;if(_0x715c30[_0xe96951(0x184)](_0x715c30[_0xe96951(0x169)],_0x715c30['DbjgE'])){if(_0x25967f){if(_0x715c30[_0xe96951(0x184)](_0x715c30[_0xe96951(0x284)],_0x715c30[_0xe96951(0x1de)])){if(_0x1bd775)return _0x5ae940;else _0x715c30[_0xe96951(0x1d7)](_0x57cfa2,0x0);}else{const _0x38539d=_0x25967f[_0xe96951(0x26b)](_0xe28f61,arguments);return _0x25967f=null,_0x38539d;}}}else return!![];}:function(){};return _0x2a8c23=![],_0x3f6312;}};}());function _0x1dd4(){const _0x21bce3=['test','warehouseIn','stock','counter','WRazT','zYQGz','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','dbName','gger','Swzbl','RZNsf','WessS','16199150uSAtIJ','ZKtAu','iwHfz','warn','uzYxh','jQiwJ','YqfTQ','rEehi','ShXLk','WxCPu','NwqaZ','trace','hlPGD','gRZkB','error\x20===>\x20','ekiOg','1630408YDOTuL','TOOBL','XwsMu','rwbXM','init','nxrTV','SdGwj','canCancel','aFWQW','vuFHo','RVAis','WpyaS','qyKua','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','send','HiAuT','ueRrL','get_StatusName_byStatusNumber','odWVP','/fetch/modal','aJwpc','documentElement','pwURN','kgRvs','userAuthority','oZmfh','networkidle0','error','ZXWoz','CjiqT','FSWRs','bind','Essks','ogvnQ','isAuth','OlKmx','SITBK','DpVcB','difqC','DQJtx','OMBBH','MGPIf','moLZy','uhugj','wLvPO','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','red','LVKqP','screenshot','iSsuF','382brYMyd','max','canEdit','ypqRz','MFolc','CAtHN','pZNzE','/load-last','prototype','{}.constructor(\x22return\x20this\x22)(\x20)','WfDuh','KBSDh','gBjLw','/search','tXKwt','offsetHeight','BbdDa','hnHjk','mwcwf','Router','exception','BQkAY','dateTimeEditRemain','jCtYh','XAyYw','ADOtT','oAOwS','MwZqM','TPBgh','check_DocDateTime_CanCancel','qyXsd','NPzNl','uqMTh','iQEqn','GUQTu','FEcHu','jpeg','convert_DocPrint','uLhZN','ยกเลิก','VaaDy','sewlD','DbjgE','พบ\x20\x22','GiqDU','YrYcX','sOHgC','/changes','cqvYx','NIntU','GbYBJ','jfcmc','gXuHq','function\x20*\x5c(\x20*\x5c)','xAAlN','eOoZX','debu','UfmdO','changesHistory','dOpGy','FkrMq','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','lApNK','renderView','string','2508HScdRy','RgiEY','BLYfL','stringify','oSNAh','print','ZLWZJ','uCdJf','deMbt','evaluate','toArray','includes','NspgB','\x22\x20{{sep}}เรียบร้อยแล้ว','IpwUZ','log','Wmkgo','jFgSj','WVHJC','VdEfr','Xrdvd','XJnJH','FPvmY','matchedCount','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','setViewport','doc_changes.ejs','ZxdXz','VCewx','input','attachment;\x20filename=','length','/status','.jpeg','EeKPO','__proto__','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','zjeYN','BPpUr','check_DocDateTime_CanEdit','dateTimeCanEdit','XRtJV','AkKUt','DxIWe','NvaxZ','modifiedCount','docStatusNumber','fCHzJ','tNUJd','MQdSa','136UeRCqG','tYGpO','iqegV','call','50ulwUpM','prKMl','938dFzNGq','gbUhL','chain','pFdYd','bLYBf','ZTavu','705489HIGVJN','cJSKr','10124zEXVgP','APjMg','UGyZp','yNlHX','PdSpm','DOC_TYPE','warehouseOut','zHgPA','nOSGE','PKLJq','PGSfc','toString','nvDXm','TkFVW','SELis','xLbzV','JfYDP','UhItT','QUKvN','XzzcY','IzlAO','vgobl','yVuKB','EDkWx','userId','HbQdH','JHEjI','VseCs','iRCao','ไม่พบเอกสารเลขที่\x20\x22','wThDT','zPUwQ','eQnrP','sLiSb','PATH_SALES','docId','setContent','active','EpMKv','DkPfe','info','aIEfv','scrollHeight','uRmDa','SpEky','mLJGd','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','ไม่พบเอกสารล่าสุด','GmYUK','OYWCy','sales','table','czoWV','uAMme','OlgcV','getMainDocPathObj','yiDtC','RWQsY','sUOfs','Gwyml','fuopW','bhUBt','HkxdZ','qhRTs','getItems_for_Modal','console','ไม่พบเอกสาร\x20\x22','mUPUz','lFZGi','nJqyG','LnXYm','yellow','puppeteer','dateTimeCancelRemain','while\x20(true)\x20{}','return\x20(function()\x20','MnuWC','GYirn','almzz','aoqBz','writeHead','HUWAW','image/jpeg','Svfwu','PrXjY','lvfRT','UgAsQ','aggregate','jAbWl','เอกสาร\x20\x22','WwQCB','dijag','paNJw','CgWYM','MAafL','branchName','JDmlB','DBoLR','KGGZf','โหลดเอกสารเลขที่\x20\x22','get_Info_ByUrl','CEAuy','formatDate','UEtYr','dbUrl','BHKSl','OQeig','getUserData','ruHLR','findOne','BBiPc','iSSFj','mqtuY','igWpJ','kwYzL','boTvn','floor','NLbRC','QvDRs','QPlNz','oVGvn','getUserBranchesById','AuQYF','AvtmJ','{{sep}}หรือไม่มีสิทธิ์','green','ancsB','10tflbQB','image','OOcUj','constructor','itfcN','message','updateOne','CUmKD','originalUrl','jQTeR','qLylh','stateObject','/load','ahSLb','SJGnm','post','get','EdswB','ropqS','/print','JTLDB','IIFUv','kgipw','body','action','เอกสารที่ตันเองไม่ได้สร้าง','close','HjLdH','ipINY','jhGnM','ไม่พบประวัติการเปลี่ยนแปลง','replace','dDiqm','JscqN','{{sep}}[บันทึกการแก้ไข]','eEHbH','RIkSW','NeXCQ','newPage','KbepI','xSeON','connect','sfXDv','GUOlR','apply','PATH_WAREHOUSE_OUT','getChangeHistory','xEmWM','push','5815701IYgXOI','UWcRh','aCCIb','FMWMj','collection','xvBIJ','ZjoFx','kKNtD','qaSGG','aNBnU'];_0x1dd4=function(){return _0x21bce3;};return _0x1dd4();}(function(){const _0x5e106b=_0x6f12,_0x22315f={'qyKua':function(_0x37cb7f,_0x1c2686){return _0x37cb7f(_0x1c2686);},'sewlD':function(_0x2174ba,_0x4dc20e){return _0x2174ba+_0x4dc20e;},'fCHzJ':_0x5e106b(0x20b),'zYQGz':_0x5e106b(0x148),'bPjnT':function(_0xa7cbe6){return _0xa7cbe6();},'DBoLR':_0x5e106b(0x18f),'eOoZX':_0x5e106b(0x289),'dijag':_0x5e106b(0x1e8),'ancsB':_0x5e106b(0x128),'VeRwW':'exception','JTLDB':_0x5e106b(0x1f3),'paNJw':_0x5e106b(0x291),'AVHOw':function(_0x4ae278,_0x1daec5){return _0x4ae278<_0x1daec5;},'aFWQW':function(_0x225615,_0x1c5741){return _0x225615!==_0x1c5741;},'JwFZU':_0x5e106b(0x15e),'mDoms':_0x5e106b(0x1b7),'EdswB':_0x5e106b(0x174),'YqfTQ':_0x5e106b(0x13a),'zjeYN':function(_0x5dc7aa,_0x4de174){return _0x5dc7aa(_0x4de174);},'CjiqT':_0x5e106b(0x29a),'QvDRs':function(_0x3b1f6c,_0x21ee5b){return _0x3b1f6c+_0x21ee5b;},'qaSGG':_0x5e106b(0x1ba),'IAULy':function(_0x334610,_0x28934a){return _0x334610+_0x28934a;},'jhGnM':_0x5e106b(0x19d),'rwbXM':function(_0x87d8b0,_0x2d035b){return _0x87d8b0!==_0x2d035b;},'JIysh':'RIeJw','HbQdH':'LnYkc','dhbDM':function(_0x93681a,_0x36c6a5){return _0x93681a(_0x36c6a5);},'kgRvs':function(_0x51ee72,_0x14c4c7){return _0x51ee72===_0x14c4c7;},'eQnrP':_0x5e106b(0x1fa),'iqegV':_0x5e106b(0x216),'UGyZp':function(_0x6a6661,_0x3089c7,_0x32597b){return _0x6a6661(_0x3089c7,_0x32597b);}};_0x22315f[_0x5e106b(0x1c2)](_0x539e22,this,function(){const _0x2511cc=_0x5e106b,_0x5797a8={'OYWCy':function(_0x4b73f8,_0xa48e0e){const _0x8c4489=_0x6f12;return _0x22315f[_0x8c4489(0x119)](_0x4b73f8,_0xa48e0e);},'nJqyG':function(_0x433afc,_0x5e5d30){const _0x12b311=_0x6f12;return _0x22315f[_0x12b311(0x168)](_0x433afc,_0x5e5d30);},'JDmlB':_0x22315f[_0x2511cc(0x1af)],'OlKmx':_0x22315f[_0x2511cc(0x27f)],'GbYBJ':function(_0x4a1ac4){return _0x22315f['bPjnT'](_0x4a1ac4);},'MFolc':_0x22315f[_0x2511cc(0x221)],'ZKtAu':_0x22315f[_0x2511cc(0x176)],'WRazT':_0x22315f[_0x2511cc(0x21b)],'XWjBr':_0x22315f[_0x2511cc(0x23e)],'zHgPA':_0x22315f['VeRwW'],'nMcmZ':_0x22315f[_0x2511cc(0x253)],'mLJGd':_0x22315f[_0x2511cc(0x21c)],'WxCPu':function(_0xd18e48,_0x1068d2){return _0x22315f['AVHOw'](_0xd18e48,_0x1068d2);}};if(_0x22315f[_0x2511cc(0x29e)](_0x22315f['JwFZU'],_0x22315f['mDoms'])){const _0x23f624=new RegExp(_0x22315f[_0x2511cc(0x250)]),_0x5db168=new RegExp(_0x22315f[_0x2511cc(0x28c)],'i'),_0x17f151=_0x22315f[_0x2511cc(0x1a5)](_0x131169,_0x22315f[_0x2511cc(0x12a)]);if(!_0x23f624[_0x2511cc(0x27a)](_0x22315f[_0x2511cc(0x236)](_0x17f151,_0x22315f[_0x2511cc(0x278)]))||!_0x5db168[_0x2511cc(0x27a)](_0x22315f['IAULy'](_0x17f151,_0x22315f[_0x2511cc(0x25c)])))_0x22315f[_0x2511cc(0x299)](_0x22315f['JIysh'],_0x22315f[_0x2511cc(0x1d9)])?_0x22315f['dhbDM'](_0x17f151,'0'):_0x50a1cc[_0x2511cc(0x259)]();else{if(_0x22315f[_0x2511cc(0x124)](_0x22315f[_0x2511cc(0x1e0)],_0x22315f[_0x2511cc(0x1b4)])){let _0x430cb6;try{const _0xea3ded=_0x5797a8[_0x2511cc(0x1f1)](_0x124335,_0x5797a8[_0x2511cc(0x205)](_0x5797a8[_0x2511cc(0x205)](_0x5797a8[_0x2511cc(0x220)],_0x5797a8[_0x2511cc(0x130)]),');'));_0x430cb6=_0x5797a8[_0x2511cc(0x171)](_0xea3ded);}catch(_0x3d1f5b){_0x430cb6=_0x38a5cc;}const _0x13f72e=_0x430cb6[_0x2511cc(0x201)]=_0x430cb6[_0x2511cc(0x201)]||{},_0x256ca5=[_0x5797a8[_0x2511cc(0x143)],_0x5797a8[_0x2511cc(0x287)],_0x5797a8[_0x2511cc(0x27e)],_0x5797a8['XWjBr'],_0x5797a8[_0x2511cc(0x1c7)],_0x5797a8['nMcmZ'],_0x5797a8[_0x2511cc(0x1ed)]];for(let _0x4a13fb=0x0;_0x5797a8[_0x2511cc(0x28f)](_0x4a13fb,_0x256ca5[_0x2511cc(0x19f)]);_0x4a13fb++){const _0x1dc495=_0x2ec921[_0x2511cc(0x242)][_0x2511cc(0x147)][_0x2511cc(0x12c)](_0x1b8d20),_0x1e0c4a=_0x256ca5[_0x4a13fb],_0x2b37e6=_0x13f72e[_0x1e0c4a]||_0x1dc495;_0x1dc495['__proto__']=_0x3123c6[_0x2511cc(0x12c)](_0x1a6a7b),_0x1dc495[_0x2511cc(0x1cb)]=_0x2b37e6[_0x2511cc(0x1cb)][_0x2511cc(0x12c)](_0x2b37e6),_0x13f72e[_0x1e0c4a]=_0x1dc495;}}else _0x22315f['bPjnT'](_0x131169);}}else{const _0x74124a=_0x212dbc['body'],_0x320b7a=_0x3f90c6['documentElement'];return _0xa5d1b1[_0x2511cc(0x140)](_0x74124a[_0x2511cc(0x1ea)],_0x74124a[_0x2511cc(0x14e)],_0x320b7a['clientHeight'],_0x320b7a['scrollHeight'],_0x320b7a['offsetHeight']);}})();}());function _0x6f12(_0x144a66,_0x46ab8b){const _0x4ec21a=_0x1dd4();return _0x6f12=function(_0x4221ef,_0x4cee25){_0x4221ef=_0x4221ef-0x118;let _0x101075=_0x4ec21a[_0x4221ef];return _0x101075;},_0x6f12(_0x144a66,_0x46ab8b);}const _0x4cee25=(function(){const _0x3e444b=_0x6f12,_0x53b4ee={'qhRTs':'red','UhItT':function(_0x403f82,_0x4c028a){return _0x403f82!==_0x4c028a;},'UEtYr':_0x3e444b(0x12d),'FEcHu':'GnAWB','gbUhL':'RZFbX','xEmWM':function(_0x369d80,_0x2e2ee5){return _0x369d80+_0x2e2ee5;},'VdEfr':_0x3e444b(0x177),'fuopW':_0x3e444b(0x282),'dOpGy':_0x3e444b(0x257),'DxIWe':'TkfPv','MQdSa':'iCySu'};let _0x1e6b57=!![];return function(_0x3eb22a,_0x4dd314){const _0x3fca53=_0x3e444b,_0xe9cf5={'ueRrL':function(_0x2132c1,_0x3fb5b8){const _0x319a94=_0x6f12;return _0x53b4ee[_0x319a94(0x26e)](_0x2132c1,_0x3fb5b8);},'ogvnQ':_0x53b4ee[_0x3fca53(0x193)],'iSSFj':_0x53b4ee[_0x3fca53(0x1fc)],'NbRRG':_0x53b4ee[_0x3fca53(0x17a)]};if(_0x53b4ee[_0x3fca53(0x1d1)](_0x53b4ee[_0x3fca53(0x1ab)],_0x53b4ee[_0x3fca53(0x1b1)])){const _0x20d5b6=_0x1e6b57?function(){const _0x28164f=_0x3fca53,_0x417ebd={'AkKUt':_0x53b4ee[_0x28164f(0x1ff)]};if(_0x53b4ee[_0x28164f(0x1d1)](_0x53b4ee[_0x28164f(0x227)],_0x53b4ee['UEtYr']))_0x53cba7[_0x28164f(0x259)]();else{if(_0x4dd314){if(_0x53b4ee['UhItT'](_0x53b4ee[_0x28164f(0x162)],_0x53b4ee[_0x28164f(0x1b9)])){const _0x564cc5=_0x4dd314[_0x28164f(0x26b)](_0x3eb22a,arguments);return _0x4dd314=null,_0x564cc5;}else return _0xd56d27['log'](_0x3b90f4),_0x1aa403[_0x28164f(0x11b)](_0x3e5d4e[_0x28164f(0x183)]({'isSearch':!0x1,'class':_0x417ebd[_0x28164f(0x1aa)],'msg':_0x2040ae[_0x28164f(0x244)]}));}}}:function(){};return _0x1e6b57=![],_0x20d5b6;}else(function(){return!![];}[_0x3fca53(0x242)](_0xe9cf5[_0x3fca53(0x11d)](_0xe9cf5[_0x3fca53(0x12e)],_0xe9cf5[_0x3fca53(0x22f)]))[_0x3fca53(0x1b5)](_0xe9cf5['NbRRG']));};}()),_0x4221ef=_0x4cee25(this,function(){const _0x5789e4=_0x6f12,_0x3b0288={'PdSpm':function(_0x557029,_0x2911e1){return _0x557029(_0x2911e1);},'kwYzL':function(_0x437bb2,_0x4c2ff3){return _0x437bb2!==_0x4c2ff3;},'VaaDy':_0x5789e4(0x1a6),'BLYfL':function(_0x2cc40c,_0x59fc67){return _0x2cc40c+_0x59fc67;},'WfDuh':'return\x20(function()\x20','ypqRz':_0x5789e4(0x148),'nvDXm':function(_0x206b17){return _0x206b17();},'FHMpT':function(_0x4afb8c,_0xdad11e){return _0x4afb8c!==_0xdad11e;},'PKLJq':_0x5789e4(0x203),'ZjoFx':_0x5789e4(0x18f),'JBJgj':_0x5789e4(0x289),'NeXCQ':_0x5789e4(0x1e8),'yNlHX':_0x5789e4(0x128),'XJnJH':_0x5789e4(0x153),'Swzbl':'table','pKGJN':_0x5789e4(0x291),'rTmuc':function(_0x402be3,_0x1cd7f2){return _0x402be3<_0x1cd7f2;},'difqC':'EgoFr'};let _0x136d0a;try{if(_0x3b0288['kwYzL'](_0x3b0288[_0x5789e4(0x167)],_0x3b0288[_0x5789e4(0x167)]))_0x3b0288[_0x5789e4(0x1c4)](_0x551eb3,0x0);else{const _0xf7e659=_0x3b0288[_0x5789e4(0x1c4)](Function,_0x3b0288[_0x5789e4(0x182)](_0x3b0288[_0x5789e4(0x182)](_0x3b0288[_0x5789e4(0x149)],_0x3b0288[_0x5789e4(0x142)]),');'));_0x136d0a=_0x3b0288[_0x5789e4(0x1cc)](_0xf7e659);}}catch(_0x226a8c){if(_0x3b0288['FHMpT'](_0x3b0288[_0x5789e4(0x1c9)],_0x3b0288[_0x5789e4(0x1c9)])){const _0x58e126=_0x23605b[_0x5789e4(0x26b)](_0x5f4ba9,arguments);return _0x5aeff6=null,_0x58e126;}else _0x136d0a=window;}const _0x28232c=_0x136d0a['console']=_0x136d0a[_0x5789e4(0x201)]||{},_0x4fe4a1=[_0x3b0288[_0x5789e4(0x276)],_0x3b0288['JBJgj'],_0x3b0288[_0x5789e4(0x264)],_0x3b0288[_0x5789e4(0x1c3)],_0x3b0288[_0x5789e4(0x195)],_0x3b0288[_0x5789e4(0x283)],_0x3b0288['pKGJN']];for(let _0x4587ae=0x0;_0x3b0288['rTmuc'](_0x4587ae,_0x4fe4a1[_0x5789e4(0x19f)]);_0x4587ae++){if(_0x3b0288[_0x5789e4(0x232)](_0x3b0288[_0x5789e4(0x133)],_0x3b0288[_0x5789e4(0x133)])){const _0x2908e2=_0x428180['apply'](_0x33b2d2,arguments);return _0x38ccaf=null,_0x2908e2;}else{const _0x3afbdd=_0x4cee25[_0x5789e4(0x242)]['prototype'][_0x5789e4(0x12c)](_0x4cee25),_0x4f448a=_0x4fe4a1[_0x4587ae],_0x3ba3ba=_0x28232c[_0x4f448a]||_0x3afbdd;_0x3afbdd[_0x5789e4(0x1a3)]=_0x4cee25[_0x5789e4(0x12c)](_0x4cee25),_0x3afbdd['toString']=_0x3ba3ba['toString'][_0x5789e4(0x12c)](_0x3ba3ba),_0x28232c[_0x4f448a]=_0x3afbdd;}}});_0x4221ef();import _0x5754fa from'express';const b=_0x5754fa[_0x2ff5de(0x152)]();import _0x140824 from'path';import{MongoClient as _0x155409}from'mongodb';import _0x500c0f from'../middleware/mainAuth.js';import*as _0x540333 from'../mymodule/myUsers.js';import*as _0x414ac3 from'../mymodule/myDateTime.js';import*as _0x492ea9 from'../mymodule/myModule.js';import*as _0x1b51ea from'../mymodule/myDocMain.js';import*as _0x758baa from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0x2ff5de(0x26c)],p=global[_0x2ff5de(0x1e2)],M=[w+_0x2ff5de(0x16e),S+_0x2ff5de(0x16e),p+_0x2ff5de(0x16e)],v=[w+'/print',S+_0x2ff5de(0x252),p+'/print'],k=[w+_0x2ff5de(0x1a0),S+'/status',p+_0x2ff5de(0x1a0)],B=[w+_0x2ff5de(0x14c),S+_0x2ff5de(0x14c),p+_0x2ff5de(0x14c)],x=[w+'/load',S+'/load',p+_0x2ff5de(0x24b),w+_0x2ff5de(0x146),S+'/load-last',p+_0x2ff5de(0x146)],L=[w+'/fetch/modal',S+_0x2ff5de(0x120),p+'/fetch/modal'];b[_0x2ff5de(0x24f)](L,_0x500c0f[_0x2ff5de(0x12f)],async(_0x3caf3c,_0x10e27d)=>{const _0x20c414=_0x2ff5de,_0xbc2b4f={'BBiPc':_0x20c414(0x13b),'JKbiA':function(_0x2f7a5d,_0x3e2d7a){return _0x2f7a5d!==_0x3e2d7a;},'PGSfc':_0x20c414(0x19c),'THuwS':_0x20c414(0x1cf),'AuQYF':function(_0x4ec408,_0x530979){return _0x4ec408==_0x530979;},'fNWPh':_0x20c414(0x27b),'igWpJ':_0x20c414(0x27c),'jAbWl':function(_0x42e051,_0x35d59f){return _0x42e051==_0x35d59f;},'QzEPz':_0x20c414(0x1c6),'XwsMu':_0x20c414(0x1f2),'uCdJf':_0x20c414(0x1e5),'gwcVR':_0x20c414(0x23d),'TOOBL':_0x20c414(0x1ee),'RsBWy':function(_0x5b1c3f,_0x3f65ca){return _0x5b1c3f===_0x3f65ca;},'bLYBf':_0x20c414(0x28a),'VWmAx':_0x20c414(0x22a)},_0x3d7eb2=await _0x540333[_0x20c414(0x22b)](_0x3caf3c),_0x25f412=await _0x1b51ea[_0x20c414(0x1f7)](_0x3caf3c,_0x10e27d,_0x3d7eb2[_0x20c414(0x125)]);try{if(_0xbc2b4f['JKbiA'](_0xbc2b4f[_0x20c414(0x1ca)],_0xbc2b4f['THuwS'])){if(_0xbc2b4f[_0x20c414(0x23a)](_0x25f412[_0x20c414(0x1c5)],_0xbc2b4f['fNWPh']))var _0x85a826=await _0x758baa[_0x20c414(0x200)](_0xbc2b4f[_0x20c414(0x231)]);else{if(_0xbc2b4f[_0x20c414(0x218)](_0x25f412[_0x20c414(0x1c5)],_0xbc2b4f['QzEPz']))var _0x85a826=await _0x758baa[_0x20c414(0x200)](_0xbc2b4f['igWpJ']);else{if(_0xbc2b4f[_0x20c414(0x218)](_0x25f412[_0x20c414(0x1c5)],_0xbc2b4f[_0x20c414(0x298)]))var _0x85a826=await _0x758baa[_0x20c414(0x200)](_0xbc2b4f[_0x20c414(0x187)]);}}const _0x9338aa=await _0x758baa['getItemsCategory']();return _0x10e27d[_0x20c414(0x11b)](JSON[_0x20c414(0x183)]({'DATA_ITEMS':_0x85a826,'DATA_CATEGORY':_0x9338aa,'isFetch':!0x0,'class':_0xbc2b4f['gwcVR'],'msg':_0xbc2b4f[_0x20c414(0x297)]}));}else _0x5894c9[_0x20c414(0x259)]();}catch(_0x450a32){return _0xbc2b4f['RsBWy'](_0xbc2b4f[_0x20c414(0x1bc)],_0xbc2b4f['VWmAx'])?(_0x8b1132[_0x20c414(0x18f)](_0x354bba),_0x58f51c[_0x20c414(0x11b)](_0x592597[_0x20c414(0x183)]({'isFetch':!0x1,'class':_0xbc2b4f[_0x20c414(0x22e)],'msg':_0x583b0d[_0x20c414(0x244)]}))):(console[_0x20c414(0x18f)](_0x450a32),_0x10e27d[_0x20c414(0x11b)](JSON['stringify']({'isFetch':!0x1,'class':_0xbc2b4f[_0x20c414(0x22e)],'msg':_0x450a32[_0x20c414(0x244)]})));}}),b[_0x2ff5de(0x24e)](B,_0x500c0f[_0x2ff5de(0x12f)],async(_0x286aa6,_0xe76fba)=>{const _0x41dc7a=_0x2ff5de,_0x19c6e8={'WpyaS':_0x41dc7a(0x13b),'yVuKB':_0x41dc7a(0x294),'NxLPa':function(_0x338791,_0x14c6de){return _0x338791<_0x14c6de;},'OOcUj':_0x41dc7a(0x207),'gBjLw':_0x41dc7a(0x198),'czoWV':function(_0x280cd5,_0x572b3d){return _0x280cd5!==_0x572b3d;},'IzlAO':_0x41dc7a(0x16b),'kPFBl':'IrALl','MGPIf':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','tNUJd':function(_0x80e01b,_0x594bd9){return _0x80e01b+_0x594bd9;},'itfcN':_0x41dc7a(0x23d),'SdGwj':function(_0x274797,_0x37d001){return _0x274797===_0x37d001;},'uhugj':_0x41dc7a(0x173),'SELis':function(_0x4f7714,_0x45ce34){return _0x4f7714===_0x45ce34;},'zPUwQ':_0x41dc7a(0x266),'uqMTh':_0x41dc7a(0x25b)};let {sip:_0xc712d8}=_0x286aa6[_0x41dc7a(0x256)];if(!_0xc712d8&&_0x19c6e8['NxLPa'](_0xc712d8[_0x41dc7a(0x19f)],0x2))return _0xe76fba[_0x41dc7a(0x11b)](JSON['stringify']({'isSearch':!0x1,'class':_0x19c6e8[_0x41dc7a(0x241)],'msg':_0x19c6e8[_0x41dc7a(0x14b)]}));_0xc712d8=_0xc712d8[_0x41dc7a(0x25e)](/[!@#$%^&*<>]/g,'')??null;const _0x46c490=await _0x540333[_0x41dc7a(0x22b)](_0x286aa6);await _0x1b51ea['getMainDocPathObj'](_0x286aa6,_0xe76fba,_0x46c490[_0x41dc7a(0x125)]);const {collectionName:_0x200bb6}=_0x758baa['get_Info_ByUrl'](_0x286aa6[_0x41dc7a(0x247)]),_0x1eafd7=new _0x155409(global[_0x41dc7a(0x228)]);try{if(_0x19c6e8[_0x41dc7a(0x1f4)](_0x19c6e8[_0x41dc7a(0x1d4)],_0x19c6e8['kPFBl'])){await _0x1eafd7[_0x41dc7a(0x268)]();const _0x57cf36=_0x1eafd7['db'](global[_0x41dc7a(0x281)])[_0x41dc7a(0x274)](_0x200bb6),_0x238f49=[{'$or':[{'docId':{'$regex':_0xc712d8,'$options':'i'}},{'docDate':{'$regex':_0xc712d8,'$options':'i'}}]}];let _0x25f3f6='';['O','S']['includes'](_0x46c490[_0x41dc7a(0x125)])||(_0x25f3f6+=_0x19c6e8[_0x41dc7a(0x136)],_0x238f49[_0x41dc7a(0x26f)]({'userId':_0x46c490['userId']}));const _0x22cec0=await _0x57cf36[_0x41dc7a(0x217)]([{'$match':{'$and':_0x238f49}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x41dc7a(0x18a)]();return _0x25f3f6=_0x19c6e8[_0x41dc7a(0x1b0)](_0x41dc7a(0x16a)+_0x22cec0[_0x41dc7a(0x19f)]+'\x22\x20เอกสาร',_0x25f3f6),_0xe76fba['send'](JSON['stringify']({'searchFound':_0x22cec0,'msg':_0x25f3f6,'isSearch':!0x0,'class':_0x19c6e8[_0x41dc7a(0x243)]}));}else return _0xe71143[_0x41dc7a(0x18f)](_0x253562),_0xfe82d3[_0x41dc7a(0x11b)](_0x3217f4[_0x41dc7a(0x183)]({'isLoad':!0x1,'class':_0x19c6e8[_0x41dc7a(0x118)],'msg':_0x253160[_0x41dc7a(0x244)]}));}catch(_0x147230){if(_0x19c6e8[_0x41dc7a(0x29c)](_0x19c6e8[_0x41dc7a(0x138)],_0x19c6e8[_0x41dc7a(0x138)]))return console[_0x41dc7a(0x18f)](_0x147230),_0xe76fba[_0x41dc7a(0x11b)](JSON['stringify']({'isSearch':!0x1,'class':_0x19c6e8[_0x41dc7a(0x118)],'msg':_0x147230[_0x41dc7a(0x244)]}));else{const _0x357916=_0x1d3ab3?function(){const _0x42bdd9=_0x41dc7a;if(_0x55c279){const _0x5ee117=_0xc6310e[_0x42bdd9(0x26b)](_0x923d1b,arguments);return _0x1d2ff5=null,_0x5ee117;}}:function(){};return _0x36d17b=![],_0x357916;}}finally{_0x19c6e8[_0x41dc7a(0x1ce)](_0x19c6e8[_0x41dc7a(0x1df)],_0x19c6e8[_0x41dc7a(0x15f)])?(_0x40a16b[_0x41dc7a(0x18f)](_0x19c6e8[_0x41dc7a(0x1d6)],_0x4ebd02),_0x1f01a9[_0x41dc7a(0x11b)](_0x4eb8cf[_0x41dc7a(0x183)]({'isPrint':!0x1,'class':_0x19c6e8[_0x41dc7a(0x118)],'msg':_0x29efe3[_0x41dc7a(0x244)]}))):_0x1eafd7[_0x41dc7a(0x259)]();}}),b['post'](x,_0x500c0f[_0x2ff5de(0x12f)],async(_0x117e6a,_0xb19082)=>{const _0x2a1bd6=_0x2ff5de,_0x18647c={'almzz':_0x2a1bd6(0x174),'WwQCB':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','lvfRT':function(_0x20629e,_0x33def1){return _0x20629e(_0x33def1);},'mqtuY':'init','pfUsJ':function(_0xdd2c05,_0xeb65f1){return _0xdd2c05+_0xeb65f1;},'oJRYc':_0x2a1bd6(0x1ba),'LRRiL':function(_0x3b7fdc,_0x3b5446){return _0x3b7fdc+_0x3b5446;},'uRmDa':_0x2a1bd6(0x19d),'FPvmY':function(_0x4ae038,_0x1defc4){return _0x4ae038(_0x1defc4);},'QPlNz':function(_0x2b4e93){return _0x2b4e93();},'uAMme':_0x2a1bd6(0x20a),'ERluw':'counter','lApNK':function(_0x1d25d7,_0x949ea5){return _0x1d25d7!==_0x949ea5;},'FkTtV':_0x2a1bd6(0x1e1),'TkFVW':_0x2a1bd6(0x1e6),'sfXDv':function(_0x64b021,_0x5c57e2){return _0x64b021===_0x5c57e2;},'FkrMq':'load','tYGpO':_0x2a1bd6(0x271),'boTvn':_0x2a1bd6(0x211),'PgRER':'load-last','jQTeR':_0x2a1bd6(0x1ef),'NvaxZ':_0x2a1bd6(0x13b),'hlPGD':function(_0x130310,_0x4e344a){return _0x130310==_0x4e344a;},'cDayP':function(_0x3f59c3,_0x4ba76d){return _0x3f59c3!==_0x4ba76d;},'tVmEY':_0x2a1bd6(0x157),'CEAuy':_0x2a1bd6(0x1a2),'eEHbH':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','JpJwx':function(_0x4202ce,_0x162e14){return _0x4202ce!==_0x162e14;},'MOmjn':_0x2a1bd6(0x160),'HkxdZ':_0x2a1bd6(0x16f),'APjMg':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','OlgcV':'green','kKNtD':function(_0x4c45bd,_0x35d66d){return _0x4c45bd!==_0x35d66d;},'RVAis':_0x2a1bd6(0x181),'SZNkt':_0x2a1bd6(0x18e),'jjaky':function(_0x4642c9,_0x811ab1){return _0x4642c9!==_0x811ab1;},'aJwpc':_0x2a1bd6(0x1ec)};let {docId:_0x2b1cda,action:_0x3abb54}=_0x117e6a[_0x2a1bd6(0x256)];const _0x44d03c=await _0x540333[_0x2a1bd6(0x22b)](_0x117e6a);await _0x1b51ea['getMainDocPathObj'](_0x117e6a,_0xb19082,_0x44d03c['userAuthority']);const {collectionName:_0x101149}=_0x758baa[_0x2a1bd6(0x224)](_0x117e6a['originalUrl']),_0xa2bed3=new _0x155409(global[_0x2a1bd6(0x228)]);try{if(_0x18647c[_0x2a1bd6(0x17d)](_0x18647c['FkTtV'],_0x18647c[_0x2a1bd6(0x1cd)])){await _0xa2bed3[_0x2a1bd6(0x268)]();const _0x3c1dfc=_0xa2bed3['db'](global['dbName'])[_0x2a1bd6(0x274)](_0x101149);if(_0x18647c[_0x2a1bd6(0x269)](_0x3abb54,_0x18647c[_0x2a1bd6(0x17b)])){if(_0x18647c[_0x2a1bd6(0x269)](_0x18647c[_0x2a1bd6(0x1b3)],_0x18647c[_0x2a1bd6(0x233)])){const _0x291ca1=new _0x4e8d06(BaKXJn[_0x2a1bd6(0x20e)]),_0x1ca2b4=new _0x3d9308(BaKXJn[_0x2a1bd6(0x21a)],'i'),_0x17c49c=BaKXJn[_0x2a1bd6(0x215)](_0x4fd26a,BaKXJn[_0x2a1bd6(0x230)]);!_0x291ca1['test'](BaKXJn['pfUsJ'](_0x17c49c,BaKXJn['oJRYc']))||!_0x1ca2b4[_0x2a1bd6(0x27a)](BaKXJn['LRRiL'](_0x17c49c,BaKXJn[_0x2a1bd6(0x1eb)]))?BaKXJn[_0x2a1bd6(0x196)](_0x17c49c,'0'):BaKXJn[_0x2a1bd6(0x237)](_0x2ec415);}else{const _0x5bd308=['O','S']['includes'](_0x44d03c[_0x2a1bd6(0x125)])?{'docId':_0x2b1cda}:{'docId':_0x2b1cda,'userId':_0x44d03c['userId']};var _0xddb259=await _0x3c1dfc['findOne'](_0x5bd308,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x18647c[_0x2a1bd6(0x269)](_0x3abb54,_0x18647c['PgRER']))var _0xddb259=await _0x3c1dfc[_0x2a1bd6(0x22d)]({'userId':_0x44d03c['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x8f11f9=_0xddb259?'':_0x18647c[_0x2a1bd6(0x269)](_0x3abb54,_0x18647c[_0x2a1bd6(0x17b)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x2b1cda+'\x22':_0x18647c[_0x2a1bd6(0x248)];if(!_0xddb259)return _0xb19082['send'](JSON[_0x2a1bd6(0x183)]({'isLoad':!0x1,'class':_0x18647c[_0x2a1bd6(0x1ac)],'msg':_0x8f11f9}));let _0x4dcc32=_0x2a1bd6(0x223)+_0xddb259[_0x2a1bd6(0x1e3)]+_0x2a1bd6(0x18d);if(_0x18647c[_0x2a1bd6(0x292)](_0xddb259[_0x2a1bd6(0x1ae)],0x1)&&_0xddb259[_0x2a1bd6(0x1a8)]){if(_0x18647c['cDayP'](_0x18647c['tVmEY'],_0x18647c[_0x2a1bd6(0x225)])){let _0xa1592a=await _0x758baa[_0x2a1bd6(0x1a7)](_0xddb259,_0x101149,_0x44d03c[_0x2a1bd6(0x1d8)]);_0xddb259[_0x2a1bd6(0x155)]=_0xa1592a[_0x2a1bd6(0x155)],_0x18647c[_0x2a1bd6(0x292)](_0xa1592a[_0x2a1bd6(0x141)],!0x1)&&(_0xddb259[_0x2a1bd6(0x1ae)]=_0xa1592a[_0x2a1bd6(0x1ae)],_0x4dcc32+=_0x18647c[_0x2a1bd6(0x262)]);}else _0x48907a['close']();}else _0xddb259[_0x2a1bd6(0x155)]='-';if((_0x18647c[_0x2a1bd6(0x292)](_0xddb259['docStatusNumber'],0x1)||_0x18647c[_0x2a1bd6(0x292)](_0xddb259['docStatusNumber'],0x2))&&_0xddb259['dateTimeCanCancel']){if(_0x18647c['JpJwx'](_0x18647c['MOmjn'],_0x18647c[_0x2a1bd6(0x1fe)])){const _0x1020c1=await _0x758baa[_0x2a1bd6(0x15c)](_0xddb259,_0x101149,_0x44d03c[_0x2a1bd6(0x1d8)]);_0xddb259[_0x2a1bd6(0x209)]=_0x1020c1[_0x2a1bd6(0x209)],_0x18647c[_0x2a1bd6(0x292)](_0x1020c1['canCancel'],!0x1)&&(_0x4dcc32+=_0x18647c[_0x2a1bd6(0x1c1)]);}else{if(_0x59ec81){const _0x4f45ab=_0x330b4e[_0x2a1bd6(0x26b)](_0x43da1d,arguments);return _0x2eb5c2=null,_0x4f45ab;}}}else _0xddb259['dateTimeCancelRemain']='-';const {branchName:_0x11b52f}=await _0x758baa[_0x2a1bd6(0x239)](_0xddb259['branchId']);return _0xddb259[_0x2a1bd6(0x21f)]=_0x11b52f,_0xb19082['send'](JSON['stringify']({'doc':_0xddb259,'isLoad':!0x0,'class':_0x18647c[_0x2a1bd6(0x1f6)],'msg':_0x4dcc32}));}else return function(_0x4f63a7){}[_0x2a1bd6(0x242)](BaKXJn[_0x2a1bd6(0x1f5)])['apply'](BaKXJn['ERluw']);}catch(_0x4d4811){if(_0x18647c[_0x2a1bd6(0x277)](_0x18647c[_0x2a1bd6(0x2a0)],_0x18647c['SZNkt']))return console['log'](_0x4d4811),_0xb19082[_0x2a1bd6(0x11b)](JSON['stringify']({'isLoad':!0x1,'class':_0x18647c[_0x2a1bd6(0x1ac)],'msg':_0x4d4811[_0x2a1bd6(0x244)]}));else BaKXJn[_0x2a1bd6(0x215)](_0xe72001,'0');}finally{if(_0x18647c['jjaky'](_0x18647c['aJwpc'],_0x18647c[_0x2a1bd6(0x121)])){const _0x4de426=_0xd37a71?function(){if(_0x4d7185){const _0x448c19=_0x1161cd['apply'](_0x3b0681,arguments);return _0x434b17=null,_0x448c19;}}:function(){};return _0x5d940e=![],_0x4de426;}else _0xa2bed3['close']();}}),b[_0x2ff5de(0x24e)](M,_0x500c0f[_0x2ff5de(0x12f)],async(_0x379107,_0x4f4167)=>{const _0x756932=_0x2ff5de,_0x26ec5e={'iSsuF':function(_0x28727e){return _0x28727e();},'JscqN':function(_0x39b9dd,_0x4a091c){return _0x39b9dd(_0x4a091c);},'jFgSj':function(_0x2e4f66,_0x30d6fa){return _0x2e4f66+_0x30d6fa;},'jQiwJ':function(_0x36de44,_0xf1ec87){return _0x36de44+_0xf1ec87;},'HxZIn':_0x756932(0x20b),'FSWRs':_0x756932(0x148),'lkOlS':function(_0x3ad2c2,_0x39fcdf){return _0x3ad2c2===_0x39fcdf;},'JfYDP':_0x756932(0x249),'bhUBt':_0x756932(0x13b),'lFZGi':function(_0x3213d8,_0x444e28){return _0x3213d8<_0x444e28;},'deMbt':_0x756932(0x207),'qwhAs':_0x756932(0x25d),'vuFHo':_0x756932(0x19a),'NLbRC':_0x756932(0x23d),'MnuWC':function(_0x4bb37e,_0x4d77be){return _0x4bb37e===_0x4d77be;},'GmYUK':'IVEmu','WessS':_0x756932(0x294),'qyXsd':function(_0x39e722,_0x4bd953){return _0x39e722!==_0x4bd953;},'ahSLb':'ZShkP'},{docId:_0x59ddad}=_0x379107[_0x756932(0x256)],_0x34cfca=await _0x540333['getUserData'](_0x379107);await _0x1b51ea['getMainDocPathObj'](_0x379107,_0x4f4167,_0x34cfca[_0x756932(0x125)]);const {collectionName:_0x3e899d}=_0x758baa['get_Info_ByUrl'](_0x379107[_0x756932(0x247)]),_0x478a1e=new _0x155409(global[_0x756932(0x228)]);try{if(_0x26ec5e['lkOlS'](_0x26ec5e[_0x756932(0x1d0)],_0x26ec5e[_0x756932(0x1d0)])){await _0x478a1e[_0x756932(0x268)]();var _0x4eacdd=await _0x478a1e['db'](global[_0x756932(0x281)])['collection'](_0x3e899d)[_0x756932(0x22d)]({'docId':_0x59ddad});if(!_0x4eacdd)return _0x4f4167[_0x756932(0x11b)](JSON[_0x756932(0x183)]({'isPrint':!0x1,'class':_0x26ec5e[_0x756932(0x1fd)],'msg':_0x756932(0x1dd)+_0x59ddad+'\x22'}));const _0x608ffc=_0x4eacdd[_0x756932(0x179)]||[];if(_0x26ec5e[_0x756932(0x204)](_0x608ffc[_0x756932(0x19f)],0x1))return _0x4f4167[_0x756932(0x11b)](JSON[_0x756932(0x183)]({'isPrint':!0x1,'class':_0x26ec5e[_0x756932(0x188)],'msg':_0x26ec5e['qwhAs']}));const _0x2b0f6a=_0x140824['join'](folderForms,_0x26ec5e[_0x756932(0x29f)]),_0x390428=await _0x492ea9[_0x756932(0x17e)](_0x2b0f6a,_0x4f4167,{'title':_0x4eacdd['docId'],'time':_0x414ac3[_0x756932(0x226)](new Date()),'changesHistory':_0x608ffc});_0x4f4167[_0x756932(0x11b)](JSON[_0x756932(0x183)]({'isPrint':!0x0,'class':_0x26ec5e[_0x756932(0x235)],'htmlPage':_0x390428}));}else return![];}catch(_0x15dfe4){_0x26ec5e[_0x756932(0x20c)](_0x26ec5e[_0x756932(0x1f0)],_0x26ec5e[_0x756932(0x1f0)])?(console[_0x756932(0x18f)](_0x26ec5e[_0x756932(0x285)],_0x15dfe4),_0x4f4167[_0x756932(0x11b)](JSON[_0x756932(0x183)]({'isPrint':!0x1,'class':_0x26ec5e[_0x756932(0x1fd)],'msg':_0x15dfe4[_0x756932(0x244)]}))):CwCJIE['iSsuF'](_0x2c2348);}finally{if(_0x26ec5e[_0x756932(0x15d)](_0x26ec5e[_0x756932(0x24c)],_0x26ec5e['ahSLb'])){const _0x289f9b=CwCJIE[_0x756932(0x260)](_0x2f6f6d,CwCJIE[_0x756932(0x191)](CwCJIE[_0x756932(0x28b)](CwCJIE['HxZIn'],CwCJIE[_0x756932(0x12b)]),');'));_0x39ccf0=CwCJIE[_0x756932(0x13e)](_0x289f9b);}else _0x478a1e['close']();}}),b['post'](v,_0x500c0f[_0x2ff5de(0x12f)],async(_0x5f01fb,_0x267821)=>{const _0x5c73e9=_0x2ff5de,_0x249930={'wLvPO':function(_0x1e4722,_0xd40561){return _0x1e4722!==_0xd40561;},'HjLdH':_0x5c73e9(0x1a9),'WPUuJ':'function\x20*\x5c(\x20*\x5c)','UfmdO':_0x5c73e9(0x13a),'kjVcd':function(_0x334398,_0x14cedf){return _0x334398(_0x14cedf);},'ShXLk':_0x5c73e9(0x29a),'lbPME':function(_0x5272a1,_0x149b32){return _0x5272a1+_0x149b32;},'xvBIJ':_0x5c73e9(0x1ba),'nOSGE':function(_0x1ef64c,_0x5d5abe){return _0x1ef64c+_0x5d5abe;},'dDiqm':'input','TPBgh':function(_0xf28f66,_0x488e14){return _0xf28f66(_0x488e14);},'FyLqY':function(_0x47110b){return _0x47110b();},'CUmKD':function(_0x190be5,_0x22372e,_0x302f49){return _0x190be5(_0x22372e,_0x302f49);},'QPDEC':_0x5c73e9(0x154),'ZLWZJ':'RuSZv','BHKSl':_0x5c73e9(0x13b),'GUQTu':'doc_print.ejs','yiDtC':function(_0xc0974a,_0x1aaedc){return _0xc0974a==_0x1aaedc;},'oAOwS':_0x5c73e9(0x185),'iwwqM':_0x5c73e9(0x23d),'uLhZN':function(_0x3d54c9,_0x166a66){return _0x3d54c9==_0x166a66;},'gJWSY':_0x5c73e9(0x240),'pFdYd':function(_0x46bc6c,_0x4a351d){return _0x46bc6c===_0x4a351d;},'NspgB':'xjtbn','WKIRH':_0x5c73e9(0x208),'Gwyml':_0x5c73e9(0x127),'aCCIb':function(_0x356ed8,_0x3cb74c){return _0x356ed8*_0x3cb74c;},'oTgrz':function(_0x3da2aa,_0x2c8999){return _0x3da2aa/_0x2c8999;},'xwlnH':_0x5c73e9(0x163),'cJSKr':_0x5c73e9(0x212),'KGGZf':_0x5c73e9(0x1d5),'KBSDh':_0x5c73e9(0x137),'IIFUv':_0x5c73e9(0x294),'nxrTV':'FNDLX'},{docId:_0x3d18a4,action:_0x112b82}=_0x5f01fb[_0x5c73e9(0x256)],_0x126b9d=await _0x540333['getUserData'](_0x5f01fb);await _0x1b51ea[_0x5c73e9(0x1f7)](_0x5f01fb,_0x267821,_0x126b9d[_0x5c73e9(0x125)]);const {collectionName:_0x567654,docTitle:_0x357101}=_0x758baa[_0x5c73e9(0x224)](_0x5f01fb[_0x5c73e9(0x247)]),_0xef0d35=new _0x155409(global['dbUrl']);try{if(_0x249930[_0x5c73e9(0x139)](_0x249930['QPDEC'],_0x249930[_0x5c73e9(0x186)])){await _0xef0d35[_0x5c73e9(0x268)]();var _0x51d1d0=await _0xef0d35['db'](global['dbName'])[_0x5c73e9(0x274)](_0x567654)[_0x5c73e9(0x22d)]({'docId':_0x3d18a4});if(!_0x51d1d0)return _0x267821[_0x5c73e9(0x11b)](JSON[_0x5c73e9(0x183)]({'isLoad':!0x1,'class':_0x249930[_0x5c73e9(0x229)],'msg':_0x5c73e9(0x1dd)+_0x3d18a4+'\x22'}));_0x51d1d0['docTitle']=_0x357101,_0x51d1d0['statusName']=_0x758baa[_0x5c73e9(0x11e)](_0x51d1d0[_0x5c73e9(0x1ae)]);const _0x59a484=_0x758baa[_0x5c73e9(0x164)](_0x51d1d0),_0x1f9487=_0x140824['join'](folderForms,_0x249930[_0x5c73e9(0x161)]),_0x50d75a=await _0x492ea9[_0x5c73e9(0x17e)](_0x1f9487,_0x267821,{'title':_0x3d18a4,'time':_0x414ac3['formatDate'](new Date()),'action':_0x112b82,'doc':_0x59a484});if(_0x249930[_0x5c73e9(0x1f8)](_0x112b82,_0x249930[_0x5c73e9(0x159)]))_0x267821[_0x5c73e9(0x11b)](JSON[_0x5c73e9(0x183)]({'isPrint':!0x0,'class':_0x249930['iwwqM'],'htmlPage':_0x50d75a}));else{if(_0x249930[_0x5c73e9(0x165)](_0x112b82,_0x249930['gJWSY'])){if(_0x249930[_0x5c73e9(0x1bb)](_0x249930[_0x5c73e9(0x18c)],_0x249930['NspgB'])){const _0x2317a9=await(await import(_0x249930['WKIRH']))['launch'](),_0x32f3fa=await _0x2317a9[_0x5c73e9(0x265)]();await _0x32f3fa[_0x5c73e9(0x1e4)](_0x50d75a,{'waitUntil':_0x249930[_0x5c73e9(0x1fb)],'timeout':0x2710}),await new Promise(_0x4bd37c=>setTimeout(_0x4bd37c,0x3e8));const _0x167fca=Math[_0x5c73e9(0x234)](_0x249930[_0x5c73e9(0x272)](_0x249930['oTgrz'](0x50,25.4),0x60));await _0x32f3fa[_0x5c73e9(0x199)]({'width':_0x167fca,'height':0x258,'deviceScaleFactor':0x1});const _0x5bb45f=await _0x32f3fa[_0x5c73e9(0x189)](()=>{const _0x43e813=_0x5c73e9;if(_0x249930[_0x43e813(0x139)](_0x249930[_0x43e813(0x25a)],_0x249930[_0x43e813(0x25a)]))_0xa5f816=_0x54a19a;else{const _0x3886fc=document[_0x43e813(0x256)],_0x289a50=document[_0x43e813(0x122)];return Math[_0x43e813(0x140)](_0x3886fc[_0x43e813(0x1ea)],_0x3886fc[_0x43e813(0x14e)],_0x289a50['clientHeight'],_0x289a50['scrollHeight'],_0x289a50['offsetHeight']);}}),_0x524c6e=await _0x32f3fa[_0x5c73e9(0x13d)]({'type':_0x249930['xwlnH'],'clip':{'x':0x0,'y':0x0,'width':_0x167fca,'height':_0x5bb45f},'omitBackground':!0x1});await _0x2317a9[_0x5c73e9(0x259)]();const _0x63e12=_0x51d1d0[_0x5c73e9(0x1e3)][_0x5c73e9(0x25e)](/\//g,'');_0x267821[_0x5c73e9(0x210)](0xc8,{'Content-Type':_0x249930[_0x5c73e9(0x1bf)],'Content-Disposition':_0x5c73e9(0x19e)+_0x63e12+_0x5c73e9(0x1a1),'Content-Length':_0x524c6e[_0x5c73e9(0x19f)]}),_0x267821['end'](_0x524c6e);}else _0x587b2b[_0x5c73e9(0x259)]();}}}else return _0x4ee9ed;}catch(_0x27e381){if(_0x249930[_0x5c73e9(0x139)](_0x249930[_0x5c73e9(0x222)],_0x249930[_0x5c73e9(0x14a)]))console[_0x5c73e9(0x18f)](_0x249930[_0x5c73e9(0x254)],_0x27e381),_0x267821['send'](JSON[_0x5c73e9(0x183)]({'isPrint':!0x1,'class':_0x249930[_0x5c73e9(0x229)],'msg':_0x27e381[_0x5c73e9(0x244)]}));else{if(_0x66d69f){const _0x9e6cb8=_0x5b0ade[_0x5c73e9(0x26b)](_0x32f0bb,arguments);return _0x484636=null,_0x9e6cb8;}}}finally{_0x249930[_0x5c73e9(0x139)](_0x249930['nxrTV'],_0x249930[_0x5c73e9(0x29b)])?FnMruE[_0x5c73e9(0x246)](_0x339b3c,this,function(){const _0x331202=_0x5c73e9,_0xc3abe2=new _0x5dad0c(FnMruE['WPUuJ']),_0x37d270=new _0x22649d(FnMruE[_0x331202(0x178)],'i'),_0x1b9064=FnMruE['kjVcd'](_0xbfd29d,FnMruE[_0x331202(0x28e)]);!_0xc3abe2[_0x331202(0x27a)](FnMruE['lbPME'](_0x1b9064,FnMruE[_0x331202(0x275)]))||!_0x37d270[_0x331202(0x27a)](FnMruE[_0x331202(0x1c8)](_0x1b9064,FnMruE[_0x331202(0x25f)]))?FnMruE[_0x331202(0x15b)](_0x1b9064,'0'):FnMruE['FyLqY'](_0x21831f);})():_0xef0d35['close']();}}),b[_0x2ff5de(0x24e)](k,_0x500c0f['isAuth'],async(_0x12bf6a,_0x5e431a)=>{const _0x1a25c4=_0x2ff5de,_0x53a51f={'Xrdvd':function(_0x2faedc,_0x53dc49){return _0x2faedc+_0x53dc49;},'aoqBz':_0x1a25c4(0x177),'RIkSW':_0x1a25c4(0x282),'iwHfz':_0x1a25c4(0x24a),'oZmfh':_0x1a25c4(0x294),'sOHgC':_0x1a25c4(0x13b),'QUKvN':function(_0x511114,_0x52d9e0){return _0x511114==_0x52d9e0;},'aIEfv':'cancel','tXKwt':_0x1a25c4(0x166),'MwZqM':'finish','GQXZA':_0x1a25c4(0x17c),'kgipw':function(_0x19f210,_0x3ab527){return _0x19f210===_0x3ab527;},'HiAuT':function(_0x5738c2,_0x1b64b5){return _0x5738c2==_0x1b64b5;},'WVHJC':function(_0x108bf7,_0x5dabef){return _0x108bf7==_0x5dabef;},'VseCs':_0x1a25c4(0x11a),'JHEjI':function(_0x22f912,_0x5a106e){return _0x22f912===_0x5a106e;},'hnHjk':_0x1a25c4(0x280),'jfcmc':function(_0x13e4ed,_0x8cd91e){return _0x13e4ed==_0x8cd91e;},'XzzcY':function(_0x18460c,_0x424dc8){return _0x18460c!==_0x424dc8;},'MAafL':_0x1a25c4(0x251),'BbdDa':_0x1a25c4(0x175),'jJAoo':function(_0x4e97ee,_0x31765e){return _0x4e97ee==_0x31765e;},'YCAzR':function(_0x1d81a4,_0x3b9adc){return _0x1d81a4>_0x3b9adc;},'LVKqP':function(_0x3c5979,_0x3031cc){return _0x3c5979!==_0x3031cc;},'ZTavu':_0x1a25c4(0x145),'APvtj':_0x1a25c4(0x293),'AvtmJ':function(_0x151897,_0x121cfb){return _0x151897>_0x121cfb;},'jCtYh':_0x1a25c4(0x213),'GUOlR':_0x1a25c4(0x290),'xAIWD':_0x1a25c4(0x261),'oFHEt':_0x1a25c4(0x23d),'oVGvn':function(_0x4e6247,_0x36d526){return _0x4e6247<_0x36d526;},'aNBnU':_0x1a25c4(0x207)},_0x130388=new _0x155409(global[_0x1a25c4(0x228)]);try{const _0x3493db=await _0x540333[_0x1a25c4(0x22b)](_0x12bf6a);await _0x1b51ea[_0x1a25c4(0x1f7)](_0x12bf6a,_0x5e431a,_0x3493db[_0x1a25c4(0x125)]);const {collectionName:_0x39a523}=_0x758baa[_0x1a25c4(0x224)](_0x12bf6a['originalUrl']),{docId:_0xe9936f,action:_0x374b84}=_0x12bf6a[_0x1a25c4(0x256)],_0x29568a=_0x53a51f[_0x1a25c4(0x1d2)](_0x374b84,_0x53a51f[_0x1a25c4(0x1e9)])?_0x53a51f[_0x1a25c4(0x14d)]:_0x53a51f['QUKvN'](_0x374b84,_0x53a51f[_0x1a25c4(0x15a)])?'จบ':'';if(!_0xe9936f||![_0x53a51f[_0x1a25c4(0x15a)],_0x53a51f['aIEfv']][_0x1a25c4(0x18b)](_0x374b84))return _0x5e431a['send'](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':_0x53a51f['GQXZA']}));const _0x5b9eb6={'docId':_0xe9936f,'userId':_0x3493db[_0x1a25c4(0x1d8)]},_0x13932e=_0x130388['db'](global[_0x1a25c4(0x281)])[_0x1a25c4(0x274)](_0x39a523),_0x3607b7=await _0x13932e[_0x1a25c4(0x22d)](_0x5b9eb6);if(!_0x3607b7)return _0x5e431a['send'](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':_0x1a25c4(0x202)+_0xe9936f+_0x1a25c4(0x23c)+_0x29568a+_0x1a25c4(0x258)}));const _0x4b8b83=_0x3607b7['docStatusNumber'];if(_0x53a51f[_0x1a25c4(0x255)](_0x374b84,_0x53a51f[_0x1a25c4(0x1e9)])&&!(_0x53a51f[_0x1a25c4(0x11c)](_0x4b8b83,0x1)||_0x53a51f['WVHJC'](_0x4b8b83,0x2)))return _0x5e431a['send'](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':_0x53a51f[_0x1a25c4(0x1db)]}));if(_0x53a51f[_0x1a25c4(0x1da)](_0x374b84,_0x53a51f[_0x1a25c4(0x15a)])&&_0x53a51f[_0x1a25c4(0x192)](!_0x4b8b83,0x1))return _0x5e431a[_0x1a25c4(0x11b)](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f['sOHgC'],'msg':_0x53a51f[_0x1a25c4(0x150)]}));if(_0x53a51f[_0x1a25c4(0x172)](_0x374b84,_0x53a51f[_0x1a25c4(0x1e9)])){if(_0x53a51f[_0x1a25c4(0x1d3)](_0x53a51f[_0x1a25c4(0x21e)],_0x53a51f[_0x1a25c4(0x14f)])){if(_0x53a51f['jJAoo'](_0x3607b7['canCancel'],!0x1))return _0x5e431a[_0x1a25c4(0x11b)](JSON['stringify']({'isStatus':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':'เอกสาร\x20\x22'+_0xe9936f+_0x1a25c4(0x1a4)}));if(_0x53a51f['WVHJC']((await _0x758baa[_0x1a25c4(0x15c)](_0x3607b7,_0x39a523,_0x3493db[_0x1a25c4(0x1d8)]))[_0x1a25c4(0x29d)],!0x1))return _0x5e431a[_0x1a25c4(0x11b)](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':_0x1a25c4(0x219)+_0xe9936f+_0x1a25c4(0x1a4)}));}else(function(){return![];}[_0x1a25c4(0x242)](OOAzVu[_0x1a25c4(0x194)](OOAzVu[_0x1a25c4(0x20f)],OOAzVu[_0x1a25c4(0x263)]))[_0x1a25c4(0x26b)](OOAzVu[_0x1a25c4(0x288)]));}if(_0x53a51f[_0x1a25c4(0x11c)](_0x374b84,_0x53a51f[_0x1a25c4(0x1e9)]))var _0x121b28=0xa;else{if(_0x53a51f[_0x1a25c4(0x11c)](_0x374b84,_0x53a51f['MwZqM']))var _0x121b28=0x2;}const _0x365351=await _0x13932e['updateOne'](_0x5b9eb6,{'$set':{'docStatusNumber':_0x121b28}});var _0xd60cd0=_0x29568a+'\x20\x22'+_0xe9936f+'\x22\x20เรียบร้อยแล้ว';if(_0x365351['matchedCount']||_0x53a51f['YCAzR'](_0x365351[_0x1a25c4(0x1ad)],0x0)){if(_0x53a51f[_0x1a25c4(0x13c)](_0x53a51f[_0x1a25c4(0x1bd)],_0x53a51f['APvtj'])){const _0x58bbc9=_0x758baa[_0x1a25c4(0x26d)]({'docStatusNumber':_0x4b8b83},{'docStatusNumber':_0x121b28});if(_0x53a51f[_0x1a25c4(0x23b)](_0x58bbc9['length'],0x0)){if(_0x53a51f[_0x1a25c4(0x255)](_0x53a51f[_0x1a25c4(0x156)],_0x53a51f[_0x1a25c4(0x26a)]))_0x1ae680[_0x1a25c4(0x18f)](_0x53a51f[_0x1a25c4(0x126)],_0x9c6eb7),_0x43260f[_0x1a25c4(0x11b)](_0x1e8800['stringify']({'isPrint':!0x1,'class':_0x53a51f[_0x1a25c4(0x16d)],'msg':_0x4e5a2c[_0x1a25c4(0x244)]}));else{const _0x2ad765={'dateTime':_0x414ac3['formatDateTime'](new Date()),'userId':_0x3493db[_0x1a25c4(0x1d8)],'userFullname':_0x3493db['userFullname'],'changes':_0x58bbc9};await _0x13932e[_0x1a25c4(0x245)]({'docId':_0xe9936f},{'$push':{'changesHistory':{'$each':[_0x2ad765],'$position':0x0}}}),_0xd60cd0+=_0x53a51f['xAIWD'];}}return _0x5e431a[_0x1a25c4(0x11b)](JSON['stringify']({'isStatus':!0x0,'docId':_0xe9936f,'docStatusNumber':_0x121b28,'class':_0x53a51f['oFHEt'],'msg':_0xd60cd0}));}else{const _0x512089=_0x5a694b[_0x1a25c4(0x242)]['prototype']['bind'](_0xc351c5),_0x13264e=_0x40220f[_0x10db4c],_0xf43c01=_0x346b64[_0x13264e]||_0x512089;_0x512089['__proto__']=_0x465254[_0x1a25c4(0x12c)](_0x360fca),_0x512089[_0x1a25c4(0x1cb)]=_0xf43c01[_0x1a25c4(0x1cb)][_0x1a25c4(0x12c)](_0xf43c01),_0x26f1c2[_0x13264e]=_0x512089;}}else{if(_0x365351[_0x1a25c4(0x197)]&&_0x53a51f[_0x1a25c4(0x238)](_0x365351[_0x1a25c4(0x1ad)],0x1))return _0x5e431a[_0x1a25c4(0x11b)](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'docId':_0xe9936f,'docStatusNumber':_0x4b8b83,'class':_0x53a51f[_0x1a25c4(0x279)],'msg':'\x22'+_0xe9936f+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x250206){console[_0x1a25c4(0x18f)](_0x250206),_0x5e431a[_0x1a25c4(0x11b)](JSON[_0x1a25c4(0x183)]({'isStatus':!0x1,'class':_0x53a51f['sOHgC'],'msg':_0x250206[_0x1a25c4(0x244)]}));}finally{_0x130388[_0x1a25c4(0x259)]();}});export default b;function _0x131169(_0x558046){const _0x364236=_0x2ff5de,_0x425c62={'DpVcB':function(_0xb2a47e,_0x3d7f1f){return _0xb2a47e===_0x3d7f1f;},'xNPZO':_0x364236(0x17f),'pwURN':'while\x20(true)\x20{}','Kzyth':_0x364236(0x27d),'GYirn':function(_0x232689,_0x6d8683){return _0x232689!==_0x6d8683;},'fTJQt':function(_0x5a21e3,_0x3c38ec){return _0x5a21e3+_0x3c38ec;},'ekiOg':function(_0x2ad7a5,_0x56dcb6){return _0x2ad7a5/_0x56dcb6;},'YrYcX':'length','SITBK':function(_0x26464e,_0x5a0508){return _0x26464e===_0x5a0508;},'rEehi':function(_0x5ed228,_0x4a4412){return _0x5ed228%_0x4a4412;},'OMBBH':function(_0x303278,_0x99765b){return _0x303278+_0x99765b;},'SJGnm':_0x364236(0x177),'CAtHN':_0x364236(0x282),'RWQsY':_0x364236(0x257),'xSeON':function(_0x1cdb7b,_0x40fef6){return _0x1cdb7b+_0x40fef6;},'DQJtx':_0x364236(0x24a),'ZXWoz':function(_0x1f07ae,_0x2f8de7){return _0x1f07ae(_0x2f8de7);},'Wmkgo':function(_0xeb4e6a,_0x1f8cd6){return _0xeb4e6a(_0x1f8cd6);}};function _0x1388be(_0x176077){const _0x158ad0=_0x364236;if(_0x425c62[_0x158ad0(0x132)](typeof _0x176077,_0x425c62['xNPZO']))return function(_0x38536f){}['constructor'](_0x425c62[_0x158ad0(0x123)])[_0x158ad0(0x26b)](_0x425c62['Kzyth']);else _0x425c62[_0x158ad0(0x20d)](_0x425c62['fTJQt']('',_0x425c62[_0x158ad0(0x295)](_0x176077,_0x176077))[_0x425c62[_0x158ad0(0x16c)]],0x1)||_0x425c62[_0x158ad0(0x131)](_0x425c62[_0x158ad0(0x28d)](_0x176077,0x14),0x0)?function(){return!![];}[_0x158ad0(0x242)](_0x425c62[_0x158ad0(0x135)](_0x425c62['SJGnm'],_0x425c62['CAtHN']))[_0x158ad0(0x1b5)](_0x425c62[_0x158ad0(0x1f9)]):function(){return![];}[_0x158ad0(0x242)](_0x425c62[_0x158ad0(0x267)](_0x425c62[_0x158ad0(0x24d)],_0x425c62[_0x158ad0(0x144)]))[_0x158ad0(0x26b)](_0x425c62[_0x158ad0(0x134)]);_0x425c62[_0x158ad0(0x129)](_0x1388be,++_0x176077);}try{if(_0x558046)return _0x1388be;else _0x425c62[_0x364236(0x190)](_0x1388be,0x0);}catch(_0xa9b653){}}