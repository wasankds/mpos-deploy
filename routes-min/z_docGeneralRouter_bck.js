const _0xa0995c=_0x466d;(function(_0x4260aa,_0x29eb7f){const _0x3f7b07=_0x466d,_0x7edf9c=_0x4260aa();while(!![]){try{const _0x5dbf84=-parseInt(_0x3f7b07(0x1f3))/0x1*(-parseInt(_0x3f7b07(0x1c9))/0x2)+parseInt(_0x3f7b07(0x1d9))/0x3*(-parseInt(_0x3f7b07(0x2f1))/0x4)+parseInt(_0x3f7b07(0x312))/0x5*(parseInt(_0x3f7b07(0x2ea))/0x6)+parseInt(_0x3f7b07(0x278))/0x7+-parseInt(_0x3f7b07(0x1e6))/0x8+-parseInt(_0x3f7b07(0x225))/0x9*(parseInt(_0x3f7b07(0x211))/0xa)+parseInt(_0x3f7b07(0x2d7))/0xb;if(_0x5dbf84===_0x29eb7f)break;else _0x7edf9c['push'](_0x7edf9c['shift']());}catch(_0x1ef100){_0x7edf9c['push'](_0x7edf9c['shift']());}}}(_0x47f9,0x4821f));const _0x55bddc=(function(){const _0x9c71c0=_0x466d,_0x3f2bef={'EniGO':function(_0x4bc5df,_0x1710e2){return _0x4bc5df(_0x1710e2);},'LZxpp':_0x9c71c0(0x259),'xsuVg':function(_0x171074,_0x1b18c0){return _0x171074+_0x1b18c0;},'mfAsz':_0x9c71c0(0x2a0),'WtkOz':_0x9c71c0(0x202),'LZysL':'stateObject','XFQNG':function(_0x2f7aa1,_0x5890e2){return _0x2f7aa1===_0x5890e2;},'kJcfu':_0x9c71c0(0x2bb),'surux':_0x9c71c0(0x2b5),'NbSxy':_0x9c71c0(0x2d2)};let _0x17cd6b=!![];return function(_0x22cbbb,_0x1c1d1b){const _0x15a7ef=_0x9c71c0,_0x3f7a48={'EfWXR':_0x3f2bef[_0x15a7ef(0x2bf)],'NqSWY':function(_0xc558be,_0x2bd5e9){const _0x12a64a=_0x15a7ef;return _0x3f2bef[_0x12a64a(0x320)](_0xc558be,_0x2bd5e9);},'glDzm':_0x3f2bef[_0x15a7ef(0x2a8)],'qVnIt':_0x3f2bef['WtkOz'],'eYOsy':_0x3f2bef['LZysL'],'AlREl':function(_0x3aa6fb,_0x498c26){const _0x1caaef=_0x15a7ef;return _0x3f2bef[_0x1caaef(0x2e3)](_0x3aa6fb,_0x498c26);},'btryW':_0x3f2bef['kJcfu'],'vLnst':_0x3f2bef[_0x15a7ef(0x23a)]};if(_0x3f2bef[_0x15a7ef(0x2e3)](_0x3f2bef[_0x15a7ef(0x1ee)],_0x3f2bef[_0x15a7ef(0x1ee)])){const _0x1c7f52=_0x17cd6b?function(){const _0xb505bf=_0x15a7ef,_0x351206={'GDEAB':function(_0x291413,_0x4e4e42){const _0x186088=_0x466d;return _0x3f7a48[_0x186088(0x291)](_0x291413,_0x4e4e42);},'GZNwH':_0x3f7a48[_0xb505bf(0x1f2)],'mOYPU':_0x3f7a48[_0xb505bf(0x2fe)],'pMrsU':_0x3f7a48[_0xb505bf(0x2f2)]};if(_0x3f7a48[_0xb505bf(0x24d)](_0x3f7a48[_0xb505bf(0x223)],_0x3f7a48[_0xb505bf(0x223)])){if(_0x1c1d1b){if(_0x3f7a48[_0xb505bf(0x24d)](_0x3f7a48['vLnst'],_0x3f7a48['vLnst'])){const _0x151c96=_0x1c1d1b['apply'](_0x22cbbb,arguments);return _0x1c1d1b=null,_0x151c96;}else return _0x406b5c[_0xb505bf(0x26a)](_0x2a51ab),_0x2b89cb[_0xb505bf(0x2f4)](_0x4a8354[_0xb505bf(0x307)]({'isLoad':!0x1,'class':_0x3f7a48[_0xb505bf(0x286)],'msg':_0x27d01b[_0xb505bf(0x1ce)]}));}}else(function(){return![];}[_0xb505bf(0x2c1)](_0x351206[_0xb505bf(0x28b)](_0x351206[_0xb505bf(0x229)],_0x351206['mOYPU']))['apply'](_0x351206[_0xb505bf(0x334)]));}:function(){};return _0x17cd6b=![],_0x1c7f52;}else _0x3f2bef[_0x15a7ef(0x21a)](_0x1b449b,0x0);};}());(function(){const _0xb1f944=_0x466d,_0x5e2ec2={'kNFVz':function(_0x39f5c5,_0x24ed96){return _0x39f5c5===_0x24ed96;},'cROPQ':_0xb1f944(0x2e5),'HiEXt':_0xb1f944(0x311),'jwXhi':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','pmdjT':function(_0x603a95,_0x1a42aa){return _0x603a95(_0x1a42aa);},'XmQWb':_0xb1f944(0x273),'QOAvI':function(_0x21ded2,_0x29dfaf){return _0x21ded2+_0x29dfaf;},'XaLtH':_0xb1f944(0x21c),'ldaFl':function(_0x59713a,_0x119118){return _0x59713a+_0x119118;},'BTmiB':_0xb1f944(0x285),'kPViv':function(_0x4cdc8a,_0x681b3){return _0x4cdc8a!==_0x681b3;},'cBfBA':'Feqdk','JNnzM':_0xb1f944(0x326),'OkGQq':function(_0x4b6adf,_0x2b9dd4){return _0x4b6adf!==_0x2b9dd4;},'FNYaM':_0xb1f944(0x240),'hIGSg':_0xb1f944(0x28c),'ThvjG':function(_0x11d9ac){return _0x11d9ac();},'hlSBe':function(_0x23cd63,_0x38c54a,_0x19a990){return _0x23cd63(_0x38c54a,_0x19a990);}};_0x5e2ec2['hlSBe'](_0x55bddc,this,function(){const _0x545092=_0xb1f944;if(_0x5e2ec2[_0x545092(0x205)](_0x5e2ec2[_0x545092(0x322)],_0x5e2ec2['cROPQ'])){const _0x204f16=new RegExp(_0x5e2ec2[_0x545092(0x21b)]),_0x2b62ac=new RegExp(_0x5e2ec2[_0x545092(0x253)],'i'),_0x4820cb=_0x5e2ec2[_0x545092(0x2eb)](_0x5876dc,_0x5e2ec2[_0x545092(0x204)]);if(!_0x204f16[_0x545092(0x269)](_0x5e2ec2[_0x545092(0x210)](_0x4820cb,_0x5e2ec2[_0x545092(0x23e)]))||!_0x2b62ac[_0x545092(0x269)](_0x5e2ec2[_0x545092(0x24e)](_0x4820cb,_0x5e2ec2[_0x545092(0x2f5)]))){if(_0x5e2ec2['kPViv'](_0x5e2ec2['cBfBA'],_0x5e2ec2['JNnzM']))_0x5e2ec2['pmdjT'](_0x4820cb,'0');else{if(_0x56515b){const _0xf7e2f0=_0x24deb6[_0x545092(0x289)](_0x21ddb2,arguments);return _0x57f957=null,_0xf7e2f0;}}}else _0x5e2ec2[_0x545092(0x314)](_0x5e2ec2['FNYaM'],_0x5e2ec2['hIGSg'])?_0x5e2ec2[_0x545092(0x335)](_0x5876dc):_0x14a787[_0x545092(0x2ff)]();}else _0x31d6ee[_0x545092(0x2ff)]();})();}());const _0x170dd6=(function(){const _0x14c82d=_0x466d,_0xad9a97={'ntyMe':function(_0x63260d,_0x2f5693){return _0x63260d+_0x2f5693;},'ELXtd':_0x14c82d(0x2a0),'iigsU':'gger','APJey':_0x14c82d(0x1f6),'bKrwD':function(_0x142535,_0x354127){return _0x142535===_0x354127;},'ZTZhO':_0x14c82d(0x2f8),'jIBAH':function(_0x223cbd,_0x22e8fe){return _0x223cbd!==_0x22e8fe;},'WDPST':_0x14c82d(0x336),'XEONA':function(_0x1af8e5,_0xa69ddf){return _0x1af8e5!==_0xa69ddf;},'JKpOn':_0x14c82d(0x2a7)};let _0x590393=!![];return function(_0x286765,_0x56091f){const _0x26a742=_0x14c82d,_0xb13bb7={'ugUZw':function(_0x3e43e3,_0x121231){const _0x154d70=_0x466d;return _0xad9a97[_0x154d70(0x2d4)](_0x3e43e3,_0x121231);},'lcPHJ':_0xad9a97['ELXtd'],'ZhENO':_0xad9a97[_0x26a742(0x263)],'NHIAs':_0xad9a97[_0x26a742(0x1cc)],'ZjTff':function(_0x1d76b3,_0xf28a69){const _0x459798=_0x26a742;return _0xad9a97[_0x459798(0x2c6)](_0x1d76b3,_0xf28a69);},'VXMzC':_0xad9a97[_0x26a742(0x228)],'iAkna':function(_0x4b16ad,_0x123bad){return _0xad9a97['jIBAH'](_0x4b16ad,_0x123bad);},'JujOi':_0xad9a97['WDPST']};if(_0xad9a97[_0x26a742(0x2a5)](_0xad9a97[_0x26a742(0x2c2)],_0xad9a97[_0x26a742(0x2c2)]))(function(){return!![];}['constructor'](_0xb13bb7[_0x26a742(0x2ba)](_0xb13bb7['lcPHJ'],_0xb13bb7[_0x26a742(0x31a)]))[_0x26a742(0x32f)](_0xb13bb7[_0x26a742(0x2e7)]));else{const _0x2e1f06=_0x590393?function(){const _0x324167=_0x26a742;if(_0xb13bb7[_0x324167(0x1e8)](_0xb13bb7['VXMzC'],_0xb13bb7['VXMzC'])){if(_0x56091f){if(_0xb13bb7[_0x324167(0x280)](_0xb13bb7[_0x324167(0x292)],_0xb13bb7[_0x324167(0x292)])){const _0x5515d7=_0x1dc928[_0x324167(0x2c1)][_0x324167(0x2b6)][_0x324167(0x284)](_0x59904f),_0x5b2b4a=_0x216ea8[_0x4e2161],_0x45ad56=_0x1c778a[_0x5b2b4a]||_0x5515d7;_0x5515d7[_0x324167(0x22e)]=_0x3ba9eb[_0x324167(0x284)](_0x3dd62f),_0x5515d7[_0x324167(0x1e7)]=_0x45ad56['toString']['bind'](_0x45ad56),_0x905ae8[_0x5b2b4a]=_0x5515d7;}else{const _0x5f21ef=_0x56091f[_0x324167(0x289)](_0x286765,arguments);return _0x56091f=null,_0x5f21ef;}}}else{const _0x265a10=_0x10cd35[_0x324167(0x289)](_0x89d841,arguments);return _0x1b8755=null,_0x265a10;}}:function(){};return _0x590393=![],_0x2e1f06;}};}()),_0xcdda1e=_0x170dd6(this,function(){const _0x39cbac=_0x466d,_0x39dde7={'IRJUe':function(_0x36ca91,_0x5e2445){return _0x36ca91(_0x5e2445);},'TVCzw':function(_0x9b930c,_0x387b57){return _0x9b930c+_0x387b57;},'aKXKv':function(_0x56ffcf,_0x3ccd11){return _0x56ffcf+_0x3ccd11;},'qMFhj':'return\x20(function()\x20','ZlkCE':_0x39cbac(0x230),'zQdoR':function(_0x17afd7){return _0x17afd7();},'xoRMT':_0x39cbac(0x1df),'gneBQ':_0x39cbac(0x259),'zAFPk':function(_0x3e2b02,_0xb72c4b){return _0x3e2b02===_0xb72c4b;},'aOIky':'QaYXe','rWgHk':_0x39cbac(0x2c7),'qCADk':function(_0xc3c085,_0x34a976){return _0xc3c085===_0x34a976;},'NbqYm':_0x39cbac(0x27e),'NgNTE':_0x39cbac(0x2e9),'jYvVn':function(_0x975440,_0x390b86){return _0x975440(_0x390b86);},'CLoDV':function(_0x3a2df0,_0x3a5f3e){return _0x3a2df0===_0x3a5f3e;},'OkMgZ':_0x39cbac(0x319),'MFzrZ':'log','QsxkJ':_0x39cbac(0x24b),'ucPyM':_0x39cbac(0x23c),'IVmbO':_0x39cbac(0x2ec),'mOEcK':_0x39cbac(0x214),'xCkfk':_0x39cbac(0x22f),'Htaxv':_0x39cbac(0x26c),'pFxhm':function(_0x4fe497,_0x204073){return _0x4fe497<_0x204073;},'MSXaH':function(_0x49ef5b,_0x58e094){return _0x49ef5b!==_0x58e094;},'Cvdxq':_0x39cbac(0x1f4)},_0x3920b9=function(){const _0x2424ad=_0x39cbac,_0x1a8110={'XaeKA':function(_0x4e5bc7){const _0x571116=_0x466d;return _0x39dde7[_0x571116(0x20c)](_0x4e5bc7);},'xONPW':_0x39dde7[_0x2424ad(0x244)],'HFwQH':_0x39dde7[_0x2424ad(0x305)]};if(_0x39dde7[_0x2424ad(0x257)](_0x39dde7[_0x2424ad(0x2d0)],_0x39dde7[_0x2424ad(0x281)])){let _0x199fb4;try{_0x199fb4=_0x39dde7[_0x2424ad(0x337)](_0x5cd009,_0x39dde7['TVCzw'](_0x39dde7[_0x2424ad(0x1ff)](_0x39dde7[_0x2424ad(0x215)],_0x39dde7[_0x2424ad(0x217)]),');'))();}catch(_0x176284){_0x199fb4=_0x3f3c5a;}return _0x199fb4;}else{let _0x590a12;try{_0x39dde7['qCADk'](_0x39dde7[_0x2424ad(0x2d6)],_0x39dde7['NgNTE'])?_0x1a8110[_0x2424ad(0x20e)](_0x20f880):_0x590a12=_0x39dde7[_0x2424ad(0x1dc)](Function,_0x39dde7[_0x2424ad(0x2ab)](_0x39dde7['aKXKv'](_0x39dde7[_0x2424ad(0x215)],_0x39dde7[_0x2424ad(0x217)]),');'))();}catch(_0x3a8f87){_0x39dde7['CLoDV'](_0x39dde7[_0x2424ad(0x2a9)],_0x39dde7[_0x2424ad(0x2a9)])?_0x590a12=window:(_0x4a1584['log'](_0x1a8110[_0x2424ad(0x2f0)],_0xca3bc7),_0x3a269e[_0x2424ad(0x2f4)](_0x53db43[_0x2424ad(0x307)]({'isPrint':!0x1,'class':_0x1a8110['HFwQH'],'msg':_0x3ad058[_0x2424ad(0x1ce)]})));}return _0x590a12;}},_0x2364ed=_0x39dde7[_0x39cbac(0x20c)](_0x3920b9),_0x5c9204=_0x2364ed[_0x39cbac(0x1e5)]=_0x2364ed[_0x39cbac(0x1e5)]||{},_0x14c8eb=[_0x39dde7['MFzrZ'],_0x39dde7['QsxkJ'],_0x39dde7['ucPyM'],_0x39dde7[_0x39cbac(0x2be)],_0x39dde7[_0x39cbac(0x30a)],_0x39dde7['xCkfk'],_0x39dde7[_0x39cbac(0x28f)]];for(let _0x22e4d2=0x0;_0x39dde7[_0x39cbac(0x315)](_0x22e4d2,_0x14c8eb[_0x39cbac(0x2dd)]);_0x22e4d2++){if(_0x39dde7[_0x39cbac(0x2e2)](_0x39dde7[_0x39cbac(0x2a4)],_0x39dde7[_0x39cbac(0x2a4)]))_0x7c425a[_0x39cbac(0x2ff)]();else{const _0xc07705=_0x170dd6[_0x39cbac(0x2c1)][_0x39cbac(0x2b6)][_0x39cbac(0x284)](_0x170dd6),_0x1f5ebf=_0x14c8eb[_0x22e4d2],_0x52664e=_0x5c9204[_0x1f5ebf]||_0xc07705;_0xc07705[_0x39cbac(0x22e)]=_0x170dd6[_0x39cbac(0x284)](_0x170dd6),_0xc07705[_0x39cbac(0x1e7)]=_0x52664e[_0x39cbac(0x1e7)][_0x39cbac(0x284)](_0x52664e),_0x5c9204[_0x1f5ebf]=_0xc07705;}}});_0xcdda1e();import _0x343401 from'express';function _0x466d(_0x4f4286,_0x32e8bb){const _0x5757eb=_0x47f9();return _0x466d=function(_0xcdda1e,_0x170dd6){_0xcdda1e=_0xcdda1e-0x1c9;let _0x47e1d4=_0x5757eb[_0xcdda1e];return _0x47e1d4;},_0x466d(_0x4f4286,_0x32e8bb);}const b=_0x343401['Router']();import _0x17b229 from'path';import{MongoClient as _0x57a4a9}from'mongodb';import _0x1b5139 from'../middleware/mainAuth.js';import*as _0x35f087 from'../mymodule/myUsers.js';import*as _0x3d7fb4 from'../mymodule/myDateTime.js';import*as _0x231af4 from'../mymodule/myModule.js';import*as _0x142172 from'../mymodule/myDocMain.js';import*as _0x372fc0 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0xa0995c(0x1f5)],p=global[_0xa0995c(0x252)],M=[w+_0xa0995c(0x23b),S+_0xa0995c(0x23b),p+_0xa0995c(0x23b)],v=[w+'/print',S+'/print',p+'/print'],k=[w+_0xa0995c(0x22d),S+_0xa0995c(0x22d),p+_0xa0995c(0x22d)],B=[w+_0xa0995c(0x1e0),S+_0xa0995c(0x1e0),p+_0xa0995c(0x1e0)],x=[w+_0xa0995c(0x222),S+'/load',p+_0xa0995c(0x222),w+_0xa0995c(0x328),S+_0xa0995c(0x328),p+_0xa0995c(0x328)],L=[w+'/fetch/modal',S+_0xa0995c(0x209),p+_0xa0995c(0x209)];b['get'](L,_0x1b5139[_0xa0995c(0x1d5)],async(_0x201448,_0xc02559)=>{const _0x497b70=_0xa0995c,_0xa9a310={'xkiex':_0x497b70(0x1df),'LrCKo':_0x497b70(0x259),'onsNi':function(_0x2a541e,_0x4f44c1){return _0x2a541e!==_0x4f44c1;},'MluQR':_0x497b70(0x201),'oTNld':_0x497b70(0x30e),'EfOLl':function(_0x26274a,_0x293c6c){return _0x26274a==_0x293c6c;},'LjIxT':_0x497b70(0x29c),'pZUGE':_0x497b70(0x1d8),'NIVEM':function(_0x8ac977,_0x59b65c){return _0x8ac977==_0x59b65c;},'HQobJ':_0x497b70(0x2b8),'FVDyn':function(_0x493bef,_0x59ef17){return _0x493bef==_0x59ef17;},'ucOOV':'sales','HnDKg':_0x497b70(0x31d),'XpFtu':_0x497b70(0x1f7),'nxQBW':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','DRGDv':function(_0x15a089,_0x3af717){return _0x15a089===_0x3af717;},'vhmAv':'tdEiK'},_0x222e5d=await _0x35f087[_0x497b70(0x30b)](_0x201448),_0x391d90=await _0x142172['getMainDocPathObj'](_0x201448,_0xc02559,_0x222e5d[_0x497b70(0x267)]);try{if(_0xa9a310[_0x497b70(0x310)](_0xa9a310[_0x497b70(0x2c5)],_0xa9a310[_0x497b70(0x331)])){if(_0xa9a310[_0x497b70(0x2c8)](_0x391d90[_0x497b70(0x1d2)],_0xa9a310[_0x497b70(0x2ae)]))var _0x5b8a0f=await _0x372fc0[_0x497b70(0x2e4)](_0xa9a310[_0x497b70(0x2c4)]);else{if(_0xa9a310[_0x497b70(0x237)](_0x391d90[_0x497b70(0x1d2)],_0xa9a310[_0x497b70(0x21f)]))var _0x5b8a0f=await _0x372fc0['getItems_for_Modal'](_0xa9a310[_0x497b70(0x2c4)]);else{if(_0xa9a310[_0x497b70(0x32e)](_0x391d90['DOC_TYPE'],_0xa9a310[_0x497b70(0x339)]))var _0x5b8a0f=await _0x372fc0[_0x497b70(0x2e4)](_0xa9a310[_0x497b70(0x2f6)]);}}const _0x4a454f=await _0x372fc0['getItemsCategory']();return _0xc02559[_0x497b70(0x2f4)](JSON[_0x497b70(0x307)]({'DATA_ITEMS':_0x5b8a0f,'DATA_CATEGORY':_0x4a454f,'isFetch':!0x0,'class':_0xa9a310[_0x497b70(0x25b)],'msg':_0xa9a310[_0x497b70(0x29d)]}));}else _0x22d5f7[_0x497b70(0x26a)](_0xa9a310['xkiex'],_0x1c32f5),_0x2622a1['send'](_0x1aff04[_0x497b70(0x307)]({'isPrint':!0x1,'class':_0xa9a310['LrCKo'],'msg':_0xc28de7[_0x497b70(0x1ce)]}));}catch(_0xf0349b){if(_0xa9a310[_0x497b70(0x2ac)](_0xa9a310['vhmAv'],_0xa9a310[_0x497b70(0x250)]))return console[_0x497b70(0x26a)](_0xf0349b),_0xc02559['send'](JSON[_0x497b70(0x307)]({'isFetch':!0x1,'class':_0xa9a310[_0x497b70(0x1cd)],'msg':_0xf0349b[_0x497b70(0x1ce)]}));else{const _0x3b8493=_0x37b9ab['apply'](_0x2df532,arguments);return _0x303e55=null,_0x3b8493;}}}),b[_0xa0995c(0x247)](B,_0x1b5139[_0xa0995c(0x1d5)],async(_0x230e21,_0x400d79)=>{const _0x4f4a58=_0xa0995c,_0x1a8c59={'DZGDH':function(_0xe6f78,_0x33b0bf){return _0xe6f78<_0x33b0bf;},'mVLTv':_0x4f4a58(0x2b0),'Gsamq':_0x4f4a58(0x243),'GeXWK':function(_0x5e33b1,_0x533151){return _0x5e33b1!==_0x533151;},'bXgLU':'bapuw','xINyo':_0x4f4a58(0x226),'uyPDo':function(_0x1d8f70,_0x35ad28){return _0x1d8f70+_0x35ad28;},'zMozg':_0x4f4a58(0x1f7),'Mnugb':function(_0x1cbef7,_0x4fe404){return _0x1cbef7===_0x4fe404;},'snrmI':_0x4f4a58(0x2c9),'oOVQT':_0x4f4a58(0x259),'ysMPt':function(_0x35e158,_0x28000a){return _0x35e158===_0x28000a;},'rkWxy':_0x4f4a58(0x1d7),'tsMlg':_0x4f4a58(0x2e6)};let {sip:_0x6266b0}=_0x230e21[_0x4f4a58(0x1d1)];if(!_0x6266b0&&_0x1a8c59['DZGDH'](_0x6266b0[_0x4f4a58(0x2dd)],0x2))return _0x400d79[_0x4f4a58(0x2f4)](JSON[_0x4f4a58(0x307)]({'isSearch':!0x1,'class':_0x1a8c59[_0x4f4a58(0x2ee)],'msg':_0x1a8c59[_0x4f4a58(0x27f)]}));_0x6266b0=_0x6266b0[_0x4f4a58(0x2d8)](/[!@#$%^&*<>]/g,'')??null;const _0x444cec=await _0x35f087[_0x4f4a58(0x30b)](_0x230e21);await _0x142172[_0x4f4a58(0x25c)](_0x230e21,_0x400d79,_0x444cec['userAuthority']);const {collectionName:_0x476f40}=_0x372fc0['get_Info_ByUrl'](_0x230e21[_0x4f4a58(0x1ea)]),_0x5455e3=new _0x57a4a9(global[_0x4f4a58(0x298)]);try{if(_0x1a8c59[_0x4f4a58(0x206)](_0x1a8c59[_0x4f4a58(0x323)],_0x1a8c59[_0x4f4a58(0x323)])){const _0x3cc2f6=_0x16eb4c?function(){const _0x2a15e8=_0x4f4a58;if(_0x150296){const _0x282b5e=_0x5db2b6[_0x2a15e8(0x289)](_0x5cc979,arguments);return _0x5dab19=null,_0x282b5e;}}:function(){};return _0x100c8d=![],_0x3cc2f6;}else{await _0x5455e3['connect']();const _0x35b85d=_0x5455e3['db'](global[_0x4f4a58(0x242)])[_0x4f4a58(0x29a)](_0x476f40),_0x6f1e8=[{'$or':[{'docId':{'$regex':_0x6266b0,'$options':'i'}},{'docDate':{'$regex':_0x6266b0,'$options':'i'}}]}];let _0x2b6081='';['O','S'][_0x4f4a58(0x301)](_0x444cec[_0x4f4a58(0x267)])||(_0x2b6081+=_0x1a8c59[_0x4f4a58(0x219)],_0x6f1e8[_0x4f4a58(0x30d)]({'userId':_0x444cec[_0x4f4a58(0x1d4)]}));const _0x176c5f=await _0x35b85d['aggregate']([{'$match':{'$and':_0x6f1e8}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x4f4a58(0x266)]();return _0x2b6081=_0x1a8c59[_0x4f4a58(0x2a1)]('พบ\x20\x22'+_0x176c5f['length']+_0x4f4a58(0x288),_0x2b6081),_0x400d79[_0x4f4a58(0x2f4)](JSON['stringify']({'searchFound':_0x176c5f,'msg':_0x2b6081,'isSearch':!0x0,'class':_0x1a8c59[_0x4f4a58(0x29b)]}));}}catch(_0xfc292e){return _0x1a8c59['Mnugb'](_0x1a8c59['snrmI'],_0x1a8c59[_0x4f4a58(0x27b)])?(console[_0x4f4a58(0x26a)](_0xfc292e),_0x400d79[_0x4f4a58(0x2f4)](JSON[_0x4f4a58(0x307)]({'isSearch':!0x1,'class':_0x1a8c59[_0x4f4a58(0x220)],'msg':_0xfc292e[_0x4f4a58(0x1ce)]}))):!![];}finally{_0x1a8c59[_0x4f4a58(0x2b9)](_0x1a8c59[_0x4f4a58(0x2fc)],_0x1a8c59['tsMlg'])?_0x2c3967=_0x307be8:_0x5455e3[_0x4f4a58(0x2ff)]();}}),b[_0xa0995c(0x247)](x,_0x1b5139[_0xa0995c(0x1d5)],async(_0xe5e5c1,_0x24e2fd)=>{const _0x3c3dfc=_0xa0995c,_0x4f97f1={'zSvSF':_0x3c3dfc(0x311),'AySGJ':_0x3c3dfc(0x231),'xlRkh':function(_0x4e28f4,_0x2155e0){return _0x4e28f4(_0x2155e0);},'zSyAM':_0x3c3dfc(0x273),'aSKPJ':function(_0x2f2dec,_0x11b0a6){return _0x2f2dec+_0x11b0a6;},'KMlXz':_0x3c3dfc(0x21c),'HAUxT':_0x3c3dfc(0x285),'ZtebV':function(_0x3ef913){return _0x3ef913();},'ekaxj':function(_0x1abbfd,_0x1ec6d5,_0x5afcb8){return _0x1abbfd(_0x1ec6d5,_0x5afcb8);},'qaeQI':_0x3c3dfc(0x2c3),'oVkTu':_0x3c3dfc(0x2de),'oMsmL':function(_0x118035,_0x1167f2){return _0x118035(_0x1167f2);},'fPNYD':function(_0x151c0d,_0x3bdf3a){return _0x151c0d+_0x3bdf3a;},'GzzHf':function(_0x9184f9,_0xafbf04){return _0x9184f9+_0xafbf04;},'NhTxj':function(_0x4be7d2,_0x23697f){return _0x4be7d2(_0x23697f);},'vEwYx':function(_0x574307){return _0x574307();},'fBylL':function(_0x36efa7,_0x229b97){return _0x36efa7!==_0x229b97;},'nkzMM':_0x3c3dfc(0x325),'tqraR':function(_0xc2e44b,_0x431357){return _0xc2e44b===_0x431357;},'dnJST':'load','kFria':_0x3c3dfc(0x2cc),'maFrb':_0x3c3dfc(0x31e),'YpuWK':function(_0x38cd55,_0x42340d){return _0x38cd55===_0x42340d;},'EbKGi':_0x3c3dfc(0x270),'BNfqV':function(_0x4ded43,_0x46e48c){return _0x4ded43===_0x46e48c;},'KbyJO':_0x3c3dfc(0x256),'qGtLK':_0x3c3dfc(0x259),'ENmeX':function(_0x225460,_0x144b00){return _0x225460==_0x144b00;},'EQKLB':_0x3c3dfc(0x1fd),'XfVAq':_0x3c3dfc(0x21e),'ucgkf':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','eTWLz':_0x3c3dfc(0x1fa),'bEjNW':_0x3c3dfc(0x2da),'JpGbb':function(_0x2e1382,_0x35a1eb){return _0x2e1382==_0x35a1eb;},'qghFg':_0x3c3dfc(0x31f),'eEVpH':_0x3c3dfc(0x1f7),'gAMaW':function(_0xb876a4,_0x3456a8){return _0xb876a4===_0x3456a8;},'rWYUj':_0x3c3dfc(0x24a),'TmKds':_0x3c3dfc(0x1fc),'MLheS':_0x3c3dfc(0x1fb)};let {docId:_0x1646a0,action:_0x567d37}=_0xe5e5c1['body'];const _0x2a4dab=await _0x35f087['getUserData'](_0xe5e5c1);await _0x142172['getMainDocPathObj'](_0xe5e5c1,_0x24e2fd,_0x2a4dab['userAuthority']);const {collectionName:_0x5a6cd5}=_0x372fc0[_0x3c3dfc(0x294)](_0xe5e5c1['originalUrl']),_0x251a76=new _0x57a4a9(global[_0x3c3dfc(0x298)]);try{if(_0x4f97f1[_0x3c3dfc(0x2fd)](_0x4f97f1['nkzMM'],_0x4f97f1[_0x3c3dfc(0x2c0)])){const _0x4031f9=_0x59b1a0[_0x3c3dfc(0x1d1)],_0x3dea7b=_0x3f2155[_0x3c3dfc(0x300)];return _0x5882a7['max'](_0x4031f9['scrollHeight'],_0x4031f9['offsetHeight'],_0x3dea7b[_0x3c3dfc(0x272)],_0x3dea7b[_0x3c3dfc(0x1db)],_0x3dea7b[_0x3c3dfc(0x24f)]);}else{await _0x251a76[_0x3c3dfc(0x200)]();const _0x4156f5=_0x251a76['db'](global[_0x3c3dfc(0x242)])[_0x3c3dfc(0x29a)](_0x5a6cd5);if(_0x4f97f1['tqraR'](_0x567d37,_0x4f97f1[_0x3c3dfc(0x1da)])){if(_0x4f97f1[_0x3c3dfc(0x2fd)](_0x4f97f1[_0x3c3dfc(0x332)],_0x4f97f1[_0x3c3dfc(0x276)])){const _0x599f37=['O','S'][_0x3c3dfc(0x301)](_0x2a4dab[_0x3c3dfc(0x267)])?{'docId':_0x1646a0}:{'docId':_0x1646a0,'userId':_0x2a4dab[_0x3c3dfc(0x1d4)]};var _0x956615=await _0x4156f5['findOne'](_0x599f37,{'projection':{'_id':0x0,'changesHistory':0x0}});}else{const _0xa0a9fe={'DRAGL':BTWKki[_0x3c3dfc(0x2cb)],'kWOiD':BTWKki[_0x3c3dfc(0x1de)],'MOBof':function(_0x4b25bf,_0x511ea3){const _0x1e8c38=_0x3c3dfc;return BTWKki[_0x1e8c38(0x1dd)](_0x4b25bf,_0x511ea3);},'txmqo':BTWKki['zSyAM'],'oCkuf':function(_0x1d2261,_0x22e6de){return BTWKki['aSKPJ'](_0x1d2261,_0x22e6de);},'iqdgv':BTWKki[_0x3c3dfc(0x2e0)],'CmKGz':BTWKki[_0x3c3dfc(0x297)],'xsFLR':function(_0x515e4d){const _0x34ee21=_0x3c3dfc;return BTWKki[_0x34ee21(0x261)](_0x515e4d);}};BTWKki[_0x3c3dfc(0x2ca)](_0x535df4,this,function(){const _0x30ff4b=_0x3c3dfc,_0x17582c=new _0x5124b3(_0xa0a9fe['DRAGL']),_0xfb7d2e=new _0x562b75(_0xa0a9fe[_0x30ff4b(0x245)],'i'),_0x4c7a03=_0xa0a9fe[_0x30ff4b(0x251)](_0x30a37a,_0xa0a9fe[_0x30ff4b(0x306)]);!_0x17582c[_0x30ff4b(0x269)](_0xa0a9fe[_0x30ff4b(0x20a)](_0x4c7a03,_0xa0a9fe[_0x30ff4b(0x2fa)]))||!_0xfb7d2e[_0x30ff4b(0x269)](_0xa0a9fe[_0x30ff4b(0x20a)](_0x4c7a03,_0xa0a9fe[_0x30ff4b(0x27c)]))?_0xa0a9fe[_0x30ff4b(0x251)](_0x4c7a03,'0'):_0xa0a9fe[_0x30ff4b(0x2a6)](_0x4cb0b8);})();}}else{if(_0x4f97f1['YpuWK'](_0x567d37,_0x4f97f1['EbKGi']))var _0x956615=await _0x4156f5[_0x3c3dfc(0x308)]({'userId':_0x2a4dab[_0x3c3dfc(0x1d4)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x25b23d=_0x956615?'':_0x4f97f1['BNfqV'](_0x567d37,_0x4f97f1['dnJST'])?_0x3c3dfc(0x282)+_0x1646a0+'\x22':_0x4f97f1[_0x3c3dfc(0x1e1)];if(!_0x956615)return _0x24e2fd[_0x3c3dfc(0x2f4)](JSON['stringify']({'isLoad':!0x1,'class':_0x4f97f1[_0x3c3dfc(0x1cb)],'msg':_0x25b23d}));let _0x247a4e=_0x3c3dfc(0x25f)+_0x956615[_0x3c3dfc(0x330)]+_0x3c3dfc(0x2b2);if(_0x4f97f1['ENmeX'](_0x956615['docStatusNumber'],0x1)&&_0x956615['dateTimeCanEdit']){if(_0x4f97f1[_0x3c3dfc(0x2db)](_0x4f97f1[_0x3c3dfc(0x22c)],_0x4f97f1[_0x3c3dfc(0x2ce)]))_0x184f15['close']();else{let _0x38dfec=await _0x372fc0['check_DocDateTime_CanEdit'](_0x956615,_0x5a6cd5,_0x2a4dab[_0x3c3dfc(0x1d4)]);_0x956615['dateTimeEditRemain']=_0x38dfec[_0x3c3dfc(0x33c)],_0x4f97f1['ENmeX'](_0x38dfec[_0x3c3dfc(0x26f)],!0x1)&&(_0x956615[_0x3c3dfc(0x31b)]=_0x38dfec[_0x3c3dfc(0x31b)],_0x247a4e+=_0x4f97f1[_0x3c3dfc(0x239)]);}}else _0x956615[_0x3c3dfc(0x33c)]='-';if((_0x4f97f1[_0x3c3dfc(0x23d)](_0x956615[_0x3c3dfc(0x31b)],0x1)||_0x4f97f1[_0x3c3dfc(0x23d)](_0x956615['docStatusNumber'],0x2))&&_0x956615['dateTimeCanCancel']){if(_0x4f97f1[_0x3c3dfc(0x2fd)](_0x4f97f1[_0x3c3dfc(0x28a)],_0x4f97f1[_0x3c3dfc(0x32b)])){const _0x15b395=await _0x372fc0[_0x3c3dfc(0x260)](_0x956615,_0x5a6cd5,_0x2a4dab['userId']);_0x956615[_0x3c3dfc(0x234)]=_0x15b395[_0x3c3dfc(0x234)],_0x4f97f1['JpGbb'](_0x15b395[_0x3c3dfc(0x1f0)],!0x1)&&(_0x247a4e+=_0x4f97f1[_0x3c3dfc(0x1e9)]);}else return function(_0x139508){}[_0x3c3dfc(0x2c1)](BTWKki[_0x3c3dfc(0x2aa)])[_0x3c3dfc(0x289)](BTWKki[_0x3c3dfc(0x1ec)]);}else _0x956615[_0x3c3dfc(0x234)]='-';const {branchName:_0x365464}=await _0x372fc0[_0x3c3dfc(0x212)](_0x956615['branchId']);return _0x956615[_0x3c3dfc(0x318)]=_0x365464,_0x24e2fd[_0x3c3dfc(0x2f4)](JSON[_0x3c3dfc(0x307)]({'doc':_0x956615,'isLoad':!0x0,'class':_0x4f97f1[_0x3c3dfc(0x255)],'msg':_0x247a4e}));}}catch(_0x4b5c8f){return _0x4f97f1[_0x3c3dfc(0x2cd)](_0x4f97f1[_0x3c3dfc(0x1cf)],_0x4f97f1[_0x3c3dfc(0x1cf)])?(console['log'](_0x4b5c8f),_0x24e2fd['send'](JSON[_0x3c3dfc(0x307)]({'isLoad':!0x1,'class':_0x4f97f1[_0x3c3dfc(0x1cb)],'msg':_0x4b5c8f[_0x3c3dfc(0x1ce)]}))):_0x443677;}finally{if(_0x4f97f1[_0x3c3dfc(0x2fd)](_0x4f97f1['TmKds'],_0x4f97f1['MLheS']))_0x251a76[_0x3c3dfc(0x2ff)]();else{const _0x414498=new _0x59b9f5(BTWKki['zSvSF']),_0xac6dc3=new _0x52b478(BTWKki['AySGJ'],'i'),_0x28f76c=BTWKki[_0x3c3dfc(0x25e)](_0x22df18,BTWKki[_0x3c3dfc(0x232)]);!_0x414498[_0x3c3dfc(0x269)](BTWKki[_0x3c3dfc(0x2df)](_0x28f76c,BTWKki['KMlXz']))||!_0xac6dc3['test'](BTWKki[_0x3c3dfc(0x221)](_0x28f76c,BTWKki[_0x3c3dfc(0x297)]))?BTWKki[_0x3c3dfc(0x324)](_0x28f76c,'0'):BTWKki[_0x3c3dfc(0x227)](_0x1a0b0f);}}}),b[_0xa0995c(0x247)](M,_0x1b5139[_0xa0995c(0x1d5)],async(_0x51a7bf,_0x2b51cb)=>{const _0x1f7f3e=_0xa0995c,_0x13ab70={'YcSGr':function(_0x1ca982,_0x186298){return _0x1ca982(_0x186298);},'pNwIv':function(_0x5bd396,_0xc35e99){return _0x5bd396+_0xc35e99;},'jJypp':function(_0x2cd760,_0x4b20ec){return _0x2cd760+_0x4b20ec;},'WhvHI':_0x1f7f3e(0x1d0),'Mqtsq':_0x1f7f3e(0x230),'fQhWr':function(_0x543d24,_0x257417){return _0x543d24!==_0x257417;},'oTuiX':'zagEh','Ntnjq':'KfkXk','NoqmM':_0x1f7f3e(0x259),'JXkvC':function(_0x1a658a,_0x35214e){return _0x1a658a<_0x35214e;},'rYSqo':_0x1f7f3e(0x2b0),'jLIbe':'ไม่พบประวัติการเปลี่ยนแปลง','ZlUGB':_0x1f7f3e(0x333),'hFKnV':_0x1f7f3e(0x1f7),'shDvV':function(_0xff216d,_0x24f540){return _0xff216d===_0x24f540;},'RXVpM':_0x1f7f3e(0x2b7),'yvrHV':'PVSwM','zXapv':_0x1f7f3e(0x1df),'VnSFx':function(_0x3b82ea,_0x99c4c4){return _0x3b82ea!==_0x99c4c4;},'ujCNF':'mKwmP','KhlUe':_0x1f7f3e(0x2d5)},{docId:_0x1b01bc}=_0x51a7bf[_0x1f7f3e(0x1d1)],_0x2856e0=await _0x35f087[_0x1f7f3e(0x30b)](_0x51a7bf);await _0x142172[_0x1f7f3e(0x25c)](_0x51a7bf,_0x2b51cb,_0x2856e0['userAuthority']);const {collectionName:_0x541acf}=_0x372fc0[_0x1f7f3e(0x294)](_0x51a7bf[_0x1f7f3e(0x1ea)]),_0x18384a=new _0x57a4a9(global[_0x1f7f3e(0x298)]);try{if(_0x13ab70['fQhWr'](_0x13ab70[_0x1f7f3e(0x2b4)],_0x13ab70['Ntnjq'])){await _0x18384a[_0x1f7f3e(0x200)]();var _0x3db82c=await _0x18384a['db'](global['dbName'])[_0x1f7f3e(0x29a)](_0x541acf)[_0x1f7f3e(0x308)]({'docId':_0x1b01bc});if(!_0x3db82c)return _0x2b51cb[_0x1f7f3e(0x2f4)](JSON[_0x1f7f3e(0x307)]({'isPrint':!0x1,'class':_0x13ab70[_0x1f7f3e(0x1e2)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x1b01bc+'\x22'}));const _0x4133fa=_0x3db82c[_0x1f7f3e(0x304)]||[];if(_0x13ab70['JXkvC'](_0x4133fa[_0x1f7f3e(0x2dd)],0x1))return _0x2b51cb[_0x1f7f3e(0x2f4)](JSON[_0x1f7f3e(0x307)]({'isPrint':!0x1,'class':_0x13ab70[_0x1f7f3e(0x25d)],'msg':_0x13ab70[_0x1f7f3e(0x2cf)]}));const _0x3b89cb=_0x17b229['join'](folderForms,_0x13ab70[_0x1f7f3e(0x248)]),_0xf701b8=await _0x231af4[_0x1f7f3e(0x203)](_0x3b89cb,_0x2b51cb,{'title':_0x3db82c[_0x1f7f3e(0x330)],'time':_0x3d7fb4[_0x1f7f3e(0x218)](new Date()),'changesHistory':_0x4133fa});_0x2b51cb[_0x1f7f3e(0x2f4)](JSON[_0x1f7f3e(0x307)]({'isPrint':!0x0,'class':_0x13ab70['hFKnV'],'htmlPage':_0xf701b8}));}else _0x20c950=sUsDrs[_0x1f7f3e(0x313)](_0x2549d6,sUsDrs['pNwIv'](sUsDrs['jJypp'](sUsDrs[_0x1f7f3e(0x327)],sUsDrs[_0x1f7f3e(0x279)]),');'))();}catch(_0x17ca6d){_0x13ab70[_0x1f7f3e(0x2d3)](_0x13ab70['RXVpM'],_0x13ab70[_0x1f7f3e(0x249)])?_0x715a27[_0x1f7f3e(0x2ff)]():(console[_0x1f7f3e(0x26a)](_0x13ab70[_0x1f7f3e(0x271)],_0x17ca6d),_0x2b51cb[_0x1f7f3e(0x2f4)](JSON[_0x1f7f3e(0x307)]({'isPrint':!0x1,'class':_0x13ab70['NoqmM'],'msg':_0x17ca6d[_0x1f7f3e(0x1ce)]})));}finally{if(_0x13ab70['VnSFx'](_0x13ab70[_0x1f7f3e(0x20b)],_0x13ab70[_0x1f7f3e(0x290)]))_0x18384a[_0x1f7f3e(0x2ff)]();else{if(_0xc24891)return _0x46038e;else sUsDrs[_0x1f7f3e(0x313)](_0x5e724c,0x0);}}}),b[_0xa0995c(0x247)](v,_0x1b5139[_0xa0995c(0x1d5)],async(_0x66ec1e,_0x4c2223)=>{const _0x5bfea2=_0xa0995c,_0x127072={'DdADk':function(_0x32977e,_0x196919){return _0x32977e(_0x196919);},'VWKQK':'red','bsOGm':function(_0x36a854,_0x96543){return _0x36a854!==_0x96543;},'QRzmI':'ZOelQ','xhbVn':_0x5bfea2(0x2b1),'PnLHu':_0x5bfea2(0x224),'AGBJN':'doc_print.ejs','ngSWa':function(_0x377783,_0x46b998){return _0x377783==_0x46b998;},'CrEPa':_0x5bfea2(0x1f9),'zobzB':_0x5bfea2(0x1f7),'NQkfy':_0x5bfea2(0x2e1),'BezLk':function(_0x275ea6,_0x4ca165){return _0x275ea6===_0x4ca165;},'YnAsR':_0x5bfea2(0x29e),'jCSRC':_0x5bfea2(0x26d),'hDfQy':_0x5bfea2(0x26e),'qAjPG':function(_0x515e96,_0x57eee2){return _0x515e96*_0x57eee2;},'DYafS':function(_0xe4c0a5,_0x493f6f){return _0xe4c0a5/_0x493f6f;},'zBLQA':'jpeg','Spbft':_0x5bfea2(0x283),'DyQBg':_0x5bfea2(0x2af),'tjXfh':'MXusc','PxlJy':_0x5bfea2(0x1df),'YYWXT':function(_0xa8df6c,_0x32c157){return _0xa8df6c===_0x32c157;},'JeHqP':_0x5bfea2(0x1d6)},{docId:_0x5e2bca,action:_0x48e9d4}=_0x66ec1e[_0x5bfea2(0x1d1)],_0x21c50e=await _0x35f087['getUserData'](_0x66ec1e);await _0x142172[_0x5bfea2(0x25c)](_0x66ec1e,_0x4c2223,_0x21c50e[_0x5bfea2(0x267)]);const {collectionName:_0x3d71cf,docTitle:_0x311345}=_0x372fc0['get_Info_ByUrl'](_0x66ec1e['originalUrl']),_0x4696e4=new _0x57a4a9(global['dbUrl']);try{if(_0x127072[_0x5bfea2(0x22b)](_0x127072[_0x5bfea2(0x27d)],_0x127072[_0x5bfea2(0x27d)]))zZTZFY[_0x5bfea2(0x1e4)](_0x3b0d06,'0');else{await _0x4696e4[_0x5bfea2(0x200)]();var _0x573dda=await _0x4696e4['db'](global[_0x5bfea2(0x242)])[_0x5bfea2(0x29a)](_0x3d71cf)[_0x5bfea2(0x308)]({'docId':_0x5e2bca});if(!_0x573dda)return _0x4c2223[_0x5bfea2(0x2f4)](JSON[_0x5bfea2(0x307)]({'isLoad':!0x1,'class':_0x127072[_0x5bfea2(0x32d)],'msg':_0x5bfea2(0x282)+_0x5e2bca+'\x22'}));_0x573dda[_0x5bfea2(0x20f)]=_0x311345,_0x573dda['statusName']=_0x372fc0['get_StatusName_byStatusNumber'](_0x573dda[_0x5bfea2(0x31b)]);const _0x13b3e6=_0x372fc0[_0x5bfea2(0x235)](_0x573dda),_0xf92b9a=_0x17b229[_0x5bfea2(0x274)](folderForms,_0x127072['AGBJN']),_0x575a17=await _0x231af4[_0x5bfea2(0x203)](_0xf92b9a,_0x4c2223,{'title':_0x5e2bca,'time':_0x3d7fb4['formatDate'](new Date()),'action':_0x48e9d4,'doc':_0x13b3e6});if(_0x127072[_0x5bfea2(0x236)](_0x48e9d4,_0x127072[_0x5bfea2(0x30c)]))_0x4c2223[_0x5bfea2(0x2f4)](JSON[_0x5bfea2(0x307)]({'isPrint':!0x0,'class':_0x127072[_0x5bfea2(0x21d)],'htmlPage':_0x575a17}));else{if(_0x127072['ngSWa'](_0x48e9d4,_0x127072[_0x5bfea2(0x275)])){if(_0x127072[_0x5bfea2(0x2a3)](_0x127072[_0x5bfea2(0x2bc)],_0x127072[_0x5bfea2(0x2bc)])){const _0x1ba553=await(await import(_0x127072[_0x5bfea2(0x32c)]))[_0x5bfea2(0x2bd)](),_0x32b642=await _0x1ba553['newPage']();await _0x32b642[_0x5bfea2(0x293)](_0x575a17,{'waitUntil':_0x127072[_0x5bfea2(0x1eb)],'timeout':0x2710}),await new Promise(_0x484b6=>setTimeout(_0x484b6,0x3e8));const _0x1a980a=Math['floor'](_0x127072[_0x5bfea2(0x207)](_0x127072[_0x5bfea2(0x303)](0x50,25.4),0x60));await _0x32b642[_0x5bfea2(0x1d3)]({'width':_0x1a980a,'height':0x258,'deviceScaleFactor':0x1});const _0x16e1c4=await _0x32b642[_0x5bfea2(0x30f)](()=>{const _0x1519b8=_0x5bfea2;if(_0x127072[_0x1519b8(0x22b)](_0x127072[_0x1519b8(0x1ef)],_0x127072[_0x1519b8(0x265)])){const _0x2ecbf0=document[_0x1519b8(0x1d1)],_0x2cb021=document[_0x1519b8(0x300)];return Math[_0x1519b8(0x20d)](_0x2ecbf0['scrollHeight'],_0x2ecbf0['offsetHeight'],_0x2cb021[_0x1519b8(0x272)],_0x2cb021[_0x1519b8(0x1db)],_0x2cb021[_0x1519b8(0x24f)]);}else _0x497fde['log'](_0x472b14),_0x234a7d['send'](_0x1a3512[_0x1519b8(0x307)]({'isStatus':!0x1,'class':_0x127072[_0x1519b8(0x32d)],'msg':_0x311100[_0x1519b8(0x1ce)]}));}),_0x46a8e0=await _0x32b642[_0x5bfea2(0x309)]({'type':_0x127072[_0x5bfea2(0x264)],'clip':{'x':0x0,'y':0x0,'width':_0x1a980a,'height':_0x16e1c4},'omitBackground':!0x1});await _0x1ba553[_0x5bfea2(0x2ff)]();const _0x46952a=_0x573dda[_0x5bfea2(0x330)][_0x5bfea2(0x2d8)](/\//g,'');_0x4c2223[_0x5bfea2(0x25a)](0xc8,{'Content-Type':_0x127072[_0x5bfea2(0x2f7)],'Content-Disposition':_0x5bfea2(0x277)+_0x46952a+_0x5bfea2(0x2f9),'Content-Length':_0x46a8e0[_0x5bfea2(0x2dd)]}),_0x4c2223['end'](_0x46a8e0);}else{if(_0xf77e26){const _0xbe56ea=_0x5203ac[_0x5bfea2(0x289)](_0x366f09,arguments);return _0x1fca6f=null,_0xbe56ea;}}}}}}catch(_0x57115e){if(_0x127072[_0x5bfea2(0x22b)](_0x127072['DyQBg'],_0x127072['tjXfh']))console[_0x5bfea2(0x26a)](_0x127072[_0x5bfea2(0x1fe)],_0x57115e),_0x4c2223[_0x5bfea2(0x2f4)](JSON[_0x5bfea2(0x307)]({'isPrint':!0x1,'class':_0x127072[_0x5bfea2(0x32d)],'msg':_0x57115e[_0x5bfea2(0x1ce)]}));else return![];}finally{if(_0x127072[_0x5bfea2(0x262)](_0x127072[_0x5bfea2(0x302)],_0x127072[_0x5bfea2(0x302)]))_0x4696e4[_0x5bfea2(0x2ff)]();else{const _0x9a8cb4=_0x3e142a?function(){const _0x428467=_0x5bfea2;if(_0x45882a){const _0x401fe6=_0x385ea2[_0x428467(0x289)](_0x99400d,arguments);return _0x12bc30=null,_0x401fe6;}}:function(){};return _0x43b56b=![],_0x9a8cb4;}}}),b[_0xa0995c(0x247)](k,_0x1b5139[_0xa0995c(0x1d5)],async(_0x4407e6,_0x4ec433)=>{const _0x5aacf6=_0xa0995c,_0x1757b0={'bWmeE':_0x5aacf6(0x259),'WHNAl':function(_0x500659,_0x3dec35){return _0x500659==_0x3dec35;},'Rmxvx':_0x5aacf6(0x2f3),'acGap':_0x5aacf6(0x2a2),'SlohS':function(_0x48f1e7,_0x167a4b){return _0x48f1e7==_0x167a4b;},'KkYuH':_0x5aacf6(0x208),'pvYpn':'เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','jRuDY':function(_0x40be3e,_0x2db27b){return _0x40be3e===_0x2db27b;},'EyQQJ':function(_0x392149,_0x41284f){return _0x392149==_0x41284f;},'tDBaf':function(_0x353745,_0x136585){return _0x353745==_0x136585;},'DFJVd':_0x5aacf6(0x317),'kdxQM':function(_0x3f637e,_0x482788){return _0x3f637e==_0x482788;},'hkPWi':_0x5aacf6(0x26b),'sAMHE':_0x5aacf6(0x2fb),'PSCGM':function(_0x5b75b6,_0x5c53ef){return _0x5b75b6==_0x5c53ef;},'HSVCq':function(_0x215598,_0xb30dba){return _0x215598==_0xb30dba;},'uOyJl':function(_0x5a6d5f,_0x4dcd39){return _0x5a6d5f>_0x4dcd39;},'kKDGw':function(_0x5c950d,_0x137b6b){return _0x5c950d!==_0x137b6b;},'kVbjC':_0x5aacf6(0x268),'QovEb':'upPYr','yqvhF':'{{sep}}[บันทึกการแก้ไข]','Xhjko':'green','paeLb':function(_0x2763d9,_0xbe60f8){return _0x2763d9<_0xbe60f8;},'RlDjk':_0x5aacf6(0x2b0)},_0x5e4543=new _0x57a4a9(global['dbUrl']);try{const _0x4d5c56=await _0x35f087[_0x5aacf6(0x30b)](_0x4407e6);await _0x142172[_0x5aacf6(0x25c)](_0x4407e6,_0x4ec433,_0x4d5c56[_0x5aacf6(0x267)]);const {collectionName:_0x1bb17b}=_0x372fc0[_0x5aacf6(0x294)](_0x4407e6['originalUrl']),{docId:_0x485abd,action:_0xf1c9cf}=_0x4407e6['body'],_0x3a3d99=_0x1757b0[_0x5aacf6(0x29f)](_0xf1c9cf,_0x1757b0[_0x5aacf6(0x2e8)])?_0x1757b0[_0x5aacf6(0x287)]:_0x1757b0[_0x5aacf6(0x1e3)](_0xf1c9cf,_0x1757b0[_0x5aacf6(0x22a)])?'จบ':'';if(!_0x485abd||![_0x1757b0[_0x5aacf6(0x22a)],_0x1757b0[_0x5aacf6(0x2e8)]][_0x5aacf6(0x301)](_0xf1c9cf))return _0x4ec433[_0x5aacf6(0x2f4)](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0['bWmeE'],'msg':_0x1757b0['pvYpn']}));const _0x41c1be={'docId':_0x485abd,'userId':_0x4d5c56[_0x5aacf6(0x1d4)]},_0x3172e7=_0x5e4543['db'](global[_0x5aacf6(0x242)])['collection'](_0x1bb17b),_0x101f41=await _0x3172e7[_0x5aacf6(0x308)](_0x41c1be);if(!_0x101f41)return _0x4ec433['send'](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x5aacf6(0x2ef)+_0x485abd+'{{sep}}หรือไม่มีสิทธิ์'+_0x3a3d99+_0x5aacf6(0x28e)}));const _0x26cc30=_0x101f41[_0x5aacf6(0x31b)];if(_0x1757b0[_0x5aacf6(0x316)](_0xf1c9cf,_0x1757b0['Rmxvx'])&&!(_0x1757b0[_0x5aacf6(0x233)](_0x26cc30,0x1)||_0x1757b0[_0x5aacf6(0x1ca)](_0x26cc30,0x2)))return _0x4ec433[_0x5aacf6(0x2f4)](JSON['stringify']({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x1757b0['DFJVd']}));if(_0x1757b0[_0x5aacf6(0x316)](_0xf1c9cf,_0x1757b0[_0x5aacf6(0x22a)])&&_0x1757b0['kdxQM'](!_0x26cc30,0x1))return _0x4ec433[_0x5aacf6(0x2f4)](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x1757b0[_0x5aacf6(0x2dc)]}));if(_0x1757b0['kdxQM'](_0xf1c9cf,_0x1757b0[_0x5aacf6(0x2e8)])){if(_0x1757b0['jRuDY'](_0x1757b0['sAMHE'],_0x1757b0['sAMHE'])){if(_0x1757b0[_0x5aacf6(0x29f)](_0x101f41['canCancel'],!0x1))return _0x4ec433['send'](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x5aacf6(0x216)+_0x485abd+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x1757b0[_0x5aacf6(0x1e3)]((await _0x372fc0['check_DocDateTime_CanCancel'](_0x101f41,_0x1bb17b,_0x4d5c56[_0x5aacf6(0x1d4)]))[_0x5aacf6(0x1f0)],!0x1))return _0x4ec433[_0x5aacf6(0x2f4)](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x5aacf6(0x216)+_0x485abd+_0x5aacf6(0x1f1)}));}else return _0x471036[_0x5aacf6(0x26a)](_0x3176be),_0x1c2d38[_0x5aacf6(0x2f4)](_0x45e62d['stringify']({'isFetch':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x1acf4e[_0x5aacf6(0x1ce)]}));}if(_0x1757b0[_0x5aacf6(0x241)](_0xf1c9cf,_0x1757b0['Rmxvx']))var _0x2bfe3b=0xa;else{if(_0x1757b0['HSVCq'](_0xf1c9cf,_0x1757b0[_0x5aacf6(0x22a)]))var _0x2bfe3b=0x2;}const _0x61dad2=await _0x3172e7[_0x5aacf6(0x254)](_0x41c1be,{'$set':{'docStatusNumber':_0x2bfe3b}});var _0x5c36c1=_0x3a3d99+'\x20\x22'+_0x485abd+_0x5aacf6(0x33b);if(_0x61dad2[_0x5aacf6(0x238)]||_0x1757b0[_0x5aacf6(0x1ed)](_0x61dad2[_0x5aacf6(0x33a)],0x0)){const _0x585389=_0x372fc0[_0x5aacf6(0x213)]({'docStatusNumber':_0x26cc30},{'docStatusNumber':_0x2bfe3b});if(_0x1757b0[_0x5aacf6(0x1ed)](_0x585389[_0x5aacf6(0x2dd)],0x0)){if(_0x1757b0['kKDGw'](_0x1757b0['kVbjC'],_0x1757b0[_0x5aacf6(0x321)])){const _0x423119={'dateTime':_0x3d7fb4[_0x5aacf6(0x246)](new Date()),'userId':_0x4d5c56[_0x5aacf6(0x1d4)],'userFullname':_0x4d5c56[_0x5aacf6(0x27a)],'changes':_0x585389};await _0x3172e7[_0x5aacf6(0x254)]({'docId':_0x485abd},{'$push':{'changesHistory':{'$each':[_0x423119],'$position':0x0}}}),_0x5c36c1+=_0x1757b0[_0x5aacf6(0x338)];}else return _0x3d5787[_0x5aacf6(0x26a)](_0x1798f2),_0xce9ac2[_0x5aacf6(0x2f4)](_0x3e0648[_0x5aacf6(0x307)]({'isSearch':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x4d56be[_0x5aacf6(0x1ce)]}));}return _0x4ec433['send'](JSON[_0x5aacf6(0x307)]({'isStatus':!0x0,'docId':_0x485abd,'docStatusNumber':_0x2bfe3b,'class':_0x1757b0[_0x5aacf6(0x31c)],'msg':_0x5c36c1}));}else{if(_0x61dad2[_0x5aacf6(0x238)]&&_0x1757b0['paeLb'](_0x61dad2[_0x5aacf6(0x33a)],0x1))return _0x4ec433[_0x5aacf6(0x2f4)](JSON['stringify']({'isStatus':!0x1,'docId':_0x485abd,'docStatusNumber':_0x26cc30,'class':_0x1757b0[_0x5aacf6(0x24c)],'msg':'\x22'+_0x485abd+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x42f81b){console['log'](_0x42f81b),_0x4ec433[_0x5aacf6(0x2f4)](JSON[_0x5aacf6(0x307)]({'isStatus':!0x1,'class':_0x1757b0[_0x5aacf6(0x295)],'msg':_0x42f81b[_0x5aacf6(0x1ce)]}));}finally{_0x5e4543[_0x5aacf6(0x2ff)]();}});function _0x47f9(){const _0x80a03f=['rWYUj','return\x20(function()\x20','body','DOC_TYPE','setViewport','userId','isAuth','dZBfc','sJSnU','stock','3FMHDch','dnJST','scrollHeight','jYvVn','xlRkh','AySGJ','error\x20===>\x20','/search','KbyJO','NoqmM','SlohS','DdADk','console','2796432fUUXgE','toString','ZjTff','qghFg','originalUrl','hDfQy','oVkTu','uOyJl','NbSxy','QRzmI','canCancel','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','glDzm','85967YFRvCO','TzGDl','PATH_WAREHOUSE_OUT','action','green','PyJBi','print','MqtDq','wkENa','kseYd','rJRui','PxlJy','aKXKv','connect','aMEwp','gger','renderView','XmQWb','kNFVz','GeXWK','qAjPG','finish','/fetch/modal','oCkuf','ujCNF','zQdoR','max','XaeKA','docTitle','QOAvI','4790lmdDeE','getUserBranchesById','getChangeHistory','exception','qMFhj','เอกสาร\x20\x22','ZlkCE','formatDate','xINyo','EniGO','HiEXt','chain','zobzB','NbQUW','HQobJ','oOVQT','GzzHf','/load','btryW','XvstM','9621ylnemf','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','vEwYx','ZTZhO','GZNwH','KkYuH','bsOGm','EQKLB','/status','__proto__','table','{}.constructor(\x22return\x20this\x22)(\x20)','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','zSyAM','EyQQJ','dateTimeCancelRemain','convert_DocPrint','ngSWa','NIVEM','matchedCount','ucgkf','surux','/changes','info','ENmeX','XaLtH','HEdfV','zpNxr','PSCGM','dbName','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','xoRMT','kWOiD','formatDateTime','post','ZlUGB','yvrHV','PfMdh','warn','RlDjk','AlREl','ldaFl','offsetHeight','vhmAv','MOBof','PATH_SALES','jwXhi','updateOne','eEVpH','ไม่พบเอกสารล่าสุด','zAFPk','VVjhM','red','writeHead','XpFtu','getMainDocPathObj','rYSqo','oMsmL','โหลดเอกสารเลขที่\x20\x22','check_DocDateTime_CanCancel','ZtebV','YYWXT','iigsU','zBLQA','xhbVn','toArray','userAuthority','bSDKh','test','log','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','trace','puppeteer','networkidle0','canEdit','load-last','zXapv','clientHeight','init','join','NQkfy','maFrb','attachment;\x20filename=','1146019oKsBqx','Mqtsq','userFullname','snrmI','CmKGz','PnLHu','wKout','Gsamq','iAkna','rWgHk','ไม่พบเอกสารเลขที่\x20\x22','image/jpeg','bind','input','EfWXR','acGap','\x22\x20เอกสาร','apply','eTWLz','GDEAB','unlFN','eXhNl','เอกสารที่ตันเองไม่ได้สร้าง','Htaxv','KhlUe','NqSWY','JujOi','setContent','get_Info_ByUrl','bWmeE','ofuXT','HAUxT','dbUrl','eVfrU','collection','zMozg','warehouseIn','nxQBW','FEVgC','WHNAl','debu','uyPDo','ยกเลิก','BezLk','Cvdxq','XEONA','xsFLR','zADLS','mfAsz','OkMgZ','qaeQI','TVCzw','DRGDv','CUQKL','LjIxT','tKgyn','yellow','lXMTB','\x22\x20{{sep}}เรียบร้อยแล้ว','QQfEn','oTuiX','SSvYi','prototype','TubmP','warehouseOut','ysMPt','ugUZw','ATVdm','YnAsR','launch','IVmbO','LZxpp','nkzMM','constructor','JKpOn','while\x20(true)\x20{}','pZUGE','MluQR','bKrwD','tEVya','EfOLl','AndRy','ekaxj','zSvSF','NCiuN','gAMaW','XfVAq','jLIbe','aOIky','SDaKX','LQAYX','shDvV','ntyMe','sqeOR','NbqYm','7087542HdDynu','replace','string','gycLT','YpuWK','hkPWi','length','counter','fPNYD','KMlXz','image','MSXaH','XFQNG','getItems_for_Modal','nKsxx','XFanq','NHIAs','Rmxvx','LqRis','228IMoSDX','pmdjT','error','AxGnr','mVLTv','ไม่พบเอกสาร\x20\x22','xONPW','1325804ywyyuD','eYOsy','cancel','send','BTmiB','HnDKg','Spbft','Uujxa','.jpeg','iqdgv','JyikS','rkWxy','fBylL','qVnIt','close','documentElement','includes','JeHqP','DYafS','changesHistory','gneBQ','txmqo','stringify','findOne','screenshot','mOEcK','getUserData','CrEPa','push','pXvuX','evaluate','onsNi','function\x20*\x5c(\x20*\x5c)','44290VAeiVY','YcSGr','OkGQq','pFxhm','jRuDY','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','branchName','fgQvA','ZhENO','docStatusNumber','Xhjko','active','FcqwZ','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','xsuVg','QovEb','cROPQ','bXgLU','NhTxj','mAvza','chitg','WhvHI','/load-last','wKTea','yvyYv','bEjNW','jCSRC','VWKQK','FVDyn','call','docId','oTNld','kFria','doc_changes.ejs','pMrsU','ThvjG','pMmdn','IRJUe','yqvhF','ucOOV','modifiedCount','\x22\x20เรียบร้อยแล้ว','dateTimeEditRemain','8Pbmcxb','tDBaf','qGtLK','APJey','LrCKo','message'];_0x47f9=function(){return _0x80a03f;};return _0x47f9();}export default b;function _0x5876dc(_0x537935){const _0xeeee48=_0xa0995c,_0x103e0a={'eXhNl':function(_0x1abda9,_0x2e9b6d){return _0x1abda9===_0x2e9b6d;},'ZuwXk':_0xeeee48(0x2d9),'OOYsM':'while\x20(true)\x20{}','TjOmN':'counter','QQfEn':function(_0x416bac,_0x39d99e){return _0x416bac!==_0x39d99e;},'HEdfV':function(_0x5f24ec,_0x486676){return _0x5f24ec+_0x486676;},'SDaKX':function(_0x43229e,_0x410726){return _0x43229e/_0x410726;},'BSeNr':_0xeeee48(0x2dd),'wKTea':function(_0xd07313,_0x4f445b){return _0xd07313%_0x4f445b;},'VVjhM':function(_0x53cf66,_0xc78aaf){return _0x53cf66+_0xc78aaf;},'PyJBi':_0xeeee48(0x2a0),'CUQKL':_0xeeee48(0x202),'eVfrU':'action','ofuXT':'stateObject','AxGnr':function(_0x586c7a,_0x557526){return _0x586c7a(_0x557526);},'yvyYv':function(_0x1fe3d9,_0x3bff2f){return _0x1fe3d9(_0x3bff2f);}};function _0x2baf1d(_0x5a2894){const _0x422d7c=_0xeeee48;if(_0x103e0a['eXhNl'](typeof _0x5a2894,_0x103e0a['ZuwXk']))return function(_0x2da4b2){}[_0x422d7c(0x2c1)](_0x103e0a['OOYsM'])[_0x422d7c(0x289)](_0x103e0a['TjOmN']);else _0x103e0a[_0x422d7c(0x2b3)](_0x103e0a[_0x422d7c(0x23f)]('',_0x103e0a[_0x422d7c(0x2d1)](_0x5a2894,_0x5a2894))[_0x103e0a['BSeNr']],0x1)||_0x103e0a[_0x422d7c(0x28d)](_0x103e0a[_0x422d7c(0x329)](_0x5a2894,0x14),0x0)?function(){return!![];}[_0x422d7c(0x2c1)](_0x103e0a[_0x422d7c(0x258)](_0x103e0a[_0x422d7c(0x1f8)],_0x103e0a[_0x422d7c(0x2ad)]))['call'](_0x103e0a[_0x422d7c(0x299)]):function(){return![];}[_0x422d7c(0x2c1)](_0x103e0a[_0x422d7c(0x258)](_0x103e0a[_0x422d7c(0x1f8)],_0x103e0a[_0x422d7c(0x2ad)]))[_0x422d7c(0x289)](_0x103e0a[_0x422d7c(0x296)]);_0x103e0a[_0x422d7c(0x2ed)](_0x2baf1d,++_0x5a2894);}try{if(_0x537935)return _0x2baf1d;else _0x103e0a[_0xeeee48(0x32a)](_0x2baf1d,0x0);}catch(_0x2e2c8b){}}