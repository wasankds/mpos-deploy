function _0x8523(_0x54cc9f,_0x32e780){const _0x246415=_0x2834();return _0x8523=function(_0x583b64,_0x61f8bd){_0x583b64=_0x583b64-0x13f;let _0x3f935d=_0x246415[_0x583b64];return _0x3f935d;},_0x8523(_0x54cc9f,_0x32e780);}function _0x2834(){const _0x4a13b7=['get_StatusName_byStatusNumber','mqKuX','igbKi','USXoo','jaIDo','dQTaI','while\x20(true)\x20{}','BiJlV','Ksmss','UFaGl','sbbTb','QZsPI','xIIvQ','MPvxa','writeHead','Hcrdy','cwgIx','WSjNU','jcwji','PaZMc','cpasx','userAuthority','userId','rREQB','canCancel','tXihP','yellow','lbAJK','ZhHpR','eqCNo','IFkzz','ไม่พบเอกสารเลขที่\x20\x22','LWQLb','OLbMe','hgHye','collection','UPdZp','post','jpeg','docId','NXmnl','gger','IqNlk','323680TuRYmd','PATH_SALES','/search','wUPxL','yxQzv','oNoNw','PftuC','dlxTC','XYFgz','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','459591PHcpyj','getUserData','constructor','rZIMl','khmrr','pIlZS','close','ydLCx','ZxONp','findOne','pvZuT','newPage','convert_DocPrint','เอกสาร\x20\x22','oKgiV','TvqJP','doc_print.ejs','ymtnO','string','เอกสารที่ตันเองไม่ได้สร้าง','KnmZw','\x22\x20เรียบร้อยแล้ว','afAua','UxUki','YPKXM','vlVtV','APuxR','NinMX','WCYIV','nyLNW','evShH','RPxDn','FIUHR','branchId','/load','connect','debu','BvbVt','25wOglfE','rHfOB','puppeteer','yweFM','VRiLy','NGNrG','JfuFA','log','QNzHQ','mdyVG','TfmBq','PJPzF','pyUdt','unSrL','VSbFF','KSqbT','body','ilmoQ','tthhG','oXhdi','offsetHeight','check_DocDateTime_CanCancel','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','dbName','replace','__proto__','getChangeHistory','ZLQwE','launch','renderView','warn','JjpJi','pxJXG','nWGcR','pQcGo','QMkrF','kpPAb','message','fvgnB','RnBZV','floor','aggregate','image/jpeg','XFBxC','green','XIAFd','formatDate','pHNCD','MUbFC','cancel','.jpeg','input','modifiedCount','wJJAB','ZvImA','ไม่พบเอกสาร\x20\x22','jEbgr','bind','/changes','length','prototype','vWjKQ','zEdvI','HKvln','OuLoX','pFITZ','zazdH','dypTO','ffGaj','maaJd','IkTzA','zHBue','rsCaj','IuPAC','DfhZY','IpQUd','hnUvH','XDGkN','EmpfL','FAdUt','VrJPh','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','load','QBhxu','pInRy','JyxYx','IcJXh','QXqKr','kLXmN','QQOdt','xPnZb','CpfNp','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','พบ\x20\x22','ZKWMi','tPtuu','oubWO','znjOR','uyZJh','{{sep}}หรือไม่มีสิทธิ์','jsmXS','SEPgz','zJvBq','rayrN','POCKW','WTZqp','DWZDy','\x20ไม่เปลี่ยนแปลง\x22','attachment;\x20filename=','trace','fzxHh','GIWRW','wpQJM','ไม่พบเอกสารล่าสุด','error','DOUZZ','updateOne','XWAEo','vSlrX','PATH_WAREHOUSE_IN','mJKqi','GlibE','counter','dOavF','wPiLM','YfZoo','test','1665924AVYGJu','formatDateTime','qcEaz','OwRiM','kfjiL','YQesW','hvpck','NFuwR','docTitle','sEQLl','getItemsCategory','GVmhJ','join','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','mGMOP','ooWYq','check_DocDateTime_CanEdit','KuDRI','table','eDLCl','/status','red','scrollHeight','glqFY','nlztB','GDCDz','KpQCQ','sWNMY','UsibY','LkiPf','PBZmk','XEiVX','sxOgH','canEdit','xbzGC','218226nUujYW','originalUrl','documentElement','yZkdb','Sfpgw','gtDuZ','MCTNX','{}.constructor(\x22return\x20this\x22)(\x20)','JEmSk','Mpcty','evaluate','action','/print','kgvUh','eiaeY','dbUrl','qfkoD','OrrPC','RZjwJ','YcxeW','tGyeP','OMaXV','dateTimeCanEdit','dXdxX','qjVDS','yHhMa','DYJOq','MBwmU','nWDvK','ไม่พบประวัติการเปลี่ยนแปลง','gQFlk','uDyoO','send','stringify','stock','console','doQPR','bRuxc','PATH_WAREHOUSE_OUT','wSpJF','TxcrT','bNIRt','init','call','vNzhC','mQrqi','uWFBE','ZXhXE','screenshot','BSTWy','OFQmC','qmiAL','YwtsN','52260MuPMMk','/fetch/modal','CGNYP','mRpSD','sJRoQ','isAuth','BFuIt','{{sep}}[บันทึกการแก้ไข]','mckDr','max','toString','chain','hcYFt','aHbqE','dateTimeCancelRemain','sYZxb','getMainDocPathObj','yHKuM','ClbrX','HGOCh','oGkgC','clientHeight','docStatusNumber','end','error\x20===>\x20','gEeIz','qvulP','iASmU','bqzFK','warehouseIn','SWApq','KbqLg','GzNDw','xhxmE','includes','mmiwJ','AFTdC','rXcwd','HOarq','print','Router','DOC_TYPE','270690JlJVeW','HYtbv','225qmfoll','EWNHA','326900uFCAtE','FLKOc','function\x20*\x5c(\x20*\x5c)','matchedCount','apply','JTXda','NWxGb','ISaxt','CtufY','BSluH','kPiOv','dateTimeEditRemain','JpKrg','gbNBg','setViewport','gXKym','BfFwX','IOqNX','getItems_for_Modal','ยกเลิก','\x22\x20เอกสาร','info','YfDNc','ElnAg','BpIdz','iYpYj','LzMud','/load-last','get_Info_ByUrl'];_0x2834=function(){return _0x4a13b7;};return _0x2834();}const _0xbf1059=_0x8523;(function(_0x6d9f4e,_0x232ca2){const _0x1f7a58=_0x8523,_0x2657f9=_0x6d9f4e();while(!![]){try{const _0x2eb4bf=parseInt(_0x1f7a58(0x152))/0x1+parseInt(_0x1f7a58(0x21b))/0x2+parseInt(_0x1f7a58(0x1f8))/0x3+-parseInt(_0x1f7a58(0x250))/0x4+-parseInt(_0x1f7a58(0x178))/0x5*(-parseInt(_0x1f7a58(0x27a))/0x6)+-parseInt(_0x1f7a58(0x27e))/0x7+parseInt(_0x1f7a58(0x148))/0x8*(-parseInt(_0x1f7a58(0x27c))/0x9);if(_0x2eb4bf===_0x232ca2)break;else _0x2657f9['push'](_0x2657f9['shift']());}catch(_0x18123e){_0x2657f9['push'](_0x2657f9['shift']());}}}(_0x2834,0x43f32));const _0x295bbe=(function(){const _0x45931f=_0x8523,_0x56ab8d={'dypTO':function(_0x39ab8d,_0x3555a6){return _0x39ab8d(_0x3555a6);},'mWQqK':function(_0x4c0338,_0x3c40d6){return _0x4c0338===_0x3c40d6;},'jsmXS':'zyfsx','MBwmU':'xqdrM','aPqll':function(_0x36f12a,_0x58d8de){return _0x36f12a!==_0x58d8de;},'KpQCQ':_0x45931f(0x1d2),'ElnAg':function(_0x10f8db,_0x42fde8){return _0x10f8db!==_0x42fde8;},'wSpJF':_0x45931f(0x1e3),'evShH':'Bjybw'};let _0x25af7d=!![];return function(_0x3107b2,_0xcb27e7){const _0x5b9199=_0x45931f;if(_0x56ab8d[_0x5b9199(0x295)](_0x56ab8d[_0x5b9199(0x242)],_0x56ab8d[_0x5b9199(0x170)])){const _0x58a811=_0x25af7d?function(){const _0x49c241=_0x5b9199,_0x257c02={'qjVDS':function(_0x4d0f88,_0x1806c2){const _0x59ac54=_0x8523;return _0x56ab8d[_0x59ac54(0x1bb)](_0x4d0f88,_0x1806c2);}};if(_0x56ab8d['mWQqK'](_0x56ab8d[_0x49c241(0x1dd)],_0x56ab8d[_0x49c241(0x236)]))return!![];else{if(_0xcb27e7){if(_0x56ab8d['aPqll'](_0x56ab8d['KpQCQ'],_0x56ab8d[_0x49c241(0x212)]))_0x257c02[_0x49c241(0x233)](_0x48bd61,0x0);else{const _0x2dd280=_0xcb27e7[_0x49c241(0x282)](_0x3107b2,arguments);return _0xcb27e7=null,_0x2dd280;}}}}:function(){};return _0x25af7d=![],_0x58a811;}else{const _0x23b408=_0xba3b2?function(){if(_0x524310){const _0x385db4=_0x5b1b8d['apply'](_0xfe0936,arguments);return _0x3734ea=null,_0x385db4;}}:function(){};return _0x5ce321=![],_0x23b408;}};}());(function(){const _0x43012b=_0x8523,_0x5df75e={'OrrPC':_0x43012b(0x20d),'YPKXM':function(_0x4420f0,_0x3eac19){return _0x4420f0(_0x3eac19);},'tXihP':function(_0x385219,_0x19463c){return _0x385219===_0x19463c;},'JjpJi':_0x43012b(0x25c),'FLKOc':_0x43012b(0x280),'eqCNo':_0x43012b(0x205),'eiaeY':function(_0x45df6c,_0x128c83){return _0x45df6c(_0x128c83);},'mKBbW':_0x43012b(0x245),'JTXda':function(_0xe6fae2,_0x4f8898){return _0xe6fae2+_0x4f8898;},'qcEaz':_0x43012b(0x25b),'lbAJK':function(_0x337059,_0x21729b){return _0x337059+_0x21729b;},'oubWO':_0x43012b(0x1ab),'xbzGC':function(_0x1f53f4,_0x2520f9){return _0x1f53f4!==_0x2520f9;},'LkiPf':_0x43012b(0x1ce),'sxOgH':_0x43012b(0x1f4),'ISaxt':function(_0x23de4c,_0x4545be){return _0x23de4c!==_0x4545be;},'qmiAL':_0x43012b(0x1d1),'AuswL':function(_0xbb53a3){return _0xbb53a3();},'oXhdi':function(_0x1d56f5,_0x406d05,_0x246aaa){return _0x1d56f5(_0x406d05,_0x246aaa);}};_0x5df75e[_0x43012b(0x18b)](_0x295bbe,this,function(){const _0x5278f4=_0x43012b,_0x4c12b6={'RhyVJ':function(_0xb93818,_0x563077){const _0x1dcf9e=_0x8523;return _0x5df75e[_0x1dcf9e(0x16a)](_0xb93818,_0x563077);}};if(_0x5df75e[_0x5278f4(0x2b4)](_0x5df75e[_0x5278f4(0x197)],_0x5df75e[_0x5278f4(0x197)])){const _0x4259fc=new RegExp(_0x5df75e[_0x5278f4(0x27f)]),_0x230065=new RegExp(_0x5df75e[_0x5278f4(0x2b8)],'i'),_0x544ee0=_0x5df75e[_0x5278f4(0x229)](_0x3e611c,_0x5df75e['mKBbW']);if(!_0x4259fc[_0x5278f4(0x1f7)](_0x5df75e[_0x5278f4(0x283)](_0x544ee0,_0x5df75e[_0x5278f4(0x1fa)]))||!_0x230065[_0x5278f4(0x1f7)](_0x5df75e[_0x5278f4(0x2b6)](_0x544ee0,_0x5df75e[_0x5278f4(0x1d9)])))_0x5df75e[_0x5278f4(0x21a)](_0x5df75e[_0x5278f4(0x215)],_0x5df75e[_0x5278f4(0x218)])?_0x5df75e['YPKXM'](_0x544ee0,'0'):_0x27764d[_0x5278f4(0x158)]();else{if(_0x5df75e[_0x5278f4(0x285)](_0x5df75e[_0x5278f4(0x24e)],_0x5df75e[_0x5278f4(0x24e)]))return _0x502c5a['log'](_0x5dc0c4),_0xb21c5e['send'](_0x5eec73[_0x5278f4(0x23c)]({'isFetch':!0x1,'class':_0x5df75e[_0x5278f4(0x22c)],'msg':_0xd1af5b['message']}));else _0x5df75e['AuswL'](_0x3e611c);}}else{if(_0x4d7568)return _0x577031;else _0x4c12b6['RhyVJ'](_0x4e3394,0x0);}})();}());const _0x61f8bd=(function(){const _0x8f248c=_0x8523,_0x4dc6cd={'flBUs':_0x8f248c(0x280),'hRNOn':_0x8f248c(0x205),'Wlcux':function(_0x59fbba,_0x105504){return _0x59fbba(_0x105504);},'VKZmX':_0x8f248c(0x245),'bqzFK':function(_0x288639,_0x5d994c){return _0x288639+_0x5d994c;},'dXdxX':_0x8f248c(0x25b),'MPvxa':_0x8f248c(0x1ab),'WTZqp':function(_0x3de56c){return _0x3de56c();},'heDcF':function(_0x14f951,_0xea872a,_0x16f9e1){return _0x14f951(_0xea872a,_0x16f9e1);},'iYpYj':function(_0x39e91d,_0x1c507f){return _0x39e91d+_0x1c507f;},'JeSxd':'debu','FAdUt':_0x8f248c(0x146),'mdyVG':'action','mGMOP':function(_0x3eaf9c,_0x4a0df3){return _0x3eaf9c===_0x4a0df3;},'BSluH':'KjwCY','CgPdq':function(_0x5f1cad,_0x30ddae){return _0x5f1cad===_0x30ddae;},'WCYIV':'HbxZR','yxQzv':_0x8f248c(0x169),'POCKW':function(_0x5084f5,_0x449632){return _0x5084f5!==_0x449632;},'sWNMY':_0x8f248c(0x210)};let _0xcc6977=!![];return function(_0x407d42,_0x19cb7f){const _0x372882=_0x8f248c,_0x57488c={'uyZJh':_0x4dc6cd['flBUs'],'CkIiq':_0x4dc6cd['hRNOn'],'pyUdt':function(_0x62310f,_0x36dfd3){return _0x4dc6cd['Wlcux'](_0x62310f,_0x36dfd3);},'GnDSr':_0x4dc6cd['VKZmX'],'Hcrdy':function(_0x1a793f,_0x54171d){const _0x5aef24=_0x8523;return _0x4dc6cd[_0x5aef24(0x26c)](_0x1a793f,_0x54171d);},'KnmZw':_0x4dc6cd[_0x372882(0x232)],'MMLaH':function(_0x5ed9de,_0x4959c6){const _0x2871da=_0x372882;return _0x4dc6cd[_0x2871da(0x26c)](_0x5ed9de,_0x4959c6);},'IkTzA':_0x4dc6cd[_0x372882(0x2a8)],'oGkgC':function(_0x2bf662){const _0xe82800=_0x372882;return _0x4dc6cd[_0xe82800(0x1e2)](_0x2bf662);},'VrJPh':function(_0x2ecd2d,_0x12f114,_0x542e8c){return _0x4dc6cd['heDcF'](_0x2ecd2d,_0x12f114,_0x542e8c);},'kpPAb':function(_0x3ff11e,_0x2a9392){const _0x180181=_0x372882;return _0x4dc6cd[_0x180181(0x297)](_0x3ff11e,_0x2a9392);},'bNIRt':_0x4dc6cd['JeSxd'],'XSJcw':_0x4dc6cd[_0x372882(0x1c7)],'ZrscZ':_0x4dc6cd[_0x372882(0x181)],'oNoNw':function(_0x393681,_0x25e07a){const _0x359213=_0x372882;return _0x4dc6cd[_0x359213(0x206)](_0x393681,_0x25e07a);},'YcxeW':_0x4dc6cd[_0x372882(0x287)],'wMvmt':function(_0x29b14d,_0x294fb5){return _0x4dc6cd['CgPdq'](_0x29b14d,_0x294fb5);},'IOqNX':_0x4dc6cd[_0x372882(0x16e)],'ZaqCa':_0x4dc6cd[_0x372882(0x14c)]};if(_0x4dc6cd[_0x372882(0x1e1)](_0x4dc6cd[_0x372882(0x213)],_0x4dc6cd[_0x372882(0x213)])){const _0x751910={'glqFY':_0x57488c[_0x372882(0x1db)],'XEiVX':_0x57488c['CkIiq'],'KSqbT':function(_0x4cbc03,_0x5aff95){return _0x57488c['pyUdt'](_0x4cbc03,_0x5aff95);},'doQPR':_0x57488c['GnDSr'],'HKvln':function(_0x51049a,_0x4e63dd){const _0x4d654c=_0x372882;return _0x57488c[_0x4d654c(0x2aa)](_0x51049a,_0x4e63dd);},'PEBFH':_0x57488c[_0x372882(0x166)],'XWAEo':function(_0x103411,_0x1076e9){return _0x57488c['MMLaH'](_0x103411,_0x1076e9);},'fvgnB':_0x57488c[_0x372882(0x1be)],'RPxDn':function(_0x38d3ca,_0x3725b1){const _0x346c8e=_0x372882;return _0x57488c[_0x346c8e(0x184)](_0x38d3ca,_0x3725b1);},'uNpgh':function(_0x2d40c4){const _0x505fa5=_0x372882;return _0x57488c[_0x505fa5(0x264)](_0x2d40c4);}};_0x57488c[_0x372882(0x1c8)](_0x4eb1f8,this,function(){const _0x19f8ab=_0x372882,_0x165886=new _0x12fe8d(_0x751910[_0x19f8ab(0x20f)]),_0x3dfb5f=new _0x5c582b(_0x751910[_0x19f8ab(0x217)],'i'),_0x178d9e=_0x751910[_0x19f8ab(0x187)](_0x586029,_0x751910[_0x19f8ab(0x23f)]);!_0x165886['test'](_0x751910[_0x19f8ab(0x1b7)](_0x178d9e,_0x751910['PEBFH']))||!_0x3dfb5f[_0x19f8ab(0x1f7)](_0x751910[_0x19f8ab(0x1ee)](_0x178d9e,_0x751910[_0x19f8ab(0x19e)]))?_0x751910[_0x19f8ab(0x171)](_0x178d9e,'0'):_0x751910['uNpgh'](_0x9c14c8);})();}else{const _0xcb94db=_0xcc6977?function(){const _0x4da744=_0x372882,_0x20ba32={'LzMud':function(_0x50c0d7,_0xd13e53){const _0x204fbe=_0x8523;return _0x57488c[_0x204fbe(0x19c)](_0x50c0d7,_0xd13e53);},'qfkoD':_0x57488c[_0x4da744(0x244)],'XDGkN':_0x57488c['XSJcw'],'BvbVt':_0x57488c['ZrscZ']};if(_0x57488c[_0x4da744(0x14d)](_0x57488c[_0x4da744(0x22e)],_0x57488c[_0x4da744(0x22e)])){if(_0x19cb7f){if(_0x57488c['wMvmt'](_0x57488c[_0x4da744(0x28f)],_0x57488c['ZaqCa']))(function(){return!![];}[_0x4da744(0x154)](_0x20ba32[_0x4da744(0x298)](_0x20ba32[_0x4da744(0x22b)],_0x20ba32[_0x4da744(0x1c5)]))[_0x4da744(0x246)](_0x20ba32[_0x4da744(0x177)]));else{const _0x4fd8b4=_0x19cb7f[_0x4da744(0x282)](_0x407d42,arguments);return _0x19cb7f=null,_0x4fd8b4;}}}else{const _0x4c0540=_0x1cef64[_0x4da744(0x282)](_0x526c7e,arguments);return _0x563019=null,_0x4c0540;}}:function(){};return _0xcc6977=![],_0xcb94db;}};}()),_0x583b64=_0x61f8bd(this,function(){const _0x5652f2=_0x8523,_0x3697b5={'rREQB':function(_0x5c189f,_0x5b3f95){return _0x5c189f(_0x5b3f95);},'gtDuZ':function(_0xb3a326,_0x80d92d){return _0xb3a326+_0x80d92d;},'hvpck':'return\x20(function()\x20','XYFgz':_0x5652f2(0x222),'sJRoQ':function(_0x38a831,_0xd889aa){return _0x38a831+_0xd889aa;},'vSlrX':function(_0x312f38,_0x46cf92){return _0x312f38!==_0x46cf92;},'tGyeP':'ZEdwS','aHbqE':'MlReH','kLXmN':function(_0xa85b0d,_0x1dd7b0){return _0xa85b0d+_0x1dd7b0;},'zazdH':function(_0x53787f,_0x51fd25){return _0x53787f+_0x51fd25;},'GDCDz':function(_0x15d22c,_0x4a3d5c){return _0x15d22c!==_0x4a3d5c;},'CpfNp':'xzBRG','htFpN':_0x5652f2(0x1ae),'DYJOq':_0x5652f2(0x20d),'RnBZV':function(_0x14d344){return _0x14d344();},'mRpSD':_0x5652f2(0x17f),'Vzhmk':_0x5652f2(0x196),'jcwji':_0x5652f2(0x293),'TfmBq':_0x5652f2(0x1eb),'afAua':'exception','DfhZY':_0x5652f2(0x20a),'HYtbv':_0x5652f2(0x1e6),'rsCaj':function(_0x3eb0e4,_0x4caba4){return _0x3eb0e4<_0x4caba4;},'rpzqW':function(_0xcdc816,_0x38b078){return _0xcdc816===_0x38b078;},'kgvUh':_0x5652f2(0x29d),'EmpWn':_0x5652f2(0x2a4)},_0xa7a8e0=function(){const _0x12c457=_0x5652f2,_0x18a4b4={'vWjKQ':function(_0x2d016d,_0x4b6ef0){const _0x2cc874=_0x8523;return _0x3697b5[_0x2cc874(0x2b2)](_0x2d016d,_0x4b6ef0);},'sbbTb':function(_0x356325,_0x3a6b7d){return _0x3697b5['gtDuZ'](_0x356325,_0x3a6b7d);},'wUPxL':function(_0xbce4a1,_0x344533){const _0x108641=_0x8523;return _0x3697b5[_0x108641(0x254)](_0xbce4a1,_0x344533);},'nWGcR':_0x3697b5['hvpck'],'yHKuM':_0x3697b5[_0x12c457(0x150)]};if(_0x3697b5[_0x12c457(0x1ef)](_0x3697b5[_0x12c457(0x22f)],_0x3697b5[_0x12c457(0x22f)]))_0x19b30a=_0x3697b5['rREQB'](_0x216459,_0x3697b5['gtDuZ'](_0x3697b5[_0x12c457(0x220)](_0x3697b5[_0x12c457(0x1fe)],_0x3697b5['XYFgz']),');'))();else{let _0x3c369e;try{if(_0x3697b5[_0x12c457(0x1ef)](_0x3697b5[_0x12c457(0x25d)],_0x3697b5[_0x12c457(0x25d)])){let _0x277085;try{_0x277085=_0x18a4b4[_0x12c457(0x1b5)](_0x450d1b,_0x18a4b4[_0x12c457(0x2a5)](_0x18a4b4[_0x12c457(0x14b)](_0x18a4b4[_0x12c457(0x199)],_0x18a4b4[_0x12c457(0x261)]),');'))();}catch(_0x507085){_0x277085=_0x474a7d;}return _0x277085;}else _0x3c369e=_0x3697b5[_0x12c457(0x2b2)](Function,_0x3697b5[_0x12c457(0x1d0)](_0x3697b5[_0x12c457(0x1ba)](_0x3697b5[_0x12c457(0x1fe)],_0x3697b5[_0x12c457(0x150)]),');'))();}catch(_0x3751){if(_0x3697b5[_0x12c457(0x211)](_0x3697b5[_0x12c457(0x1d3)],_0x3697b5['htFpN']))_0x3c369e=window;else{const _0x2a7b35=_0x59cae4[_0x12c457(0x282)](_0x2733b0,arguments);return _0x2206c5=null,_0x2a7b35;}}return _0x3c369e;}},_0x1434a7=_0x3697b5[_0x5652f2(0x19f)](_0xa7a8e0),_0x5dc373=_0x1434a7[_0x5652f2(0x23e)]=_0x1434a7[_0x5652f2(0x23e)]||{},_0x1d81ff=[_0x3697b5[_0x5652f2(0x253)],_0x3697b5['Vzhmk'],_0x3697b5[_0x5652f2(0x2ad)],_0x3697b5[_0x5652f2(0x182)],_0x3697b5[_0x5652f2(0x168)],_0x3697b5[_0x5652f2(0x1c2)],_0x3697b5[_0x5652f2(0x27b)]];for(let _0x5b7fc9=0x0;_0x3697b5[_0x5652f2(0x1c0)](_0x5b7fc9,_0x1d81ff[_0x5652f2(0x1b3)]);_0x5b7fc9++){if(_0x3697b5['rpzqW'](_0x3697b5[_0x5652f2(0x228)],_0x3697b5['EmpWn']))return _0x148e84[_0x5652f2(0x17f)](_0x1857a0),_0x33b545[_0x5652f2(0x23b)](_0xb4d70[_0x5652f2(0x23c)]({'isLoad':!0x1,'class':_0x3697b5[_0x5652f2(0x235)],'msg':_0x694bf7[_0x5652f2(0x19d)]}));else{const _0x5425a5=_0x61f8bd[_0x5652f2(0x154)]['prototype'][_0x5652f2(0x1b1)](_0x61f8bd),_0x252182=_0x1d81ff[_0x5b7fc9],_0x33b5dd=_0x5dc373[_0x252182]||_0x5425a5;_0x5425a5[_0x5652f2(0x191)]=_0x61f8bd[_0x5652f2(0x1b1)](_0x61f8bd),_0x5425a5['toString']=_0x33b5dd['toString']['bind'](_0x33b5dd),_0x5dc373[_0x252182]=_0x5425a5;}}});_0x583b64();import _0x49405d from'express';const b=_0x49405d[_0xbf1059(0x278)]();import _0x1e0e57 from'path';import{MongoClient as _0x54660d}from'mongodb';import _0x144adb from'../middleware/mainAuth.js';import*as _0x1f3b18 from'../mymodule/myUsers.js';import*as _0x326efc from'../mymodule/myDateTime.js';import*as _0x538371 from'../mymodule/myModule.js';import*as _0x54d902 from'../mymodule/myDocMain.js';import*as _0x4f5032 from'../mymodule/myData.js';const w=global[_0xbf1059(0x1f0)],S=global[_0xbf1059(0x241)],p=global[_0xbf1059(0x149)],M=[w+_0xbf1059(0x1b2),S+_0xbf1059(0x1b2),p+_0xbf1059(0x1b2)],v=[w+'/print',S+_0xbf1059(0x227),p+'/print'],k=[w+_0xbf1059(0x20c),S+'/status',p+_0xbf1059(0x20c)],B=[w+_0xbf1059(0x14a),S+_0xbf1059(0x14a),p+_0xbf1059(0x14a)],x=[w+_0xbf1059(0x174),S+_0xbf1059(0x174),p+_0xbf1059(0x174),w+_0xbf1059(0x299),S+_0xbf1059(0x299),p+_0xbf1059(0x299)],L=[w+_0xbf1059(0x251),S+_0xbf1059(0x251),p+'/fetch/modal'];b['get'](L,_0x144adb['isAuth'],async(_0x2cedb0,_0x741ef7)=>{const _0x201ecb=_0xbf1059,_0x977e36={'JIYIR':_0x201ecb(0x2a1),'maaJd':_0x201ecb(0x1f3),'ZXhXE':function(_0x2993f3,_0x21cd9d){return _0x2993f3!==_0x21cd9d;},'pHNCD':_0x201ecb(0x2af),'vlVtV':function(_0x45bf7c,_0x4cff26){return _0x45bf7c==_0x4cff26;},'jaIDo':_0x201ecb(0x26d),'uDyoO':_0x201ecb(0x23d),'khmrr':function(_0x23829f,_0xeb5e70){return _0x23829f==_0xeb5e70;},'AtfGb':'warehouseOut','QMkrF':function(_0x1c5584,_0x24405b){return _0x1c5584==_0x24405b;},'TvqJP':'sales','WSjNU':'active','nyLNW':'green','GIWRW':_0x201ecb(0x18e),'xhxmE':function(_0xe99470,_0x33ad53){return _0xe99470===_0x33ad53;},'unSrL':'kmOEp','ZYoRd':'red'},_0x1ae5c3=await _0x1f3b18['getUserData'](_0x2cedb0),_0x301fa1=await _0x54d902['getMainDocPathObj'](_0x2cedb0,_0x741ef7,_0x1ae5c3['userAuthority']);try{if(_0x977e36[_0x201ecb(0x24a)](_0x977e36[_0x201ecb(0x1a7)],_0x977e36['pHNCD']))return function(_0x12c76f){}['constructor'](JDuVGG['JIYIR'])['apply'](JDuVGG[_0x201ecb(0x1bd)]);else{if(_0x977e36[_0x201ecb(0x16b)](_0x301fa1[_0x201ecb(0x279)],_0x977e36[_0x201ecb(0x29f)]))var _0x3f6957=await _0x4f5032[_0x201ecb(0x290)](_0x977e36['uDyoO']);else{if(_0x977e36[_0x201ecb(0x156)](_0x301fa1[_0x201ecb(0x279)],_0x977e36['AtfGb']))var _0x3f6957=await _0x4f5032[_0x201ecb(0x290)](_0x977e36[_0x201ecb(0x23a)]);else{if(_0x977e36[_0x201ecb(0x19b)](_0x301fa1['DOC_TYPE'],_0x977e36[_0x201ecb(0x161)]))var _0x3f6957=await _0x4f5032[_0x201ecb(0x290)](_0x977e36[_0x201ecb(0x2ac)]);}}const _0x302ec7=await _0x4f5032[_0x201ecb(0x202)]();return _0x741ef7['send'](JSON['stringify']({'DATA_ITEMS':_0x3f6957,'DATA_CATEGORY':_0x302ec7,'isFetch':!0x0,'class':_0x977e36[_0x201ecb(0x16f)],'msg':_0x977e36[_0x201ecb(0x1e8)]}));}}catch(_0x4f77c1){if(_0x977e36[_0x201ecb(0x271)](_0x977e36['unSrL'],_0x977e36[_0x201ecb(0x185)]))return console[_0x201ecb(0x17f)](_0x4f77c1),_0x741ef7['send'](JSON[_0x201ecb(0x23c)]({'isFetch':!0x1,'class':_0x977e36['ZYoRd'],'msg':_0x4f77c1[_0x201ecb(0x19d)]}));else _0x3a2b9c[_0x201ecb(0x158)]();}}),b[_0xbf1059(0x142)](B,_0x144adb[_0xbf1059(0x255)],async(_0x1108ee,_0x52be1b)=>{const _0x3a5b88=_0xbf1059,_0x1f7ab4={'RZjwJ':function(_0x5bfe1b,_0x252cfc){return _0x5bfe1b<_0x252cfc;},'USXoo':_0x3a5b88(0x2b5),'ClbrX':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','yweFM':function(_0x28d442,_0x5c6835){return _0x28d442===_0x5c6835;},'AFTdC':_0x3a5b88(0x2a0),'TxcrT':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','ppNoe':function(_0x19ac9d,_0x2251ef){return _0x19ac9d+_0x2251ef;},'rayrN':_0x3a5b88(0x1a4),'cwgIx':function(_0x32e387,_0x112c6c){return _0x32e387!==_0x112c6c;},'HGOCh':_0x3a5b88(0x239),'nWDvK':_0x3a5b88(0x20d),'kcMcj':_0x3a5b88(0x2bc),'EmpfL':_0x3a5b88(0x248)};let {sip:_0x13ef22}=_0x1108ee[_0x3a5b88(0x188)];if(!_0x13ef22&&_0x1f7ab4[_0x3a5b88(0x22d)](_0x13ef22[_0x3a5b88(0x1b3)],0x2))return _0x52be1b[_0x3a5b88(0x23b)](JSON[_0x3a5b88(0x23c)]({'isSearch':!0x1,'class':_0x1f7ab4[_0x3a5b88(0x29e)],'msg':_0x1f7ab4[_0x3a5b88(0x262)]}));_0x13ef22=_0x13ef22[_0x3a5b88(0x190)](/[!@#$%^&*<>]/g,'')??null;const _0xc8ee89=await _0x1f3b18['getUserData'](_0x1108ee);await _0x54d902[_0x3a5b88(0x260)](_0x1108ee,_0x52be1b,_0xc8ee89[_0x3a5b88(0x2b0)]);const {collectionName:_0x581ad5}=_0x4f5032['get_Info_ByUrl'](_0x1108ee[_0x3a5b88(0x21c)]),_0x46fdc8=new _0x54660d(global['dbUrl']);try{if(_0x1f7ab4['yweFM'](_0x1f7ab4[_0x3a5b88(0x274)],_0x1f7ab4[_0x3a5b88(0x274)])){await _0x46fdc8['connect']();const _0x5daf31=_0x46fdc8['db'](global[_0x3a5b88(0x18f)])[_0x3a5b88(0x140)](_0x581ad5),_0x457818=[{'$or':[{'docId':{'$regex':_0x13ef22,'$options':'i'}},{'docDate':{'$regex':_0x13ef22,'$options':'i'}}]}];let _0x52fb44='';['O','S'][_0x3a5b88(0x272)](_0xc8ee89[_0x3a5b88(0x2b0)])||(_0x52fb44+=_0x1f7ab4[_0x3a5b88(0x243)],_0x457818['push']({'userId':_0xc8ee89[_0x3a5b88(0x2b1)]}));const _0x34b5b0=await _0x5daf31[_0x3a5b88(0x1a1)]([{'$match':{'$and':_0x457818}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])['toArray']();return _0x52fb44=_0x1f7ab4['ppNoe'](_0x3a5b88(0x1d6)+_0x34b5b0['length']+_0x3a5b88(0x292),_0x52fb44),_0x52be1b[_0x3a5b88(0x23b)](JSON[_0x3a5b88(0x23c)]({'searchFound':_0x34b5b0,'msg':_0x52fb44,'isSearch':!0x0,'class':_0x1f7ab4[_0x3a5b88(0x1e0)]}));}else _0x104122[_0x3a5b88(0x158)]();}catch(_0x427b32){return _0x1f7ab4[_0x3a5b88(0x2ab)](_0x1f7ab4[_0x3a5b88(0x263)],_0x1f7ab4['HGOCh'])?_0x40e5fd:(console[_0x3a5b88(0x17f)](_0x427b32),_0x52be1b[_0x3a5b88(0x23b)](JSON['stringify']({'isSearch':!0x1,'class':_0x1f7ab4[_0x3a5b88(0x237)],'msg':_0x427b32[_0x3a5b88(0x19d)]})));}finally{_0x1f7ab4[_0x3a5b88(0x17b)](_0x1f7ab4['kcMcj'],_0x1f7ab4[_0x3a5b88(0x1c6)])?_0x308971[_0x3a5b88(0x158)]():_0x46fdc8[_0x3a5b88(0x158)]();}}),b[_0xbf1059(0x142)](x,_0x144adb[_0xbf1059(0x255)],async(_0x450ded,_0x214257)=>{const _0x2348b4=_0xbf1059,_0x5e1fd3={'jEbgr':function(_0x3f36a9,_0x62e5cf){return _0x3f36a9(_0x62e5cf);},'GVmhJ':function(_0x23d8a8,_0x153f35){return _0x23d8a8+_0x153f35;},'LWQLb':_0x2348b4(0x176),'BpIdz':'gger','OFQmC':'stateObject','JfuFA':_0x2348b4(0x280),'SWApq':_0x2348b4(0x205),'pQcGo':'init','eDLCl':function(_0x230d79,_0x1e8473){return _0x230d79+_0x1e8473;},'xvQPB':_0x2348b4(0x25b),'kfjiL':_0x2348b4(0x1ab),'VSbFF':function(_0xd836ca){return _0xd836ca();},'zHBue':function(_0x50500e,_0xce934){return _0x50500e===_0xce934;},'QNRKA':_0x2348b4(0x157),'ZhHpR':_0x2348b4(0x1f6),'QbhfH':function(_0x29e577,_0x3a189f){return _0x29e577===_0x3a189f;},'XIAFd':_0x2348b4(0x1ca),'pInRy':function(_0x46765f,_0x580aeb){return _0x46765f===_0x580aeb;},'rHfOB':_0x2348b4(0x249),'APuxR':function(_0x27ffb4,_0x30302b){return _0x27ffb4===_0x30302b;},'hnUvH':'load-last','sEQLl':function(_0x2e816f,_0x3fe4cc){return _0x2e816f===_0x3fe4cc;},'IuPAC':_0x2348b4(0x1ea),'faEXc':'red','yHhMa':function(_0x53b486,_0x531980){return _0x53b486==_0x531980;},'pxJXG':function(_0x7ec2ca,_0x9998b4){return _0x7ec2ca!==_0x9998b4;},'ZKWMi':_0x2348b4(0x28d),'JyxYx':function(_0x13fb0a,_0x41044a){return _0x13fb0a==_0x41044a;},'asLLr':_0x2348b4(0x1d5),'oiCWO':function(_0x23d4df,_0x4c35a9){return _0x23d4df==_0x4c35a9;},'QNzHQ':function(_0x1509be,_0x4d83a5){return _0x1509be==_0x4d83a5;},'fzxHh':function(_0x5d778f,_0x5cd3d7){return _0x5d778f===_0x5cd3d7;},'NinMX':'MLOLR','ymtnO':function(_0x5c519c,_0x283850){return _0x5c519c==_0x283850;},'gbNBg':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','OMaXV':_0x2348b4(0x1a4),'MUbFC':function(_0x4bdcd2,_0x44db05){return _0x4bdcd2!==_0x44db05;},'BfFwX':_0x2348b4(0x1df),'CGNYP':'qrcla'};let {docId:_0x1a731c,action:_0x98ab33}=_0x450ded[_0x2348b4(0x188)];const _0x2ddb24=await _0x1f3b18[_0x2348b4(0x153)](_0x450ded);await _0x54d902[_0x2348b4(0x260)](_0x450ded,_0x214257,_0x2ddb24[_0x2348b4(0x2b0)]);const {collectionName:_0x255bdb}=_0x4f5032[_0x2348b4(0x29a)](_0x450ded[_0x2348b4(0x21c)]),_0xb88bed=new _0x54660d(global[_0x2348b4(0x22a)]);try{if(_0x5e1fd3[_0x2348b4(0x1bf)](_0x5e1fd3['QNRKA'],_0x5e1fd3[_0x2348b4(0x2b7)]))QRbiIx['jEbgr'](_0x2e953e,'0');else{await _0xb88bed[_0x2348b4(0x175)]();const _0x4150f9=_0xb88bed['db'](global['dbName'])[_0x2348b4(0x140)](_0x255bdb);if(_0x5e1fd3['QbhfH'](_0x98ab33,_0x5e1fd3[_0x2348b4(0x1a5)])){if(_0x5e1fd3[_0x2348b4(0x1cc)](_0x5e1fd3[_0x2348b4(0x179)],_0x5e1fd3[_0x2348b4(0x179)])){const _0x31a868=['O','S'][_0x2348b4(0x272)](_0x2ddb24[_0x2348b4(0x2b0)])?{'docId':_0x1a731c}:{'docId':_0x1a731c,'userId':_0x2ddb24[_0x2348b4(0x2b1)]};var _0x2cfb47=await _0x4150f9[_0x2348b4(0x15b)](_0x31a868,{'projection':{'_id':0x0,'changesHistory':0x0}});}else{const _0x33f954=_0x2849d3[_0x2348b4(0x188)],_0x12c9e2=_0x3fdbad[_0x2348b4(0x21d)];return _0x150521[_0x2348b4(0x259)](_0x33f954['scrollHeight'],_0x33f954['offsetHeight'],_0x12c9e2[_0x2348b4(0x265)],_0x12c9e2[_0x2348b4(0x20e)],_0x12c9e2[_0x2348b4(0x18c)]);}}else{if(_0x5e1fd3[_0x2348b4(0x16c)](_0x98ab33,_0x5e1fd3[_0x2348b4(0x1c4)]))var _0x2cfb47=await _0x4150f9[_0x2348b4(0x15b)]({'userId':_0x2ddb24[_0x2348b4(0x2b1)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x5842c9=_0x2cfb47?'':_0x5e1fd3[_0x2348b4(0x201)](_0x98ab33,_0x5e1fd3['XIAFd'])?_0x2348b4(0x2ba)+_0x1a731c+'\x22':_0x5e1fd3[_0x2348b4(0x1c1)];if(!_0x2cfb47)return _0x214257['send'](JSON[_0x2348b4(0x23c)]({'isLoad':!0x1,'class':_0x5e1fd3['faEXc'],'msg':_0x5842c9}));let _0xad48b4='โหลดเอกสารเลขที่\x20\x22'+_0x2cfb47[_0x2348b4(0x144)]+'\x22\x20{{sep}}เรียบร้อยแล้ว';if(_0x5e1fd3[_0x2348b4(0x234)](_0x2cfb47[_0x2348b4(0x266)],0x1)&&_0x2cfb47[_0x2348b4(0x231)]){if(_0x5e1fd3[_0x2348b4(0x198)](_0x5e1fd3[_0x2348b4(0x1d7)],_0x5e1fd3[_0x2348b4(0x1d7)])){if(_0x51dcac){const _0x13ff48=_0x5c9a94['apply'](_0x422e19,arguments);return _0x525dbc=null,_0x13ff48;}}else{let _0x3679fb=await _0x4f5032[_0x2348b4(0x208)](_0x2cfb47,_0x255bdb,_0x2ddb24[_0x2348b4(0x2b1)]);_0x2cfb47[_0x2348b4(0x289)]=_0x3679fb[_0x2348b4(0x289)],_0x5e1fd3[_0x2348b4(0x1cd)](_0x3679fb[_0x2348b4(0x219)],!0x1)&&(_0x2cfb47[_0x2348b4(0x266)]=_0x3679fb[_0x2348b4(0x266)],_0xad48b4+=_0x5e1fd3['asLLr']);}}else _0x2cfb47[_0x2348b4(0x289)]='-';if((_0x5e1fd3['oiCWO'](_0x2cfb47['docStatusNumber'],0x1)||_0x5e1fd3[_0x2348b4(0x180)](_0x2cfb47['docStatusNumber'],0x2))&&_0x2cfb47['dateTimeCanCancel']){if(_0x5e1fd3[_0x2348b4(0x1e7)](_0x5e1fd3[_0x2348b4(0x16d)],_0x5e1fd3[_0x2348b4(0x16d)])){const _0x4317d4=await _0x4f5032[_0x2348b4(0x18d)](_0x2cfb47,_0x255bdb,_0x2ddb24[_0x2348b4(0x2b1)]);_0x2cfb47['dateTimeCancelRemain']=_0x4317d4[_0x2348b4(0x25e)],_0x5e1fd3[_0x2348b4(0x163)](_0x4317d4[_0x2348b4(0x2b3)],!0x1)&&(_0xad48b4+=_0x5e1fd3[_0x2348b4(0x28b)]);}else(function(){return![];}[_0x2348b4(0x154)](QRbiIx[_0x2348b4(0x203)](QRbiIx[_0x2348b4(0x2bb)],QRbiIx[_0x2348b4(0x296)]))['apply'](QRbiIx[_0x2348b4(0x24d)]));}else _0x2cfb47[_0x2348b4(0x25e)]='-';const {branchName:_0x471717}=await _0x4f5032['getUserBranchesById'](_0x2cfb47[_0x2348b4(0x173)]);return _0x2cfb47['branchName']=_0x471717,_0x214257['send'](JSON[_0x2348b4(0x23c)]({'doc':_0x2cfb47,'isLoad':!0x0,'class':_0x5e1fd3[_0x2348b4(0x230)],'msg':_0xad48b4}));}}catch(_0x2d5d5c){if(_0x5e1fd3[_0x2348b4(0x1a8)](_0x5e1fd3['BfFwX'],_0x5e1fd3[_0x2348b4(0x28e)])){if(_0x1db049){const _0x47252a=_0x23b963[_0x2348b4(0x282)](_0x2e8d5e,arguments);return _0x58c536=null,_0x47252a;}}else return console[_0x2348b4(0x17f)](_0x2d5d5c),_0x214257[_0x2348b4(0x23b)](JSON[_0x2348b4(0x23c)]({'isLoad':!0x1,'class':_0x5e1fd3['faEXc'],'msg':_0x2d5d5c[_0x2348b4(0x19d)]}));}finally{if(_0x5e1fd3[_0x2348b4(0x198)](_0x5e1fd3['CGNYP'],_0x5e1fd3[_0x2348b4(0x252)])){const _0x6a80da=new _0x52d99a(QRbiIx[_0x2348b4(0x17e)]),_0x304596=new _0x2c9615(QRbiIx[_0x2348b4(0x26e)],'i'),_0x546b8d=QRbiIx[_0x2348b4(0x1b0)](_0x1a14d8,QRbiIx[_0x2348b4(0x19a)]);!_0x6a80da[_0x2348b4(0x1f7)](QRbiIx[_0x2348b4(0x20b)](_0x546b8d,QRbiIx['xvQPB']))||!_0x304596[_0x2348b4(0x1f7)](QRbiIx[_0x2348b4(0x20b)](_0x546b8d,QRbiIx[_0x2348b4(0x1fc)]))?QRbiIx['jEbgr'](_0x546b8d,'0'):QRbiIx[_0x2348b4(0x186)](_0x4c9472);}else _0xb88bed[_0x2348b4(0x158)]();}}),b[_0xbf1059(0x142)](M,_0x144adb[_0xbf1059(0x255)],async(_0x880884,_0x3e5d35)=>{const _0x1af3a8=_0xbf1059,_0x3d4f55={'BFuIt':_0x1af3a8(0x268),'GlibE':'red','qlXbT':function(_0x221339,_0x58b06b){return _0x221339===_0x58b06b;},'tPtuu':_0x1af3a8(0x155),'nxleP':function(_0x359ee9,_0x11472a){return _0x359ee9<_0x11472a;},'QBhxu':_0x1af3a8(0x2b5),'ZxONp':_0x1af3a8(0x238),'PJPzF':'doc_changes.ejs','FIUHR':_0x1af3a8(0x1a4),'KbqLg':function(_0x2672dd,_0x34401e){return _0x2672dd!==_0x34401e;},'mckDr':'sIgVE','DOUZZ':'keglE','IFkzz':'fHEhd','sYZxb':'Jdhvp'},{docId:_0x5217b7}=_0x880884[_0x1af3a8(0x188)],_0x57dfbd=await _0x1f3b18[_0x1af3a8(0x153)](_0x880884);await _0x54d902[_0x1af3a8(0x260)](_0x880884,_0x3e5d35,_0x57dfbd[_0x1af3a8(0x2b0)]);const {collectionName:_0x368c0c}=_0x4f5032[_0x1af3a8(0x29a)](_0x880884[_0x1af3a8(0x21c)]),_0x1b9a55=new _0x54660d(global[_0x1af3a8(0x22a)]);try{if(_0x3d4f55['qlXbT'](_0x3d4f55[_0x1af3a8(0x1d8)],_0x3d4f55[_0x1af3a8(0x1d8)])){await _0x1b9a55[_0x1af3a8(0x175)]();var _0xa9c432=await _0x1b9a55['db'](global[_0x1af3a8(0x18f)])[_0x1af3a8(0x140)](_0x368c0c)[_0x1af3a8(0x15b)]({'docId':_0x5217b7});if(!_0xa9c432)return _0x3e5d35[_0x1af3a8(0x23b)](JSON[_0x1af3a8(0x23c)]({'isPrint':!0x1,'class':_0x3d4f55[_0x1af3a8(0x1f2)],'msg':_0x1af3a8(0x2ba)+_0x5217b7+'\x22'}));const _0x1b805=_0xa9c432['changesHistory']||[];if(_0x3d4f55['nxleP'](_0x1b805[_0x1af3a8(0x1b3)],0x1))return _0x3e5d35['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x3d4f55[_0x1af3a8(0x1cb)],'msg':_0x3d4f55[_0x1af3a8(0x15a)]}));const _0x352f66=_0x1e0e57[_0x1af3a8(0x204)](folderForms,_0x3d4f55[_0x1af3a8(0x183)]),_0x10c853=await _0x538371[_0x1af3a8(0x195)](_0x352f66,_0x3e5d35,{'title':_0xa9c432[_0x1af3a8(0x144)],'time':_0x326efc['formatDate'](new Date()),'changesHistory':_0x1b805});_0x3e5d35[_0x1af3a8(0x23b)](JSON[_0x1af3a8(0x23c)]({'isPrint':!0x0,'class':_0x3d4f55[_0x1af3a8(0x172)],'htmlPage':_0x10c853}));}else _0x47d66d[_0x1af3a8(0x17f)](_0x3d4f55[_0x1af3a8(0x256)],_0x22cdfd),_0x4fc3f0[_0x1af3a8(0x23b)](_0x320182[_0x1af3a8(0x23c)]({'isPrint':!0x1,'class':_0x3d4f55[_0x1af3a8(0x1f2)],'msg':_0x25821f[_0x1af3a8(0x19d)]}));}catch(_0x2ef60d){_0x3d4f55[_0x1af3a8(0x26f)](_0x3d4f55[_0x1af3a8(0x258)],_0x3d4f55[_0x1af3a8(0x1ec)])?(console[_0x1af3a8(0x17f)](_0x3d4f55[_0x1af3a8(0x256)],_0x2ef60d),_0x3e5d35[_0x1af3a8(0x23b)](JSON[_0x1af3a8(0x23c)]({'isPrint':!0x1,'class':_0x3d4f55[_0x1af3a8(0x1f2)],'msg':_0x2ef60d[_0x1af3a8(0x19d)]}))):(_0x515da8[_0x1af3a8(0x17f)](_0x197848),_0x43ce98[_0x1af3a8(0x23b)](_0x48b80a['stringify']({'isStatus':!0x1,'class':_0x3d4f55[_0x1af3a8(0x1f2)],'msg':_0x43cab7['message']})));}finally{_0x3d4f55[_0x1af3a8(0x26f)](_0x3d4f55[_0x1af3a8(0x2b9)],_0x3d4f55[_0x1af3a8(0x25f)])?_0x1b9a55[_0x1af3a8(0x158)]():_0x23ca32=_0x2b3169;}}),b[_0xbf1059(0x142)](v,_0x144adb['isAuth'],async(_0x1848d2,_0xacd6e6)=>{const _0x325bbc=_0xbf1059,_0x5edf9e={'Sfpgw':function(_0x5ae344){return _0x5ae344();},'oKgiV':_0x325bbc(0x20d),'NWxGb':function(_0x130836,_0x3c7b07){return _0x130836!==_0x3c7b07;},'cclJr':_0x325bbc(0x26b),'Ksmss':'poqqn','Mpcty':_0x325bbc(0x268),'mJKqi':function(_0xa434cb,_0x17b29a){return _0xa434cb===_0x17b29a;},'GzNDw':_0x325bbc(0x1ff),'mCIIc':_0x325bbc(0x1e9),'gEeIz':_0x325bbc(0x162),'YfDNc':function(_0x29afef,_0x291d4a){return _0x29afef==_0x291d4a;},'buMsw':_0x325bbc(0x277),'PaZMc':_0x325bbc(0x1a4),'UPdZp':'image','NGNrG':function(_0x18d763,_0x42ca65){return _0x18d763!==_0x42ca65;},'znjOR':'dDGJi','MCTNX':_0x325bbc(0x17a),'bRuxc':'networkidle0','IpQUd':function(_0x2eb633,_0x4e33e3){return _0x2eb633*_0x4e33e3;},'BSTWy':function(_0x1ee271,_0x1536d1){return _0x1ee271/_0x1536d1;},'JEmSk':_0x325bbc(0x143),'mqKuX':_0x325bbc(0x1a2),'ooWYq':_0x325bbc(0x1cf),'yZkdb':_0x325bbc(0x27d),'wPiLM':_0x325bbc(0x2a7)},{docId:_0x2c3e92,action:_0x1ce082}=_0x1848d2['body'],_0x137bc2=await _0x1f3b18[_0x325bbc(0x153)](_0x1848d2);await _0x54d902[_0x325bbc(0x260)](_0x1848d2,_0xacd6e6,_0x137bc2[_0x325bbc(0x2b0)]);const {collectionName:_0x24341a,docTitle:_0x2bb1b0}=_0x4f5032['get_Info_ByUrl'](_0x1848d2[_0x325bbc(0x21c)]),_0x429519=new _0x54660d(global[_0x325bbc(0x22a)]);try{if(_0x5edf9e[_0x325bbc(0x1f1)](_0x5edf9e[_0x325bbc(0x270)],_0x5edf9e['mCIIc']))hUNLWu[_0x325bbc(0x21f)](_0x11da65);else{await _0x429519[_0x325bbc(0x175)]();var _0x3e8640=await _0x429519['db'](global['dbName'])['collection'](_0x24341a)['findOne']({'docId':_0x2c3e92});if(!_0x3e8640)return _0xacd6e6[_0x325bbc(0x23b)](JSON[_0x325bbc(0x23c)]({'isLoad':!0x1,'class':_0x5edf9e['oKgiV'],'msg':_0x325bbc(0x2ba)+_0x2c3e92+'\x22'}));_0x3e8640[_0x325bbc(0x200)]=_0x2bb1b0,_0x3e8640['statusName']=_0x4f5032[_0x325bbc(0x29b)](_0x3e8640['docStatusNumber']);const _0xbfae1e=_0x4f5032[_0x325bbc(0x15e)](_0x3e8640),_0x15d3a7=_0x1e0e57[_0x325bbc(0x204)](folderForms,_0x5edf9e[_0x325bbc(0x269)]),_0x37a5f8=await _0x538371[_0x325bbc(0x195)](_0x15d3a7,_0xacd6e6,{'title':_0x2c3e92,'time':_0x326efc[_0x325bbc(0x1a6)](new Date()),'action':_0x1ce082,'doc':_0xbfae1e});if(_0x5edf9e[_0x325bbc(0x294)](_0x1ce082,_0x5edf9e['buMsw']))_0xacd6e6[_0x325bbc(0x23b)](JSON['stringify']({'isPrint':!0x0,'class':_0x5edf9e[_0x325bbc(0x2ae)],'htmlPage':_0x37a5f8}));else{if(_0x5edf9e[_0x325bbc(0x294)](_0x1ce082,_0x5edf9e[_0x325bbc(0x141)])){if(_0x5edf9e[_0x325bbc(0x17d)](_0x5edf9e[_0x325bbc(0x1da)],_0x5edf9e[_0x325bbc(0x1da)]))return _0x238e71[_0x325bbc(0x17f)](_0x15992d),_0x123d99['send'](_0x28d8a2[_0x325bbc(0x23c)]({'isSearch':!0x1,'class':_0x5edf9e[_0x325bbc(0x160)],'msg':_0x33e479[_0x325bbc(0x19d)]}));else{const _0x374738=await(await import(_0x5edf9e[_0x325bbc(0x221)]))[_0x325bbc(0x194)](),_0x43114a=await _0x374738[_0x325bbc(0x15d)]();await _0x43114a['setContent'](_0x37a5f8,{'waitUntil':_0x5edf9e[_0x325bbc(0x240)],'timeout':0x2710}),await new Promise(_0x4eca76=>setTimeout(_0x4eca76,0x3e8));const _0x1cd75b=Math[_0x325bbc(0x1a0)](_0x5edf9e[_0x325bbc(0x1c3)](_0x5edf9e[_0x325bbc(0x24c)](0x50,25.4),0x60));await _0x43114a[_0x325bbc(0x28c)]({'width':_0x1cd75b,'height':0x258,'deviceScaleFactor':0x1});const _0x9d6f98=await _0x43114a[_0x325bbc(0x225)](()=>{const _0x2e25ae=_0x325bbc;if(_0x5edf9e[_0x2e25ae(0x284)](_0x5edf9e['cclJr'],_0x5edf9e[_0x2e25ae(0x2a3)])){const _0x322e88=document['body'],_0x39105d=document[_0x2e25ae(0x21d)];return Math[_0x2e25ae(0x259)](_0x322e88[_0x2e25ae(0x20e)],_0x322e88[_0x2e25ae(0x18c)],_0x39105d[_0x2e25ae(0x265)],_0x39105d[_0x2e25ae(0x20e)],_0x39105d[_0x2e25ae(0x18c)]);}else{const _0x4208af=_0x45dc8a['constructor'][_0x2e25ae(0x1b4)][_0x2e25ae(0x1b1)](_0x5c9e61),_0x376c8a=_0x2bad04[_0x399dbf],_0x304b5e=_0x5ce095[_0x376c8a]||_0x4208af;_0x4208af[_0x2e25ae(0x191)]=_0x3ffc33[_0x2e25ae(0x1b1)](_0x1de521),_0x4208af[_0x2e25ae(0x25a)]=_0x304b5e[_0x2e25ae(0x25a)][_0x2e25ae(0x1b1)](_0x304b5e),_0x4f608c[_0x376c8a]=_0x4208af;}}),_0x2866af=await _0x43114a[_0x325bbc(0x24b)]({'type':_0x5edf9e[_0x325bbc(0x223)],'clip':{'x':0x0,'y':0x0,'width':_0x1cd75b,'height':_0x9d6f98},'omitBackground':!0x1});await _0x374738[_0x325bbc(0x158)]();const _0x5959ed=_0x3e8640['docId'][_0x325bbc(0x190)](/\//g,'');_0xacd6e6[_0x325bbc(0x2a9)](0xc8,{'Content-Type':_0x5edf9e[_0x325bbc(0x29c)],'Content-Disposition':_0x325bbc(0x1e5)+_0x5959ed+_0x325bbc(0x1aa),'Content-Length':_0x2866af[_0x325bbc(0x1b3)]}),_0xacd6e6[_0x325bbc(0x267)](_0x2866af);}}}}}catch(_0x3c7853){if(_0x5edf9e[_0x325bbc(0x1f1)](_0x5edf9e[_0x325bbc(0x207)],_0x5edf9e[_0x325bbc(0x207)]))console['log'](_0x5edf9e[_0x325bbc(0x224)],_0x3c7853),_0xacd6e6[_0x325bbc(0x23b)](JSON[_0x325bbc(0x23c)]({'isPrint':!0x1,'class':_0x5edf9e[_0x325bbc(0x160)],'msg':_0x3c7853[_0x325bbc(0x19d)]}));else return![];}finally{_0x5edf9e[_0x325bbc(0x1f1)](_0x5edf9e[_0x325bbc(0x21e)],_0x5edf9e[_0x325bbc(0x1f5)])?(_0x1d8968['log'](_0x5edf9e[_0x325bbc(0x224)],_0x57dbcb),_0x59014e[_0x325bbc(0x23b)](_0x345705['stringify']({'isPrint':!0x1,'class':_0x5edf9e[_0x325bbc(0x160)],'msg':_0x9ef0ad['message']}))):_0x429519[_0x325bbc(0x158)]();}}),b['post'](k,_0x144adb[_0xbf1059(0x255)],async(_0x56aa70,_0x1e3f6b)=>{const _0x1ef7e3=_0xbf1059,_0x13511a={'dlxTC':function(_0x1cd468,_0x3fac07){return _0x1cd468==_0x3fac07;},'IqNlk':_0x1ef7e3(0x1a9),'rXcwd':_0x1ef7e3(0x291),'PBZmk':function(_0xa4863,_0x34bcc3){return _0xa4863==_0x34bcc3;},'ffGaj':'finish','YwtsN':'red','wJJAB':_0x1ef7e3(0x1c9),'vNzhC':function(_0x289384,_0xccf30c){return _0x289384===_0xccf30c;},'pFITZ':_0x1ef7e3(0x1d4),'XFBxC':_0x1ef7e3(0x151),'qvulP':function(_0x32dcce,_0x5afa77){return _0x32dcce==_0x5afa77;},'tgsTh':function(_0x58d2d2,_0x47d395){return _0x58d2d2===_0x47d395;},'CtufY':_0x1ef7e3(0x159),'ilmoQ':_0x1ef7e3(0x214),'NXmnl':function(_0x5ae0b1,_0x36972e){return _0x5ae0b1==_0x36972e;},'OwRiM':function(_0x532c5a,_0x3610da){return _0x532c5a>_0x3610da;},'QZsPI':function(_0x428e2a,_0x58b3ba){return _0x428e2a>_0x58b3ba;},'YQesW':_0x1ef7e3(0x276),'JpKrg':_0x1ef7e3(0x193),'zEdvI':_0x1ef7e3(0x257),'kPiOv':'green','KuDRI':function(_0x14160e,_0x2eeb82){return _0x14160e<_0x2eeb82;},'PpINL':'yellow'},_0x464888=new _0x54660d(global[_0x1ef7e3(0x22a)]);try{const _0xd7ff0c=await _0x1f3b18['getUserData'](_0x56aa70);await _0x54d902['getMainDocPathObj'](_0x56aa70,_0x1e3f6b,_0xd7ff0c[_0x1ef7e3(0x2b0)]);const {collectionName:_0x4c2cd4}=_0x4f5032['get_Info_ByUrl'](_0x56aa70[_0x1ef7e3(0x21c)]),{docId:_0x5537e9,action:_0x47ee61}=_0x56aa70[_0x1ef7e3(0x188)],_0x175aa7=_0x13511a[_0x1ef7e3(0x14f)](_0x47ee61,_0x13511a[_0x1ef7e3(0x147)])?_0x13511a[_0x1ef7e3(0x275)]:_0x13511a['PBZmk'](_0x47ee61,_0x13511a[_0x1ef7e3(0x1bc)])?'จบ':'';if(!_0x5537e9||![_0x13511a[_0x1ef7e3(0x1bc)],_0x13511a['IqNlk']]['includes'](_0x47ee61))return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x13511a[_0x1ef7e3(0x1ad)]}));const _0x487d73={'docId':_0x5537e9,'userId':_0xd7ff0c[_0x1ef7e3(0x2b1)]},_0x35f47e=_0x464888['db'](global[_0x1ef7e3(0x18f)])[_0x1ef7e3(0x140)](_0x4c2cd4),_0x3fa93d=await _0x35f47e[_0x1ef7e3(0x15b)](_0x487d73);if(!_0x3fa93d)return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x1ef7e3(0x1af)+_0x5537e9+_0x1ef7e3(0x1dc)+_0x175aa7+_0x1ef7e3(0x165)}));const _0x3ac186=_0x3fa93d[_0x1ef7e3(0x266)];if(_0x13511a[_0x1ef7e3(0x247)](_0x47ee61,_0x13511a[_0x1ef7e3(0x147)])&&!(_0x13511a[_0x1ef7e3(0x14f)](_0x3ac186,0x1)||_0x13511a[_0x1ef7e3(0x216)](_0x3ac186,0x2)))return _0x1e3f6b['send'](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x13511a[_0x1ef7e3(0x1b9)]}));if(_0x13511a['vNzhC'](_0x47ee61,_0x13511a[_0x1ef7e3(0x1bc)])&&_0x13511a[_0x1ef7e3(0x14f)](!_0x3ac186,0x1))return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON['stringify']({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x13511a[_0x1ef7e3(0x1a3)]}));if(_0x13511a[_0x1ef7e3(0x26a)](_0x47ee61,_0x13511a[_0x1ef7e3(0x147)])){if(_0x13511a['tgsTh'](_0x13511a[_0x1ef7e3(0x286)],_0x13511a[_0x1ef7e3(0x189)])){const _0x5be76f=_0x1100b5?function(){const _0x55cc60=_0x1ef7e3;if(_0x30eba3){const _0x4a1b43=_0x1f8f57[_0x55cc60(0x282)](_0x25ae59,arguments);return _0x1bc602=null,_0x4a1b43;}}:function(){};return _0x2bb563=![],_0x5be76f;}else{if(_0x13511a[_0x1ef7e3(0x145)](_0x3fa93d[_0x1ef7e3(0x2b3)],!0x1))return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON['stringify']({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x1ef7e3(0x15f)+_0x5537e9+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));if(_0x13511a[_0x1ef7e3(0x14f)]((await _0x4f5032[_0x1ef7e3(0x18d)](_0x3fa93d,_0x4c2cd4,_0xd7ff0c[_0x1ef7e3(0x2b1)]))['canCancel'],!0x1))return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':'เอกสาร\x20\x22'+_0x5537e9+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}}if(_0x13511a[_0x1ef7e3(0x14f)](_0x47ee61,_0x13511a[_0x1ef7e3(0x147)]))var _0x402e9d=0xa;else{if(_0x13511a[_0x1ef7e3(0x216)](_0x47ee61,_0x13511a[_0x1ef7e3(0x1bc)]))var _0x402e9d=0x2;}const _0x24bf53=await _0x35f47e['updateOne'](_0x487d73,{'$set':{'docStatusNumber':_0x402e9d}});var _0xf1e666=_0x175aa7+'\x20\x22'+_0x5537e9+_0x1ef7e3(0x167);if(_0x24bf53[_0x1ef7e3(0x281)]||_0x13511a[_0x1ef7e3(0x1fb)](_0x24bf53[_0x1ef7e3(0x1ac)],0x0)){const _0x3e3697=_0x4f5032[_0x1ef7e3(0x192)]({'docStatusNumber':_0x3ac186},{'docStatusNumber':_0x402e9d});if(_0x13511a[_0x1ef7e3(0x2a6)](_0x3e3697['length'],0x0)){if(_0x13511a[_0x1ef7e3(0x247)](_0x13511a[_0x1ef7e3(0x1fd)],_0x13511a[_0x1ef7e3(0x28a)]))_0x490439[_0x1ef7e3(0x158)]();else{const _0x42076a={'dateTime':_0x326efc[_0x1ef7e3(0x1f9)](new Date()),'userId':_0xd7ff0c[_0x1ef7e3(0x2b1)],'userFullname':_0xd7ff0c['userFullname'],'changes':_0x3e3697};await _0x35f47e[_0x1ef7e3(0x1ed)]({'docId':_0x5537e9},{'$push':{'changesHistory':{'$each':[_0x42076a],'$position':0x0}}}),_0xf1e666+=_0x13511a[_0x1ef7e3(0x1b6)];}}return _0x1e3f6b['send'](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x0,'docId':_0x5537e9,'docStatusNumber':_0x402e9d,'class':_0x13511a[_0x1ef7e3(0x288)],'msg':_0xf1e666}));}else{if(_0x24bf53['matchedCount']&&_0x13511a[_0x1ef7e3(0x209)](_0x24bf53[_0x1ef7e3(0x1ac)],0x1))return _0x1e3f6b[_0x1ef7e3(0x23b)](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'docId':_0x5537e9,'docStatusNumber':_0x3ac186,'class':_0x13511a['PpINL'],'msg':'\x22'+_0x5537e9+_0x1ef7e3(0x1e4)}));}}catch(_0x31785a){console['log'](_0x31785a),_0x1e3f6b[_0x1ef7e3(0x23b)](JSON[_0x1ef7e3(0x23c)]({'isStatus':!0x1,'class':_0x13511a[_0x1ef7e3(0x24f)],'msg':_0x31785a[_0x1ef7e3(0x19d)]}));}finally{_0x464888[_0x1ef7e3(0x158)]();}});export default b;function _0x3e611c(_0x5e2c48){const _0x245724=_0xbf1059,_0x587bf7={'VRiLy':function(_0x2e6885,_0x4f1678){return _0x2e6885===_0x4f1678;},'NOUSV':_0x245724(0x164),'pvZuT':_0x245724(0x2a1),'OuLoX':_0x245724(0x1f3),'BiJlV':function(_0x55b09d,_0x2e0afd){return _0x55b09d!==_0x2e0afd;},'tthhG':function(_0x4edfd0,_0x185807){return _0x4edfd0+_0x185807;},'JFFdA':function(_0x57dc56,_0x3aadb9){return _0x57dc56/_0x3aadb9;},'lXNQb':'length','mmiwJ':function(_0x5f5187,_0x1a5579){return _0x5f5187===_0x1a5579;},'hgHye':function(_0x355bf8,_0x643400){return _0x355bf8%_0x643400;},'BqjUa':_0x245724(0x176),'PftuC':'gger','AEoxL':_0x245724(0x226),'afKwB':'stateObject','SEPgz':function(_0x28d16e,_0x50ac80){return _0x28d16e(_0x50ac80);}};function _0x16e0b8(_0x2482e2){const _0x5e4208=_0x245724;if(_0x587bf7[_0x5e4208(0x17c)](typeof _0x2482e2,_0x587bf7['NOUSV']))return function(_0xd5dea8){}[_0x5e4208(0x154)](_0x587bf7[_0x5e4208(0x15c)])[_0x5e4208(0x282)](_0x587bf7[_0x5e4208(0x1b8)]);else _0x587bf7[_0x5e4208(0x2a2)](_0x587bf7[_0x5e4208(0x18a)]('',_0x587bf7['JFFdA'](_0x2482e2,_0x2482e2))[_0x587bf7['lXNQb']],0x1)||_0x587bf7[_0x5e4208(0x273)](_0x587bf7[_0x5e4208(0x13f)](_0x2482e2,0x14),0x0)?function(){return!![];}[_0x5e4208(0x154)](_0x587bf7[_0x5e4208(0x18a)](_0x587bf7['BqjUa'],_0x587bf7[_0x5e4208(0x14e)]))['call'](_0x587bf7['AEoxL']):function(){return![];}['constructor'](_0x587bf7[_0x5e4208(0x18a)](_0x587bf7['BqjUa'],_0x587bf7['PftuC']))[_0x5e4208(0x282)](_0x587bf7['afKwB']);_0x587bf7[_0x5e4208(0x1de)](_0x16e0b8,++_0x2482e2);}try{if(_0x5e2c48)return _0x16e0b8;else _0x587bf7[_0x245724(0x1de)](_0x16e0b8,0x0);}catch(_0x31f454){}}