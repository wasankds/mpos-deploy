const _0x65c5f5=_0x456b;(function(_0x4ec134,_0x352db7){const _0x3f2fc9=_0x456b,_0x501188=_0x4ec134();while(!![]){try{const _0x27660b=parseInt(_0x3f2fc9(0x19a))/0x1+parseInt(_0x3f2fc9(0x22b))/0x2+parseInt(_0x3f2fc9(0x260))/0x3*(-parseInt(_0x3f2fc9(0x1af))/0x4)+parseInt(_0x3f2fc9(0x11b))/0x5*(parseInt(_0x3f2fc9(0x17f))/0x6)+parseInt(_0x3f2fc9(0x177))/0x7*(parseInt(_0x3f2fc9(0x19f))/0x8)+-parseInt(_0x3f2fc9(0x228))/0x9*(parseInt(_0x3f2fc9(0x26a))/0xa)+parseInt(_0x3f2fc9(0x25a))/0xb*(parseInt(_0x3f2fc9(0x205))/0xc);if(_0x27660b===_0x352db7)break;else _0x501188['push'](_0x501188['shift']());}catch(_0x5e4d48){_0x501188['push'](_0x501188['shift']());}}}(_0x3896,0x91c88));const _0x38d942=(function(){const _0x1d5120=_0x456b,_0x3ee992={'ONbth':function(_0x118ce5,_0x2e3499){return _0x118ce5(_0x2e3499);},'rDfke':function(_0x5db2b3,_0x36b3fb){return _0x5db2b3===_0x36b3fb;},'EHKWf':_0x1d5120(0x1db),'owilS':_0x1d5120(0x10c),'SNkMA':function(_0x3f3034,_0x5b01cf){return _0x3f3034!==_0x5b01cf;},'DHpXp':_0x1d5120(0x11f),'rgonr':'rOHkP','zgGQv':_0x1d5120(0x257),'pGAko':function(_0x450aa3,_0x1f5662){return _0x450aa3===_0x1f5662;},'nynvV':'BcKTn'};let _0x100fad=!![];return function(_0x1a8fb8,_0x3f66aa){const _0x4241bb=_0x1d5120;if(_0x3ee992[_0x4241bb(0x195)](_0x3ee992[_0x4241bb(0x274)],_0x3ee992['nynvV'])){const _0x13ece3=_0x100fad?function(){const _0x134875=_0x4241bb,_0x554e88={'xikHN':function(_0x5bf66d,_0x481af6){const _0x35bf06=_0x456b;return _0x3ee992[_0x35bf06(0x117)](_0x5bf66d,_0x481af6);}};if(_0x3ee992[_0x134875(0x25b)](_0x3ee992[_0x134875(0x259)],_0x3ee992[_0x134875(0x1a6)])){const _0x5915f7=_0x7e3ce9['constructor'][_0x134875(0x1b4)]['bind'](_0x33f90a),_0x4b70e1=_0x31aa05[_0x1474f4],_0x3511ed=_0x1df704[_0x4b70e1]||_0x5915f7;_0x5915f7[_0x134875(0x1c8)]=_0x285ac4['bind'](_0x170703),_0x5915f7[_0x134875(0x112)]=_0x3511ed[_0x134875(0x112)]['bind'](_0x3511ed),_0x427848[_0x4b70e1]=_0x5915f7;}else{if(_0x3f66aa){if(_0x3ee992[_0x134875(0x1a7)](_0x3ee992[_0x134875(0x129)],_0x3ee992['rgonr'])){const _0xa9db7c=_0x3f66aa['apply'](_0x1a8fb8,arguments);return _0x3f66aa=null,_0xa9db7c;}else{if(_0x5211bc)return _0x503365;else _0x554e88[_0x134875(0x119)](_0x2e1297,0x0);}}}}:function(){};return _0x100fad=![],_0x13ece3;}else return _0x459938[_0x4241bb(0x156)](_0x273763),_0x5d2630[_0x4241bb(0x1c2)](_0x1f9852[_0x4241bb(0x125)]({'isFetch':!0x1,'class':_0x3ee992['zgGQv'],'msg':_0x382284['message']}));};}());(function(){const _0xa4f08a=_0x456b,_0x22386d={'TUJtg':'error\x20===>\x20','kBMps':_0xa4f08a(0x257),'PbToA':function(_0x480fa4,_0x4828ce){return _0x480fa4===_0x4828ce;},'EUwCD':_0xa4f08a(0x1d1),'WYORw':_0xa4f08a(0x20b),'rirIo':'function\x20*\x5c(\x20*\x5c)','jRFlN':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','bmOXd':function(_0x53982f,_0x564146){return _0x53982f(_0x564146);},'kTQyl':_0xa4f08a(0x233),'nZWZy':function(_0x5f0e2f,_0x3520d4){return _0x5f0e2f+_0x3520d4;},'CszpS':_0xa4f08a(0x1d9),'BYFHH':function(_0x3c7076,_0x38511f){return _0x3c7076+_0x38511f;},'IVtIy':_0xa4f08a(0x239),'BGimG':function(_0x20d7da,_0x471387){return _0x20d7da===_0x471387;},'QGXVt':_0xa4f08a(0x154),'ZZGRv':function(_0x30c063,_0x22db31){return _0x30c063(_0x22db31);},'eWkLe':_0xa4f08a(0x140),'cGwyP':function(_0x2e234e){return _0x2e234e();},'LOZNk':function(_0x24a666,_0xf7710,_0x108c88){return _0x24a666(_0xf7710,_0x108c88);}};_0x22386d['LOZNk'](_0x38d942,this,function(){const _0x191e47=_0xa4f08a,_0x30ee61={'gqsKc':_0x22386d['TUJtg'],'Qnoya':_0x22386d['kBMps']};if(_0x22386d[_0x191e47(0x155)](_0x22386d['EUwCD'],_0x22386d[_0x191e47(0x18d)])){const _0x46047c=_0x22f8d1?function(){const _0x135d60=_0x191e47;if(_0x4ed6af){const _0x3135f6=_0x3a1340[_0x135d60(0x1a4)](_0x467afc,arguments);return _0x25eaf4=null,_0x3135f6;}}:function(){};return _0x58efc1=![],_0x46047c;}else{const _0x2dfe8=new RegExp(_0x22386d[_0x191e47(0x1fd)]),_0x7ba1e3=new RegExp(_0x22386d['jRFlN'],'i'),_0x4c6513=_0x22386d[_0x191e47(0x16a)](_0xb9389d,_0x22386d['kTQyl']);if(!_0x2dfe8[_0x191e47(0x1ce)](_0x22386d['nZWZy'](_0x4c6513,_0x22386d['CszpS']))||!_0x7ba1e3[_0x191e47(0x1ce)](_0x22386d[_0x191e47(0x193)](_0x4c6513,_0x22386d[_0x191e47(0x116)])))_0x22386d[_0x191e47(0x1f1)](_0x22386d[_0x191e47(0x245)],_0x22386d[_0x191e47(0x245)])?_0x22386d[_0x191e47(0x23b)](_0x4c6513,'0'):(_0x5838c4['log'](_0x30ee61[_0x191e47(0x214)],_0xec4b07),_0x3130ac[_0x191e47(0x1c2)](_0x1fe834['stringify']({'isPrint':!0x1,'class':_0x30ee61['Qnoya'],'msg':_0x294460[_0x191e47(0x236)]})));else{if(_0x22386d[_0x191e47(0x1f1)](_0x22386d[_0x191e47(0x1eb)],_0x22386d[_0x191e47(0x1eb)]))_0x22386d[_0x191e47(0x196)](_0xb9389d);else{const _0x3813fe=_0x147b5d?function(){if(_0x28b6e0){const _0x3d6dc9=_0x405901['apply'](_0x4ce83b,arguments);return _0x5e6c88=null,_0x3d6dc9;}}:function(){};return _0x209ba0=![],_0x3813fe;}}}})();}());const _0x504c88=(function(){const _0x1432be=_0x456b,_0xa54716={'HCvIi':function(_0x1b61df,_0x58bf0b){return _0x1b61df!==_0x58bf0b;},'fzCwq':_0x1432be(0x178),'fgVWr':_0x1432be(0x22c),'xNAWu':function(_0x1eb033,_0x1a91b8){return _0x1eb033===_0x1a91b8;},'ABxKZ':_0x1432be(0x275),'PgPji':'FjusS','HsyeW':function(_0x347067,_0x2bfd79){return _0x347067===_0x2bfd79;},'OYtnF':'KZulC','OBRfK':_0x1432be(0x21f)};let _0x468179=!![];return function(_0x55ab97,_0xa36348){const _0x2bce65=_0x1432be,_0x13c943={'demVo':function(_0x7adfbc,_0x5ba4ef){return _0xa54716['HCvIi'](_0x7adfbc,_0x5ba4ef);},'feSGP':_0xa54716['fzCwq'],'MeNaR':_0xa54716[_0x2bce65(0x16d)],'YPHwq':function(_0x1b95c8,_0x126f59){return _0xa54716['xNAWu'](_0x1b95c8,_0x126f59);},'GZJIU':_0xa54716[_0x2bce65(0x1a9)],'esBeD':_0xa54716[_0x2bce65(0x1f9)]};if(_0xa54716[_0x2bce65(0x134)](_0xa54716['OYtnF'],_0xa54716[_0x2bce65(0x13d)]))_0x46cb1a['close']();else{const _0x131b0f=_0x468179?function(){const _0xfde328=_0x2bce65;if(_0x13c943['demVo'](_0x13c943[_0xfde328(0x1c0)],_0x13c943['MeNaR'])){if(_0xa36348){if(_0x13c943[_0xfde328(0x114)](_0x13c943[_0xfde328(0x20c)],_0x13c943['esBeD']))_0x3735ba[_0xfde328(0x199)]();else{const _0xddcd3c=_0xa36348['apply'](_0x55ab97,arguments);return _0xa36348=null,_0xddcd3c;}}}else{if(_0x507ac8){const _0x161444=_0x309886[_0xfde328(0x1a4)](_0x15ad4b,arguments);return _0x6b8204=null,_0x161444;}}}:function(){};return _0x468179=![],_0x131b0f;}};}()),_0x4c4ce3=_0x504c88(this,function(){const _0x506b84=_0x456b,_0x4ae21e={'EtJhE':_0x506b84(0x1b0),'TdZgI':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','gAYVO':function(_0xd182f7,_0x2aa689){return _0xd182f7(_0x2aa689);},'dDFPm':_0x506b84(0x233),'chOhL':function(_0x396f37,_0x20ea87){return _0x396f37+_0x20ea87;},'MOjxq':_0x506b84(0x1d9),'idUWq':function(_0x43c107,_0x504e29){return _0x43c107+_0x504e29;},'CijsU':'input','XcXAw':function(_0x176218,_0x3169d8){return _0x176218(_0x3169d8);},'HwEvX':function(_0x3a9c44){return _0x3a9c44();},'YaRNi':function(_0x3613b3,_0x173c7b,_0x2e08ac){return _0x3613b3(_0x173c7b,_0x2e08ac);},'YxaQq':function(_0x18e915,_0x536549){return _0x18e915===_0x536549;},'hvrVu':_0x506b84(0x126),'PtxeT':function(_0x5723ed,_0x1ac37d){return _0x5723ed+_0x1ac37d;},'SymCK':function(_0x4c8767,_0x3eb30f){return _0x4c8767+_0x3eb30f;},'qSRbs':'return\x20(function()\x20','jbPPv':_0x506b84(0x229),'CvRqG':function(_0xc755c7){return _0xc755c7();},'UIdVx':function(_0x48f13f,_0x51a58f){return _0x48f13f!==_0x51a58f;},'aPJKz':_0x506b84(0x1c1),'ieafV':_0x506b84(0x156),'JCqsk':_0x506b84(0x1ef),'qmIyb':'info','jPOxe':'error','CpnYR':_0x506b84(0x10d),'VYExZ':_0x506b84(0x103),'IycaS':_0x506b84(0x215),'WHwrq':function(_0x1f4f1d,_0x3af620){return _0x1f4f1d<_0x3af620;},'sOnBw':_0x506b84(0x145)};let _0x28645c;try{if(_0x4ae21e[_0x506b84(0x237)](_0x4ae21e[_0x506b84(0x240)],_0x4ae21e[_0x506b84(0x240)])){const _0x176743=_0x4ae21e[_0x506b84(0x147)](Function,_0x4ae21e[_0x506b84(0x16f)](_0x4ae21e[_0x506b84(0x226)](_0x4ae21e[_0x506b84(0x186)],_0x4ae21e[_0x506b84(0x167)]),');'));_0x28645c=_0x4ae21e[_0x506b84(0x209)](_0x176743);}else _0x5eeca7['close']();}catch(_0x5e1ed5){_0x4ae21e['UIdVx'](_0x4ae21e[_0x506b84(0x1bd)],_0x4ae21e[_0x506b84(0x1bd)])?_0x4ae21e[_0x506b84(0x15a)](_0x14f25e,this,function(){const _0x52a0b8=_0x506b84,_0x1850a7=new _0x4d5116(_0x4ae21e[_0x52a0b8(0x191)]),_0x22f298=new _0x153698(_0x4ae21e[_0x52a0b8(0x256)],'i'),_0x608a39=_0x4ae21e[_0x52a0b8(0x14b)](_0x3838b5,_0x4ae21e['dDFPm']);!_0x1850a7[_0x52a0b8(0x1ce)](_0x4ae21e['chOhL'](_0x608a39,_0x4ae21e[_0x52a0b8(0x248)]))||!_0x22f298['test'](_0x4ae21e[_0x52a0b8(0x1fc)](_0x608a39,_0x4ae21e[_0x52a0b8(0x197)]))?_0x4ae21e['XcXAw'](_0x608a39,'0'):_0x4ae21e[_0x52a0b8(0x130)](_0x35deed);})():_0x28645c=window;}const _0x55e878=_0x28645c['console']=_0x28645c[_0x506b84(0x10f)]||{},_0x171a1e=[_0x4ae21e[_0x506b84(0x27c)],_0x4ae21e[_0x506b84(0x153)],_0x4ae21e[_0x506b84(0x128)],_0x4ae21e[_0x506b84(0x18c)],_0x4ae21e['CpnYR'],_0x4ae21e[_0x506b84(0x187)],_0x4ae21e[_0x506b84(0x1a3)]];for(let _0x79c68d=0x0;_0x4ae21e[_0x506b84(0x12e)](_0x79c68d,_0x171a1e[_0x506b84(0x242)]);_0x79c68d++){if(_0x4ae21e[_0x506b84(0x225)](_0x4ae21e[_0x506b84(0x1d6)],_0x4ae21e[_0x506b84(0x1d6)])){const _0x43e008=_0x39756c['apply'](_0x47f0a3,arguments);return _0x2a3150=null,_0x43e008;}else{const _0x5e4a09=_0x504c88[_0x506b84(0x211)][_0x506b84(0x1b4)][_0x506b84(0x120)](_0x504c88),_0x280724=_0x171a1e[_0x79c68d],_0xae6e98=_0x55e878[_0x280724]||_0x5e4a09;_0x5e4a09['__proto__']=_0x504c88[_0x506b84(0x120)](_0x504c88),_0x5e4a09[_0x506b84(0x112)]=_0xae6e98['toString'][_0x506b84(0x120)](_0xae6e98),_0x55e878[_0x280724]=_0x5e4a09;}}});_0x4c4ce3();import _0x5c4da3 from'express';const b=_0x5c4da3['Router']();import _0x4bde12 from'path';import{MongoClient as _0x59394d}from'mongodb';import _0x5e4543 from'../middleware/mainAuth.js';import*as _0x557609 from'../mymodule/myUsers.js';import*as _0x5c193e from'../mymodule/myDateTime.js';import*as _0x4c1fdf from'../mymodule/myModule.js';import*as _0xede436 from'../mymodule/myDocMain.js';import*as _0x1a13f4 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0x65c5f5(0x1ec)],p=global[_0x65c5f5(0x176)],M=[w+_0x65c5f5(0x19b),S+_0x65c5f5(0x19b),p+'/changes'],v=[w+_0x65c5f5(0x20f),S+_0x65c5f5(0x20f),p+'/print'],k=[w+'/status',S+_0x65c5f5(0x247),p+_0x65c5f5(0x247)],B=[w+'/search',S+_0x65c5f5(0x109),p+_0x65c5f5(0x109)],x=[w+'/load',S+_0x65c5f5(0x227),p+_0x65c5f5(0x227),w+'/load-last',S+'/load-last',p+'/load-last'],L=[w+_0x65c5f5(0x201),S+'/fetch/modal',p+'/fetch/modal'];b[_0x65c5f5(0x1f3)](L,_0x5e4543[_0x65c5f5(0x172)],async(_0x1efc60,_0x1a5808)=>{const _0x3abc67=_0x65c5f5,_0xbeec47={'FeEuH':'red','KsBuY':_0x3abc67(0x17b),'zvckw':'counter','oyPtZ':function(_0x9e9688,_0x17887e){return _0x9e9688===_0x17887e;},'bfgdC':_0x3abc67(0x17a),'kjANq':function(_0x2a70b4,_0x3979ff){return _0x2a70b4==_0x3979ff;},'jUaLh':_0x3abc67(0x13b),'BccLW':_0x3abc67(0x1b1),'BNXws':_0x3abc67(0x27a),'fbfqe':function(_0x3053c8,_0x5bd41c){return _0x3053c8==_0x5bd41c;},'AKXHC':'sales','CBAuC':_0x3abc67(0x164),'igAZV':_0x3abc67(0x271),'YREiO':_0x3abc67(0x1bc),'bwloB':function(_0xe48871,_0x308008){return _0xe48871!==_0x308008;},'zNOUt':'MJYLN'},_0x4bb2b6=await _0x557609[_0x3abc67(0x184)](_0x1efc60),_0xbcb1e4=await _0xede436[_0x3abc67(0x166)](_0x1efc60,_0x1a5808,_0x4bb2b6[_0x3abc67(0x1ee)]);try{if(_0xbeec47[_0x3abc67(0x262)](_0xbeec47[_0x3abc67(0x18e)],_0xbeec47[_0x3abc67(0x18e)])){if(_0xbeec47[_0x3abc67(0x149)](_0xbcb1e4[_0x3abc67(0x24c)],_0xbeec47[_0x3abc67(0x1e8)]))var _0x1a6dbc=await _0x1a13f4[_0x3abc67(0x249)](_0xbeec47['BccLW']);else{if(_0xbeec47[_0x3abc67(0x149)](_0xbcb1e4[_0x3abc67(0x24c)],_0xbeec47['BNXws']))var _0x1a6dbc=await _0x1a13f4['getItems_for_Modal'](_0xbeec47[_0x3abc67(0x264)]);else{if(_0xbeec47[_0x3abc67(0x26d)](_0xbcb1e4[_0x3abc67(0x24c)],_0xbeec47['AKXHC']))var _0x1a6dbc=await _0x1a13f4[_0x3abc67(0x249)](_0xbeec47[_0x3abc67(0x1c7)]);}}const _0x4ccd67=await _0x1a13f4['getItemsCategory']();return _0x1a5808[_0x3abc67(0x1c2)](JSON[_0x3abc67(0x125)]({'DATA_ITEMS':_0x1a6dbc,'DATA_CATEGORY':_0x4ccd67,'isFetch':!0x0,'class':_0xbeec47[_0x3abc67(0x20d)],'msg':_0xbeec47[_0x3abc67(0x111)]}));}else return _0x44c961[_0x3abc67(0x156)](_0x4dbf86),_0x283363['send'](_0x52e6ab[_0x3abc67(0x125)]({'isLoad':!0x1,'class':_0xbeec47[_0x3abc67(0x152)],'msg':_0x154ffa[_0x3abc67(0x236)]}));}catch(_0x4e5e01){return _0xbeec47[_0x3abc67(0x23a)](_0xbeec47[_0x3abc67(0x163)],_0xbeec47[_0x3abc67(0x163)])?function(_0x5d27b3){}[_0x3abc67(0x211)](DEoKuK[_0x3abc67(0x158)])[_0x3abc67(0x1a4)](DEoKuK['zvckw']):(console[_0x3abc67(0x156)](_0x4e5e01),_0x1a5808[_0x3abc67(0x1c2)](JSON[_0x3abc67(0x125)]({'isFetch':!0x1,'class':_0xbeec47[_0x3abc67(0x152)],'msg':_0x4e5e01['message']})));}}),b[_0x65c5f5(0x1d3)](B,_0x5e4543[_0x65c5f5(0x172)],async(_0x2ecb65,_0x12d1dd)=>{const _0x25066d=_0x65c5f5,_0x383ae7={'coktR':function(_0x5846bc){return _0x5846bc();},'ztoKh':function(_0x147f38,_0x41fc6c){return _0x147f38(_0x41fc6c);},'BvocH':function(_0x140064,_0x522a7c){return _0x140064<_0x522a7c;},'jVPXC':_0x25066d(0x1e1),'zjSGM':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','CihwU':function(_0x16bd0a,_0x4077ad){return _0x16bd0a!==_0x4077ad;},'RdHxj':'gUDQV','aqlFA':_0x25066d(0x24b),'MlsEz':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','CRCXa':function(_0x28d1b9,_0x379666){return _0x28d1b9+_0x379666;},'THYCr':_0x25066d(0x271),'stYhu':'SDibm','ITsWS':_0x25066d(0x257),'MBWgC':function(_0x2f44fd,_0x1ee6e2){return _0x2f44fd!==_0x1ee6e2;},'tevnk':_0x25066d(0x10e)};let {sip:_0x49b7d5}=_0x2ecb65[_0x25066d(0x254)];if(!_0x49b7d5&&_0x383ae7[_0x25066d(0x24e)](_0x49b7d5[_0x25066d(0x242)],0x2))return _0x12d1dd['send'](JSON[_0x25066d(0x125)]({'isSearch':!0x1,'class':_0x383ae7[_0x25066d(0x25d)],'msg':_0x383ae7[_0x25066d(0x159)]}));_0x49b7d5=_0x49b7d5[_0x25066d(0x1ba)](/[!@#$%^&*<>]/g,'')??null;const _0x31ad74=await _0x557609['getUserData'](_0x2ecb65);await _0xede436[_0x25066d(0x166)](_0x2ecb65,_0x12d1dd,_0x31ad74[_0x25066d(0x1ee)]);const {collectionName:_0x47e859}=_0x1a13f4[_0x25066d(0x1f7)](_0x2ecb65[_0x25066d(0x1aa)]),_0x58b0e1=new _0x59394d(global[_0x25066d(0x143)]);try{if(_0x383ae7[_0x25066d(0x26f)](_0x383ae7[_0x25066d(0x1a2)],_0x383ae7[_0x25066d(0x138)])){await _0x58b0e1[_0x25066d(0x253)]();const _0x310dd8=_0x58b0e1['db'](global['dbName'])[_0x25066d(0x1e7)](_0x47e859),_0x430406=[{'$or':[{'docId':{'$regex':_0x49b7d5,'$options':'i'}},{'docDate':{'$regex':_0x49b7d5,'$options':'i'}}]}];let _0xd1bdfd='';['O','S']['includes'](_0x31ad74[_0x25066d(0x1ee)])||(_0xd1bdfd+=_0x383ae7['MlsEz'],_0x430406['push']({'userId':_0x31ad74[_0x25066d(0x19c)]}));const _0x1ea8aa=await _0x310dd8[_0x25066d(0x23f)]([{'$match':{'$and':_0x430406}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x25066d(0x16c)]();return _0xd1bdfd=_0x383ae7[_0x25066d(0x170)](_0x25066d(0x148)+_0x1ea8aa[_0x25066d(0x242)]+_0x25066d(0x18f),_0xd1bdfd),_0x12d1dd[_0x25066d(0x1c2)](JSON[_0x25066d(0x125)]({'searchFound':_0x1ea8aa,'msg':_0xd1bdfd,'isSearch':!0x0,'class':_0x383ae7[_0x25066d(0x278)]}));}else _0x5d7e0f[_0x25066d(0x199)]();}catch(_0x536cfc){if(_0x383ae7['CihwU'](_0x383ae7[_0x25066d(0x127)],_0x383ae7['stYhu']))zyEorQ[_0x25066d(0x210)](_0x3a1c0a);else return console['log'](_0x536cfc),_0x12d1dd[_0x25066d(0x1c2)](JSON[_0x25066d(0x125)]({'isSearch':!0x1,'class':_0x383ae7['ITsWS'],'msg':_0x536cfc[_0x25066d(0x236)]}));}finally{_0x383ae7[_0x25066d(0x252)](_0x383ae7[_0x25066d(0x265)],_0x383ae7[_0x25066d(0x265)])?zyEorQ[_0x25066d(0x17c)](_0x1ed4d8,'0'):_0x58b0e1['close']();}}),b[_0x65c5f5(0x1d3)](x,_0x5e4543[_0x65c5f5(0x172)],async(_0x3c1c79,_0x40092b)=>{const _0x571732=_0x65c5f5,_0x2f452c={'CSFuJ':_0x571732(0x206),'fNOrl':_0x571732(0x257),'VvJeT':function(_0x14962e,_0x40507f){return _0x14962e(_0x40507f);},'tHOGS':function(_0x1a4638,_0x39972b){return _0x1a4638+_0x39972b;},'lFkMJ':function(_0x263017,_0x9e66f2){return _0x263017+_0x9e66f2;},'SCCkA':_0x571732(0x216),'BtKlF':_0x571732(0x229),'hkyqp':function(_0x42afd2){return _0x42afd2();},'fqQDz':'log','LyZfX':'warn','tUULv':'info','upYvp':_0x571732(0x241),'YXiWO':'exception','qZWwh':_0x571732(0x103),'bFkSl':_0x571732(0x215),'xGfSk':function(_0x11301f,_0x434a67){return _0x11301f<_0x434a67;},'qErWL':function(_0x92d9c4,_0x2209fe){return _0x92d9c4(_0x2209fe);},'lrWou':function(_0xebb6ee,_0x4c7be3){return _0xebb6ee===_0x4c7be3;},'zdmnm':_0x571732(0x22e),'cwIbr':function(_0x1419e0,_0x55879d){return _0x1419e0===_0x55879d;},'iraKU':_0x571732(0x204),'yAYPk':_0x571732(0x1e6),'OrrAk':_0x571732(0x217),'RxHuH':function(_0x21597c,_0x5507e9){return _0x21597c===_0x5507e9;},'ZWowj':'load-last','LCnGE':function(_0x184e7b,_0x1bb697){return _0x184e7b===_0x1bb697;},'cEUaX':_0x571732(0x11d),'GuDQA':function(_0x343d2d,_0x3378cf){return _0x343d2d==_0x3378cf;},'RxrWz':function(_0x43b6db,_0x59ebac){return _0x43b6db!==_0x59ebac;},'lVtww':_0x571732(0x104),'jLDoX':function(_0x32fc7d,_0xa88ccb){return _0x32fc7d==_0xa88ccb;},'GRUBX':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','UtScG':function(_0x1037cc,_0x45cdcb){return _0x1037cc==_0x45cdcb;},'lmNmq':function(_0x5f4eec,_0x3d78f6){return _0x5f4eec==_0x3d78f6;},'EcUnD':_0x571732(0x20a),'ludrg':_0x571732(0x1be),'Glsed':_0x571732(0x271),'SsVBN':_0x571732(0x1b3),'HvmLK':_0x571732(0x1e9),'LoOpF':_0x571732(0x13c),'nNDlV':'WSfIm'};let {docId:_0x575c14,action:_0x5cc81b}=_0x3c1c79['body'];const _0x480e10=await _0x557609['getUserData'](_0x3c1c79);await _0xede436[_0x571732(0x166)](_0x3c1c79,_0x40092b,_0x480e10[_0x571732(0x1ee)]);const {collectionName:_0x921c47}=_0x1a13f4[_0x571732(0x1f7)](_0x3c1c79[_0x571732(0x1aa)]),_0x4a77a9=new _0x59394d(global[_0x571732(0x143)]);try{if(_0x2f452c[_0x571732(0x123)](_0x2f452c[_0x571732(0x238)],_0x2f452c[_0x571732(0x238)])){await _0x4a77a9[_0x571732(0x253)]();const _0x4c4781=_0x4a77a9['db'](global[_0x571732(0x250)])[_0x571732(0x1e7)](_0x921c47);if(_0x2f452c[_0x571732(0x160)](_0x5cc81b,_0x2f452c[_0x571732(0x255)])){if(_0x2f452c['lrWou'](_0x2f452c[_0x571732(0x113)],_0x2f452c[_0x571732(0x13a)])){const _0x333860=_0x4fea4c[_0x571732(0x254)],_0x11cda1=_0x1706a9[_0x571732(0x1ca)];return _0x2bea59[_0x571732(0x12c)](_0x333860[_0x571732(0x192)],_0x333860['offsetHeight'],_0x11cda1[_0x571732(0x105)],_0x11cda1[_0x571732(0x192)],_0x11cda1[_0x571732(0x203)]);}else{const _0x3aac39=['O','S'][_0x571732(0x212)](_0x480e10[_0x571732(0x1ee)])?{'docId':_0x575c14}:{'docId':_0x575c14,'userId':_0x480e10[_0x571732(0x19c)]};var _0x994f5=await _0x4c4781[_0x571732(0x207)](_0x3aac39,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x2f452c[_0x571732(0x1f0)](_0x5cc81b,_0x2f452c[_0x571732(0x235)]))var _0x994f5=await _0x4c4781[_0x571732(0x207)]({'userId':_0x480e10[_0x571732(0x19c)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x3e72c5=_0x994f5?'':_0x2f452c[_0x571732(0x110)](_0x5cc81b,_0x2f452c[_0x571732(0x255)])?_0x571732(0x182)+_0x575c14+'\x22':_0x2f452c[_0x571732(0x1d8)];if(!_0x994f5)return _0x40092b[_0x571732(0x1c2)](JSON['stringify']({'isLoad':!0x1,'class':_0x2f452c[_0x571732(0x135)],'msg':_0x3e72c5}));let _0x1b0d19='โหลดเอกสารเลขที่\x20\x22'+_0x994f5[_0x571732(0x1cd)]+_0x571732(0x19e);if(_0x2f452c[_0x571732(0x1f2)](_0x994f5[_0x571732(0x1d0)],0x1)&&_0x994f5[_0x571732(0x21c)]){if(_0x2f452c[_0x571732(0x10a)](_0x2f452c[_0x571732(0x190)],_0x2f452c['lVtww']))_0x59036f[_0x571732(0x156)](_0x2f452c[_0x571732(0x1ff)],_0x28d673),_0x3e8902[_0x571732(0x1c2)](_0x4a3954[_0x571732(0x125)]({'isPrint':!0x1,'class':_0x2f452c['fNOrl'],'msg':_0x35c1fc[_0x571732(0x236)]}));else{let _0x2ceaeb=await _0x1a13f4[_0x571732(0x15e)](_0x994f5,_0x921c47,_0x480e10[_0x571732(0x19c)]);_0x994f5[_0x571732(0x1df)]=_0x2ceaeb[_0x571732(0x1df)],_0x2f452c[_0x571732(0x13e)](_0x2ceaeb[_0x571732(0x1c6)],!0x1)&&(_0x994f5[_0x571732(0x1d0)]=_0x2ceaeb[_0x571732(0x1d0)],_0x1b0d19+=_0x2f452c[_0x571732(0x1e3)]);}}else _0x994f5[_0x571732(0x1df)]='-';if((_0x2f452c[_0x571732(0x21a)](_0x994f5[_0x571732(0x1d0)],0x1)||_0x2f452c['lmNmq'](_0x994f5[_0x571732(0x1d0)],0x2))&&_0x994f5['dateTimeCanCancel']){if(_0x2f452c[_0x571732(0x110)](_0x2f452c['EcUnD'],_0x2f452c[_0x571732(0x218)])){const _0x39c088=await _0x1a13f4[_0x571732(0x232)](_0x994f5,_0x921c47,_0x480e10[_0x571732(0x19c)]);_0x994f5[_0x571732(0x1c4)]=_0x39c088[_0x571732(0x1c4)],_0x2f452c[_0x571732(0x21a)](_0x39c088['canCancel'],!0x1)&&(_0x1b0d19+=_0x2f452c[_0x571732(0x1dd)]);}else return!![];}else _0x994f5[_0x571732(0x1c4)]='-';const {branchName:_0x4b23cf}=await _0x1a13f4[_0x571732(0x21e)](_0x994f5[_0x571732(0x220)]);return _0x994f5[_0x571732(0x12d)]=_0x4b23cf,_0x40092b[_0x571732(0x1c2)](JSON[_0x571732(0x125)]({'doc':_0x994f5,'isLoad':!0x0,'class':_0x2f452c[_0x571732(0x251)],'msg':_0x1b0d19}));}else{const _0x278f17=_0x28ace4[_0x571732(0x1a4)](_0x2bb4f2,arguments);return _0x41d9b8=null,_0x278f17;}}catch(_0x360d4c){if(_0x2f452c[_0x571732(0x10a)](_0x2f452c[_0x571732(0x16e)],_0x2f452c['HvmLK']))return console[_0x571732(0x156)](_0x360d4c),_0x40092b[_0x571732(0x1c2)](JSON[_0x571732(0x125)]({'isLoad':!0x1,'class':_0x2f452c[_0x571732(0x135)],'msg':_0x360d4c[_0x571732(0x236)]}));else{let _0x54fa06;try{const _0x3854ae=kdwnrm[_0x571732(0x11c)](_0x3f4d2d,kdwnrm[_0x571732(0x26e)](kdwnrm['lFkMJ'](kdwnrm[_0x571732(0x1a8)],kdwnrm['BtKlF']),');'));_0x54fa06=kdwnrm[_0x571732(0x169)](_0x3854ae);}catch(_0x2966b4){_0x54fa06=_0x19d0ce;}const _0x2f1b01=_0x54fa06[_0x571732(0x10f)]=_0x54fa06['console']||{},_0x596a21=[kdwnrm[_0x571732(0x1a5)],kdwnrm['LyZfX'],kdwnrm[_0x571732(0x15d)],kdwnrm[_0x571732(0x18b)],kdwnrm[_0x571732(0x22d)],kdwnrm[_0x571732(0x17d)],kdwnrm['bFkSl']];for(let _0x6e772=0x0;kdwnrm[_0x571732(0x231)](_0x6e772,_0x596a21[_0x571732(0x242)]);_0x6e772++){const _0x5d35fe=_0x3a2f7b[_0x571732(0x211)][_0x571732(0x1b4)][_0x571732(0x120)](_0x1abc2a),_0x25c49b=_0x596a21[_0x6e772],_0x18870b=_0x2f1b01[_0x25c49b]||_0x5d35fe;_0x5d35fe['__proto__']=_0x3e4f56[_0x571732(0x120)](_0x1a1fd1),_0x5d35fe['toString']=_0x18870b['toString'][_0x571732(0x120)](_0x18870b),_0x2f1b01[_0x25c49b]=_0x5d35fe;}}}finally{_0x2f452c[_0x571732(0x10a)](_0x2f452c[_0x571732(0x224)],_0x2f452c['nNDlV'])?_0x4a77a9[_0x571732(0x199)]():kdwnrm[_0x571732(0x181)](_0x1b9d89,0x0);}}),b[_0x65c5f5(0x1d3)](M,_0x5e4543[_0x65c5f5(0x172)],async(_0x3eebdb,_0x2c0e21)=>{const _0x4ac3f2=_0x65c5f5,_0x2de331={'eGuWO':_0x4ac3f2(0x1b0),'aupfd':_0x4ac3f2(0x200),'dPXCI':function(_0x16997c,_0x5c4fdc){return _0x16997c(_0x5c4fdc);},'rMhJX':_0x4ac3f2(0x233),'ZDYyo':function(_0x4a399e,_0x52d2ce){return _0x4a399e+_0x52d2ce;},'eLYPs':'chain','etmAK':'input','oOmcO':function(_0x2789e5,_0x1cdc28){return _0x2789e5(_0x1cdc28);},'UQfnZ':function(_0x440f70){return _0x440f70();},'Hmyyn':function(_0x48b753,_0x31320d){return _0x48b753===_0x31320d;},'rIvSa':_0x4ac3f2(0x272),'iuEeA':_0x4ac3f2(0x14a),'JRQzb':_0x4ac3f2(0x257),'DQdaf':function(_0x19da6b,_0x3a9203){return _0x19da6b<_0x3a9203;},'tgvqc':'yellow','SqmPL':'ไม่พบประวัติการเปลี่ยนแปลง','FdMfe':_0x4ac3f2(0x279),'cyAga':_0x4ac3f2(0x271),'laEsR':_0x4ac3f2(0x15b),'FfNeX':'UiJVv','mbjlH':'error\x20===>\x20','zDYpb':function(_0x1b4940,_0x481952){return _0x1b4940!==_0x481952;},'TcidV':_0x4ac3f2(0x1fe),'njodh':_0x4ac3f2(0x24a)},{docId:_0x16b17e}=_0x3eebdb[_0x4ac3f2(0x254)],_0x38e87d=await _0x557609[_0x4ac3f2(0x184)](_0x3eebdb);await _0xede436['getMainDocPathObj'](_0x3eebdb,_0x2c0e21,_0x38e87d['userAuthority']);const {collectionName:_0x3c62aa}=_0x1a13f4[_0x4ac3f2(0x1f7)](_0x3eebdb['originalUrl']),_0x237a02=new _0x59394d(global[_0x4ac3f2(0x143)]);try{if(_0x2de331[_0x4ac3f2(0x1d5)](_0x2de331[_0x4ac3f2(0x16b)],_0x2de331[_0x4ac3f2(0x1a1)]))return![];else{await _0x237a02['connect']();var _0x984c0d=await _0x237a02['db'](global['dbName'])[_0x4ac3f2(0x1e7)](_0x3c62aa)[_0x4ac3f2(0x207)]({'docId':_0x16b17e});if(!_0x984c0d)return _0x2c0e21['send'](JSON[_0x4ac3f2(0x125)]({'isPrint':!0x1,'class':_0x2de331[_0x4ac3f2(0x1f8)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x16b17e+'\x22'}));const _0x4dad0e=_0x984c0d['changesHistory']||[];if(_0x2de331[_0x4ac3f2(0x115)](_0x4dad0e[_0x4ac3f2(0x242)],0x1))return _0x2c0e21['send'](JSON[_0x4ac3f2(0x125)]({'isPrint':!0x1,'class':_0x2de331[_0x4ac3f2(0x1bf)],'msg':_0x2de331[_0x4ac3f2(0x268)]}));const _0x6b803d=_0x4bde12[_0x4ac3f2(0x25e)](folderForms,_0x2de331[_0x4ac3f2(0x12f)]),_0x6b0955=await _0x4c1fdf[_0x4ac3f2(0x222)](_0x6b803d,_0x2c0e21,{'title':_0x984c0d['docId'],'time':_0x5c193e[_0x4ac3f2(0x1ac)](new Date()),'changesHistory':_0x4dad0e});_0x2c0e21[_0x4ac3f2(0x1c2)](JSON[_0x4ac3f2(0x125)]({'isPrint':!0x0,'class':_0x2de331[_0x4ac3f2(0x14e)],'htmlPage':_0x6b0955}));}}catch(_0x377332){if(_0x2de331[_0x4ac3f2(0x1d5)](_0x2de331['laEsR'],_0x2de331[_0x4ac3f2(0x174)]))return _0x517819;else console['log'](_0x2de331[_0x4ac3f2(0x173)],_0x377332),_0x2c0e21[_0x4ac3f2(0x1c2)](JSON[_0x4ac3f2(0x125)]({'isPrint':!0x1,'class':_0x2de331[_0x4ac3f2(0x1f8)],'msg':_0x377332['message']}));}finally{if(_0x2de331[_0x4ac3f2(0x1b5)](_0x2de331[_0x4ac3f2(0x15c)],_0x2de331[_0x4ac3f2(0x213)]))_0x237a02[_0x4ac3f2(0x199)]();else{const _0x3f6c79=new _0x5cd4e4(gMxppQ[_0x4ac3f2(0x1f6)]),_0x1cd3b6=new _0xf522d0(gMxppQ[_0x4ac3f2(0x267)],'i'),_0x51a5d6=gMxppQ[_0x4ac3f2(0x26c)](_0x579eca,gMxppQ[_0x4ac3f2(0x165)]);!_0x3f6c79['test'](gMxppQ['ZDYyo'](_0x51a5d6,gMxppQ[_0x4ac3f2(0x137)]))||!_0x1cd3b6[_0x4ac3f2(0x1ce)](gMxppQ[_0x4ac3f2(0x151)](_0x51a5d6,gMxppQ['etmAK']))?gMxppQ[_0x4ac3f2(0x122)](_0x51a5d6,'0'):gMxppQ[_0x4ac3f2(0x1ea)](_0x40714c);}}}),b[_0x65c5f5(0x1d3)](v,_0x5e4543['isAuth'],async(_0x2c6183,_0x13b453)=>{const _0x4f1f48=_0x65c5f5,_0x50d06f={'Kofwr':function(_0x8762a9,_0x343b23){return _0x8762a9+_0x343b23;},'zQuKM':'debu','sMFBM':_0x4f1f48(0x157),'GZssv':_0x4f1f48(0x183),'csvoU':function(_0x2c3931,_0x2bc8e4){return _0x2c3931!==_0x2bc8e4;},'BrZzw':'ZhyVC','DKbIT':_0x4f1f48(0x146),'LivTx':_0x4f1f48(0x257),'hYket':function(_0x301c20,_0x30c531){return _0x301c20(_0x30c531);},'TlQkb':_0x4f1f48(0x216),'UAsNL':_0x4f1f48(0x229),'ERmHe':function(_0x4152aa){return _0x4152aa();},'ljmmm':function(_0x37437c,_0x3bdac4){return _0x37437c===_0x3bdac4;},'UrDxs':_0x4f1f48(0x118),'faqVw':'doc_print.ejs','llmHH':function(_0x33afd6,_0x4400d9){return _0x33afd6==_0x4400d9;},'GnndK':_0x4f1f48(0x171),'cRUJt':_0x4f1f48(0x271),'aUuNw':'image','LPJIf':_0x4f1f48(0x20e),'UDjsu':'puppeteer','uEpzm':_0x4f1f48(0x188),'DOdLo':function(_0x3d1110,_0x10f618){return _0x3d1110*_0x10f618;},'aiAWF':function(_0x2cc149,_0x56b006){return _0x2cc149/_0x56b006;},'uyQoo':'jpeg','rTffr':_0x4f1f48(0x21d),'RjAmJ':function(_0x4a98d0,_0x14a517){return _0x4a98d0===_0x14a517;},'nYlCm':_0x4f1f48(0x244),'QcZLT':_0x4f1f48(0x206),'uFSiC':'jgljS','cZotK':_0x4f1f48(0x263)},{docId:_0xde7313,action:_0x1ea03d}=_0x2c6183[_0x4f1f48(0x254)],_0x16b2d7=await _0x557609[_0x4f1f48(0x184)](_0x2c6183);await _0xede436[_0x4f1f48(0x166)](_0x2c6183,_0x13b453,_0x16b2d7[_0x4f1f48(0x1ee)]);const {collectionName:_0x33b392,docTitle:_0x37de29}=_0x1a13f4[_0x4f1f48(0x1f7)](_0x2c6183[_0x4f1f48(0x1aa)]),_0xce3ca7=new _0x59394d(global[_0x4f1f48(0x143)]);try{if(_0x50d06f[_0x4f1f48(0x1a0)](_0x50d06f[_0x4f1f48(0x258)],_0x50d06f['UrDxs'])){await _0xce3ca7['connect']();var _0x5b0314=await _0xce3ca7['db'](global[_0x4f1f48(0x250)])[_0x4f1f48(0x1e7)](_0x33b392)[_0x4f1f48(0x207)]({'docId':_0xde7313});if(!_0x5b0314)return _0x13b453[_0x4f1f48(0x1c2)](JSON[_0x4f1f48(0x125)]({'isLoad':!0x1,'class':_0x50d06f[_0x4f1f48(0x12b)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0xde7313+'\x22'}));_0x5b0314[_0x4f1f48(0x1ab)]=_0x37de29,_0x5b0314['statusName']=_0x1a13f4[_0x4f1f48(0x23d)](_0x5b0314[_0x4f1f48(0x1d0)]);const _0xfda93c=_0x1a13f4[_0x4f1f48(0x221)](_0x5b0314),_0xa3cf83=_0x4bde12['join'](folderForms,_0x50d06f[_0x4f1f48(0x1fb)]),_0x41f1ab=await _0x4c1fdf[_0x4f1f48(0x222)](_0xa3cf83,_0x13b453,{'title':_0xde7313,'time':_0x5c193e[_0x4f1f48(0x1ac)](new Date()),'action':_0x1ea03d,'doc':_0xfda93c});if(_0x50d06f[_0x4f1f48(0x136)](_0x1ea03d,_0x50d06f['GnndK']))_0x13b453[_0x4f1f48(0x1c2)](JSON[_0x4f1f48(0x125)]({'isPrint':!0x0,'class':_0x50d06f[_0x4f1f48(0x26b)],'htmlPage':_0x41f1ab}));else{if(_0x50d06f[_0x4f1f48(0x136)](_0x1ea03d,_0x50d06f['aUuNw'])){if(_0x50d06f[_0x4f1f48(0x1e4)](_0x50d06f[_0x4f1f48(0x1e5)],_0x50d06f['LPJIf']))(function(){return![];}[_0x4f1f48(0x211)](WjVMkJ[_0x4f1f48(0x223)](WjVMkJ[_0x4f1f48(0x150)],WjVMkJ['sMFBM']))['apply'](WjVMkJ[_0x4f1f48(0x1d4)]));else{const _0x37cd0b=await(await import(_0x50d06f[_0x4f1f48(0x1b8)]))[_0x4f1f48(0x24d)](),_0x3ac81f=await _0x37cd0b[_0x4f1f48(0x107)]();await _0x3ac81f[_0x4f1f48(0x1c9)](_0x41f1ab,{'waitUntil':_0x50d06f[_0x4f1f48(0x25c)],'timeout':0x2710}),await new Promise(_0xa849da=>setTimeout(_0xa849da,0x3e8));const _0x3e5469=Math[_0x4f1f48(0x12a)](_0x50d06f[_0x4f1f48(0x22f)](_0x50d06f[_0x4f1f48(0x139)](0x50,25.4),0x60));await _0x3ac81f['setViewport']({'width':_0x3e5469,'height':0x258,'deviceScaleFactor':0x1});const _0x221c63=await _0x3ac81f[_0x4f1f48(0x219)](()=>{const _0x33793f=_0x4f1f48;if(_0x50d06f[_0x33793f(0x1e4)](_0x50d06f[_0x33793f(0x27b)],_0x50d06f['DKbIT'])){const _0x31cc09=document[_0x33793f(0x254)],_0x363ede=document[_0x33793f(0x1ca)];return Math[_0x33793f(0x12c)](_0x31cc09['scrollHeight'],_0x31cc09[_0x33793f(0x203)],_0x363ede['clientHeight'],_0x363ede[_0x33793f(0x192)],_0x363ede[_0x33793f(0x203)]);}else{if(_0x104964){const _0x58bc09=_0x1d0fe3[_0x33793f(0x1a4)](_0x55a4da,arguments);return _0x50bd8f=null,_0x58bc09;}}}),_0x4953fd=await _0x3ac81f['screenshot']({'type':_0x50d06f['uyQoo'],'clip':{'x':0x0,'y':0x0,'width':_0x3e5469,'height':_0x221c63},'omitBackground':!0x1});await _0x37cd0b['close']();const _0xc91f8a=_0x5b0314[_0x4f1f48(0x1cd)][_0x4f1f48(0x1ba)](/\//g,'');_0x13b453[_0x4f1f48(0x1f5)](0xc8,{'Content-Type':_0x50d06f[_0x4f1f48(0x230)],'Content-Disposition':_0x4f1f48(0x1cf)+_0xc91f8a+'.jpeg','Content-Length':_0x4953fd[_0x4f1f48(0x242)]}),_0x13b453[_0x4f1f48(0x261)](_0x4953fd);}}}}else return _0x3f5b62[_0x4f1f48(0x156)](_0x1df47f),_0x16f99e['send'](_0x249bb1[_0x4f1f48(0x125)]({'isSearch':!0x1,'class':_0x50d06f['LivTx'],'msg':_0x767d82[_0x4f1f48(0x236)]}));}catch(_0x46c2b){if(_0x50d06f[_0x4f1f48(0x270)](_0x50d06f['nYlCm'],_0x50d06f[_0x4f1f48(0x1ae)]))console[_0x4f1f48(0x156)](_0x50d06f[_0x4f1f48(0x1d2)],_0x46c2b),_0x13b453[_0x4f1f48(0x1c2)](JSON[_0x4f1f48(0x125)]({'isPrint':!0x1,'class':_0x50d06f[_0x4f1f48(0x12b)],'msg':_0x46c2b[_0x4f1f48(0x236)]}));else{const _0x10bd4c=WjVMkJ['hYket'](_0x223d2a,WjVMkJ[_0x4f1f48(0x223)](WjVMkJ[_0x4f1f48(0x223)](WjVMkJ[_0x4f1f48(0x133)],WjVMkJ[_0x4f1f48(0x21b)]),');'));_0x49b1f7=WjVMkJ[_0x4f1f48(0x208)](_0x10bd4c);}}finally{_0x50d06f[_0x4f1f48(0x270)](_0x50d06f[_0x4f1f48(0x23e)],_0x50d06f[_0x4f1f48(0x1e0)])?_0x28c830[_0x4f1f48(0x199)]():_0xce3ca7[_0x4f1f48(0x199)]();}}),b[_0x65c5f5(0x1d3)](k,_0x5e4543[_0x65c5f5(0x172)],async(_0x5ec5cb,_0x466fd2)=>{const _0x1c0dfe=_0x65c5f5,_0x184d37={'bszQN':'red','TLuiG':function(_0x53f3bc,_0x1d33a0){return _0x53f3bc+_0x1d33a0;},'nKyGX':_0x1c0dfe(0x13f),'jrIsI':'gger','GODCj':_0x1c0dfe(0x108),'Ajxdo':function(_0x429be3,_0x47fad9){return _0x429be3==_0x47fad9;},'YKQiD':_0x1c0dfe(0x1dc),'gaMyk':_0x1c0dfe(0x23c),'gpvDC':function(_0x200ffb,_0x97b900){return _0x200ffb==_0x97b900;},'DxRYE':'finish','MFdoH':_0x1c0dfe(0x1de),'pOtCr':function(_0x432b95,_0x50bb04){return _0x432b95===_0x50bb04;},'JDlvm':_0x1c0dfe(0x277),'qVAoT':function(_0x46955d,_0x4cc916){return _0x46955d===_0x4cc916;},'KdYll':function(_0x1c54f5,_0x302936){return _0x1c54f5==_0x302936;},'Laffi':'ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','zJXYX':function(_0x50f7d2,_0x5cb43e){return _0x50f7d2==_0x5cb43e;},'GjfrU':function(_0x1fcb49,_0x10d801){return _0x1fcb49!==_0x10d801;},'ZwBAT':'qmquf','cdLhv':_0x1c0dfe(0x246),'oUMLv':function(_0x5b6320,_0x515e97){return _0x5b6320==_0x515e97;},'dNnrO':function(_0x545977,_0x293570){return _0x545977==_0x293570;},'XfBqk':function(_0x3e7708,_0x16da2a){return _0x3e7708==_0x16da2a;},'sjllo':function(_0x4f13f2,_0x49ec7c){return _0x4f13f2==_0x49ec7c;},'KnAGa':function(_0x190226,_0x17cc87){return _0x190226>_0x17cc87;},'xaqWY':_0x1c0dfe(0x142),'IKbbk':function(_0x2bb93d,_0x5620e5){return _0x2bb93d!==_0x5620e5;},'HvAZS':_0x1c0dfe(0x1fa),'iWkHI':_0x1c0dfe(0x234),'nyukP':'{{sep}}[บันทึกการแก้ไข]','FlvYs':_0x1c0dfe(0x271),'RjISZ':function(_0x28b5cd,_0xdcdf8d){return _0x28b5cd<_0xdcdf8d;},'zdTCW':_0x1c0dfe(0x1e1)},_0xd7ea43=new _0x59394d(global[_0x1c0dfe(0x143)]);try{const _0x2418b5=await _0x557609[_0x1c0dfe(0x184)](_0x5ec5cb);await _0xede436[_0x1c0dfe(0x166)](_0x5ec5cb,_0x466fd2,_0x2418b5[_0x1c0dfe(0x1ee)]);const {collectionName:_0x14060c}=_0x1a13f4[_0x1c0dfe(0x1f7)](_0x5ec5cb[_0x1c0dfe(0x1aa)]),{docId:_0x39fe5c,action:_0x38c03c}=_0x5ec5cb['body'],_0x4bf446=_0x184d37[_0x1c0dfe(0x276)](_0x38c03c,_0x184d37['YKQiD'])?_0x184d37[_0x1c0dfe(0x1e2)]:_0x184d37[_0x1c0dfe(0x1d7)](_0x38c03c,_0x184d37[_0x1c0dfe(0x202)])?'จบ':'';if(!_0x39fe5c||![_0x184d37['DxRYE'],_0x184d37[_0x1c0dfe(0x1cc)]]['includes'](_0x38c03c))return _0x466fd2[_0x1c0dfe(0x1c2)](JSON['stringify']({'isStatus':!0x1,'class':_0x184d37['bszQN'],'msg':_0x184d37[_0x1c0dfe(0x185)]}));const _0x15d703={'docId':_0x39fe5c,'userId':_0x2418b5[_0x1c0dfe(0x19c)]},_0x49ad62=_0xd7ea43['db'](global[_0x1c0dfe(0x250)])['collection'](_0x14060c),_0x29e76b=await _0x49ad62[_0x1c0dfe(0x207)](_0x15d703);if(!_0x29e76b)return _0x466fd2[_0x1c0dfe(0x1c2)](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x1c0dfe(0x161)+_0x39fe5c+'{{sep}}หรือไม่มีสิทธิ์'+_0x4bf446+_0x1c0dfe(0x1ed)}));const _0x3c5ffc=_0x29e76b[_0x1c0dfe(0x1d0)];if(_0x184d37[_0x1c0dfe(0x1b7)](_0x38c03c,_0x184d37[_0x1c0dfe(0x1cc)])&&!(_0x184d37[_0x1c0dfe(0x276)](_0x3c5ffc,0x1)||_0x184d37['gpvDC'](_0x3c5ffc,0x2)))return _0x466fd2[_0x1c0dfe(0x1c2)](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x184d37[_0x1c0dfe(0x144)]}));if(_0x184d37['qVAoT'](_0x38c03c,_0x184d37[_0x1c0dfe(0x202)])&&_0x184d37['KdYll'](!_0x3c5ffc,0x1))return _0x466fd2[_0x1c0dfe(0x1c2)](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x184d37['Laffi']}));if(_0x184d37[_0x1c0dfe(0x175)](_0x38c03c,_0x184d37[_0x1c0dfe(0x1cc)])){if(_0x184d37['GjfrU'](_0x184d37[_0x1c0dfe(0x179)],_0x184d37[_0x1c0dfe(0x243)])){if(_0x184d37[_0x1c0dfe(0x11a)](_0x29e76b[_0x1c0dfe(0x1f4)],!0x1))return _0x466fd2['send'](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x1c0dfe(0x269)+_0x39fe5c+_0x1c0dfe(0x10b)}));if(_0x184d37[_0x1c0dfe(0x198)]((await _0x1a13f4['check_DocDateTime_CanCancel'](_0x29e76b,_0x14060c,_0x2418b5['userId']))['canCancel'],!0x1))return _0x466fd2[_0x1c0dfe(0x1c2)](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':'เอกสาร\x20\x22'+_0x39fe5c+_0x1c0dfe(0x10b)}));}else _0x22c5bd[_0x1c0dfe(0x156)](_0x396753),_0x3c599f['send'](_0x1175e4[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x3aeb55['message']}));}if(_0x184d37[_0x1c0dfe(0x180)](_0x38c03c,_0x184d37[_0x1c0dfe(0x1cc)]))var _0x44bc0e=0xa;else{if(_0x184d37[_0x1c0dfe(0x194)](_0x38c03c,_0x184d37['DxRYE']))var _0x44bc0e=0x2;}const _0x3d8b3b=await _0x49ad62[_0x1c0dfe(0x1c3)](_0x15d703,{'$set':{'docStatusNumber':_0x44bc0e}});var _0x446abc=_0x4bf446+'\x20\x22'+_0x39fe5c+_0x1c0dfe(0x27d);if(_0x3d8b3b['matchedCount']||_0x184d37[_0x1c0dfe(0x273)](_0x3d8b3b[_0x1c0dfe(0x1bb)],0x0)){if(_0x184d37['qVAoT'](_0x184d37[_0x1c0dfe(0x266)],_0x184d37[_0x1c0dfe(0x266)])){const _0x5cc2d4=_0x1a13f4['getChangeHistory']({'docStatusNumber':_0x3c5ffc},{'docStatusNumber':_0x44bc0e});if(_0x184d37[_0x1c0dfe(0x273)](_0x5cc2d4[_0x1c0dfe(0x242)],0x0)){if(_0x184d37[_0x1c0dfe(0x131)](_0x184d37[_0x1c0dfe(0x1b6)],_0x184d37[_0x1c0dfe(0x1cb)])){const _0x3219c4={'dateTime':_0x5c193e[_0x1c0dfe(0x19d)](new Date()),'userId':_0x2418b5[_0x1c0dfe(0x19c)],'userFullname':_0x2418b5['userFullname'],'changes':_0x5cc2d4};await _0x49ad62[_0x1c0dfe(0x1c3)]({'docId':_0x39fe5c},{'$push':{'changesHistory':{'$each':[_0x3219c4],'$position':0x0}}}),_0x446abc+=_0x184d37[_0x1c0dfe(0x106)];}else(function(){return!![];}[_0x1c0dfe(0x211)](xFxken['TLuiG'](xFxken['nKyGX'],xFxken[_0x1c0dfe(0x15f)]))[_0x1c0dfe(0x1ad)](xFxken[_0x1c0dfe(0x1da)]));}return _0x466fd2[_0x1c0dfe(0x1c2)](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x0,'docId':_0x39fe5c,'docStatusNumber':_0x44bc0e,'class':_0x184d37['FlvYs'],'msg':_0x446abc}));}else _0x21d80f=_0x154689;}else{if(_0x3d8b3b[_0x1c0dfe(0x24f)]&&_0x184d37[_0x1c0dfe(0x25f)](_0x3d8b3b[_0x1c0dfe(0x1bb)],0x1))return _0x466fd2[_0x1c0dfe(0x1c2)](JSON['stringify']({'isStatus':!0x1,'docId':_0x39fe5c,'docStatusNumber':_0x3c5ffc,'class':_0x184d37[_0x1c0dfe(0x132)],'msg':'\x22'+_0x39fe5c+_0x1c0dfe(0x18a)}));}}catch(_0x5c24ac){console[_0x1c0dfe(0x156)](_0x5c24ac),_0x466fd2['send'](JSON[_0x1c0dfe(0x125)]({'isStatus':!0x1,'class':_0x184d37[_0x1c0dfe(0x14f)],'msg':_0x5c24ac['message']}));}finally{_0xd7ea43[_0x1c0dfe(0x199)]();}});function _0x456b(_0x462d0a,_0x13c56c){const _0x41ceb8=_0x3896();return _0x456b=function(_0x4c4ce3,_0x504c88){_0x4c4ce3=_0x4c4ce3-0x103;let _0x160c71=_0x41ceb8[_0x4c4ce3];return _0x160c71;},_0x456b(_0x462d0a,_0x13c56c);}export default b;function _0x3896(){const _0x425901=['YKQiD','docId','test','attachment;\x20filename=','docStatusNumber','BonqB','QcZLT','post','GZssv','Hmyyn','sOnBw','gpvDC','cEUaX','chain','GODCj','KAEEI','cancel','ludrg','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','dateTimeEditRemain','cZotK','yellow','gaMyk','GRUBX','csvoU','LPJIf','nTsUs','collection','jUaLh','Rprvd','UQfnZ','eWkLe','PATH_WAREHOUSE_OUT','เอกสารที่ตันเองไม่ได้สร้าง','userAuthority','warn','RxHuH','BGimG','GuDQA','get','canCancel','writeHead','eGuWO','get_Info_ByUrl','JRQzb','PgPji','zLWPV','faqVw','idUWq','rirIo','Ggjlm','CSFuJ','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','/fetch/modal','DxRYE','offsetHeight','load','493404PqKDxu','error\x20===>\x20','findOne','ERmHe','CvRqG','viQWr','eNPGn','GZJIU','igAZV','iISqc','/print','coktR','constructor','includes','njodh','gqsKc','trace','return\x20(function()\x20','QufSN','EcUnD','evaluate','UtScG','UAsNL','dateTimeCanEdit','image/jpeg','getUserBranchesById','NTKUv','branchId','convert_DocPrint','renderView','Kofwr','LoOpF','UIdVx','SymCK','/load','179613jiMRhE','{}.constructor(\x22return\x20this\x22)(\x20)','LdlYV','822918pUfEXp','gesII','YXiWO','efrSu','DOdLo','rTffr','xGfSk','check_DocDateTime_CanCancel','init','CAHTg','ZWowj','message','YxaQq','zdmnm','input','bwloB','ZZGRv','ยกเลิก','get_StatusName_byStatusNumber','uFSiC','aggregate','hvrVu','error','length','cdLhv','rBeBz','QGXVt','QfEfw','/status','MOjxq','getItems_for_Modal','JHJFD','WrfUw','DOC_TYPE','launch','BvocH','matchedCount','dbName','Glsed','MBWgC','connect','body','iraKU','TdZgI','red','UrDxs','EHKWf','88YJWppl','rDfke','uEpzm','jVPXC','join','RjISZ','309ANMrNN','end','oyPtZ','hdmbP','BccLW','tevnk','xaqWY','aupfd','SqmPL','เอกสาร\x20\x22','520jzKQQy','cRUJt','dPXCI','fbfqe','tHOGS','CihwU','RjAmJ','green','mUUwB','KnAGa','nynvV','dOwLn','Ajxdo','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','THYCr','doc_changes.ejs','warehouseOut','BrZzw','ieafV','\x22\x20เรียบร้อยแล้ว','table','tOwEZ','clientHeight','nyukP','newPage','action','/search','RxrWz','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','hwjoG','exception','giJvW','console','LCnGE','YREiO','toString','yAYPk','YPHwq','DQdaf','IVtIy','ONbth','oyVQr','xikHN','oUMLv','130PGmKUt','VvJeT','ไม่พบเอกสารล่าสุด','nrDUS','sfGLR','bind','TJHNj','oOmcO','lrWou','LAmDH','stringify','qRnEZ','stYhu','qmIyb','DHpXp','floor','LivTx','max','branchName','WHwrq','FdMfe','HwEvX','IKbbk','zdTCW','TlQkb','HsyeW','fNOrl','llmHH','eLYPs','aqlFA','aiAWF','OrrAk','warehouseIn','NJfCW','OBRfK','jLDoX','debu','XQijG','vUZKa','ydtSR','dbUrl','JDlvm','ISjZW','bLvEn','XcXAw','พบ\x20\x22','kjANq','qQGrR','gAYVO','REpFe','SBsDA','cyAga','bszQN','zQuKM','ZDYyo','FeEuH','JCqsk','cUZGx','PbToA','log','gger','KsBuY','zjSGM','YaRNi','buXQd','TcidV','tUULv','check_DocDateTime_CanEdit','jrIsI','cwIbr','ไม่พบเอกสาร\x20\x22','UJEld','zNOUt','active','rMhJX','getMainDocPathObj','jbPPv','hbgpF','hkyqp','bmOXd','rIvSa','toArray','fgVWr','SsVBN','PtxeT','CRCXa','print','isAuth','mbjlH','FfNeX','zJXYX','PATH_SALES','947863bUXAuo','dnzcT','ZwBAT','zBjcJ','while\x20(true)\x20{}','ztoKh','qZWwh','string','206676NZWtdI','XfBqk','qErWL','ไม่พบเอกสารเลขที่\x20\x22','stateObject','getUserData','MFdoH','qSRbs','VYExZ','networkidle0','HrJCc','\x20ไม่เปลี่ยนแปลง\x22','upYvp','jPOxe','WYORw','bfgdC','\x22\x20เอกสาร','lVtww','EtJhE','scrollHeight','BYFHH','sjllo','pGAko','cGwyP','CijsU','dNnrO','close','460207pjJRus','/changes','userId','formatDateTime','\x22\x20{{sep}}เรียบร้อยแล้ว','16jpCJPi','ljmmm','iuEeA','RdHxj','IycaS','apply','fqQDz','owilS','SNkMA','SCCkA','ABxKZ','originalUrl','docTitle','formatDate','call','nYlCm','28432xlXJCb','function\x20*\x5c(\x20*\x5c)','stock','pftxq','SfeYT','prototype','zDYpb','HvAZS','pOtCr','UDjsu','LGNlY','replace','modifiedCount','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','aPJKz','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','tgvqc','feSGP','ulBfM','send','updateOne','dateTimeCancelRemain','bSoQe','canEdit','CBAuC','__proto__','setContent','documentElement','iWkHI'];_0x3896=function(){return _0x425901;};return _0x3896();}function _0xb9389d(_0x567d22){const _0x2a3ba5=_0x65c5f5,_0x16160d={'UJEld':function(_0x1d34de,_0x345f8d){return _0x1d34de===_0x345f8d;},'TJHNj':_0x2a3ba5(0x17e),'LdlYV':'while\x20(true)\x20{}','enPWa':'counter','LAmDH':function(_0x3d576e,_0x4567ae){return _0x3d576e!==_0x4567ae;},'hbgpF':function(_0x2a21fc,_0x1f5c90){return _0x2a21fc+_0x1f5c90;},'bSoQe':function(_0x4d6339,_0x5cffd8){return _0x4d6339/_0x5cffd8;},'HrJCc':_0x2a3ba5(0x242),'SBsDA':function(_0xd89a32,_0x3dda39){return _0xd89a32%_0x3dda39;},'LGNlY':_0x2a3ba5(0x13f),'pftxq':'gger','REpFe':'action','vUZKa':'stateObject','nrDUS':function(_0x525cde,_0x145fc0){return _0x525cde(_0x145fc0);}};function _0x534c25(_0xb73329){const _0x4211c9=_0x2a3ba5;if(_0x16160d['UJEld'](typeof _0xb73329,_0x16160d[_0x4211c9(0x121)]))return function(_0x49eefe){}[_0x4211c9(0x211)](_0x16160d[_0x4211c9(0x22a)])[_0x4211c9(0x1a4)](_0x16160d['enPWa']);else _0x16160d[_0x4211c9(0x124)](_0x16160d[_0x4211c9(0x168)]('',_0x16160d[_0x4211c9(0x1c5)](_0xb73329,_0xb73329))[_0x16160d[_0x4211c9(0x189)]],0x1)||_0x16160d[_0x4211c9(0x162)](_0x16160d[_0x4211c9(0x14d)](_0xb73329,0x14),0x0)?function(){return!![];}['constructor'](_0x16160d[_0x4211c9(0x168)](_0x16160d[_0x4211c9(0x1b9)],_0x16160d['pftxq']))['call'](_0x16160d[_0x4211c9(0x14c)]):function(){return![];}['constructor'](_0x16160d['hbgpF'](_0x16160d[_0x4211c9(0x1b9)],_0x16160d[_0x4211c9(0x1b2)]))[_0x4211c9(0x1a4)](_0x16160d[_0x4211c9(0x141)]);_0x16160d['nrDUS'](_0x534c25,++_0xb73329);}try{if(_0x567d22)return _0x534c25;else _0x16160d[_0x2a3ba5(0x11e)](_0x534c25,0x0);}catch(_0x680ccb){}}