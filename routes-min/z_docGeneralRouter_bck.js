const _0x2e089a=_0x4ab2;(function(_0x37e522,_0x418632){const _0x545ee7=_0x4ab2,_0x190239=_0x37e522();while(!![]){try{const _0x3b4423=parseInt(_0x545ee7(0x120))/0x1*(parseInt(_0x545ee7(0x281))/0x2)+parseInt(_0x545ee7(0x191))/0x3*(-parseInt(_0x545ee7(0x243))/0x4)+parseInt(_0x545ee7(0x10a))/0x5*(parseInt(_0x545ee7(0x160))/0x6)+-parseInt(_0x545ee7(0x193))/0x7*(-parseInt(_0x545ee7(0x221))/0x8)+-parseInt(_0x545ee7(0x1f2))/0x9*(parseInt(_0x545ee7(0x25c))/0xa)+-parseInt(_0x545ee7(0x1d0))/0xb+parseInt(_0x545ee7(0x20b))/0xc*(-parseInt(_0x545ee7(0x19c))/0xd);if(_0x3b4423===_0x418632)break;else _0x190239['push'](_0x190239['shift']());}catch(_0xdba433){_0x190239['push'](_0x190239['shift']());}}}(_0x24ee,0x3caeb));const _0x17e687=(function(){const _0x12b5ed=_0x4ab2,_0x401986={'xEvXj':_0x12b5ed(0x20a),'Twqha':_0x12b5ed(0x11d),'zXNTE':function(_0x35bebd,_0x240b0e){return _0x35bebd(_0x240b0e);},'lzxmR':_0x12b5ed(0x13d),'UBfbe':function(_0x4c053c,_0x5696b1){return _0x4c053c+_0x5696b1;},'OIiTK':_0x12b5ed(0x1ca),'fTACF':_0x12b5ed(0x20f),'GAzkL':function(_0x18793a,_0x3e3d2d){return _0x18793a(_0x3e3d2d);},'beBsH':function(_0x13d8af){return _0x13d8af();},'RfnMQ':_0x12b5ed(0x205),'yeGko':'gger','koUPJ':'action','KitSb':function(_0xf0c118,_0x57c0c5){return _0xf0c118===_0x57c0c5;},'JIGIa':'OZEyW','xbYYJ':function(_0x445e00,_0x3d4971){return _0x445e00!==_0x3d4971;},'MYsDM':'FkMgO','eWndj':function(_0x3abbf9,_0x52c75e){return _0x3abbf9+_0x52c75e;},'GqHeB':'return\x20(function()\x20','akAly':'{}.constructor(\x22return\x20this\x22)(\x20)','Iptqm':function(_0x1b523b){return _0x1b523b();},'oFElu':_0x12b5ed(0x1d4)};let _0x9c8f53=!![];return function(_0x2ecaac,_0x1ee7f7){const _0x115414=_0x12b5ed;if(_0x401986['KitSb'](_0x401986[_0x115414(0x11c)],_0x401986['oFElu'])){const _0x1e8cee=_0x9c8f53?function(){const _0x229992=_0x115414,_0x123afb={'yTzga':_0x401986[_0x229992(0x23e)],'VCOlC':_0x401986[_0x229992(0x1b7)],'IrrUB':function(_0x3db899,_0x144a40){return _0x401986['zXNTE'](_0x3db899,_0x144a40);},'cbCQo':_0x401986['lzxmR'],'VfovU':function(_0x2b6b28,_0x460978){return _0x401986['UBfbe'](_0x2b6b28,_0x460978);},'keWAI':_0x401986[_0x229992(0x181)],'ExntM':_0x401986['fTACF'],'xiplK':function(_0x56aae5,_0xcc80a8){const _0x2b1d5f=_0x229992;return _0x401986[_0x2b1d5f(0x111)](_0x56aae5,_0xcc80a8);},'LLEEz':function(_0x3af9fa){const _0x1dbe3e=_0x229992;return _0x401986[_0x1dbe3e(0x208)](_0x3af9fa);},'qOMCy':_0x401986[_0x229992(0x24d)],'qVGUY':_0x401986[_0x229992(0x257)],'mvNJk':_0x401986[_0x229992(0x1e2)]};if(_0x401986['KitSb'](_0x401986[_0x229992(0x1de)],_0x401986[_0x229992(0x1de)])){if(_0x1ee7f7){if(_0x401986[_0x229992(0x130)](_0x401986[_0x229992(0x17f)],_0x401986[_0x229992(0x17f)])){const _0x49c65a=new _0xd122a5(_0x123afb[_0x229992(0x19b)]),_0x463b60=new _0x1f0b74(_0x123afb[_0x229992(0x1f1)],'i'),_0x21f284=_0x123afb[_0x229992(0x280)](_0x5036bf,_0x123afb[_0x229992(0x25a)]);!_0x49c65a['test'](_0x123afb[_0x229992(0x13f)](_0x21f284,_0x123afb[_0x229992(0x26f)]))||!_0x463b60['test'](_0x123afb[_0x229992(0x13f)](_0x21f284,_0x123afb[_0x229992(0x14f)]))?_0x123afb['xiplK'](_0x21f284,'0'):_0x123afb['LLEEz'](_0x1d5a8c);}else{const _0x59517f=_0x1ee7f7[_0x229992(0x133)](_0x2ecaac,arguments);return _0x1ee7f7=null,_0x59517f;}}}else(function(){return!![];}[_0x229992(0x1b9)](_0x123afb[_0x229992(0x13f)](_0x123afb['qOMCy'],_0x123afb[_0x229992(0x207)]))[_0x229992(0x259)](_0x123afb[_0x229992(0x22e)]));}:function(){};return _0x9c8f53=![],_0x1e8cee;}else{const _0x1178f1=_0x401986[_0x115414(0x11e)](_0x6fcf95,_0x401986['UBfbe'](_0x401986[_0x115414(0x156)](_0x401986[_0x115414(0x252)],_0x401986[_0x115414(0x143)]),');'));_0x558d15=_0x401986[_0x115414(0x248)](_0x1178f1);}};}());function _0x4ab2(_0xa70189,_0x14bcab){const _0x5c648c=_0x24ee();return _0x4ab2=function(_0x2dfbcf,_0x16ee0c){_0x2dfbcf=_0x2dfbcf-0x108;let _0x4b9fba=_0x5c648c[_0x2dfbcf];return _0x4b9fba;},_0x4ab2(_0xa70189,_0x14bcab);}(function(){const _0xa881e5=_0x4ab2,_0x1e874c={'RZsAU':_0xa881e5(0x17c),'feKog':function(_0x13123c,_0xfd8db){return _0x13123c!==_0xfd8db;},'eifUu':'KYatY','oFKyE':_0xa881e5(0x1b3),'rXmPH':_0xa881e5(0x20a),'TiqJW':_0xa881e5(0x11d),'RdwtZ':function(_0x4a949a,_0x16a69e){return _0x4a949a(_0x16a69e);},'ZbVuK':_0xa881e5(0x13d),'MWEMF':function(_0x578afe,_0x4dc512){return _0x578afe+_0x4dc512;},'GAEjR':_0xa881e5(0x1ca),'AXpcm':function(_0x5a18e6,_0x281d7e){return _0x5a18e6+_0x281d7e;},'WKQdj':_0xa881e5(0x20f),'SWTBO':function(_0x5dfac7,_0x2f4305){return _0x5dfac7===_0x2f4305;},'TGAWa':_0xa881e5(0x1df),'qceVW':function(_0x4745cc,_0x249717){return _0x4745cc(_0x249717);},'cbiPa':_0xa881e5(0x1dd),'qkTZe':function(_0x18d537){return _0x18d537();},'EPSUT':function(_0x4be905,_0x33a051,_0x1a591c){return _0x4be905(_0x33a051,_0x1a591c);}};_0x1e874c[_0xa881e5(0x12f)](_0x17e687,this,function(){const _0x367338=_0xa881e5,_0x17d24f={'fipXs':_0x1e874c[_0x367338(0x25d)]};if(_0x1e874c[_0x367338(0x161)](_0x1e874c[_0x367338(0x1d2)],_0x1e874c[_0x367338(0x289)])){const _0x154ddf=new RegExp(_0x1e874c[_0x367338(0x164)]),_0x5cbd39=new RegExp(_0x1e874c['TiqJW'],'i'),_0x156935=_0x1e874c[_0x367338(0x192)](_0xc6cb0f,_0x1e874c[_0x367338(0x1ea)]);if(!_0x154ddf[_0x367338(0x25e)](_0x1e874c[_0x367338(0x27e)](_0x156935,_0x1e874c[_0x367338(0x187)]))||!_0x5cbd39[_0x367338(0x25e)](_0x1e874c[_0x367338(0x188)](_0x156935,_0x1e874c[_0x367338(0x223)]))){if(_0x1e874c[_0x367338(0x1ce)](_0x1e874c[_0x367338(0x138)],_0x1e874c[_0x367338(0x138)]))_0x1e874c[_0x367338(0x1eb)](_0x156935,'0');else return _0x3def3c;}else{if(_0x1e874c[_0x367338(0x1ce)](_0x1e874c[_0x367338(0x254)],_0x1e874c['cbiPa']))_0x1e874c['qkTZe'](_0xc6cb0f);else{if(_0x25aa75){const _0x4ad8f2=_0x53d72d[_0x367338(0x133)](_0x57761,arguments);return _0x27b247=null,_0x4ad8f2;}}}}else return _0x6b545f[_0x367338(0x21d)](_0x48cfb0),_0x426229[_0x367338(0x241)](_0x442c83[_0x367338(0x204)]({'isFetch':!0x1,'class':_0x17d24f[_0x367338(0x26c)],'msg':_0x4d2008[_0x367338(0x226)]}));})();}());const _0x16ee0c=(function(){const _0x7d4329=_0x4ab2,_0x4e5646={'tmvhZ':_0x7d4329(0x1fb),'jCRrx':_0x7d4329(0x17c),'gkcwR':function(_0x1ebea2,_0x494d92){return _0x1ebea2===_0x494d92;},'CfwJz':'dYJJu','HlNUr':_0x7d4329(0x24c),'TFJsV':_0x7d4329(0x119),'IyVsi':function(_0x222c65,_0x2648dc){return _0x222c65===_0x2648dc;},'AFMyc':_0x7d4329(0x268)};let _0x17abcb=!![];return function(_0x296156,_0x367afb){const _0x333042=_0x7d4329,_0x5803bf={'UnnPe':_0x4e5646[_0x333042(0x169)],'CqOql':_0x4e5646[_0x333042(0x1aa)],'HMttj':function(_0x1fe9aa,_0x4849c2){const _0x3f3dd9=_0x333042;return _0x4e5646[_0x3f3dd9(0x128)](_0x1fe9aa,_0x4849c2);},'zNMeT':_0x4e5646[_0x333042(0x190)],'onYPA':_0x4e5646[_0x333042(0x1d7)],'lblQS':_0x4e5646['TFJsV']};if(_0x4e5646[_0x333042(0x251)](_0x4e5646[_0x333042(0x1f4)],_0x4e5646[_0x333042(0x1f4)])){const _0x59164c=_0x17abcb?function(){const _0x5f09f4=_0x333042;if(_0x5803bf['HMttj'](_0x5803bf['zNMeT'],_0x5803bf[_0x5f09f4(0x237)])){if(_0x367afb){if(_0x5803bf['HMttj'](_0x5803bf[_0x5f09f4(0x1a5)],_0x5803bf[_0x5f09f4(0x1c9)])){const _0x178c74=_0xa4c9ff?function(){const _0xd467d3=_0x5f09f4;if(_0x58ab1a){const _0xa1ddf8=_0xd4e35[_0xd467d3(0x133)](_0x44cba8,arguments);return _0x34d473=null,_0xa1ddf8;}}:function(){};return _0xc7bb5b=![],_0x178c74;}else{const _0xc1562b=_0x367afb[_0x5f09f4(0x133)](_0x296156,arguments);return _0x367afb=null,_0xc1562b;}}}else _0x42ea67[_0x5f09f4(0x21d)](_0x5803bf[_0x5f09f4(0x21f)],_0x5d9e42),_0x37af89['send'](_0x5e2d52[_0x5f09f4(0x204)]({'isPrint':!0x1,'class':_0x5803bf[_0x5f09f4(0x26d)],'msg':_0x5e1962[_0x5f09f4(0x226)]}));}:function(){};return _0x17abcb=![],_0x59164c;}else return![];};}()),_0x2dfbcf=_0x16ee0c(this,function(){const _0x2fc90c=_0x4ab2,_0x153e70={'jlQYL':'error\x20===>\x20','xnScT':_0x2fc90c(0x17c),'NQynw':function(_0xec4fc6,_0x444101){return _0xec4fc6!==_0x444101;},'KTxuL':_0x2fc90c(0x275),'yfCKR':function(_0x4f9a63,_0x3a6350){return _0x4f9a63(_0x3a6350);},'gmWyU':function(_0xcbb66f,_0x3272af){return _0xcbb66f+_0x3272af;},'DYbcC':function(_0x47c1f2,_0x125ef5){return _0x47c1f2+_0x125ef5;},'LUwPZ':_0x2fc90c(0x1e4),'ITHyt':_0x2fc90c(0x1c3),'BKslW':function(_0x3acab6){return _0x3acab6();},'ZrzDA':'EVJSe','ScShe':_0x2fc90c(0x21d),'kGeML':_0x2fc90c(0x113),'vthvO':_0x2fc90c(0x21e),'KOmFB':_0x2fc90c(0x261),'hRQwC':_0x2fc90c(0x1ec),'SeycQ':_0x2fc90c(0x10f),'CGGNS':_0x2fc90c(0x28e),'OyyuN':function(_0x4cdc82,_0x2bca89){return _0x4cdc82<_0x2bca89;},'xrNws':function(_0x277d67,_0x366156){return _0x277d67===_0x366156;},'NOkds':_0x2fc90c(0x15f),'NwHmq':_0x2fc90c(0x12c)};let _0xa1d1c8;try{if(_0x153e70[_0x2fc90c(0x179)](_0x153e70[_0x2fc90c(0x238)],_0x153e70[_0x2fc90c(0x238)]))_0x1048c1[_0x2fc90c(0x21d)](_0x153e70['jlQYL'],_0xfb1580),_0x1e6ef3[_0x2fc90c(0x241)](_0x1fb1b3['stringify']({'isPrint':!0x1,'class':_0x153e70[_0x2fc90c(0x198)],'msg':_0x419def[_0x2fc90c(0x226)]}));else{const _0x21d01b=_0x153e70[_0x2fc90c(0x174)](Function,_0x153e70[_0x2fc90c(0x203)](_0x153e70[_0x2fc90c(0x1e5)](_0x153e70[_0x2fc90c(0x195)],_0x153e70['ITHyt']),');'));_0xa1d1c8=_0x153e70[_0x2fc90c(0x21b)](_0x21d01b);}}catch(_0x42fe3d){if(_0x153e70[_0x2fc90c(0x179)](_0x153e70['ZrzDA'],_0x153e70[_0x2fc90c(0x227)])){const _0x56bc19=_0x11c4a4[_0x2fc90c(0x1b9)][_0x2fc90c(0x24e)]['bind'](_0x38336d),_0x52e7bc=_0x572abb[_0x3d6c65],_0x5c8d49=_0x3fc186[_0x52e7bc]||_0x56bc19;_0x56bc19['__proto__']=_0x13d0fe[_0x2fc90c(0x1b5)](_0x357aed),_0x56bc19[_0x2fc90c(0x17a)]=_0x5c8d49[_0x2fc90c(0x17a)][_0x2fc90c(0x1b5)](_0x5c8d49),_0x5cf3b1[_0x52e7bc]=_0x56bc19;}else _0xa1d1c8=window;}const _0x1bf054=_0xa1d1c8['console']=_0xa1d1c8[_0x2fc90c(0x168)]||{},_0x1943fc=[_0x153e70[_0x2fc90c(0x1b4)],_0x153e70[_0x2fc90c(0x1bd)],_0x153e70[_0x2fc90c(0x16c)],_0x153e70[_0x2fc90c(0x278)],_0x153e70['hRQwC'],_0x153e70['SeycQ'],_0x153e70[_0x2fc90c(0x147)]];for(let _0x30cf02=0x0;_0x153e70[_0x2fc90c(0x27b)](_0x30cf02,_0x1943fc[_0x2fc90c(0x16a)]);_0x30cf02++){if(_0x153e70[_0x2fc90c(0x242)](_0x153e70['NOkds'],_0x153e70[_0x2fc90c(0x194)]))_0x721a94[_0x2fc90c(0x13c)]();else{const _0x3982b7=_0x16ee0c[_0x2fc90c(0x1b9)][_0x2fc90c(0x24e)]['bind'](_0x16ee0c),_0x30ea68=_0x1943fc[_0x30cf02],_0x114873=_0x1bf054[_0x30ea68]||_0x3982b7;_0x3982b7[_0x2fc90c(0x14e)]=_0x16ee0c['bind'](_0x16ee0c),_0x3982b7[_0x2fc90c(0x17a)]=_0x114873[_0x2fc90c(0x17a)][_0x2fc90c(0x1b5)](_0x114873),_0x1bf054[_0x30ea68]=_0x3982b7;}}});_0x2dfbcf();import _0x4cb0af from'express';const b=_0x4cb0af[_0x2e089a(0x18c)]();import _0x31ae24 from'path';function _0x24ee(){const _0x5697a3=['ExntM','LaaPo','kImOJ','setContent','XGNGT','mjzwz','LskYz','eWndj','get_Info_ByUrl','NQxHy','dateTimeEditRemain','stock','BJplC','findOne','BHZWK','/load-last','nTDiv','18XmseGo','feKog','Gaaiu','screenshot','rXmPH','body','branchName','/fetch/modal','console','tmvhZ','length','RTYCD','vthvO','docId','launch','YFDqT','coTcH','DThBV','offsetHeight','YnxTr','yfCKR','gloAr','ewXkQ','image','GHvcI','NQynw','toString','image/jpeg','red','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','replace','MYsDM','FMnKH','OIiTK','PATH_WAREHOUSE_OUT','sFkCw','canEdit','getChangeHistory','yJYYx','GAEjR','AXpcm','qEtFU','green','changesHistory','Router','push','BBcjc','LJiZL','CfwJz','4974XuyRJr','RdwtZ','69055fBMIde','NwHmq','LUwPZ','max','\x20ไม่เปลี่ยนแปลง\x22','xnScT','TZTho','tWUlF','yTzga','35633tcqcBb','{{sep}}หรือไม่มีสิทธิ์','jpeg','เอกสารที่ตันเองไม่ได้สร้าง','documentElement','getMainDocPathObj','yibLS','tSqwe','QzmWe','onYPA','erxYx','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','zcLbF','oCjUq','jCRrx','canCancel','ZEUiW','NwNIE','KLTsL','gger','VzzQy','get','ไม่พบเอกสารเลขที่\x20\x22','syIxT','ScShe','bind','jkfCT','Twqha','lQzuK','constructor','collection','load-last','JNstG','kGeML','HHNtV','gKPTT','warehouseOut','otgQR','uNSqb','{}.constructor(\x22return\x20this\x22)(\x20)','active','cancel','MRtwH','includes','dateTimeCanCancel','lblQS','chain','oGlEG','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','bqJpK','SWTBO','djApz','1027950EuYekR','bgtih','eifUu','SvkVP','ubJbp','attachment;\x20filename=','aDQKj','HlNUr','IUXPa','YhFzt','getUserData','vFTvK','jFaNH','ILdzo','JIGIa','HUiAA','setViewport','KgsHa','koUPJ','toArray','return\x20(function()\x20','DYbcC','PkfMI','YIyhV','PATH_SALES','LDZKA','ZbVuK','qceVW','exception','UVykT','XqFSe','statusName','originalUrl','VCOlC','34677IAdaOB','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','AFMyc','nqyGe','renderView','pZFxc','scrollHeight','WAlau','newPage','error\x20===>\x20','LKCfZ','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','vKZUA','lBjkw','VIutd','gRDey','PgRjp','gmWyU','stringify','debu','elZyC','qVGUY','beBsH','getItems_for_Modal','function\x20*\x5c(\x20*\x5c)','1968yLWvyL','eIQYG','cYwHw','MyzOk','input','GxnmF','dateTimeCancelRemain','fcdGE','EUwqJ','Jfzyh','yrQbg','dbUrl','gLDEe','CckGL','.jpeg','QYCEc','BKslW','uDtAn','log','info','UnnPe','end','384YFgnnJ','docTitle','WKQdj','oIbIr','ytOqw','message','ZrzDA','/search','ไม่พบเอกสารล่าสุด','userAuthority','yLlqj','cqwiT','KmwJE','mvNJk','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','ySHRR','IcFtR','bDsGs','FtbFW','load','mxaTg','UobwX','zNMeT','KTxuL','kJpro','IZuZm','PitEH','OJQRg','nJaeZ','xEvXj','action','DOC_TYPE','send','xrNws','132ORcnuN','FKsGZ','stateObject','FwHdy','doc_print.ejs','Iptqm','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','OySyl','JNQhm','xSBOr','RfnMQ','prototype','counter','jlQSQ','IyVsi','GqHeB','\x22\x20เรียบร้อยแล้ว','cbiPa','docStatusNumber','XIeQU','yeGko','AAzkd','call','cbCQo','aZsUu','40zvMbFA','RZsAU','test','connect','พบ\x20\x22','error','efrhL','tOZNk','string','Nhcno','bFfyc','ALAmp','jGFEH','lVMlX','updateOne','yellow','fipXs','CqOql','post','keWAI','/status','isAuth','puppeteer','AWIIs','while\x20(true)\x20{}','sVOzz','matchedCount','EmNDt','KOmFB','เอกสาร\x20\x22','/print','OyyuN','mvIdi','DJjGZ','MWEMF','IOQNK','IrrUB','89036csnMYc','kazhK','Bqkjy','ZFvDP','{{sep}}[บันทึกการแก้ไข]','RgtZf','ahgYx','XQWBX','oFKyE','TZOuE','SFnhJ','cvWLf','fSOiw','trace','nyUfJ','DNJcr','ยกเลิก','350105IfTEOC','branchId','/load','VPVVt','CMCGf','table','FfBhT','GAzkL','convert_DocPrint','warn','htsaG','evaluate','wKhUz','sJSbB','uMZVz','bNcSO','rMVbo','Ptbiy','oFElu','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','zXNTE','aOobN','4ujaedc','formatDateTime','bYyvC','DATvx','warehouseIn','YswKB','AqKRN','pCQje','gkcwR','dbName','ErTaQ','\x22\x20{{sep}}เรียบร้อยแล้ว','inbLa','CSgEI','Etegf','EPSUT','xbYYJ','join','VydrT','apply','QWOsv','AeCBb','mjTVC','KyeMt','TGAWa','userId','VayjP','/changes','close','init','VZXQN','VfovU','sfRfq','xrihi','Yaytb','akAly','tKDdR','clientHeight','sales','CGGNS','guhcu','Hlakg','gWUWB','eVpSg','DWbTq','Jqquv','__proto__'];_0x24ee=function(){return _0x5697a3;};return _0x24ee();}import{MongoClient as _0x2c14fd}from'mongodb';import _0x1bdb2d from'../middleware/mainAuth.js';import*as _0x1c42ca from'../mymodule/myUsers.js';import*as _0x3374a5 from'../mymodule/myDateTime.js';import*as _0x253d3b from'../mymodule/myModule.js';import*as _0x32a230 from'../mymodule/myDocMain.js';import*as _0x215766 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0x2e089a(0x182)],p=global[_0x2e089a(0x1e8)],M=[w+_0x2e089a(0x13b),S+_0x2e089a(0x13b),p+_0x2e089a(0x13b)],v=[w+_0x2e089a(0x27a),S+'/print',p+'/print'],k=[w+'/status',S+_0x2e089a(0x270),p+_0x2e089a(0x270)],B=[w+_0x2e089a(0x228),S+_0x2e089a(0x228),p+_0x2e089a(0x228)],x=[w+_0x2e089a(0x10c),S+_0x2e089a(0x10c),p+'/load',w+'/load-last',S+_0x2e089a(0x15e),p+_0x2e089a(0x15e)],L=[w+_0x2e089a(0x167),S+_0x2e089a(0x167),p+'/fetch/modal'];b[_0x2e089a(0x1b1)](L,_0x1bdb2d[_0x2e089a(0x271)],async(_0x4f1da8,_0x2d94ba)=>{const _0x315597=_0x2e089a,_0x3db3fa={'PgRjp':function(_0x30efec,_0x51dedc){return _0x30efec(_0x51dedc);},'gWUWB':function(_0xf8a1a2,_0x404aa2){return _0xf8a1a2===_0x404aa2;},'nyUfJ':_0x315597(0x12d),'zcLbF':function(_0x1543e7,_0x424b48){return _0x1543e7==_0x424b48;},'FqnYa':_0x315597(0x124),'LKCfZ':_0x315597(0x15a),'EUwqJ':_0x315597(0x1c0),'efrhL':function(_0x52f27a,_0x1f00c1){return _0x52f27a==_0x1f00c1;},'yJYYx':_0x315597(0x146),'xqJbb':_0x315597(0x1c4),'Jqquv':_0x315597(0x18a),'YIyhV':_0x315597(0x17d),'NuQij':function(_0x4b7d20,_0x49b124){return _0x4b7d20!==_0x49b124;},'SFnhJ':_0x315597(0x23b),'AWIIs':_0x315597(0x17c)},_0xed420a=await _0x1c42ca[_0x315597(0x1da)](_0x4f1da8),_0x53bc46=await _0x32a230[_0x315597(0x1a1)](_0x4f1da8,_0x2d94ba,_0xed420a[_0x315597(0x22a)]);try{if(_0x3db3fa[_0x315597(0x14a)](_0x3db3fa[_0x315597(0x28f)],_0x3db3fa[_0x315597(0x28f)])){if(_0x3db3fa['zcLbF'](_0x53bc46[_0x315597(0x240)],_0x3db3fa['FqnYa']))var _0x49abbf=await _0x215766[_0x315597(0x209)](_0x3db3fa[_0x315597(0x1fc)]);else{if(_0x3db3fa[_0x315597(0x1a8)](_0x53bc46[_0x315597(0x240)],_0x3db3fa[_0x315597(0x213)]))var _0x49abbf=await _0x215766['getItems_for_Modal'](_0x3db3fa[_0x315597(0x1fc)]);else{if(_0x3db3fa[_0x315597(0x262)](_0x53bc46[_0x315597(0x240)],_0x3db3fa[_0x315597(0x186)]))var _0x49abbf=await _0x215766['getItems_for_Modal'](_0x3db3fa['xqJbb']);}}const _0x8bd229=await _0x215766['getItemsCategory']();return _0x2d94ba[_0x315597(0x241)](JSON['stringify']({'DATA_ITEMS':_0x49abbf,'DATA_CATEGORY':_0x8bd229,'isFetch':!0x0,'class':_0x3db3fa[_0x315597(0x14d)],'msg':_0x3db3fa[_0x315597(0x1e7)]}));}else jdlqiz[_0x315597(0x202)](_0x4d9b35,'0');}catch(_0x1c2e64){if(_0x3db3fa['NuQij'](_0x3db3fa[_0x315597(0x28b)],_0x3db3fa[_0x315597(0x28b)])){if(_0x4160a6)return _0x3ae22c;else jdlqiz[_0x315597(0x202)](_0x344f59,0x0);}else return console[_0x315597(0x21d)](_0x1c2e64),_0x2d94ba['send'](JSON[_0x315597(0x204)]({'isFetch':!0x1,'class':_0x3db3fa[_0x315597(0x273)],'msg':_0x1c2e64[_0x315597(0x226)]}));}}),b['post'](B,_0x1bdb2d[_0x2e089a(0x271)],async(_0x5345c2,_0x9a7558)=>{const _0x4439a7=_0x2e089a,_0x1b1273={'cvWLf':function(_0x1d36e1,_0xbd6012){return _0x1d36e1(_0xbd6012);},'gloAr':function(_0x246bf3,_0x3663d8){return _0x246bf3+_0x3663d8;},'wxnoO':_0x4439a7(0x205),'kJpro':_0x4439a7(0x1af),'Yaytb':_0x4439a7(0x245),'KgsHa':function(_0x24984b,_0x4b7063){return _0x24984b<_0x4b7063;},'Ywvlo':'yellow','gRDey':_0x4439a7(0x1f3),'RgtZf':function(_0x5ad1a1,_0x126529){return _0x5ad1a1!==_0x126529;},'Hlakg':_0x4439a7(0x18e),'xrihi':_0x4439a7(0x1fd),'XQWBX':function(_0x3c7c7f,_0x592df1){return _0x3c7c7f+_0x592df1;},'nJaeZ':_0x4439a7(0x18a),'htsaG':_0x4439a7(0x125),'OMyLv':_0x4439a7(0x17c),'SChEj':'ujeNX','YhFzt':_0x4439a7(0x266)};let {sip:_0x31c982}=_0x5345c2[_0x4439a7(0x165)];if(!_0x31c982&&_0x1b1273[_0x4439a7(0x1e1)](_0x31c982[_0x4439a7(0x16a)],0x2))return _0x9a7558[_0x4439a7(0x241)](JSON[_0x4439a7(0x204)]({'isSearch':!0x1,'class':_0x1b1273['Ywvlo'],'msg':_0x1b1273[_0x4439a7(0x201)]}));_0x31c982=_0x31c982[_0x4439a7(0x17e)](/[!@#$%^&*<>]/g,'')??null;const _0x2784d3=await _0x1c42ca['getUserData'](_0x5345c2);await _0x32a230[_0x4439a7(0x1a1)](_0x5345c2,_0x9a7558,_0x2784d3[_0x4439a7(0x22a)]);const {collectionName:_0x16d162}=_0x215766[_0x4439a7(0x157)](_0x5345c2['originalUrl']),_0x110dbf=new _0x2c14fd(global[_0x4439a7(0x216)]);try{if(_0x1b1273[_0x4439a7(0x286)](_0x1b1273[_0x4439a7(0x149)],_0x1b1273[_0x4439a7(0x149)]))LXnbHC[_0x4439a7(0x28c)](_0x30f898,0x0);else{await _0x110dbf[_0x4439a7(0x25f)]();const _0x43d9c2=_0x110dbf['db'](global[_0x4439a7(0x129)])[_0x4439a7(0x1ba)](_0x16d162),_0x24d48b=[{'$or':[{'docId':{'$regex':_0x31c982,'$options':'i'}},{'docDate':{'$regex':_0x31c982,'$options':'i'}}]}];let _0x5d7b91='';['O','S'][_0x4439a7(0x1c7)](_0x2784d3[_0x4439a7(0x22a)])||(_0x5d7b91+=_0x1b1273[_0x4439a7(0x141)],_0x24d48b[_0x4439a7(0x18d)]({'userId':_0x2784d3[_0x4439a7(0x139)]}));const _0xa3d6c1=await _0x43d9c2['aggregate']([{'$match':{'$and':_0x24d48b}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x4439a7(0x1e3)]();return _0x5d7b91=_0x1b1273[_0x4439a7(0x288)](_0x4439a7(0x260)+_0xa3d6c1[_0x4439a7(0x16a)]+'\x22\x20เอกสาร',_0x5d7b91),_0x9a7558['send'](JSON[_0x4439a7(0x204)]({'searchFound':_0xa3d6c1,'msg':_0x5d7b91,'isSearch':!0x0,'class':_0x1b1273[_0x4439a7(0x23d)]}));}}catch(_0x3b8c81){return _0x1b1273['RgtZf'](_0x1b1273[_0x4439a7(0x114)],_0x1b1273[_0x4439a7(0x114)])?!![]:(console[_0x4439a7(0x21d)](_0x3b8c81),_0x9a7558[_0x4439a7(0x241)](JSON[_0x4439a7(0x204)]({'isSearch':!0x1,'class':_0x1b1273['OMyLv'],'msg':_0x3b8c81['message']})));}finally{_0x1b1273[_0x4439a7(0x286)](_0x1b1273['SChEj'],_0x1b1273[_0x4439a7(0x1d9)])?_0x110dbf[_0x4439a7(0x13c)]():function(){return![];}[_0x4439a7(0x1b9)](LXnbHC[_0x4439a7(0x175)](LXnbHC['wxnoO'],LXnbHC[_0x4439a7(0x239)]))[_0x4439a7(0x133)](LXnbHC[_0x4439a7(0x142)]);}}),b[_0x2e089a(0x26e)](x,_0x1bdb2d[_0x2e089a(0x271)],async(_0x145d99,_0x2a07a9)=>{const _0x52a98f=_0x2e089a,_0x1aa28a={'AqKRN':_0x52a98f(0x17c),'huaWA':function(_0x5453cc,_0xd3fdb1){return _0x5453cc(_0xd3fdb1);},'FwHdy':function(_0x33536d,_0x3bff0d){return _0x33536d+_0x3bff0d;},'erxYx':function(_0x7ea25,_0x2ae05e){return _0x7ea25+_0x2ae05e;},'eVpSg':'return\x20(function()\x20','TuCNZ':_0x52a98f(0x1c3),'hBzxm':function(_0x91e902){return _0x91e902();},'cqwiT':_0x52a98f(0x21d),'IGaKj':_0x52a98f(0x113),'LmCEb':_0x52a98f(0x21e),'RKcgt':_0x52a98f(0x261),'UobwX':'exception','ahgYx':_0x52a98f(0x10f),'BHZWK':'trace','tKDdR':function(_0x540911,_0x521a10){return _0x540911<_0x521a10;},'jFaNH':function(_0x186c63,_0x47674d){return _0x186c63===_0x47674d;},'Jfzyh':_0x52a98f(0x1e6),'LaaPo':_0x52a98f(0x189),'oIbIr':_0x52a98f(0x234),'ZEUiW':function(_0x16ec78,_0x2a397f){return _0x16ec78===_0x2a397f;},'tWUlF':_0x52a98f(0x171),'ALAmp':'pRnSS','kMlPn':_0x52a98f(0x1bb),'sFkCw':function(_0x5a2eed,_0x45d2e5){return _0x5a2eed===_0x45d2e5;},'Gaaiu':_0x52a98f(0x229),'EmNDt':function(_0x15a877,_0x5088c0){return _0x15a877==_0x5088c0;},'oGlEG':_0x52a98f(0x137),'MyzOk':_0x52a98f(0x170),'yLlqj':function(_0x245701,_0x5e70ba){return _0x245701==_0x5e70ba;},'yibLS':'{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','ErTaQ':function(_0x273a2f,_0x286920){return _0x273a2f==_0x286920;},'DNJcr':function(_0x1d0b04,_0x2c7f2d){return _0x1d0b04===_0x2c7f2d;},'HHNtV':_0x52a98f(0x1cd),'uMZVz':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','KhYTW':_0x52a98f(0x18a),'GxnmF':function(_0x106a76,_0x3ee5ec){return _0x106a76!==_0x3ee5ec;},'OJQRg':'HsoWY','QWOsv':_0x52a98f(0x180),'oCjUq':'wMoGH','opoQA':_0x52a98f(0x1fe)};let {docId:_0x92cc2a,action:_0x531811}=_0x145d99[_0x52a98f(0x165)];const _0x464195=await _0x1c42ca[_0x52a98f(0x1da)](_0x145d99);await _0x32a230[_0x52a98f(0x1a1)](_0x145d99,_0x2a07a9,_0x464195[_0x52a98f(0x22a)]);const {collectionName:_0x2cced4}=_0x215766[_0x52a98f(0x157)](_0x145d99[_0x52a98f(0x1f0)]),_0x1129fc=new _0x2c14fd(global[_0x52a98f(0x216)]);try{if(_0x1aa28a['jFaNH'](_0x1aa28a[_0x52a98f(0x214)],_0x1aa28a[_0x52a98f(0x150)]))_0x3d0135[_0x52a98f(0x13c)]();else{await _0x1129fc[_0x52a98f(0x25f)]();const _0x5d6688=_0x1129fc['db'](global[_0x52a98f(0x129)])[_0x52a98f(0x1ba)](_0x2cced4);if(_0x1aa28a[_0x52a98f(0x1dc)](_0x531811,_0x1aa28a[_0x52a98f(0x224)])){if(_0x1aa28a[_0x52a98f(0x1ac)](_0x1aa28a[_0x52a98f(0x19a)],_0x1aa28a[_0x52a98f(0x267)]))_0x4c15df[_0x52a98f(0x21d)](_0x42fdb3),_0x47fa1b[_0x52a98f(0x241)](_0x23f60b['stringify']({'isStatus':!0x1,'class':_0x1aa28a[_0x52a98f(0x126)],'msg':_0x4fa5cc[_0x52a98f(0x226)]}));else{const _0x3c2c18=['O','S'][_0x52a98f(0x1c7)](_0x464195['userAuthority'])?{'docId':_0x92cc2a}:{'docId':_0x92cc2a,'userId':_0x464195[_0x52a98f(0x139)]};var _0x4fa2a6=await _0x5d6688[_0x52a98f(0x15c)](_0x3c2c18,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x1aa28a[_0x52a98f(0x1ac)](_0x531811,_0x1aa28a['kMlPn']))var _0x4fa2a6=await _0x5d6688['findOne']({'userId':_0x464195['userId']},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x7061c=_0x4fa2a6?'':_0x1aa28a[_0x52a98f(0x183)](_0x531811,_0x1aa28a[_0x52a98f(0x224)])?_0x52a98f(0x1b2)+_0x92cc2a+'\x22':_0x1aa28a[_0x52a98f(0x162)];if(!_0x4fa2a6)return _0x2a07a9[_0x52a98f(0x241)](JSON[_0x52a98f(0x204)]({'isLoad':!0x1,'class':_0x1aa28a[_0x52a98f(0x126)],'msg':_0x7061c}));let _0x524273='โหลดเอกสารเลขที่\x20\x22'+_0x4fa2a6[_0x52a98f(0x16d)]+_0x52a98f(0x12b);if(_0x1aa28a[_0x52a98f(0x277)](_0x4fa2a6['docStatusNumber'],0x1)&&_0x4fa2a6['dateTimeCanEdit']){if(_0x1aa28a[_0x52a98f(0x1ac)](_0x1aa28a[_0x52a98f(0x1cb)],_0x1aa28a[_0x52a98f(0x20e)])){let _0x4207b3;try{const _0x48cbad=AHrICC['huaWA'](_0x1cb27d,AHrICC[_0x52a98f(0x246)](AHrICC[_0x52a98f(0x1a6)](AHrICC[_0x52a98f(0x14b)],AHrICC['TuCNZ']),');'));_0x4207b3=AHrICC['hBzxm'](_0x48cbad);}catch(_0x55ac9f){_0x4207b3=_0x2a6a5d;}const _0x4f3109=_0x4207b3[_0x52a98f(0x168)]=_0x4207b3[_0x52a98f(0x168)]||{},_0x1f31e0=[AHrICC[_0x52a98f(0x22c)],AHrICC['IGaKj'],AHrICC['LmCEb'],AHrICC['RKcgt'],AHrICC[_0x52a98f(0x236)],AHrICC[_0x52a98f(0x287)],AHrICC[_0x52a98f(0x15d)]];for(let _0x375af4=0x0;AHrICC[_0x52a98f(0x144)](_0x375af4,_0x1f31e0['length']);_0x375af4++){const _0x587e4b=_0x3f884e[_0x52a98f(0x1b9)][_0x52a98f(0x24e)][_0x52a98f(0x1b5)](_0x2c36d7),_0x54aa40=_0x1f31e0[_0x375af4],_0x2f3612=_0x4f3109[_0x54aa40]||_0x587e4b;_0x587e4b[_0x52a98f(0x14e)]=_0x405af2[_0x52a98f(0x1b5)](_0x49d133),_0x587e4b[_0x52a98f(0x17a)]=_0x2f3612[_0x52a98f(0x17a)][_0x52a98f(0x1b5)](_0x2f3612),_0x4f3109[_0x54aa40]=_0x587e4b;}}else{let _0x44afc6=await _0x215766['check_DocDateTime_CanEdit'](_0x4fa2a6,_0x2cced4,_0x464195[_0x52a98f(0x139)]);_0x4fa2a6['dateTimeEditRemain']=_0x44afc6[_0x52a98f(0x159)],_0x1aa28a[_0x52a98f(0x22b)](_0x44afc6[_0x52a98f(0x184)],!0x1)&&(_0x4fa2a6['docStatusNumber']=_0x44afc6[_0x52a98f(0x255)],_0x524273+=_0x1aa28a[_0x52a98f(0x1a2)]);}}else _0x4fa2a6[_0x52a98f(0x159)]='-';if((_0x1aa28a[_0x52a98f(0x12a)](_0x4fa2a6[_0x52a98f(0x255)],0x1)||_0x1aa28a['EmNDt'](_0x4fa2a6['docStatusNumber'],0x2))&&_0x4fa2a6[_0x52a98f(0x1c8)]){if(_0x1aa28a[_0x52a98f(0x108)](_0x1aa28a[_0x52a98f(0x1be)],_0x1aa28a[_0x52a98f(0x1be)])){const _0x3b7dae=await _0x215766['check_DocDateTime_CanCancel'](_0x4fa2a6,_0x2cced4,_0x464195[_0x52a98f(0x139)]);_0x4fa2a6[_0x52a98f(0x211)]=_0x3b7dae[_0x52a98f(0x211)],_0x1aa28a[_0x52a98f(0x22b)](_0x3b7dae['canCancel'],!0x1)&&(_0x524273+=_0x1aa28a[_0x52a98f(0x118)]);}else _0x138fd3[_0x52a98f(0x13c)]();}else _0x4fa2a6[_0x52a98f(0x211)]='-';const {branchName:_0x3ab8d2}=await _0x215766['getUserBranchesById'](_0x4fa2a6[_0x52a98f(0x10b)]);return _0x4fa2a6[_0x52a98f(0x166)]=_0x3ab8d2,_0x2a07a9[_0x52a98f(0x241)](JSON[_0x52a98f(0x204)]({'doc':_0x4fa2a6,'isLoad':!0x0,'class':_0x1aa28a['KhYTW'],'msg':_0x524273}));}}catch(_0x1f1afe){if(_0x1aa28a['GxnmF'](_0x1aa28a[_0x52a98f(0x23c)],_0x1aa28a[_0x52a98f(0x134)]))return console[_0x52a98f(0x21d)](_0x1f1afe),_0x2a07a9[_0x52a98f(0x241)](JSON[_0x52a98f(0x204)]({'isLoad':!0x1,'class':_0x1aa28a['AqKRN'],'msg':_0x1f1afe[_0x52a98f(0x226)]}));else{const _0x22e69d=_0xb7b263[_0x52a98f(0x133)](_0x10aa9f,arguments);return _0x19e901=null,_0x22e69d;}}finally{if(_0x1aa28a[_0x52a98f(0x210)](_0x1aa28a[_0x52a98f(0x1a9)],_0x1aa28a['opoQA']))_0x1129fc[_0x52a98f(0x13c)]();else return _0x4711e1[_0x52a98f(0x21d)](_0x39f9ae),_0x36f606[_0x52a98f(0x241)](_0x9b8441['stringify']({'isLoad':!0x1,'class':_0x1aa28a[_0x52a98f(0x126)],'msg':_0x1a0176[_0x52a98f(0x226)]}));}}),b[_0x2e089a(0x26e)](M,_0x1bdb2d[_0x2e089a(0x271)],async(_0x8eaf8,_0x3f8215)=>{const _0x2ccfc2=_0x2e089a,_0x22f844={'rsLEm':_0x2ccfc2(0x274),'IUXPa':_0x2ccfc2(0x24f),'VgAOa':function(_0x2fa5f1){return _0x2fa5f1();},'pZFxc':function(_0x2833a3,_0x3f9d5a){return _0x2833a3===_0x3f9d5a;},'ZRWtF':_0x2ccfc2(0x10e),'cVoIa':_0x2ccfc2(0x232),'uNSqb':_0x2ccfc2(0x17c),'DJjGZ':function(_0x34ab52,_0x138954){return _0x34ab52<_0x138954;},'cYwHw':_0x2ccfc2(0x26b),'OJvOZ':'ไม่พบประวัติการเปลี่ยนแปลง','gldpH':'doc_changes.ejs','EdzWa':'green','ZFvDP':function(_0xf323c,_0x2b4d7c){return _0xf323c===_0x2b4d7c;},'jlQSQ':'EpNSQ','OySyl':_0x2ccfc2(0x110),'rMVbo':_0x2ccfc2(0x1fb),'AeCBb':function(_0x55ccd2,_0x50dcfa){return _0x55ccd2===_0x50dcfa;},'VZXQN':'vtLCD'},{docId:_0x1e0984}=_0x8eaf8[_0x2ccfc2(0x165)],_0x39a61a=await _0x1c42ca[_0x2ccfc2(0x1da)](_0x8eaf8);await _0x32a230[_0x2ccfc2(0x1a1)](_0x8eaf8,_0x3f8215,_0x39a61a[_0x2ccfc2(0x22a)]);const {collectionName:_0x2b861c}=_0x215766[_0x2ccfc2(0x157)](_0x8eaf8['originalUrl']),_0x2b0fb5=new _0x2c14fd(global['dbUrl']);try{if(_0x22f844[_0x2ccfc2(0x1f7)](_0x22f844['ZRWtF'],_0x22f844['cVoIa']))return function(_0x192d29){}['constructor'](SpDSMe['rsLEm'])['apply'](SpDSMe[_0x2ccfc2(0x1d8)]);else{await _0x2b0fb5['connect']();var _0x5d7509=await _0x2b0fb5['db'](global[_0x2ccfc2(0x129)])[_0x2ccfc2(0x1ba)](_0x2b861c)[_0x2ccfc2(0x15c)]({'docId':_0x1e0984});if(!_0x5d7509)return _0x3f8215['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x22f844[_0x2ccfc2(0x1c2)],'msg':_0x2ccfc2(0x1b2)+_0x1e0984+'\x22'}));const _0x545ff6=_0x5d7509[_0x2ccfc2(0x18b)]||[];if(_0x22f844[_0x2ccfc2(0x27d)](_0x545ff6[_0x2ccfc2(0x16a)],0x1))return _0x3f8215['send'](JSON[_0x2ccfc2(0x204)]({'isPrint':!0x1,'class':_0x22f844[_0x2ccfc2(0x20d)],'msg':_0x22f844['OJvOZ']}));const _0x5c2ea6=_0x31ae24[_0x2ccfc2(0x131)](folderForms,_0x22f844['gldpH']),_0x4548b3=await _0x253d3b['renderView'](_0x5c2ea6,_0x3f8215,{'title':_0x5d7509[_0x2ccfc2(0x16d)],'time':_0x3374a5['formatDate'](new Date()),'changesHistory':_0x545ff6});_0x3f8215[_0x2ccfc2(0x241)](JSON['stringify']({'isPrint':!0x0,'class':_0x22f844['EdzWa'],'htmlPage':_0x4548b3}));}}catch(_0x5dc8b2){if(_0x22f844[_0x2ccfc2(0x284)](_0x22f844[_0x2ccfc2(0x250)],_0x22f844[_0x2ccfc2(0x24a)])){const _0x2ae82e=_0x10da18?function(){const _0x10d026=_0x2ccfc2;if(_0xf5407d){const _0x6ca6fd=_0x36eaaf[_0x10d026(0x133)](_0x3878f3,arguments);return _0xca92d=null,_0x6ca6fd;}}:function(){};return _0x4ac7e5=![],_0x2ae82e;}else console[_0x2ccfc2(0x21d)](_0x22f844[_0x2ccfc2(0x11a)],_0x5dc8b2),_0x3f8215[_0x2ccfc2(0x241)](JSON[_0x2ccfc2(0x204)]({'isPrint':!0x1,'class':_0x22f844[_0x2ccfc2(0x1c2)],'msg':_0x5dc8b2[_0x2ccfc2(0x226)]}));}finally{_0x22f844[_0x2ccfc2(0x135)](_0x22f844[_0x2ccfc2(0x13e)],_0x22f844[_0x2ccfc2(0x13e)])?_0x2b0fb5[_0x2ccfc2(0x13c)]():SpDSMe['VgAOa'](_0x885aac);}}),b[_0x2e089a(0x26e)](v,_0x1bdb2d[_0x2e089a(0x271)],async(_0x52f9e9,_0x11ed26)=>{const _0x11ffaf=_0x2e089a,_0x10a971={'aOobN':function(_0x517d03,_0x13d690){return _0x517d03!==_0x13d690;},'Etegf':_0x11ffaf(0x212),'aizjh':'adCxh','BJplC':_0x11ffaf(0x20a),'LDZKA':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','MRtwH':function(_0x5536db,_0x21d76c){return _0x5536db(_0x21d76c);},'vFTvK':'init','vRpjw':function(_0x3c3a23,_0x3fe4c6){return _0x3c3a23+_0x3fe4c6;},'mvIdi':_0x11ffaf(0x1ca),'gLDEe':'input','SvkVP':function(_0x27fa87,_0x5a89cb){return _0x27fa87(_0x5a89cb);},'Rwlig':function(_0x54d16b){return _0x54d16b();},'ySHRR':function(_0x83f69a,_0x19c9f8,_0x5a64d2){return _0x83f69a(_0x19c9f8,_0x5a64d2);},'Bqkjy':function(_0x23b58b,_0x172240){return _0x23b58b!==_0x172240;},'Ptbiy':_0x11ffaf(0x282),'jkfCT':'red','KGHiB':_0x11ffaf(0x247),'FtbFW':function(_0x1f081f,_0x2cf0b4){return _0x1f081f==_0x2cf0b4;},'mjTVC':'print','bYyvC':_0x11ffaf(0x18a),'lQzuK':_0x11ffaf(0x177),'uDtAn':function(_0x3bd009,_0x1cf09a){return _0x3bd009===_0x1cf09a;},'VayjP':_0x11ffaf(0x140),'UVykT':_0x11ffaf(0x272),'XIeQU':'networkidle0','NQxHy':function(_0x5bef9f,_0x545d14){return _0x5bef9f*_0x545d14;},'Xstqp':function(_0xdb3816,_0x9db3cd){return _0xdb3816/_0x9db3cd;},'LJiZL':_0x11ffaf(0x19e),'IlqkK':_0x11ffaf(0x17b),'XqFSe':function(_0x3967c5,_0x11973b){return _0x3967c5===_0x11973b;},'aZsUu':_0x11ffaf(0x1d6),'Nhcno':'error\x20===>\x20','yrQbg':function(_0x3d7ec8,_0x145c03){return _0x3d7ec8!==_0x145c03;},'IOQNK':_0x11ffaf(0x235)},{docId:_0x6a3070,action:_0x5e23f2}=_0x52f9e9[_0x11ffaf(0x165)],_0x4cd5da=await _0x1c42ca[_0x11ffaf(0x1da)](_0x52f9e9);await _0x32a230[_0x11ffaf(0x1a1)](_0x52f9e9,_0x11ed26,_0x4cd5da[_0x11ffaf(0x22a)]);const {collectionName:_0x328850,docTitle:_0x509d80}=_0x215766['get_Info_ByUrl'](_0x52f9e9[_0x11ffaf(0x1f0)]),_0xe2f324=new _0x2c14fd(global[_0x11ffaf(0x216)]);try{if(_0x10a971[_0x11ffaf(0x283)](_0x10a971[_0x11ffaf(0x11b)],_0x10a971[_0x11ffaf(0x11b)])){const _0x42edbd=_0x2d229f[_0x11ffaf(0x165)],_0x3f58a5=_0x4ef0cf['documentElement'];return _0x282a91['max'](_0x42edbd['scrollHeight'],_0x42edbd[_0x11ffaf(0x172)],_0x3f58a5[_0x11ffaf(0x145)],_0x3f58a5[_0x11ffaf(0x1f8)],_0x3f58a5[_0x11ffaf(0x172)]);}else{await _0xe2f324[_0x11ffaf(0x25f)]();var _0x34f741=await _0xe2f324['db'](global[_0x11ffaf(0x129)])[_0x11ffaf(0x1ba)](_0x328850)[_0x11ffaf(0x15c)]({'docId':_0x6a3070});if(!_0x34f741)return _0x11ed26[_0x11ffaf(0x241)](JSON['stringify']({'isLoad':!0x1,'class':_0x10a971[_0x11ffaf(0x1b6)],'msg':_0x11ffaf(0x1b2)+_0x6a3070+'\x22'}));_0x34f741[_0x11ffaf(0x222)]=_0x509d80,_0x34f741[_0x11ffaf(0x1ef)]=_0x215766['get_StatusName_byStatusNumber'](_0x34f741[_0x11ffaf(0x255)]);const _0x4c3555=_0x215766[_0x11ffaf(0x112)](_0x34f741),_0x24843f=_0x31ae24[_0x11ffaf(0x131)](folderForms,_0x10a971['KGHiB']),_0x4804fc=await _0x253d3b[_0x11ffaf(0x1f6)](_0x24843f,_0x11ed26,{'title':_0x6a3070,'time':_0x3374a5['formatDate'](new Date()),'action':_0x5e23f2,'doc':_0x4c3555});if(_0x10a971[_0x11ffaf(0x233)](_0x5e23f2,_0x10a971[_0x11ffaf(0x136)]))_0x11ed26['send'](JSON[_0x11ffaf(0x204)]({'isPrint':!0x0,'class':_0x10a971[_0x11ffaf(0x122)],'htmlPage':_0x4804fc}));else{if(_0x10a971['FtbFW'](_0x5e23f2,_0x10a971[_0x11ffaf(0x1b8)])){if(_0x10a971[_0x11ffaf(0x21c)](_0x10a971[_0x11ffaf(0x13a)],_0x10a971['VayjP'])){const _0x11e39d=await(await import(_0x10a971[_0x11ffaf(0x1ed)]))[_0x11ffaf(0x16e)](),_0x1b15e5=await _0x11e39d[_0x11ffaf(0x1fa)]();await _0x1b15e5[_0x11ffaf(0x152)](_0x4804fc,{'waitUntil':_0x10a971[_0x11ffaf(0x256)],'timeout':0x2710}),await new Promise(_0x3f4f8b=>setTimeout(_0x3f4f8b,0x3e8));const _0x19adb2=Math['floor'](_0x10a971[_0x11ffaf(0x158)](_0x10a971['Xstqp'](0x50,25.4),0x60));await _0x1b15e5[_0x11ffaf(0x1e0)]({'width':_0x19adb2,'height':0x258,'deviceScaleFactor':0x1});const _0x18f8b7=await _0x1b15e5[_0x11ffaf(0x115)](()=>{const _0x39ef79=_0x11ffaf;if(_0x10a971[_0x39ef79(0x11f)](_0x10a971[_0x39ef79(0x12e)],_0x10a971['aizjh'])){const _0x27d559=document[_0x39ef79(0x165)],_0x4d392a=document[_0x39ef79(0x1a0)];return Math[_0x39ef79(0x196)](_0x27d559[_0x39ef79(0x1f8)],_0x27d559[_0x39ef79(0x172)],_0x4d392a[_0x39ef79(0x145)],_0x4d392a[_0x39ef79(0x1f8)],_0x4d392a['offsetHeight']);}else{if(_0x1e7123){const _0x8ff93c=_0x15737b[_0x39ef79(0x133)](_0x344b97,arguments);return _0x4c9d44=null,_0x8ff93c;}}}),_0x3de5c8=await _0x1b15e5[_0x11ffaf(0x163)]({'type':_0x10a971[_0x11ffaf(0x18f)],'clip':{'x':0x0,'y':0x0,'width':_0x19adb2,'height':_0x18f8b7},'omitBackground':!0x1});await _0x11e39d['close']();const _0x5f1043=_0x34f741['docId']['replace'](/\//g,'');_0x11ed26['writeHead'](0xc8,{'Content-Type':_0x10a971['IlqkK'],'Content-Disposition':_0x11ffaf(0x1d5)+_0x5f1043+_0x11ffaf(0x219),'Content-Length':_0x3de5c8[_0x11ffaf(0x16a)]}),_0x11ed26[_0x11ffaf(0x220)](_0x3de5c8);}else{const _0x552a10=_0x57f7ab[_0x11ffaf(0x133)](_0x1ce92d,arguments);return _0x2f82cf=null,_0x552a10;}}}}}catch(_0x59694a){if(_0x10a971[_0x11ffaf(0x1ee)](_0x10a971[_0x11ffaf(0x25b)],_0x10a971[_0x11ffaf(0x25b)]))console[_0x11ffaf(0x21d)](_0x10a971[_0x11ffaf(0x265)],_0x59694a),_0x11ed26['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x10a971[_0x11ffaf(0x1b6)],'msg':_0x59694a[_0x11ffaf(0x226)]}));else{const _0x2937e8={'uKeHV':uhfuaq[_0x11ffaf(0x15b)],'TZTho':uhfuaq[_0x11ffaf(0x1e9)],'gKPTT':function(_0xc40938,_0x34f55a){const _0x435e43=_0x11ffaf;return uhfuaq[_0x435e43(0x1c6)](_0xc40938,_0x34f55a);},'guhcu':uhfuaq[_0x11ffaf(0x1db)],'IcFtR':function(_0x32598b,_0x1ebc4d){return uhfuaq['vRpjw'](_0x32598b,_0x1ebc4d);},'GMgeX':uhfuaq[_0x11ffaf(0x27c)],'eIQYG':uhfuaq[_0x11ffaf(0x217)],'bgtih':function(_0x4584e8,_0x2d8b20){const _0x1af551=_0x11ffaf;return uhfuaq[_0x1af551(0x1d3)](_0x4584e8,_0x2d8b20);},'mjzwz':function(_0x5a4765){return uhfuaq['Rwlig'](_0x5a4765);}};uhfuaq[_0x11ffaf(0x230)](_0x392421,this,function(){const _0x34e86a=_0x11ffaf,_0x2044ef=new _0x50390e(_0x2937e8['uKeHV']),_0xdfda0b=new _0x44cca6(_0x2937e8[_0x34e86a(0x199)],'i'),_0x3b33a7=_0x2937e8[_0x34e86a(0x1bf)](_0x308cec,_0x2937e8[_0x34e86a(0x148)]);!_0x2044ef[_0x34e86a(0x25e)](_0x2937e8[_0x34e86a(0x231)](_0x3b33a7,_0x2937e8['GMgeX']))||!_0xdfda0b['test'](_0x2937e8[_0x34e86a(0x231)](_0x3b33a7,_0x2937e8[_0x34e86a(0x20c)]))?_0x2937e8[_0x34e86a(0x1d1)](_0x3b33a7,'0'):_0x2937e8[_0x34e86a(0x154)](_0x4f4bcd);})();}}finally{_0x10a971[_0x11ffaf(0x215)](_0x10a971[_0x11ffaf(0x27f)],_0x10a971[_0x11ffaf(0x27f)])?_0x210833[_0x11ffaf(0x13c)]():_0xe2f324[_0x11ffaf(0x13c)]();}}),b['post'](k,_0x1bdb2d[_0x2e089a(0x271)],async(_0x80e520,_0x17ab1d)=>{const _0x153c87=_0x2e089a,_0x591477={'lBjkw':_0x153c87(0x17c),'LskYz':function(_0x4cd263,_0xaddec5){return _0x4cd263==_0xaddec5;},'DATvx':_0x153c87(0x1c5),'GHvcI':_0x153c87(0x109),'kImOJ':function(_0x167546,_0xd543ab){return _0x167546==_0xd543ab;},'TZOuE':'finish','KmwJE':_0x153c87(0x1cc),'QzmWe':function(_0x5d51be,_0x7095e7){return _0x5d51be===_0x7095e7;},'YnxTr':_0x153c87(0x249),'JNstG':_0x153c87(0x1a7),'ytOqw':function(_0x54ab5e,_0x1b3917){return _0x54ab5e===_0x1b3917;},'WAlau':_0x153c87(0x258),'tSqwe':'DdzSv','IZuZm':function(_0x4cba1f,_0x1b9ce2){return _0x4cba1f==_0x1b9ce2;},'XGNGT':function(_0x184051,_0x27790d){return _0x184051==_0x27790d;},'VydrT':function(_0x40580a,_0x57dfa9){return _0x40580a==_0x57dfa9;},'VzzQy':function(_0x4d7c9d,_0x59c2c6){return _0x4d7c9d==_0x59c2c6;},'KLTsL':function(_0x2a51a6,_0x27c9b8){return _0x2a51a6>_0x27c9b8;},'lCzRV':function(_0x31d074,_0x47670a){return _0x31d074===_0x47670a;},'VPVVt':_0x153c87(0x269),'qmjkV':function(_0x11f8ef,_0x5b70b0){return _0x11f8ef>_0x5b70b0;},'wKhUz':function(_0x25ae1a,_0x468286){return _0x25ae1a!==_0x468286;},'nqyGe':_0x153c87(0x218),'cmlvE':_0x153c87(0x285),'fSOiw':_0x153c87(0x18a),'QYCEc':function(_0x493db2,_0x230e4e){return _0x493db2<_0x230e4e;},'NwNIE':_0x153c87(0x26b)},_0x275599=new _0x2c14fd(global[_0x153c87(0x216)]);try{const _0x31ff44=await _0x1c42ca['getUserData'](_0x80e520);await _0x32a230[_0x153c87(0x1a1)](_0x80e520,_0x17ab1d,_0x31ff44[_0x153c87(0x22a)]);const {collectionName:_0xb5d071}=_0x215766[_0x153c87(0x157)](_0x80e520[_0x153c87(0x1f0)]),{docId:_0x5c5352,action:_0x42da33}=_0x80e520['body'],_0x20a3da=_0x591477[_0x153c87(0x155)](_0x42da33,_0x591477[_0x153c87(0x123)])?_0x591477[_0x153c87(0x178)]:_0x591477[_0x153c87(0x151)](_0x42da33,_0x591477[_0x153c87(0x28a)])?'จบ':'';if(!_0x5c5352||![_0x591477['TZOuE'],_0x591477['DATvx']][_0x153c87(0x1c7)](_0x42da33))return _0x17ab1d[_0x153c87(0x241)](JSON[_0x153c87(0x204)]({'isStatus':!0x1,'class':_0x591477['lBjkw'],'msg':_0x591477[_0x153c87(0x22d)]}));const _0x12cce7={'docId':_0x5c5352,'userId':_0x31ff44[_0x153c87(0x139)]},_0x3253f3=_0x275599['db'](global[_0x153c87(0x129)])[_0x153c87(0x1ba)](_0xb5d071),_0x49e44c=await _0x3253f3[_0x153c87(0x15c)](_0x12cce7);if(!_0x49e44c)return _0x17ab1d[_0x153c87(0x241)](JSON[_0x153c87(0x204)]({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x5c5352+_0x153c87(0x19d)+_0x20a3da+_0x153c87(0x19f)}));const _0x430dd2=_0x49e44c[_0x153c87(0x255)];if(_0x591477['QzmWe'](_0x42da33,_0x591477['DATvx'])&&!(_0x591477['LskYz'](_0x430dd2,0x1)||_0x591477[_0x153c87(0x151)](_0x430dd2,0x2)))return _0x17ab1d[_0x153c87(0x241)](JSON[_0x153c87(0x204)]({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':_0x591477[_0x153c87(0x173)]}));if(_0x591477[_0x153c87(0x1a4)](_0x42da33,_0x591477[_0x153c87(0x28a)])&&_0x591477[_0x153c87(0x155)](!_0x430dd2,0x1))return _0x17ab1d[_0x153c87(0x241)](JSON[_0x153c87(0x204)]({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':_0x591477[_0x153c87(0x1bc)]}));if(_0x591477[_0x153c87(0x155)](_0x42da33,_0x591477['DATvx'])){if(_0x591477[_0x153c87(0x225)](_0x591477[_0x153c87(0x1f9)],_0x591477[_0x153c87(0x1a3)]))return _0x3ce9d6[_0x153c87(0x21d)](_0x200279),_0x482b14[_0x153c87(0x241)](_0x3ec2e4['stringify']({'isSearch':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':_0x46c672[_0x153c87(0x226)]}));else{if(_0x591477[_0x153c87(0x23a)](_0x49e44c['canCancel'],!0x1))return _0x17ab1d[_0x153c87(0x241)](JSON['stringify']({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':_0x153c87(0x279)+_0x5c5352+_0x153c87(0x22f)}));if(_0x591477[_0x153c87(0x153)]((await _0x215766['check_DocDateTime_CanCancel'](_0x49e44c,_0xb5d071,_0x31ff44[_0x153c87(0x139)]))[_0x153c87(0x1ab)],!0x1))return _0x17ab1d[_0x153c87(0x241)](JSON['stringify']({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':'เอกสาร\x20\x22'+_0x5c5352+_0x153c87(0x22f)}));}}if(_0x591477[_0x153c87(0x132)](_0x42da33,_0x591477[_0x153c87(0x123)]))var _0x109a15=0xa;else{if(_0x591477[_0x153c87(0x1b0)](_0x42da33,_0x591477[_0x153c87(0x28a)]))var _0x109a15=0x2;}const _0x48dbac=await _0x3253f3['updateOne'](_0x12cce7,{'$set':{'docStatusNumber':_0x109a15}});var _0x4e1d16=_0x20a3da+'\x20\x22'+_0x5c5352+_0x153c87(0x253);if(_0x48dbac[_0x153c87(0x276)]||_0x591477[_0x153c87(0x1ae)](_0x48dbac['modifiedCount'],0x0)){if(_0x591477['lCzRV'](_0x591477[_0x153c87(0x10d)],_0x591477[_0x153c87(0x10d)])){const _0x44ef35=_0x215766[_0x153c87(0x185)]({'docStatusNumber':_0x430dd2},{'docStatusNumber':_0x109a15});if(_0x591477['qmjkV'](_0x44ef35['length'],0x0)){if(_0x591477[_0x153c87(0x116)](_0x591477[_0x153c87(0x1f5)],_0x591477[_0x153c87(0x1f5)]))_0x46b302=_0x5e3630;else{const _0x3dd5d1={'dateTime':_0x3374a5[_0x153c87(0x121)](new Date()),'userId':_0x31ff44[_0x153c87(0x139)],'userFullname':_0x31ff44['userFullname'],'changes':_0x44ef35};await _0x3253f3[_0x153c87(0x26a)]({'docId':_0x5c5352},{'$push':{'changesHistory':{'$each':[_0x3dd5d1],'$position':0x0}}}),_0x4e1d16+=_0x591477['cmlvE'];}}return _0x17ab1d['send'](JSON[_0x153c87(0x204)]({'isStatus':!0x0,'docId':_0x5c5352,'docStatusNumber':_0x109a15,'class':_0x591477[_0x153c87(0x28d)],'msg':_0x4e1d16}));}else _0x5a6ce0[_0x153c87(0x13c)]();}else{if(_0x48dbac['matchedCount']&&_0x591477[_0x153c87(0x21a)](_0x48dbac['modifiedCount'],0x1))return _0x17ab1d[_0x153c87(0x241)](JSON[_0x153c87(0x204)]({'isStatus':!0x1,'docId':_0x5c5352,'docStatusNumber':_0x430dd2,'class':_0x591477[_0x153c87(0x1ad)],'msg':'\x22'+_0x5c5352+_0x153c87(0x197)}));}}catch(_0x5da058){console[_0x153c87(0x21d)](_0x5da058),_0x17ab1d[_0x153c87(0x241)](JSON['stringify']({'isStatus':!0x1,'class':_0x591477[_0x153c87(0x1ff)],'msg':_0x5da058[_0x153c87(0x226)]}));}finally{_0x275599['close']();}});export default b;function _0xc6cb0f(_0x49c9fe){const _0x33ad8a=_0x2e089a,_0x3cb062={'wAcrd':function(_0x493b85,_0x2d0830){return _0x493b85===_0x2d0830;},'ewXkQ':_0x33ad8a(0x264),'YFDqT':_0x33ad8a(0x274),'sJSbB':_0x33ad8a(0x24f),'JNQhm':function(_0x401196,_0x30c6a6){return _0x401196!==_0x30c6a6;},'RTYCD':function(_0x3996ec,_0x37e9d5){return _0x3996ec+_0x37e9d5;},'VIutd':function(_0x1d5750,_0xf67679){return _0x1d5750/_0xf67679;},'tOZNk':_0x33ad8a(0x16a),'pCQje':function(_0x23a4a1,_0x590bd0){return _0x23a4a1%_0x590bd0;},'DWbTq':'debu','elZyC':'gger','FKsGZ':_0x33ad8a(0x23f),'otgQR':function(_0x42f062,_0x59552a){return _0x42f062+_0x59552a;},'bCioc':'stateObject','djApz':function(_0x1bcf02,_0x800860){return _0x1bcf02(_0x800860);}};function _0x4752db(_0x10ed9d){const _0x24e749=_0x33ad8a;if(_0x3cb062['wAcrd'](typeof _0x10ed9d,_0x3cb062[_0x24e749(0x176)]))return function(_0x58b9c3){}['constructor'](_0x3cb062[_0x24e749(0x16f)])[_0x24e749(0x133)](_0x3cb062[_0x24e749(0x117)]);else _0x3cb062[_0x24e749(0x24b)](_0x3cb062['RTYCD']('',_0x3cb062[_0x24e749(0x200)](_0x10ed9d,_0x10ed9d))[_0x3cb062[_0x24e749(0x263)]],0x1)||_0x3cb062['wAcrd'](_0x3cb062[_0x24e749(0x127)](_0x10ed9d,0x14),0x0)?function(){return!![];}[_0x24e749(0x1b9)](_0x3cb062[_0x24e749(0x16b)](_0x3cb062[_0x24e749(0x14c)],_0x3cb062[_0x24e749(0x206)]))['call'](_0x3cb062[_0x24e749(0x244)]):function(){return![];}['constructor'](_0x3cb062[_0x24e749(0x1c1)](_0x3cb062[_0x24e749(0x14c)],_0x3cb062[_0x24e749(0x206)]))[_0x24e749(0x133)](_0x3cb062['bCioc']);_0x3cb062[_0x24e749(0x1cf)](_0x4752db,++_0x10ed9d);}try{if(_0x49c9fe)return _0x4752db;else _0x3cb062[_0x33ad8a(0x1cf)](_0x4752db,0x0);}catch(_0x26a9fb){}}