const _0x8098dc=_0x1599;function _0x2bbb(){const _0x5474a7=['body','BXyCJ','WjLfN','nPTUd','xPEXg','OQDar','\x20ไม่เปลี่ยนแปลง\x22','yToik','VtPXA','floor','check_DocDateTime_CanEdit','NSQvb','finish','gpExo','NJBhb','bind','mUyZa','VGAYL','cancel','diliK','7401810zXAgHw','MoVwp','xEekj','HFNvK','oIMeg','RomPt','ntEzt','zOegr','{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','DOC_TYPE','error','qPmWt','isAuth','JlGNv','apply','stock','CpXzG','eeSte','GIEzX','ezHCQ','LYvmI','yifFl','writeHead','exception','stvXX','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','pCIXB','qIjwt','OJlXi','wPnQF','/load','Hmlyb','/print','wcQax','ZrBqV','uiNDj','kXPeX','qtviU','NCEvi','newPage','fOGBi','IiHWU','EDDxX','ไม่พบเอกสารเลขที่\x20\x22','1314501XkBIdc','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','efpRF','2241800aHeYuj','post','screenshot','docId','LURGE','2918496GPofRz','green','AzWhr','PHMaK','SFQvb','kEhLT','xRvCx','BdnEc','aXGII','hrjXu','IcDHl','getUserBranchesById','JEhmh','GKuvt','BzUgH','fHzjN','ETpyQ','EcKzX','XuWco','counter','function\x20*\x5c(\x20*\x5c)','RldBC','kIQxJ','OcdGF','{{sep}}หรือไม่มีสิทธิ์','uHmya','tSsLh','fDMBw','VhHgR','OKDnk','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','EyURS','PEStl','GVjKO','GGeFG','WJKMh','wNEtL','connect','{}.constructor(\x22return\x20this\x22)(\x20)','TxUil','GkZbo','FgQKv','length','Pbuiu','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','FCgdU','WYkiI','constructor','wlGlW','evaluate','qImDY','dbName','ctCGz','collection','2EsBWoI','debu','join','ndZHm','userId','renderView','get_StatusName_byStatusNumber','izKdj','pKbaw','ephbX','cjOdH','suADR','wrXrG','test','warehouseOut','hSQev','convert_DocPrint','mpDUp','TPQFD','fxzfA','tUqLN','XPtDW','PmtMe','RcOJL','matchedCount','input','KZRJe','scrollHeight','docStatusNumber','call','VAmaw','DHAtZ','เอกสารที่ตันเองไม่ได้สร้าง','17072559fiFySj','gTCmt','ouLqX','YhkUM','/search','prototype','mCJlk','.jpeg','EufRA','Uhhgc','toArray','AXNvn','includes','ohuJv','maTNr','OFtaT','GnSjF','__proto__','pRIlQ','iKImN','DGLbZ','EeUSo','Mlbsz','print','EvOkh','fxbbB','KxMsa','AnEGi','active','gzMBd','userAuthority','PQnEh','zGuCv','PwkHv','PATH_WAREHOUSE_OUT','max','sbuJk','error\x20===>\x20','getMainDocPathObj','AltMC','getChangeHistory','IeSDQ','XRild','cmget','LBmth','jhywf','get_Info_ByUrl','NCjWi','dcWTe','KfvdU','SdAmt','OUXhl','bFVdx','getUserData','YWICo','FQlcJ','lGvjz','yEjrV','RdsCV','cdeSb','message','findOne','dfRzz','eJgdJ','dCZma','chain','jhsur','SzSyO','info','red','ZPBUD','HDXoY','VUQEv','while\x20(true)\x20{}','OvnAj','iGQEf','init','canCancel','โหลดเอกสารเลขที่\x20\x22','lByUc','uzaeE','end','mVpFX','35JgEOKO','yrGaH','trace','WhMwI','CEzwP','WpIws','PHzZo','ไม่พบเอกสาร\x20\x22','branchName','JOZIw','setContent','YjVQo','mhSdY','action','GpQbS','offsetHeight','RnCzi','load-last','OsofL','return\x20(function()\x20','gger','warn','yellow','/fetch/modal','send','getItems_for_Modal','mnIBJ','AOJoR','/changes','vkQVU','MLMeq','CaErS','WmiIe','DCHUD','wKEuj','console','dateTimeEditRemain','Router','MEbRq','QpIOD','wICOE','dateTimeCanEdit','xQNdf','kYrgS','erxKQ','SfTaX','launch','QiWTU','เอกสาร\x20\x22','image/jpeg','3626814YMTfoU','load','GOFdY','BiJpq','QgQKw','jrdWf','oZVtE','aggregate','yDPhb','clientHeight','xiPZh','doc_print.ejs','KSeZT','sSMJO','VZJoS','close','dbUrl','formatDateTime','attachment;\x20filename=','903290ZcYEir','uHjTk','PATH_WAREHOUSE_IN','BfUpW','nsniO','canEdit','NbTwY','aMkJa','originalUrl','YpkGd','image','FbSSU','pumgV','string','gCbdb','VQamm','VPOYY','replace','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','UpnoP','ayNKR','formatDate','toString','qluiq','JnAJj','IQCab','XsWRa','qSvif','HjZXb','userFullname','qNbmd','BRRKu','AvJSV','lBokX','log','PcGZO','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','VLqas','UKXdy','hbGWa','stateObject','FEJjv','OJdIP','stringify','iVxWT','QeyJt','EAKxT','vvXUZ','puppeteer','/load-last','YqNHF','{{sep}}[บันทึกการแก้ไข]','warehouseIn','check_DocDateTime_CanCancel','VIfmK','JMTWk','table','xkHOi','difzI','qtDpW','ZuyWH','lcrRh','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','JQBga','uLxUh','CksqV','BvfTZ','CBGGC','dateTimeCancelRemain','rvIWQ','IGjpC','oPPMm','TfMDf','push','/status','\x22\x20{{sep}}เรียบร้อยแล้ว','ไม่พบประวัติการเปลี่ยนแปลง','AOaPN','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','get'];_0x2bbb=function(){return _0x5474a7;};return _0x2bbb();}(function(_0x2a77e3,_0xf28835){const _0x335af3=_0x1599,_0x43cef3=_0x2a77e3();while(!![]){try{const _0x10a2f0=parseInt(_0x335af3(0x20f))/0x1*(parseInt(_0x335af3(0x24d))/0x2)+parseInt(_0x335af3(0x16c))/0x3+-parseInt(_0x335af3(0x217))/0x4+-parseInt(_0x335af3(0x17f))/0x5+-parseInt(_0x335af3(0x1e3))/0x6+-parseInt(_0x335af3(0x13a))/0x7*(parseInt(_0x335af3(0x212))/0x8)+parseInt(_0x335af3(0x26e))/0x9;if(_0x10a2f0===_0xf28835)break;else _0x43cef3['push'](_0x43cef3['shift']());}catch(_0x431d34){_0x43cef3['push'](_0x43cef3['shift']());}}}(_0x2bbb,0xd5b54));const _0x5258d5=(function(){const _0x286623=_0x1599,_0x479dd0={'kEhLT':_0x286623(0x12c),'mhSdY':function(_0x3bc92e,_0x302baf){return _0x3bc92e===_0x302baf;},'qhpcw':_0x286623(0x11e),'VLqas':_0x286623(0x1bf),'hSQev':function(_0x267b42,_0x1d9166){return _0x267b42===_0x1d9166;},'Mlbsz':_0x286623(0x13d),'vNTGq':function(_0x813c28,_0x1d68f2){return _0x813c28(_0x1d68f2);},'LXORf':function(_0x707058,_0x79c71e){return _0x707058+_0x79c71e;},'GGeFG':function(_0x129a62,_0x265482){return _0x129a62+_0x265482;},'oEBCV':'return\x20(function()\x20','nsniO':_0x286623(0x23d),'SdAmt':function(_0x5dad8b){return _0x5dad8b();},'zGuCv':_0x286623(0x293),'yEjrV':function(_0xe2e057,_0x195e6d){return _0xe2e057!==_0x195e6d;},'GnSjF':_0x286623(0x178)};let _0x460b8e=!![];return function(_0xd3c146,_0x368d7c){const _0xb2d212=_0x286623,_0x56420={'EKFzi':function(_0x23233c,_0x34f8e1){return _0x479dd0['vNTGq'](_0x23233c,_0x34f8e1);},'xQNdf':function(_0x328ef3,_0x293ff4){return _0x479dd0['LXORf'](_0x328ef3,_0x293ff4);},'WJKMh':function(_0x624d69,_0x3a3560){const _0x160344=_0x1599;return _0x479dd0[_0x160344(0x239)](_0x624d69,_0x3a3560);},'NCEvi':_0x479dd0['oEBCV'],'jRPvd':_0x479dd0[_0xb2d212(0x183)],'bgpGq':function(_0x590422){const _0x28f92e=_0xb2d212;return _0x479dd0[_0x28f92e(0x119)](_0x590422);},'RcOJL':_0x479dd0[_0xb2d212(0x28e)],'wMbGg':_0x479dd0[_0xb2d212(0x21c)]};if(_0x479dd0[_0xb2d212(0x120)](_0x479dd0['GnSjF'],_0x479dd0[_0xb2d212(0x27e)])){const _0x6c0a4a=_0x56420['EKFzi'](_0xedd3ee,_0x56420[_0xb2d212(0x164)](_0x56420[_0xb2d212(0x23a)](_0x56420[_0xb2d212(0x209)],_0x56420['jRPvd']),');'));_0x367ad7=_0x56420['bgpGq'](_0x6c0a4a);}else{const _0x19df08=_0x460b8e?function(){const _0x3fe818=_0xb2d212,_0x3b4959={'GkZbo':_0x479dd0[_0x3fe818(0x21c)]};if(_0x479dd0[_0x3fe818(0x146)](_0x479dd0['qhpcw'],_0x479dd0[_0x3fe818(0x1a4)]))_0xed1f23[_0x3fe818(0x1a1)](_0x56420[_0x3fe818(0x264)],_0x158691),_0x18d8c8[_0x3fe818(0x152)](_0x13ae36['stringify']({'isPrint':!0x1,'class':_0x56420['wMbGg'],'msg':_0x21f018[_0x3fe818(0x123)]}));else{if(_0x368d7c){if(_0x479dd0[_0x3fe818(0x25c)](_0x479dd0['Mlbsz'],_0x479dd0[_0x3fe818(0x284)])){const _0x5174bb=_0x368d7c[_0x3fe818(0x1f1)](_0xd3c146,arguments);return _0x368d7c=null,_0x5174bb;}else return _0x8167c6[_0x3fe818(0x1a1)](_0x827029),_0x4eac86[_0x3fe818(0x152)](_0x53df4c[_0x3fe818(0x1aa)]({'isSearch':!0x1,'class':_0x3b4959[_0x3fe818(0x23f)],'msg':_0x102b7e['message']}));}}}:function(){};return _0x460b8e=![],_0x19df08;}};}());(function(){const _0x2a4be5=_0x1599,_0x3e4780={'JOZIw':_0x2a4be5(0x293),'fxbbB':_0x2a4be5(0x12c),'qPmWt':function(_0x38445c,_0xf5000b){return _0x38445c(_0xf5000b);},'TxUil':function(_0x170083,_0x399156){return _0x170083===_0x399156;},'OUXhl':'NTuMr','qluiq':_0x2a4be5(0x22b),'vkQVU':_0x2a4be5(0x243),'RomPt':_0x2a4be5(0x133),'YqNHF':function(_0x2fead1,_0x1ef2c7){return _0x2fead1+_0x1ef2c7;},'UpnoP':'chain','CEzwP':_0x2a4be5(0x266),'IGjpC':function(_0x5837fa,_0x13153e){return _0x5837fa===_0x13153e;},'mVpFX':_0x2a4be5(0x234),'KfvdU':function(_0x4e8401,_0x7a5d07){return _0x4e8401!==_0x7a5d07;},'MLMeq':_0x2a4be5(0x1f3),'tUqLN':function(_0x320fd8){return _0x320fd8();},'qIjwt':function(_0x25f882,_0x34a3cf,_0x669c03){return _0x25f882(_0x34a3cf,_0x669c03);}};_0x3e4780[_0x2a4be5(0x1fe)](_0x5258d5,this,function(){const _0x1ea334=_0x2a4be5,_0x3ed7c4={'EufRA':_0x3e4780[_0x1ea334(0x143)],'pCIXB':_0x3e4780[_0x1ea334(0x287)],'LBmth':function(_0x5f3dc0,_0x302281){const _0x7ad8cd=_0x1ea334;return _0x3e4780[_0x7ad8cd(0x1ee)](_0x5f3dc0,_0x302281);}};if(_0x3e4780[_0x1ea334(0x23e)](_0x3e4780[_0x1ea334(0x11a)],_0x3e4780[_0x1ea334(0x11a)])){const _0x243b15=new RegExp(_0x3e4780[_0x1ea334(0x196)]),_0xedcf64=new RegExp(_0x3e4780[_0x1ea334(0x157)],'i'),_0x412f1d=_0x3e4780[_0x1ea334(0x1ee)](_0x5d69ec,_0x3e4780[_0x1ea334(0x1e8)]);if(!_0x243b15[_0x1ea334(0x25a)](_0x3e4780[_0x1ea334(0x1b1)](_0x412f1d,_0x3e4780[_0x1ea334(0x192)]))||!_0xedcf64[_0x1ea334(0x25a)](_0x3e4780['YqNHF'](_0x412f1d,_0x3e4780[_0x1ea334(0x13e)]))){if(_0x3e4780[_0x1ea334(0x1c5)](_0x3e4780[_0x1ea334(0x139)],_0x3e4780['mVpFX']))_0x3e4780[_0x1ea334(0x1ee)](_0x412f1d,'0');else{if(_0x529366){const _0x5daee4=_0x3c4bb0[_0x1ea334(0x1f1)](_0x13e637,arguments);return _0x38af14=null,_0x5daee4;}}}else _0x3e4780[_0x1ea334(0x118)](_0x3e4780[_0x1ea334(0x158)],_0x3e4780[_0x1ea334(0x158)])?(_0x285279['log'](_0x3ed7c4[_0x1ea334(0x276)],_0x1c536e),_0x42aea9[_0x1ea334(0x152)](_0x33ece6['stringify']({'isPrint':!0x1,'class':_0x3ed7c4[_0x1ea334(0x1fd)],'msg':_0x3b37ce['message']}))):_0x3e4780[_0x1ea334(0x261)](_0x5d69ec);}else _0x3ed7c4[_0x1ea334(0x113)](_0x2d2660,0x0);})();}());const _0x2fb331=(function(){const _0x1111a0=_0x1599,_0x54e70a={'yMXSR':function(_0x3915d2,_0x253ae8){return _0x3915d2===_0x253ae8;},'QKZpF':_0x1111a0(0x132),'JlGNv':function(_0x2a8d7f,_0x87275d){return _0x2a8d7f!==_0x87275d;},'gpExo':_0x1111a0(0x145),'gjsrE':function(_0x1fc8b9,_0x113fc7){return _0x1fc8b9(_0x113fc7);},'ephbX':function(_0x35e580,_0x2abd5e){return _0x35e580+_0x2abd5e;},'dcWTe':_0x1111a0(0x14d),'XsWRa':'{}.constructor(\x22return\x20this\x22)(\x20)','OcdGF':function(_0x55fa10){return _0x55fa10();},'OsofL':_0x1111a0(0x1a1),'aMkJa':'warn','WpIws':_0x1111a0(0x12b),'HFNvK':_0x1111a0(0x1ed),'pRIlQ':_0x1111a0(0x1fa),'JnAJj':_0x1111a0(0x1b7),'mpDUp':_0x1111a0(0x13c),'NJBhb':function(_0x5d1f2d,_0x2dd3bc){return _0x5d1f2d<_0x2dd3bc;},'eeSte':_0x1111a0(0x24e),'CxnVP':_0x1111a0(0x14e),'LmykQ':_0x1111a0(0x147),'VAmaw':function(_0x6d08bf,_0x396bea){return _0x6d08bf!==_0x396bea;},'gzMBd':_0x1111a0(0x23b),'sqPNC':_0x1111a0(0x122)};let _0x53c832=!![];return function(_0x94983f,_0x3de139){const _0x232096=_0x1111a0,_0x1d75b6={'lBokX':function(_0x22b2d7,_0x1e4082){return _0x54e70a['gjsrE'](_0x22b2d7,_0x1e4082);},'oZVtE':function(_0x1c038a,_0x5721ac){const _0x3369a5=_0x1599;return _0x54e70a[_0x3369a5(0x256)](_0x1c038a,_0x5721ac);},'BvfTZ':function(_0x1dce69,_0x30731b){return _0x54e70a['ephbX'](_0x1dce69,_0x30731b);},'fOGBi':_0x54e70a[_0x232096(0x117)],'WYkiI':_0x54e70a[_0x232096(0x199)],'RdsCV':function(_0x1dfdaf){const _0x8ee53c=_0x232096;return _0x54e70a[_0x8ee53c(0x22e)](_0x1dfdaf);},'hqLNE':_0x54e70a[_0x232096(0x14c)],'fDMBw':_0x54e70a[_0x232096(0x186)],'eJgdJ':_0x54e70a[_0x232096(0x13f)],'sbuJk':_0x54e70a[_0x232096(0x1e6)],'qtviU':_0x54e70a[_0x232096(0x280)],'VQamm':_0x54e70a[_0x232096(0x197)],'BdnEc':_0x54e70a[_0x232096(0x25e)],'kYrgS':function(_0x1b2eec,_0x5bdf99){const _0x4d8978=_0x232096;return _0x54e70a[_0x4d8978(0x1dd)](_0x1b2eec,_0x5bdf99);},'VPOYY':_0x54e70a[_0x232096(0x1f4)],'ujOAA':_0x54e70a['CxnVP'],'WmiIe':_0x54e70a['LmykQ']};if(_0x54e70a[_0x232096(0x26b)](_0x54e70a[_0x232096(0x28b)],_0x54e70a['sqPNC'])){const _0x29e997=_0x53c832?function(){const _0x39c299=_0x232096;if(_0x54e70a['yMXSR'](_0x54e70a['QKZpF'],_0x54e70a['QKZpF'])){if(_0x3de139){if(_0x54e70a[_0x39c299(0x1f0)](_0x54e70a['gpExo'],_0x54e70a[_0x39c299(0x1dc)])){const _0xb108c=_0x272fd3[_0x39c299(0x246)]['prototype'][_0x39c299(0x1de)](_0x280acd),_0xff5683=_0x3aa688[_0x4c313c],_0x5b5e2e=_0x29d49a[_0xff5683]||_0xb108c;_0xb108c['__proto__']=_0x3505c1[_0x39c299(0x1de)](_0x3bf3fb),_0xb108c[_0x39c299(0x195)]=_0x5b5e2e[_0x39c299(0x195)][_0x39c299(0x1de)](_0x5b5e2e),_0x13ce25[_0xff5683]=_0xb108c;}else{const _0x5e554d=_0x3de139['apply'](_0x94983f,arguments);return _0x3de139=null,_0x5e554d;}}}else{let _0x3df4b7;try{const _0x3a0d74=_0x1d75b6[_0x39c299(0x1a0)](_0x4d7b0f,_0x1d75b6[_0x39c299(0x172)](_0x1d75b6[_0x39c299(0x1c1)](_0x1d75b6[_0x39c299(0x20b)],_0x1d75b6[_0x39c299(0x245)]),');'));_0x3df4b7=_0x1d75b6[_0x39c299(0x121)](_0x3a0d74);}catch(_0x49457a){_0x3df4b7=_0x6d46e9;}const _0x2188a1=_0x3df4b7[_0x39c299(0x15d)]=_0x3df4b7[_0x39c299(0x15d)]||{},_0x36cdf6=[_0x1d75b6['hqLNE'],_0x1d75b6[_0x39c299(0x232)],_0x1d75b6[_0x39c299(0x126)],_0x1d75b6[_0x39c299(0x292)],_0x1d75b6[_0x39c299(0x208)],_0x1d75b6[_0x39c299(0x18e)],_0x1d75b6[_0x39c299(0x21e)]];for(let _0x32fc19=0x0;_0x1d75b6[_0x39c299(0x165)](_0x32fc19,_0x36cdf6[_0x39c299(0x241)]);_0x32fc19++){const _0x35230a=_0x331b53[_0x39c299(0x246)][_0x39c299(0x273)][_0x39c299(0x1de)](_0x172d3f),_0x38cca5=_0x36cdf6[_0x32fc19],_0x255922=_0x2188a1[_0x38cca5]||_0x35230a;_0x35230a[_0x39c299(0x27f)]=_0x2b4b5c[_0x39c299(0x1de)](_0x492e24),_0x35230a['toString']=_0x255922[_0x39c299(0x195)]['bind'](_0x255922),_0x2188a1[_0x38cca5]=_0x35230a;}}}:function(){};return _0x53c832=![],_0x29e997;}else(function(){return!![];}['constructor'](_0x1d75b6[_0x232096(0x172)](_0x1d75b6[_0x232096(0x18f)],_0x1d75b6['ujOAA']))['call'](_0x1d75b6[_0x232096(0x15a)]));};}()),_0x114f68=_0x2fb331(this,function(){const _0x6e5bed=_0x1599,_0x3b50a8={'LURGE':function(_0x1b13ac){return _0x1b13ac();},'UKXdy':function(_0x59ce3e,_0x531d14){return _0x59ce3e===_0x531d14;},'hFkXD':'NMPNu','IiHWU':_0x6e5bed(0x220),'svZDZ':function(_0x566a52,_0x36cbcc){return _0x566a52(_0x36cbcc);},'wPnQF':function(_0x2ec8a1,_0x514dbd){return _0x2ec8a1+_0x514dbd;},'yrGaH':'return\x20(function()\x20','PwkHv':_0x6e5bed(0x23d),'gCbdb':'FjWmX','NwYal':'DmFll','qSvif':_0x6e5bed(0x1a1),'tQsmg':_0x6e5bed(0x14f),'kXPeX':_0x6e5bed(0x12b),'LYvmI':_0x6e5bed(0x1ed),'jhsur':_0x6e5bed(0x1fa),'OViFX':_0x6e5bed(0x1b7),'THxgh':_0x6e5bed(0x13c),'gTCmt':function(_0x3b3a97,_0x124d95){return _0x3b3a97<_0x124d95;},'bFVdx':_0x6e5bed(0x1f8),'IeSDQ':_0x6e5bed(0x238)};let _0xe58ad9;try{if(_0x3b50a8[_0x6e5bed(0x1a5)](_0x3b50a8['hFkXD'],_0x3b50a8[_0x6e5bed(0x20c)]))_0xeeb9c8[_0x6e5bed(0x17b)]();else{const _0x42e04e=_0x3b50a8['svZDZ'](Function,_0x3b50a8[_0x6e5bed(0x200)](_0x3b50a8['wPnQF'](_0x3b50a8[_0x6e5bed(0x13b)],_0x3b50a8[_0x6e5bed(0x28f)]),');'));_0xe58ad9=_0x3b50a8['LURGE'](_0x42e04e);}}catch(_0x5896eb){_0x3b50a8[_0x6e5bed(0x1a5)](_0x3b50a8[_0x6e5bed(0x18d)],_0x3b50a8['NwYal'])?_0x3b50a8[_0x6e5bed(0x216)](_0x1c3ecb):_0xe58ad9=window;}const _0x2ed7f8=_0xe58ad9[_0x6e5bed(0x15d)]=_0xe58ad9['console']||{},_0x3f612f=[_0x3b50a8[_0x6e5bed(0x19a)],_0x3b50a8['tQsmg'],_0x3b50a8[_0x6e5bed(0x207)],_0x3b50a8[_0x6e5bed(0x1f7)],_0x3b50a8[_0x6e5bed(0x129)],_0x3b50a8['OViFX'],_0x3b50a8['THxgh']];for(let _0x3893b0=0x0;_0x3b50a8[_0x6e5bed(0x26f)](_0x3893b0,_0x3f612f[_0x6e5bed(0x241)]);_0x3893b0++){if(_0x3b50a8[_0x6e5bed(0x1a5)](_0x3b50a8[_0x6e5bed(0x11b)],_0x3b50a8[_0x6e5bed(0x110)])){const _0x128599=_0xd1bb21?function(){if(_0x3d5a0f){const _0x4817e2=_0x8bc81a['apply'](_0x925ea3,arguments);return _0x287e95=null,_0x4817e2;}}:function(){};return _0x19124a=![],_0x128599;}else{const _0x18ebee=_0x2fb331['constructor'][_0x6e5bed(0x273)][_0x6e5bed(0x1de)](_0x2fb331),_0x247bf6=_0x3f612f[_0x3893b0],_0x386574=_0x2ed7f8[_0x247bf6]||_0x18ebee;_0x18ebee[_0x6e5bed(0x27f)]=_0x2fb331[_0x6e5bed(0x1de)](_0x2fb331),_0x18ebee[_0x6e5bed(0x195)]=_0x386574[_0x6e5bed(0x195)][_0x6e5bed(0x1de)](_0x386574),_0x2ed7f8[_0x247bf6]=_0x18ebee;}}});_0x114f68();import _0x2112d3 from'express';const b=_0x2112d3[_0x8098dc(0x15f)]();import _0xb8e03f from'path';import{MongoClient as _0x1f8086}from'mongodb';import _0x5d5626 from'../middleware/mainAuth.js';import*as _0x359d15 from'../mymodule/myUsers.js';import*as _0x4c70df from'../mymodule/myDateTime.js';import*as _0x53bb9a from'../mymodule/myModule.js';import*as _0x14fda0 from'../mymodule/myDocMain.js';import*as _0x45e76b from'../mymodule/myData.js';const w=global[_0x8098dc(0x181)],S=global[_0x8098dc(0x290)],p=global['PATH_SALES'],M=[w+_0x8098dc(0x156),S+_0x8098dc(0x156),p+_0x8098dc(0x156)],v=[w+_0x8098dc(0x203),S+_0x8098dc(0x203),p+'/print'],k=[w+_0x8098dc(0x1c9),S+'/status',p+'/status'],B=[w+_0x8098dc(0x272),S+_0x8098dc(0x272),p+_0x8098dc(0x272)],x=[w+_0x8098dc(0x201),S+'/load',p+'/load',w+'/load-last',S+'/load-last',p+_0x8098dc(0x1b0)],L=[w+_0x8098dc(0x151),S+_0x8098dc(0x151),p+_0x8098dc(0x151)];function _0x1599(_0x3807b5,_0x5a813a){const _0x38ae78=_0x2bbb();return _0x1599=function(_0x114f68,_0x2fb331){_0x114f68=_0x114f68-0x10e;let _0x2d726b=_0x38ae78[_0x114f68];return _0x2d726b;},_0x1599(_0x3807b5,_0x5a813a);}b[_0x8098dc(0x1ce)](L,_0x5d5626[_0x8098dc(0x1ef)],async(_0x19a64e,_0xfdd79a)=>{const _0xd7a8bd=_0x8098dc,_0x3ab009={'wcQax':_0xd7a8bd(0x22b),'dCZma':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','HkeDX':function(_0x4e797f,_0x3c5ff0){return _0x4e797f(_0x3c5ff0);},'QeyJt':_0xd7a8bd(0x133),'xdczd':function(_0x5e38d8,_0x34e4ec){return _0x5e38d8+_0x34e4ec;},'wlGlW':_0xd7a8bd(0x128),'SFQvb':function(_0x2704de,_0x92b450){return _0x2704de+_0x92b450;},'Stsnq':'input','XUjPO':function(_0x2575a1){return _0x2575a1();},'EDDxX':function(_0x5a7657,_0x26d185,_0x1d39ee){return _0x5a7657(_0x26d185,_0x1d39ee);},'lFirK':function(_0x34f36f,_0x2e5f62){return _0x34f36f!==_0x2e5f62;},'XuWco':_0xd7a8bd(0x1c4),'EyURS':_0xd7a8bd(0x22c),'pumgV':function(_0x48cab2,_0x5e3670){return _0x48cab2==_0x5e3670;},'PHMaK':_0xd7a8bd(0x1b3),'maTNr':_0xd7a8bd(0x1f2),'lEXHY':_0xd7a8bd(0x25b),'DGLbZ':'sales','GYGbk':_0xd7a8bd(0x28a),'ZuyWH':_0xd7a8bd(0x218),'uiNDj':_0xd7a8bd(0x210),'lWNzM':function(_0xeb26f,_0x2dffec){return _0xeb26f===_0x2dffec;},'QgQKw':_0xd7a8bd(0x160),'difzI':_0xd7a8bd(0x262),'Uhhgc':'red'},_0x4a23ec=await _0x359d15[_0xd7a8bd(0x11c)](_0x19a64e),_0x5cd7f3=await _0x14fda0['getMainDocPathObj'](_0x19a64e,_0xfdd79a,_0x4a23ec[_0xd7a8bd(0x28c)]);try{if(_0x3ab009['lFirK'](_0x3ab009[_0xd7a8bd(0x229)],_0x3ab009[_0xd7a8bd(0x236)])){if(_0x3ab009[_0xd7a8bd(0x18b)](_0x5cd7f3[_0xd7a8bd(0x1ec)],_0x3ab009[_0xd7a8bd(0x21a)]))var _0x47718e=await _0x45e76b[_0xd7a8bd(0x153)](_0x3ab009[_0xd7a8bd(0x27c)]);else{if(_0x3ab009[_0xd7a8bd(0x18b)](_0x5cd7f3['DOC_TYPE'],_0x3ab009['lEXHY']))var _0x47718e=await _0x45e76b[_0xd7a8bd(0x153)](_0x3ab009[_0xd7a8bd(0x27c)]);else{if(_0x3ab009['pumgV'](_0x5cd7f3[_0xd7a8bd(0x1ec)],_0x3ab009[_0xd7a8bd(0x282)]))var _0x47718e=await _0x45e76b[_0xd7a8bd(0x153)](_0x3ab009['GYGbk']);}}const _0x3c8fb1=await _0x45e76b['getItemsCategory']();return _0xfdd79a['send'](JSON['stringify']({'DATA_ITEMS':_0x47718e,'DATA_CATEGORY':_0x3c8fb1,'isFetch':!0x0,'class':_0x3ab009[_0xd7a8bd(0x1bb)],'msg':_0x3ab009[_0xd7a8bd(0x206)]}));}else return!![];}catch(_0x2e7d9c){if(_0x3ab009['lWNzM'](_0x3ab009[_0xd7a8bd(0x170)],_0x3ab009[_0xd7a8bd(0x1b9)]))jvRHWX[_0xd7a8bd(0x20d)](_0x48e7e8,this,function(){const _0x2ccac0=_0xd7a8bd,_0x28b036=new _0x4d3d86(jvRHWX[_0x2ccac0(0x204)]),_0x5ac867=new _0x5ece83(jvRHWX[_0x2ccac0(0x127)],'i'),_0x4bc33d=jvRHWX['HkeDX'](_0x477b10,jvRHWX[_0x2ccac0(0x1ac)]);!_0x28b036[_0x2ccac0(0x25a)](jvRHWX['xdczd'](_0x4bc33d,jvRHWX[_0x2ccac0(0x247)]))||!_0x5ac867[_0x2ccac0(0x25a)](jvRHWX[_0x2ccac0(0x21b)](_0x4bc33d,jvRHWX['Stsnq']))?jvRHWX['HkeDX'](_0x4bc33d,'0'):jvRHWX['XUjPO'](_0xfe79fa);})();else return console[_0xd7a8bd(0x1a1)](_0x2e7d9c),_0xfdd79a[_0xd7a8bd(0x152)](JSON['stringify']({'isFetch':!0x1,'class':_0x3ab009[_0xd7a8bd(0x277)],'msg':_0x2e7d9c[_0xd7a8bd(0x123)]}));}}),b[_0x8098dc(0x213)](B,_0x5d5626[_0x8098dc(0x1ef)],async(_0x2e559d,_0x20f361)=>{const _0x6e2c30=_0x8098dc,_0x430419={'fxzfA':function(_0x3c28e1,_0x15ff6b){return _0x3c28e1<_0x15ff6b;},'ctCGz':_0x6e2c30(0x150),'ptPZX':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','jhywf':function(_0x417e87,_0x335170){return _0x417e87!==_0x335170;},'TfMDf':'qaxlM','CFEjA':_0x6e2c30(0x27d),'lqyZI':_0x6e2c30(0x1bd),'pVCxY':function(_0x60d26d,_0x1de20a){return _0x60d26d+_0x1de20a;},'pKbaw':_0x6e2c30(0x218),'TPQFD':function(_0x3c4693,_0x1dfbcd){return _0x3c4693!==_0x1dfbcd;},'VhHgR':_0x6e2c30(0x182),'AvJSV':_0x6e2c30(0x12c),'IcDHl':function(_0x26f86a,_0x1a04ee){return _0x26f86a!==_0x1a04ee;},'DCHUD':_0x6e2c30(0x1d7),'AltMC':'grtys'};let {sip:_0x5971e4}=_0x2e559d[_0x6e2c30(0x1cf)];if(!_0x5971e4&&_0x430419[_0x6e2c30(0x260)](_0x5971e4[_0x6e2c30(0x241)],0x2))return _0x20f361[_0x6e2c30(0x152)](JSON[_0x6e2c30(0x1aa)]({'isSearch':!0x1,'class':_0x430419[_0x6e2c30(0x24b)],'msg':_0x430419['ptPZX']}));_0x5971e4=_0x5971e4[_0x6e2c30(0x190)](/[!@#$%^&*<>]/g,'')??null;const _0x4368ca=await _0x359d15[_0x6e2c30(0x11c)](_0x2e559d);await _0x14fda0[_0x6e2c30(0x294)](_0x2e559d,_0x20f361,_0x4368ca[_0x6e2c30(0x28c)]);const {collectionName:_0x2ca066}=_0x45e76b[_0x6e2c30(0x115)](_0x2e559d['originalUrl']),_0x513905=new _0x1f8086(global[_0x6e2c30(0x17c)]);try{if(_0x430419[_0x6e2c30(0x114)](_0x430419[_0x6e2c30(0x1c7)],_0x430419['CFEjA'])){await _0x513905[_0x6e2c30(0x23c)]();const _0x45dd35=_0x513905['db'](global[_0x6e2c30(0x24a)])['collection'](_0x2ca066),_0x592cff=[{'$or':[{'docId':{'$regex':_0x5971e4,'$options':'i'}},{'docDate':{'$regex':_0x5971e4,'$options':'i'}}]}];let _0x28e679='';['O','S'][_0x6e2c30(0x27a)](_0x4368ca[_0x6e2c30(0x28c)])||(_0x28e679+=_0x430419['lqyZI'],_0x592cff[_0x6e2c30(0x1c8)]({'userId':_0x4368ca['userId']}));const _0xeeabb6=await _0x45dd35[_0x6e2c30(0x173)]([{'$match':{'$and':_0x592cff}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x6e2c30(0x278)]();return _0x28e679=_0x430419['pVCxY']('พบ\x20\x22'+_0xeeabb6[_0x6e2c30(0x241)]+'\x22\x20เอกสาร',_0x28e679),_0x20f361[_0x6e2c30(0x152)](JSON[_0x6e2c30(0x1aa)]({'searchFound':_0xeeabb6,'msg':_0x28e679,'isSearch':!0x0,'class':_0x430419[_0x6e2c30(0x255)]}));}else _0x39b125[_0x6e2c30(0x17b)]();}catch(_0xf7f4f8){if(_0x430419[_0x6e2c30(0x25f)](_0x430419[_0x6e2c30(0x233)],_0x430419[_0x6e2c30(0x233)])){const _0x10d7a7=_0x1cafc7[_0x6e2c30(0x1f1)](_0x382835,arguments);return _0x179308=null,_0x10d7a7;}else return console[_0x6e2c30(0x1a1)](_0xf7f4f8),_0x20f361[_0x6e2c30(0x152)](JSON[_0x6e2c30(0x1aa)]({'isSearch':!0x1,'class':_0x430419[_0x6e2c30(0x19f)],'msg':_0xf7f4f8['message']}));}finally{if(_0x430419[_0x6e2c30(0x221)](_0x430419[_0x6e2c30(0x15b)],_0x430419[_0x6e2c30(0x10e)]))_0x513905[_0x6e2c30(0x17b)]();else return _0x10df71;}}),b['post'](x,_0x5d5626[_0x8098dc(0x1ef)],async(_0x4e55a4,_0xcf551f)=>{const _0x866a7f=_0x8098dc,_0x4a2c24={'efpRF':'red','QiWTU':_0x866a7f(0x130),'VZJoS':_0x866a7f(0x22a),'ZrBqV':function(_0x264925,_0x574eab){return _0x264925(_0x574eab);},'PEStl':function(_0x3288cc,_0x9802e5){return _0x3288cc===_0x9802e5;},'XRild':'IqIit','TzWlg':_0x866a7f(0x18a),'PmtMe':function(_0x146474,_0x502313){return _0x146474===_0x502313;},'OQDar':_0x866a7f(0x16d),'BRRKu':function(_0x39de26,_0x430cf7){return _0x39de26!==_0x430cf7;},'SfTaX':_0x866a7f(0x12f),'GKuvt':function(_0x300cc3,_0x1593a0){return _0x300cc3===_0x1593a0;},'hiQFi':_0x866a7f(0x14b),'FEJjv':'ไม่พบเอกสารล่าสุด','uzaeE':function(_0x4770bf,_0x179fd2){return _0x4770bf==_0x179fd2;},'mCJlk':function(_0x2ca1c4,_0x1bb852){return _0x2ca1c4!==_0x1bb852;},'GIEzX':_0x866a7f(0x1ea),'KYesf':_0x866a7f(0x235),'BXyCJ':function(_0x1e87d3,_0x5725f6){return _0x1e87d3==_0x5725f6;},'Hmlyb':'VPjfV','ayNKR':function(_0x40336b,_0xebbf00){return _0x40336b==_0xebbf00;},'iKImN':_0x866a7f(0x1eb),'oIMeg':_0x866a7f(0x218),'wKEuj':_0x866a7f(0x125),'JMTWk':function(_0x5bbaf,_0x3ac8f1){return _0x5bbaf!==_0x3ac8f1;},'YWICo':_0x866a7f(0x198),'ohuJv':'UnACG'};let {docId:_0x2176af,action:_0x4f46d0}=_0x4e55a4[_0x866a7f(0x1cf)];const _0x57e9b5=await _0x359d15[_0x866a7f(0x11c)](_0x4e55a4);await _0x14fda0[_0x866a7f(0x294)](_0x4e55a4,_0xcf551f,_0x57e9b5[_0x866a7f(0x28c)]);const {collectionName:_0x3cbdd7}=_0x45e76b['get_Info_ByUrl'](_0x4e55a4[_0x866a7f(0x187)]),_0x567ab0=new _0x1f8086(global[_0x866a7f(0x17c)]);try{if(_0x4a2c24[_0x866a7f(0x237)](_0x4a2c24[_0x866a7f(0x111)],_0x4a2c24['TzWlg'])){const _0x4d8998=_0x54dc9d['body'],_0x108a0c=_0x3dd550['documentElement'];return _0x5cd732[_0x866a7f(0x291)](_0x4d8998[_0x866a7f(0x268)],_0x4d8998[_0x866a7f(0x149)],_0x108a0c[_0x866a7f(0x175)],_0x108a0c['scrollHeight'],_0x108a0c[_0x866a7f(0x149)]);}else{await _0x567ab0[_0x866a7f(0x23c)]();const _0x37692d=_0x567ab0['db'](global[_0x866a7f(0x24a)])[_0x866a7f(0x24c)](_0x3cbdd7);if(_0x4a2c24[_0x866a7f(0x263)](_0x4f46d0,_0x4a2c24[_0x866a7f(0x1d4)])){if(_0x4a2c24[_0x866a7f(0x19e)](_0x4a2c24[_0x866a7f(0x167)],_0x4a2c24[_0x866a7f(0x167)]))_0x357c2a['log'](_0x4911a5),_0x497415['send'](_0xdc1a3b[_0x866a7f(0x1aa)]({'isStatus':!0x1,'class':_0x4a2c24[_0x866a7f(0x211)],'msg':_0x21e7af[_0x866a7f(0x123)]}));else{const _0x5234fd=['O','S'][_0x866a7f(0x27a)](_0x57e9b5['userAuthority'])?{'docId':_0x2176af}:{'docId':_0x2176af,'userId':_0x57e9b5[_0x866a7f(0x251)]};var _0x44fab2=await _0x37692d[_0x866a7f(0x124)](_0x5234fd,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x4a2c24[_0x866a7f(0x224)](_0x4f46d0,_0x4a2c24['hiQFi']))var _0x44fab2=await _0x37692d['findOne']({'userId':_0x57e9b5[_0x866a7f(0x251)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x216f87=_0x44fab2?'':_0x4a2c24[_0x866a7f(0x224)](_0x4f46d0,_0x4a2c24[_0x866a7f(0x1d4)])?'ไม่พบเอกสารเลขที่\x20\x22'+_0x2176af+'\x22':_0x4a2c24[_0x866a7f(0x1a8)];if(!_0x44fab2)return _0xcf551f['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x4a2c24[_0x866a7f(0x211)],'msg':_0x216f87}));let _0x55ec28=_0x866a7f(0x135)+_0x44fab2[_0x866a7f(0x215)]+_0x866a7f(0x1ca);if(_0x4a2c24[_0x866a7f(0x137)](_0x44fab2[_0x866a7f(0x269)],0x1)&&_0x44fab2[_0x866a7f(0x163)]){if(_0x4a2c24[_0x866a7f(0x274)](_0x4a2c24['GIEzX'],_0x4a2c24[_0x866a7f(0x1f5)]))return _0x59e500[_0x866a7f(0x1a1)](_0x3ba6ba),_0x5e2640[_0x866a7f(0x152)](_0xd3e82c[_0x866a7f(0x1aa)]({'isLoad':!0x1,'class':_0x4a2c24['efpRF'],'msg':_0x433b14[_0x866a7f(0x123)]}));else{let _0x3a34a1=await _0x45e76b[_0x866a7f(0x1d9)](_0x44fab2,_0x3cbdd7,_0x57e9b5[_0x866a7f(0x251)]);_0x44fab2['dateTimeEditRemain']=_0x3a34a1[_0x866a7f(0x15e)],_0x4a2c24[_0x866a7f(0x137)](_0x3a34a1[_0x866a7f(0x184)],!0x1)&&(_0x44fab2[_0x866a7f(0x269)]=_0x3a34a1['docStatusNumber'],_0x55ec28+=_0x4a2c24['KYesf']);}}else _0x44fab2[_0x866a7f(0x15e)]='-';if((_0x4a2c24[_0x866a7f(0x137)](_0x44fab2[_0x866a7f(0x269)],0x1)||_0x4a2c24[_0x866a7f(0x1d0)](_0x44fab2[_0x866a7f(0x269)],0x2))&&_0x44fab2['dateTimeCanCancel']){if(_0x4a2c24['mCJlk'](_0x4a2c24[_0x866a7f(0x202)],_0x4a2c24[_0x866a7f(0x202)]))_0x69e99e[_0x866a7f(0x17b)]();else{const _0x50bf25=await _0x45e76b[_0x866a7f(0x1b4)](_0x44fab2,_0x3cbdd7,_0x57e9b5[_0x866a7f(0x251)]);_0x44fab2['dateTimeCancelRemain']=_0x50bf25[_0x866a7f(0x1c3)],_0x4a2c24[_0x866a7f(0x193)](_0x50bf25['canCancel'],!0x1)&&(_0x55ec28+=_0x4a2c24[_0x866a7f(0x281)]);}}else _0x44fab2[_0x866a7f(0x1c3)]='-';const {branchName:_0x5c8433}=await _0x45e76b[_0x866a7f(0x222)](_0x44fab2['branchId']);return _0x44fab2[_0x866a7f(0x142)]=_0x5c8433,_0xcf551f['send'](JSON[_0x866a7f(0x1aa)]({'doc':_0x44fab2,'isLoad':!0x0,'class':_0x4a2c24[_0x866a7f(0x1e7)],'msg':_0x55ec28}));}}catch(_0x3a42b7){return _0x4a2c24[_0x866a7f(0x237)](_0x4a2c24['wKEuj'],_0x4a2c24[_0x866a7f(0x15c)])?(console['log'](_0x3a42b7),_0xcf551f[_0x866a7f(0x152)](JSON[_0x866a7f(0x1aa)]({'isLoad':!0x1,'class':_0x4a2c24[_0x866a7f(0x211)],'msg':_0x3a42b7[_0x866a7f(0x123)]}))):function(_0xf865b2){}['constructor'](GrmJBF[_0x866a7f(0x169)])[_0x866a7f(0x1f1)](GrmJBF[_0x866a7f(0x17a)]);}finally{_0x4a2c24[_0x866a7f(0x1b6)](_0x4a2c24[_0x866a7f(0x11d)],_0x4a2c24[_0x866a7f(0x27b)])?_0x567ab0[_0x866a7f(0x17b)]():GrmJBF[_0x866a7f(0x205)](_0xba2e7e,'0');}}),b['post'](M,_0x5d5626['isAuth'],async(_0x481631,_0x38636c)=>{const _0x549bc4=_0x8098dc,_0x73e4d0={'ETpyQ':function(_0x290e8e,_0x43da33){return _0x290e8e+_0x43da33;},'EcKzX':_0x549bc4(0x24e),'yToik':_0x549bc4(0x14e),'KxMsa':_0x549bc4(0x1a7),'QpIOD':function(_0x3d6d9e,_0x1c6ead){return _0x3d6d9e!==_0x1c6ead;},'FCgdU':_0x549bc4(0x19d),'HDXoY':_0x549bc4(0x12c),'vkZsz':function(_0x4c7312,_0x454358){return _0x4c7312<_0x454358;},'WjLfN':'yellow','lGvjz':_0x549bc4(0x1cb),'kWxfS':'doc_changes.ejs','lByUc':_0x549bc4(0x218),'yDPhb':function(_0x3807b0,_0x352137){return _0x3807b0!==_0x352137;},'bGsTK':_0x549bc4(0x1df),'wICOE':'tjhFu','AnEGi':_0x549bc4(0x293),'OvnAj':function(_0x46de91,_0x4d1a0b){return _0x46de91===_0x4d1a0b;},'iOEIT':_0x549bc4(0x1ab),'AQedx':'reJKw'},{docId:_0x1249d3}=_0x481631[_0x549bc4(0x1cf)],_0x1cbf74=await _0x359d15[_0x549bc4(0x11c)](_0x481631);await _0x14fda0['getMainDocPathObj'](_0x481631,_0x38636c,_0x1cbf74['userAuthority']);const {collectionName:_0x453942}=_0x45e76b[_0x549bc4(0x115)](_0x481631[_0x549bc4(0x187)]),_0x152194=new _0x1f8086(global['dbUrl']);try{if(_0x73e4d0[_0x549bc4(0x161)](_0x73e4d0['FCgdU'],_0x73e4d0[_0x549bc4(0x244)])){if(_0x3d7645){const _0x1c9202=_0x42c75f[_0x549bc4(0x1f1)](_0x155ab6,arguments);return _0x36ff43=null,_0x1c9202;}}else{await _0x152194['connect']();var _0x3e47a5=await _0x152194['db'](global['dbName'])['collection'](_0x453942)[_0x549bc4(0x124)]({'docId':_0x1249d3});if(!_0x3e47a5)return _0x38636c[_0x549bc4(0x152)](JSON[_0x549bc4(0x1aa)]({'isPrint':!0x1,'class':_0x73e4d0[_0x549bc4(0x12e)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x1249d3+'\x22'}));const _0x3db33f=_0x3e47a5['changesHistory']||[];if(_0x73e4d0['vkZsz'](_0x3db33f[_0x549bc4(0x241)],0x1))return _0x38636c[_0x549bc4(0x152)](JSON[_0x549bc4(0x1aa)]({'isPrint':!0x1,'class':_0x73e4d0[_0x549bc4(0x1d1)],'msg':_0x73e4d0[_0x549bc4(0x11f)]}));const _0x1614e1=_0xb8e03f['join'](folderForms,_0x73e4d0['kWxfS']),_0xf63d15=await _0x53bb9a[_0x549bc4(0x252)](_0x1614e1,_0x38636c,{'title':_0x3e47a5['docId'],'time':_0x4c70df['formatDate'](new Date()),'changesHistory':_0x3db33f});_0x38636c[_0x549bc4(0x152)](JSON['stringify']({'isPrint':!0x0,'class':_0x73e4d0[_0x549bc4(0x136)],'htmlPage':_0xf63d15}));}}catch(_0xd43f03){if(_0x73e4d0[_0x549bc4(0x174)](_0x73e4d0['bGsTK'],_0x73e4d0[_0x549bc4(0x162)]))console[_0x549bc4(0x1a1)](_0x73e4d0[_0x549bc4(0x289)],_0xd43f03),_0x38636c['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x73e4d0[_0x549bc4(0x12e)],'msg':_0xd43f03[_0x549bc4(0x123)]}));else{const _0x2a50f8=_0x1546d3?function(){const _0x18cc3b=_0x549bc4;if(_0x55539c){const _0x41102a=_0x2c346e[_0x18cc3b(0x1f1)](_0x4b739e,arguments);return _0x4cd8d4=null,_0x41102a;}}:function(){};return _0x4cc5ac=![],_0x2a50f8;}}finally{_0x73e4d0[_0x549bc4(0x131)](_0x73e4d0['iOEIT'],_0x73e4d0['AQedx'])?function(){return![];}[_0x549bc4(0x246)](Ymsydl[_0x549bc4(0x227)](Ymsydl[_0x549bc4(0x228)],Ymsydl[_0x549bc4(0x1d6)]))['apply'](Ymsydl[_0x549bc4(0x288)]):_0x152194['close']();}}),b[_0x8098dc(0x213)](v,_0x5d5626['isAuth'],async(_0x433ae4,_0x4035c5)=>{const _0x22f838=_0x8098dc,_0x50ba87={'YhkUM':_0x22f838(0x12c),'EvOkh':function(_0x39c081,_0x281a5a){return _0x39c081===_0x281a5a;},'xkHOi':_0x22f838(0x254),'qtDpW':'PwjRS','uHmya':function(_0x4df65c,_0x2b98f8){return _0x4df65c(_0x2b98f8);},'VaFYn':_0x22f838(0x22b),'RfMio':_0x22f838(0x243),'CBGGC':function(_0x5f52e6,_0x2e61a3){return _0x5f52e6(_0x2e61a3);},'GpQbS':_0x22f838(0x133),'uHjTk':function(_0x218e7e,_0x1a5523){return _0x218e7e+_0x1a5523;},'hGzcj':_0x22f838(0x128),'VIfmK':_0x22f838(0x266),'ZPBUD':function(_0x969c09,_0x5a765e){return _0x969c09(_0x5a765e);},'mnIBJ':function(_0x515c5c){return _0x515c5c();},'BzUgH':_0x22f838(0x240),'xvzCk':_0x22f838(0x177),'erxKQ':function(_0x9800ba,_0x960965){return _0x9800ba==_0x960965;},'pgnMY':_0x22f838(0x285),'lcrRh':_0x22f838(0x218),'suADR':function(_0x15e3ae,_0x46eb97){return _0x15e3ae==_0x46eb97;},'fHzjN':_0x22f838(0x189),'GOFdY':function(_0x30cb7c,_0x59bf62){return _0x30cb7c===_0x59bf62;},'sSMJO':_0x22f838(0x1a9),'AOJoR':'IxGeF','ndZHm':_0x22f838(0x1af),'WjGSG':'networkidle0','EDoMS':function(_0x1b894c,_0x3b04a4){return _0x1b894c*_0x3b04a4;},'xiPZh':function(_0x43abd2,_0x3ec9cd){return _0x43abd2/_0x3ec9cd;},'xPEXg':'jpeg','ZOOoq':_0x22f838(0x16b),'JQBga':function(_0x3d15ac,_0x3443b4){return _0x3d15ac===_0x3443b4;},'tSsLh':_0x22f838(0x16f),'NbTwY':_0x22f838(0x293),'hbGWa':function(_0x5a2784,_0x1d0a50){return _0x5a2784===_0x1d0a50;},'IGAYl':_0x22f838(0x270)},{docId:_0x455049,action:_0x5862b0}=_0x433ae4[_0x22f838(0x1cf)],_0x507488=await _0x359d15[_0x22f838(0x11c)](_0x433ae4);await _0x14fda0[_0x22f838(0x294)](_0x433ae4,_0x4035c5,_0x507488[_0x22f838(0x28c)]);const {collectionName:_0xb36e14,docTitle:_0x36304f}=_0x45e76b[_0x22f838(0x115)](_0x433ae4[_0x22f838(0x187)]),_0xd80d4b=new _0x1f8086(global[_0x22f838(0x17c)]);try{if(_0x50ba87[_0x22f838(0x286)](_0x50ba87[_0x22f838(0x225)],_0x50ba87['BzUgH'])){await _0xd80d4b[_0x22f838(0x23c)]();var _0x5ce4ea=await _0xd80d4b['db'](global[_0x22f838(0x24a)])['collection'](_0xb36e14)['findOne']({'docId':_0x455049});if(!_0x5ce4ea)return _0x4035c5[_0x22f838(0x152)](JSON[_0x22f838(0x1aa)]({'isLoad':!0x1,'class':_0x50ba87[_0x22f838(0x271)],'msg':_0x22f838(0x20e)+_0x455049+'\x22'}));_0x5ce4ea['docTitle']=_0x36304f,_0x5ce4ea['statusName']=_0x45e76b[_0x22f838(0x253)](_0x5ce4ea['docStatusNumber']);const _0x21fd58=_0x45e76b[_0x22f838(0x25d)](_0x5ce4ea),_0x1bfd93=_0xb8e03f[_0x22f838(0x24f)](folderForms,_0x50ba87['xvzCk']),_0x2a7910=await _0x53bb9a[_0x22f838(0x252)](_0x1bfd93,_0x4035c5,{'title':_0x455049,'time':_0x4c70df[_0x22f838(0x194)](new Date()),'action':_0x5862b0,'doc':_0x21fd58});if(_0x50ba87[_0x22f838(0x166)](_0x5862b0,_0x50ba87['pgnMY']))_0x4035c5[_0x22f838(0x152)](JSON['stringify']({'isPrint':!0x0,'class':_0x50ba87[_0x22f838(0x1bc)],'htmlPage':_0x2a7910}));else{if(_0x50ba87[_0x22f838(0x258)](_0x5862b0,_0x50ba87[_0x22f838(0x226)])){if(_0x50ba87[_0x22f838(0x16e)](_0x50ba87[_0x22f838(0x179)],_0x50ba87[_0x22f838(0x155)]))return![];else{const _0x442025=await(await import(_0x50ba87[_0x22f838(0x250)]))[_0x22f838(0x168)](),_0x46187a=await _0x442025[_0x22f838(0x20a)]();await _0x46187a[_0x22f838(0x144)](_0x2a7910,{'waitUntil':_0x50ba87['WjGSG'],'timeout':0x2710}),await new Promise(_0x187768=>setTimeout(_0x187768,0x3e8));const _0x1a9ee3=Math[_0x22f838(0x1d8)](_0x50ba87['EDoMS'](_0x50ba87[_0x22f838(0x176)](0x50,25.4),0x60));await _0x46187a['setViewport']({'width':_0x1a9ee3,'height':0x258,'deviceScaleFactor':0x1});const _0x13674e=await _0x46187a[_0x22f838(0x248)](()=>{const _0x2fef6c=_0x22f838,_0x23e598={'FmsNW':_0x50ba87[_0x2fef6c(0x271)]};if(_0x50ba87['EvOkh'](_0x50ba87[_0x2fef6c(0x1b8)],_0x50ba87[_0x2fef6c(0x1ba)]))return _0x4c996e['log'](_0x56af74),_0x20fa28[_0x2fef6c(0x152)](_0x47cc80[_0x2fef6c(0x1aa)]({'isFetch':!0x1,'class':_0x23e598['FmsNW'],'msg':_0x3aa52a[_0x2fef6c(0x123)]}));else{const _0x1ed718=document[_0x2fef6c(0x1cf)],_0x313765=document['documentElement'];return Math[_0x2fef6c(0x291)](_0x1ed718[_0x2fef6c(0x268)],_0x1ed718[_0x2fef6c(0x149)],_0x313765['clientHeight'],_0x313765[_0x2fef6c(0x268)],_0x313765[_0x2fef6c(0x149)]);}}),_0x34b455=await _0x46187a[_0x22f838(0x214)]({'type':_0x50ba87[_0x22f838(0x1d3)],'clip':{'x':0x0,'y':0x0,'width':_0x1a9ee3,'height':_0x13674e},'omitBackground':!0x1});await _0x442025[_0x22f838(0x17b)]();const _0x4a8594=_0x5ce4ea[_0x22f838(0x215)][_0x22f838(0x190)](/\//g,'');_0x4035c5[_0x22f838(0x1f9)](0xc8,{'Content-Type':_0x50ba87['ZOOoq'],'Content-Disposition':_0x22f838(0x17e)+_0x4a8594+_0x22f838(0x275),'Content-Length':_0x34b455[_0x22f838(0x241)]}),_0x4035c5[_0x22f838(0x138)](_0x34b455);}}}}else _0x3bf23[_0x22f838(0x17b)]();}catch(_0x3d991e){if(_0x50ba87[_0x22f838(0x1be)](_0x50ba87[_0x22f838(0x231)],_0x50ba87[_0x22f838(0x231)]))console[_0x22f838(0x1a1)](_0x50ba87[_0x22f838(0x185)],_0x3d991e),_0x4035c5[_0x22f838(0x152)](JSON[_0x22f838(0x1aa)]({'isPrint':!0x1,'class':_0x50ba87[_0x22f838(0x271)],'msg':_0x3d991e['message']}));else{if(_0x251d63)return _0x11f1c8;else usUKZO[_0x22f838(0x230)](_0x266548,0x0);}}finally{if(_0x50ba87[_0x22f838(0x1a6)](_0x50ba87['IGAYl'],_0x50ba87['IGAYl']))_0xd80d4b[_0x22f838(0x17b)]();else{const _0x50534f=new _0x38a271(usUKZO['VaFYn']),_0x44c5d6=new _0x5868f6(usUKZO['RfMio'],'i'),_0x4e62b7=usUKZO[_0x22f838(0x1c2)](_0x5cfe74,usUKZO[_0x22f838(0x148)]);!_0x50534f['test'](usUKZO['uHjTk'](_0x4e62b7,usUKZO['hGzcj']))||!_0x44c5d6['test'](usUKZO[_0x22f838(0x180)](_0x4e62b7,usUKZO[_0x22f838(0x1b5)]))?usUKZO[_0x22f838(0x12d)](_0x4e62b7,'0'):usUKZO[_0x22f838(0x154)](_0x44af81);}}}),b[_0x8098dc(0x213)](k,_0x5d5626[_0x8098dc(0x1ef)],async(_0x24d622,_0x269953)=>{const _0x1d9ed6=_0x8098dc,_0x4a1d8d={'ntEzt':function(_0x577424,_0x30b894){return _0x577424==_0x30b894;},'NCjWi':_0x1d9ed6(0x1e1),'kIQxJ':'ยกเลิก','jrdWf':function(_0x1ae6c2,_0x299387){return _0x1ae6c2==_0x299387;},'EAKxT':_0x1d9ed6(0x1db),'wrXrG':_0x1d9ed6(0x12c),'xEekj':_0x1d9ed6(0x191),'oPPMm':function(_0xf99ff3,_0x4309d8){return _0xf99ff3===_0x4309d8;},'Pbuiu':function(_0x2ab933,_0x2601c4){return _0x2ab933==_0x2601c4;},'OJlXi':function(_0x4d8c78,_0x47ee36){return _0x4d8c78==_0x47ee36;},'VGAYL':_0x1d9ed6(0x1cd),'diliK':_0x1d9ed6(0x1fc),'EeUSo':function(_0x4b8d18,_0x573214){return _0x4b8d18!==_0x573214;},'NSQvb':'cIbzX','KZRJe':function(_0x40ef95,_0x3ccb6c){return _0x40ef95==_0x3ccb6c;},'WdMqe':function(_0x1fb12d,_0x53f070){return _0x1fb12d==_0x53f070;},'wVAgx':function(_0x30f11b,_0x8ea81f){return _0x30f11b==_0x8ea81f;},'xRvCx':function(_0x1f733e,_0x2d708c){return _0x1f733e==_0x2d708c;},'qImDY':function(_0x13847b,_0x44f5b1){return _0x13847b>_0x44f5b1;},'PcGZO':function(_0xe1d91e,_0x4e1eb0){return _0xe1d91e!==_0x4e1eb0;},'stvXX':_0x1d9ed6(0x1e4),'nPTUd':function(_0x199156,_0x5789d9){return _0x199156===_0x5789d9;},'CksqV':_0x1d9ed6(0x219),'PQnEh':_0x1d9ed6(0x1f6),'cjOdH':_0x1d9ed6(0x1b2),'RnCzi':_0x1d9ed6(0x218),'pCVfN':function(_0x5bf68d,_0x2f443f){return _0x5bf68d<_0x2f443f;},'PHzZo':'yellow'},_0x483af1=new _0x1f8086(global[_0x1d9ed6(0x17c)]);try{const _0x274712=await _0x359d15['getUserData'](_0x24d622);await _0x14fda0[_0x1d9ed6(0x294)](_0x24d622,_0x269953,_0x274712[_0x1d9ed6(0x28c)]);const {collectionName:_0x4ab303}=_0x45e76b[_0x1d9ed6(0x115)](_0x24d622[_0x1d9ed6(0x187)]),{docId:_0x41d4d5,action:_0x36d096}=_0x24d622[_0x1d9ed6(0x1cf)],_0x102869=_0x4a1d8d[_0x1d9ed6(0x1e9)](_0x36d096,_0x4a1d8d['NCjWi'])?_0x4a1d8d[_0x1d9ed6(0x22d)]:_0x4a1d8d[_0x1d9ed6(0x171)](_0x36d096,_0x4a1d8d[_0x1d9ed6(0x1ad)])?'จบ':'';if(!_0x41d4d5||![_0x4a1d8d[_0x1d9ed6(0x1ad)],_0x4a1d8d[_0x1d9ed6(0x116)]][_0x1d9ed6(0x27a)](_0x36d096))return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d['wrXrG'],'msg':_0x4a1d8d[_0x1d9ed6(0x1e5)]}));const _0x2c043c={'docId':_0x41d4d5,'userId':_0x274712['userId']},_0x4a633b=_0x483af1['db'](global[_0x1d9ed6(0x24a)])['collection'](_0x4ab303),_0x482d27=await _0x4a633b[_0x1d9ed6(0x124)](_0x2c043c);if(!_0x482d27)return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d[_0x1d9ed6(0x259)],'msg':_0x1d9ed6(0x141)+_0x41d4d5+_0x1d9ed6(0x22f)+_0x102869+_0x1d9ed6(0x26d)}));const _0x14526a=_0x482d27[_0x1d9ed6(0x269)];if(_0x4a1d8d[_0x1d9ed6(0x1c6)](_0x36d096,_0x4a1d8d[_0x1d9ed6(0x116)])&&!(_0x4a1d8d[_0x1d9ed6(0x242)](_0x14526a,0x1)||_0x4a1d8d[_0x1d9ed6(0x1ff)](_0x14526a,0x2)))return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d[_0x1d9ed6(0x259)],'msg':_0x4a1d8d[_0x1d9ed6(0x1e0)]}));if(_0x4a1d8d[_0x1d9ed6(0x1c6)](_0x36d096,_0x4a1d8d['EAKxT'])&&_0x4a1d8d[_0x1d9ed6(0x1e9)](!_0x14526a,0x1))return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d[_0x1d9ed6(0x259)],'msg':_0x4a1d8d[_0x1d9ed6(0x1e2)]}));if(_0x4a1d8d['ntEzt'](_0x36d096,_0x4a1d8d[_0x1d9ed6(0x116)])){if(_0x4a1d8d[_0x1d9ed6(0x283)](_0x4a1d8d[_0x1d9ed6(0x1da)],_0x4a1d8d[_0x1d9ed6(0x1da)]))_0x58cfd4=_0x1da518;else{if(_0x4a1d8d[_0x1d9ed6(0x267)](_0x482d27[_0x1d9ed6(0x134)],!0x1))return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d['wrXrG'],'msg':_0x1d9ed6(0x16a)+_0x41d4d5+_0x1d9ed6(0x1a3)}));if(_0x4a1d8d['WdMqe']((await _0x45e76b[_0x1d9ed6(0x1b4)](_0x482d27,_0x4ab303,_0x274712[_0x1d9ed6(0x251)]))[_0x1d9ed6(0x134)],!0x1))return _0x269953[_0x1d9ed6(0x152)](JSON['stringify']({'isStatus':!0x1,'class':_0x4a1d8d[_0x1d9ed6(0x259)],'msg':_0x1d9ed6(0x16a)+_0x41d4d5+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}}if(_0x4a1d8d['wVAgx'](_0x36d096,_0x4a1d8d[_0x1d9ed6(0x116)]))var _0x226398=0xa;else{if(_0x4a1d8d[_0x1d9ed6(0x21d)](_0x36d096,_0x4a1d8d[_0x1d9ed6(0x1ad)]))var _0x226398=0x2;}const _0x6e8b3c=await _0x4a633b['updateOne'](_0x2c043c,{'$set':{'docStatusNumber':_0x226398}});var _0x1a8262=_0x102869+'\x20\x22'+_0x41d4d5+'\x22\x20เรียบร้อยแล้ว';if(_0x6e8b3c[_0x1d9ed6(0x265)]||_0x4a1d8d[_0x1d9ed6(0x249)](_0x6e8b3c['modifiedCount'],0x0)){if(_0x4a1d8d[_0x1d9ed6(0x1a2)](_0x4a1d8d[_0x1d9ed6(0x1fb)],_0x4a1d8d[_0x1d9ed6(0x1fb)]))_0x2f5fc4[_0x1d9ed6(0x17b)]();else{const _0x5bebab=_0x45e76b[_0x1d9ed6(0x10f)]({'docStatusNumber':_0x14526a},{'docStatusNumber':_0x226398});if(_0x4a1d8d[_0x1d9ed6(0x249)](_0x5bebab[_0x1d9ed6(0x241)],0x0)){if(_0x4a1d8d[_0x1d9ed6(0x1d2)](_0x4a1d8d[_0x1d9ed6(0x1c0)],_0x4a1d8d[_0x1d9ed6(0x28d)])){const _0x4c7184=_0x2c09cb[_0x1d9ed6(0x1f1)](_0x26ac08,arguments);return _0x51bd63=null,_0x4c7184;}else{const _0xfa7110={'dateTime':_0x4c70df[_0x1d9ed6(0x17d)](new Date()),'userId':_0x274712['userId'],'userFullname':_0x274712[_0x1d9ed6(0x19c)],'changes':_0x5bebab};await _0x4a633b['updateOne']({'docId':_0x41d4d5},{'$push':{'changesHistory':{'$each':[_0xfa7110],'$position':0x0}}}),_0x1a8262+=_0x4a1d8d[_0x1d9ed6(0x257)];}}return _0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x0,'docId':_0x41d4d5,'docStatusNumber':_0x226398,'class':_0x4a1d8d[_0x1d9ed6(0x14a)],'msg':_0x1a8262}));}}else{if(_0x6e8b3c['matchedCount']&&_0x4a1d8d['pCVfN'](_0x6e8b3c['modifiedCount'],0x1))return _0x269953['send'](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'docId':_0x41d4d5,'docStatusNumber':_0x14526a,'class':_0x4a1d8d[_0x1d9ed6(0x140)],'msg':'\x22'+_0x41d4d5+_0x1d9ed6(0x1d5)}));}}catch(_0xe684b9){console['log'](_0xe684b9),_0x269953[_0x1d9ed6(0x152)](JSON[_0x1d9ed6(0x1aa)]({'isStatus':!0x1,'class':_0x4a1d8d[_0x1d9ed6(0x259)],'msg':_0xe684b9[_0x1d9ed6(0x123)]}));}finally{_0x483af1[_0x1d9ed6(0x17b)]();}});export default b;function _0x5d69ec(_0x5cccaf){const _0x38800e=_0x8098dc,_0xdfa179={'JBMAB':function(_0x10e9be,_0x2186cb){return _0x10e9be===_0x2186cb;},'zQbJS':_0x38800e(0x18c),'GbqZM':_0x38800e(0x130),'kbIre':'counter','CaErS':function(_0x4b1658,_0x2462cc){return _0x4b1658!==_0x2462cc;},'cmget':function(_0x1d338e,_0x2b865e){return _0x1d338e+_0x2b865e;},'ADKvS':function(_0x46cfa8,_0x142575){return _0x46cfa8/_0x142575;},'SzSyO':_0x38800e(0x241),'vvXUZ':function(_0x3f3a2c,_0x1fb917){return _0x3f3a2c%_0x1fb917;},'AOaPN':function(_0x1979c7,_0xbf45){return _0x1979c7+_0xbf45;},'JEhmh':_0x38800e(0x24e),'DHAtZ':_0x38800e(0x14e),'aXGII':_0x38800e(0x147),'HjZXb':_0x38800e(0x1a7),'YpkGd':function(_0x1ebe42,_0x5db7e9){return _0x1ebe42(_0x5db7e9);},'AXNvn':function(_0x572169,_0x15e8fc){return _0x572169(_0x15e8fc);}};function _0x51e347(_0x1956fd){const _0x5ca3d8=_0x38800e;if(_0xdfa179['JBMAB'](typeof _0x1956fd,_0xdfa179['zQbJS']))return function(_0xc89f9d){}[_0x5ca3d8(0x246)](_0xdfa179['GbqZM'])['apply'](_0xdfa179['kbIre']);else _0xdfa179[_0x5ca3d8(0x159)](_0xdfa179[_0x5ca3d8(0x112)]('',_0xdfa179['ADKvS'](_0x1956fd,_0x1956fd))[_0xdfa179[_0x5ca3d8(0x12a)]],0x1)||_0xdfa179['JBMAB'](_0xdfa179[_0x5ca3d8(0x1ae)](_0x1956fd,0x14),0x0)?function(){return!![];}['constructor'](_0xdfa179[_0x5ca3d8(0x1cc)](_0xdfa179[_0x5ca3d8(0x223)],_0xdfa179['DHAtZ']))[_0x5ca3d8(0x26a)](_0xdfa179[_0x5ca3d8(0x21f)]):function(){return![];}[_0x5ca3d8(0x246)](_0xdfa179[_0x5ca3d8(0x1cc)](_0xdfa179['JEhmh'],_0xdfa179[_0x5ca3d8(0x26c)]))[_0x5ca3d8(0x1f1)](_0xdfa179[_0x5ca3d8(0x19b)]);_0xdfa179[_0x5ca3d8(0x188)](_0x51e347,++_0x1956fd);}try{if(_0x5cccaf)return _0x51e347;else _0xdfa179[_0x38800e(0x279)](_0x51e347,0x0);}catch(_0x2a3dbb){}}