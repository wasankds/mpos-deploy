const _0x8778ca=_0x55a4;(function(_0x125531,_0x31b933){const _0x1c0d45=_0x55a4,_0x418cf5=_0x125531();while(!![]){try{const _0x5eb63f=parseInt(_0x1c0d45(0x12c))/0x1*(-parseInt(_0x1c0d45(0x165))/0x2)+-parseInt(_0x1c0d45(0x121))/0x3+-parseInt(_0x1c0d45(0x14b))/0x4*(-parseInt(_0x1c0d45(0x1ce))/0x5)+-parseInt(_0x1c0d45(0x1aa))/0x6*(-parseInt(_0x1c0d45(0x15e))/0x7)+-parseInt(_0x1c0d45(0x110))/0x8*(parseInt(_0x1c0d45(0xca))/0x9)+-parseInt(_0x1c0d45(0x1bd))/0xa+-parseInt(_0x1c0d45(0x1ae))/0xb*(-parseInt(_0x1c0d45(0xf9))/0xc);if(_0x5eb63f===_0x31b933)break;else _0x418cf5['push'](_0x418cf5['shift']());}catch(_0x508be6){_0x418cf5['push'](_0x418cf5['shift']());}}}(_0x3fc6,0x75b9e));function _0x55a4(_0x304c56,_0x56f76c){const _0x24d380=_0x3fc6();return _0x55a4=function(_0x35721d,_0x1cd497){_0x35721d=_0x35721d-0xab;let _0xd86e61=_0x24d380[_0x35721d];return _0xd86e61;},_0x55a4(_0x304c56,_0x56f76c);}const _0x5ad495=(function(){const _0x31889a=_0x55a4,_0x348d58={'YSwON':_0x31889a(0xc3),'hmgIk':'red','AmXRd':function(_0x21e848,_0x54240a){return _0x21e848!==_0x54240a;},'QHMyE':'rCiUY','ihsTm':function(_0x4b5a11,_0x24ddf7){return _0x4b5a11===_0x24ddf7;},'GjBmt':_0x31889a(0xec),'GeOhg':_0x31889a(0x19e),'arCXv':function(_0x3bc9b1,_0x281cf8){return _0x3bc9b1+_0x281cf8;},'PVFuM':_0x31889a(0x1c0),'sQOAo':_0x31889a(0x1fb),'GiUnN':_0x31889a(0x205),'SvgLp':_0x31889a(0x1bc)};let _0x32292b=!![];return function(_0x1917a5,_0x35d4b8){const _0x4e3d0e=_0x31889a,_0x30edb6={'frdlH':_0x348d58[_0x4e3d0e(0x14e)],'EAAxC':_0x348d58['hmgIk'],'ihQmZ':function(_0x46658d,_0x3896c2){const _0x4d54bc=_0x4e3d0e;return _0x348d58[_0x4d54bc(0x183)](_0x46658d,_0x3896c2);},'diorr':_0x348d58[_0x4e3d0e(0xdf)],'YVcYU':function(_0x470f91,_0x4a7b9b){const _0x5f5b81=_0x4e3d0e;return _0x348d58[_0x5f5b81(0x20c)](_0x470f91,_0x4a7b9b);},'mLGUJ':_0x348d58[_0x4e3d0e(0x1f8)],'kGrGG':_0x348d58[_0x4e3d0e(0x13b)],'FaCCm':function(_0x2203d9,_0x180a78){const _0x5cf341=_0x4e3d0e;return _0x348d58[_0x5cf341(0xdb)](_0x2203d9,_0x180a78);},'sClnS':_0x348d58[_0x4e3d0e(0x135)],'sgyuI':_0x348d58[_0x4e3d0e(0x206)],'gPAzB':_0x348d58['GiUnN']};if(_0x348d58['ihsTm'](_0x348d58[_0x4e3d0e(0x155)],_0x348d58[_0x4e3d0e(0x155)])){const _0x5a179b=_0x32292b?function(){const _0x52e51b=_0x4e3d0e;if(_0x30edb6[_0x52e51b(0x12f)](_0x30edb6['diorr'],_0x30edb6['diorr']))_0x5e651c[_0x52e51b(0x1d2)](_0x30edb6[_0x52e51b(0x1c8)],_0x7c6ba),_0x566b30[_0x52e51b(0x1ee)](_0x3c57eb[_0x52e51b(0x178)]({'isPrint':!0x1,'class':_0x30edb6[_0x52e51b(0x22c)],'msg':_0x4d58b2[_0x52e51b(0x186)]}));else{if(_0x35d4b8){if(_0x30edb6[_0x52e51b(0xb3)](_0x30edb6[_0x52e51b(0x1cf)],_0x30edb6[_0x52e51b(0x1db)])){const _0x5205c8=_0x1285e5?function(){const _0x2c9f6b=_0x52e51b;if(_0x4b7206){const _0x2b72a7=_0x25609c[_0x2c9f6b(0xfa)](_0x3fc2c3,arguments);return _0x482a1e=null,_0x2b72a7;}}:function(){};return _0x453a2f=![],_0x5205c8;}else{const _0x4da697=_0x35d4b8[_0x52e51b(0xfa)](_0x1917a5,arguments);return _0x35d4b8=null,_0x4da697;}}}}:function(){};return _0x32292b=![],_0x5a179b;}else(function(){return!![];}['constructor'](_0x30edb6[_0x4e3d0e(0x159)](_0x30edb6[_0x4e3d0e(0x1ad)],_0x30edb6['sgyuI']))[_0x4e3d0e(0x19b)](_0x30edb6['gPAzB']));};}());(function(){const _0x361af5=_0x55a4,_0x224a63={'FaGEC':_0x361af5(0x214),'rfgVg':function(_0x101713,_0x3fc8f0){return _0x101713(_0x3fc8f0);},'gnFLY':function(_0x58c01b,_0x1a44d6){return _0x58c01b===_0x1a44d6;},'yOQvs':_0x361af5(0xf7),'ZnbDm':'function\x20*\x5c(\x20*\x5c)','MRQTc':_0x361af5(0x171),'cLXGX':_0x361af5(0x1a4),'gjonW':function(_0x597cbb,_0x5eaa71){return _0x597cbb+_0x5eaa71;},'RzmFa':_0x361af5(0x181),'xuObR':_0x361af5(0x119),'wiINv':function(_0x39688e,_0x331271){return _0x39688e!==_0x331271;},'XWEfb':_0x361af5(0x19f),'SjWsv':_0x361af5(0xad),'bdXcB':_0x361af5(0x193),'jUpwe':function(_0x7201dd){return _0x7201dd();},'VeYhm':function(_0x1b9950,_0xe5d537,_0x2ad20b){return _0x1b9950(_0xe5d537,_0x2ad20b);}};_0x224a63[_0x361af5(0x229)](_0x5ad495,this,function(){const _0x46f18f=_0x361af5,_0x44527e={'rucse':function(_0x130e1d,_0x81a6fc){const _0x3caf84=_0x55a4;return _0x224a63[_0x3caf84(0x1ed)](_0x130e1d,_0x81a6fc);}};if(_0x224a63[_0x46f18f(0x141)](_0x224a63['yOQvs'],_0x224a63[_0x46f18f(0x1ba)])){const _0x1e8736=new RegExp(_0x224a63[_0x46f18f(0x18e)]),_0x106f05=new RegExp(_0x224a63['MRQTc'],'i'),_0x5442d8=_0x224a63[_0x46f18f(0x1ed)](_0x41ef25,_0x224a63[_0x46f18f(0x21b)]);if(!_0x1e8736['test'](_0x224a63[_0x46f18f(0x1d3)](_0x5442d8,_0x224a63[_0x46f18f(0x11a)]))||!_0x106f05[_0x46f18f(0x122)](_0x224a63[_0x46f18f(0x1d3)](_0x5442d8,_0x224a63[_0x46f18f(0x182)]))){if(_0x224a63['wiINv'](_0x224a63[_0x46f18f(0x1c4)],_0x224a63[_0x46f18f(0x151)]))_0x224a63['rfgVg'](_0x5442d8,'0');else{if(_0x1df8b9)return _0x1580e4;else _0x44527e[_0x46f18f(0x21f)](_0x526cf8,0x0);}}else{if(_0x224a63[_0x46f18f(0x129)](_0x224a63[_0x46f18f(0xc6)],_0x224a63['bdXcB']))return _0x564863[_0x46f18f(0x1d2)](_0x4787c6),_0x4c01bc[_0x46f18f(0x1ee)](_0x48c922[_0x46f18f(0x178)]({'isSearch':!0x1,'class':_0x224a63[_0x46f18f(0xc1)],'msg':_0x52553e['message']}));else _0x224a63['jUpwe'](_0x41ef25);}}else{const _0x1a5aed=_0x499c33[_0x46f18f(0xfa)](_0x17c54c,arguments);return _0x464bbd=null,_0x1a5aed;}})();}());function _0x3fc6(){const _0x277c49=['tcSok','__proto__','getUserData','floor','udmHE','UcOeI','YjKhN','40jxutNH','sfqcg','{}.constructor(\x22return\x20this\x22)(\x20)','canEdit','close','otUDu','/status','emjFA','jpeg','input','RzmFa','ygXcp','โหลดเอกสารเลขที่\x20\x22','statusName','PATH_WAREHOUSE_IN','lVAQf','scrollHeight','1460793VwLawo','test','zJvJE','oXQyM','matchedCount','EuMFt','cancel','ENAxK','wiINv','{{sep}}หรือไม่มีสิทธิ์','Zqxnn','268zXfMQK','kOCAH','cXTBg','ihQmZ','ORZdM','puppeteer','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','image','green','PVFuM','zHCnP','aIJsO','JdUOM','GXEsj','tQjYu','GeOhg','Cvgnl','ePckY','\x20ไม่เปลี่ยนแปลง\x22','dateTimeCanEdit','TqNzg','gnFLY','BLupW','เอกสาร\x20\x22','PvRon','htdmt','bind','zJWEQ','warn','xqxqs','bFPGV','21532hKFjFx','PfvtE','YuFYH','YSwON','ไม่พบเอกสาร\x20\x22','documentElement','SjWsv','FBFCY','load-last','post','SvgLp','fIREb','JHBtc','counter','FaCCm','uzjaK','canCancel','renderView','/fetch/modal','21LLIIDZ','XbIVY','ukGoA','clientHeight','tJrgc','YXoHB','replace','6828nvlmAG','fdwfJ','RXUvo','stateObject','msKco','lcQKv','aFIFM','docStatusNumber','GqXwH','docTitle','print','yFNod','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','Deyee','NyrLs','Ohgfz','fQRpx','mFvbe','ไม่พบเอกสารล่าสุด','stringify','doc_print.ejs','PdZaf','fiYdz','jvPyB','hfOrI','KVKLT','function\x20*\x5c(\x20*\x5c)','constructor','chain','xuObR','AmXRd','rwQAV','NcLhL','message','TDwzo','Router','eTeZD','jTOYE','/load','image/jpeg','mzCFU','ZnbDm','offsetHeight','BXoGK','DjXzG','YeOmj','uuEvk','ttEkh','collection','nYEyw','jBhoL','dateTimeCancelRemain','scPsX','IriJA','call','tcJSQ','\x22\x20เรียบร้อยแล้ว','ftPSb','LlLIM','feoDN','hCOrR','QbJZg','console','init','XUNjv','GPRCB','XkQqe','DPXMk','length','1420566gtcBVp','.jpeg','dbUrl','sClnS','52712xJQrPC','includes','oExlK','XUnIp','qwkjx','vEMXz','KMCMi','ySwwk','/search','vNwir','Jnfuz','aweXR','yOQvs','getItems_for_Modal','iyCWG','5644440klnBfA','bvKjk','ยกเลิก','debu','rADwX','findOne','vHZEy','XWEfb','launch','GKLhl','leaUi','frdlH','branchId','OEfCm','YeRob','wUWcv','QGkBI','725OhvCRR','mLGUJ','setContent','VYYud','log','gjonW','tkoZU','eSjcE','table','NqMSu','exception','MshCE','EjoSo','kGrGG','UpDup','prototype','XWfgH','kQdof','stock','bBgPm','Qblxn','HpbmY','formatDateTime','zGMYL','jQhuy','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','eBkMd','sFoJw','CVTdW','max','SHXoW','rfgVg','send','YlSKp','Cvgxi','XECjX','CxRIe','MQSHe','check_DocDateTime_CanCancel','body','WQykz','toString','GjBmt','EOSEG','dateTimeCanCancel','gger','iCssK','info','esuGF','CfBms','formatDate','newPage','vAaQu','TJTzf','getMainDocPathObj','action','sQOAo','ugIrQ','check_DocDateTime_CanEdit','IXVQW','modifiedCount','PATH_SALES','ihsTm','return\x20(function()\x20','NWtcX','lGTSd','isAuth','MPzNz','alxPk','nBtgU','red','toArray','ajYLj','kvSon','ZgDUI','FBBBU','btQiO','cLXGX','prOUF','wSxll','get_StatusName_byStatusNumber','rucse','SqyvC','active','/changes','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','fUjDC','while\x20(true)\x20{}','XlYLC','NqSKP','/load-last','VeYhm','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','AKqVF','EAAxC','setViewport','vxQTC','trace','hEjJD','YYIhx','LjVqq','dsuhj','VnWUV','เอกสารที่ตันเองไม่ได้สร้าง','YVcYU','finish','JNgae','Rzzda','NHqla','dGPeo','originalUrl','RekcE','FRYXF','oveOn','UWLwz','DOC_TYPE','WxWvW','userAuthority','FaGEC','/print','error\x20===>\x20','HDCSf','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','bdXcB','Mtvfp','hkjJq','kBBQi','1233DeZZqv','yellow','TuNxx','updateOne','\x22\x20เอกสาร','QEMsY','zHkia','ไม่พบประวัติการเปลี่ยนแปลง','wjAmj','ZNSIW','warehouseIn','sVltZ','OTZHZ','changesHistory','uARTV','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','dbName','arCXv','rBECw','OyZhK','dateTimeEditRemain','QHMyE','xbqBB','zKsbB','eaMWo','nmXUv','HNppM','writeHead','ckGxO','PvpQK','YFDrA','PpZYE','xNcPG','\x22\x20{{sep}}เรียบร้อยแล้ว','WxTMD','ALHKF','MDTXW','ไม่พบเอกสารเลขที่\x20\x22','warehouseOut','igZnj','EhnZx','error','UoFar','jaIpy','fEBdb','mAVsj','zvIBs','2400uCRIRg','apply','get_Info_ByUrl','userId','HKajC','string','ScRIp','connect','BhbUi','DjCyo','aYAZj','LZVFT','wZMHh','evaluate','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','oXFIe'];_0x3fc6=function(){return _0x277c49;};return _0x3fc6();}const _0x1cd497=(function(){const _0x312e39=_0x55a4,_0x58e9d6={'sFoJw':function(_0xe7d5f4){return _0xe7d5f4();},'UpDup':function(_0x5d3521,_0x1cbf1f){return _0x5d3521(_0x1cbf1f);},'jBhoL':function(_0x397e74,_0x17f62c){return _0x397e74+_0x17f62c;},'HwQeC':_0x312e39(0x20d),'QEMsY':_0x312e39(0x112),'XbIVY':function(_0x20184c){return _0x20184c();},'tQjYu':function(_0x43d1fe,_0x4d538e){return _0x43d1fe===_0x4d538e;},'AfqmV':_0x312e39(0x102),'uARTV':_0x312e39(0x1e5),'btQiO':_0x312e39(0x103),'ogjEt':_0x312e39(0x12d),'iCssK':function(_0x369872,_0x4728b4){return _0x369872!==_0x4728b4;},'zJWEQ':_0x312e39(0x216),'zKsbB':_0x312e39(0x176)};let _0x34765a=!![];return function(_0x201d8e,_0x3f6f2d){const _0x3b451f=_0x312e39,_0x76e75={'SGxxI':function(_0x4a8b74,_0x2079eb){const _0x88a55c=_0x55a4;return _0x58e9d6[_0x88a55c(0x1dc)](_0x4a8b74,_0x2079eb);},'jEQJG':function(_0x4bf43c,_0x96bc5){const _0x710aed=_0x55a4;return _0x58e9d6[_0x710aed(0x197)](_0x4bf43c,_0x96bc5);},'ZgDUI':function(_0x53243d,_0x3cfa25){return _0x58e9d6['jBhoL'](_0x53243d,_0x3cfa25);},'SHXoW':_0x58e9d6['HwQeC'],'lVAQf':_0x58e9d6[_0x3b451f(0xcf)],'RekcE':function(_0xbe3ca7){const _0x20391b=_0x3b451f;return _0x58e9d6[_0x20391b(0x15f)](_0xbe3ca7);},'aFIFM':function(_0x9ababb,_0x4e116a){const _0x255c02=_0x3b451f;return _0x58e9d6[_0x255c02(0x13a)](_0x9ababb,_0x4e116a);},'sfqcg':_0x58e9d6['AfqmV'],'nYEyw':_0x58e9d6[_0x3b451f(0xd8)],'XlYLC':_0x58e9d6[_0x3b451f(0x21a)],'LksVJ':_0x58e9d6['ogjEt']};if(_0x58e9d6[_0x3b451f(0x1fc)](_0x58e9d6[_0x3b451f(0x147)],_0x58e9d6[_0x3b451f(0xe1)])){const _0x31ce1d=_0x34765a?function(){const _0x3808f9=_0x3b451f;if(_0x76e75[_0x3808f9(0x16b)](_0x76e75[_0x3808f9(0x111)],_0x76e75[_0x3808f9(0x196)])){const _0x7bc316=_0x76e75['SGxxI'](_0x4c60c2,_0x76e75['jEQJG'](_0x76e75[_0x3808f9(0x218)](_0x76e75[_0x3808f9(0x1ec)],_0x76e75[_0x3808f9(0x11f)]),');'));_0x2e8b3e=_0x76e75[_0x3808f9(0xba)](_0x7bc316);}else{if(_0x3f6f2d){if(_0x76e75[_0x3808f9(0x16b)](_0x76e75[_0x3808f9(0x226)],_0x76e75['LksVJ']))return _0x2f8e54;else{const _0xa1bb79=_0x3f6f2d['apply'](_0x201d8e,arguments);return _0x3f6f2d=null,_0xa1bb79;}}}}:function(){};return _0x34765a=![],_0x31ce1d;}else _0x58e9d6[_0x3b451f(0x1e9)](_0x28a42f);};}()),_0x35721d=_0x1cd497(this,function(){const _0x3815e3=_0x55a4,_0x41b9db={'MxRoK':_0x3815e3(0x214),'aExSj':function(_0x12c90a,_0x13865e){return _0x12c90a===_0x13865e;},'OEfCm':_0x3815e3(0xb6),'kvSon':'tGmnl','vxQTC':function(_0x5f0c70,_0x123ab0){return _0x5f0c70(_0x123ab0);},'BhbUi':function(_0x336c02,_0x5b0b30){return _0x336c02+_0x5b0b30;},'ScRIp':_0x3815e3(0x20d),'otUDu':_0x3815e3(0x112),'MPzNz':function(_0x4990fc){return _0x4990fc();},'PdZaf':function(_0x169dfe,_0x7cef19){return _0x169dfe!==_0x7cef19;},'JdUOM':'bfNun','BXoGK':_0x3815e3(0x1d2),'zJvJE':'warn','yFNod':_0x3815e3(0x1fd),'xbqBB':_0x3815e3(0xf3),'SwWiR':_0x3815e3(0x1d8),'UWLwz':_0x3815e3(0x1d6),'XkQqe':'trace','nmXUv':function(_0x38786d,_0x552d47){return _0x38786d<_0x552d47;},'eTeZD':function(_0x33d91b,_0xb675a6){return _0x33d91b!==_0xb675a6;},'Zqxnn':'ccltR'};let _0x306cac;try{if(_0x41b9db['aExSj'](_0x41b9db[_0x3815e3(0x1ca)],_0x41b9db[_0x3815e3(0x217)]))return!![];else{const _0x21385b=_0x41b9db[_0x3815e3(0xab)](Function,_0x41b9db['BhbUi'](_0x41b9db[_0x3815e3(0x101)](_0x41b9db[_0x3815e3(0xff)],_0x41b9db[_0x3815e3(0x115)]),');'));_0x306cac=_0x41b9db[_0x3815e3(0x211)](_0x21385b);}}catch(_0x273a18){if(_0x41b9db[_0x3815e3(0x17a)](_0x41b9db[_0x3815e3(0x138)],_0x41b9db[_0x3815e3(0x138)])){const _0x20803c=_0x1b124d[_0x3815e3(0x1f5)],_0xe0ce03=_0xa38ea0[_0x3815e3(0x150)];return _0x4f5567[_0x3815e3(0x1eb)](_0x20803c[_0x3815e3(0x120)],_0x20803c[_0x3815e3(0x18f)],_0xe0ce03[_0x3815e3(0x161)],_0xe0ce03[_0x3815e3(0x120)],_0xe0ce03[_0x3815e3(0x18f)]);}else _0x306cac=window;}const _0x5cdbcc=_0x306cac[_0x3815e3(0x1a3)]=_0x306cac[_0x3815e3(0x1a3)]||{},_0xa8a555=[_0x41b9db[_0x3815e3(0x190)],_0x41b9db[_0x3815e3(0x123)],_0x41b9db[_0x3815e3(0x170)],_0x41b9db[_0x3815e3(0xe0)],_0x41b9db['SwWiR'],_0x41b9db[_0x3815e3(0xbd)],_0x41b9db[_0x3815e3(0x1a7)]];for(let _0x21c393=0x0;_0x41b9db[_0x3815e3(0xe3)](_0x21c393,_0xa8a555[_0x3815e3(0x1a9)]);_0x21c393++){if(_0x41b9db[_0x3815e3(0x189)](_0x41b9db['Zqxnn'],_0x41b9db[_0x3815e3(0x12b)]))return _0x4f5841[_0x3815e3(0x1d2)](_0xc81db2),_0x4b2af7[_0x3815e3(0x1ee)](_0x1dd419[_0x3815e3(0x178)]({'isFetch':!0x1,'class':_0x41b9db['MxRoK'],'msg':_0x1bfa69[_0x3815e3(0x186)]}));else{const _0x501468=_0x1cd497[_0x3815e3(0x180)][_0x3815e3(0x1dd)]['bind'](_0x1cd497),_0x4a6b17=_0xa8a555[_0x21c393],_0x1420d1=_0x5cdbcc[_0x4a6b17]||_0x501468;_0x501468[_0x3815e3(0x10a)]=_0x1cd497[_0x3815e3(0x146)](_0x1cd497),_0x501468['toString']=_0x1420d1[_0x3815e3(0x1f7)][_0x3815e3(0x146)](_0x1420d1),_0x5cdbcc[_0x4a6b17]=_0x501468;}}});_0x35721d();import _0x4c6689 from'express';const b=_0x4c6689[_0x8778ca(0x188)]();import _0x44e93e from'path';import{MongoClient as _0xde4953}from'mongodb';import _0xe6b8f1 from'../middleware/mainAuth.js';import*as _0x4fd245 from'../mymodule/myUsers.js';import*as _0x521e47 from'../mymodule/myDateTime.js';import*as _0x230d9b from'../mymodule/myModule.js';import*as _0x5a7f32 from'../mymodule/myDocMain.js';import*as _0x12e720 from'../mymodule/myData.js';const w=global[_0x8778ca(0x11e)],S=global['PATH_WAREHOUSE_OUT'],p=global[_0x8778ca(0x20b)],M=[w+_0x8778ca(0x222),S+'/changes',p+'/changes'],v=[w+'/print',S+_0x8778ca(0xc2),p+_0x8778ca(0xc2)],k=[w+_0x8778ca(0x116),S+'/status',p+'/status'],B=[w+_0x8778ca(0x1b6),S+'/search',p+_0x8778ca(0x1b6)],x=[w+_0x8778ca(0x18b),S+_0x8778ca(0x18b),p+'/load',w+'/load-last',S+_0x8778ca(0x228),p+_0x8778ca(0x228)],L=[w+_0x8778ca(0x15d),S+_0x8778ca(0x15d),p+_0x8778ca(0x15d)];b['get'](L,_0xe6b8f1[_0x8778ca(0x210)],async(_0x4f5cf7,_0xcb4c87)=>{const _0x449757=_0x8778ca,_0x1e2df7={'Deyee':_0x449757(0x17f),'ybYzL':_0x449757(0x171),'esuGF':function(_0x1f3e74,_0x526c76){return _0x1f3e74(_0x526c76);},'xqxqs':_0x449757(0x1a4),'jvPyB':function(_0x134a20,_0x197949){return _0x134a20+_0x197949;},'udmHE':_0x449757(0x181),'BdHOc':function(_0x47b0eb,_0x1892d7){return _0x47b0eb+_0x1892d7;},'NyrLs':_0x449757(0x119),'EOSEG':function(_0x1b156d){return _0x1b156d();},'eSjcE':function(_0x4f127e,_0x247d58){return _0x4f127e!==_0x247d58;},'HpbmY':'iCPNn','rADwX':function(_0x2cf8cf,_0x31860f){return _0x2cf8cf==_0x31860f;},'HKajC':_0x449757(0xd4),'PvpQK':_0x449757(0x1e0),'DDJBi':_0x449757(0xf0),'SqyvC':'sales','ttEkh':_0x449757(0x221),'YXoHB':_0x449757(0x134),'NKYRZ':_0x449757(0x107),'YFDrA':function(_0x41615f,_0x3d6bd4){return _0x41615f===_0x3d6bd4;},'UcOeI':_0x449757(0x1d9),'cXTBg':_0x449757(0xf4),'zvIBs':_0x449757(0x214)},_0x2a33c7=await _0x4fd245[_0x449757(0x10b)](_0x4f5cf7),_0xf493ef=await _0x5a7f32[_0x449757(0x204)](_0x4f5cf7,_0xcb4c87,_0x2a33c7['userAuthority']);try{if(_0x1e2df7[_0x449757(0x1d5)](_0x1e2df7[_0x449757(0x1e3)],_0x1e2df7[_0x449757(0x1e3)])){if(_0x528e7f){const _0x5bcfc4=_0x404b1f[_0x449757(0xfa)](_0x65dd3d,arguments);return _0x3a7f4e=null,_0x5bcfc4;}}else{if(_0x1e2df7['rADwX'](_0xf493ef[_0x449757(0xbe)],_0x1e2df7[_0x449757(0xfd)]))var _0x507b4f=await _0x12e720[_0x449757(0x1bb)](_0x1e2df7[_0x449757(0xe7)]);else{if(_0x1e2df7[_0x449757(0x1c1)](_0xf493ef[_0x449757(0xbe)],_0x1e2df7['DDJBi']))var _0x507b4f=await _0x12e720[_0x449757(0x1bb)](_0x1e2df7[_0x449757(0xe7)]);else{if(_0x1e2df7[_0x449757(0x1c1)](_0xf493ef[_0x449757(0xbe)],_0x1e2df7[_0x449757(0x220)]))var _0x507b4f=await _0x12e720['getItems_for_Modal'](_0x1e2df7[_0x449757(0x194)]);}}const _0x527b00=await _0x12e720['getItemsCategory']();return _0xcb4c87['send'](JSON[_0x449757(0x178)]({'DATA_ITEMS':_0x507b4f,'DATA_CATEGORY':_0x527b00,'isFetch':!0x0,'class':_0x1e2df7[_0x449757(0x163)],'msg':_0x1e2df7['NKYRZ']}));}}catch(_0x43d40f){if(_0x1e2df7[_0x449757(0xe8)](_0x1e2df7[_0x449757(0x10e)],_0x1e2df7[_0x449757(0x12e)])){const _0x1d5bbd=new _0x3e337b(nYQBRp[_0x449757(0x172)]),_0x454c0f=new _0x5602f7(nYQBRp['ybYzL'],'i'),_0x3580f3=nYQBRp[_0x449757(0x1fe)](_0x73d431,nYQBRp[_0x449757(0x149)]);!_0x1d5bbd['test'](nYQBRp[_0x449757(0x17c)](_0x3580f3,nYQBRp[_0x449757(0x10d)]))||!_0x454c0f[_0x449757(0x122)](nYQBRp['BdHOc'](_0x3580f3,nYQBRp[_0x449757(0x173)]))?nYQBRp[_0x449757(0x1fe)](_0x3580f3,'0'):nYQBRp[_0x449757(0x1f9)](_0x16c8b5);}else return console[_0x449757(0x1d2)](_0x43d40f),_0xcb4c87[_0x449757(0x1ee)](JSON[_0x449757(0x178)]({'isFetch':!0x1,'class':_0x1e2df7[_0x449757(0xf8)],'msg':_0x43d40f[_0x449757(0x186)]}));}}),b[_0x8778ca(0x154)](B,_0xe6b8f1[_0x8778ca(0x210)],async(_0x2fdc59,_0x334cdd)=>{const _0x2250e1=_0x8778ca,_0x35bfed={'Mtvfp':_0x2250e1(0xc3),'EuMFt':_0x2250e1(0x214),'FBBBU':function(_0xec7b89,_0xffbac){return _0xec7b89<_0xffbac;},'oveOn':_0x2250e1(0xcb),'RXUvo':'กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','prOUF':function(_0x280c63,_0xad91e5){return _0x280c63===_0xad91e5;},'zHkia':_0x2250e1(0x1f3),'KVKLT':_0x2250e1(0x1e7),'NqMSu':function(_0x54931b,_0x30e8f9){return _0x54931b+_0x30e8f9;},'ZNSIW':_0x2250e1(0x134),'HDCSf':function(_0x361c17,_0x4ddec6){return _0x361c17!==_0x4ddec6;},'KMCMi':_0x2250e1(0xf5),'sVltZ':_0x2250e1(0xb0),'ySwwk':_0x2250e1(0x144)};let {sip:_0x3cb9c9}=_0x2fdc59[_0x2250e1(0x1f5)];if(!_0x3cb9c9&&_0x35bfed[_0x2250e1(0x219)](_0x3cb9c9[_0x2250e1(0x1a9)],0x2))return _0x334cdd[_0x2250e1(0x1ee)](JSON[_0x2250e1(0x178)]({'isSearch':!0x1,'class':_0x35bfed[_0x2250e1(0xbc)],'msg':_0x35bfed[_0x2250e1(0x167)]}));_0x3cb9c9=_0x3cb9c9['replace'](/[!@#$%^&*<>]/g,'')??null;const _0x349aa3=await _0x4fd245[_0x2250e1(0x10b)](_0x2fdc59);await _0x5a7f32['getMainDocPathObj'](_0x2fdc59,_0x334cdd,_0x349aa3[_0x2250e1(0xc0)]);const {collectionName:_0x30dde9}=_0x12e720['get_Info_ByUrl'](_0x2fdc59[_0x2250e1(0xb9)]),_0x5e14af=new _0xde4953(global[_0x2250e1(0x1ac)]);try{if(_0x35bfed[_0x2250e1(0x21c)](_0x35bfed[_0x2250e1(0xd0)],_0x35bfed[_0x2250e1(0xd0)])){await _0x5e14af[_0x2250e1(0x100)]();const _0x3fb080=_0x5e14af['db'](global[_0x2250e1(0xda)])[_0x2250e1(0x195)](_0x30dde9),_0x1d500d=[{'$or':[{'docId':{'$regex':_0x3cb9c9,'$options':'i'}},{'docDate':{'$regex':_0x3cb9c9,'$options':'i'}}]}];let _0x405bd3='';['O','S'][_0x2250e1(0x1af)](_0x349aa3[_0x2250e1(0xc0)])||(_0x405bd3+=_0x35bfed[_0x2250e1(0x17e)],_0x1d500d['push']({'userId':_0x349aa3[_0x2250e1(0xfc)]}));const _0x2ba31e=await _0x3fb080['aggregate']([{'$match':{'$and':_0x1d500d}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x2250e1(0x215)]();return _0x405bd3=_0x35bfed[_0x2250e1(0x1d7)]('พบ\x20\x22'+_0x2ba31e[_0x2250e1(0x1a9)]+_0x2250e1(0xce),_0x405bd3),_0x334cdd['send'](JSON['stringify']({'searchFound':_0x2ba31e,'msg':_0x405bd3,'isSearch':!0x0,'class':_0x35bfed[_0x2250e1(0xd3)]}));}else _0xd98b5b[_0x2250e1(0x114)]();}catch(_0x106e1b){if(_0x35bfed[_0x2250e1(0xc4)](_0x35bfed[_0x2250e1(0x1b4)],_0x35bfed[_0x2250e1(0xd5)]))return console['log'](_0x106e1b),_0x334cdd[_0x2250e1(0x1ee)](JSON[_0x2250e1(0x178)]({'isSearch':!0x1,'class':_0x35bfed[_0x2250e1(0x126)],'msg':_0x106e1b[_0x2250e1(0x186)]}));else _0x2cbd15['close']();}finally{_0x35bfed[_0x2250e1(0x21c)](_0x35bfed[_0x2250e1(0x1b5)],_0x35bfed[_0x2250e1(0x1b5)])?_0x5e14af[_0x2250e1(0x114)]():(_0x55d0e7[_0x2250e1(0x1d2)](_0x35bfed[_0x2250e1(0xc7)],_0x1aa356),_0x451f36[_0x2250e1(0x1ee)](_0x542438['stringify']({'isPrint':!0x1,'class':_0x35bfed[_0x2250e1(0x126)],'msg':_0x3fcea7['message']})));}}),b[_0x8778ca(0x154)](x,_0xe6b8f1[_0x8778ca(0x210)],async(_0x4ce0dd,_0x410612)=>{const _0x19aee3=_0x8778ca,_0x238bc9={'uzjaK':function(_0x998939,_0x5364c2){return _0x998939(_0x5364c2);},'jIhFR':function(_0x40d33d,_0x4781e9){return _0x40d33d+_0x4781e9;},'AesmS':_0x19aee3(0x1c0),'nTBJx':_0x19aee3(0x1fb),'emjFA':_0x19aee3(0x168),'qwkjx':_0x19aee3(0x17f),'DPXMk':_0x19aee3(0x171),'OTZHZ':_0x19aee3(0x1a4),'WxCWX':'chain','GKLhl':_0x19aee3(0x119),'Jnfuz':function(_0x44d991){return _0x44d991();},'TDwzo':function(_0x7a1201,_0x1269b9,_0x58b391){return _0x7a1201(_0x1269b9,_0x58b391);},'AKqVF':_0x19aee3(0x225),'NcLhL':_0x19aee3(0x158),'oXQyM':'red','rwQAV':function(_0x1c5809,_0x31f2e0){return _0x1c5809===_0x31f2e0;},'TJTzf':_0x19aee3(0x1de),'GPRCB':'vcRIl','vNwir':'load','fQRpx':function(_0x4db674,_0x117214){return _0x4db674!==_0x117214;},'FBFCY':_0x19aee3(0x14c),'wUWcv':_0x19aee3(0x153),'hkjJq':_0x19aee3(0x177),'dGPeo':function(_0x21a417,_0x138540){return _0x21a417==_0x138540;},'htdmt':_0x19aee3(0x160),'ygXcp':_0x19aee3(0xd9),'UEUfb':function(_0x50b272,_0x4df9dd){return _0x50b272===_0x4df9dd;},'CfBms':'ZiwYZ','mQQFh':_0x19aee3(0x1b3),'elNvY':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','scPsX':'green','ORZdM':'YWwej','XJfvH':_0x19aee3(0x1c3),'fIREb':_0x19aee3(0x140)};let {docId:_0x822736,action:_0x39df19}=_0x4ce0dd[_0x19aee3(0x1f5)];const _0x31bb58=await _0x4fd245[_0x19aee3(0x10b)](_0x4ce0dd);await _0x5a7f32[_0x19aee3(0x204)](_0x4ce0dd,_0x410612,_0x31bb58[_0x19aee3(0xc0)]);const {collectionName:_0x24b15d}=_0x12e720['get_Info_ByUrl'](_0x4ce0dd[_0x19aee3(0xb9)]),_0x168ff4=new _0xde4953(global[_0x19aee3(0x1ac)]);try{if(_0x238bc9[_0x19aee3(0x184)](_0x238bc9[_0x19aee3(0x203)],_0x238bc9[_0x19aee3(0x1a6)]))CbdXZZ[_0x19aee3(0x15a)](_0x4e6626,0x0);else{await _0x168ff4[_0x19aee3(0x100)]();const _0x3942c6=_0x168ff4['db'](global[_0x19aee3(0xda)])[_0x19aee3(0x195)](_0x24b15d);if(_0x238bc9[_0x19aee3(0x184)](_0x39df19,_0x238bc9[_0x19aee3(0x1b7)])){if(_0x238bc9[_0x19aee3(0x175)](_0x238bc9[_0x19aee3(0x152)],_0x238bc9['FBFCY']))(function(){return![];}[_0x19aee3(0x180)](CbdXZZ['jIhFR'](CbdXZZ['AesmS'],CbdXZZ['nTBJx']))['apply'](CbdXZZ[_0x19aee3(0x117)]));else{const _0x43a661=['O','S'][_0x19aee3(0x1af)](_0x31bb58[_0x19aee3(0xc0)])?{'docId':_0x822736}:{'docId':_0x822736,'userId':_0x31bb58[_0x19aee3(0xfc)]};var _0x5c7a31=await _0x3942c6[_0x19aee3(0x1c2)](_0x43a661,{'projection':{'_id':0x0,'changesHistory':0x0}});}}else{if(_0x238bc9['rwQAV'](_0x39df19,_0x238bc9[_0x19aee3(0x1cc)]))var _0x5c7a31=await _0x3942c6[_0x19aee3(0x1c2)]({'userId':_0x31bb58[_0x19aee3(0xfc)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x194a42=_0x5c7a31?'':_0x238bc9['rwQAV'](_0x39df19,_0x238bc9[_0x19aee3(0x1b7)])?_0x19aee3(0xef)+_0x822736+'\x22':_0x238bc9[_0x19aee3(0xc8)];if(!_0x5c7a31)return _0x410612['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x238bc9[_0x19aee3(0x124)],'msg':_0x194a42}));let _0xc5ab2=_0x19aee3(0x11c)+_0x5c7a31['docId']+_0x19aee3(0xeb);if(_0x238bc9[_0x19aee3(0xb8)](_0x5c7a31[_0x19aee3(0x16c)],0x1)&&_0x5c7a31[_0x19aee3(0x13f)]){if(_0x238bc9[_0x19aee3(0x184)](_0x238bc9['htdmt'],_0x238bc9[_0x19aee3(0x145)])){let _0x6e1ec7=await _0x12e720[_0x19aee3(0x208)](_0x5c7a31,_0x24b15d,_0x31bb58[_0x19aee3(0xfc)]);_0x5c7a31[_0x19aee3(0xde)]=_0x6e1ec7['dateTimeEditRemain'],_0x238bc9[_0x19aee3(0xb8)](_0x6e1ec7[_0x19aee3(0x113)],!0x1)&&(_0x5c7a31['docStatusNumber']=_0x6e1ec7[_0x19aee3(0x16c)],_0xc5ab2+=_0x238bc9[_0x19aee3(0x11b)]);}else _0x434a04=_0x5cb7a8;}else _0x5c7a31[_0x19aee3(0xde)]='-';if((_0x238bc9[_0x19aee3(0xb8)](_0x5c7a31[_0x19aee3(0x16c)],0x1)||_0x238bc9[_0x19aee3(0xb8)](_0x5c7a31['docStatusNumber'],0x2))&&_0x5c7a31[_0x19aee3(0x1fa)]){if(_0x238bc9['UEUfb'](_0x238bc9[_0x19aee3(0x1ff)],_0x238bc9['mQQFh'])){const _0x1be4c0={'VYYud':CbdXZZ[_0x19aee3(0x1b2)],'ALHKF':CbdXZZ[_0x19aee3(0x1a8)],'EjoSo':function(_0x4e5c50,_0x4b3965){const _0xb116f2=_0x19aee3;return CbdXZZ[_0xb116f2(0x15a)](_0x4e5c50,_0x4b3965);},'DLbaj':CbdXZZ[_0x19aee3(0xd6)],'VnWUV':function(_0x4340d4,_0x1131be){return CbdXZZ['jIhFR'](_0x4340d4,_0x1131be);},'FRYXF':CbdXZZ['WxCWX'],'GXEsj':CbdXZZ[_0x19aee3(0x1c6)],'eaMWo':function(_0xac2f1f){const _0x9b812e=_0x19aee3;return CbdXZZ[_0x9b812e(0x1b8)](_0xac2f1f);}};CbdXZZ[_0x19aee3(0x187)](_0x3eb4b9,this,function(){const _0x4ec594=_0x19aee3,_0x5e0608=new _0x5ebd18(_0x1be4c0[_0x4ec594(0x1d1)]),_0xeefd24=new _0x389171(_0x1be4c0[_0x4ec594(0xed)],'i'),_0x45301f=_0x1be4c0[_0x4ec594(0x1da)](_0x42669b,_0x1be4c0['DLbaj']);!_0x5e0608[_0x4ec594(0x122)](_0x1be4c0[_0x4ec594(0xb1)](_0x45301f,_0x1be4c0[_0x4ec594(0xbb)]))||!_0xeefd24[_0x4ec594(0x122)](_0x1be4c0[_0x4ec594(0xb1)](_0x45301f,_0x1be4c0[_0x4ec594(0x139)]))?_0x1be4c0[_0x4ec594(0x1da)](_0x45301f,'0'):_0x1be4c0[_0x4ec594(0xe2)](_0x2c6b87);})();}else{const _0x322065=await _0x12e720['check_DocDateTime_CanCancel'](_0x5c7a31,_0x24b15d,_0x31bb58[_0x19aee3(0xfc)]);_0x5c7a31[_0x19aee3(0x198)]=_0x322065['dateTimeCancelRemain'],_0x238bc9['dGPeo'](_0x322065[_0x19aee3(0x15b)],!0x1)&&(_0xc5ab2+=_0x238bc9['elNvY']);}}else _0x5c7a31[_0x19aee3(0x198)]='-';const {branchName:_0x42da75}=await _0x12e720['getUserBranchesById'](_0x5c7a31[_0x19aee3(0x1c9)]);return _0x5c7a31['branchName']=_0x42da75,_0x410612[_0x19aee3(0x1ee)](JSON['stringify']({'doc':_0x5c7a31,'isLoad':!0x0,'class':_0x238bc9[_0x19aee3(0x199)],'msg':_0xc5ab2}));}}catch(_0x4c4733){return _0x238bc9[_0x19aee3(0x184)](_0x238bc9[_0x19aee3(0x130)],_0x238bc9['XJfvH'])?function(_0x3d6516){}[_0x19aee3(0x180)](CbdXZZ[_0x19aee3(0x22b)])[_0x19aee3(0xfa)](CbdXZZ[_0x19aee3(0x185)]):(console[_0x19aee3(0x1d2)](_0x4c4733),_0x410612[_0x19aee3(0x1ee)](JSON[_0x19aee3(0x178)]({'isLoad':!0x1,'class':_0x238bc9['oXQyM'],'msg':_0x4c4733[_0x19aee3(0x186)]})));}finally{if(_0x238bc9[_0x19aee3(0x175)](_0x238bc9[_0x19aee3(0x156)],_0x238bc9[_0x19aee3(0x156)]))return _0xa866b5[_0x19aee3(0x1d2)](_0x31e579),_0xde863d[_0x19aee3(0x1ee)](_0x2660e1[_0x19aee3(0x178)]({'isLoad':!0x1,'class':_0x238bc9[_0x19aee3(0x124)],'msg':_0x2524c2[_0x19aee3(0x186)]}));else _0x168ff4['close']();}}),b[_0x8778ca(0x154)](M,_0xe6b8f1[_0x8778ca(0x210)],async(_0x16610,_0x186443)=>{const _0x83dc62=_0x8778ca,_0x67e6a9={'fUjDC':_0x83dc62(0x214),'WQykz':function(_0x4b48b9,_0x28ef7d){return _0x4b48b9===_0x28ef7d;},'rBECw':_0x83dc62(0x1cd),'wdaCW':_0x83dc62(0x109),'PpZYE':function(_0x1296ef,_0x283b73){return _0x1296ef<_0x283b73;},'leaUi':_0x83dc62(0xcb),'Ohgfz':_0x83dc62(0xd1),'qhRuy':'doc_changes.ejs','msKco':_0x83dc62(0x134),'qciyr':_0x83dc62(0x108),'igZnj':'TCrRy','fdwfJ':_0x83dc62(0xc3),'tkoZU':'flruv','qcBLv':_0x83dc62(0x136)},{docId:_0x4cb0c9}=_0x16610['body'],_0x1e47f5=await _0x4fd245[_0x83dc62(0x10b)](_0x16610);await _0x5a7f32[_0x83dc62(0x204)](_0x16610,_0x186443,_0x1e47f5[_0x83dc62(0xc0)]);const {collectionName:_0x3af23b}=_0x12e720[_0x83dc62(0xfb)](_0x16610[_0x83dc62(0xb9)]),_0x5bc0db=new _0xde4953(global['dbUrl']);try{if(_0x67e6a9['WQykz'](_0x67e6a9[_0x83dc62(0xdc)],_0x67e6a9['wdaCW']))_0xbcae01[_0x83dc62(0x114)]();else{await _0x5bc0db[_0x83dc62(0x100)]();var _0x258d67=await _0x5bc0db['db'](global[_0x83dc62(0xda)])[_0x83dc62(0x195)](_0x3af23b)['findOne']({'docId':_0x4cb0c9});if(!_0x258d67)return _0x186443[_0x83dc62(0x1ee)](JSON[_0x83dc62(0x178)]({'isPrint':!0x1,'class':_0x67e6a9[_0x83dc62(0x224)],'msg':_0x83dc62(0xef)+_0x4cb0c9+'\x22'}));const _0x281da2=_0x258d67[_0x83dc62(0xd7)]||[];if(_0x67e6a9[_0x83dc62(0xe9)](_0x281da2[_0x83dc62(0x1a9)],0x1))return _0x186443[_0x83dc62(0x1ee)](JSON[_0x83dc62(0x178)]({'isPrint':!0x1,'class':_0x67e6a9[_0x83dc62(0x1c7)],'msg':_0x67e6a9[_0x83dc62(0x174)]}));const _0x5c7000=_0x44e93e['join'](folderForms,_0x67e6a9['qhRuy']),_0x2b9c00=await _0x230d9b[_0x83dc62(0x15c)](_0x5c7000,_0x186443,{'title':_0x258d67['docId'],'time':_0x521e47[_0x83dc62(0x200)](new Date()),'changesHistory':_0x281da2});_0x186443['send'](JSON[_0x83dc62(0x178)]({'isPrint':!0x0,'class':_0x67e6a9[_0x83dc62(0x169)],'htmlPage':_0x2b9c00}));}}catch(_0x42f068){if(_0x67e6a9[_0x83dc62(0x1f6)](_0x67e6a9['qciyr'],_0x67e6a9[_0x83dc62(0xf1)])){const _0x5aba05=_0x518b7c?function(){if(_0x1cebaf){const _0x479137=_0xcedc91['apply'](_0x218cb7,arguments);return _0x198b72=null,_0x479137;}}:function(){};return _0x467ec3=![],_0x5aba05;}else console[_0x83dc62(0x1d2)](_0x67e6a9[_0x83dc62(0x166)],_0x42f068),_0x186443[_0x83dc62(0x1ee)](JSON['stringify']({'isPrint':!0x1,'class':_0x67e6a9[_0x83dc62(0x224)],'msg':_0x42f068[_0x83dc62(0x186)]}));}finally{_0x67e6a9['WQykz'](_0x67e6a9[_0x83dc62(0x1d4)],_0x67e6a9['qcBLv'])?(_0x4f993a[_0x83dc62(0x1d2)](_0x169843),_0x1685da[_0x83dc62(0x1ee)](_0x2b4fbc[_0x83dc62(0x178)]({'isStatus':!0x1,'class':_0x67e6a9[_0x83dc62(0x224)],'msg':_0xa43993[_0x83dc62(0x186)]}))):_0x5bc0db['close']();}}),b[_0x8778ca(0x154)](v,_0xe6b8f1[_0x8778ca(0x210)],async(_0x44b701,_0x49e0cb)=>{const _0x16375e=_0x8778ca,_0x4e57ca={'LZVFT':function(_0x174481,_0x1b4833){return _0x174481===_0x1b4833;},'CxRIe':_0x16375e(0x1e2),'HNppM':_0x16375e(0x1e6),'DjXzG':function(_0x3ebb1,_0xcfdb64){return _0x3ebb1(_0xcfdb64);},'cGHwS':function(_0x45a1c2,_0x10b9b2){return _0x45a1c2+_0x10b9b2;},'rZfJC':function(_0x414a94,_0x2bbe67){return _0x414a94+_0x2bbe67;},'NWtcX':_0x16375e(0x20d),'ePckY':_0x16375e(0x112),'pivup':function(_0x49e80d){return _0x49e80d();},'YlSKp':_0x16375e(0x1d2),'kBBQi':_0x16375e(0x148),'OyZhK':'info','BLupW':_0x16375e(0xf3),'tIhkn':_0x16375e(0x1d8),'MDTXW':_0x16375e(0x1d6),'Cvgnl':_0x16375e(0xac),'aweXR':function(_0xcd8127,_0x33b097){return _0xcd8127<_0x33b097;},'vAaQu':function(_0x3db6b8,_0x34c25a){return _0x3db6b8!==_0x34c25a;},'CzXqS':_0x16375e(0x209),'gWyfi':_0x16375e(0x16d),'IriJA':_0x16375e(0x214),'wjAmj':_0x16375e(0x179),'eJURy':function(_0x21b58c,_0x1c8451){return _0x21b58c==_0x1c8451;},'ckGxO':_0x16375e(0x16f),'kWpqF':_0x16375e(0x134),'fEBdb':function(_0x1ee16c,_0x229fd6){return _0x1ee16c==_0x229fd6;},'FTMyQ':_0x16375e(0x133),'eBkMd':'pEmBL','tJrgc':_0x16375e(0x131),'XWoUH':'networkidle0','JHBtc':function(_0x2a8018,_0x1a0a4e){return _0x2a8018*_0x1a0a4e;},'vcTfz':function(_0x4dc4a6,_0x299861){return _0x4dc4a6/_0x299861;},'LjVqq':_0x16375e(0x118),'vPvYD':_0x16375e(0x18c),'XUNjv':function(_0x4523b2,_0x62d9ee){return _0x4523b2!==_0x62d9ee;},'lcQKv':'CKXfV','wToSk':_0x16375e(0x227),'YPBRr':_0x16375e(0xc3),'YeRob':_0x16375e(0x1df)},{docId:_0x3ee96a,action:_0x5538bf}=_0x44b701['body'],_0x5e7921=await _0x4fd245[_0x16375e(0x10b)](_0x44b701);await _0x5a7f32[_0x16375e(0x204)](_0x44b701,_0x49e0cb,_0x5e7921[_0x16375e(0xc0)]);const {collectionName:_0x35ba61,docTitle:_0x477f86}=_0x12e720[_0x16375e(0xfb)](_0x44b701[_0x16375e(0xb9)]),_0x33f081=new _0xde4953(global[_0x16375e(0x1ac)]);try{if(_0x4e57ca[_0x16375e(0x202)](_0x4e57ca['CzXqS'],_0x4e57ca['gWyfi'])){await _0x33f081['connect']();var _0x15d5b5=await _0x33f081['db'](global[_0x16375e(0xda)])[_0x16375e(0x195)](_0x35ba61)['findOne']({'docId':_0x3ee96a});if(!_0x15d5b5)return _0x49e0cb[_0x16375e(0x1ee)](JSON[_0x16375e(0x178)]({'isLoad':!0x1,'class':_0x4e57ca['IriJA'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x3ee96a+'\x22'}));_0x15d5b5[_0x16375e(0x16e)]=_0x477f86,_0x15d5b5[_0x16375e(0x11d)]=_0x12e720[_0x16375e(0x21e)](_0x15d5b5['docStatusNumber']);const _0x2fda48=_0x12e720['convert_DocPrint'](_0x15d5b5),_0x41f38b=_0x44e93e['join'](folderForms,_0x4e57ca[_0x16375e(0xd2)]),_0x321538=await _0x230d9b[_0x16375e(0x15c)](_0x41f38b,_0x49e0cb,{'title':_0x3ee96a,'time':_0x521e47[_0x16375e(0x200)](new Date()),'action':_0x5538bf,'doc':_0x2fda48});if(_0x4e57ca['eJURy'](_0x5538bf,_0x4e57ca[_0x16375e(0xe6)]))_0x49e0cb['send'](JSON[_0x16375e(0x178)]({'isPrint':!0x0,'class':_0x4e57ca['kWpqF'],'htmlPage':_0x321538}));else{if(_0x4e57ca[_0x16375e(0xf6)](_0x5538bf,_0x4e57ca['FTMyQ'])){if(_0x4e57ca[_0x16375e(0x104)](_0x4e57ca['eBkMd'],_0x4e57ca[_0x16375e(0x1e8)])){const _0x265613=await(await import(_0x4e57ca[_0x16375e(0x162)]))[_0x16375e(0x1c5)](),_0x11a659=await _0x265613[_0x16375e(0x201)]();await _0x11a659[_0x16375e(0x1d0)](_0x321538,{'waitUntil':_0x4e57ca['XWoUH'],'timeout':0x2710}),await new Promise(_0x5927f4=>setTimeout(_0x5927f4,0x3e8));const _0x422079=Math[_0x16375e(0x10c)](_0x4e57ca[_0x16375e(0x157)](_0x4e57ca['vcTfz'](0x50,25.4),0x60));await _0x11a659[_0x16375e(0x22d)]({'width':_0x422079,'height':0x258,'deviceScaleFactor':0x1});const _0x111b50=await _0x11a659[_0x16375e(0x106)](()=>{const _0x399eb2=_0x16375e;if(_0x4e57ca[_0x399eb2(0x104)](_0x4e57ca[_0x399eb2(0x1f2)],_0x4e57ca[_0x399eb2(0xe4)]))_0x581b4a[_0x399eb2(0x114)]();else{const _0x30f4e0=document[_0x399eb2(0x1f5)],_0x4dc542=document[_0x399eb2(0x150)];return Math[_0x399eb2(0x1eb)](_0x30f4e0[_0x399eb2(0x120)],_0x30f4e0[_0x399eb2(0x18f)],_0x4dc542[_0x399eb2(0x161)],_0x4dc542[_0x399eb2(0x120)],_0x4dc542[_0x399eb2(0x18f)]);}}),_0x3b8d19=await _0x11a659['screenshot']({'type':_0x4e57ca[_0x16375e(0xaf)],'clip':{'x':0x0,'y':0x0,'width':_0x422079,'height':_0x111b50},'omitBackground':!0x1});await _0x265613['close']();const _0x1693e7=_0x15d5b5['docId'][_0x16375e(0x164)](/\//g,'');_0x49e0cb[_0x16375e(0xe5)](0xc8,{'Content-Type':_0x4e57ca['vPvYD'],'Content-Disposition':'attachment;\x20filename='+_0x1693e7+_0x16375e(0x1ab),'Content-Length':_0x3b8d19['length']}),_0x49e0cb['end'](_0x3b8d19);}else{const _0x3b5f29=_0xe450cc['apply'](_0x2924f6,arguments);return _0x339f58=null,_0x3b5f29;}}}}else return![];}catch(_0x28324c){if(_0x4e57ca[_0x16375e(0x1a5)](_0x4e57ca[_0x16375e(0x16a)],_0x4e57ca['wToSk']))console[_0x16375e(0x1d2)](_0x4e57ca['YPBRr'],_0x28324c),_0x49e0cb[_0x16375e(0x1ee)](JSON['stringify']({'isPrint':!0x1,'class':_0x4e57ca[_0x16375e(0x19a)],'msg':_0x28324c[_0x16375e(0x186)]}));else{let _0x505a52;try{const _0x3acae8=QLTlHm[_0x16375e(0x191)](_0x208d6a,QLTlHm['cGHwS'](QLTlHm['rZfJC'](QLTlHm[_0x16375e(0x20e)],QLTlHm[_0x16375e(0x13d)]),');'));_0x505a52=QLTlHm['pivup'](_0x3acae8);}catch(_0x35e27f){_0x505a52=_0x509e68;}const _0x41bbbd=_0x505a52[_0x16375e(0x1a3)]=_0x505a52[_0x16375e(0x1a3)]||{},_0x595f68=[QLTlHm[_0x16375e(0x1ef)],QLTlHm[_0x16375e(0xc9)],QLTlHm[_0x16375e(0xdd)],QLTlHm[_0x16375e(0x142)],QLTlHm['tIhkn'],QLTlHm[_0x16375e(0xee)],QLTlHm[_0x16375e(0x13c)]];for(let _0x22f362=0x0;QLTlHm[_0x16375e(0x1b9)](_0x22f362,_0x595f68['length']);_0x22f362++){const _0x23f4cc=_0x33d01c['constructor']['prototype'][_0x16375e(0x146)](_0x1a4c95),_0x2c7020=_0x595f68[_0x22f362],_0x5e450d=_0x41bbbd[_0x2c7020]||_0x23f4cc;_0x23f4cc[_0x16375e(0x10a)]=_0x3468d0['bind'](_0x43874c),_0x23f4cc[_0x16375e(0x1f7)]=_0x5e450d[_0x16375e(0x1f7)][_0x16375e(0x146)](_0x5e450d),_0x41bbbd[_0x2c7020]=_0x23f4cc;}}}finally{_0x4e57ca[_0x16375e(0x202)](_0x4e57ca[_0x16375e(0x1cb)],_0x4e57ca[_0x16375e(0x1cb)])?_0x47245d[_0x16375e(0x114)]():_0x33f081[_0x16375e(0x114)]();}}),b[_0x8778ca(0x154)](k,_0xe6b8f1['isAuth'],async(_0x168418,_0x351a42)=>{const _0x34954b=_0x8778ca,_0x5ae580={'VwRpo':function(_0x46ce1f,_0x462249){return _0x46ce1f(_0x462249);},'XUnIp':function(_0x561c62,_0x16fa8e){return _0x561c62==_0x16fa8e;},'lGTSd':_0x34954b(0x127),'wSxll':_0x34954b(0x1bf),'bBgPm':_0x34954b(0xb4),'bvKjk':_0x34954b(0x214),'xttzi':_0x34954b(0x132),'EhnZx':function(_0x229185,_0x1569e8){return _0x229185===_0x1569e8;},'xNcPG':function(_0x2be0c5,_0x16115d){return _0x2be0c5==_0x16115d;},'BUeSH':_0x34954b(0xc5),'CcMgH':function(_0x512258,_0x3f0a63){return _0x512258===_0x3f0a63;},'tcJSQ':function(_0x4d2a70,_0x3a490e){return _0x4d2a70==_0x3a490e;},'YuFYH':_0x34954b(0x223),'ugIrQ':function(_0x3e19ed,_0x1286ab){return _0x3e19ed!==_0x1286ab;},'nBtgU':'yGoak','QbJZg':_0x34954b(0x14a),'hfOrI':function(_0x4e1741,_0x57fb71){return _0x4e1741==_0x57fb71;},'mzCFU':function(_0x49b6a9,_0x1987dc){return _0x49b6a9==_0x1987dc;},'XECjX':function(_0x1942f2,_0x550f57){return _0x1942f2==_0x550f57;},'YjKhN':function(_0x2dc0db,_0x2e698d){return _0x2dc0db>_0x2e698d;},'edZPD':function(_0x534eaf,_0x4fd491){return _0x534eaf!==_0x4fd491;},'rAwsq':_0x34954b(0x1a0),'WZaSM':_0x34954b(0xb5),'aIJsO':function(_0xd60b62,_0x1e659e){return _0xd60b62>_0x1e659e;},'URxXU':'ZkZRt','bSouL':_0x34954b(0x105),'alxPk':'{{sep}}[บันทึกการแก้ไข]','IpoKL':'green','ZpnEZ':function(_0x4e2b79,_0x2a51b4){return _0x4e2b79<_0x2a51b4;},'VoTBv':_0x34954b(0xcb)},_0x22f9c9=new _0xde4953(global[_0x34954b(0x1ac)]);try{const _0x33ca4d=await _0x4fd245[_0x34954b(0x10b)](_0x168418);await _0x5a7f32[_0x34954b(0x204)](_0x168418,_0x351a42,_0x33ca4d[_0x34954b(0xc0)]);const {collectionName:_0x3d907f}=_0x12e720[_0x34954b(0xfb)](_0x168418[_0x34954b(0xb9)]),{docId:_0x4eb228,action:_0x53a315}=_0x168418[_0x34954b(0x1f5)],_0x4f95ed=_0x5ae580['XUnIp'](_0x53a315,_0x5ae580[_0x34954b(0x20f)])?_0x5ae580[_0x34954b(0x21d)]:_0x5ae580[_0x34954b(0x1b1)](_0x53a315,_0x5ae580[_0x34954b(0x1e1)])?'จบ':'';if(!_0x4eb228||![_0x5ae580[_0x34954b(0x1e1)],_0x5ae580[_0x34954b(0x20f)]][_0x34954b(0x1af)](_0x53a315))return _0x351a42[_0x34954b(0x1ee)](JSON[_0x34954b(0x178)]({'isStatus':!0x1,'class':_0x5ae580['bvKjk'],'msg':_0x5ae580['xttzi']}));const _0xbc8fd={'docId':_0x4eb228,'userId':_0x33ca4d[_0x34954b(0xfc)]},_0x1cb020=_0x22f9c9['db'](global[_0x34954b(0xda)])['collection'](_0x3d907f),_0x5c400f=await _0x1cb020['findOne'](_0xbc8fd);if(!_0x5c400f)return _0x351a42[_0x34954b(0x1ee)](JSON['stringify']({'isStatus':!0x1,'class':_0x5ae580['bvKjk'],'msg':_0x34954b(0x14f)+_0x4eb228+_0x34954b(0x12a)+_0x4f95ed+_0x34954b(0xb2)}));const _0x2a91f7=_0x5c400f[_0x34954b(0x16c)];if(_0x5ae580[_0x34954b(0xf2)](_0x53a315,_0x5ae580[_0x34954b(0x20f)])&&!(_0x5ae580[_0x34954b(0x1b1)](_0x2a91f7,0x1)||_0x5ae580[_0x34954b(0xea)](_0x2a91f7,0x2)))return _0x351a42['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x5ae580['bvKjk'],'msg':_0x5ae580['BUeSH']}));if(_0x5ae580['CcMgH'](_0x53a315,_0x5ae580['bBgPm'])&&_0x5ae580['tcJSQ'](!_0x2a91f7,0x1))return _0x351a42[_0x34954b(0x1ee)](JSON[_0x34954b(0x178)]({'isStatus':!0x1,'class':_0x5ae580['bvKjk'],'msg':_0x5ae580[_0x34954b(0x14d)]}));if(_0x5ae580[_0x34954b(0x19c)](_0x53a315,_0x5ae580[_0x34954b(0x20f)])){if(_0x5ae580[_0x34954b(0x207)](_0x5ae580[_0x34954b(0x213)],_0x5ae580[_0x34954b(0x1a2)])){if(_0x5ae580[_0x34954b(0x17d)](_0x5c400f[_0x34954b(0x15b)],!0x1))return _0x351a42[_0x34954b(0x1ee)](JSON['stringify']({'isStatus':!0x1,'class':_0x5ae580['bvKjk'],'msg':'เอกสาร\x20\x22'+_0x4eb228+_0x34954b(0x22a)}));if(_0x5ae580[_0x34954b(0x1b1)]((await _0x12e720[_0x34954b(0x1f4)](_0x5c400f,_0x3d907f,_0x33ca4d['userId']))[_0x34954b(0x15b)],!0x1))return _0x351a42[_0x34954b(0x1ee)](JSON[_0x34954b(0x178)]({'isStatus':!0x1,'class':_0x5ae580[_0x34954b(0x1be)],'msg':_0x34954b(0x143)+_0x4eb228+'\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว'}));}else OTjxld['VwRpo'](_0x2df9d7,'0');}if(_0x5ae580[_0x34954b(0x18d)](_0x53a315,_0x5ae580['lGTSd']))var _0x373e32=0xa;else{if(_0x5ae580[_0x34954b(0x1f1)](_0x53a315,_0x5ae580[_0x34954b(0x1e1)]))var _0x373e32=0x2;}const _0x531480=await _0x1cb020[_0x34954b(0xcd)](_0xbc8fd,{'$set':{'docStatusNumber':_0x373e32}});var _0x54786a=_0x4f95ed+'\x20\x22'+_0x4eb228+_0x34954b(0x19d);if(_0x531480[_0x34954b(0x125)]||_0x5ae580[_0x34954b(0x10f)](_0x531480[_0x34954b(0x20a)],0x0)){if(_0x5ae580['edZPD'](_0x5ae580['rAwsq'],_0x5ae580['WZaSM'])){const _0x2b2a4e=_0x12e720['getChangeHistory']({'docStatusNumber':_0x2a91f7},{'docStatusNumber':_0x373e32});if(_0x5ae580[_0x34954b(0x137)](_0x2b2a4e[_0x34954b(0x1a9)],0x0)){if(_0x5ae580[_0x34954b(0xf2)](_0x5ae580['URxXU'],_0x5ae580['bSouL'])){const _0x4a6936=_0x2a6a13['constructor'][_0x34954b(0x1dd)]['bind'](_0x2cdcfa),_0x42d7a0=_0x4e39ce[_0x1e5585],_0x1eac00=_0x25c1aa[_0x42d7a0]||_0x4a6936;_0x4a6936['__proto__']=_0x40361b[_0x34954b(0x146)](_0x1fec32),_0x4a6936[_0x34954b(0x1f7)]=_0x1eac00[_0x34954b(0x1f7)]['bind'](_0x1eac00),_0x15aae4[_0x42d7a0]=_0x4a6936;}else{const _0x48715b={'dateTime':_0x521e47[_0x34954b(0x1e4)](new Date()),'userId':_0x33ca4d['userId'],'userFullname':_0x33ca4d['userFullname'],'changes':_0x2b2a4e};await _0x1cb020[_0x34954b(0xcd)]({'docId':_0x4eb228},{'$push':{'changesHistory':{'$each':[_0x48715b],'$position':0x0}}}),_0x54786a+=_0x5ae580[_0x34954b(0x212)];}}return _0x351a42[_0x34954b(0x1ee)](JSON['stringify']({'isStatus':!0x0,'docId':_0x4eb228,'docStatusNumber':_0x373e32,'class':_0x5ae580['IpoKL'],'msg':_0x54786a}));}else{if(_0x2ca7f2){const _0xd3d376=_0x3ef173[_0x34954b(0xfa)](_0x47204a,arguments);return _0x528d1f=null,_0xd3d376;}}}else{if(_0x531480[_0x34954b(0x125)]&&_0x5ae580['ZpnEZ'](_0x531480[_0x34954b(0x20a)],0x1))return _0x351a42[_0x34954b(0x1ee)](JSON[_0x34954b(0x178)]({'isStatus':!0x1,'docId':_0x4eb228,'docStatusNumber':_0x2a91f7,'class':_0x5ae580['VoTBv'],'msg':'\x22'+_0x4eb228+_0x34954b(0x13e)}));}}catch(_0x55d6ce){console[_0x34954b(0x1d2)](_0x55d6ce),_0x351a42[_0x34954b(0x1ee)](JSON['stringify']({'isStatus':!0x1,'class':_0x5ae580[_0x34954b(0x1be)],'msg':_0x55d6ce[_0x34954b(0x186)]}));}finally{_0x22f9c9[_0x34954b(0x114)]();}});export default b;function _0x41ef25(_0x412d89){const _0x1f5703=_0x8778ca,_0x5050ad={'CVTdW':function(_0x344e27,_0x96c6c3){return _0x344e27===_0x96c6c3;},'YeOmj':_0x1f5703(0xfe),'oExlK':_0x1f5703(0x225),'aeCKm':'counter','YYIhx':function(_0x38b808,_0x52bb84){return _0x38b808!==_0x52bb84;},'NHqla':function(_0x1fb0aa,_0x328eaf){return _0x1fb0aa+_0x328eaf;},'qNHGa':function(_0x3c6862,_0x1ae816){return _0x3c6862/_0x1ae816;},'Cvgxi':'length','OSEeU':function(_0x3bd8eb,_0x3f5708){return _0x3bd8eb===_0x3f5708;},'TuNxx':function(_0x28a6bf,_0x272b9e){return _0x28a6bf%_0x272b9e;},'ENAxK':_0x1f5703(0x1c0),'WxWvW':_0x1f5703(0x1fb),'xjPYO':_0x1f5703(0x205),'jTOYE':function(_0x5b76b7,_0x24012e){return _0x5b76b7+_0x24012e;},'hCOrR':_0x1f5703(0x168),'WMBDJ':function(_0x590fdd,_0x56fad1){return _0x590fdd(_0x56fad1);},'fiYdz':function(_0x9bfb74,_0x33dbd9){return _0x9bfb74(_0x33dbd9);}};function _0x2aa16c(_0x389088){const _0x3ce6be=_0x1f5703;if(_0x5050ad[_0x3ce6be(0x1ea)](typeof _0x389088,_0x5050ad[_0x3ce6be(0x192)]))return function(_0x3d2c6a){}[_0x3ce6be(0x180)](_0x5050ad[_0x3ce6be(0x1b0)])[_0x3ce6be(0xfa)](_0x5050ad['aeCKm']);else _0x5050ad[_0x3ce6be(0xae)](_0x5050ad[_0x3ce6be(0xb7)]('',_0x5050ad['qNHGa'](_0x389088,_0x389088))[_0x5050ad[_0x3ce6be(0x1f0)]],0x1)||_0x5050ad['OSEeU'](_0x5050ad[_0x3ce6be(0xcc)](_0x389088,0x14),0x0)?function(){return!![];}['constructor'](_0x5050ad['NHqla'](_0x5050ad[_0x3ce6be(0x128)],_0x5050ad[_0x3ce6be(0xbf)]))[_0x3ce6be(0x19b)](_0x5050ad['xjPYO']):function(){return![];}['constructor'](_0x5050ad[_0x3ce6be(0x18a)](_0x5050ad[_0x3ce6be(0x128)],_0x5050ad['WxWvW']))[_0x3ce6be(0xfa)](_0x5050ad[_0x3ce6be(0x1a1)]);_0x5050ad['WMBDJ'](_0x2aa16c,++_0x389088);}try{if(_0x412d89)return _0x2aa16c;else _0x5050ad[_0x1f5703(0x17b)](_0x2aa16c,0x0);}catch(_0x504775){}}