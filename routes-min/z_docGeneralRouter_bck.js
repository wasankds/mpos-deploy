const _0x1a4679=_0xee71;(function(_0x4cabc5,_0x869815){const _0x5bc5bf=_0xee71,_0x33cbf1=_0x4cabc5();while(!![]){try{const _0x2cce6d=-parseInt(_0x5bc5bf(0x1bb))/0x1*(parseInt(_0x5bc5bf(0x162))/0x2)+-parseInt(_0x5bc5bf(0x204))/0x3*(parseInt(_0x5bc5bf(0x230))/0x4)+parseInt(_0x5bc5bf(0x1c5))/0x5*(-parseInt(_0x5bc5bf(0x229))/0x6)+parseInt(_0x5bc5bf(0x21b))/0x7+-parseInt(_0x5bc5bf(0x1fa))/0x8+-parseInt(_0x5bc5bf(0x257))/0x9*(parseInt(_0x5bc5bf(0x132))/0xa)+parseInt(_0x5bc5bf(0x29e))/0xb;if(_0x2cce6d===_0x869815)break;else _0x33cbf1['push'](_0x33cbf1['shift']());}catch(_0x33654f){_0x33cbf1['push'](_0x33cbf1['shift']());}}}(_0x9495,0xe154e));const _0x456200=(function(){const _0x1648c5=_0xee71,_0x2e303e={'BBMkL':function(_0x1fc7cf,_0x3eac47){return _0x1fc7cf+_0x3eac47;},'LPbgg':'debu','OXAOk':_0x1648c5(0x272),'evNkf':_0x1648c5(0x185),'fgLUm':function(_0x14d866,_0x59d08b){return _0x14d866(_0x59d08b);},'RpbRh':'return\x20(function()\x20','BZEjc':'{}.constructor(\x22return\x20this\x22)(\x20)','FYAbS':function(_0x2ae0a6){return _0x2ae0a6();},'lBGeN':function(_0x3d912c,_0x4b0b90){return _0x3d912c!==_0x4b0b90;},'kXbjK':_0x1648c5(0x1b4),'exNku':function(_0x22238d,_0x3db4cb){return _0x22238d===_0x3db4cb;},'DATWI':_0x1648c5(0x23d),'OvzcD':function(_0x93dc1b,_0xe1dcd2){return _0x93dc1b!==_0xe1dcd2;},'pJRst':_0x1648c5(0x1f9)};let _0x5939b4=!![];return function(_0x744076,_0x24efd7){const _0x5d26d8=_0x1648c5;if(_0x2e303e[_0x5d26d8(0x16f)](_0x2e303e[_0x5d26d8(0x1e8)],_0x2e303e['pJRst'])){const _0x39301a=_0x118ec5?function(){if(_0x54b177){const _0x1055fd=_0x197326['apply'](_0x3e9c1e,arguments);return _0x122d90=null,_0x1055fd;}}:function(){};return _0x1e5771=![],_0x39301a;}else{const _0x211d4f=_0x5939b4?function(){const _0x317721=_0x5d26d8,_0x463d08={'QIase':function(_0x3a7c18,_0x359df4){const _0x3054b9=_0xee71;return _0x2e303e[_0x3054b9(0x135)](_0x3a7c18,_0x359df4);},'TeZCe':_0x2e303e[_0x317721(0x279)],'YgoWB':_0x2e303e['OXAOk'],'axDZd':_0x2e303e[_0x317721(0x246)],'wQgWV':function(_0x4d9d21,_0x4ba8a7){return _0x2e303e['fgLUm'](_0x4d9d21,_0x4ba8a7);},'cNYKE':function(_0x670731,_0xdecf70){const _0x338963=_0x317721;return _0x2e303e[_0x338963(0x135)](_0x670731,_0xdecf70);},'bHayN':_0x2e303e['RpbRh'],'Hgxkb':_0x2e303e[_0x317721(0x1d5)],'LtvYe':function(_0x378e42){return _0x2e303e['FYAbS'](_0x378e42);}};if(_0x2e303e[_0x317721(0x274)](_0x2e303e[_0x317721(0x270)],_0x2e303e['kXbjK']))(function(){return!![];}['constructor'](_0x463d08[_0x317721(0x227)](_0x463d08[_0x317721(0x1ba)],_0x463d08[_0x317721(0x179)]))[_0x317721(0x18f)](_0x463d08['axDZd']));else{if(_0x24efd7){if(_0x2e303e[_0x317721(0x141)](_0x2e303e[_0x317721(0x1d8)],_0x2e303e[_0x317721(0x1d8)])){const _0x42639f=_0x24efd7[_0x317721(0x1b5)](_0x744076,arguments);return _0x24efd7=null,_0x42639f;}else{const _0x302065=_0x463d08[_0x317721(0x153)](_0x40a5d6,_0x463d08[_0x317721(0x227)](_0x463d08[_0x317721(0x267)](_0x463d08['bHayN'],_0x463d08['Hgxkb']),');'));_0xefc909=_0x463d08['LtvYe'](_0x302065);}}}}:function(){};return _0x5939b4=![],_0x211d4f;}};}());(function(){const _0x232b36=_0xee71,_0x1cb1a3={'oXhXk':function(_0xcaec24,_0x1e9bb8){return _0xcaec24(_0x1e9bb8);},'UbfpU':function(_0x3e21ac,_0x1f3bb7){return _0x3e21ac===_0x1f3bb7;},'RjnwD':_0x232b36(0x157),'GTrxP':_0x232b36(0x1fc),'rxxGw':_0x232b36(0x13d),'AkvZc':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','KkWNQ':function(_0xe8b363,_0x4a4e4b){return _0xe8b363(_0x4a4e4b);},'uPdbQ':_0x232b36(0x190),'gRDjc':function(_0x36910c,_0x48cdfe){return _0x36910c+_0x48cdfe;},'wxhjd':'chain','Ewwaa':_0x232b36(0x240),'EDsFs':function(_0x11fef0,_0x3e431d){return _0x11fef0!==_0x3e431d;},'iULsN':'FxvsC','HlxKi':function(_0x37e7b0,_0x44ee48){return _0x37e7b0===_0x44ee48;},'iByNI':_0x232b36(0x23e),'UqnRd':_0x232b36(0x197),'JBuum':function(_0x36120a){return _0x36120a();},'NgZTN':function(_0x238f17,_0x4b9ab8,_0x1a676c){return _0x238f17(_0x4b9ab8,_0x1a676c);}};_0x1cb1a3[_0x232b36(0x28d)](_0x456200,this,function(){const _0x511c3c=_0x232b36,_0x5ec07c={'wAknb':function(_0x550a61,_0x1fd354){const _0x45c54f=_0xee71;return _0x1cb1a3[_0x45c54f(0x286)](_0x550a61,_0x1fd354);}};if(_0x1cb1a3['UbfpU'](_0x1cb1a3[_0x511c3c(0x215)],_0x1cb1a3['GTrxP'])){const _0x1ff68c=_0x4210b8['apply'](_0x48fb27,arguments);return _0x38cf1a=null,_0x1ff68c;}else{const _0x91fed7=new RegExp(_0x1cb1a3['rxxGw']),_0x52113b=new RegExp(_0x1cb1a3[_0x511c3c(0x25b)],'i'),_0x212f38=_0x1cb1a3[_0x511c3c(0x1de)](_0x10381a,_0x1cb1a3['uPdbQ']);if(!_0x91fed7[_0x511c3c(0x1ed)](_0x1cb1a3[_0x511c3c(0x140)](_0x212f38,_0x1cb1a3[_0x511c3c(0x1ae)]))||!_0x52113b[_0x511c3c(0x1ed)](_0x1cb1a3[_0x511c3c(0x140)](_0x212f38,_0x1cb1a3[_0x511c3c(0x297)])))_0x1cb1a3[_0x511c3c(0x154)](_0x1cb1a3[_0x511c3c(0x1e6)],_0x1cb1a3['iULsN'])?_0x5ec07c[_0x511c3c(0x22a)](_0x162083,0x0):_0x1cb1a3['KkWNQ'](_0x212f38,'0');else{if(_0x1cb1a3[_0x511c3c(0x294)](_0x1cb1a3[_0x511c3c(0x14d)],_0x1cb1a3[_0x511c3c(0x259)]))return!![];else _0x1cb1a3[_0x511c3c(0x149)](_0x10381a);}}})();}());const _0x45761e=(function(){const _0x53d7b8=_0xee71,_0x50d596={'yMhxf':_0x53d7b8(0x2a2),'reeRp':'counter','KLZFv':function(_0x4059bd,_0x94e987){return _0x4059bd!==_0x94e987;},'lqLRf':'YBplw','kGdsN':function(_0x597ade,_0x4cb023){return _0x597ade!==_0x4cb023;},'Hnkak':_0x53d7b8(0x178),'zcrwk':'tiazU','MwKAG':_0x53d7b8(0x205),'SmgWE':function(_0x4cc89e,_0x2581fd){return _0x4cc89e!==_0x2581fd;},'vPmEq':_0x53d7b8(0x1cf)};let _0xfecec=!![];return function(_0x425dbd,_0x964f85){const _0x2b1b0e=_0x53d7b8,_0x4566b3={'ptMsl':_0x50d596[_0x2b1b0e(0x1f2)]};if(_0x50d596[_0x2b1b0e(0x28b)](_0x50d596[_0x2b1b0e(0x1d4)],_0x50d596[_0x2b1b0e(0x1d4)]))return _0x5973c2[_0x2b1b0e(0x166)](_0x37a05f),_0x3943d1['send'](_0xfb0e67['stringify']({'isLoad':!0x1,'class':_0x4566b3[_0x2b1b0e(0x20b)],'msg':_0x128903[_0x2b1b0e(0x176)]}));else{const _0x191c44=_0xfecec?function(){const _0x5347dd=_0x2b1b0e,_0x32904c={'JgAEC':_0x50d596[_0x5347dd(0x1c2)],'tjmDM':_0x50d596[_0x5347dd(0x278)]};if(_0x50d596[_0x5347dd(0x276)](_0x50d596[_0x5347dd(0x24d)],_0x50d596[_0x5347dd(0x24d)]))return function(_0x597243){}[_0x5347dd(0x19f)](_0x32904c[_0x5347dd(0x1d0)])[_0x5347dd(0x1b5)](_0x32904c['tjmDM']);else{if(_0x964f85){if(_0x50d596[_0x5347dd(0x202)](_0x50d596[_0x5347dd(0x27f)],_0x50d596[_0x5347dd(0x219)])){const _0x1dca10=_0x964f85[_0x5347dd(0x1b5)](_0x425dbd,arguments);return _0x964f85=null,_0x1dca10;}else{const _0x4222e3=_0xe32316[_0x5347dd(0x19f)]['prototype'][_0x5347dd(0x296)](_0x30bc8b),_0x3750a9=_0x237314[_0x4ec8a4],_0x4c2c52=_0x4267a6[_0x3750a9]||_0x4222e3;_0x4222e3[_0x5347dd(0x198)]=_0x364ef8[_0x5347dd(0x296)](_0x2f2ee2),_0x4222e3[_0x5347dd(0x1a9)]=_0x4c2c52[_0x5347dd(0x1a9)]['bind'](_0x4c2c52),_0x188d8b[_0x3750a9]=_0x4222e3;}}}}:function(){};return _0xfecec=![],_0x191c44;}};}()),_0x34b747=_0x45761e(this,function(){const _0x53010f=_0xee71,_0xc09c07={'lJfCp':_0x53010f(0x1e2),'ujenw':_0x53010f(0x205),'NrVWW':function(_0x1771c8,_0x5ba9d0){return _0x1771c8===_0x5ba9d0;},'aGdkZ':_0x53010f(0x26f),'nWyYx':function(_0x327441,_0x3b18fa){return _0x327441(_0x3b18fa);},'JvRhq':function(_0x484dcc,_0x1ab9ce){return _0x484dcc+_0x1ab9ce;},'AXzIV':function(_0xb39045,_0x4afb5b){return _0xb39045+_0x4afb5b;},'NVPfD':_0x53010f(0x19e),'mBkvn':_0x53010f(0x248),'dClSt':function(_0x58363b){return _0x58363b();},'fdmUg':function(_0x283ce6,_0xee49c5){return _0x283ce6!==_0xee49c5;},'yoOlQ':_0x53010f(0x27b),'ICYzs':_0x53010f(0x29d),'sSCAo':_0x53010f(0x166),'WCOYA':_0x53010f(0x1b0),'sItmX':'info','PJCBS':_0x53010f(0x299),'xoeqo':_0x53010f(0x265),'QyqIG':_0x53010f(0x1db),'idlrq':_0x53010f(0x16d),'oGRyy':function(_0x1f23a4,_0x5bf05a){return _0x1f23a4<_0x5bf05a;},'oIdAV':_0x53010f(0x1a3)};let _0x359223;try{if(_0xc09c07['NrVWW'](_0xc09c07[_0x53010f(0x170)],_0xc09c07['aGdkZ'])){const _0x160dd4=_0xc09c07['nWyYx'](Function,_0xc09c07[_0x53010f(0x148)](_0xc09c07[_0x53010f(0x26c)](_0xc09c07['NVPfD'],_0xc09c07[_0x53010f(0x22c)]),');'));_0x359223=_0xc09c07[_0x53010f(0x156)](_0x160dd4);}else _0x588e0c[_0x53010f(0x23a)]();}catch(_0xeb5045){if(_0xc09c07[_0x53010f(0x225)](_0xc09c07[_0x53010f(0x22f)],_0xc09c07[_0x53010f(0x15e)]))_0x359223=window;else{const _0x49667e=_0x47c4e5?function(){const _0x5da9bc=_0x53010f;if(_0xb2a412){const _0x31bde6=_0x42fce0[_0x5da9bc(0x1b5)](_0x1893a4,arguments);return _0x16944f=null,_0x31bde6;}}:function(){};return _0x2c492b=![],_0x49667e;}}const _0x4126c6=_0x359223['console']=_0x359223[_0x53010f(0x25a)]||{},_0x5371fc=[_0xc09c07[_0x53010f(0x221)],_0xc09c07[_0x53010f(0x21a)],_0xc09c07['sItmX'],_0xc09c07[_0x53010f(0x1f4)],_0xc09c07[_0x53010f(0x14b)],_0xc09c07[_0x53010f(0x281)],_0xc09c07['idlrq']];for(let _0x1456c9=0x0;_0xc09c07[_0x53010f(0x24f)](_0x1456c9,_0x5371fc[_0x53010f(0x171)]);_0x1456c9++){if(_0xc09c07['NrVWW'](_0xc09c07[_0x53010f(0x1e9)],_0xc09c07[_0x53010f(0x1e9)])){const _0x5f4aff=_0x45761e[_0x53010f(0x19f)][_0x53010f(0x243)][_0x53010f(0x296)](_0x45761e),_0x102d2b=_0x5371fc[_0x1456c9],_0x1e9a28=_0x4126c6[_0x102d2b]||_0x5f4aff;_0x5f4aff[_0x53010f(0x198)]=_0x45761e['bind'](_0x45761e),_0x5f4aff[_0x53010f(0x1a9)]=_0x1e9a28[_0x53010f(0x1a9)][_0x53010f(0x296)](_0x1e9a28),_0x4126c6[_0x102d2b]=_0x5f4aff;}else _0x402638[_0x53010f(0x166)](_0xc09c07[_0x53010f(0x236)],_0x489547),_0x40a0f9[_0x53010f(0x26b)](_0x5d8fde[_0x53010f(0x152)]({'isPrint':!0x1,'class':_0xc09c07[_0x53010f(0x25d)],'msg':_0x581870[_0x53010f(0x176)]}));}});_0x34b747();import _0x12f09d from'express';const b=_0x12f09d['Router']();import _0x5495e4 from'path';import{MongoClient as _0x4c8fe6}from'mongodb';function _0x9495(){const _0x460859=['kiLIG','gRDjc','exNku','body','CSnbn','bRyLz','image/jpeg','ADAjZ','uwFuE','JvRhq','JBuum','ccVAs','xoeqo','ktNsP','iByNI','\x22\x20เอกสาร','hjEUD','image','BUhxk','stringify','wQgWV','EDsFs','replace','dClSt','hPlOq','join','cKJqA','newPage','ยกเลิก','IyCOA','convert_DocPrint','ICYzs','uLORE','RGDqr','WbJLu','922UXUKMC','GqefG','HArAf','/fetch/modal','log','wyHtJ','qhiAM','bdKJB','includes','bUuUC','FdjPu','trace','uIVOX','OvzcD','aGdkZ','length','MYLGe','warehouseOut','nLqLT','irlGS','message','max','qtjTB','YgoWB','EMvdw','renderView','BMiXj','YxFVO','/search','HqzGz','RzUzX','ejDZK','HiHma','getMainDocPathObj','/load','action','SEFSq','updateOne','cXGQj','aggregate','sales','attachment;\x20filename=','{{sep}}[\x20เลยกำหนดแก้ไข\x20สถานะถูก{{sep}}เปลี่ยนเป็น\x202\x20อัตโนมัติ]','PATH_WAREHOUSE_OUT','AvHgF','call','init','KZcVb','lpyHx','ywLFC','rvuvn','qcxkz','nqTlu','xkQaf','__proto__','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','IEqYk','iXPkT','GUVoa','LOUMQ','return\x20(function()\x20','constructor','ไม่พบเอกสารเลขที่\x20\x22','xSDtC','HOxPN','mVOqF','AVryf','szAdL','UkgkP','zlLxy','ZWSOB','toString','formatDateTime','RmdqQ','stock','KQHIf','wxhjd','UxkDY','warn','AanaR','EIIQi','toArray','HCXys','apply','hunrm','SPYMO','เอกสารที่ตันเองไม่ได้สร้าง','cLWiP','TeZCe','2867swQjhp','VfVrE','TfjOb','userId','XWkpR','jFcPu','nSvNi','yMhxf','collection','matchedCount','28430NPVnVT','qwjsz','ylURi','Rlxuu','SaEvl','findOne','get_Info_ByUrl','branchName','TwHRA','PfkLl','INPLW','JgAEC','string','byFfu','uPWhf','vPmEq','BZEjc','SOryJ','พบ\x20\x22','DATWI','originalUrl','modifiedCount','table','QPfEy','/load-last','KkWNQ','rLHlK','docId','evaluate','error\x20===>\x20','isAuth','yellow','NRNtr','iULsN','clientHeight','pJRst','oIdAV','post','hqkgt','kYNij','test','CknAn','wPvno','bCHHu','cancel','MwKAG','fjKnO','PJCBS','OOexE','\x22\x20เอกสารเกินกำหนดยกเลิกแล้ว','mAZkg','OHJUM','LZWYy','12771784SKAEMD','/print','LCPxS','vLVgM','TAMct','EXQtM','statusName','VdHBk','kGdsN','check_DocDateTime_CanCancel','3VJszMr','red','ไม่พบเอกสารล่าสุด','{{sep}}หรือไม่มีสิทธิ์','wEwRG','yYlMv','MGjUz','ptMsl','IFeLs','AVsIZ','lKlks','stateObject','connect','WBGNR','pedvm','MsTkd','dVBkj','RjnwD','pNdPS','VFwOG','pArAf','zcrwk','WCOYA','6237518CsGCOD','uPWSE','GtyOd','vVeUb','dateTimeCancelRemain','wnXkB','sSCAo','HSfHP','vXuhP','QNrhl','fdmUg','htHak','QIase','WoKsM','942mvZWLj','wAknb','QWNFo','mBkvn','zJusT','info','yoOlQ','5217916CwgJJS','เอกสาร\x20\x22','GIygL','ZIpxB','debu','push','lJfCp','puppeteer','GZLDT','ePxkS','close','HdcNL','YhbCX','Fwjqt','QEkgY','buefg','input','FjJbk','jpeg','prototype','BAvWC','IYRnP','evNkf','getUserData','{}.constructor(\x22return\x20this\x22)(\x20)','doc_print.ejs','docStatusNumber','JyRqP','FLVrz','lqLRf','zGJMM','oGRyy','YeZKy','lYPgD','kUckD','lQPFN','dbUjT','wmUof','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','36MsaBus','/changes','UqnRd','console','AkvZc','IxsCx','ujenw','load-last','VQAmE','Adshc','bsKsO','UWYRM','print','NInob','exception','documentElement','cNYKE','userAuthority','QBaBl','warehouseIn','send','AXzIV','fzgTI','offsetHeight','VLmLF','kXbjK','โหลดเอกสารเลขที่\x20\x22','gger','BeqNT','lBGeN','ไม่พบเอกสาร\x20\x22','KLZFv','DXoTE','reeRp','LPbgg','PVmHg','hvshg','RozPW','fTOHK','LLywy','Hnkak','docTitle','QyqIG','dbUrl','twCpp','InyUk','ไม่พบประวัติการเปลี่ยนแปลง','oXhXk','green','Idgca','writeHead','xIQwS','SmgWE','Hahop','NgZTN','OtfWi','Rbyjz','BzoUh','dateTimeEditRemain','FdMNT','canCancel','HlxKi','dateTimeCanCancel','bind','Ewwaa','YLyVl','error','/status','TgYod','rBzPU','KCmhU','60113295ffWykY','HfdBw','YEKIq','XKckR','while\x20(true)\x20{}','scIgZ','active','scrollHeight','794050aadkBM','กรุณาระบุคำค้นหา\x202\x20ตัวอักษรขึ้นไป','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','BBMkL','DOC_TYPE','dbName','PATH_SALES','gMopw','UixEg','screenshot','formatDate','function\x20*\x5c(\x20*\x5c)','chain'];_0x9495=function(){return _0x460859;};return _0x9495();}import _0x336ba0 from'../middleware/mainAuth.js';function _0xee71(_0x49917a,_0x4e40db){const _0x7a7ea=_0x9495();return _0xee71=function(_0x34b747,_0x45761e){_0x34b747=_0x34b747-0x130;let _0x2d973f=_0x7a7ea[_0x34b747];return _0x2d973f;},_0xee71(_0x49917a,_0x4e40db);}import*as _0x427670 from'../mymodule/myUsers.js';import*as _0x2286b8 from'../mymodule/myDateTime.js';import*as _0x4ea060 from'../mymodule/myModule.js';import*as _0x118e27 from'../mymodule/myDocMain.js';import*as _0x5efd62 from'../mymodule/myData.js';const w=global['PATH_WAREHOUSE_IN'],S=global[_0x1a4679(0x18d)],p=global[_0x1a4679(0x138)],M=[w+'/changes',S+_0x1a4679(0x258),p+'/changes'],v=[w+_0x1a4679(0x1fb),S+_0x1a4679(0x1fb),p+_0x1a4679(0x1fb)],k=[w+_0x1a4679(0x29a),S+_0x1a4679(0x29a),p+'/status'],B=[w+_0x1a4679(0x17e),S+_0x1a4679(0x17e),p+_0x1a4679(0x17e)],x=[w+_0x1a4679(0x184),S+'/load',p+_0x1a4679(0x184),w+_0x1a4679(0x1dd),S+_0x1a4679(0x1dd),p+'/load-last'],L=[w+_0x1a4679(0x165),S+_0x1a4679(0x165),p+_0x1a4679(0x165)];b['get'](L,_0x336ba0[_0x1a4679(0x1e3)],async(_0x32e210,_0x5db668)=>{const _0x4284d5=_0x1a4679,_0x1cfa06={'VdHBk':'function\x20*\x5c(\x20*\x5c)','CknAn':_0x4284d5(0x199),'Rbyjz':function(_0x42c3b1,_0x4822a8){return _0x42c3b1(_0x4822a8);},'kYNij':_0x4284d5(0x190),'uIVOX':function(_0x102e62,_0x210012){return _0x102e62+_0x210012;},'wmUof':'chain','nSvNi':'input','YJHIq':function(_0x1e86ee){return _0x1e86ee();},'SEFSq':function(_0x570857,_0x2f3ccf,_0x3afde7){return _0x570857(_0x2f3ccf,_0x3afde7);},'nLqLT':function(_0x3c22f8,_0x2c0ad8){return _0x3c22f8===_0x2c0ad8;},'MYLGe':_0x4284d5(0x181),'IYRnP':function(_0x4d5851,_0x810aea){return _0x4d5851==_0x810aea;},'AvHgF':_0x4284d5(0x26a),'rLHlK':_0x4284d5(0x1ac),'NRNtr':_0x4284d5(0x173),'pNdPS':_0x4284d5(0x18a),'FLVrz':_0x4284d5(0x130),'uPWSE':_0x4284d5(0x287),'YxFVO':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','lZMaN':function(_0x2d9da1,_0x2fca47){return _0x2d9da1===_0x2fca47;},'LLywy':_0x4284d5(0x21e),'OtfWi':_0x4284d5(0x205)},_0x582e15=await _0x427670[_0x4284d5(0x247)](_0x32e210),_0x3b113a=await _0x118e27[_0x4284d5(0x183)](_0x32e210,_0x5db668,_0x582e15[_0x4284d5(0x268)]);try{if(_0x1cfa06[_0x4284d5(0x174)](_0x1cfa06[_0x4284d5(0x172)],_0x1cfa06[_0x4284d5(0x172)])){if(_0x1cfa06[_0x4284d5(0x245)](_0x3b113a[_0x4284d5(0x136)],_0x1cfa06[_0x4284d5(0x18e)]))var _0x21e38d=await _0x5efd62['getItems_for_Modal'](_0x1cfa06['rLHlK']);else{if(_0x1cfa06[_0x4284d5(0x245)](_0x3b113a[_0x4284d5(0x136)],_0x1cfa06[_0x4284d5(0x1e5)]))var _0x21e38d=await _0x5efd62['getItems_for_Modal'](_0x1cfa06[_0x4284d5(0x1df)]);else{if(_0x1cfa06[_0x4284d5(0x245)](_0x3b113a['DOC_TYPE'],_0x1cfa06[_0x4284d5(0x216)]))var _0x21e38d=await _0x5efd62['getItems_for_Modal'](_0x1cfa06[_0x4284d5(0x24c)]);}}const _0x3b96e1=await _0x5efd62['getItemsCategory']();return _0x5db668[_0x4284d5(0x26b)](JSON[_0x4284d5(0x152)]({'DATA_ITEMS':_0x21e38d,'DATA_CATEGORY':_0x3b96e1,'isFetch':!0x0,'class':_0x1cfa06[_0x4284d5(0x21c)],'msg':_0x1cfa06[_0x4284d5(0x17d)]}));}else{const _0x5d1a00={'IyCOA':RptFiA[_0x4284d5(0x201)],'bRyLz':RptFiA[_0x4284d5(0x1ee)],'HiHma':function(_0x5e9981,_0x12cd67){const _0x5761f3=_0x4284d5;return RptFiA[_0x5761f3(0x28f)](_0x5e9981,_0x12cd67);},'vXuhP':RptFiA[_0x4284d5(0x1ec)],'MhGhs':function(_0x50968d,_0x2d8ef2){const _0x47832f=_0x4284d5;return RptFiA[_0x47832f(0x16e)](_0x50968d,_0x2d8ef2);},'GrpvJ':RptFiA[_0x4284d5(0x255)],'AanaR':function(_0x202dda,_0x6e3b56){const _0x1d490d=_0x4284d5;return RptFiA[_0x1d490d(0x16e)](_0x202dda,_0x6e3b56);},'UixEg':RptFiA[_0x4284d5(0x1c1)],'FhbZs':function(_0x4e33b8,_0x4affca){const _0x1d2ab7=_0x4284d5;return RptFiA[_0x1d2ab7(0x28f)](_0x4e33b8,_0x4affca);},'YeZKy':function(_0x47efa3){return RptFiA['YJHIq'](_0x47efa3);}};RptFiA[_0x4284d5(0x186)](_0x2e9eeb,this,function(){const _0x804a58=_0x4284d5,_0x4c93d4=new _0x5be570(_0x5d1a00[_0x804a58(0x15c)]),_0x256e60=new _0x2f96ed(_0x5d1a00[_0x804a58(0x144)],'i'),_0x5431c8=_0x5d1a00[_0x804a58(0x182)](_0x3b33ec,_0x5d1a00[_0x804a58(0x223)]);!_0x4c93d4[_0x804a58(0x1ed)](_0x5d1a00['MhGhs'](_0x5431c8,_0x5d1a00['GrpvJ']))||!_0x256e60[_0x804a58(0x1ed)](_0x5d1a00[_0x804a58(0x1b1)](_0x5431c8,_0x5d1a00[_0x804a58(0x13a)]))?_0x5d1a00['FhbZs'](_0x5431c8,'0'):_0x5d1a00[_0x804a58(0x250)](_0x36c798);})();}}catch(_0x483da1){if(_0x1cfa06['lZMaN'](_0x1cfa06[_0x4284d5(0x27e)],_0x1cfa06[_0x4284d5(0x27e)]))return console[_0x4284d5(0x166)](_0x483da1),_0x5db668[_0x4284d5(0x26b)](JSON[_0x4284d5(0x152)]({'isFetch':!0x1,'class':_0x1cfa06[_0x4284d5(0x28e)],'msg':_0x483da1[_0x4284d5(0x176)]}));else _0x16a70f[_0x4284d5(0x23a)]();}}),b[_0x1a4679(0x1ea)](B,_0x336ba0['isAuth'],async(_0x93aa2,_0x1e4c9f)=>{const _0x3193f7=_0x1a4679,_0x5d9ed={'xIQwS':function(_0x27b0f2,_0x214155){return _0x27b0f2+_0x214155;},'RmdqQ':_0x3193f7(0x234),'RKtgD':_0x3193f7(0x272),'RePwQ':_0x3193f7(0x20f),'HGcIP':_0x3193f7(0x13d),'zGJMM':_0x3193f7(0x199),'cXGQj':function(_0x515ae6,_0x3f18fa){return _0x515ae6(_0x3f18fa);},'bUuUC':_0x3193f7(0x190),'BAvWC':function(_0x47e078,_0x5161e4){return _0x47e078+_0x5161e4;},'GqefG':_0x3193f7(0x13e),'AVsIZ':'input','DEbGY':function(_0x1def3e){return _0x1def3e();},'rBzPU':function(_0x4f8d99,_0x3ec7c1){return _0x4f8d99<_0x3ec7c1;},'euSyB':_0x3193f7(0x1e4),'kUckD':_0x3193f7(0x133),'wEwRG':function(_0x31ac39,_0x3d11dc){return _0x31ac39!==_0x3d11dc;},'ZWSOB':_0x3193f7(0x1ce),'ccVAs':'{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','EMvdw':_0x3193f7(0x287),'VfVrE':function(_0x56e690,_0x2badf4){return _0x56e690===_0x2badf4;},'dbUjT':_0x3193f7(0x139),'szAdL':_0x3193f7(0x205),'WEGYe':function(_0x10613c,_0x35d7b6){return _0x10613c!==_0x35d7b6;},'WAJPa':_0x3193f7(0x180),'ADAjZ':'BokDY'};let {sip:_0x3c428c}=_0x93aa2['body'];if(!_0x3c428c&&_0x5d9ed[_0x3193f7(0x29c)](_0x3c428c[_0x3193f7(0x171)],0x2))return _0x1e4c9f[_0x3193f7(0x26b)](JSON[_0x3193f7(0x152)]({'isSearch':!0x1,'class':_0x5d9ed['euSyB'],'msg':_0x5d9ed[_0x3193f7(0x252)]}));_0x3c428c=_0x3c428c[_0x3193f7(0x155)](/[!@#$%^&*<>]/g,'')??null;const _0x4752ae=await _0x427670[_0x3193f7(0x247)](_0x93aa2);await _0x118e27['getMainDocPathObj'](_0x93aa2,_0x1e4c9f,_0x4752ae[_0x3193f7(0x268)]);const {collectionName:_0x24fd72}=_0x5efd62[_0x3193f7(0x1cb)](_0x93aa2[_0x3193f7(0x1d9)]),_0x490dad=new _0x4c8fe6(global[_0x3193f7(0x282)]);try{if(_0x5d9ed[_0x3193f7(0x208)](_0x5d9ed[_0x3193f7(0x1a8)],_0x5d9ed[_0x3193f7(0x1a8)]))(function(){return![];}[_0x3193f7(0x19f)](gBWRHC['xIQwS'](gBWRHC[_0x3193f7(0x1ab)],gBWRHC['RKtgD']))[_0x3193f7(0x1b5)](gBWRHC['RePwQ']));else{await _0x490dad[_0x3193f7(0x210)]();const _0x3dfb3a=_0x490dad['db'](global['dbName'])[_0x3193f7(0x1c3)](_0x24fd72),_0xa27ab4=[{'$or':[{'docId':{'$regex':_0x3c428c,'$options':'i'}},{'docDate':{'$regex':_0x3c428c,'$options':'i'}}]}];let _0x3d81a4='';['O','S'][_0x3193f7(0x16a)](_0x4752ae[_0x3193f7(0x268)])||(_0x3d81a4+=_0x5d9ed[_0x3193f7(0x14a)],_0xa27ab4[_0x3193f7(0x235)]({'userId':_0x4752ae[_0x3193f7(0x1be)]}));const _0x56bcb1=await _0x3dfb3a[_0x3193f7(0x189)]([{'$match':{'$and':_0xa27ab4}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'docDate':0x1,'userId':0x1}}])[_0x3193f7(0x1b3)]();return _0x3d81a4=_0x5d9ed[_0x3193f7(0x28a)](_0x3193f7(0x1d7)+_0x56bcb1['length']+_0x3193f7(0x14e),_0x3d81a4),_0x1e4c9f[_0x3193f7(0x26b)](JSON[_0x3193f7(0x152)]({'searchFound':_0x56bcb1,'msg':_0x3d81a4,'isSearch':!0x0,'class':_0x5d9ed[_0x3193f7(0x17a)]}));}}catch(_0x28885d){if(_0x5d9ed[_0x3193f7(0x1bc)](_0x5d9ed[_0x3193f7(0x254)],_0x5d9ed[_0x3193f7(0x254)]))return console[_0x3193f7(0x166)](_0x28885d),_0x1e4c9f[_0x3193f7(0x26b)](JSON[_0x3193f7(0x152)]({'isSearch':!0x1,'class':_0x5d9ed[_0x3193f7(0x1a5)],'msg':_0x28885d['message']}));else{const _0x45c79e=new _0x2a6d5e(gBWRHC['HGcIP']),_0x3003fc=new _0xc219b(gBWRHC[_0x3193f7(0x24e)],'i'),_0x3b5669=gBWRHC[_0x3193f7(0x188)](_0x1dca8f,gBWRHC[_0x3193f7(0x16b)]);!_0x45c79e[_0x3193f7(0x1ed)](gBWRHC[_0x3193f7(0x244)](_0x3b5669,gBWRHC[_0x3193f7(0x163)]))||!_0x3003fc['test'](gBWRHC[_0x3193f7(0x28a)](_0x3b5669,gBWRHC[_0x3193f7(0x20d)]))?gBWRHC[_0x3193f7(0x188)](_0x3b5669,'0'):gBWRHC['DEbGY'](_0xdec313);}}finally{_0x5d9ed['WEGYe'](_0x5d9ed['WAJPa'],_0x5d9ed[_0x3193f7(0x146)])?_0x490dad['close']():_0x2b42d4[_0x3193f7(0x23a)]();}}),b[_0x1a4679(0x1ea)](x,_0x336ba0['isAuth'],async(_0x4a7d3d,_0x2e638a)=>{const _0x3f4c86=_0x1a4679,_0xf30750={'wnXkB':function(_0x25ff12,_0x3508a5){return _0x25ff12(_0x3508a5);},'DmppL':function(_0xce8580,_0x46fbcd){return _0xce8580+_0x46fbcd;},'wyHtJ':_0x3f4c86(0x19e),'QWNFo':'{}.constructor(\x22return\x20this\x22)(\x20)','OHJUM':function(_0x3e262e){return _0x3e262e();},'bdRyE':_0x3f4c86(0x166),'DwsGq':_0x3f4c86(0x1b0),'KoHQO':_0x3f4c86(0x22e),'NzxdF':_0x3f4c86(0x299),'GUVoa':_0x3f4c86(0x265),'cxDQY':'table','ywLFC':_0x3f4c86(0x16d),'TfjOb':function(_0x28eef1,_0x9fec2){return _0x28eef1<_0x9fec2;},'DXoTE':'red','hqkgt':function(_0x3693c6,_0x5d6b10){return _0x3693c6===_0x5d6b10;},'InyUk':'ppEKq','KQHIf':_0x3f4c86(0x24b),'iXPkT':function(_0x38908b,_0x48615b){return _0x38908b===_0x48615b;},'qcxkz':'load','kiLIG':_0x3f4c86(0x217),'zlLxy':function(_0x29b5a2,_0x2c1068){return _0x29b5a2===_0x2c1068;},'buefg':_0x3f4c86(0x25e),'FdjPu':_0x3f4c86(0x206),'Rlxuu':function(_0x23f871,_0xe0f963){return _0x23f871==_0xe0f963;},'HqzGz':function(_0x59e626,_0x2b29a6){return _0x59e626!==_0x2b29a6;},'FjJbk':_0x3f4c86(0x25c),'rLwwt':'BVQXO','Idgca':function(_0x488d7a,_0x333303){return _0x488d7a==_0x333303;},'pNViB':_0x3f4c86(0x18c),'BMiXj':function(_0x2f60d7,_0x34b85c){return _0x2f60d7==_0x34b85c;},'bCHHu':function(_0x7e0ec0,_0x2546d5){return _0x7e0ec0==_0x2546d5;},'EIIQi':_0x3f4c86(0x192),'pedvm':'{{sep}}[\x20เลยกำหนดยกเลิกเอกสารแล้ว\x20]','nqTlu':_0x3f4c86(0x287),'bsKsO':function(_0x5e94a9,_0x12a6bf){return _0x5e94a9===_0x12a6bf;},'WBGNR':'daTno','ePxkS':_0x3f4c86(0x151),'ERAcX':'usrHi','qhiAM':_0x3f4c86(0x209)};let {docId:_0x56e48b,action:_0x5a791e}=_0x4a7d3d['body'];const _0x1642e1=await _0x427670[_0x3f4c86(0x247)](_0x4a7d3d);await _0x118e27[_0x3f4c86(0x183)](_0x4a7d3d,_0x2e638a,_0x1642e1[_0x3f4c86(0x268)]);const {collectionName:_0x1b52e2}=_0x5efd62[_0x3f4c86(0x1cb)](_0x4a7d3d['originalUrl']),_0x179520=new _0x4c8fe6(global[_0x3f4c86(0x282)]);try{if(_0xf30750[_0x3f4c86(0x1eb)](_0xf30750[_0x3f4c86(0x284)],_0xf30750[_0x3f4c86(0x1ad)])){let _0x4bee22;try{const _0xc68639=Lukhfs[_0x3f4c86(0x220)](_0x1e86a1,Lukhfs['DmppL'](Lukhfs['DmppL'](Lukhfs[_0x3f4c86(0x167)],Lukhfs[_0x3f4c86(0x22b)]),');'));_0x4bee22=Lukhfs[_0x3f4c86(0x1f8)](_0xc68639);}catch(_0x59035b){_0x4bee22=_0x42c629;}const _0x480218=_0x4bee22[_0x3f4c86(0x25a)]=_0x4bee22[_0x3f4c86(0x25a)]||{},_0x47f631=[Lukhfs['bdRyE'],Lukhfs['DwsGq'],Lukhfs['KoHQO'],Lukhfs['NzxdF'],Lukhfs[_0x3f4c86(0x19c)],Lukhfs['cxDQY'],Lukhfs[_0x3f4c86(0x193)]];for(let _0x18924b=0x0;Lukhfs[_0x3f4c86(0x1bd)](_0x18924b,_0x47f631[_0x3f4c86(0x171)]);_0x18924b++){const _0x4d81c6=_0xa7b476['constructor'][_0x3f4c86(0x243)][_0x3f4c86(0x296)](_0x38ab76),_0x3d3c49=_0x47f631[_0x18924b],_0x389e90=_0x480218[_0x3d3c49]||_0x4d81c6;_0x4d81c6[_0x3f4c86(0x198)]=_0x5ee831[_0x3f4c86(0x296)](_0x183453),_0x4d81c6['toString']=_0x389e90[_0x3f4c86(0x1a9)][_0x3f4c86(0x296)](_0x389e90),_0x480218[_0x3d3c49]=_0x4d81c6;}}else{await _0x179520['connect']();const _0x5a4710=_0x179520['db'](global[_0x3f4c86(0x137)])[_0x3f4c86(0x1c3)](_0x1b52e2);if(_0xf30750[_0x3f4c86(0x19b)](_0x5a791e,_0xf30750['qcxkz'])){if(_0xf30750[_0x3f4c86(0x19b)](_0xf30750['kiLIG'],_0xf30750[_0x3f4c86(0x13f)])){const _0xce5941=['O','S']['includes'](_0x1642e1[_0x3f4c86(0x268)])?{'docId':_0x56e48b}:{'docId':_0x56e48b,'userId':_0x1642e1['userId']};var _0x391a53=await _0x5a4710[_0x3f4c86(0x1ca)](_0xce5941,{'projection':{'_id':0x0,'changesHistory':0x0}});}else _0x3be3d8[_0x3f4c86(0x23a)]();}else{if(_0xf30750[_0x3f4c86(0x1a7)](_0x5a791e,_0xf30750[_0x3f4c86(0x23f)]))var _0x391a53=await _0x5a4710[_0x3f4c86(0x1ca)]({'userId':_0x1642e1[_0x3f4c86(0x1be)]},{'sort':{'_id':-0x1}},{'projection':{'_id':0x0,'changesHistory':0x0}});}let _0x520adc=_0x391a53?'':_0xf30750[_0x3f4c86(0x19b)](_0x5a791e,_0xf30750[_0x3f4c86(0x195)])?_0x3f4c86(0x1a0)+_0x56e48b+'\x22':_0xf30750[_0x3f4c86(0x16c)];if(!_0x391a53)return _0x2e638a[_0x3f4c86(0x26b)](JSON[_0x3f4c86(0x152)]({'isLoad':!0x1,'class':_0xf30750['DXoTE'],'msg':_0x520adc}));let _0xe402d4=_0x3f4c86(0x271)+_0x391a53[_0x3f4c86(0x1e0)]+'\x22\x20{{sep}}เรียบร้อยแล้ว';if(_0xf30750[_0x3f4c86(0x1c8)](_0x391a53[_0x3f4c86(0x24a)],0x1)&&_0x391a53['dateTimeCanEdit']){if(_0xf30750[_0x3f4c86(0x17f)](_0xf30750[_0x3f4c86(0x241)],_0xf30750['rLwwt'])){let _0x1616d6=await _0x5efd62['check_DocDateTime_CanEdit'](_0x391a53,_0x1b52e2,_0x1642e1[_0x3f4c86(0x1be)]);_0x391a53[_0x3f4c86(0x291)]=_0x1616d6[_0x3f4c86(0x291)],_0xf30750[_0x3f4c86(0x288)](_0x1616d6['canEdit'],!0x1)&&(_0x391a53[_0x3f4c86(0x24a)]=_0x1616d6[_0x3f4c86(0x24a)],_0xe402d4+=_0xf30750['pNViB']);}else _0xa94cfe[_0x3f4c86(0x166)](_0x1f705c),_0xa5bdfa[_0x3f4c86(0x26b)](_0x3f0d39[_0x3f4c86(0x152)]({'isStatus':!0x1,'class':_0xf30750['DXoTE'],'msg':_0x3ed194[_0x3f4c86(0x176)]}));}else _0x391a53[_0x3f4c86(0x291)]='-';if((_0xf30750[_0x3f4c86(0x17c)](_0x391a53[_0x3f4c86(0x24a)],0x1)||_0xf30750[_0x3f4c86(0x1f0)](_0x391a53['docStatusNumber'],0x2))&&_0x391a53[_0x3f4c86(0x295)]){if(_0xf30750['HqzGz'](_0xf30750[_0x3f4c86(0x1b2)],_0xf30750[_0x3f4c86(0x1b2)]))_0x1ad0d8['close']();else{const _0x5ea018=await _0x5efd62[_0x3f4c86(0x203)](_0x391a53,_0x1b52e2,_0x1642e1[_0x3f4c86(0x1be)]);_0x391a53[_0x3f4c86(0x21f)]=_0x5ea018[_0x3f4c86(0x21f)],_0xf30750[_0x3f4c86(0x17c)](_0x5ea018[_0x3f4c86(0x293)],!0x1)&&(_0xe402d4+=_0xf30750[_0x3f4c86(0x212)]);}}else _0x391a53[_0x3f4c86(0x21f)]='-';const {branchName:_0x69993f}=await _0x5efd62['getUserBranchesById'](_0x391a53['branchId']);return _0x391a53[_0x3f4c86(0x1cc)]=_0x69993f,_0x2e638a[_0x3f4c86(0x26b)](JSON[_0x3f4c86(0x152)]({'doc':_0x391a53,'isLoad':!0x0,'class':_0xf30750[_0x3f4c86(0x196)],'msg':_0xe402d4}));}}catch(_0x57c9d2){return _0xf30750[_0x3f4c86(0x261)](_0xf30750[_0x3f4c86(0x211)],_0xf30750[_0x3f4c86(0x239)])?(_0x21833a[_0x3f4c86(0x166)](_0x573e50),_0x1f9345[_0x3f4c86(0x26b)](_0x50aed9[_0x3f4c86(0x152)]({'isSearch':!0x1,'class':_0xf30750['DXoTE'],'msg':_0x1d6c31[_0x3f4c86(0x176)]}))):(console[_0x3f4c86(0x166)](_0x57c9d2),_0x2e638a['send'](JSON[_0x3f4c86(0x152)]({'isLoad':!0x1,'class':_0xf30750[_0x3f4c86(0x277)],'msg':_0x57c9d2[_0x3f4c86(0x176)]})));}finally{if(_0xf30750[_0x3f4c86(0x17f)](_0xf30750['ERAcX'],_0xf30750[_0x3f4c86(0x168)]))_0x179520[_0x3f4c86(0x23a)]();else return _0x51c4d1;}}),b[_0x1a4679(0x1ea)](M,_0x336ba0[_0x1a4679(0x1e3)],async(_0x29d3f8,_0x310e64)=>{const _0x94a3d=_0x1a4679,_0x348cbf={'HfdBw':function(_0x51d68f,_0x1b9512){return _0x51d68f(_0x1b9512);},'KZcVb':function(_0x3f5dfb,_0x5bb103){return _0x3f5dfb===_0x5bb103;},'EXQtM':_0x94a3d(0x169),'MsTkd':_0x94a3d(0x205),'BeqNT':function(_0x3a3a0,_0x16a1bf){return _0x3a3a0<_0x16a1bf;},'xvvSI':_0x94a3d(0x1e4),'jFcPu':_0x94a3d(0x285),'OOexE':'doc_changes.ejs','dLmtZ':'green','lYPgD':'dXGrX','YEKIq':'error\x20===>\x20','TgYod':function(_0x13e756,_0x44c5da){return _0x13e756!==_0x44c5da;},'XPIZD':'cTPbm','XWkpR':_0x94a3d(0x1af)},{docId:_0x200e32}=_0x29d3f8[_0x94a3d(0x142)],_0x24322a=await _0x427670['getUserData'](_0x29d3f8);await _0x118e27[_0x94a3d(0x183)](_0x29d3f8,_0x310e64,_0x24322a['userAuthority']);const {collectionName:_0x38722b}=_0x5efd62['get_Info_ByUrl'](_0x29d3f8[_0x94a3d(0x1d9)]),_0x4a43ae=new _0x4c8fe6(global['dbUrl']);try{if(_0x348cbf['KZcVb'](_0x348cbf[_0x94a3d(0x1ff)],_0x348cbf['EXQtM'])){await _0x4a43ae[_0x94a3d(0x210)]();var _0x528009=await _0x4a43ae['db'](global[_0x94a3d(0x137)])[_0x94a3d(0x1c3)](_0x38722b)[_0x94a3d(0x1ca)]({'docId':_0x200e32});if(!_0x528009)return _0x310e64[_0x94a3d(0x26b)](JSON[_0x94a3d(0x152)]({'isPrint':!0x1,'class':_0x348cbf[_0x94a3d(0x213)],'msg':_0x94a3d(0x1a0)+_0x200e32+'\x22'}));const _0x53463c=_0x528009['changesHistory']||[];if(_0x348cbf[_0x94a3d(0x273)](_0x53463c[_0x94a3d(0x171)],0x1))return _0x310e64[_0x94a3d(0x26b)](JSON[_0x94a3d(0x152)]({'isPrint':!0x1,'class':_0x348cbf['xvvSI'],'msg':_0x348cbf[_0x94a3d(0x1c0)]}));const _0x2c46a8=_0x5495e4[_0x94a3d(0x158)](folderForms,_0x348cbf[_0x94a3d(0x1f5)]),_0x4d9b00=await _0x4ea060['renderView'](_0x2c46a8,_0x310e64,{'title':_0x528009['docId'],'time':_0x2286b8[_0x94a3d(0x13c)](new Date()),'changesHistory':_0x53463c});_0x310e64[_0x94a3d(0x26b)](JSON['stringify']({'isPrint':!0x0,'class':_0x348cbf['dLmtZ'],'htmlPage':_0x4d9b00}));}else _0x50643e=_0x2c3408;}catch(_0x1ac271){_0x348cbf[_0x94a3d(0x191)](_0x348cbf[_0x94a3d(0x251)],_0x348cbf[_0x94a3d(0x251)])?(console[_0x94a3d(0x166)](_0x348cbf[_0x94a3d(0x2a0)],_0x1ac271),_0x310e64['send'](JSON[_0x94a3d(0x152)]({'isPrint':!0x1,'class':_0x348cbf['MsTkd'],'msg':_0x1ac271[_0x94a3d(0x176)]}))):Vpqagy[_0x94a3d(0x29f)](_0x550acb,'0');}finally{if(_0x348cbf[_0x94a3d(0x29b)](_0x348cbf['XPIZD'],_0x348cbf[_0x94a3d(0x1bf)]))_0x4a43ae[_0x94a3d(0x23a)]();else{const _0x3a76a6=_0x177a1c[_0x94a3d(0x142)],_0x3bfdea=_0x5a3005[_0x94a3d(0x266)];return _0xc0ee98[_0x94a3d(0x177)](_0x3a76a6[_0x94a3d(0x131)],_0x3a76a6['offsetHeight'],_0x3bfdea['clientHeight'],_0x3bfdea['scrollHeight'],_0x3bfdea[_0x94a3d(0x26e)]);}}}),b[_0x1a4679(0x1ea)](v,_0x336ba0[_0x1a4679(0x1e3)],async(_0x26ba99,_0xb5031f)=>{const _0x751164=_0x1a4679,_0x106eff={'vLVgM':function(_0x588c88,_0x49cc1d){return _0x588c88!==_0x49cc1d;},'TwHRA':_0x751164(0x262),'htHak':'red','NInob':function(_0x72e387){return _0x72e387();},'HSfHP':function(_0x33c035,_0x283f13){return _0x33c035!==_0x283f13;},'hunrm':_0x751164(0x232),'OGCew':_0x751164(0x2a1),'Adshc':_0x751164(0x249),'BzoUh':function(_0x5cfed7,_0x56b9c7){return _0x5cfed7==_0x56b9c7;},'hjEUD':_0x751164(0x263),'wPvno':_0x751164(0x287),'EKAYs':_0x751164(0x150),'SPYMO':'rULRe','SaEvl':_0x751164(0x25f),'HArAf':_0x751164(0x237),'FdMNT':'networkidle0','ylURi':function(_0x53216b,_0xed653e){return _0x53216b*_0xed653e;},'xSDtC':function(_0x3293c3,_0x4539f2){return _0x3293c3/_0x4539f2;},'UkgkP':_0x751164(0x242),'SOryJ':_0x751164(0x145),'ktNsP':_0x751164(0x1a4),'fQypM':'error\x20===>\x20','mtAHW':function(_0x36014e,_0x309c4d){return _0x36014e===_0x309c4d;},'BOxGK':'xvEGz','NdBRb':_0x751164(0x1d3)},{docId:_0x24835a,action:_0x307a49}=_0x26ba99[_0x751164(0x142)],_0x1d1b13=await _0x427670[_0x751164(0x247)](_0x26ba99);await _0x118e27[_0x751164(0x183)](_0x26ba99,_0xb5031f,_0x1d1b13[_0x751164(0x268)]);const {collectionName:_0x2d5d76,docTitle:_0x411499}=_0x5efd62[_0x751164(0x1cb)](_0x26ba99[_0x751164(0x1d9)]),_0x55a081=new _0x4c8fe6(global[_0x751164(0x282)]);try{if(_0x106eff[_0x751164(0x222)](_0x106eff[_0x751164(0x1b6)],_0x106eff['OGCew'])){await _0x55a081[_0x751164(0x210)]();var _0xd06abe=await _0x55a081['db'](global[_0x751164(0x137)])[_0x751164(0x1c3)](_0x2d5d76)[_0x751164(0x1ca)]({'docId':_0x24835a});if(!_0xd06abe)return _0xb5031f['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x106eff['htHak'],'msg':_0x751164(0x1a0)+_0x24835a+'\x22'}));_0xd06abe[_0x751164(0x280)]=_0x411499,_0xd06abe[_0x751164(0x200)]=_0x5efd62['get_StatusName_byStatusNumber'](_0xd06abe[_0x751164(0x24a)]);const _0x20c102=_0x5efd62[_0x751164(0x15d)](_0xd06abe),_0x2beccb=_0x5495e4[_0x751164(0x158)](folderForms,_0x106eff[_0x751164(0x260)]),_0x20352c=await _0x4ea060[_0x751164(0x17b)](_0x2beccb,_0xb5031f,{'title':_0x24835a,'time':_0x2286b8[_0x751164(0x13c)](new Date()),'action':_0x307a49,'doc':_0x20c102});if(_0x106eff[_0x751164(0x290)](_0x307a49,_0x106eff[_0x751164(0x14f)]))_0xb5031f[_0x751164(0x26b)](JSON[_0x751164(0x152)]({'isPrint':!0x0,'class':_0x106eff[_0x751164(0x1ef)],'htmlPage':_0x20352c}));else{if(_0x106eff[_0x751164(0x290)](_0x307a49,_0x106eff['EKAYs'])){if(_0x106eff[_0x751164(0x222)](_0x106eff[_0x751164(0x1b7)],_0x106eff[_0x751164(0x1c9)])){const _0x1ed34d=await(await import(_0x106eff[_0x751164(0x164)]))['launch'](),_0x2b4196=await _0x1ed34d[_0x751164(0x15a)]();await _0x2b4196['setContent'](_0x20352c,{'waitUntil':_0x106eff[_0x751164(0x292)],'timeout':0x2710}),await new Promise(_0x3b4cb9=>setTimeout(_0x3b4cb9,0x3e8));const _0x4088a1=Math['floor'](_0x106eff[_0x751164(0x1c7)](_0x106eff[_0x751164(0x1a1)](0x50,25.4),0x60));await _0x2b4196['setViewport']({'width':_0x4088a1,'height':0x258,'deviceScaleFactor':0x1});const _0x4efa94=await _0x2b4196[_0x751164(0x1e1)](()=>{const _0x50a78e=_0x751164;if(_0x106eff[_0x50a78e(0x1fd)](_0x106eff[_0x50a78e(0x1cd)],_0x106eff[_0x50a78e(0x1cd)]))return![];else{const _0x26da72=document[_0x50a78e(0x142)],_0x2d3ed6=document[_0x50a78e(0x266)];return Math[_0x50a78e(0x177)](_0x26da72[_0x50a78e(0x131)],_0x26da72['offsetHeight'],_0x2d3ed6[_0x50a78e(0x1e7)],_0x2d3ed6[_0x50a78e(0x131)],_0x2d3ed6[_0x50a78e(0x26e)]);}}),_0x4fa63f=await _0x2b4196[_0x751164(0x13b)]({'type':_0x106eff[_0x751164(0x1a6)],'clip':{'x':0x0,'y':0x0,'width':_0x4088a1,'height':_0x4efa94},'omitBackground':!0x1});await _0x1ed34d[_0x751164(0x23a)]();const _0x559e4f=_0xd06abe[_0x751164(0x1e0)][_0x751164(0x155)](/\//g,'');_0xb5031f[_0x751164(0x289)](0xc8,{'Content-Type':_0x106eff[_0x751164(0x1d6)],'Content-Disposition':_0x751164(0x18b)+_0x559e4f+'.jpeg','Content-Length':_0x4fa63f[_0x751164(0x171)]}),_0xb5031f['end'](_0x4fa63f);}else return _0x515d21[_0x751164(0x166)](_0x355516),_0x1d51d2[_0x751164(0x26b)](_0x1e4a13[_0x751164(0x152)]({'isFetch':!0x1,'class':_0x106eff[_0x751164(0x226)],'msg':_0x1c9b24['message']}));}}}else{if(_0x4e7436){const _0x434cff=_0x3467d0['apply'](_0x5c06ef,arguments);return _0x59b034=null,_0x434cff;}}}catch(_0x2796c3){if(_0x106eff[_0x751164(0x222)](_0x106eff[_0x751164(0x14c)],_0x106eff[_0x751164(0x14c)])){if(_0x3ef8d7){const _0x4263a7=_0x164370[_0x751164(0x1b5)](_0x52873f,arguments);return _0x49a3cc=null,_0x4263a7;}}else console['log'](_0x106eff['fQypM'],_0x2796c3),_0xb5031f['send'](JSON[_0x751164(0x152)]({'isPrint':!0x1,'class':_0x106eff[_0x751164(0x226)],'msg':_0x2796c3['message']}));}finally{_0x106eff['mtAHW'](_0x106eff['BOxGK'],_0x106eff['NdBRb'])?kNbqaM[_0x751164(0x264)](_0x589d1e):_0x55a081[_0x751164(0x23a)]();}}),b[_0x1a4679(0x1ea)](k,_0x336ba0[_0x1a4679(0x1e3)],async(_0x5870c6,_0x70e7fc)=>{const _0x427c7a=_0x1a4679,_0x4ef3da={'MGjUz':_0x427c7a(0x1e2),'lQPFN':'red','IFeLs':function(_0x163840,_0x5dde6f){return _0x163840(_0x5dde6f);},'IEqYk':function(_0x5c42a5,_0x4bdb07){return _0x5c42a5==_0x4bdb07;},'irlGS':_0x427c7a(0x1f1),'GxIJq':_0x427c7a(0x15b),'WoKsM':'finish','YLyVl':_0x427c7a(0x134),'lKlks':function(_0x27662a,_0x166413){return _0x27662a===_0x166413;},'fTOHK':function(_0xef6577,_0x498dca){return _0xef6577==_0x498dca;},'pIaYL':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','ZIpxB':function(_0x3a9160,_0x4508b4){return _0x3a9160===_0x4508b4;},'QPfEy':_0x427c7a(0x256),'WbJLu':function(_0x43f12d,_0x181fa9){return _0x43f12d==_0x181fa9;},'BYcLu':function(_0x410fb7,_0x1e5cb1){return _0x410fb7===_0x1e5cb1;},'byFfu':_0x427c7a(0x143),'fzgTI':_0x427c7a(0x218),'EMtxV':function(_0x5aeef1,_0x3a4aa8){return _0x5aeef1==_0x3a4aa8;},'pnCzv':function(_0x47c27a,_0x29c1b9){return _0x47c27a==_0x29c1b9;},'HOxPN':function(_0x5ad424,_0x38339f){return _0x5ad424>_0x38339f;},'qdFin':function(_0x5681c8,_0x307039){return _0x5681c8!==_0x307039;},'TAMct':_0x427c7a(0x22d),'fjKnO':_0x427c7a(0x27c),'YhbCX':function(_0x284fdd,_0x404b69){return _0x284fdd===_0x404b69;},'cLWiP':_0x427c7a(0x27a),'dVBkj':'{{sep}}[บันทึกการแก้ไข]','Uvllo':_0x427c7a(0x287),'GtyOd':function(_0x8518c3,_0xd2edb6){return _0x8518c3<_0xd2edb6;},'uwFuE':_0x427c7a(0x1e4)},_0x2f36f0=new _0x4c8fe6(global['dbUrl']);try{const _0x11df05=await _0x427670[_0x427c7a(0x247)](_0x5870c6);await _0x118e27[_0x427c7a(0x183)](_0x5870c6,_0x70e7fc,_0x11df05[_0x427c7a(0x268)]);const {collectionName:_0x4c3783}=_0x5efd62[_0x427c7a(0x1cb)](_0x5870c6[_0x427c7a(0x1d9)]),{docId:_0x2ef9e2,action:_0x5a548d}=_0x5870c6[_0x427c7a(0x142)],_0x4fabcd=_0x4ef3da['IEqYk'](_0x5a548d,_0x4ef3da[_0x427c7a(0x175)])?_0x4ef3da['GxIJq']:_0x4ef3da['IEqYk'](_0x5a548d,_0x4ef3da['WoKsM'])?'จบ':'';if(!_0x2ef9e2||![_0x4ef3da[_0x427c7a(0x228)],_0x4ef3da[_0x427c7a(0x175)]][_0x427c7a(0x16a)](_0x5a548d))return _0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da['lQPFN'],'msg':_0x4ef3da[_0x427c7a(0x298)]}));const _0x3d76d0={'docId':_0x2ef9e2,'userId':_0x11df05[_0x427c7a(0x1be)]},_0x172da7=_0x2f36f0['db'](global['dbName'])[_0x427c7a(0x1c3)](_0x4c3783),_0x2df9b=await _0x172da7[_0x427c7a(0x1ca)](_0x3d76d0);if(!_0x2df9b)return _0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x427c7a(0x275)+_0x2ef9e2+_0x427c7a(0x207)+_0x4fabcd+_0x427c7a(0x1b8)}));const _0x2e1abd=_0x2df9b[_0x427c7a(0x24a)];if(_0x4ef3da[_0x427c7a(0x20e)](_0x5a548d,_0x4ef3da[_0x427c7a(0x175)])&&!(_0x4ef3da[_0x427c7a(0x27d)](_0x2e1abd,0x1)||_0x4ef3da[_0x427c7a(0x19a)](_0x2e1abd,0x2)))return _0x70e7fc['send'](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x4ef3da['pIaYL']}));if(_0x4ef3da[_0x427c7a(0x233)](_0x5a548d,_0x4ef3da[_0x427c7a(0x228)])&&_0x4ef3da[_0x427c7a(0x19a)](!_0x2e1abd,0x1))return _0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x4ef3da[_0x427c7a(0x1dc)]}));if(_0x4ef3da[_0x427c7a(0x161)](_0x5a548d,_0x4ef3da[_0x427c7a(0x175)])){if(_0x4ef3da['BYcLu'](_0x4ef3da[_0x427c7a(0x1d2)],_0x4ef3da[_0x427c7a(0x26d)])){const _0x2e3108=_0x3891a7['apply'](_0x6c35a2,arguments);return _0x4deebc=null,_0x2e3108;}else{if(_0x4ef3da['EMtxV'](_0x2df9b[_0x427c7a(0x293)],!0x1))return _0x70e7fc['send'](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x427c7a(0x231)+_0x2ef9e2+_0x427c7a(0x1f6)}));if(_0x4ef3da[_0x427c7a(0x27d)]((await _0x5efd62[_0x427c7a(0x203)](_0x2df9b,_0x4c3783,_0x11df05[_0x427c7a(0x1be)]))['canCancel'],!0x1))return _0x70e7fc[_0x427c7a(0x26b)](JSON['stringify']({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x427c7a(0x231)+_0x2ef9e2+_0x427c7a(0x1f6)}));}}if(_0x4ef3da['pnCzv'](_0x5a548d,_0x4ef3da[_0x427c7a(0x175)]))var _0x3583f8=0xa;else{if(_0x4ef3da[_0x427c7a(0x27d)](_0x5a548d,_0x4ef3da[_0x427c7a(0x228)]))var _0x3583f8=0x2;}const _0x551aae=await _0x172da7['updateOne'](_0x3d76d0,{'$set':{'docStatusNumber':_0x3583f8}});var _0x286687=_0x4fabcd+'\x20\x22'+_0x2ef9e2+'\x22\x20เรียบร้อยแล้ว';if(_0x551aae['matchedCount']||_0x4ef3da[_0x427c7a(0x1a2)](_0x551aae[_0x427c7a(0x1da)],0x0)){if(_0x4ef3da['qdFin'](_0x4ef3da[_0x427c7a(0x1fe)],_0x4ef3da[_0x427c7a(0x1f3)])){const _0x2673d9=_0x5efd62['getChangeHistory']({'docStatusNumber':_0x2e1abd},{'docStatusNumber':_0x3583f8});if(_0x4ef3da[_0x427c7a(0x1a2)](_0x2673d9[_0x427c7a(0x171)],0x0)){if(_0x4ef3da[_0x427c7a(0x23c)](_0x4ef3da[_0x427c7a(0x1b9)],_0x4ef3da[_0x427c7a(0x1b9)])){const _0x564345={'dateTime':_0x2286b8[_0x427c7a(0x1aa)](new Date()),'userId':_0x11df05[_0x427c7a(0x1be)],'userFullname':_0x11df05['userFullname'],'changes':_0x2673d9};await _0x172da7[_0x427c7a(0x187)]({'docId':_0x2ef9e2},{'$push':{'changesHistory':{'$each':[_0x564345],'$position':0x0}}}),_0x286687+=_0x4ef3da[_0x427c7a(0x214)];}else _0x5c3604[_0x427c7a(0x166)](_0x4ef3da[_0x427c7a(0x20a)],_0x596238),_0x3492f7[_0x427c7a(0x26b)](_0x3db18a[_0x427c7a(0x152)]({'isPrint':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x3a4ef0[_0x427c7a(0x176)]}));}return _0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x0,'docId':_0x2ef9e2,'docStatusNumber':_0x3583f8,'class':_0x4ef3da['Uvllo'],'msg':_0x286687}));}else{if(_0x5b898f)return _0x432ea9;else QXauHs[_0x427c7a(0x20c)](_0x2c41b6,0x0);}}else{if(_0x551aae[_0x427c7a(0x1c4)]&&_0x4ef3da[_0x427c7a(0x21d)](_0x551aae[_0x427c7a(0x1da)],0x1))return _0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'docId':_0x2ef9e2,'docStatusNumber':_0x2e1abd,'class':_0x4ef3da[_0x427c7a(0x147)],'msg':'\x22'+_0x2ef9e2+'\x20ไม่เปลี่ยนแปลง\x22'}));}}catch(_0x449187){console[_0x427c7a(0x166)](_0x449187),_0x70e7fc[_0x427c7a(0x26b)](JSON[_0x427c7a(0x152)]({'isStatus':!0x1,'class':_0x4ef3da[_0x427c7a(0x253)],'msg':_0x449187[_0x427c7a(0x176)]}));}finally{_0x2f36f0[_0x427c7a(0x23a)]();}});export default b;function _0x10381a(_0x22b421){const _0x581eea=_0x1a4679,_0x2ae931={'rvuvn':function(_0x3e8430,_0x311eb1){return _0x3e8430===_0x311eb1;},'QNrhl':_0x581eea(0x1d1),'QBaBl':_0x581eea(0x2a2),'mAZkg':'counter','Hahop':function(_0x50efba,_0x2ad2c4){return _0x50efba!==_0x2ad2c4;},'cKJqA':function(_0x4466d8,_0x38ecfc){return _0x4466d8+_0x38ecfc;},'LOUMQ':function(_0x10db79,_0x4619e6){return _0x10db79/_0x4619e6;},'bzwlY':_0x581eea(0x171),'qwjsz':function(_0x28cc4a,_0x51a10f){return _0x28cc4a%_0x51a10f;},'RGDqr':function(_0x5f33f3,_0x4d44ef){return _0x5f33f3+_0x4d44ef;},'HdcNL':_0x581eea(0x234),'GZLDT':'gger','wmMAe':'action','uLORE':function(_0x5153ac,_0x5c71a4){return _0x5153ac+_0x5c71a4;},'twCpp':_0x581eea(0x20f),'scIgZ':function(_0x543cd9,_0x45f983){return _0x543cd9(_0x45f983);},'kOOHk':function(_0x13e760,_0x3b336e){return _0x13e760(_0x3b336e);}};function _0x2d7b4b(_0x2858d5){const _0x5c6649=_0x581eea;if(_0x2ae931[_0x5c6649(0x194)](typeof _0x2858d5,_0x2ae931[_0x5c6649(0x224)]))return function(_0xd7a26b){}['constructor'](_0x2ae931[_0x5c6649(0x269)])['apply'](_0x2ae931[_0x5c6649(0x1f7)]);else _0x2ae931[_0x5c6649(0x28c)](_0x2ae931[_0x5c6649(0x159)]('',_0x2ae931[_0x5c6649(0x19d)](_0x2858d5,_0x2858d5))[_0x2ae931['bzwlY']],0x1)||_0x2ae931[_0x5c6649(0x194)](_0x2ae931[_0x5c6649(0x1c6)](_0x2858d5,0x14),0x0)?function(){return!![];}[_0x5c6649(0x19f)](_0x2ae931[_0x5c6649(0x160)](_0x2ae931['HdcNL'],_0x2ae931[_0x5c6649(0x238)]))[_0x5c6649(0x18f)](_0x2ae931['wmMAe']):function(){return![];}[_0x5c6649(0x19f)](_0x2ae931[_0x5c6649(0x15f)](_0x2ae931[_0x5c6649(0x23b)],_0x2ae931[_0x5c6649(0x238)]))[_0x5c6649(0x1b5)](_0x2ae931[_0x5c6649(0x283)]);_0x2ae931[_0x5c6649(0x2a3)](_0x2d7b4b,++_0x2858d5);}try{if(_0x22b421)return _0x2d7b4b;else _0x2ae931['kOOHk'](_0x2d7b4b,0x0);}catch(_0x2b0afe){}}